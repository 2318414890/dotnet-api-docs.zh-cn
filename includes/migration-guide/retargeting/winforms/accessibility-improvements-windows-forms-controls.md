### <a name="accessibility-improvements-in-windows-forms-controls"></a><span data-ttu-id="de465-101">Windows 窗体控件中的可访问性改进</span><span class="sxs-lookup"><span data-stu-id="de465-101">Accessibility improvements in Windows Forms controls</span></span>

|   |   |
|---|---|
|<span data-ttu-id="de465-102">详细信息</span><span class="sxs-lookup"><span data-stu-id="de465-102">Details</span></span>|<span data-ttu-id="de465-103">Windows 窗体提高它的工作原理与可访问性技术更好地支持 Windows 窗体客户。</span><span class="sxs-lookup"><span data-stu-id="de465-103">Windows Forms is improving how it works with accessibility technologies to better support Windows Forms customers.</span></span> <span data-ttu-id="de465-104">这些方法包括以下更改：</span><span class="sxs-lookup"><span data-stu-id="de465-104">These include the following changes:</span></span><ul><li><span data-ttu-id="de465-105">在高对比度模式下显示更改，以提高。</span><span class="sxs-lookup"><span data-stu-id="de465-105">Changes to improve display during High Contrast mode.</span></span></li><li><span data-ttu-id="de465-106">更改，以提高属性浏览器体验。</span><span class="sxs-lookup"><span data-stu-id="de465-106">Changes to improve the property browser experience.</span></span> <span data-ttu-id="de465-107">属性浏览器改进包括：</span><span class="sxs-lookup"><span data-stu-id="de465-107">Property browser improvements include:</span></span></li><li><span data-ttu-id="de465-108">更好地通过各种下拉选择窗口使用键盘导航。</span><span class="sxs-lookup"><span data-stu-id="de465-108">Better keyboard navigation through the various drop-down selection windows.</span></span></li><li><span data-ttu-id="de465-109">减少不必要的制表位。</span><span class="sxs-lookup"><span data-stu-id="de465-109">Reduced unnecessary tab stops.</span></span></li><li><span data-ttu-id="de465-110">更好地报告控件类型。</span><span class="sxs-lookup"><span data-stu-id="de465-110">Better reporting of control types.</span></span></li><li><span data-ttu-id="de465-111">改进了讲述人行为。</span><span class="sxs-lookup"><span data-stu-id="de465-111">Improved narrator behavior.</span></span></li><li><span data-ttu-id="de465-112">若要在控件中实现缺少的 UI 可访问性模式的更改。</span><span class="sxs-lookup"><span data-stu-id="de465-112">Changes to implement missing UI accessibility patterns in controls.</span></span></li></ul>|
|<span data-ttu-id="de465-113">建议</span><span class="sxs-lookup"><span data-stu-id="de465-113">Suggestion</span></span>|<span data-ttu-id="de465-114"><strong>如何选择加入或退出这些更改</strong>使应用程序以利用这些更改，它必须运行.NET Framework 4.7.1 上或更高版本。</span><span class="sxs-lookup"><span data-stu-id="de465-114"><strong>How to opt in or out of these changes</strong>In order for the application to benefit from these changes, it must run on the .NET Framework 4.7.1 or later.</span></span> <span data-ttu-id="de465-115">应用程序可以利用这些更改通过以下方式之一：</span><span class="sxs-lookup"><span data-stu-id="de465-115">The application can benefit from these changes in either of the following ways:</span></span><ul><li><span data-ttu-id="de465-116">它被编译为面向.NET Framework 4.7.1。</span><span class="sxs-lookup"><span data-stu-id="de465-116">It is recompiled to target the .NET Framework 4.7.1.</span></span> <span data-ttu-id="de465-117">这些可访问性更改为默认情况下，在面向.NET Framework 4.7.1 的 Windows 窗体应用程序上启用或更高版本。</span><span class="sxs-lookup"><span data-stu-id="de465-117">These accessibility changes are enabled by default on Windows Forms applications that target the .NET Framework 4.7.1 or later.</span></span></li><li><span data-ttu-id="de465-118">它通过将以下内容添加 opts 外的旧的可访问性行为[AppContext 交换机](~/docs/framework/configure-apps/file-schema/runtime/appcontextswitchoverrides-element.md)到<code>&lt;runtime&gt;</code>部分的 app.config 文件，将其设置为<code>false</code>，如下面的示例所示。</span><span class="sxs-lookup"><span data-stu-id="de465-118">It opts out of the legacy accessibility behaviors by adding the following [AppContext switch](~/docs/framework/configure-apps/file-schema/runtime/appcontextswitchoverrides-element.md) to the <code>&lt;runtime&gt;</code> section of the app.config file and setting it to <code>false</code>, as the following example shows.</span></span></li></ul><pre><code class="language-xml">&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt;&#13;&#10;&lt;configuration&gt;&#13;&#10;&lt;startup&gt;&#13;&#10;&lt;supportedRuntime version=&quot;v4.0&quot; sku=&quot;.NETFramework,Version=v4.7&quot;/&gt;&#13;&#10;&lt;/startup&gt;&#13;&#10;&lt;runtime&gt;&#13;&#10;&lt;!-- AppContextSwitchOverrides value attribute is in the form of &#39;key1=true/false;key2=true/false  --&gt;&#13;&#10;&lt;AppContextSwitchOverrides value=&quot;Switch.UseLegacyAccessibilityFeatures=false&quot; /&gt;&#13;&#10;&lt;/runtime&gt;&#13;&#10;&lt;/configuration&gt;&#13;&#10;</code></pre><span data-ttu-id="de465-119">面向.NET Framework 4.7.1 的应用程序或更高版本，并且想要保留旧可访问性行为来选择加入的旧的可访问性功能的使用通过此 AppContext 开关显式设置为<code>true</code>。UI 自动化的概述，请参阅[UI 自动化概述](~/docs/framework/ui-automation/ui-automation-overview.md)。<strong>增加了对 UI 自动化模式和属性支持</strong>辅助功能客户端可以通过使用通用、 公开描述调用模式充分利用新 WinForms 可访问性功能。</span><span class="sxs-lookup"><span data-stu-id="de465-119">Applications that target the .NET Framework 4.7.1 or later and want to preserve the legacy accessibility behavior can opt in to the use of legacy accessibility features by explicitly setting this AppContext switch to <code>true</code>.For an overview of UI automation, see the [UI Automation Overview](~/docs/framework/ui-automation/ui-automation-overview.md).<strong>Added support for UI Automation patterns and properties</strong>Accessibility clients can take advantage of new WinForms accessibility functionality by using common, publicly described invocation patterns.</span></span> <span data-ttu-id="de465-120">这些模式不是特定于 WinForms 的。</span><span class="sxs-lookup"><span data-stu-id="de465-120">These patterns are not WinForms-specific.</span></span> <span data-ttu-id="de465-121">例如，辅助功能客户端可以 IAccessible 接口 (MAAS) 若要获取的 IServiceProvider 接口上调用 QueryInterface 方法。</span><span class="sxs-lookup"><span data-stu-id="de465-121">For instance, accessibility clients can call the QueryInterface method on the IAccessible interface (MAAS) to obtain an IServiceProvider interface.</span></span> <span data-ttu-id="de465-122">此接口是否可用，客户端可以使用其 QueryService 方法来请求 IAccessibleEx 接口。</span><span class="sxs-lookup"><span data-stu-id="de465-122">If this interface is available, clients can use its QueryService method to request an IAccessibleEx interface.</span></span> <span data-ttu-id="de465-123">有关详细信息，请参阅[从客户端使用 IAccessibleEx](https://msdn.microsoft.com/library/windows/desktop/dd561924.aspx)。</span><span class="sxs-lookup"><span data-stu-id="de465-123">For more information, see [Using IAccessibleEx from a Client](https://msdn.microsoft.com/library/windows/desktop/dd561924.aspx).</span></span> <span data-ttu-id="de465-124">从.NET Framework 4.7.1，IServiceProvider 开始和[IAccessibleEx](https://msdn.microsoft.com/library/windows/desktop/dd561898.aspx) （如果适用） 可用于 WinForms 辅助功能对象。.NET Framework 4.7.1 添加以下 UI 自动化模式和属性的支持：</span><span class="sxs-lookup"><span data-stu-id="de465-124">Starting with the .NET Framework 4.7.1, IServiceProvider and [IAccessibleEx](https://msdn.microsoft.com/library/windows/desktop/dd561898.aspx) (where applicable) are available for WinForms accessibility objects.The .NET Framework 4.7.1 adds support for the following UI automation patterns and properties:</span></span><ul><li><span data-ttu-id="de465-125"><code>T:System.Windows.Forms.ToolStripSplitButton</code>和<code>T:System.Windows.Forms.ComboBox</code>控件支持[展开/折叠模式](~/docs/framework/ui-automation/implementing-the-ui-automation-expandcollapse-control-pattern.md)。</span><span class="sxs-lookup"><span data-stu-id="de465-125">The <code>T:System.Windows.Forms.ToolStripSplitButton</code> and <code>T:System.Windows.Forms.ComboBox</code> controls support the [Expand/Collapse pattern](~/docs/framework/ui-automation/implementing-the-ui-automation-expandcollapse-control-pattern.md).</span></span></li><li><span data-ttu-id="de465-126"><code>T:System.Windows.Forms.ToolStripMenuItem</code>控件具有[ControlType](~/docs/framework/ui-automation/ui-automation-support-for-the-menubar-control-type.md)属性值<xref:System.Windows.Automation.ControlType.MenuItem?displayProperty=nameWithType>。</span><span class="sxs-lookup"><span data-stu-id="de465-126">The <code>T:System.Windows.Forms.ToolStripMenuItem</code> control has a [ControlType](~/docs/framework/ui-automation/ui-automation-support-for-the-menubar-control-type.md) property value <xref:System.Windows.Automation.ControlType.MenuItem?displayProperty=nameWithType>.</span></span></li><li><span data-ttu-id="de465-127"><code>T:System.Windows.Forms.ToolStripItem</code>控件支持[名称](xref:System.Windows.Automation.AutomationElement.NameProperty)属性和[展开/折叠模式](~/docs/framework/ui-automation/implementing-the-ui-automation-expandcollapse-control-pattern.md)。</span><span class="sxs-lookup"><span data-stu-id="de465-127">The <code>T:System.Windows.Forms.ToolStripItem</code> control supports the [Name](xref:System.Windows.Automation.AutomationElement.NameProperty) property and [Expand/Collapse pattern](~/docs/framework/ui-automation/implementing-the-ui-automation-expandcollapse-control-pattern.md).</span></span></li><li><span data-ttu-id="de465-128"><code>T:System.Windows.Forms.ToolStripDropDownItem</code>控件支持<xref:System.Windows.Forms.AccessibleEvents>，该值指示 StateChange 和 NameChange 时下拉列表是展开还是折叠。</span><span class="sxs-lookup"><span data-stu-id="de465-128">The <code>T:System.Windows.Forms.ToolStripDropDownItem</code> control supports <xref:System.Windows.Forms.AccessibleEvents> indicating StateChange and NameChange when drop down is expanded or collapsed.</span></span></li><li><span data-ttu-id="de465-129"><code>T:System.Windows.Forms.ToolStripDropDownButton</code>控件具有[ControlType](~/docs/framework/ui-automation/ui-automation-support-for-the-menubar-control-type.md)属性值<xref:System.Windows.Automation.ControlType.MenuItem?displayProperty=nameWithType>。</span><span class="sxs-lookup"><span data-stu-id="de465-129">The <code>T:System.Windows.Forms.ToolStripDropDownButton</code> control has a [ControlType](~/docs/framework/ui-automation/ui-automation-support-for-the-menubar-control-type.md) property value of <xref:System.Windows.Automation.ControlType.MenuItem?displayProperty=nameWithType>.</span></span></li><li><span data-ttu-id="de465-130"><code>T:System.Windows.Forms.DataGridViewCheckBoxCell</code>控件支持[Toggle 模式](xref:System.Windows.Automation.TogglePattern)。</span><span class="sxs-lookup"><span data-stu-id="de465-130">The <code>T:System.Windows.Forms.DataGridViewCheckBoxCell</code> control supports the [Toggle Pattern](xref:System.Windows.Automation.TogglePattern).</span></span></li><li><span data-ttu-id="de465-131"><code>T:System.Windows.Forms.NumericUpDown</code>和<code>T:System.Windows.Forms.DomainUpDown</code>控件支持[名称](xref:System.Windows.Automation.AutomationElement.NameProperty)并且具有[ControlType](~/docs/framework/ui-automation/ui-automation-support-for-the-spinner-control-type.md)的<xref:System.Windows.Automation.ControlType.Spinner?displayProperty=nameWithType>。</span><span class="sxs-lookup"><span data-stu-id="de465-131">The <code>T:System.Windows.Forms.NumericUpDown</code> and <code>T:System.Windows.Forms.DomainUpDown</code> controls support the [Name](xref:System.Windows.Automation.AutomationElement.NameProperty) and have a [ControlType](~/docs/framework/ui-automation/ui-automation-support-for-the-spinner-control-type.md) of <xref:System.Windows.Automation.ControlType.Spinner?displayProperty=nameWithType>.</span></span></li></ul><span data-ttu-id="de465-132"><strong>对属性网格控制的改进</strong>的.NET Framework 4.7.1 向 PropertyBrowser 控件添加了以下改进：</span><span class="sxs-lookup"><span data-stu-id="de465-132"><strong>Improvements to the PropertyGrid control</strong>The .NET Framework 4.7.1 adds the following improvements to the PropertyBrowser control:</span></span><ul><li><span data-ttu-id="de465-133"><strong>详细信息</strong>在用户输入中的值不正确时，将显示错误对话框的按钮<code>T:System.Windows.Forms.PropertyGrid</code>控件支持[展开/折叠模式](~/docs/framework/ui-automation/implementing-the-ui-automation-expandcollapse-control-pattern.md)、 状态和名称更改通知，和一个[ControlType](~/docs/framework/ui-automation/ui-automation-support-for-the-menubar-control-type.md)属性值为<xref:System.Windows.Automation.ControlType.MenuItem?displayProperty=nameWithType>。</span><span class="sxs-lookup"><span data-stu-id="de465-133">The <strong>Details</strong> button in the error dialog that is displayed when the user enters an incorrect value in the <code>T:System.Windows.Forms.PropertyGrid</code> control supports the [Expand/Collapse pattern](~/docs/framework/ui-automation/implementing-the-ui-automation-expandcollapse-control-pattern.md), state and name change notifications, and a [ControlType](~/docs/framework/ui-automation/ui-automation-support-for-the-menubar-control-type.md) property with a value of <xref:System.Windows.Automation.ControlType.MenuItem?displayProperty=nameWithType>.</span></span></li><li><span data-ttu-id="de465-134">消息窗格中显示时<strong>详细信息</strong>展开的错误对话框的按钮现在是键盘可访问并且允许讲述人地宣布错误消息的内容。</span><span class="sxs-lookup"><span data-stu-id="de465-134">The message pane displayed when the <strong>Details</strong> button of the error dialog is expanded is now keyboard accessible and allows Narrator to announce the content of the error message.</span></span></li><li><span data-ttu-id="de465-135"><xref:System.Windows.Forms.AccessibleRole>中的行<code>T:System.Windows.Forms.PropertyGrid</code>控制已更改从&quot;行&quot;到&quot;单元格&quot;。</span><span class="sxs-lookup"><span data-stu-id="de465-135">The <xref:System.Windows.Forms.AccessibleRole> of rows in <code>T:System.Windows.Forms.PropertyGrid</code> control have changed from &quot;Row&quot; to &quot;Cell&quot;.</span></span> <span data-ttu-id="de465-136">单元格将映射到 UIA ControlType &quot;DataItem&quot;，这使得它能够支持相应的键盘快捷方式和讲述人公告。</span><span class="sxs-lookup"><span data-stu-id="de465-136">The cell maps to UIA ControlType &quot;DataItem&quot;, which allows it to support appropriate keyboard shortcuts and Narrator announcements.</span></span></li><li><span data-ttu-id="de465-137"><code>T:System.Windows.Forms.PropertyGrid</code>控制哪些表示标头的项的行<code>T:System.Windows.Forms.PropertyGrid</code>控件具有<code>P:System.Windows.Forms.PropertySort</code>属性设置为<code>F:System.Windows.Forms.PropertySory.Categorized</code>具有[ControlType](~/docs/framework/ui-automation/ui-automation-support-for-the-menubar-control-type.md)属性值 <xref:System.Windows.Automation.ControlType.Button?displayProperty=nameWithType></span><span class="sxs-lookup"><span data-stu-id="de465-137">The <code>T:System.Windows.Forms.PropertyGrid</code> control rows which represent header items when the <code>T:System.Windows.Forms.PropertyGrid</code> control has a <code>P:System.Windows.Forms.PropertySort</code> property set to <code>F:System.Windows.Forms.PropertySory.Categorized</code> have a [ControlType](~/docs/framework/ui-automation/ui-automation-support-for-the-menubar-control-type.md) property value of <xref:System.Windows.Automation.ControlType.Button?displayProperty=nameWithType></span></span></li><li><span data-ttu-id="de465-138"><code>T:System.Windows.Forms.PropertyGrid</code>控制哪些表示标头的项的行<code>T:System.Windows.Forms.PropertyGrid</code>控件具有<code>P:System.Windows.Forms.PropertySort</code>属性设置为<code>F:System.Windows.Forms.PropertySory.Categorized</code>支持[展开/折叠模式](~/docs/framework/ui-automation/implementing-the-ui-automation-expandcollapse-control-pattern.md)。</span><span class="sxs-lookup"><span data-stu-id="de465-138">The <code>T:System.Windows.Forms.PropertyGrid</code> control rows which represent header items when the <code>T:System.Windows.Forms.PropertyGrid</code> control has a <code>P:System.Windows.Forms.PropertySort</code> property set to <code>F:System.Windows.Forms.PropertySory.Categorized</code> support the [Expand/Collapse pattern](~/docs/framework/ui-automation/implementing-the-ui-automation-expandcollapse-control-pattern.md).</span></span></li><li><span data-ttu-id="de465-139">网格与它上方的工具栏之间改进的键盘导航。</span><span class="sxs-lookup"><span data-stu-id="de465-139">Improved keyboard navigation between the grid and the ToolBar above it.</span></span> <span data-ttu-id="de465-140">按&quot;Shift Tab&quot;现在选择第一个工具栏按钮，而不是整个工具栏</span><span class="sxs-lookup"><span data-stu-id="de465-140">Pressing &quot;Shift-Tab&quot; now selects the first ToolBar button, instead of the whole ToolBar</span></span></li><li><span data-ttu-id="de465-141"><code>T:System.Windows.Forms.PropertyGrid</code> 在高对比度模式下显示的控件将现在周围绘制聚焦框的工具栏按钮对应到当前<code>P:System.Windows.Forms.PropertySort</code>属性值。</span><span class="sxs-lookup"><span data-stu-id="de465-141"><code>T:System.Windows.Forms.PropertyGrid</code> controls displayed in High Contrast mode will now draw a focus rectangle around the ToolBar button which corresponds to the current <code>P:System.Windows.Forms.PropertySort</code> property value.</span></span></li><li><span data-ttu-id="de465-142"><code>T:System.Windows.Forms.PropertyGrid</code> 控件显示在高对比度模式，并与<code>P:System.Windows.Forms.PropertySort</code>属性设置为<code>F:System.Windows.Forms.PropertySory.Categorized</code>将现在显示高度对比颜色的颜色的类别标题的背景。</span><span class="sxs-lookup"><span data-stu-id="de465-142"><code>T:System.Windows.Forms.PropertyGrid</code> controls displayed in High Contrast mode and with a <code>P:System.Windows.Forms.PropertySort</code> property set to <code>F:System.Windows.Forms.PropertySory.Categorized</code> will now display the background of category headers in a highly contrasting color.</span></span></li><li><span data-ttu-id="de465-143"><code>T:System.Windows.Forms.PropertyGrid</code> 控件更好地区分具有焦点的工具栏项和工具栏项表示的当前值<code>P:System.Windows.Forms.PropertySort</code>属性。</span><span class="sxs-lookup"><span data-stu-id="de465-143"><code>T:System.Windows.Forms.PropertyGrid</code> controls better differentiates between ToolBar items with focus and the ToolBar items which indicate the current value of the <code>P:System.Windows.Forms.PropertySort</code> property.</span></span> <span data-ttu-id="de465-144">此修补程序包含高对比度更改和非高对比度方案的更改。</span><span class="sxs-lookup"><span data-stu-id="de465-144">This fix consists of a High Contrast change and a change for non-High Contrast scenarios.</span></span></li><li><span data-ttu-id="de465-145"><code>T:System.Windows.Forms.PropertyGrid</code> 控制工具栏项表示的当前值<code>P:System.Windows.Forms.PropertySort</code>属性支持[Toggle 模式](xref:System.Windows.Automation.TogglePattern)。</span><span class="sxs-lookup"><span data-stu-id="de465-145"><code>T:System.Windows.Forms.PropertyGrid</code> control ToolBar items which indicates the current value of the <code>P:System.Windows.Forms.PropertySort</code> property support the [Toggle Pattern](xref:System.Windows.Automation.TogglePattern).</span></span></li><li><span data-ttu-id="de465-146">改进了对区分对齐选取器中的所选的对齐讲述人支持。</span><span class="sxs-lookup"><span data-stu-id="de465-146">Improved Narrator support for distinguishing the selected alignment in the Alignment Picker.</span></span></li><li><span data-ttu-id="de465-147">当一个空<code>T:System.Windows.Forms.PropertyGrid</code>窗体上显示控件，它现在将会收到的焦点其中以前它不会。</span><span class="sxs-lookup"><span data-stu-id="de465-147">When an empty <code>T:System.Windows.Forms.PropertyGrid</code> control is displayed on a form, it will now receive focus where previously it would not.</span></span></li></ul><span data-ttu-id="de465-148"><strong>高对比度主题中的使用操作系统定义的颜色</strong></span><span class="sxs-lookup"><span data-stu-id="de465-148"><strong>Use of OS-defined colors in High Contrast themes</strong></span></span><ul><li><span data-ttu-id="de465-149"><code>T:System.Windows.Forms.Button</code> 和<code>T:System.Windows.Forms.CheckBox</code>控制与<code>P:System.Windows.Forms.Control.FlatStyle</code>设置为<xref:System.Windows.Forms.FlatStyle.System?displayProperty=nameWithType>默认样式时，现在使用选中的高对比度主题中的操作系统定义的颜色。</span><span class="sxs-lookup"><span data-stu-id="de465-149"><code>T:System.Windows.Forms.Button</code> and <code>T:System.Windows.Forms.CheckBox</code> controls with <code>P:System.Windows.Forms.Control.FlatStyle</code> set to <xref:System.Windows.Forms.FlatStyle.System?displayProperty=nameWithType>, which is the default style, now use OS-defined colors in High Contrast theme when selected.</span></span> <span data-ttu-id="de465-150">以前，文本和背景色已不对比，且难以读取。</span><span class="sxs-lookup"><span data-stu-id="de465-150">Previously, text and background colors were not contrasting and were hard to read.</span></span></li><li><span data-ttu-id="de465-151"><code>T:System.Windows.Forms.Button</code><code>T:System.Windows.Forms.CheckBox</code>， <code>T:System.Windows.Forms.RadioButton</code>， <code>T:System.Windows.Forms.Label</code>，<code>T:System.Windows.Forms.LinkLabel</code>和<code>T:System.Windows.Forms.GroupBox</code>与<code>P:System.Windows.Forms.Control.Enabled</code>设置为<em>false</em>，使用带的阴影颜色呈现在高对比度主题，从而导致针对低对比度的文本背景。</span><span class="sxs-lookup"><span data-stu-id="de465-151"><code>T:System.Windows.Forms.Button</code>, <code>T:System.Windows.Forms.CheckBox</code>, <code>T:System.Windows.Forms.RadioButton</code>, <code>T:System.Windows.Forms.Label</code>, <code>T:System.Windows.Forms.LinkLabel</code> and <code>T:System.Windows.Forms.GroupBox</code> with<code>P:System.Windows.Forms.Control.Enabled</code> set to <em>false</em>, used a shaded color to render text in High Contrast themes, resulting in low contrast against the background.</span></span> <span data-ttu-id="de465-152">现在，这些控件使用&quot;禁用文本&quot;由操作系统定义的颜色。</span><span class="sxs-lookup"><span data-stu-id="de465-152">Now these controls use &quot;Disabled Text&quot; color defined by the OS.</span></span> <span data-ttu-id="de465-153">此修补程序适用于使用的控件<code>P:System.Windows.Forms.Control.FlatStyle</code>属性设置为值非<code>F:System.Windows.Forms.FlatStyle.System</code>。</span><span class="sxs-lookup"><span data-stu-id="de465-153">This fix applies to controls with <code>P:System.Windows.Forms.Control.FlatStyle</code> property set to a value other than <code>F:System.Windows.Forms.FlatStyle.System</code>.</span></span> <span data-ttu-id="de465-154">后一种控件呈现操作系统。</span><span class="sxs-lookup"><span data-stu-id="de465-154">The latter controls are rendered by the OS.</span></span></li><li><span data-ttu-id="de465-155"><code>T:System.Windows.Forms.DataGridView</code> 现在呈现当前具有焦点的单元格内容周围可见矩形。</span><span class="sxs-lookup"><span data-stu-id="de465-155"><code>T:System.Windows.Forms.DataGridView</code> now renders a visible rectangle around the content of the cell which has the current focus.</span></span> <span data-ttu-id="de465-156">以前，这不是在某些高对比度主题中可见的。</span><span class="sxs-lookup"><span data-stu-id="de465-156">Previously, this was not visible in certain High Contrast themes.</span></span></li><li><span data-ttu-id="de465-157"><code>T:System.Windows.Forms.ToolStripMenuItem</code> 控制与<code>P:System.Windows.Forms.ToolStripItem.Enabled</code>属性设置为<em>false</em>现在使用&quot;禁用文本&quot;由操作系统定义的颜色。</span><span class="sxs-lookup"><span data-stu-id="de465-157"><code>T:System.Windows.Forms.ToolStripMenuItem</code> controls with a <code>P:System.Windows.Forms.ToolStripItem.Enabled</code> property set to <em>false</em> now use the &quot;Disabled Text&quot; color defined by the OS.</span></span></li><li><span data-ttu-id="de465-158"><code>T:System.Windows.Forms.ToolStripMenuItem</code> 控制与<code>P:System.Windows.Forms.ToolStripItem.Checked</code>属性设置为<em>true</em>现在呈现关联的复选标记以对比系统颜色。</span><span class="sxs-lookup"><span data-stu-id="de465-158"><code>T:System.Windows.Forms.ToolStripMenuItem</code> controls with a <code>P:System.Windows.Forms.ToolStripItem.Checked</code> property set to <em>true</em> now render the associated check mark in a contrasting system color.</span></span>  <span data-ttu-id="de465-159">以前的复选标记颜色已不对比足够和在高对比度主题中不可见。</span><span class="sxs-lookup"><span data-stu-id="de465-159">Previously the check mark color was not contrasting enough and not visible in High Contrast themes.</span></span></li></ul><span data-ttu-id="de465-160">注意： windows 10 已更改一些高对比度系统颜色的值。</span><span class="sxs-lookup"><span data-stu-id="de465-160">NOTE: Windows10 has changed values for some high contrast system colors.</span></span> <span data-ttu-id="de465-161">Windows 窗体框架基于 Win32 framework。</span><span class="sxs-lookup"><span data-stu-id="de465-161">Windows Forms Framework is based on the Win32 framework.</span></span> <span data-ttu-id="de465-162">为获得最佳体验，最新版本的 Windows 上运行并选择加入到最新的操作系统更改，通过在测试应用程序中添加应用程序清单文件并取消注释以下代码：</span><span class="sxs-lookup"><span data-stu-id="de465-162">For the best experience, run on the latest version of Windows and opt in to the latest OS changes by adding an app.manifest file in a test application and uncommenting the following code:</span></span><pre><code>&lt;!-- Windows 10 --&gt;&#13;&#10;&lt;supportedOS Id=&quot;{8e0f7a12-bfb3-4fe8-b9a5-48fd50a15a9a}&quot; /&gt;&#13;&#10;</code></pre><span data-ttu-id="de465-163"><strong>改进的键盘导航</strong></span><span class="sxs-lookup"><span data-stu-id="de465-163"><strong>Improved keyboard navigation</strong></span></span><ul><li><span data-ttu-id="de465-164">当<code>T:System.Windows.Forms.ComboBox</code>控件具有<code>P:System.Windows.Forms.ComboBox.DropDownStyle</code>设置为<code>F:System.Windows.Forms.DropDownStyle.DropDownList</code>且在窗体上排序的选项卡中的第一个控件使用键盘打开父窗体时，它会立即显示聚焦框。</span><span class="sxs-lookup"><span data-stu-id="de465-164">When a <code>T:System.Windows.Forms.ComboBox</code> control has <code>P:System.Windows.Forms.ComboBox.DropDownStyle</code> set to <code>F:System.Windows.Forms.DropDownStyle.DropDownList</code> and is the first control in the tab order on the form, it now displays a focus rectangle when the parent form is opened using the keyboard.</span></span> <span data-ttu-id="de465-165">在此更改之前键盘焦点在控件中，但不是呈现焦点指示器。</span><span class="sxs-lookup"><span data-stu-id="de465-165">Before this change, keyboard focus was on this control, but a focus indicator was not rendered.</span></span></li></ul><span data-ttu-id="de465-166"><strong>改进了讲述人支持</strong></span><span class="sxs-lookup"><span data-stu-id="de465-166"><strong>Improved Narrator support</strong></span></span><ul><li><span data-ttu-id="de465-167"><code>T:System.Windows.Forms.MonthCalendar</code>控件已添加对辅助技术，以访问控件，包括讲述人时以前无法阅读该控件的值的功能的支持。</span><span class="sxs-lookup"><span data-stu-id="de465-167">The <code>T:System.Windows.Forms.MonthCalendar</code> control has added support for assistive technologies to access the control, including the ability for Narrator to read the value of the control when previously it could not.</span></span></li><li><span data-ttu-id="de465-168"><code>T:System.Windows.Forms.CheckedListBox</code>控件现在通知讲述人时<code>P:System.Windows.Forms.CheckState</code>属性已更改。</span><span class="sxs-lookup"><span data-stu-id="de465-168">The <code>T:System.Windows.Forms.CheckedListBox</code> control now notifies Narrator when the <code>P:System.Windows.Forms.CheckState</code> property has been changed.</span></span> <span data-ttu-id="de465-169">以前，讲述人未收到通知，因此用户就会通知，<code>P:System.Windows.Forms.CheckState</code>已更新。</span><span class="sxs-lookup"><span data-stu-id="de465-169">Previously, Narrator did not recieve notification and as a result users would not be informed that the <code>P:System.Windows.Forms.CheckState</code> had been updated.</span></span></li><li><span data-ttu-id="de465-170"><code>T:System.Windows.Forms.LinkLabel</code>控制已更改其通知控件中的文本的讲述人的方式。</span><span class="sxs-lookup"><span data-stu-id="de465-170">The <code>T:System.Windows.Forms.LinkLabel</code> control has changed the way it notifies Narrator of the text of in the control.</span></span> <span data-ttu-id="de465-171">以前，讲述人两次宣布此文本和读取&quot; &amp; &quot;符号为实际的文本，即使它们不是对用户可见。</span><span class="sxs-lookup"><span data-stu-id="de465-171">Previously, Narrator announced this text twice and read &quot;&amp;&quot; symbols as real text even though they are not visible to a user.</span></span> <span data-ttu-id="de465-172">重复的文本已从讲述人公告，移除以及不必要&quot; &amp; &quot;符号。</span><span class="sxs-lookup"><span data-stu-id="de465-172">The duplicated text was removed from the Narrator announcements, as well as unnecessary &quot;&amp;&quot; symbols.</span></span></li><li><span data-ttu-id="de465-173"><code>T:System.Windows.Forms.DataGridViewCell</code>控件现在类型正确报表只读状态设置为讲述人和其他辅助技术。</span><span class="sxs-lookup"><span data-stu-id="de465-173">The <code>T:System.Windows.Forms.DataGridViewCell</code> control types now correctly report the read-only status to Narrator and other assistive technologies.</span></span></li><li><span data-ttu-id="de465-174">讲述人现在是否能够读取系统菜单中的子窗口[多文档界面](~/docs/framework/winforms/advanced/multiple-document-interface-mdi-applications.md)应用程序。</span><span class="sxs-lookup"><span data-stu-id="de465-174">Narrator is now able to read the System Menu of child windows in [Multiple-Document Interface](~/docs/framework/winforms/advanced/multiple-document-interface-mdi-applications.md) applications.</span></span></li><li><span data-ttu-id="de465-175">讲述人现在是否能够读取<code>T:System.Windows.Forms.ToolStripMenuItem</code>控制与<code>P:System.Windows.Forms.ToolStripItem.Enabled</code>属性设置为<em>false</em>。</span><span class="sxs-lookup"><span data-stu-id="de465-175">Narrator is now able to read <code>T:System.Windows.Forms.ToolStripMenuItem</code> controls with a <code>P:System.Windows.Forms.ToolStripItem.Enabled</code> property set to <em>false</em>.</span></span> <span data-ttu-id="de465-176">以前，讲述人是无法专注于已禁用的菜单项来读取内容。</span><span class="sxs-lookup"><span data-stu-id="de465-176">Previously, Narrator was unable to focus on disabled menu items to read hte content.</span></span></li></ul>|
|<span data-ttu-id="de465-177">范围</span><span class="sxs-lookup"><span data-stu-id="de465-177">Scope</span></span>|<span data-ttu-id="de465-178">主要</span><span class="sxs-lookup"><span data-stu-id="de465-178">Major</span></span>|
|<span data-ttu-id="de465-179">版本</span><span class="sxs-lookup"><span data-stu-id="de465-179">Version</span></span>|<span data-ttu-id="de465-180">4.7.1</span><span class="sxs-lookup"><span data-stu-id="de465-180">4.7.1</span></span>|
|<span data-ttu-id="de465-181">类型</span><span class="sxs-lookup"><span data-stu-id="de465-181">Type</span></span>|<span data-ttu-id="de465-182">重定目标</span><span class="sxs-lookup"><span data-stu-id="de465-182">Retargeting</span></span>|
|<span data-ttu-id="de465-183">受影响的 API</span><span class="sxs-lookup"><span data-stu-id="de465-183">Affected APIs</span></span>|<ul><li><xref:System.Windows.Forms.ToolStripDropDownButton.CreateAccessibilityInstance?displayProperty=nameWithType></li><li><xref:System.Windows.Forms.DomainUpDown.DomainUpDownAccessibleObject.Name?displayProperty=nameWithType></li><li>[<span data-ttu-id="de465-184">MonthCalendar.AccessibilityObject</span><span class="sxs-lookup"><span data-stu-id="de465-184">MonthCalendar.AccessibilityObject</span></span>](xref:System.Windows.Forms.Control.AccessibilityObject)</li></ul>|

