<Type Name="RegistryProxy" FullName="Microsoft.VisualBasic.MyServices.RegistryProxy">
  <Metadata><Meta Name="ms.openlocfilehash" Value="b2782e231f7e871bb563a95ced6e98693888e030" /><Meta Name="ms.sourcegitcommit" Value="95e24aee1283af2f120fc5da4b0bdc0712ab698f" /><Meta Name="ms.translationtype" Value="MT" /><Meta Name="ms.contentlocale" Value="zh-CN" /><Meta Name="ms.lasthandoff" Value="05/06/2019" /><Meta Name="ms.locfileid" Value="65135758" /></Metadata><TypeSignature Language="C#" Value="public class RegistryProxy" />
  <TypeSignature Language="ILAsm" Value=".class public auto ansi RegistryProxy extends System.Object" />
  <TypeSignature Language="DocId" Value="T:Microsoft.VisualBasic.MyServices.RegistryProxy" />
  <TypeSignature Language="VB.NET" Value="Public Class RegistryProxy" />
  <TypeSignature Language="C++ CLI" Value="public ref class RegistryProxy" />
  <TypeSignature Language="F#" Value="type RegistryProxy = class" />
  <AssemblyInfo>
    <AssemblyName>Microsoft.VisualBasic</AssemblyName>
    <AssemblyVersion>8.0.0.0</AssemblyVersion>
    <AssemblyVersion>10.0.0.0</AssemblyVersion>
  </AssemblyInfo>
  <AssemblyInfo>
    <AssemblyName>Microsoft.VisualBasic.Core</AssemblyName>
    <AssemblyVersion>10.0.4.0</AssemblyVersion>
  </AssemblyInfo>
  <Base>
    <BaseTypeName>System.Object</BaseTypeName>
  </Base>
  <Interfaces />
  <Attributes>
    <Attribute>
      <AttributeName>System.ComponentModel.EditorBrowsable(System.ComponentModel.EditorBrowsableState.Never)</AttributeName>
    </Attribute>
  </Attributes>
  <Docs>
    <summary><span data-ttu-id="1ecb0-101">提供了用于操控注册表的属性和方法。</span><span class="sxs-lookup"><span data-stu-id="1ecb0-101">Provides properties and methods for manipulating the registry.</span></span></summary>
    <remarks>
      <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="1ecb0-102">若要使用这些属性，必须具有读取和写入权限从<xref:System.Security.Permissions.RegistryPermissionAccess>枚举。</span><span class="sxs-lookup"><span data-stu-id="1ecb0-102">To use these properties, you must have Read and Write permission from the <xref:System.Security.Permissions.RegistryPermissionAccess> enumeration.</span></span> <span data-ttu-id="1ecb0-103">以完全信任级别运行的任何代码 （在默认的安全策略，这是安装在用户的本地硬盘上的任何代码） 具有访问注册表的必要权限。</span><span class="sxs-lookup"><span data-stu-id="1ecb0-103">Any code running with full trust (under the default security policy, this is any code installed on the user's local hard drive) has the necessary permissions to access the registry.</span></span> <span data-ttu-id="1ecb0-104">有关更多信息，请参见 <xref:System.Security.Permissions.RegistryPermission> 类。</span><span class="sxs-lookup"><span data-stu-id="1ecb0-104">For more information, see the <xref:System.Security.Permissions.RegistryPermission> class.</span></span>  
  
 <span data-ttu-id="1ecb0-105">下表列出了所涉及的任务的示例`My.Computer.Registry`对象。</span><span class="sxs-lookup"><span data-stu-id="1ecb0-105">The following table lists examples of tasks involving the `My.Computer.Registry` object.</span></span>  
  
|<span data-ttu-id="1ecb0-106">功能</span><span class="sxs-lookup"><span data-stu-id="1ecb0-106">To</span></span>|<span data-ttu-id="1ecb0-107">查看</span><span class="sxs-lookup"><span data-stu-id="1ecb0-107">See</span></span>|  
|--------|---------|  
|<span data-ttu-id="1ecb0-108">创建注册表项并将其值设置</span><span class="sxs-lookup"><span data-stu-id="1ecb0-108">Create a registry key and set its value</span></span>|[<span data-ttu-id="1ecb0-109">如何：创建注册表项并将其值设置</span><span class="sxs-lookup"><span data-stu-id="1ecb0-109">How to: Create a Registry Key and Set Its Value</span></span>](~/docs/visual-basic/developing-apps/programming/computer-resources/how-to-create-a-registry-key-and-set-its-value.md)|  
|<span data-ttu-id="1ecb0-110">删除注册表项</span><span class="sxs-lookup"><span data-stu-id="1ecb0-110">Delete a registry key</span></span>|[<span data-ttu-id="1ecb0-111">如何：删除注册表项</span><span class="sxs-lookup"><span data-stu-id="1ecb0-111">How to: Delete a Registry Key</span></span>](~/docs/visual-basic/developing-apps/programming/computer-resources/how-to-delete-a-registry-key.md)|  
|<span data-ttu-id="1ecb0-112">从注册表中读取数据</span><span class="sxs-lookup"><span data-stu-id="1ecb0-112">Read data from the registry</span></span>|[<span data-ttu-id="1ecb0-113">如何：从注册表项读取值</span><span class="sxs-lookup"><span data-stu-id="1ecb0-113">How to: Read a Value from a Registry Key</span></span>](~/docs/visual-basic/developing-apps/programming/computer-resources/how-to-read-a-value-from-a-registry-key.md)|  
  
   
  
## Examples  
 <span data-ttu-id="1ecb0-114">此示例读取值`Name`从`HKEY_CURRENT_USER\Software\MyApp`并将其显示在消息框中。</span><span class="sxs-lookup"><span data-stu-id="1ecb0-114">This example reads the value `Name` from `HKEY_CURRENT_USER\Software\MyApp` and displays it in a message box.</span></span>  
  
 [!code-vb[VbVbalrMyRegistry#8](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbalrMyRegistry/VB/Class1.vb#8)]  
  
 ]]></format>
    </remarks>
    <altmember cref="T:Microsoft.Win32.Registry" />
    <related type="Article" href="~/docs/visual-basic/language-reference/objects/index.md"><span data-ttu-id="1ecb0-115">对象 (Visual Basic)</span><span class="sxs-lookup"><span data-stu-id="1ecb0-115">Objects (Visual Basic)</span></span></related>
    <related type="Article" href="~/docs/visual-basic/developing-apps/programming/computer-resources/reading-from-and-writing-to-the-registry.md"><span data-ttu-id="1ecb0-116">读取和写入注册表 (Visual Basic)</span><span class="sxs-lookup"><span data-stu-id="1ecb0-116">Reading from and Writing to the Registry (Visual Basic)</span></span></related>
  </Docs>
  <Members>
    <Member MemberName="ClassesRoot">
      <MemberSignature Language="C#" Value="public Microsoft.Win32.RegistryKey ClassesRoot { get; }" />
      <MemberSignature Language="ILAsm" Value=".property instance class Microsoft.Win32.RegistryKey ClassesRoot" />
      <MemberSignature Language="DocId" Value="P:Microsoft.VisualBasic.MyServices.RegistryProxy.ClassesRoot" />
      <MemberSignature Language="VB.NET" Value="Public ReadOnly Property ClassesRoot As RegistryKey" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; property Microsoft::Win32::RegistryKey ^ ClassesRoot { Microsoft::Win32::RegistryKey ^ get(); };" />
      <MemberSignature Language="F#" Value="member this.ClassesRoot : Microsoft.Win32.RegistryKey" Usage="Microsoft.VisualBasic.MyServices.RegistryProxy.ClassesRoot" />
      <MemberType>Property</MemberType>
      <AssemblyInfo>
        <AssemblyName>Microsoft.VisualBasic</AssemblyName>
        <AssemblyVersion>8.0.0.0</AssemblyVersion>
        <AssemblyVersion>10.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <AssemblyInfo>
        <AssemblyName>Microsoft.VisualBasic.Core</AssemblyName>
      </AssemblyInfo>
      <Attributes>
        <Attribute FrameworkAlternate="netframework-4.0">
          <AttributeName>get: System.Runtime.TargetedPatchingOptOut("Performance critical to inline this type of method across NGen image boundaries")</AttributeName>
        </Attribute>
      </Attributes>
      <ReturnValue>
        <ReturnType>Microsoft.Win32.RegistryKey</ReturnType>
      </ReturnValue>
      <Docs>
        <summary><span data-ttu-id="1ecb0-117">返回<see cref="T:Microsoft.Win32.RegistryKey" />类型提供了访问权<see langword="HKEY_CLASSES_ROOT" />。</span><span class="sxs-lookup"><span data-stu-id="1ecb0-117">Returns a <see cref="T:Microsoft.Win32.RegistryKey" /> type which provides access to <see langword="HKEY_CLASSES_ROOT" />.</span></span></summary>
        <value><see cref="T:Microsoft.Win32.RegistryKey" /></value>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="1ecb0-118">`HKEY_CLASSES_ROOT` 主要用于在 Windows 中存储有关文件关联的信息。</span><span class="sxs-lookup"><span data-stu-id="1ecb0-118">`HKEY_CLASSES_ROOT` is primarily used to store information about file associations in Windows.</span></span>  
  
 <span data-ttu-id="1ecb0-119"><xref:System.Security.Permissions.RegistryPermission>类，该类是在<xref:System.Security.Permissions>命名空间，控制对注册表变量的访问。</span><span class="sxs-lookup"><span data-stu-id="1ecb0-119">The <xref:System.Security.Permissions.RegistryPermission> class, which is in the <xref:System.Security.Permissions> namespace, controls access to registry variables.</span></span> <span data-ttu-id="1ecb0-120">不应将注册表变量存储在某些内存位置，在这些位置，不具有 <xref:System.Security.Permissions.RegistryPermission> 的代码可访问这些变量。</span><span class="sxs-lookup"><span data-stu-id="1ecb0-120">Registry variables should not be stored in memory locations where code without <xref:System.Security.Permissions.RegistryPermission> can access them.</span></span> <span data-ttu-id="1ecb0-121">同样，授予权限时，授予顺利完成工作所需的这些权限。</span><span class="sxs-lookup"><span data-stu-id="1ecb0-121">Similarly, when granting permissions, grant only those privileges necessary to get the job done.</span></span>  
  
 <span data-ttu-id="1ecb0-122">通过 <xref:System.Security.Permissions.RegistryPermissionAccess> 枚举定义注册表权限访问值。</span><span class="sxs-lookup"><span data-stu-id="1ecb0-122">Registry permission access values are defined by the <xref:System.Security.Permissions.RegistryPermissionAccess> enumeration.</span></span> <span data-ttu-id="1ecb0-123">下表详细说明了其成员。</span><span class="sxs-lookup"><span data-stu-id="1ecb0-123">The following table details its members.</span></span>  
  
|<span data-ttu-id="1ecb0-124">值</span><span class="sxs-lookup"><span data-stu-id="1ecb0-124">Value</span></span>|<span data-ttu-id="1ecb0-125">描述</span><span class="sxs-lookup"><span data-stu-id="1ecb0-125">Description</span></span>|  
|-----------|-----------------|  
|<span data-ttu-id="1ecb0-126">AllAccess</span><span class="sxs-lookup"><span data-stu-id="1ecb0-126">AllAccess</span></span>|<span data-ttu-id="1ecb0-127">创建、 读取和写入访问权限，对注册表变量。</span><span class="sxs-lookup"><span data-stu-id="1ecb0-127">Create, read, and write access to registry variables.</span></span>|  
|<span data-ttu-id="1ecb0-128">创建</span><span class="sxs-lookup"><span data-stu-id="1ecb0-128">Create</span></span>|<span data-ttu-id="1ecb0-129">创建对注册表变量的访问。</span><span class="sxs-lookup"><span data-stu-id="1ecb0-129">Create access to registry variables.</span></span>|  
|<span data-ttu-id="1ecb0-130">NoAccess</span><span class="sxs-lookup"><span data-stu-id="1ecb0-130">NoAccess</span></span>|<span data-ttu-id="1ecb0-131">没有对注册表变量的访问权限。</span><span class="sxs-lookup"><span data-stu-id="1ecb0-131">No access to registry variables.</span></span>|  
|<span data-ttu-id="1ecb0-132">读取</span><span class="sxs-lookup"><span data-stu-id="1ecb0-132">Read</span></span>|<span data-ttu-id="1ecb0-133">对注册表变量进行读取访问。</span><span class="sxs-lookup"><span data-stu-id="1ecb0-133">Read access to registry variables.</span></span>|  
|<span data-ttu-id="1ecb0-134">Write</span><span class="sxs-lookup"><span data-stu-id="1ecb0-134">Write</span></span>|<span data-ttu-id="1ecb0-135">对注册表变量的写访问。</span><span class="sxs-lookup"><span data-stu-id="1ecb0-135">Write access to registry variables.</span></span>|  
  
 <span data-ttu-id="1ecb0-136">下表列出了所涉及的任务的示例`My.Computer.Registry`对象。</span><span class="sxs-lookup"><span data-stu-id="1ecb0-136">The following table lists examples of tasks involving the `My.Computer.Registry` object.</span></span>  
  
|<span data-ttu-id="1ecb0-137">功能</span><span class="sxs-lookup"><span data-stu-id="1ecb0-137">To</span></span>|<span data-ttu-id="1ecb0-138">查看</span><span class="sxs-lookup"><span data-stu-id="1ecb0-138">See</span></span>|  
|--------|---------|  
|<span data-ttu-id="1ecb0-139">创建注册表项并将其值设置</span><span class="sxs-lookup"><span data-stu-id="1ecb0-139">Create a registry key and set its value</span></span>|[<span data-ttu-id="1ecb0-140">如何：创建注册表项并将其值设置</span><span class="sxs-lookup"><span data-stu-id="1ecb0-140">How to: Create a Registry Key and Set Its Value</span></span>](~/docs/visual-basic/developing-apps/programming/computer-resources/how-to-create-a-registry-key-and-set-its-value.md)|  
|<span data-ttu-id="1ecb0-141">删除注册表项</span><span class="sxs-lookup"><span data-stu-id="1ecb0-141">Delete a registry key</span></span>|[<span data-ttu-id="1ecb0-142">如何：删除注册表项</span><span class="sxs-lookup"><span data-stu-id="1ecb0-142">How to: Delete a Registry Key</span></span>](~/docs/visual-basic/developing-apps/programming/computer-resources/how-to-delete-a-registry-key.md)|  
|<span data-ttu-id="1ecb0-143">从注册表项读取值</span><span class="sxs-lookup"><span data-stu-id="1ecb0-143">Read a value from a registry key</span></span>|[<span data-ttu-id="1ecb0-144">如何：从注册表项读取值</span><span class="sxs-lookup"><span data-stu-id="1ecb0-144">How to: Read a Value from a Registry Key</span></span>](~/docs/visual-basic/developing-apps/programming/computer-resources/how-to-read-a-value-from-a-registry-key.md)|  
  
   
  
## Examples  
 <span data-ttu-id="1ecb0-145">此示例将获取名称的子项`ClassesRoot`注册表项并将它们添加到`ListBox1`。</span><span class="sxs-lookup"><span data-stu-id="1ecb0-145">This example gets the names of the subkeys for the `ClassesRoot` registry key and adds them to `ListBox1`.</span></span>  
  
 [!code-vb[VbVbalrMyRegistry#10](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbalrMyRegistry/VB/Class1.vb#10)]  
  
 <span data-ttu-id="1ecb0-146">此示例要求具有`ListBox`名为`ListBox1`在项目中。</span><span class="sxs-lookup"><span data-stu-id="1ecb0-146">This example requires that you have a `ListBox` named `ListBox1` in your project.</span></span>  
  
 ]]></format>
        </remarks>
        <altmember cref="T:Microsoft.Win32.RegistryKey" />
        <altmember cref="F:Microsoft.Win32.Registry.ClassesRoot" />
        <related type="Article" href="~/docs/visual-basic/language-reference/objects/index.md"><span data-ttu-id="1ecb0-147">对象 (Visual Basic)</span><span class="sxs-lookup"><span data-stu-id="1ecb0-147">Objects (Visual Basic)</span></span></related>
        <related type="Article" href="~/docs/visual-basic/developing-apps/programming/computer-resources/reading-from-and-writing-to-the-registry.md"><span data-ttu-id="1ecb0-148">读取和写入注册表 (Visual Basic)</span><span class="sxs-lookup"><span data-stu-id="1ecb0-148">Reading from and Writing to the Registry (Visual Basic)</span></span></related>
        <related type="Article" href="https://msdn.microsoft.com/library/9980aff7-2f69-492b-8f66-29a9a76d3df5"><span data-ttu-id="1ecb0-149">安全性与注册表</span><span class="sxs-lookup"><span data-stu-id="1ecb0-149">Security and the Registry</span></span></related>
      </Docs>
    </Member>
    <Member MemberName="CurrentConfig">
      <MemberSignature Language="C#" Value="public Microsoft.Win32.RegistryKey CurrentConfig { get; }" />
      <MemberSignature Language="ILAsm" Value=".property instance class Microsoft.Win32.RegistryKey CurrentConfig" />
      <MemberSignature Language="DocId" Value="P:Microsoft.VisualBasic.MyServices.RegistryProxy.CurrentConfig" />
      <MemberSignature Language="VB.NET" Value="Public ReadOnly Property CurrentConfig As RegistryKey" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; property Microsoft::Win32::RegistryKey ^ CurrentConfig { Microsoft::Win32::RegistryKey ^ get(); };" />
      <MemberSignature Language="F#" Value="member this.CurrentConfig : Microsoft.Win32.RegistryKey" Usage="Microsoft.VisualBasic.MyServices.RegistryProxy.CurrentConfig" />
      <MemberType>Property</MemberType>
      <AssemblyInfo>
        <AssemblyName>Microsoft.VisualBasic</AssemblyName>
        <AssemblyVersion>8.0.0.0</AssemblyVersion>
        <AssemblyVersion>10.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <AssemblyInfo>
        <AssemblyName>Microsoft.VisualBasic.Core</AssemblyName>
      </AssemblyInfo>
      <Attributes>
        <Attribute FrameworkAlternate="netframework-4.0">
          <AttributeName>get: System.Runtime.TargetedPatchingOptOut("Performance critical to inline this type of method across NGen image boundaries")</AttributeName>
        </Attribute>
      </Attributes>
      <ReturnValue>
        <ReturnType>Microsoft.Win32.RegistryKey</ReturnType>
      </ReturnValue>
      <Docs>
        <summary><span data-ttu-id="1ecb0-150">返回<see cref="T:Microsoft.Win32.RegistryKey" />类型提供了访问权<see langword="HKEY_CURRENT_CONFIG" />。</span><span class="sxs-lookup"><span data-stu-id="1ecb0-150">Returns a <see cref="T:Microsoft.Win32.RegistryKey" /> type which provides access to <see langword="HKEY_CURRENT_CONFIG" />.</span></span></summary>
        <value><see cref="T:Microsoft.Win32.RegistryKey" /></value>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="1ecb0-151">`HKEY_CURRENT_CONFIG` 主要用于在计算机上存储的设备的设置。</span><span class="sxs-lookup"><span data-stu-id="1ecb0-151">`HKEY_CURRENT_CONFIG` is primarily used to store settings for devices on the computer.</span></span>  
  
 <span data-ttu-id="1ecb0-152"><xref:System.Security.Permissions.RegistryPermission>类，该类是在<xref:System.Security.Permissions>命名空间，控制对注册表变量的访问。</span><span class="sxs-lookup"><span data-stu-id="1ecb0-152">The <xref:System.Security.Permissions.RegistryPermission> class, which is in the <xref:System.Security.Permissions> namespace, controls access to registry variables.</span></span> <span data-ttu-id="1ecb0-153">不应将注册表变量存储在某些内存位置，在这些位置，不具有 <xref:System.Security.Permissions.RegistryPermission> 的代码可访问这些变量。</span><span class="sxs-lookup"><span data-stu-id="1ecb0-153">Registry variables should not be stored in memory locations where code without <xref:System.Security.Permissions.RegistryPermission> can access them.</span></span> <span data-ttu-id="1ecb0-154">同样，授予权限时，授予顺利完成工作所需的这些权限。</span><span class="sxs-lookup"><span data-stu-id="1ecb0-154">Similarly, when granting permissions, grant only those privileges necessary to get the job done.</span></span>  
  
 <span data-ttu-id="1ecb0-155">通过 <xref:System.Security.Permissions.RegistryPermissionAccess> 枚举定义注册表权限访问值。</span><span class="sxs-lookup"><span data-stu-id="1ecb0-155">Registry permission access values are defined by the <xref:System.Security.Permissions.RegistryPermissionAccess> enumeration.</span></span> <span data-ttu-id="1ecb0-156">下表详细说明了其成员。</span><span class="sxs-lookup"><span data-stu-id="1ecb0-156">The following table details its members.</span></span>  
  
|<span data-ttu-id="1ecb0-157">值</span><span class="sxs-lookup"><span data-stu-id="1ecb0-157">Value</span></span>|<span data-ttu-id="1ecb0-158">描述</span><span class="sxs-lookup"><span data-stu-id="1ecb0-158">Description</span></span>|  
|-----------|-----------------|  
|<span data-ttu-id="1ecb0-159">AllAccess</span><span class="sxs-lookup"><span data-stu-id="1ecb0-159">AllAccess</span></span>|<span data-ttu-id="1ecb0-160">创建、 读取和写入访问权限，对注册表变量。</span><span class="sxs-lookup"><span data-stu-id="1ecb0-160">Create, read, and write access to registry variables.</span></span>|  
|<span data-ttu-id="1ecb0-161">创建</span><span class="sxs-lookup"><span data-stu-id="1ecb0-161">Create</span></span>|<span data-ttu-id="1ecb0-162">创建对注册表变量的访问。</span><span class="sxs-lookup"><span data-stu-id="1ecb0-162">Create access to registry variables.</span></span>|  
|<span data-ttu-id="1ecb0-163">NoAccess</span><span class="sxs-lookup"><span data-stu-id="1ecb0-163">NoAccess</span></span>|<span data-ttu-id="1ecb0-164">没有对注册表变量的访问权限。</span><span class="sxs-lookup"><span data-stu-id="1ecb0-164">No access to registry variables.</span></span>|  
|<span data-ttu-id="1ecb0-165">读取</span><span class="sxs-lookup"><span data-stu-id="1ecb0-165">Read</span></span>|<span data-ttu-id="1ecb0-166">对注册表变量进行读取访问。</span><span class="sxs-lookup"><span data-stu-id="1ecb0-166">Read access to registry variables.</span></span>|  
|<span data-ttu-id="1ecb0-167">Write</span><span class="sxs-lookup"><span data-stu-id="1ecb0-167">Write</span></span>|<span data-ttu-id="1ecb0-168">对注册表变量的写访问。</span><span class="sxs-lookup"><span data-stu-id="1ecb0-168">Write access to registry variables.</span></span>|  
  
 <span data-ttu-id="1ecb0-169">下表列出了所涉及的任务的示例`My.Computer.Registry`对象。</span><span class="sxs-lookup"><span data-stu-id="1ecb0-169">The following table lists examples of tasks involving the `My.Computer.Registry` object.</span></span>  
  
|<span data-ttu-id="1ecb0-170">功能</span><span class="sxs-lookup"><span data-stu-id="1ecb0-170">To</span></span>|<span data-ttu-id="1ecb0-171">查看</span><span class="sxs-lookup"><span data-stu-id="1ecb0-171">See</span></span>|  
|--------|---------|  
|<span data-ttu-id="1ecb0-172">创建注册表项并将其值设置</span><span class="sxs-lookup"><span data-stu-id="1ecb0-172">Create a registry key and set its value</span></span>|[<span data-ttu-id="1ecb0-173">如何：创建注册表项并将其值设置</span><span class="sxs-lookup"><span data-stu-id="1ecb0-173">How to: Create a Registry Key and Set Its Value</span></span>](~/docs/visual-basic/developing-apps/programming/computer-resources/how-to-create-a-registry-key-and-set-its-value.md)|  
|<span data-ttu-id="1ecb0-174">删除注册表项</span><span class="sxs-lookup"><span data-stu-id="1ecb0-174">Delete a registry key</span></span>|[<span data-ttu-id="1ecb0-175">如何：删除注册表项</span><span class="sxs-lookup"><span data-stu-id="1ecb0-175">How to: Delete a Registry Key</span></span>](~/docs/visual-basic/developing-apps/programming/computer-resources/how-to-delete-a-registry-key.md)|  
|<span data-ttu-id="1ecb0-176">从注册表项读取值</span><span class="sxs-lookup"><span data-stu-id="1ecb0-176">Read a value from a registry key</span></span>|[<span data-ttu-id="1ecb0-177">如何：从注册表项读取值</span><span class="sxs-lookup"><span data-stu-id="1ecb0-177">How to: Read a Value from a Registry Key</span></span>](~/docs/visual-basic/developing-apps/programming/computer-resources/how-to-read-a-value-from-a-registry-key.md)|  
  
   
  
## Examples  
 <span data-ttu-id="1ecb0-178">此示例将创建该子项`MyDeviceSettings`。</span><span class="sxs-lookup"><span data-stu-id="1ecb0-178">This example creates the subkey `MyDeviceSettings`.</span></span>  
  
 [!code-vb[VbVbalrMyRegistry#5](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbalrMyRegistry/VB/Class1.vb#5)]  
  
 ]]></format>
        </remarks>
        <altmember cref="T:Microsoft.Win32.RegistryKey" />
        <altmember cref="F:Microsoft.Win32.Registry.CurrentConfig" />
        <related type="Article" href="~/docs/visual-basic/language-reference/objects/index.md"><span data-ttu-id="1ecb0-179">对象 (Visual Basic)</span><span class="sxs-lookup"><span data-stu-id="1ecb0-179">Objects (Visual Basic)</span></span></related>
        <related type="Article" href="~/docs/visual-basic/developing-apps/programming/computer-resources/reading-from-and-writing-to-the-registry.md"><span data-ttu-id="1ecb0-180">读取和写入注册表 (Visual Basic)</span><span class="sxs-lookup"><span data-stu-id="1ecb0-180">Reading from and Writing to the Registry (Visual Basic)</span></span></related>
        <related type="Article" href="https://msdn.microsoft.com/library/9980aff7-2f69-492b-8f66-29a9a76d3df5"><span data-ttu-id="1ecb0-181">安全性与注册表</span><span class="sxs-lookup"><span data-stu-id="1ecb0-181">Security and the Registry</span></span></related>
      </Docs>
    </Member>
    <Member MemberName="CurrentUser">
      <MemberSignature Language="C#" Value="public Microsoft.Win32.RegistryKey CurrentUser { get; }" />
      <MemberSignature Language="ILAsm" Value=".property instance class Microsoft.Win32.RegistryKey CurrentUser" />
      <MemberSignature Language="DocId" Value="P:Microsoft.VisualBasic.MyServices.RegistryProxy.CurrentUser" />
      <MemberSignature Language="VB.NET" Value="Public ReadOnly Property CurrentUser As RegistryKey" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; property Microsoft::Win32::RegistryKey ^ CurrentUser { Microsoft::Win32::RegistryKey ^ get(); };" />
      <MemberSignature Language="F#" Value="member this.CurrentUser : Microsoft.Win32.RegistryKey" Usage="Microsoft.VisualBasic.MyServices.RegistryProxy.CurrentUser" />
      <MemberType>Property</MemberType>
      <AssemblyInfo>
        <AssemblyName>Microsoft.VisualBasic</AssemblyName>
        <AssemblyVersion>8.0.0.0</AssemblyVersion>
        <AssemblyVersion>10.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <AssemblyInfo>
        <AssemblyName>Microsoft.VisualBasic.Core</AssemblyName>
      </AssemblyInfo>
      <Attributes>
        <Attribute FrameworkAlternate="netframework-4.0">
          <AttributeName>get: System.Runtime.TargetedPatchingOptOut("Performance critical to inline this type of method across NGen image boundaries")</AttributeName>
        </Attribute>
      </Attributes>
      <ReturnValue>
        <ReturnType>Microsoft.Win32.RegistryKey</ReturnType>
      </ReturnValue>
      <Docs>
        <summary><span data-ttu-id="1ecb0-182">返回<see cref="T:Microsoft.Win32.RegistryKey" />类型提供了访问权<see langword="HKEY_CURRENT_USER" />。</span><span class="sxs-lookup"><span data-stu-id="1ecb0-182">Returns a <see cref="T:Microsoft.Win32.RegistryKey" /> type which provides access to <see langword="HKEY_CURRENT_USER" />.</span></span></summary>
        <value><see cref="T:Microsoft.Win32.RegistryKey" /></value>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="1ecb0-183">`HKEY_CURRENT_USER` 主要用于在 Windows 中存储每个用户设置，如颜色和字体。</span><span class="sxs-lookup"><span data-stu-id="1ecb0-183">`HKEY_CURRENT_USER` is primarily used to store per-user settings, such as colors and fonts, in Windows.</span></span> <span data-ttu-id="1ecb0-184">密钥因用户而异。</span><span class="sxs-lookup"><span data-stu-id="1ecb0-184">The key differ according to the user.</span></span>  
  
 <span data-ttu-id="1ecb0-185"><xref:System.Security.Permissions.RegistryPermission>类，该类是在<xref:System.Security.Permissions>命名空间，控制对注册表变量的访问。</span><span class="sxs-lookup"><span data-stu-id="1ecb0-185">The <xref:System.Security.Permissions.RegistryPermission> class, which is in the <xref:System.Security.Permissions> namespace, controls access to registry variables.</span></span> <span data-ttu-id="1ecb0-186">不应将注册表变量存储在某些内存位置，在这些位置，不具有 <xref:System.Security.Permissions.RegistryPermission> 的代码可访问这些变量。</span><span class="sxs-lookup"><span data-stu-id="1ecb0-186">Registry variables should not be stored in memory locations where code without <xref:System.Security.Permissions.RegistryPermission> can access them.</span></span> <span data-ttu-id="1ecb0-187">同样，授予权限时，授予顺利完成工作所需的最少权限。</span><span class="sxs-lookup"><span data-stu-id="1ecb0-187">Similarly, when granting permissions, grant the fewest privileges necessary to get the job done.</span></span>  
  
 <span data-ttu-id="1ecb0-188">通过 <xref:System.Security.Permissions.RegistryPermissionAccess> 枚举定义注册表权限访问值。</span><span class="sxs-lookup"><span data-stu-id="1ecb0-188">Registry permission access values are defined by the <xref:System.Security.Permissions.RegistryPermissionAccess> enumeration.</span></span> <span data-ttu-id="1ecb0-189">下表详细说明了其成员。</span><span class="sxs-lookup"><span data-stu-id="1ecb0-189">The following table details its members.</span></span>  
  
|<span data-ttu-id="1ecb0-190">值</span><span class="sxs-lookup"><span data-stu-id="1ecb0-190">Value</span></span>|<span data-ttu-id="1ecb0-191">描述</span><span class="sxs-lookup"><span data-stu-id="1ecb0-191">Description</span></span>|  
|-----------|-----------------|  
|<span data-ttu-id="1ecb0-192">AllAccess</span><span class="sxs-lookup"><span data-stu-id="1ecb0-192">AllAccess</span></span>|<span data-ttu-id="1ecb0-193">创建、 读取和写入访问权限，对注册表变量。</span><span class="sxs-lookup"><span data-stu-id="1ecb0-193">Create, read, and write access to registry variables.</span></span>|  
|<span data-ttu-id="1ecb0-194">创建</span><span class="sxs-lookup"><span data-stu-id="1ecb0-194">Create</span></span>|<span data-ttu-id="1ecb0-195">创建对注册表变量的访问。</span><span class="sxs-lookup"><span data-stu-id="1ecb0-195">Create access to registry variables.</span></span>|  
|<span data-ttu-id="1ecb0-196">NoAccess</span><span class="sxs-lookup"><span data-stu-id="1ecb0-196">NoAccess</span></span>|<span data-ttu-id="1ecb0-197">没有对注册表变量的访问权限。</span><span class="sxs-lookup"><span data-stu-id="1ecb0-197">No access to registry variables.</span></span>|  
|<span data-ttu-id="1ecb0-198">读取</span><span class="sxs-lookup"><span data-stu-id="1ecb0-198">Read</span></span>|<span data-ttu-id="1ecb0-199">对注册表变量进行读取访问。</span><span class="sxs-lookup"><span data-stu-id="1ecb0-199">Read access to registry variables.</span></span>|  
|<span data-ttu-id="1ecb0-200">Write</span><span class="sxs-lookup"><span data-stu-id="1ecb0-200">Write</span></span>|<span data-ttu-id="1ecb0-201">对注册表变量的写访问。</span><span class="sxs-lookup"><span data-stu-id="1ecb0-201">Write access to registry variables.</span></span>|  
  
 <span data-ttu-id="1ecb0-202">下表列出了所涉及的任务的示例`My.Computer.Registry`对象。</span><span class="sxs-lookup"><span data-stu-id="1ecb0-202">The following table lists examples of tasks involving the `My.Computer.Registry` object.</span></span>  
  
|<span data-ttu-id="1ecb0-203">功能</span><span class="sxs-lookup"><span data-stu-id="1ecb0-203">To</span></span>|<span data-ttu-id="1ecb0-204">查看</span><span class="sxs-lookup"><span data-stu-id="1ecb0-204">See</span></span>|  
|--------|---------|  
|<span data-ttu-id="1ecb0-205">创建注册表项并将其值设置</span><span class="sxs-lookup"><span data-stu-id="1ecb0-205">Create a registry key and set its value</span></span>|[<span data-ttu-id="1ecb0-206">如何：创建注册表项并将其值设置</span><span class="sxs-lookup"><span data-stu-id="1ecb0-206">How to: Create a Registry Key and Set Its Value</span></span>](~/docs/visual-basic/developing-apps/programming/computer-resources/how-to-create-a-registry-key-and-set-its-value.md)|  
|<span data-ttu-id="1ecb0-207">删除注册表项</span><span class="sxs-lookup"><span data-stu-id="1ecb0-207">Delete a registry key</span></span>|[<span data-ttu-id="1ecb0-208">如何：删除注册表项</span><span class="sxs-lookup"><span data-stu-id="1ecb0-208">How to: Delete a Registry Key</span></span>](~/docs/visual-basic/developing-apps/programming/computer-resources/how-to-delete-a-registry-key.md)|  
|<span data-ttu-id="1ecb0-209">从注册表项读取值</span><span class="sxs-lookup"><span data-stu-id="1ecb0-209">Read a value from a registry key</span></span>|[<span data-ttu-id="1ecb0-210">如何：从注册表项读取值</span><span class="sxs-lookup"><span data-stu-id="1ecb0-210">How to: Read a Value from a Registry Key</span></span>](~/docs/visual-basic/developing-apps/programming/computer-resources/how-to-read-a-value-from-a-registry-key.md)|  
  
   
  
## Examples  
 <span data-ttu-id="1ecb0-211">此示例将删除子项`Software\MyCompany\Preferences\UserData`。</span><span class="sxs-lookup"><span data-stu-id="1ecb0-211">This example deletes the subkey `Software\MyCompany\Preferences\UserData`.</span></span>  
  
 [!code-vb[VbVbalrMyRegistry#2](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbalrMyRegistry/VB/Class1.vb#2)]  
  
 ]]></format>
        </remarks>
        <altmember cref="T:Microsoft.Win32.RegistryKey" />
        <altmember cref="F:Microsoft.Win32.Registry.CurrentUser" />
        <related type="Article" href="~/docs/visual-basic/language-reference/objects/index.md"><span data-ttu-id="1ecb0-212">对象 (Visual Basic)</span><span class="sxs-lookup"><span data-stu-id="1ecb0-212">Objects (Visual Basic)</span></span></related>
        <related type="Article" href="~/docs/visual-basic/developing-apps/programming/computer-resources/reading-from-and-writing-to-the-registry.md"><span data-ttu-id="1ecb0-213">读取和写入注册表 (Visual Basic)</span><span class="sxs-lookup"><span data-stu-id="1ecb0-213">Reading from and Writing to the Registry (Visual Basic)</span></span></related>
        <related type="Article" href="https://msdn.microsoft.com/library/9980aff7-2f69-492b-8f66-29a9a76d3df5"><span data-ttu-id="1ecb0-214">安全性与注册表</span><span class="sxs-lookup"><span data-stu-id="1ecb0-214">Security and the Registry</span></span></related>
      </Docs>
    </Member>
    <Member MemberName="DynData">
      <MemberSignature Language="C#" Value="public Microsoft.Win32.RegistryKey DynData { get; }" />
      <MemberSignature Language="ILAsm" Value=".property instance class Microsoft.Win32.RegistryKey DynData" />
      <MemberSignature Language="DocId" Value="P:Microsoft.VisualBasic.MyServices.RegistryProxy.DynData" />
      <MemberSignature Language="VB.NET" Value="Public ReadOnly Property DynData As RegistryKey" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; property Microsoft::Win32::RegistryKey ^ DynData { Microsoft::Win32::RegistryKey ^ get(); };" />
      <MemberSignature Language="F#" Value="member this.DynData : Microsoft.Win32.RegistryKey" Usage="Microsoft.VisualBasic.MyServices.RegistryProxy.DynData" />
      <MemberType>Property</MemberType>
      <AssemblyInfo>
        <AssemblyName>Microsoft.VisualBasic</AssemblyName>
        <AssemblyVersion>8.0.0.0</AssemblyVersion>
        <AssemblyVersion>10.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <AssemblyInfo>
        <AssemblyName>Microsoft.VisualBasic.Core</AssemblyName>
      </AssemblyInfo>
      <Attributes>
        <Attribute FrameworkAlternate="netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;netframework-4.8">
          <AttributeName>System.Obsolete("The DynData registry key works only on Win9x, which is not supported by this version of the .NET Framework.  Use the PerformanceData registry key instead.  This property will be removed from a future version of the framework.")</AttributeName>
        </Attribute>
      </Attributes>
      <ReturnValue>
        <ReturnType>Microsoft.Win32.RegistryKey</ReturnType>
      </ReturnValue>
      <Docs>
        <summary><span data-ttu-id="1ecb0-215">返回<see cref="T:Microsoft.Win32.RegistryKey" />类型，它提供对访问<see langword="HKEY_DYNDATA" />。</span><span class="sxs-lookup"><span data-stu-id="1ecb0-215">Returns a <see cref="T:Microsoft.Win32.RegistryKey" /> type, which provides access to <see langword="HKEY_DYNDATA" />.</span></span></summary>
        <value><see cref="T:Microsoft.Win32.RegistryKey" /></value>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="1ecb0-216">`HKEY_DYNDATA` 用于存储动态注册表数据，如虚拟设备驱动程序使用的并且仅在 Windows 95/98 系统上受支持。</span><span class="sxs-lookup"><span data-stu-id="1ecb0-216">`HKEY_DYNDATA` is used to store dynamic registry data, such as that used by Virtual Device Drivers and is supported only on Windows 95/98 systems.</span></span> <span data-ttu-id="1ecb0-217">在 Windows 95/98 系统上调用任何方法返回的键`Registry.DynData`，如`CreateSubKey`， `DeleteSubKey`， `GetSubKeyCount`，`GetValueCount`等，将引发<xref:System.IO.IOException>。</span><span class="sxs-lookup"><span data-stu-id="1ecb0-217">On non-Windows 95/98 systems, calling any methods of the key returned by `Registry.DynData`, such as `CreateSubKey`, `DeleteSubKey`, `GetSubKeyCount`, `GetValueCount`, etc., will throw a <xref:System.IO.IOException>.</span></span>  
  
 <span data-ttu-id="1ecb0-218"><xref:System.Security.Permissions.RegistryPermission>类，该类是在<xref:System.Security.Permissions>命名空间，控制对注册表变量的访问。</span><span class="sxs-lookup"><span data-stu-id="1ecb0-218">The <xref:System.Security.Permissions.RegistryPermission> class, which is in the <xref:System.Security.Permissions> namespace, controls access to registry variables.</span></span> <span data-ttu-id="1ecb0-219">不应将注册表变量存储在某些内存位置，在这些位置，不具有 <xref:System.Security.Permissions.RegistryPermission> 的代码可访问这些变量。</span><span class="sxs-lookup"><span data-stu-id="1ecb0-219">Registry variables should not be stored in memory locations where code without <xref:System.Security.Permissions.RegistryPermission> can access them.</span></span> <span data-ttu-id="1ecb0-220">同样，授予权限时，授予顺利完成工作所需的最少权限。</span><span class="sxs-lookup"><span data-stu-id="1ecb0-220">Similarly, when granting permissions, grant the fewest privileges necessary to get the job done.</span></span>  
  
 <span data-ttu-id="1ecb0-221">通过 <xref:System.Security.Permissions.RegistryPermissionAccess> 枚举定义注册表权限访问值。</span><span class="sxs-lookup"><span data-stu-id="1ecb0-221">Registry permission access values are defined by the <xref:System.Security.Permissions.RegistryPermissionAccess> enumeration.</span></span> <span data-ttu-id="1ecb0-222">下表详细说明了其成员。</span><span class="sxs-lookup"><span data-stu-id="1ecb0-222">The following table details its members.</span></span>  
  
|<span data-ttu-id="1ecb0-223">值</span><span class="sxs-lookup"><span data-stu-id="1ecb0-223">Value</span></span>|<span data-ttu-id="1ecb0-224">描述</span><span class="sxs-lookup"><span data-stu-id="1ecb0-224">Description</span></span>|  
|-----------|-----------------|  
|<span data-ttu-id="1ecb0-225">AllAccess</span><span class="sxs-lookup"><span data-stu-id="1ecb0-225">AllAccess</span></span>|<span data-ttu-id="1ecb0-226">创建、 读取和写入访问权限，对注册表变量。</span><span class="sxs-lookup"><span data-stu-id="1ecb0-226">Create, read, and write access to registry variables.</span></span>|  
|<span data-ttu-id="1ecb0-227">创建</span><span class="sxs-lookup"><span data-stu-id="1ecb0-227">Create</span></span>|<span data-ttu-id="1ecb0-228">创建对注册表变量的访问。</span><span class="sxs-lookup"><span data-stu-id="1ecb0-228">Create access to registry variables.</span></span>|  
|<span data-ttu-id="1ecb0-229">NoAccess</span><span class="sxs-lookup"><span data-stu-id="1ecb0-229">NoAccess</span></span>|<span data-ttu-id="1ecb0-230">没有对注册表变量的访问权限。</span><span class="sxs-lookup"><span data-stu-id="1ecb0-230">No access to registry variables.</span></span>|  
|<span data-ttu-id="1ecb0-231">读取</span><span class="sxs-lookup"><span data-stu-id="1ecb0-231">Read</span></span>|<span data-ttu-id="1ecb0-232">对注册表变量进行读取访问。</span><span class="sxs-lookup"><span data-stu-id="1ecb0-232">Read access to registry variables.</span></span>|  
|<span data-ttu-id="1ecb0-233">Write</span><span class="sxs-lookup"><span data-stu-id="1ecb0-233">Write</span></span>|<span data-ttu-id="1ecb0-234">对注册表变量的写访问。</span><span class="sxs-lookup"><span data-stu-id="1ecb0-234">Write access to registry variables.</span></span>|  
  
 <span data-ttu-id="1ecb0-235">下表列出了所涉及的任务的示例`My.Computer.Registry`对象。</span><span class="sxs-lookup"><span data-stu-id="1ecb0-235">The following table lists examples of tasks involving the `My.Computer.Registry` object.</span></span>  
  
|<span data-ttu-id="1ecb0-236">功能</span><span class="sxs-lookup"><span data-stu-id="1ecb0-236">To</span></span>|<span data-ttu-id="1ecb0-237">查看</span><span class="sxs-lookup"><span data-stu-id="1ecb0-237">See</span></span>|  
|--------|---------|  
|<span data-ttu-id="1ecb0-238">创建注册表项并将其值设置</span><span class="sxs-lookup"><span data-stu-id="1ecb0-238">Create a registry key and set its value</span></span>|[<span data-ttu-id="1ecb0-239">如何：创建注册表项并将其值设置</span><span class="sxs-lookup"><span data-stu-id="1ecb0-239">How to: Create a Registry Key and Set Its Value</span></span>](~/docs/visual-basic/developing-apps/programming/computer-resources/how-to-create-a-registry-key-and-set-its-value.md)|  
|<span data-ttu-id="1ecb0-240">删除注册表项</span><span class="sxs-lookup"><span data-stu-id="1ecb0-240">Delete a registry key</span></span>|[<span data-ttu-id="1ecb0-241">如何：删除注册表项</span><span class="sxs-lookup"><span data-stu-id="1ecb0-241">How to: Delete a Registry Key</span></span>](~/docs/visual-basic/developing-apps/programming/computer-resources/how-to-delete-a-registry-key.md)|  
|<span data-ttu-id="1ecb0-242">从注册表项读取值</span><span class="sxs-lookup"><span data-stu-id="1ecb0-242">Read a value from a registry key</span></span>|[<span data-ttu-id="1ecb0-243">如何：从注册表项读取值</span><span class="sxs-lookup"><span data-stu-id="1ecb0-243">How to: Read a Value from a Registry Key</span></span>](~/docs/visual-basic/developing-apps/programming/computer-resources/how-to-read-a-value-from-a-registry-key.md)|  
  
   
  
## Examples  
 <span data-ttu-id="1ecb0-244">此示例将删除子项树`Software\MyCompany\Preferences`。</span><span class="sxs-lookup"><span data-stu-id="1ecb0-244">This example deletes the subkey tree `Software\MyCompany\Preferences`.</span></span>  
  
 [!code-vb[VbVbalrMyRegistry#1](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbalrMyRegistry/VB/Class1.vb#1)]  
  
 ]]></format>
        </remarks>
        <altmember cref="T:Microsoft.Win32.RegistryKey" />
        <altmember cref="F:Microsoft.Win32.Registry.DynData" />
        <related type="Article" href="~/docs/visual-basic/language-reference/objects/index.md"><span data-ttu-id="1ecb0-245">对象 (Visual Basic)</span><span class="sxs-lookup"><span data-stu-id="1ecb0-245">Objects (Visual Basic)</span></span></related>
        <related type="Article" href="~/docs/visual-basic/developing-apps/programming/computer-resources/reading-from-and-writing-to-the-registry.md"><span data-ttu-id="1ecb0-246">读取和写入注册表 (Visual Basic)</span><span class="sxs-lookup"><span data-stu-id="1ecb0-246">Reading from and Writing to the Registry (Visual Basic)</span></span></related>
        <related type="Article" href="https://msdn.microsoft.com/library/9980aff7-2f69-492b-8f66-29a9a76d3df5"><span data-ttu-id="1ecb0-247">安全性与注册表</span><span class="sxs-lookup"><span data-stu-id="1ecb0-247">Security and the Registry</span></span></related>
      </Docs>
    </Member>
    <Member MemberName="GetValue">
      <MemberSignature Language="C#" Value="public object GetValue (string keyName, string valueName, object defaultValue);" />
      <MemberSignature Language="ILAsm" Value=".method public instance object GetValue(string keyName, string valueName, object defaultValue) cil managed" />
      <MemberSignature Language="DocId" Value="M:Microsoft.VisualBasic.MyServices.RegistryProxy.GetValue(System.String,System.String,System.Object)" />
      <MemberSignature Language="VB.NET" Value="Public Function GetValue (keyName As String, valueName As String, defaultValue As Object) As Object" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; System::Object ^ GetValue(System::String ^ keyName, System::String ^ valueName, System::Object ^ defaultValue);" />
      <MemberSignature Language="F#" Value="member this.GetValue : string * string * obj -&gt; obj" Usage="registryProxy.GetValue (keyName, valueName, defaultValue)" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>Microsoft.VisualBasic</AssemblyName>
        <AssemblyVersion>8.0.0.0</AssemblyVersion>
        <AssemblyVersion>10.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <AssemblyInfo>
        <AssemblyName>Microsoft.VisualBasic.Core</AssemblyName>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Object</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="keyName" Type="System.String" Index="0" FrameworkAlternate="netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;netframework-4.8" />
        <Parameter Name="valueName" Type="System.String" Index="1" FrameworkAlternate="netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;netframework-4.8" />
        <Parameter Name="defaultValue" Type="System.Object" Index="2" FrameworkAlternate="netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;netframework-4.8" />
      </Parameters>
      <Docs>
        <param name="keyName"><span data-ttu-id="1ecb0-248"><see langword="String" />。</span><span class="sxs-lookup"><span data-stu-id="1ecb0-248"><see langword="String" />.</span></span> <span data-ttu-id="1ecb0-249">是要从中检索值的键。</span><span class="sxs-lookup"><span data-stu-id="1ecb0-249">Key from which the value is to be retrieved.</span></span> <span data-ttu-id="1ecb0-250">必需。</span><span class="sxs-lookup"><span data-stu-id="1ecb0-250">Required.</span></span></param>
        <param name="valueName"><span data-ttu-id="1ecb0-251"><see langword="String" />。</span><span class="sxs-lookup"><span data-stu-id="1ecb0-251"><see langword="String" />.</span></span> <span data-ttu-id="1ecb0-252">要检索的值。</span><span class="sxs-lookup"><span data-stu-id="1ecb0-252">Value to be retrieved.</span></span> <span data-ttu-id="1ecb0-253">必需。</span><span class="sxs-lookup"><span data-stu-id="1ecb0-253">Required.</span></span></param>
        <param name="defaultValue"><span data-ttu-id="1ecb0-254"><see langword="Object" />。</span><span class="sxs-lookup"><span data-stu-id="1ecb0-254"><see langword="Object" />.</span></span> <span data-ttu-id="1ecb0-255">如果值不存在提供的默认值。</span><span class="sxs-lookup"><span data-stu-id="1ecb0-255">Default value to be supplied if the value does not exist.</span></span> <span data-ttu-id="1ecb0-256">必需。</span><span class="sxs-lookup"><span data-stu-id="1ecb0-256">Required.</span></span></param>
        <summary><span data-ttu-id="1ecb0-257">从注册表项中获取一个值。</span><span class="sxs-lookup"><span data-stu-id="1ecb0-257">Gets a value from a registry key.</span></span></summary>
        <returns><span data-ttu-id="1ecb0-258">从注册表项中获取一个值。</span><span class="sxs-lookup"><span data-stu-id="1ecb0-258">Gets a value from a registry key.</span></span></returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="1ecb0-259">`valueName` 不区分大小写。</span><span class="sxs-lookup"><span data-stu-id="1ecb0-259">`valueName` is not case-sensitive.</span></span>  
  
 <span data-ttu-id="1ecb0-260">注册表项可以包含一个不与任何名称相关联的值。</span><span class="sxs-lookup"><span data-stu-id="1ecb0-260">A registry key can contain one value that is not associated with any name.</span></span> <span data-ttu-id="1ecb0-261">在注册表编辑器中显示此未命名的值时，而不是名称将显示字符串"(Default)"。</span><span class="sxs-lookup"><span data-stu-id="1ecb0-261">When this unnamed value is displayed in the registry editor, the string "(Default)" appears instead of a name.</span></span> <span data-ttu-id="1ecb0-262">若要检索此未命名的值，指定 null 或空字符串 ("") 为`valueName`。</span><span class="sxs-lookup"><span data-stu-id="1ecb0-262">To retrieve this unnamed value, specify either null or the empty string ("") for `valueName`.</span></span>  
  
 <span data-ttu-id="1ecb0-263">下表列出了所涉及的任务的示例`GetValue`方法。</span><span class="sxs-lookup"><span data-stu-id="1ecb0-263">The following table lists examples of tasks involving the `GetValue` method.</span></span>  
  
|<span data-ttu-id="1ecb0-264">功能</span><span class="sxs-lookup"><span data-stu-id="1ecb0-264">To</span></span>|<span data-ttu-id="1ecb0-265">查看</span><span class="sxs-lookup"><span data-stu-id="1ecb0-265">See</span></span>|  
|--------|---------|  
|<span data-ttu-id="1ecb0-266">从注册表项读取值</span><span class="sxs-lookup"><span data-stu-id="1ecb0-266">Read a value from a registry key</span></span>|[<span data-ttu-id="1ecb0-267">如何：从注册表项读取值</span><span class="sxs-lookup"><span data-stu-id="1ecb0-267">How to: Read a Value from a Registry Key</span></span>](~/docs/visual-basic/developing-apps/programming/computer-resources/how-to-read-a-value-from-a-registry-key.md)|  
  
   
  
## Examples  
 <span data-ttu-id="1ecb0-268">此示例读取值`Name`从`HKEY_CURRENT_USER\Software\MyApp`并将其显示`MessageBox`。</span><span class="sxs-lookup"><span data-stu-id="1ecb0-268">This example reads the value `Name` from `HKEY_CURRENT_USER\Software\MyApp` and displays it in a `MessageBox`.</span></span>  
  
 [!code-vb[VbVbalrMyRegistry#9](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbalrMyRegistry/VB/Class1.vb#9)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.Security.SecurityException"><span data-ttu-id="1ecb0-269">用户没有读取注册表项中所需的权限。</span><span class="sxs-lookup"><span data-stu-id="1ecb0-269">The user does not have the permissions required to read from the registry key.</span></span></exception>
        <exception cref="T:System.IO.IOException"><span data-ttu-id="1ecb0-270"><see cref="T:Microsoft.Win32.RegistryKey" />包含指定值已标记为删除。</span><span class="sxs-lookup"><span data-stu-id="1ecb0-270">The <see cref="T:Microsoft.Win32.RegistryKey" /> that contains the specified value has been marked for deletion.</span></span></exception>
        <exception cref="T:System.ArgumentException"><span data-ttu-id="1ecb0-271"><paramref name="keyName" /> 不以有效注册表根开头。</span><span class="sxs-lookup"><span data-stu-id="1ecb0-271"><paramref name="keyName" /> does not begin with a valid registry root.</span></span></exception>
        <permission cref="T:System.Security.Permissions.RegistryPermission"><span data-ttu-id="1ecb0-272">若要从注册表中读取。</span><span class="sxs-lookup"><span data-stu-id="1ecb0-272">to read from the registry.</span></span> <span data-ttu-id="1ecb0-273">关联的枚举： <see cref="F:System.Security.Permissions.RegistryPermissionAccess.Read" /></span><span class="sxs-lookup"><span data-stu-id="1ecb0-273">Associated enumeration: <see cref="F:System.Security.Permissions.RegistryPermissionAccess.Read" /></span></span></permission>
        <permission cref="T:System.Security.Permissions.EnvironmentPermission"><span data-ttu-id="1ecb0-274">若要读取注册表项的类型 REG_EXPAND_SZ。</span><span class="sxs-lookup"><span data-stu-id="1ecb0-274">to read a registry key of type REG_EXPAND_SZ.</span></span> <span data-ttu-id="1ecb0-275">关联的枚举： <see cref="F:System.Security.Permissions.PermissionState.Unrestricted" /></span><span class="sxs-lookup"><span data-stu-id="1ecb0-275">Associated enumeration: <see cref="F:System.Security.Permissions.PermissionState.Unrestricted" /></span></span></permission>
        <related type="Article" href="~/docs/visual-basic/language-reference/objects/index.md"><span data-ttu-id="1ecb0-276">对象 (Visual Basic)</span><span class="sxs-lookup"><span data-stu-id="1ecb0-276">Objects (Visual Basic)</span></span></related>
        <related type="Article" href="~/docs/visual-basic/developing-apps/programming/computer-resources/reading-from-and-writing-to-the-registry.md"><span data-ttu-id="1ecb0-277">读取和写入注册表 (Visual Basic)</span><span class="sxs-lookup"><span data-stu-id="1ecb0-277">Reading from and Writing to the Registry (Visual Basic)</span></span></related>
        <related type="Article" href="https://msdn.microsoft.com/library/9980aff7-2f69-492b-8f66-29a9a76d3df5"><span data-ttu-id="1ecb0-278">安全性与注册表</span><span class="sxs-lookup"><span data-stu-id="1ecb0-278">Security and the Registry</span></span></related>
      </Docs>
    </Member>
    <Member MemberName="LocalMachine">
      <MemberSignature Language="C#" Value="public Microsoft.Win32.RegistryKey LocalMachine { get; }" />
      <MemberSignature Language="ILAsm" Value=".property instance class Microsoft.Win32.RegistryKey LocalMachine" />
      <MemberSignature Language="DocId" Value="P:Microsoft.VisualBasic.MyServices.RegistryProxy.LocalMachine" />
      <MemberSignature Language="VB.NET" Value="Public ReadOnly Property LocalMachine As RegistryKey" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; property Microsoft::Win32::RegistryKey ^ LocalMachine { Microsoft::Win32::RegistryKey ^ get(); };" />
      <MemberSignature Language="F#" Value="member this.LocalMachine : Microsoft.Win32.RegistryKey" Usage="Microsoft.VisualBasic.MyServices.RegistryProxy.LocalMachine" />
      <MemberType>Property</MemberType>
      <AssemblyInfo>
        <AssemblyName>Microsoft.VisualBasic</AssemblyName>
        <AssemblyVersion>8.0.0.0</AssemblyVersion>
        <AssemblyVersion>10.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <AssemblyInfo>
        <AssemblyName>Microsoft.VisualBasic.Core</AssemblyName>
      </AssemblyInfo>
      <Attributes>
        <Attribute FrameworkAlternate="netframework-4.0">
          <AttributeName>get: System.Runtime.TargetedPatchingOptOut("Performance critical to inline this type of method across NGen image boundaries")</AttributeName>
        </Attribute>
      </Attributes>
      <ReturnValue>
        <ReturnType>Microsoft.Win32.RegistryKey</ReturnType>
      </ReturnValue>
      <Docs>
        <summary><span data-ttu-id="1ecb0-279">返回<see cref="T:Microsoft.Win32.RegistryKey" />类型，它提供对访问<see langword="HKEY_LOCAL_MACHINE" />。</span><span class="sxs-lookup"><span data-stu-id="1ecb0-279">Returns a <see cref="T:Microsoft.Win32.RegistryKey" /> type, which provides access to <see langword="HKEY_LOCAL_MACHINE" />.</span></span></summary>
        <value><see cref="T:Microsoft.Win32.RegistryKey" /></value>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="1ecb0-280">`HKEY_LOCAL_MACHINE` 通常用于存储在 Windows 中不改变用户的设置。</span><span class="sxs-lookup"><span data-stu-id="1ecb0-280">`HKEY_LOCAL_MACHINE` is usually used to store settings that do not vary from user to user in Windows.</span></span> <span data-ttu-id="1ecb0-281">计算机的所有用户都共享此密钥。</span><span class="sxs-lookup"><span data-stu-id="1ecb0-281">All users of the computer share this key.</span></span> <span data-ttu-id="1ecb0-282">其五个子项 (`Hardware`， `SAM`， `Security`， `Software`，和`System`) 保存在本地计算机的配置数据。</span><span class="sxs-lookup"><span data-stu-id="1ecb0-282">Its five subkeys (`Hardware`, `SAM`, `Security`, `Software`, and `System`) hold configuration data for the local machine.</span></span>  
  
 <span data-ttu-id="1ecb0-283"><xref:System.Security.Permissions.RegistryPermission>类，该类是在<xref:System.Security.Permissions>命名空间，控制对注册表变量的访问。</span><span class="sxs-lookup"><span data-stu-id="1ecb0-283">The <xref:System.Security.Permissions.RegistryPermission> class, which is in the <xref:System.Security.Permissions> namespace, controls access to registry variables.</span></span> <span data-ttu-id="1ecb0-284">不应将注册表变量存储在某些内存位置，在这些位置，不具有 <xref:System.Security.Permissions.RegistryPermission> 的代码可访问这些变量。</span><span class="sxs-lookup"><span data-stu-id="1ecb0-284">Registry variables should not be stored in memory locations where code without <xref:System.Security.Permissions.RegistryPermission> can access them.</span></span> <span data-ttu-id="1ecb0-285">同样，授予权限时，授予顺利完成工作所需的最少权限。</span><span class="sxs-lookup"><span data-stu-id="1ecb0-285">Similarly, when granting permissions, grant the fewest privileges necessary to get the job done.</span></span>  
  
 <span data-ttu-id="1ecb0-286">通过 <xref:System.Security.Permissions.RegistryPermissionAccess> 枚举定义注册表权限访问值。</span><span class="sxs-lookup"><span data-stu-id="1ecb0-286">Registry permission access values are defined by the <xref:System.Security.Permissions.RegistryPermissionAccess> enumeration.</span></span> <span data-ttu-id="1ecb0-287">下表详细说明了其成员。</span><span class="sxs-lookup"><span data-stu-id="1ecb0-287">The following table details its members.</span></span>  
  
|<span data-ttu-id="1ecb0-288">值</span><span class="sxs-lookup"><span data-stu-id="1ecb0-288">Value</span></span>|<span data-ttu-id="1ecb0-289">描述</span><span class="sxs-lookup"><span data-stu-id="1ecb0-289">Description</span></span>|  
|-----------|-----------------|  
|<span data-ttu-id="1ecb0-290">AllAccess</span><span class="sxs-lookup"><span data-stu-id="1ecb0-290">AllAccess</span></span>|<span data-ttu-id="1ecb0-291">创建、 读取和写入访问权限，对注册表变量。</span><span class="sxs-lookup"><span data-stu-id="1ecb0-291">Create, read, and write access to registry variables.</span></span>|  
|<span data-ttu-id="1ecb0-292">创建</span><span class="sxs-lookup"><span data-stu-id="1ecb0-292">Create</span></span>|<span data-ttu-id="1ecb0-293">创建对注册表变量的访问。</span><span class="sxs-lookup"><span data-stu-id="1ecb0-293">Create access to registry variables.</span></span>|  
|<span data-ttu-id="1ecb0-294">NoAccess</span><span class="sxs-lookup"><span data-stu-id="1ecb0-294">NoAccess</span></span>|<span data-ttu-id="1ecb0-295">没有对注册表变量的访问权限。</span><span class="sxs-lookup"><span data-stu-id="1ecb0-295">No access to registry variables.</span></span>|  
|<span data-ttu-id="1ecb0-296">读取</span><span class="sxs-lookup"><span data-stu-id="1ecb0-296">Read</span></span>|<span data-ttu-id="1ecb0-297">对注册表变量进行读取访问。</span><span class="sxs-lookup"><span data-stu-id="1ecb0-297">Read access to registry variables.</span></span>|  
|<span data-ttu-id="1ecb0-298">Write</span><span class="sxs-lookup"><span data-stu-id="1ecb0-298">Write</span></span>|<span data-ttu-id="1ecb0-299">对注册表变量的写访问。</span><span class="sxs-lookup"><span data-stu-id="1ecb0-299">Write access to registry variables.</span></span>|  
  
 <span data-ttu-id="1ecb0-300">下表列出了所涉及的任务的示例`My.Computer.Registry`对象。</span><span class="sxs-lookup"><span data-stu-id="1ecb0-300">The following table lists examples of tasks involving the `My.Computer.Registry` object.</span></span>  
  
|<span data-ttu-id="1ecb0-301">功能</span><span class="sxs-lookup"><span data-stu-id="1ecb0-301">To</span></span>|<span data-ttu-id="1ecb0-302">查看</span><span class="sxs-lookup"><span data-stu-id="1ecb0-302">See</span></span>|  
|--------|---------|  
|<span data-ttu-id="1ecb0-303">创建注册表项并将其值设置</span><span class="sxs-lookup"><span data-stu-id="1ecb0-303">Create a registry key and set its value</span></span>|[<span data-ttu-id="1ecb0-304">如何：创建注册表项并将其值设置</span><span class="sxs-lookup"><span data-stu-id="1ecb0-304">How to: Create a Registry Key and Set Its Value</span></span>](~/docs/visual-basic/developing-apps/programming/computer-resources/how-to-create-a-registry-key-and-set-its-value.md)|  
|<span data-ttu-id="1ecb0-305">删除注册表项</span><span class="sxs-lookup"><span data-stu-id="1ecb0-305">Delete a registry key</span></span>|[<span data-ttu-id="1ecb0-306">如何：删除注册表项</span><span class="sxs-lookup"><span data-stu-id="1ecb0-306">How to: Delete a Registry Key</span></span>](~/docs/visual-basic/developing-apps/programming/computer-resources/how-to-delete-a-registry-key.md)|  
|<span data-ttu-id="1ecb0-307">从注册表项读取值</span><span class="sxs-lookup"><span data-stu-id="1ecb0-307">Read a value from a registry key</span></span>|[<span data-ttu-id="1ecb0-308">如何：从注册表项读取值</span><span class="sxs-lookup"><span data-stu-id="1ecb0-308">How to: Read a Value from a Registry Key</span></span>](~/docs/visual-basic/developing-apps/programming/computer-resources/how-to-read-a-value-from-a-registry-key.md)|  
  
   
  
## Examples  
 <span data-ttu-id="1ecb0-309">此示例中打开的子项`Software\MyCompany\Preferences`并将值设置`FontColor`到`"red"`。</span><span class="sxs-lookup"><span data-stu-id="1ecb0-309">This example opens the subkey `Software\MyCompany\Preferences` and sets the value `FontColor` to `"red"`.</span></span>  
  
 [!code-vb[VbVbalrMyRegistry#3](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbalrMyRegistry/VB/Class1.vb#3)]  
  
 ]]></format>
        </remarks>
        <altmember cref="T:Microsoft.Win32.RegistryKey" />
        <altmember cref="F:Microsoft.Win32.Registry.LocalMachine" />
        <related type="Article" href="~/docs/visual-basic/language-reference/objects/index.md"><span data-ttu-id="1ecb0-310">对象 (Visual Basic)</span><span class="sxs-lookup"><span data-stu-id="1ecb0-310">Objects (Visual Basic)</span></span></related>
        <related type="Article" href="~/docs/visual-basic/developing-apps/programming/computer-resources/reading-from-and-writing-to-the-registry.md"><span data-ttu-id="1ecb0-311">读取和写入注册表 (Visual Basic)</span><span class="sxs-lookup"><span data-stu-id="1ecb0-311">Reading from and Writing to the Registry (Visual Basic)</span></span></related>
        <related type="Article" href="https://msdn.microsoft.com/library/9980aff7-2f69-492b-8f66-29a9a76d3df5"><span data-ttu-id="1ecb0-312">安全性与注册表</span><span class="sxs-lookup"><span data-stu-id="1ecb0-312">Security and the Registry</span></span></related>
      </Docs>
    </Member>
    <Member MemberName="PerformanceData">
      <MemberSignature Language="C#" Value="public Microsoft.Win32.RegistryKey PerformanceData { get; }" />
      <MemberSignature Language="ILAsm" Value=".property instance class Microsoft.Win32.RegistryKey PerformanceData" />
      <MemberSignature Language="DocId" Value="P:Microsoft.VisualBasic.MyServices.RegistryProxy.PerformanceData" />
      <MemberSignature Language="VB.NET" Value="Public ReadOnly Property PerformanceData As RegistryKey" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; property Microsoft::Win32::RegistryKey ^ PerformanceData { Microsoft::Win32::RegistryKey ^ get(); };" />
      <MemberSignature Language="F#" Value="member this.PerformanceData : Microsoft.Win32.RegistryKey" Usage="Microsoft.VisualBasic.MyServices.RegistryProxy.PerformanceData" />
      <MemberType>Property</MemberType>
      <AssemblyInfo>
        <AssemblyName>Microsoft.VisualBasic</AssemblyName>
        <AssemblyVersion>8.0.0.0</AssemblyVersion>
        <AssemblyVersion>10.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <AssemblyInfo>
        <AssemblyName>Microsoft.VisualBasic.Core</AssemblyName>
      </AssemblyInfo>
      <Attributes>
        <Attribute FrameworkAlternate="netframework-4.0">
          <AttributeName>get: System.Runtime.TargetedPatchingOptOut("Performance critical to inline this type of method across NGen image boundaries")</AttributeName>
        </Attribute>
      </Attributes>
      <ReturnValue>
        <ReturnType>Microsoft.Win32.RegistryKey</ReturnType>
      </ReturnValue>
      <Docs>
        <summary><span data-ttu-id="1ecb0-313">返回<see cref="T:Microsoft.Win32.RegistryKey" />类型，它提供对访问<see langword="HKEY_PERFORMANCE_DATA" />。</span><span class="sxs-lookup"><span data-stu-id="1ecb0-313">Returns a <see cref="T:Microsoft.Win32.RegistryKey" /> type, which provides access to <see langword="HKEY_PERFORMANCE_DATA" />.</span></span></summary>
        <value><see cref="T:Microsoft.Win32.RegistryKey" /></value>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="1ecb0-314">`HKEY_PERFORMANCE_DATA` 用于访问软件组件的性能信息。</span><span class="sxs-lookup"><span data-stu-id="1ecb0-314">`HKEY_PERFORMANCE_DATA` is used to access performance information for software components.</span></span> <span data-ttu-id="1ecb0-315">安装和执行时将计数器数据时，每个软件组件创建其对象和计数器的密钥。</span><span class="sxs-lookup"><span data-stu-id="1ecb0-315">Each software component creates keys for its objects and counters when it is installed and writes counter data while it is executing.</span></span> <span data-ttu-id="1ecb0-316">此数据不存储在注册表中，尽管注册表用来对其进行访问。</span><span class="sxs-lookup"><span data-stu-id="1ecb0-316">This data is not stored in the registry, although the registry is used to access it.</span></span> <span data-ttu-id="1ecb0-317">相反，调用通过注册表函数`HKEY_PERFORMANCE_DATA`会导致系统从相应的系统对象管理器收集的数据。</span><span class="sxs-lookup"><span data-stu-id="1ecb0-317">Instead, calling registry functions via `HKEY_PERFORMANCE_DATA` causes the system to collect the data from the appropriate system object managers.</span></span>  
  
 <span data-ttu-id="1ecb0-318">Windows 98 系统; 上不存在此密钥尝试使用调用以外`Name`方法将引发<xref:System.IO.IOException>。</span><span class="sxs-lookup"><span data-stu-id="1ecb0-318">This key does not exist on Windows 98 systems; an attempt to use it other than calling the `Name` method will throw an <xref:System.IO.IOException>.</span></span>  
  
 <span data-ttu-id="1ecb0-319">此密钥通常无法写入到;尝试在其上创建一个子项将引发<xref:System.IO.IOException>。</span><span class="sxs-lookup"><span data-stu-id="1ecb0-319">This key cannot normally be written to; attempting to create a subkey on it will throw an <xref:System.IO.IOException>.</span></span>  
  
 <span data-ttu-id="1ecb0-320"><xref:System.Security.Permissions.RegistryPermission>类，该类是在<xref:System.Security.Permissions>命名空间，控制对注册表变量的访问。</span><span class="sxs-lookup"><span data-stu-id="1ecb0-320">The <xref:System.Security.Permissions.RegistryPermission> class, which is in the <xref:System.Security.Permissions> namespace, controls access to registry variables.</span></span> <span data-ttu-id="1ecb0-321">不应将注册表变量存储在某些内存位置，在这些位置，不具有 <xref:System.Security.Permissions.RegistryPermission> 的代码可访问这些变量。</span><span class="sxs-lookup"><span data-stu-id="1ecb0-321">Registry variables should not be stored in memory locations where code without <xref:System.Security.Permissions.RegistryPermission> can access them.</span></span> <span data-ttu-id="1ecb0-322">同样，授予权限时，授予顺利完成工作所需的最少权限。</span><span class="sxs-lookup"><span data-stu-id="1ecb0-322">Similarly, when granting permissions, grant the fewest privileges necessary to get the job done.</span></span>  
  
 <span data-ttu-id="1ecb0-323">通过 <xref:System.Security.Permissions.RegistryPermissionAccess> 枚举定义注册表权限访问值。</span><span class="sxs-lookup"><span data-stu-id="1ecb0-323">Registry permission access values are defined by the <xref:System.Security.Permissions.RegistryPermissionAccess> enumeration.</span></span> <span data-ttu-id="1ecb0-324">下表详细说明了其成员。</span><span class="sxs-lookup"><span data-stu-id="1ecb0-324">The following table details its members.</span></span>  
  
|<span data-ttu-id="1ecb0-325">值</span><span class="sxs-lookup"><span data-stu-id="1ecb0-325">Value</span></span>|<span data-ttu-id="1ecb0-326">描述</span><span class="sxs-lookup"><span data-stu-id="1ecb0-326">Description</span></span>|  
|-----------|-----------------|  
|<span data-ttu-id="1ecb0-327">AllAccess</span><span class="sxs-lookup"><span data-stu-id="1ecb0-327">AllAccess</span></span>|<span data-ttu-id="1ecb0-328">创建、 读取和写入访问权限，对注册表变量。</span><span class="sxs-lookup"><span data-stu-id="1ecb0-328">Create, read, and write access to registry variables.</span></span>|  
|<span data-ttu-id="1ecb0-329">创建</span><span class="sxs-lookup"><span data-stu-id="1ecb0-329">Create</span></span>|<span data-ttu-id="1ecb0-330">创建对注册表变量的访问。</span><span class="sxs-lookup"><span data-stu-id="1ecb0-330">Create access to registry variables.</span></span>|  
|<span data-ttu-id="1ecb0-331">NoAccess</span><span class="sxs-lookup"><span data-stu-id="1ecb0-331">NoAccess</span></span>|<span data-ttu-id="1ecb0-332">没有对注册表变量的访问权限。</span><span class="sxs-lookup"><span data-stu-id="1ecb0-332">No access to registry variables.</span></span>|  
|<span data-ttu-id="1ecb0-333">读取</span><span class="sxs-lookup"><span data-stu-id="1ecb0-333">Read</span></span>|<span data-ttu-id="1ecb0-334">对注册表变量进行读取访问。</span><span class="sxs-lookup"><span data-stu-id="1ecb0-334">Read access to registry variables.</span></span>|  
|<span data-ttu-id="1ecb0-335">Write</span><span class="sxs-lookup"><span data-stu-id="1ecb0-335">Write</span></span>|<span data-ttu-id="1ecb0-336">对注册表变量的写访问。</span><span class="sxs-lookup"><span data-stu-id="1ecb0-336">Write access to registry variables.</span></span>|  
  
 <span data-ttu-id="1ecb0-337">下表列出了所涉及的任务的示例`My.Computer.Registry`对象。</span><span class="sxs-lookup"><span data-stu-id="1ecb0-337">The following table lists examples of tasks involving the `My.Computer.Registry` object.</span></span>  
  
|<span data-ttu-id="1ecb0-338">功能</span><span class="sxs-lookup"><span data-stu-id="1ecb0-338">To</span></span>|<span data-ttu-id="1ecb0-339">查看</span><span class="sxs-lookup"><span data-stu-id="1ecb0-339">See</span></span>|  
|--------|---------|  
|<span data-ttu-id="1ecb0-340">创建注册表项并将其值设置</span><span class="sxs-lookup"><span data-stu-id="1ecb0-340">Create a registry key and set its value</span></span>|[<span data-ttu-id="1ecb0-341">如何：创建注册表项并将其值设置</span><span class="sxs-lookup"><span data-stu-id="1ecb0-341">How to: Create a Registry Key and Set Its Value</span></span>](~/docs/visual-basic/developing-apps/programming/computer-resources/how-to-create-a-registry-key-and-set-its-value.md)|  
|<span data-ttu-id="1ecb0-342">删除注册表项</span><span class="sxs-lookup"><span data-stu-id="1ecb0-342">Delete a registry key</span></span>|[<span data-ttu-id="1ecb0-343">如何：删除注册表项</span><span class="sxs-lookup"><span data-stu-id="1ecb0-343">How to: Delete a Registry Key</span></span>](~/docs/visual-basic/developing-apps/programming/computer-resources/how-to-delete-a-registry-key.md)|  
|<span data-ttu-id="1ecb0-344">从注册表项读取值</span><span class="sxs-lookup"><span data-stu-id="1ecb0-344">Read a value from a registry key</span></span>|[<span data-ttu-id="1ecb0-345">如何：从注册表项读取值</span><span class="sxs-lookup"><span data-stu-id="1ecb0-345">How to: Read a Value from a Registry Key</span></span>](~/docs/visual-basic/developing-apps/programming/computer-resources/how-to-read-a-value-from-a-registry-key.md)|  
  
   
  
## Examples  
 <span data-ttu-id="1ecb0-346">此示例中获取的值`ThisSoftware`从`MyCompany`子项。</span><span class="sxs-lookup"><span data-stu-id="1ecb0-346">This example gets the value `ThisSoftware` from the `MyCompany` subkey.</span></span>  
  
 [!code-vb[VbVbalrMyRegistry#7](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbalrMyRegistry/VB/Class1.vb#7)]  
  
 ]]></format>
        </remarks>
        <altmember cref="T:Microsoft.Win32.RegistryKey" />
        <altmember cref="F:Microsoft.Win32.Registry.PerformanceData" />
        <related type="Article" href="~/docs/visual-basic/language-reference/objects/index.md"><span data-ttu-id="1ecb0-347">对象 (Visual Basic)</span><span class="sxs-lookup"><span data-stu-id="1ecb0-347">Objects (Visual Basic)</span></span></related>
        <related type="Article" href="~/docs/visual-basic/developing-apps/programming/computer-resources/reading-from-and-writing-to-the-registry.md"><span data-ttu-id="1ecb0-348">读取和写入注册表 (Visual Basic)</span><span class="sxs-lookup"><span data-stu-id="1ecb0-348">Reading from and Writing to the Registry (Visual Basic)</span></span></related>
        <related type="Article" href="https://msdn.microsoft.com/library/9980aff7-2f69-492b-8f66-29a9a76d3df5"><span data-ttu-id="1ecb0-349">安全性与注册表</span><span class="sxs-lookup"><span data-stu-id="1ecb0-349">Security and the Registry</span></span></related>
      </Docs>
    </Member>
    <MemberGroup MemberName="SetValue">
      <AssemblyInfo>
        <AssemblyName>Microsoft.VisualBasic</AssemblyName>
        <AssemblyVersion>10.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Docs>
        <summary><span data-ttu-id="1ecb0-350">将值写入到注册表项。</span><span class="sxs-lookup"><span data-stu-id="1ecb0-350">Writes a value to a registry key.</span></span></summary>
      </Docs>
    </MemberGroup>
    <Member MemberName="SetValue">
      <MemberSignature Language="C#" Value="public void SetValue (string keyName, string valueName, object value);" />
      <MemberSignature Language="ILAsm" Value=".method public instance void SetValue(string keyName, string valueName, object value) cil managed" />
      <MemberSignature Language="DocId" Value="M:Microsoft.VisualBasic.MyServices.RegistryProxy.SetValue(System.String,System.String,System.Object)" />
      <MemberSignature Language="VB.NET" Value="Public Sub SetValue (keyName As String, valueName As String, value As Object)" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; void SetValue(System::String ^ keyName, System::String ^ valueName, System::Object ^ value);" />
      <MemberSignature Language="F#" Value="member this.SetValue : string * string * obj -&gt; unit" Usage="registryProxy.SetValue (keyName, valueName, value)" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>Microsoft.VisualBasic</AssemblyName>
        <AssemblyVersion>8.0.0.0</AssemblyVersion>
        <AssemblyVersion>10.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <AssemblyInfo>
        <AssemblyName>Microsoft.VisualBasic.Core</AssemblyName>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Void</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="keyName" Type="System.String" Index="0" FrameworkAlternate="netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;netframework-4.8" />
        <Parameter Name="valueName" Type="System.String" Index="1" FrameworkAlternate="netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;netframework-4.8" />
        <Parameter Name="value" Type="System.Object" Index="2" FrameworkAlternate="netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;netframework-4.8" />
      </Parameters>
      <Docs>
        <param name="keyName"><span data-ttu-id="1ecb0-351"><see langword="String" />。</span><span class="sxs-lookup"><span data-stu-id="1ecb0-351"><see langword="String" />.</span></span> <span data-ttu-id="1ecb0-352">要写入的键的名称。</span><span class="sxs-lookup"><span data-stu-id="1ecb0-352">Name of the key to be written to.</span></span> <span data-ttu-id="1ecb0-353">必需。</span><span class="sxs-lookup"><span data-stu-id="1ecb0-353">Required.</span></span></param>
        <param name="valueName"><span data-ttu-id="1ecb0-354"><see langword="String" />。</span><span class="sxs-lookup"><span data-stu-id="1ecb0-354"><see langword="String" />.</span></span> <span data-ttu-id="1ecb0-355">要写入的值的名称。</span><span class="sxs-lookup"><span data-stu-id="1ecb0-355">Name of the value to be written.</span></span> <span data-ttu-id="1ecb0-356">必需。</span><span class="sxs-lookup"><span data-stu-id="1ecb0-356">Required.</span></span></param>
        <param name="value"><span data-ttu-id="1ecb0-357"><see langword="Object" />。</span><span class="sxs-lookup"><span data-stu-id="1ecb0-357"><see langword="Object" />.</span></span> <span data-ttu-id="1ecb0-358">要写入的值。</span><span class="sxs-lookup"><span data-stu-id="1ecb0-358">Value to be written.</span></span> <span data-ttu-id="1ecb0-359">必需。</span><span class="sxs-lookup"><span data-stu-id="1ecb0-359">Required.</span></span></param>
        <summary><span data-ttu-id="1ecb0-360">将值写入到注册表项。</span><span class="sxs-lookup"><span data-stu-id="1ecb0-360">Writes a value to a registry key.</span></span></summary>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="1ecb0-361">如果指定的键或值不存在，则创建它。</span><span class="sxs-lookup"><span data-stu-id="1ecb0-361">If the specified key or value does not exist, it is created.</span></span>  
  
 <span data-ttu-id="1ecb0-362">下面是示例的任务涉及`My.Computer.Registry.SetValue`方法。</span><span class="sxs-lookup"><span data-stu-id="1ecb0-362">Here is an example of a task involving the `My.Computer.Registry.SetValue` method.</span></span>  
  
|<span data-ttu-id="1ecb0-363">功能</span><span class="sxs-lookup"><span data-stu-id="1ecb0-363">To</span></span>|<span data-ttu-id="1ecb0-364">查看</span><span class="sxs-lookup"><span data-stu-id="1ecb0-364">See</span></span>|  
|--------|---------|  
|<span data-ttu-id="1ecb0-365">在注册表项中设置一个值</span><span class="sxs-lookup"><span data-stu-id="1ecb0-365">Set a value in a registry key</span></span>|[<span data-ttu-id="1ecb0-366">如何：创建注册表项并将其值设置</span><span class="sxs-lookup"><span data-stu-id="1ecb0-366">How to: Create a Registry Key and Set Its Value</span></span>](~/docs/visual-basic/developing-apps/programming/computer-resources/how-to-create-a-registry-key-and-set-its-value.md)|  
  
   
  
## Examples  
 <span data-ttu-id="1ecb0-367">此示例将值设置`FontColor`为"红色"键中`HKEY_LOCAL_MACHINE\Software\MyCompany\Preferences`。</span><span class="sxs-lookup"><span data-stu-id="1ecb0-367">This example sets the value `FontColor` to "red" in the key `HKEY_LOCAL_MACHINE\Software\MyCompany\Preferences`.</span></span>  
  
 [!code-vb[VbVbalrMyRegistry#3](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbalrMyRegistry/VB/Class1.vb#3)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentNullException"><span data-ttu-id="1ecb0-368"><paramref name="value" /> 为 <see langword="Nothing" />。</span><span class="sxs-lookup"><span data-stu-id="1ecb0-368"><paramref name="value" /> is <see langword="Nothing" />.</span></span></exception>
        <exception cref="T:System.ArgumentException"><span data-ttu-id="1ecb0-369"><paramref name="keyName" /> 不以有效注册表根开头。</span><span class="sxs-lookup"><span data-stu-id="1ecb0-369"><paramref name="keyName" /> does not begin with a valid registry root.</span></span>  
  
<span data-ttu-id="1ecb0-370">或</span><span class="sxs-lookup"><span data-stu-id="1ecb0-370">-or-</span></span> 
 <span data-ttu-id="1ecb0-371"><paramref name="valueName" /> 是长度最大长度超过允许的 （255 个字符）。</span><span class="sxs-lookup"><span data-stu-id="1ecb0-371"><paramref name="valueName" /> is longer than the maximum length allowed (255 characters).</span></span></exception>
        <exception cref="T:System.UnauthorizedAccessException"><span data-ttu-id="1ecb0-372"><see cref="T:Microsoft.Win32.RegistryKey" /> 是只读的，因此无法对其写入内容（例如，它是根级节点，或者未用写访问权限打开该项）。</span><span class="sxs-lookup"><span data-stu-id="1ecb0-372">The <see cref="T:Microsoft.Win32.RegistryKey" /> is read-only and thus cannot be written to; for example, it is a root-level node, or it has not been opened with write access.</span></span></exception>
        <exception cref="T:System.Security.SecurityException"><span data-ttu-id="1ecb0-373">用户没有创建或修改注册表项所需的权限。</span><span class="sxs-lookup"><span data-stu-id="1ecb0-373">The user does not have the permissions required to create or modify registry keys.</span></span></exception>
        <permission cref="T:System.Security.Permissions.RegistryPermission"><span data-ttu-id="1ecb0-374">若要修改指定的注册表项，如果存在，或创建注册表项，如果尚不存在。</span><span class="sxs-lookup"><span data-stu-id="1ecb0-374">to modify the specified registry key if it exists, or to create the registry key if it does not already exist.</span></span> <span data-ttu-id="1ecb0-375">关联枚举： <see cref="F:System.Security.Permissions.RegistryPermissionAccess.Write" />， <see cref="F:System.Security.Permissions.RegistryPermissionAccess.Create" /></span><span class="sxs-lookup"><span data-stu-id="1ecb0-375">Associated enumerations: <see cref="F:System.Security.Permissions.RegistryPermissionAccess.Write" />, <see cref="F:System.Security.Permissions.RegistryPermissionAccess.Create" /></span></span></permission>
        <altmember cref="T:Microsoft.Win32.RegistryValueKind" />
        <altmember cref="Overload:Microsoft.Win32.Registry.SetValue" />
        <related type="Article" href="~/docs/visual-basic/language-reference/objects/index.md"><span data-ttu-id="1ecb0-376">对象 (Visual Basic)</span><span class="sxs-lookup"><span data-stu-id="1ecb0-376">Objects (Visual Basic)</span></span></related>
        <related type="Article" href="~/docs/visual-basic/developing-apps/programming/computer-resources/reading-from-and-writing-to-the-registry.md"><span data-ttu-id="1ecb0-377">读取和写入注册表 (Visual Basic)</span><span class="sxs-lookup"><span data-stu-id="1ecb0-377">Reading from and Writing to the Registry (Visual Basic)</span></span></related>
        <related type="Article" href="https://msdn.microsoft.com/library/9980aff7-2f69-492b-8f66-29a9a76d3df5"><span data-ttu-id="1ecb0-378">安全性与注册表</span><span class="sxs-lookup"><span data-stu-id="1ecb0-378">Security and the Registry</span></span></related>
      </Docs>
    </Member>
    <Member MemberName="SetValue">
      <MemberSignature Language="C#" Value="public void SetValue (string keyName, string valueName, object value, Microsoft.Win32.RegistryValueKind valueKind);" />
      <MemberSignature Language="ILAsm" Value=".method public instance void SetValue(string keyName, string valueName, object value, valuetype Microsoft.Win32.RegistryValueKind valueKind) cil managed" />
      <MemberSignature Language="DocId" Value="M:Microsoft.VisualBasic.MyServices.RegistryProxy.SetValue(System.String,System.String,System.Object,Microsoft.Win32.RegistryValueKind)" />
      <MemberSignature Language="VB.NET" Value="Public Sub SetValue (keyName As String, valueName As String, value As Object, valueKind As RegistryValueKind)" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; void SetValue(System::String ^ keyName, System::String ^ valueName, System::Object ^ value, Microsoft::Win32::RegistryValueKind valueKind);" />
      <MemberSignature Language="F#" Value="member this.SetValue : string * string * obj * Microsoft.Win32.RegistryValueKind -&gt; unit" Usage="registryProxy.SetValue (keyName, valueName, value, valueKind)" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>Microsoft.VisualBasic</AssemblyName>
        <AssemblyVersion>8.0.0.0</AssemblyVersion>
        <AssemblyVersion>10.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <AssemblyInfo>
        <AssemblyName>Microsoft.VisualBasic.Core</AssemblyName>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Void</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="keyName" Type="System.String" Index="0" FrameworkAlternate="netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;netframework-4.8" />
        <Parameter Name="valueName" Type="System.String" Index="1" FrameworkAlternate="netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;netframework-4.8" />
        <Parameter Name="value" Type="System.Object" Index="2" FrameworkAlternate="netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;netframework-4.8" />
        <Parameter Name="valueKind" Type="Microsoft.Win32.RegistryValueKind" Index="3" FrameworkAlternate="netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;netframework-4.8" />
      </Parameters>
      <Docs>
        <param name="keyName"><span data-ttu-id="1ecb0-379"><see langword="String" />。</span><span class="sxs-lookup"><span data-stu-id="1ecb0-379"><see langword="String" />.</span></span> <span data-ttu-id="1ecb0-380">要写入的键的名称。</span><span class="sxs-lookup"><span data-stu-id="1ecb0-380">Name of the key to be written to.</span></span> <span data-ttu-id="1ecb0-381">必需。</span><span class="sxs-lookup"><span data-stu-id="1ecb0-381">Required.</span></span></param>
        <param name="valueName"><span data-ttu-id="1ecb0-382"><see langword="String" />。</span><span class="sxs-lookup"><span data-stu-id="1ecb0-382"><see langword="String" />.</span></span> <span data-ttu-id="1ecb0-383">要写入的值的名称。</span><span class="sxs-lookup"><span data-stu-id="1ecb0-383">Name of the value to be written.</span></span> <span data-ttu-id="1ecb0-384">必需。</span><span class="sxs-lookup"><span data-stu-id="1ecb0-384">Required.</span></span></param>
        <param name="value"><span data-ttu-id="1ecb0-385"><see langword="Object" />。</span><span class="sxs-lookup"><span data-stu-id="1ecb0-385"><see langword="Object" />.</span></span> <span data-ttu-id="1ecb0-386">要写入的值。</span><span class="sxs-lookup"><span data-stu-id="1ecb0-386">Value to be written.</span></span> <span data-ttu-id="1ecb0-387">必需。</span><span class="sxs-lookup"><span data-stu-id="1ecb0-387">Required.</span></span></param>
        <param name="valueKind"><span data-ttu-id="1ecb0-388"><see cref="T:Microsoft.Win32.RegistryValueKind" />。</span><span class="sxs-lookup"><span data-stu-id="1ecb0-388"><see cref="T:Microsoft.Win32.RegistryValueKind" />.</span></span> <span data-ttu-id="1ecb0-389">必需。</span><span class="sxs-lookup"><span data-stu-id="1ecb0-389">Required.</span></span></param>
        <summary><span data-ttu-id="1ecb0-390">将值写入到注册表项。</span><span class="sxs-lookup"><span data-stu-id="1ecb0-390">Writes a value to a registry key.</span></span></summary>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="1ecb0-391">如果指定的键或值不存在，则创建它。</span><span class="sxs-lookup"><span data-stu-id="1ecb0-391">If the specified key or value does not exist, it is created.</span></span>  
  
 <span data-ttu-id="1ecb0-392">下面是示例的任务涉及`My.Computer.Registry.SetValue`方法。</span><span class="sxs-lookup"><span data-stu-id="1ecb0-392">Here is an example of a task involving the `My.Computer.Registry.SetValue` method.</span></span>  
  
|<span data-ttu-id="1ecb0-393">功能</span><span class="sxs-lookup"><span data-stu-id="1ecb0-393">To</span></span>|<span data-ttu-id="1ecb0-394">查看</span><span class="sxs-lookup"><span data-stu-id="1ecb0-394">See</span></span>|  
|--------|---------|  
|<span data-ttu-id="1ecb0-395">在注册表项中设置一个值</span><span class="sxs-lookup"><span data-stu-id="1ecb0-395">Set a value in a registry key</span></span>|[<span data-ttu-id="1ecb0-396">如何：创建注册表项并将其值设置</span><span class="sxs-lookup"><span data-stu-id="1ecb0-396">How to: Create a Registry Key and Set Its Value</span></span>](~/docs/visual-basic/developing-apps/programming/computer-resources/how-to-create-a-registry-key-and-set-its-value.md)|  
  
   
  
## Examples  
 <span data-ttu-id="1ecb0-397">此示例将值设置`FontColor`为"红色"键中`HKEY_LOCAL_MACHINE\Software\MyCompany\Preferences`。</span><span class="sxs-lookup"><span data-stu-id="1ecb0-397">This example sets the value `FontColor` to "red" in the key `HKEY_LOCAL_MACHINE\Software\MyCompany\Preferences`.</span></span>  
  
 [!code-vb[VbVbalrMyRegistry#3](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbalrMyRegistry/VB/Class1.vb#3)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentNullException"><span data-ttu-id="1ecb0-398"><paramref name="value" /> 为 <see langword="Nothing" />。</span><span class="sxs-lookup"><span data-stu-id="1ecb0-398"><paramref name="value" /> is <see langword="Nothing" />.</span></span></exception>
        <exception cref="T:System.ArgumentException"><span data-ttu-id="1ecb0-399"><paramref name="keyName" /> 不以有效注册表根开头。</span><span class="sxs-lookup"><span data-stu-id="1ecb0-399"><paramref name="keyName" /> does not begin with a valid registry root.</span></span>  
  
<span data-ttu-id="1ecb0-400">或</span><span class="sxs-lookup"><span data-stu-id="1ecb0-400">-or-</span></span> 
 <span data-ttu-id="1ecb0-401"><paramref name="keyName" /> 是长度最大长度超过允许的 （255 个字符）。</span><span class="sxs-lookup"><span data-stu-id="1ecb0-401"><paramref name="keyName" /> is longer than the maximum length allowed (255 characters).</span></span>  
  
<span data-ttu-id="1ecb0-402">或</span><span class="sxs-lookup"><span data-stu-id="1ecb0-402">-or-</span></span> 
<span data-ttu-id="1ecb0-403">类型<paramref name="value" />与指定的注册表数据类型不匹配<paramref name="valueKind" />，因此不能正确转换该数据。</span><span class="sxs-lookup"><span data-stu-id="1ecb0-403">The type of <paramref name="value" /> does not match the registry data type specified by <paramref name="valueKind" />, therefore the data cannot be converted properly.</span></span></exception>
        <exception cref="T:System.UnauthorizedAccessException"><span data-ttu-id="1ecb0-404"><see cref="T:Microsoft.Win32.RegistryKey" />是只读的并因此不能对其写入; 例如，它是根级节点，或未打开具有写访问权限。</span><span class="sxs-lookup"><span data-stu-id="1ecb0-404">The <see cref="T:Microsoft.Win32.RegistryKey" /> is read-only, and thus cannot be written to; for example, it is a root-level node, or it has not been opened with write access.</span></span></exception>
        <exception cref="T:System.Security.SecurityException"><span data-ttu-id="1ecb0-405">用户没有创建或修改注册表项所需的权限。</span><span class="sxs-lookup"><span data-stu-id="1ecb0-405">The user does not have the permissions required to create or modify registry keys.</span></span></exception>
        <permission cref="T:System.Security.Permissions.RegistryPermission"><span data-ttu-id="1ecb0-406">若要修改指定的注册表项，如果存在，或创建注册表项，如果尚不存在。</span><span class="sxs-lookup"><span data-stu-id="1ecb0-406">to modify the specified registry key if it exists, or to create the registry key if it does not already exist.</span></span> <span data-ttu-id="1ecb0-407">关联枚举： <see cref="F:System.Security.Permissions.RegistryPermissionAccess.Write" />， <see cref="F:System.Security.Permissions.RegistryPermissionAccess.Create" /></span><span class="sxs-lookup"><span data-stu-id="1ecb0-407">Associated enumerations: <see cref="F:System.Security.Permissions.RegistryPermissionAccess.Write" />, <see cref="F:System.Security.Permissions.RegistryPermissionAccess.Create" /></span></span></permission>
        <altmember cref="T:Microsoft.Win32.RegistryValueKind" />
        <altmember cref="Overload:Microsoft.Win32.Registry.SetValue" />
        <related type="Article" href="~/docs/visual-basic/language-reference/objects/index.md"><span data-ttu-id="1ecb0-408">对象 (Visual Basic)</span><span class="sxs-lookup"><span data-stu-id="1ecb0-408">Objects (Visual Basic)</span></span></related>
        <related type="Article" href="~/docs/visual-basic/developing-apps/programming/computer-resources/reading-from-and-writing-to-the-registry.md"><span data-ttu-id="1ecb0-409">读取和写入注册表 (Visual Basic)</span><span class="sxs-lookup"><span data-stu-id="1ecb0-409">Reading from and Writing to the Registry (Visual Basic)</span></span></related>
        <related type="Article" href="https://msdn.microsoft.com/library/9980aff7-2f69-492b-8f66-29a9a76d3df5"><span data-ttu-id="1ecb0-410">安全性与注册表</span><span class="sxs-lookup"><span data-stu-id="1ecb0-410">Security and the Registry</span></span></related>
      </Docs>
    </Member>
    <Member MemberName="Users">
      <MemberSignature Language="C#" Value="public Microsoft.Win32.RegistryKey Users { get; }" />
      <MemberSignature Language="ILAsm" Value=".property instance class Microsoft.Win32.RegistryKey Users" />
      <MemberSignature Language="DocId" Value="P:Microsoft.VisualBasic.MyServices.RegistryProxy.Users" />
      <MemberSignature Language="VB.NET" Value="Public ReadOnly Property Users As RegistryKey" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; property Microsoft::Win32::RegistryKey ^ Users { Microsoft::Win32::RegistryKey ^ get(); };" />
      <MemberSignature Language="F#" Value="member this.Users : Microsoft.Win32.RegistryKey" Usage="Microsoft.VisualBasic.MyServices.RegistryProxy.Users" />
      <MemberType>Property</MemberType>
      <AssemblyInfo>
        <AssemblyName>Microsoft.VisualBasic</AssemblyName>
        <AssemblyVersion>8.0.0.0</AssemblyVersion>
        <AssemblyVersion>10.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <AssemblyInfo>
        <AssemblyName>Microsoft.VisualBasic.Core</AssemblyName>
      </AssemblyInfo>
      <Attributes>
        <Attribute FrameworkAlternate="netframework-4.0">
          <AttributeName>get: System.Runtime.TargetedPatchingOptOut("Performance critical to inline this type of method across NGen image boundaries")</AttributeName>
        </Attribute>
      </Attributes>
      <ReturnValue>
        <ReturnType>Microsoft.Win32.RegistryKey</ReturnType>
      </ReturnValue>
      <Docs>
        <summary><span data-ttu-id="1ecb0-411">返回<see cref="T:Microsoft.Win32.RegistryKey" />类型，它提供对访问<see langword="HKEY_USERS" />。</span><span class="sxs-lookup"><span data-stu-id="1ecb0-411">Returns a <see cref="T:Microsoft.Win32.RegistryKey" /> type, which provides access to <see langword="HKEY_USERS" />.</span></span></summary>
        <value><see cref="T:Microsoft.Win32.RegistryKey" /></value>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="1ecb0-412">`HKEY_USERS` 主要用于存储首次用户的默认设置。</span><span class="sxs-lookup"><span data-stu-id="1ecb0-412">`HKEY_USERS` is primarily used to store default settings for first-time users.</span></span>  
  
 <span data-ttu-id="1ecb0-413"><xref:System.Security.Permissions.RegistryPermission>类，该类是在<xref:System.Security.Permissions>命名空间，控制对注册表变量的访问。</span><span class="sxs-lookup"><span data-stu-id="1ecb0-413">The <xref:System.Security.Permissions.RegistryPermission> class, which is in the <xref:System.Security.Permissions> namespace, controls access to registry variables.</span></span> <span data-ttu-id="1ecb0-414">不应将注册表变量存储在某些内存位置，在这些位置，不具有 <xref:System.Security.Permissions.RegistryPermission> 的代码可访问这些变量。</span><span class="sxs-lookup"><span data-stu-id="1ecb0-414">Registry variables should not be stored in memory locations where code without <xref:System.Security.Permissions.RegistryPermission> can access them.</span></span> <span data-ttu-id="1ecb0-415">同样，授予权限时，授予顺利完成工作所需的最少权限。</span><span class="sxs-lookup"><span data-stu-id="1ecb0-415">Similarly, when granting permissions, grant the fewest privileges necessary to get the job done.</span></span>  
  
 <span data-ttu-id="1ecb0-416">通过 <xref:System.Security.Permissions.RegistryPermissionAccess> 枚举定义注册表权限访问值。</span><span class="sxs-lookup"><span data-stu-id="1ecb0-416">Registry permission access values are defined by the <xref:System.Security.Permissions.RegistryPermissionAccess> enumeration.</span></span> <span data-ttu-id="1ecb0-417">下表详细说明了其成员。</span><span class="sxs-lookup"><span data-stu-id="1ecb0-417">The following table details its members.</span></span>  
  
|<span data-ttu-id="1ecb0-418">值</span><span class="sxs-lookup"><span data-stu-id="1ecb0-418">Value</span></span>|<span data-ttu-id="1ecb0-419">对注册表变量的访问</span><span class="sxs-lookup"><span data-stu-id="1ecb0-419">Access to Registry Variables</span></span>|  
|-----------|----------------------------------|  
|<span data-ttu-id="1ecb0-420">AllAccess</span><span class="sxs-lookup"><span data-stu-id="1ecb0-420">AllAccess</span></span>|<span data-ttu-id="1ecb0-421">创建、读取和写入</span><span class="sxs-lookup"><span data-stu-id="1ecb0-421">Create, read, and write</span></span>|  
|<span data-ttu-id="1ecb0-422">创建</span><span class="sxs-lookup"><span data-stu-id="1ecb0-422">Create</span></span>|<span data-ttu-id="1ecb0-423">创建</span><span class="sxs-lookup"><span data-stu-id="1ecb0-423">Create</span></span>|  
|<span data-ttu-id="1ecb0-424">NoAccess</span><span class="sxs-lookup"><span data-stu-id="1ecb0-424">NoAccess</span></span>|<span data-ttu-id="1ecb0-425">无访问权限。</span><span class="sxs-lookup"><span data-stu-id="1ecb0-425">No access.</span></span>|  
|<span data-ttu-id="1ecb0-426">读取</span><span class="sxs-lookup"><span data-stu-id="1ecb0-426">Read</span></span>|<span data-ttu-id="1ecb0-427">读取</span><span class="sxs-lookup"><span data-stu-id="1ecb0-427">Read</span></span>|  
|<span data-ttu-id="1ecb0-428">Write</span><span class="sxs-lookup"><span data-stu-id="1ecb0-428">Write</span></span>|<span data-ttu-id="1ecb0-429">Write</span><span class="sxs-lookup"><span data-stu-id="1ecb0-429">Write</span></span>|  
  
 <span data-ttu-id="1ecb0-430">下表列出了所涉及的任务的示例`My.Computer.Registry`对象。</span><span class="sxs-lookup"><span data-stu-id="1ecb0-430">The following table lists examples of tasks involving the `My.Computer.Registry` object.</span></span>  
  
|<span data-ttu-id="1ecb0-431">**若要**</span><span class="sxs-lookup"><span data-stu-id="1ecb0-431">**To**</span></span>|<span data-ttu-id="1ecb0-432">**请参阅**</span><span class="sxs-lookup"><span data-stu-id="1ecb0-432">**See**</span></span>|  
|------------|-------------|  
|<span data-ttu-id="1ecb0-433">创建注册表项并将其值设置</span><span class="sxs-lookup"><span data-stu-id="1ecb0-433">Create a registry key and set its value</span></span>|[<span data-ttu-id="1ecb0-434">如何：创建注册表项并将其值设置</span><span class="sxs-lookup"><span data-stu-id="1ecb0-434">How to: Create a Registry Key and Set Its Value</span></span>](~/docs/visual-basic/developing-apps/programming/computer-resources/how-to-create-a-registry-key-and-set-its-value.md)|  
|<span data-ttu-id="1ecb0-435">删除注册表项</span><span class="sxs-lookup"><span data-stu-id="1ecb0-435">Delete a registry key</span></span>|[<span data-ttu-id="1ecb0-436">如何：删除注册表项</span><span class="sxs-lookup"><span data-stu-id="1ecb0-436">How to: Delete a Registry Key</span></span>](~/docs/visual-basic/developing-apps/programming/computer-resources/how-to-delete-a-registry-key.md)|  
|<span data-ttu-id="1ecb0-437">从注册表项读取值</span><span class="sxs-lookup"><span data-stu-id="1ecb0-437">Read a value from a registry key</span></span>|[<span data-ttu-id="1ecb0-438">如何：从注册表项读取值</span><span class="sxs-lookup"><span data-stu-id="1ecb0-438">How to: Read a Value from a Registry Key</span></span>](~/docs/visual-basic/developing-apps/programming/computer-resources/how-to-read-a-value-from-a-registry-key.md)|  
  
   
  
## Examples  
 <span data-ttu-id="1ecb0-439">此示例计算并显示注册表项中的值。</span><span class="sxs-lookup"><span data-stu-id="1ecb0-439">This example counts and displays the number of values in the registry key.</span></span>  
  
 [!code-vb[VbVbalrMyRegistry#4](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbalrMyRegistry/VB/Class1.vb#4)]  
  
 ]]></format>
        </remarks>
        <altmember cref="T:Microsoft.Win32.RegistryKey" />
        <altmember cref="F:Microsoft.Win32.Registry.Users" />
        <related type="Article" href="~/docs/visual-basic/language-reference/objects/index.md"><span data-ttu-id="1ecb0-440">对象 (Visual Basic)</span><span class="sxs-lookup"><span data-stu-id="1ecb0-440">Objects (Visual Basic)</span></span></related>
        <related type="Article" href="~/docs/visual-basic/developing-apps/programming/computer-resources/reading-from-and-writing-to-the-registry.md"><span data-ttu-id="1ecb0-441">读取和写入注册表 (Visual Basic)</span><span class="sxs-lookup"><span data-stu-id="1ecb0-441">Reading from and Writing to the Registry (Visual Basic)</span></span></related>
        <related type="Article" href="https://msdn.microsoft.com/library/9980aff7-2f69-492b-8f66-29a9a76d3df5"><span data-ttu-id="1ecb0-442">安全性与注册表</span><span class="sxs-lookup"><span data-stu-id="1ecb0-442">Security and the Registry</span></span></related>
      </Docs>
    </Member>
  </Members>
</Type>