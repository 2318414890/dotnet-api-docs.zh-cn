<Type Name="FileSystemProxy" FullName="Microsoft.VisualBasic.MyServices.FileSystemProxy">
  <Metadata><Meta Name="ms.openlocfilehash" Value="ee00de463bf49d0a92e881ae498c690d8482c763" /><Meta Name="ms.sourcegitcommit" Value="95e24aee1283af2f120fc5da4b0bdc0712ab698f" /><Meta Name="ms.translationtype" Value="MT" /><Meta Name="ms.contentlocale" Value="zh-CN" /><Meta Name="ms.lasthandoff" Value="05/06/2019" /><Meta Name="ms.locfileid" Value="65135841" /></Metadata><TypeSignature Language="C#" Value="public class FileSystemProxy" />
  <TypeSignature Language="ILAsm" Value=".class public auto ansi FileSystemProxy extends System.Object" />
  <TypeSignature Language="DocId" Value="T:Microsoft.VisualBasic.MyServices.FileSystemProxy" />
  <TypeSignature Language="VB.NET" Value="Public Class FileSystemProxy" />
  <TypeSignature Language="C++ CLI" Value="public ref class FileSystemProxy" />
  <TypeSignature Language="F#" Value="type FileSystemProxy = class" />
  <AssemblyInfo>
    <AssemblyName>Microsoft.VisualBasic</AssemblyName>
    <AssemblyVersion>8.0.0.0</AssemblyVersion>
    <AssemblyVersion>10.0.0.0</AssemblyVersion>
  </AssemblyInfo>
  <AssemblyInfo>
    <AssemblyName>Microsoft.VisualBasic.Core</AssemblyName>
    <AssemblyVersion>10.0.4.0</AssemblyVersion>
  </AssemblyInfo>
  <Base>
    <BaseTypeName>System.Object</BaseTypeName>
  </Base>
  <Interfaces />
  <Attributes>
    <Attribute>
      <AttributeName>System.ComponentModel.EditorBrowsable(System.ComponentModel.EditorBrowsableState.Never)</AttributeName>
    </Attribute>
  </Attributes>
  <Docs>
    <summary><span data-ttu-id="08401-101">提供了用于处理驱动器、文件和目录的属性和方法。</span><span class="sxs-lookup"><span data-stu-id="08401-101">Provides properties and methods for working with drives, files, and directories.</span></span></summary>
    <remarks>
      <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="08401-102">下表列出了所涉及的任务的示例`My.Computer.FileSystem`对象。</span><span class="sxs-lookup"><span data-stu-id="08401-102">The following table lists examples of tasks involving the `My.Computer.FileSystem` object.</span></span>  
  
|<span data-ttu-id="08401-103">功能</span><span class="sxs-lookup"><span data-stu-id="08401-103">To</span></span>|<span data-ttu-id="08401-104">查看</span><span class="sxs-lookup"><span data-stu-id="08401-104">See</span></span>|  
|--------|---------|  
|<span data-ttu-id="08401-105">从文本文件读取</span><span class="sxs-lookup"><span data-stu-id="08401-105">Read from a text file</span></span>|[<span data-ttu-id="08401-106">如何：读取文本文件</span><span class="sxs-lookup"><span data-stu-id="08401-106">How to: Read from Text Files</span></span>](~/docs/visual-basic/developing-apps/programming/drives-directories-files/how-to-read-from-text-files.md)|  
|<span data-ttu-id="08401-107">从带分隔符的文本文件中读取</span><span class="sxs-lookup"><span data-stu-id="08401-107">Read from a delimited text file</span></span>|[<span data-ttu-id="08401-108">如何：读取逗号分隔的文本文件</span><span class="sxs-lookup"><span data-stu-id="08401-108">How to: Read From Comma-Delimited Text Files</span></span>](~/docs/visual-basic/developing-apps/programming/drives-directories-files/how-to-read-from-comma-delimited-text-files.md)|  
|<span data-ttu-id="08401-109">读取定宽文本文件</span><span class="sxs-lookup"><span data-stu-id="08401-109">Read from a fixed-width text file</span></span>|[<span data-ttu-id="08401-110">如何：读取固定宽度的文本文件</span><span class="sxs-lookup"><span data-stu-id="08401-110">How to: Read From Fixed-width Text Files</span></span>](~/docs/visual-basic/developing-apps/programming/drives-directories-files/how-to-read-from-fixed-width-text-files.md)|  
|<span data-ttu-id="08401-111">读取具有多种格式的文本文件</span><span class="sxs-lookup"><span data-stu-id="08401-111">Read from a text file with multiple formats</span></span>|[<span data-ttu-id="08401-112">如何：读取具有多种格式的文本文件</span><span class="sxs-lookup"><span data-stu-id="08401-112">How to: Read From Text Files with Multiple Formats</span></span>](~/docs/visual-basic/developing-apps/programming/drives-directories-files/how-to-read-from-text-files-with-multiple-formats.md)|  
|<span data-ttu-id="08401-113">从二进制文件读取</span><span class="sxs-lookup"><span data-stu-id="08401-113">Read from a binary file</span></span>|[<span data-ttu-id="08401-114">如何：读取二进制文件</span><span class="sxs-lookup"><span data-stu-id="08401-114">How to: Read From Binary Files</span></span>](~/docs/visual-basic/developing-apps/programming/drives-directories-files/how-to-read-from-binary-files.md)|  
|<span data-ttu-id="08401-115">从文本文件中读取 <xref:System.IO.StreamReader></span><span class="sxs-lookup"><span data-stu-id="08401-115">Read from a text file with a <xref:System.IO.StreamReader></span></span>|[<span data-ttu-id="08401-116">如何：从文件使用 StreamReader 读取文本</span><span class="sxs-lookup"><span data-stu-id="08401-116">How to: Read Text from Files with a StreamReader</span></span>](~/docs/visual-basic/developing-apps/programming/drives-directories-files/how-to-read-text-from-files-with-a-streamreader.md)|  
|<span data-ttu-id="08401-117">写入到文本文件</span><span class="sxs-lookup"><span data-stu-id="08401-117">Write to a text file</span></span>|[<span data-ttu-id="08401-118">如何：向文件写入文本</span><span class="sxs-lookup"><span data-stu-id="08401-118">How to: Write Text to Files</span></span>](~/docs/visual-basic/developing-apps/programming/drives-directories-files/how-to-write-text-to-files.md)|  
|<span data-ttu-id="08401-119">追加到文本文件</span><span class="sxs-lookup"><span data-stu-id="08401-119">Append to a text file</span></span>|[<span data-ttu-id="08401-120">如何：向文本文件追加</span><span class="sxs-lookup"><span data-stu-id="08401-120">How to: Append to Text Files</span></span>](~/docs/visual-basic/developing-apps/programming/drives-directories-files/how-to-append-to-text-files.md)|  
|<span data-ttu-id="08401-121">写入二进制文件</span><span class="sxs-lookup"><span data-stu-id="08401-121">Write to a binary file</span></span>|[<span data-ttu-id="08401-122">如何：写入二进制文件</span><span class="sxs-lookup"><span data-stu-id="08401-122">How to: Write to Binary Files</span></span>](~/docs/visual-basic/developing-apps/programming/drives-directories-files/how-to-write-to-binary-files.md)|  
|<span data-ttu-id="08401-123">写入文本文件**MyDocuments**目录</span><span class="sxs-lookup"><span data-stu-id="08401-123">Write to text files in the **MyDocuments** directory</span></span>|[<span data-ttu-id="08401-124">如何：向文件中写入文本我的文档目录</span><span class="sxs-lookup"><span data-stu-id="08401-124">How to: Write Text to Files in the My Documents Directory</span></span>](~/docs/visual-basic/developing-apps/programming/drives-directories-files/how-to-write-text-to-files-in-the-my-documents-directory.md)|  
|<span data-ttu-id="08401-125">写入到的文本文件 `StreamWriter`</span><span class="sxs-lookup"><span data-stu-id="08401-125">Write to a text file with a `StreamWriter`</span></span>|[<span data-ttu-id="08401-126">如何：使用 StreamWriter 向文件写入文本</span><span class="sxs-lookup"><span data-stu-id="08401-126">How to: Write Text to Files with a StreamWriter</span></span>](~/docs/visual-basic/developing-apps/programming/drives-directories-files/how-to-write-text-to-files-with-a-streamwriter.md)|  
|<span data-ttu-id="08401-127">将具有特定模式的文件复制</span><span class="sxs-lookup"><span data-stu-id="08401-127">Copy files with a specific pattern</span></span>|[<span data-ttu-id="08401-128">如何：将具有特定模式的文件复制到目录中</span><span class="sxs-lookup"><span data-stu-id="08401-128">How to: Copy Files with a Specific Pattern to a Directory</span></span>](~/docs/visual-basic/developing-apps/programming/drives-directories-files/how-to-copy-files-with-a-specific-pattern-to-a-directory.md)|  
|<span data-ttu-id="08401-129">将文件复制到同一个目录</span><span class="sxs-lookup"><span data-stu-id="08401-129">Copy a file to the same directory</span></span>|[<span data-ttu-id="08401-130">如何：在同一目录中创建文件副本</span><span class="sxs-lookup"><span data-stu-id="08401-130">How to: Create a Copy of a File in the Same Directory</span></span>](~/docs/visual-basic/developing-apps/programming/drives-directories-files/how-to-create-a-copy-of-a-file-in-the-same-directory.md)|  
|<span data-ttu-id="08401-131">将文件复制到其他目录</span><span class="sxs-lookup"><span data-stu-id="08401-131">Copy a file to a different directory</span></span>|[<span data-ttu-id="08401-132">如何：在不同的目录中创建文件的副本</span><span class="sxs-lookup"><span data-stu-id="08401-132">How to: Create a Copy of a File in a Different Directory</span></span>](~/docs/visual-basic/developing-apps/programming/drives-directories-files/how-to-create-a-copy-of-a-file-in-a-different-directory.md)|  
|<span data-ttu-id="08401-133">创建文件</span><span class="sxs-lookup"><span data-stu-id="08401-133">Create a file</span></span>|[<span data-ttu-id="08401-134">如何：创建文件</span><span class="sxs-lookup"><span data-stu-id="08401-134">How to: Create a File</span></span>](~/docs/visual-basic/developing-apps/programming/drives-directories-files/how-to-create-a-file.md)|  
|<span data-ttu-id="08401-135">删除文件</span><span class="sxs-lookup"><span data-stu-id="08401-135">Delete a file</span></span>|[<span data-ttu-id="08401-136">如何：删除文件</span><span class="sxs-lookup"><span data-stu-id="08401-136">How to: Delete a File</span></span>](~/docs/visual-basic/developing-apps/programming/drives-directories-files/how-to-delete-a-file.md)|  
|<span data-ttu-id="08401-137">查找具有特定模式的文件</span><span class="sxs-lookup"><span data-stu-id="08401-137">Find files with a specific pattern</span></span>|[<span data-ttu-id="08401-138">如何：查找具有特定模式的文件</span><span class="sxs-lookup"><span data-stu-id="08401-138">How to: Find Files with a Specific Pattern</span></span>](~/docs/visual-basic/developing-apps/programming/drives-directories-files/how-to-find-files-with-a-specific-pattern.md)|  
|<span data-ttu-id="08401-139">移动文件</span><span class="sxs-lookup"><span data-stu-id="08401-139">Move a file</span></span>|[<span data-ttu-id="08401-140">如何：移动文件</span><span class="sxs-lookup"><span data-stu-id="08401-140">How to: Move a File</span></span>](~/docs/visual-basic/developing-apps/programming/drives-directories-files/how-to-move-a-file.md)|  
|<span data-ttu-id="08401-141">重命名文件</span><span class="sxs-lookup"><span data-stu-id="08401-141">Rename a file</span></span>|[<span data-ttu-id="08401-142">如何：重命名文件</span><span class="sxs-lookup"><span data-stu-id="08401-142">How to: Rename a File</span></span>](~/docs/visual-basic/developing-apps/programming/drives-directories-files/how-to-rename-a-file.md)|  
|<span data-ttu-id="08401-143">将一个目录复制到另一个目录</span><span class="sxs-lookup"><span data-stu-id="08401-143">Copy a directory to another directory</span></span>|[<span data-ttu-id="08401-144">如何：将目录复制到另一个目录</span><span class="sxs-lookup"><span data-stu-id="08401-144">How to: Copy a Directory to Another Directory</span></span>](~/docs/visual-basic/developing-apps/programming/drives-directories-files/how-to-copy-a-directory-to-another-directory.md)|  
|<span data-ttu-id="08401-145">创建目录</span><span class="sxs-lookup"><span data-stu-id="08401-145">Create a directory</span></span>|[<span data-ttu-id="08401-146">如何：创建一个目录</span><span class="sxs-lookup"><span data-stu-id="08401-146">How to: Create a Directory</span></span>](~/docs/visual-basic/developing-apps/programming/drives-directories-files/how-to-create-a-directory.md)|  
|<span data-ttu-id="08401-147">查找具有特定模式的子目录</span><span class="sxs-lookup"><span data-stu-id="08401-147">Find subdirectories with a specific pattern</span></span>|[<span data-ttu-id="08401-148">如何：查找具有特定模式的子目录</span><span class="sxs-lookup"><span data-stu-id="08401-148">How to: Find Subdirectories with a Specific Pattern</span></span>](~/docs/visual-basic/developing-apps/programming/drives-directories-files/how-to-find-subdirectories-with-a-specific-pattern.md)|  
|<span data-ttu-id="08401-149">获取目录中的文件的集合</span><span class="sxs-lookup"><span data-stu-id="08401-149">Get the collection of files in a directory</span></span>|[<span data-ttu-id="08401-150">如何：获取目录中的文件集合</span><span class="sxs-lookup"><span data-stu-id="08401-150">How to: Get the Collection of Files in a Directory</span></span>](~/docs/visual-basic/developing-apps/programming/drives-directories-files/how-to-get-the-collection-of-files-in-a-directory.md)|  
|<span data-ttu-id="08401-151">从读取**MyDocuments**目录</span><span class="sxs-lookup"><span data-stu-id="08401-151">Read from the **MyDocuments** directory</span></span>|[<span data-ttu-id="08401-152">如何：检索的内容我的文档目录</span><span class="sxs-lookup"><span data-stu-id="08401-152">How to: Retrieve the Contents of the My Documents Directory</span></span>](~/docs/visual-basic/developing-apps/programming/drives-directories-files/how-to-retrieve-the-contents-of-the-my-documents-directory.md)|  
|<span data-ttu-id="08401-153">分析文件路径</span><span class="sxs-lookup"><span data-stu-id="08401-153">Parse a file path</span></span>|[<span data-ttu-id="08401-154">如何：分析文件路径</span><span class="sxs-lookup"><span data-stu-id="08401-154">How to: Parse File Paths</span></span>](~/docs/visual-basic/developing-apps/programming/drives-directories-files/how-to-parse-file-paths.md)|  
  
   
  
## Examples  
 <span data-ttu-id="08401-155">此示例中进行检查以确定是否在文件夹`C:\backup\logs`存在，并检查其属性。</span><span class="sxs-lookup"><span data-stu-id="08401-155">This example checks to determine whether the folder `C:\backup\logs` exists and checks its properties.</span></span>  
  
 [!code-vb[VbVbcnMyFileSystem#23](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbcnMyFileSystem/VB/Class1.vb#23)]  
  
 ]]></format>
    </remarks>
    <altmember cref="T:Microsoft.VisualBasic.FileIO.SpecialDirectories" />
    <related type="Article" href="~/docs/visual-basic/language-reference/objects/index.md"><span data-ttu-id="08401-156">对象 (Visual Basic)</span><span class="sxs-lookup"><span data-stu-id="08401-156">Objects (Visual Basic)</span></span></related>
  </Docs>
  <Members>
    <Member MemberName="CombinePath">
      <MemberSignature Language="C#" Value="public string CombinePath (string baseDirectory, string relativePath);" />
      <MemberSignature Language="ILAsm" Value=".method public instance string CombinePath(string baseDirectory, string relativePath) cil managed" />
      <MemberSignature Language="DocId" Value="M:Microsoft.VisualBasic.MyServices.FileSystemProxy.CombinePath(System.String,System.String)" />
      <MemberSignature Language="VB.NET" Value="Public Function CombinePath (baseDirectory As String, relativePath As String) As String" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; System::String ^ CombinePath(System::String ^ baseDirectory, System::String ^ relativePath);" />
      <MemberSignature Language="F#" Value="member this.CombinePath : string * string -&gt; string" Usage="fileSystemProxy.CombinePath (baseDirectory, relativePath)" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>Microsoft.VisualBasic</AssemblyName>
        <AssemblyVersion>8.0.0.0</AssemblyVersion>
        <AssemblyVersion>10.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <AssemblyInfo>
        <AssemblyName>Microsoft.VisualBasic.Core</AssemblyName>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.String</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="baseDirectory" Type="System.String" Index="0" FrameworkAlternate="netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;netframework-4.8" />
        <Parameter Name="relativePath" Type="System.String" Index="1" FrameworkAlternate="netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;netframework-4.8" />
      </Parameters>
      <Docs>
        <param name="baseDirectory"><span data-ttu-id="08401-157"><see langword="String" />。</span><span class="sxs-lookup"><span data-stu-id="08401-157"><see langword="String" />.</span></span> <span data-ttu-id="08401-158">要组合的第一个路径。</span><span class="sxs-lookup"><span data-stu-id="08401-158">First path to be combined.</span></span></param>
        <param name="relativePath"><span data-ttu-id="08401-159"><see langword="String" />。</span><span class="sxs-lookup"><span data-stu-id="08401-159"><see langword="String" />.</span></span> <span data-ttu-id="08401-160">要组合的第二个路径。</span><span class="sxs-lookup"><span data-stu-id="08401-160">Second path to be combined.</span></span></param>
        <summary><span data-ttu-id="08401-161">组合两个路径并返回格式正确的路径。</span><span class="sxs-lookup"><span data-stu-id="08401-161">Combines two paths and returns a properly formatted path.</span></span></summary>
        <returns><span data-ttu-id="08401-162">指定路径的组合。</span><span class="sxs-lookup"><span data-stu-id="08401-162">The combination of the specified paths.</span></span></returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="08401-163">此方法将修整过多的斜杠字符创建格式正确的路径。</span><span class="sxs-lookup"><span data-stu-id="08401-163">This method trims excess slash-mark characters to create a properly formatted path.</span></span>  
  
 <span data-ttu-id="08401-164">下表列出了所涉及的任务的示例`My.Computer.FileSystem.CombinePath`方法。</span><span class="sxs-lookup"><span data-stu-id="08401-164">The following table lists examples of tasks involving the `My.Computer.FileSystem.CombinePath` method.</span></span>  
  
|<span data-ttu-id="08401-165">功能</span><span class="sxs-lookup"><span data-stu-id="08401-165">To</span></span>|<span data-ttu-id="08401-166">查看</span><span class="sxs-lookup"><span data-stu-id="08401-166">See</span></span>|  
|--------|---------|  
|<span data-ttu-id="08401-167">合并的目录路径和文件名称</span><span class="sxs-lookup"><span data-stu-id="08401-167">Combine a directory path and file name</span></span>|[<span data-ttu-id="08401-168">如何：分析文件路径</span><span class="sxs-lookup"><span data-stu-id="08401-168">How to: Parse File Paths</span></span>](~/docs/visual-basic/developing-apps/programming/drives-directories-files/how-to-parse-file-paths.md)|  
  
   
  
## Examples  
 <span data-ttu-id="08401-169">此示例将合并以创建格式正确的路径的目录路径和文件名称。</span><span class="sxs-lookup"><span data-stu-id="08401-169">This example combines a directory path and file name to create a properly formatted path.</span></span>  
  
 [!code-vb[VbRefFile#3](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbRefFile/VB/Class1.vb#3)]  
  
 <span data-ttu-id="08401-170">此示例将两个路径创建格式正确的路径合并。</span><span class="sxs-lookup"><span data-stu-id="08401-170">This example combines two paths to create a properly formatted path.</span></span>  
  
 [!code-vb[VbRefFile#4](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbRefFile/VB/Class1.vb#4)]  
  
 <span data-ttu-id="08401-171">此示例返回`C:\Dir1\Dir2\Dir4\Dir5\File.txt`。</span><span class="sxs-lookup"><span data-stu-id="08401-171">This example returns `C:\Dir1\Dir2\Dir4\Dir5\File.txt`.</span></span>  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentException"><span data-ttu-id="08401-172"><paramref name="baseDirectory" /> 或<paramref name="relativePath" />格式不正确的路径。</span><span class="sxs-lookup"><span data-stu-id="08401-172"><paramref name="baseDirectory" /> or <paramref name="relativePath" /> are malformed paths.</span></span></exception>
        <permission cref="T:System.Security.Permissions.FileIOPermission"><span data-ttu-id="08401-173">控制文件和文件夹的访问权限。</span><span class="sxs-lookup"><span data-stu-id="08401-173">Controls the ability to access files and folders.</span></span> <span data-ttu-id="08401-174">关联枚举： <see cref="F:System.Security.Permissions.PermissionState.Unrestricted" />。</span><span class="sxs-lookup"><span data-stu-id="08401-174">Associated enumeration: <see cref="F:System.Security.Permissions.PermissionState.Unrestricted" />.</span></span></permission>
        <altmember cref="M:Microsoft.VisualBasic.FileIO.FileSystem.GetParentPath(System.String)" />
        <related type="Article" href="~/docs/visual-basic/language-reference/objects/index.md"><span data-ttu-id="08401-175">对象 (Visual Basic)</span><span class="sxs-lookup"><span data-stu-id="08401-175">Objects (Visual Basic)</span></span></related>
      </Docs>
    </Member>
    <MemberGroup MemberName="CopyDirectory">
      <AssemblyInfo>
        <AssemblyName>Microsoft.VisualBasic</AssemblyName>
        <AssemblyVersion>10.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Docs>
        <summary><span data-ttu-id="08401-176">将一个目录复制到另一个目录。</span><span class="sxs-lookup"><span data-stu-id="08401-176">Copies a directory to another directory.</span></span></summary>
        <related type="Article" href="~/docs/visual-basic/language-reference/objects/index.md"><span data-ttu-id="08401-177">对象 (Visual Basic)</span><span class="sxs-lookup"><span data-stu-id="08401-177">Objects (Visual Basic)</span></span></related>
        <related type="Article" href="~/docs/visual-basic/developing-apps/programming/drives-directories-files/how-to-get-the-collection-of-files-in-a-directory.md"><span data-ttu-id="08401-178">如何：在 Visual Basic 中获取目录中的文件集合</span><span class="sxs-lookup"><span data-stu-id="08401-178">How to: Get the Collection of Files in a Directory in Visual Basic</span></span></related>
      </Docs>
    </MemberGroup>
    <Member MemberName="CopyDirectory">
      <MemberSignature Language="C#" Value="public void CopyDirectory (string sourceDirectoryName, string destinationDirectoryName);" />
      <MemberSignature Language="ILAsm" Value=".method public instance void CopyDirectory(string sourceDirectoryName, string destinationDirectoryName) cil managed" />
      <MemberSignature Language="DocId" Value="M:Microsoft.VisualBasic.MyServices.FileSystemProxy.CopyDirectory(System.String,System.String)" />
      <MemberSignature Language="VB.NET" Value="Public Sub CopyDirectory (sourceDirectoryName As String, destinationDirectoryName As String)" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; void CopyDirectory(System::String ^ sourceDirectoryName, System::String ^ destinationDirectoryName);" />
      <MemberSignature Language="F#" Value="member this.CopyDirectory : string * string -&gt; unit" Usage="fileSystemProxy.CopyDirectory (sourceDirectoryName, destinationDirectoryName)" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>Microsoft.VisualBasic</AssemblyName>
        <AssemblyVersion>8.0.0.0</AssemblyVersion>
        <AssemblyVersion>10.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <AssemblyInfo>
        <AssemblyName>Microsoft.VisualBasic.Core</AssemblyName>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Void</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="sourceDirectoryName" Type="System.String" Index="0" FrameworkAlternate="netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;netframework-4.8" />
        <Parameter Name="destinationDirectoryName" Type="System.String" Index="1" FrameworkAlternate="netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;netframework-4.8" />
      </Parameters>
      <Docs>
        <param name="sourceDirectoryName"><span data-ttu-id="08401-179">要复制的目录。</span><span class="sxs-lookup"><span data-stu-id="08401-179">The directory to be copied.</span></span></param>
        <param name="destinationDirectoryName"><span data-ttu-id="08401-180">应将目录复制到的位置。</span><span class="sxs-lookup"><span data-stu-id="08401-180">The location to which the directory should be copied.</span></span></param>
        <summary><span data-ttu-id="08401-181">将一个目录复制到另一个目录。</span><span class="sxs-lookup"><span data-stu-id="08401-181">Copies a directory to another directory.</span></span></summary>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="08401-182">此方法复制目录的内容以及目录本身。</span><span class="sxs-lookup"><span data-stu-id="08401-182">This method copies the contents of the directory as well as the directory itself.</span></span> <span data-ttu-id="08401-183">如果目标目录不存在，则创建它。</span><span class="sxs-lookup"><span data-stu-id="08401-183">If the target directory does not exist, it is created.</span></span> <span data-ttu-id="08401-184">如果在目标位置存在具有相同名称的目录，这两个目录的内容合并。</span><span class="sxs-lookup"><span data-stu-id="08401-184">If a directory with the same name exists in the target location, the contents of the two directories are merged.</span></span> <span data-ttu-id="08401-185">操作期间可为此目录指定新名称。</span><span class="sxs-lookup"><span data-stu-id="08401-185">You can specify a new name for the directory during the operation.</span></span>  
  
 <span data-ttu-id="08401-186">复制目录中的文件时，可能是由引发的异常导致的特定文件。</span><span class="sxs-lookup"><span data-stu-id="08401-186">When copying files within a directory, exceptions may be thrown that are caused by a specific file.</span></span> <span data-ttu-id="08401-187">当引发此类异常时，它们会被合并为一个异常的`Data`属性中存储的条目中的窗体<xref:System.Collections.IDictionary>其中文件或目录路径是键，特定的异常消息包含在相应的值。</span><span class="sxs-lookup"><span data-stu-id="08401-187">When such exceptions are thrown, they are consolidated into a single exception whose `Data` property holds entries in the form of an <xref:System.Collections.IDictionary> in which the file or directory path is the key and the specific exception message is contained in the corresponding value.</span></span> <span data-ttu-id="08401-188">使用`For…Each`枚举项。</span><span class="sxs-lookup"><span data-stu-id="08401-188">Use `For…Each` to enumerate through the entries.</span></span>  
  
 <span data-ttu-id="08401-189">下表列出了所涉及的任务的示例`My.Computer.FileSystem.CopyDirectory`方法。</span><span class="sxs-lookup"><span data-stu-id="08401-189">The following table lists examples of tasks involving the `My.Computer.FileSystem.CopyDirectory` method.</span></span>  
  
|<span data-ttu-id="08401-190">功能</span><span class="sxs-lookup"><span data-stu-id="08401-190">To</span></span>|<span data-ttu-id="08401-191">查看</span><span class="sxs-lookup"><span data-stu-id="08401-191">See</span></span>|  
|--------|---------|  
|<span data-ttu-id="08401-192">复制目录</span><span class="sxs-lookup"><span data-stu-id="08401-192">Copy a directory</span></span>|[<span data-ttu-id="08401-193">如何：将目录复制到另一个目录</span><span class="sxs-lookup"><span data-stu-id="08401-193">How to: Copy a Directory to Another Directory</span></span>](~/docs/visual-basic/developing-apps/programming/drives-directories-files/how-to-copy-a-directory-to-another-directory.md)|  
  
   
  
## Examples  
 <span data-ttu-id="08401-194">以下示例将复制目录`TestDirectory1`到`TestDirectory2`，覆盖现有文件。</span><span class="sxs-lookup"><span data-stu-id="08401-194">The following example copies the directory `TestDirectory1` into `TestDirectory2`, overwriting existing files.</span></span>  
  
 [!code-vb[VbVbcnMyFileSystem#49](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbcnMyFileSystem/VB/Class1.vb#49)]  
  
 <span data-ttu-id="08401-195">替换`C:\TestDirectory1`和`C:\TestDirectory2`路径和你想要复制的目录以及你想要将其复制的位置的名称。</span><span class="sxs-lookup"><span data-stu-id="08401-195">Replace `C:\TestDirectory1` and `C:\TestDirectory2` with the path and name of the directory you wish to copy and the location to which you wish to copy it.</span></span>  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentException"><span data-ttu-id="08401-196">路径由于以下原因之一无效：是零长度字符串；仅为空白；包含无效字符；是一个设备路径（以 \\\\.\\ 开头）。</span><span class="sxs-lookup"><span data-stu-id="08401-196">The path is not valid for one of the following reasons: it is a zero-length string; it contains only white space; it contains invalid characters; or it is a device path (starts with \\\\.\\).</span></span></exception>
        <exception cref="T:System.ArgumentNullException"><span data-ttu-id="08401-197"><paramref name="destinationDirectoryName" /> 或<paramref name="sourceDirectoryName" />是<see langword="Nothing" />或空字符串。</span><span class="sxs-lookup"><span data-stu-id="08401-197"><paramref name="destinationDirectoryName" /> or <paramref name="sourceDirectoryName" /> is <see langword="Nothing" /> or an empty string.</span></span></exception>
        <exception cref="T:System.IO.DirectoryNotFoundException"><span data-ttu-id="08401-198">源目录不存在。</span><span class="sxs-lookup"><span data-stu-id="08401-198">The source directory does not exist.</span></span></exception>
        <exception cref="T:System.IO.IOException"><span data-ttu-id="08401-199">源路径和目标路径是相同的。</span><span class="sxs-lookup"><span data-stu-id="08401-199">The source path and target path are the same.</span></span></exception>
        <exception cref="T:System.InvalidOperationException"><span data-ttu-id="08401-200">该操作是循环的。</span><span class="sxs-lookup"><span data-stu-id="08401-200">The operation is cyclic.</span></span></exception>
        <exception cref="T:System.IO.PathTooLongException"><span data-ttu-id="08401-201">路径超过系统定义的最大长度。</span><span class="sxs-lookup"><span data-stu-id="08401-201">The path exceeds the system-defined maximum length.</span></span></exception>
        <exception cref="T:System.NotSupportedException"><span data-ttu-id="08401-202">在路径中的文件夹名称包含冒号 （:），或格式无效。</span><span class="sxs-lookup"><span data-stu-id="08401-202">A folder name in the path contains a colon (:) or is in an invalid format.</span></span></exception>
        <exception cref="T:System.Security.SecurityException"><span data-ttu-id="08401-203">该用户缺少必要的权限查看该路径。</span><span class="sxs-lookup"><span data-stu-id="08401-203">The user lacks necessary permissions to view the path.</span></span></exception>
        <exception cref="T:System.UnauthorizedAccessException"><span data-ttu-id="08401-204">目标文件存在，但不能访问。</span><span class="sxs-lookup"><span data-stu-id="08401-204">A destination file exists but cannot be accessed.</span></span></exception>
        <permission cref="T:System.Security.Permissions.FileIOPermission"><span data-ttu-id="08401-205">控制文件和文件夹的访问权限。</span><span class="sxs-lookup"><span data-stu-id="08401-205">Controls the ability to access files and folders.</span></span> <span data-ttu-id="08401-206">关联枚举： <see cref="F:System.Security.Permissions.PermissionState.Unrestricted" />。</span><span class="sxs-lookup"><span data-stu-id="08401-206">Associated enumeration: <see cref="F:System.Security.Permissions.PermissionState.Unrestricted" />.</span></span></permission>
        <altmember cref="T:Microsoft.VisualBasic.FileIO.UICancelOption" />
        <related type="Article" href="~/docs/visual-basic/language-reference/objects/index.md"><span data-ttu-id="08401-207">对象 (Visual Basic)</span><span class="sxs-lookup"><span data-stu-id="08401-207">Objects (Visual Basic)</span></span></related>
        <related type="Article" href="~/docs/visual-basic/developing-apps/programming/drives-directories-files/how-to-get-the-collection-of-files-in-a-directory.md"><span data-ttu-id="08401-208">如何：在 Visual Basic 中获取目录中的文件集合</span><span class="sxs-lookup"><span data-stu-id="08401-208">How to: Get the Collection of Files in a Directory in Visual Basic</span></span></related>
        <related type="Article" href="~/docs/visual-basic/developing-apps/programming/drives-directories-files/how-to-parse-file-paths.md"><span data-ttu-id="08401-209">如何：在 Visual Basic 中分析文件路径</span><span class="sxs-lookup"><span data-stu-id="08401-209">How to: Parse File Paths in Visual Basic</span></span></related>
      </Docs>
    </Member>
    <Member MemberName="CopyDirectory">
      <MemberSignature Language="C#" Value="public void CopyDirectory (string sourceDirectoryName, string destinationDirectoryName, Microsoft.VisualBasic.FileIO.UIOption showUI);" />
      <MemberSignature Language="ILAsm" Value=".method public instance void CopyDirectory(string sourceDirectoryName, string destinationDirectoryName, valuetype Microsoft.VisualBasic.FileIO.UIOption showUI) cil managed" />
      <MemberSignature Language="DocId" Value="M:Microsoft.VisualBasic.MyServices.FileSystemProxy.CopyDirectory(System.String,System.String,Microsoft.VisualBasic.FileIO.UIOption)" />
      <MemberSignature Language="VB.NET" Value="Public Sub CopyDirectory (sourceDirectoryName As String, destinationDirectoryName As String, showUI As UIOption)" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; void CopyDirectory(System::String ^ sourceDirectoryName, System::String ^ destinationDirectoryName, Microsoft::VisualBasic::FileIO::UIOption showUI);" />
      <MemberSignature Language="F#" Value="member this.CopyDirectory : string * string * Microsoft.VisualBasic.FileIO.UIOption -&gt; unit" Usage="fileSystemProxy.CopyDirectory (sourceDirectoryName, destinationDirectoryName, showUI)" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>Microsoft.VisualBasic</AssemblyName>
        <AssemblyVersion>8.0.0.0</AssemblyVersion>
        <AssemblyVersion>10.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <AssemblyInfo>
        <AssemblyName>Microsoft.VisualBasic.Core</AssemblyName>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Void</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="sourceDirectoryName" Type="System.String" Index="0" FrameworkAlternate="netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;netframework-4.8" />
        <Parameter Name="destinationDirectoryName" Type="System.String" Index="1" FrameworkAlternate="netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;netframework-4.8" />
        <Parameter Name="showUI" Type="Microsoft.VisualBasic.FileIO.UIOption" Index="2" FrameworkAlternate="netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;netframework-4.8" />
      </Parameters>
      <Docs>
        <param name="sourceDirectoryName"><span data-ttu-id="08401-210">要复制的目录。</span><span class="sxs-lookup"><span data-stu-id="08401-210">The directory to be copied.</span></span></param>
        <param name="destinationDirectoryName"><span data-ttu-id="08401-211">应将目录复制到的位置。</span><span class="sxs-lookup"><span data-stu-id="08401-211">The location to which the directory should be copied.</span></span></param>
        <param name="showUI"><span data-ttu-id="08401-212">是否直观地跟踪操作的进度。</span><span class="sxs-lookup"><span data-stu-id="08401-212">Whether to visually track the operation's progress.</span></span> <span data-ttu-id="08401-213">默认值为 <see langword="UIOption.OnlyErrorDialogs" />。</span><span class="sxs-lookup"><span data-stu-id="08401-213">Default is <see langword="UIOption.OnlyErrorDialogs" />.</span></span></param>
        <summary><span data-ttu-id="08401-214">将一个目录复制到另一个目录。</span><span class="sxs-lookup"><span data-stu-id="08401-214">Copies a directory to another directory.</span></span></summary>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="08401-215">此方法复制目录的内容以及目录本身。</span><span class="sxs-lookup"><span data-stu-id="08401-215">This method copies the contents of the directory as well as the directory itself.</span></span> <span data-ttu-id="08401-216">如果目标目录不存在，则创建它。</span><span class="sxs-lookup"><span data-stu-id="08401-216">If the target directory does not exist, it is created.</span></span> <span data-ttu-id="08401-217">如果在目标位置存在具有相同名称的目录，这两个目录的内容合并。</span><span class="sxs-lookup"><span data-stu-id="08401-217">If a directory with the same name exists in the target location, the contents of the two directories are merged.</span></span> <span data-ttu-id="08401-218">操作期间可为此目录指定新名称。</span><span class="sxs-lookup"><span data-stu-id="08401-218">You can specify a new name for the directory during the operation.</span></span>  
  
 <span data-ttu-id="08401-219">复制目录中的文件时，可能是由引发的异常导致的特定文件。</span><span class="sxs-lookup"><span data-stu-id="08401-219">When copying files within a directory, exceptions may be thrown that are caused by a specific file.</span></span> <span data-ttu-id="08401-220">当引发此类异常时，它们会被合并为一个异常的`Data`属性中存储的条目中的窗体<xref:System.Collections.IDictionary>其中文件或目录路径是键，特定的异常消息包含在相应的值。</span><span class="sxs-lookup"><span data-stu-id="08401-220">When such exceptions are thrown, they are consolidated into a single exception whose `Data` property holds entries in the form of an <xref:System.Collections.IDictionary> in which the file or directory path is the key and the specific exception message is contained in the corresponding value.</span></span> <span data-ttu-id="08401-221">使用`For…Each`枚举项。</span><span class="sxs-lookup"><span data-stu-id="08401-221">Use `For…Each` to enumerate through the entries.</span></span>  
  
 <span data-ttu-id="08401-222">下表列出了所涉及的任务的示例`My.Computer.FileSystem.CopyDirectory`方法。</span><span class="sxs-lookup"><span data-stu-id="08401-222">The following table lists examples of tasks involving the `My.Computer.FileSystem.CopyDirectory` method.</span></span>  
  
|<span data-ttu-id="08401-223">功能</span><span class="sxs-lookup"><span data-stu-id="08401-223">To</span></span>|<span data-ttu-id="08401-224">查看</span><span class="sxs-lookup"><span data-stu-id="08401-224">See</span></span>|  
|--------|---------|  
|<span data-ttu-id="08401-225">复制目录</span><span class="sxs-lookup"><span data-stu-id="08401-225">Copy a directory</span></span>|[<span data-ttu-id="08401-226">如何：将目录复制到另一个目录</span><span class="sxs-lookup"><span data-stu-id="08401-226">How to: Copy a Directory to Another Directory</span></span>](~/docs/visual-basic/developing-apps/programming/drives-directories-files/how-to-copy-a-directory-to-another-directory.md)|  
  
   
  
## Examples  
 <span data-ttu-id="08401-227">以下示例将复制目录`TestDirectory1`到`TestDirectory2`，覆盖现有文件。</span><span class="sxs-lookup"><span data-stu-id="08401-227">The following example copies the directory `TestDirectory1` into `TestDirectory2`, overwriting existing files.</span></span>  
  
 [!code-vb[VbVbcnMyFileSystem#49](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbcnMyFileSystem/VB/Class1.vb#49)]  
  
 <span data-ttu-id="08401-228">替换`C:\TestDirectory1`和`C:\TestDirectory2`路径和你想要复制的目录以及你想要将其复制的位置的名称。</span><span class="sxs-lookup"><span data-stu-id="08401-228">Replace `C:\TestDirectory1` and `C:\TestDirectory2` with the path and name of the directory you wish to copy and the location to which you wish to copy it.</span></span>  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentException"><span data-ttu-id="08401-229">路径由于以下原因之一无效：是零长度字符串；仅为空白；包含无效字符；是一个设备路径（以 \\\\.\\ 开头）。</span><span class="sxs-lookup"><span data-stu-id="08401-229">The path is not valid for one of the following reasons: it is a zero-length string; it contains only white space; it contains invalid characters; or it is a device path (starts with \\\\.\\).</span></span></exception>
        <exception cref="T:System.ArgumentNullException"><span data-ttu-id="08401-230"><paramref name="destinationDirectoryName" /> 或<paramref name="sourceDirectoryName" />是<see langword="Nothing" />或空字符串。</span><span class="sxs-lookup"><span data-stu-id="08401-230"><paramref name="destinationDirectoryName" /> or <paramref name="sourceDirectoryName" /> is <see langword="Nothing" /> or an empty string.</span></span></exception>
        <exception cref="T:System.IO.DirectoryNotFoundException"><span data-ttu-id="08401-231">源目录不存在。</span><span class="sxs-lookup"><span data-stu-id="08401-231">The source directory does not exist.</span></span></exception>
        <exception cref="T:System.IO.IOException"><span data-ttu-id="08401-232">源路径和目标路径是相同的。</span><span class="sxs-lookup"><span data-stu-id="08401-232">The source path and target path are the same.</span></span></exception>
        <exception cref="T:System.InvalidOperationException"><span data-ttu-id="08401-233">该操作是循环的。</span><span class="sxs-lookup"><span data-stu-id="08401-233">The operation is cyclic.</span></span></exception>
        <exception cref="T:System.IO.PathTooLongException"><span data-ttu-id="08401-234">路径超过系统定义的最大长度。</span><span class="sxs-lookup"><span data-stu-id="08401-234">The path exceeds the system-defined maximum length.</span></span></exception>
        <exception cref="T:System.NotSupportedException"><span data-ttu-id="08401-235">在路径中的文件夹名称包含冒号 （:），或格式无效。</span><span class="sxs-lookup"><span data-stu-id="08401-235">A folder name in the path contains a colon (:) or is in an invalid format.</span></span></exception>
        <exception cref="T:System.Security.SecurityException"><span data-ttu-id="08401-236">该用户缺少必要的权限查看该路径。</span><span class="sxs-lookup"><span data-stu-id="08401-236">The user lacks necessary permissions to view the path.</span></span></exception>
        <exception cref="T:System.UnauthorizedAccessException"><span data-ttu-id="08401-237">目标文件存在，但不能访问。</span><span class="sxs-lookup"><span data-stu-id="08401-237">A destination file exists but cannot be accessed.</span></span></exception>
        <exception cref="T:System.OperationCanceledException"><span data-ttu-id="08401-238"><paramref name="ShowUI" /> 设置为<see langword="UIOption.AllDialogs" />并且用户取消了操作，或不能复制目录中的一个或多个文件。</span><span class="sxs-lookup"><span data-stu-id="08401-238"><paramref name="ShowUI" /> is set to <see langword="UIOption.AllDialogs" /> and the user cancels the operation, or one or more files in the directory cannot be copied.</span></span></exception>
        <permission cref="T:System.Security.Permissions.FileIOPermission"><span data-ttu-id="08401-239">控制文件和文件夹的访问权限。</span><span class="sxs-lookup"><span data-stu-id="08401-239">Controls the ability to access files and folders.</span></span> <span data-ttu-id="08401-240">关联枚举： <see cref="F:System.Security.Permissions.PermissionState.Unrestricted" />。</span><span class="sxs-lookup"><span data-stu-id="08401-240">Associated enumeration: <see cref="F:System.Security.Permissions.PermissionState.Unrestricted" />.</span></span></permission>
        <permission cref="T:System.Security.Permissions.UIPermission"><span data-ttu-id="08401-241">控制与用户界面和剪贴板相关的权限。</span><span class="sxs-lookup"><span data-stu-id="08401-241">Controls the permissions related to user interfaces and the clipboard.</span></span> <span data-ttu-id="08401-242">关联枚举： <see cref="F:System.Security.Permissions.UIPermissionWindow.SafeSubWindows" />。</span><span class="sxs-lookup"><span data-stu-id="08401-242">Associated enumeration: <see cref="F:System.Security.Permissions.UIPermissionWindow.SafeSubWindows" />.</span></span></permission>
        <altmember cref="T:Microsoft.VisualBasic.FileIO.UICancelOption" />
        <related type="Article" href="~/docs/visual-basic/language-reference/objects/index.md"><span data-ttu-id="08401-243">对象 (Visual Basic)</span><span class="sxs-lookup"><span data-stu-id="08401-243">Objects (Visual Basic)</span></span></related>
        <related type="Article" href="~/docs/visual-basic/developing-apps/programming/drives-directories-files/how-to-get-the-collection-of-files-in-a-directory.md"><span data-ttu-id="08401-244">如何：在 Visual Basic 中获取目录中的文件集合</span><span class="sxs-lookup"><span data-stu-id="08401-244">How to: Get the Collection of Files in a Directory in Visual Basic</span></span></related>
        <related type="Article" href="~/docs/visual-basic/developing-apps/programming/drives-directories-files/how-to-parse-file-paths.md"><span data-ttu-id="08401-245">如何：在 Visual Basic 中分析文件路径</span><span class="sxs-lookup"><span data-stu-id="08401-245">How to: Parse File Paths in Visual Basic</span></span></related>
      </Docs>
    </Member>
    <Member MemberName="CopyDirectory">
      <MemberSignature Language="C#" Value="public void CopyDirectory (string sourceDirectoryName, string destinationDirectoryName, bool overwrite);" />
      <MemberSignature Language="ILAsm" Value=".method public instance void CopyDirectory(string sourceDirectoryName, string destinationDirectoryName, bool overwrite) cil managed" />
      <MemberSignature Language="DocId" Value="M:Microsoft.VisualBasic.MyServices.FileSystemProxy.CopyDirectory(System.String,System.String,System.Boolean)" />
      <MemberSignature Language="VB.NET" Value="Public Sub CopyDirectory (sourceDirectoryName As String, destinationDirectoryName As String, overwrite As Boolean)" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; void CopyDirectory(System::String ^ sourceDirectoryName, System::String ^ destinationDirectoryName, bool overwrite);" />
      <MemberSignature Language="F#" Value="member this.CopyDirectory : string * string * bool -&gt; unit" Usage="fileSystemProxy.CopyDirectory (sourceDirectoryName, destinationDirectoryName, overwrite)" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>Microsoft.VisualBasic</AssemblyName>
        <AssemblyVersion>8.0.0.0</AssemblyVersion>
        <AssemblyVersion>10.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <AssemblyInfo>
        <AssemblyName>Microsoft.VisualBasic.Core</AssemblyName>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Void</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="sourceDirectoryName" Type="System.String" Index="0" FrameworkAlternate="netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;netframework-4.8" />
        <Parameter Name="destinationDirectoryName" Type="System.String" Index="1" FrameworkAlternate="netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;netframework-4.8" />
        <Parameter Name="overwrite" Type="System.Boolean" Index="2" FrameworkAlternate="netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;netframework-4.8" />
      </Parameters>
      <Docs>
        <param name="sourceDirectoryName"><span data-ttu-id="08401-246">要复制的目录。</span><span class="sxs-lookup"><span data-stu-id="08401-246">The directory to be copied.</span></span></param>
        <param name="destinationDirectoryName"><span data-ttu-id="08401-247">应将目录复制到的位置。</span><span class="sxs-lookup"><span data-stu-id="08401-247">The location to which the directory should be copied.</span></span></param>
        <param name="overwrite"><span data-ttu-id="08401-248"><see langword="True" /> 若要覆盖现有文件;否则为<see langword="False" />。</span><span class="sxs-lookup"><span data-stu-id="08401-248"><see langword="True" /> to overwrite existing files; otherwise <see langword="False" />.</span></span> <span data-ttu-id="08401-249">默认值为 <see langword="False" />。</span><span class="sxs-lookup"><span data-stu-id="08401-249">Default is <see langword="False" />.</span></span></param>
        <summary><span data-ttu-id="08401-250">将一个目录复制到另一个目录。</span><span class="sxs-lookup"><span data-stu-id="08401-250">Copies a directory to another directory.</span></span></summary>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="08401-251">此方法复制目录的内容以及目录本身。</span><span class="sxs-lookup"><span data-stu-id="08401-251">This method copies the contents of the directory as well as the directory itself.</span></span> <span data-ttu-id="08401-252">如果目标目录不存在，则创建它。</span><span class="sxs-lookup"><span data-stu-id="08401-252">If the target directory does not exist, it is created.</span></span> <span data-ttu-id="08401-253">如果在目标位置存在具有相同名称的目录，这两个目录的内容合并。</span><span class="sxs-lookup"><span data-stu-id="08401-253">If a directory with the same name exists in the target location, the contents of the two directories are merged.</span></span> <span data-ttu-id="08401-254">操作期间可为此目录指定新名称。</span><span class="sxs-lookup"><span data-stu-id="08401-254">You can specify a new name for the directory during the operation.</span></span>  
  
 <span data-ttu-id="08401-255">复制目录中的文件时，可能会引发异常导致的特定文件，如文件时在合并期间`overwrite`设置为`False`。</span><span class="sxs-lookup"><span data-stu-id="08401-255">When copying files within a directory, exceptions may be thrown that are caused by a specific file, such as a file existing during a merge while `overwrite` is set to `False`.</span></span> <span data-ttu-id="08401-256">当引发此类异常时，它们会被合并为一个异常的`Data`属性中存储的条目中的窗体<xref:System.Collections.IDictionary>其中文件或目录路径是键，特定的异常消息包含在相应的值。</span><span class="sxs-lookup"><span data-stu-id="08401-256">When such exceptions are thrown, they are consolidated into a single exception whose `Data` property holds entries in the form of an <xref:System.Collections.IDictionary> in which the file or directory path is the key and the specific exception message is contained in the corresponding value.</span></span> <span data-ttu-id="08401-257">使用`For…Each`枚举项。</span><span class="sxs-lookup"><span data-stu-id="08401-257">Use `For…Each` to enumerate through the entries.</span></span>  
  
 <span data-ttu-id="08401-258">下表列出了所涉及的任务的示例`My.Computer.FileSystem.CopyDirectory`方法。</span><span class="sxs-lookup"><span data-stu-id="08401-258">The following table lists examples of tasks involving the `My.Computer.FileSystem.CopyDirectory` method.</span></span>  
  
|<span data-ttu-id="08401-259">功能</span><span class="sxs-lookup"><span data-stu-id="08401-259">To</span></span>|<span data-ttu-id="08401-260">查看</span><span class="sxs-lookup"><span data-stu-id="08401-260">See</span></span>|  
|--------|---------|  
|<span data-ttu-id="08401-261">复制目录</span><span class="sxs-lookup"><span data-stu-id="08401-261">Copy a directory</span></span>|[<span data-ttu-id="08401-262">如何：将目录复制到另一个目录</span><span class="sxs-lookup"><span data-stu-id="08401-262">How to: Copy a Directory to Another Directory</span></span>](~/docs/visual-basic/developing-apps/programming/drives-directories-files/how-to-copy-a-directory-to-another-directory.md)|  
  
   
  
## Examples  
 <span data-ttu-id="08401-263">以下示例将复制目录`TestDirectory1`到`TestDirectory2`，覆盖现有文件。</span><span class="sxs-lookup"><span data-stu-id="08401-263">The following example copies the directory `TestDirectory1` into `TestDirectory2`, overwriting existing files.</span></span>  
  
 [!code-vb[VbVbcnMyFileSystem#49](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbcnMyFileSystem/VB/Class1.vb#49)]  
  
 <span data-ttu-id="08401-264">替换`C:\TestDirectory1`和`C:\TestDirectory2`路径和你想要复制的目录以及你想要将其复制的位置的名称。</span><span class="sxs-lookup"><span data-stu-id="08401-264">Replace `C:\TestDirectory1` and `C:\TestDirectory2` with the path and name of the directory you wish to copy and the location to which you wish to copy it.</span></span>  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentException"><span data-ttu-id="08401-265">路径由于以下原因之一无效：是零长度字符串；仅为空白；包含无效字符；是一个设备路径（以 \\\\.\\ 开头）。</span><span class="sxs-lookup"><span data-stu-id="08401-265">The path is not valid for one of the following reasons: it is a zero-length string; it contains only white space; it contains invalid characters; or it is a device path (starts with \\\\.\\).</span></span></exception>
        <exception cref="T:System.ArgumentNullException"><span data-ttu-id="08401-266"><paramref name="destinationDirectoryName" /> 或<paramref name="sourceDirectoryName" />是<see langword="Nothing" />或空字符串。</span><span class="sxs-lookup"><span data-stu-id="08401-266"><paramref name="destinationDirectoryName" /> or <paramref name="sourceDirectoryName" /> is <see langword="Nothing" /> or an empty string.</span></span></exception>
        <exception cref="T:System.IO.DirectoryNotFoundException"><span data-ttu-id="08401-267">源目录不存在。</span><span class="sxs-lookup"><span data-stu-id="08401-267">The source directory does not exist.</span></span></exception>
        <exception cref="T:System.IO.IOException"><span data-ttu-id="08401-268">源路径和目标路径是相同的。</span><span class="sxs-lookup"><span data-stu-id="08401-268">The source path and target path are the same.</span></span></exception>
        <exception cref="T:System.InvalidOperationException"><span data-ttu-id="08401-269">该操作是循环的。</span><span class="sxs-lookup"><span data-stu-id="08401-269">The operation is cyclic.</span></span></exception>
        <exception cref="T:System.IO.PathTooLongException"><span data-ttu-id="08401-270">路径超过系统定义的最大长度。</span><span class="sxs-lookup"><span data-stu-id="08401-270">The path exceeds the system-defined maximum length.</span></span></exception>
        <exception cref="T:System.NotSupportedException"><span data-ttu-id="08401-271">在路径中的文件夹名称包含冒号 （:），或格式无效。</span><span class="sxs-lookup"><span data-stu-id="08401-271">A folder name in the path contains a colon (:) or is in an invalid format.</span></span></exception>
        <exception cref="T:System.Security.SecurityException"><span data-ttu-id="08401-272">该用户缺少必要的权限查看该路径。</span><span class="sxs-lookup"><span data-stu-id="08401-272">The user lacks necessary permissions to view the path.</span></span></exception>
        <exception cref="T:System.UnauthorizedAccessException"><span data-ttu-id="08401-273">目标文件存在，但不能访问。</span><span class="sxs-lookup"><span data-stu-id="08401-273">A destination file exists but cannot be accessed.</span></span></exception>
        <permission cref="T:System.Security.Permissions.FileIOPermission"><span data-ttu-id="08401-274">控制文件和文件夹的访问权限。</span><span class="sxs-lookup"><span data-stu-id="08401-274">Controls the ability to access files and folders.</span></span> <span data-ttu-id="08401-275">关联枚举： <see cref="F:System.Security.Permissions.PermissionState.Unrestricted" />。</span><span class="sxs-lookup"><span data-stu-id="08401-275">Associated enumeration: <see cref="F:System.Security.Permissions.PermissionState.Unrestricted" />.</span></span></permission>
        <altmember cref="T:Microsoft.VisualBasic.FileIO.UICancelOption" />
        <related type="Article" href="~/docs/visual-basic/language-reference/objects/index.md"><span data-ttu-id="08401-276">对象 (Visual Basic)</span><span class="sxs-lookup"><span data-stu-id="08401-276">Objects (Visual Basic)</span></span></related>
        <related type="Article" href="~/docs/visual-basic/developing-apps/programming/drives-directories-files/how-to-get-the-collection-of-files-in-a-directory.md"><span data-ttu-id="08401-277">如何：在 Visual Basic 中获取目录中的文件集合</span><span class="sxs-lookup"><span data-stu-id="08401-277">How to: Get the Collection of Files in a Directory in Visual Basic</span></span></related>
        <related type="Article" href="~/docs/visual-basic/developing-apps/programming/drives-directories-files/how-to-parse-file-paths.md"><span data-ttu-id="08401-278">如何：在 Visual Basic 中分析文件路径</span><span class="sxs-lookup"><span data-stu-id="08401-278">How to: Parse File Paths in Visual Basic</span></span></related>
      </Docs>
    </Member>
    <Member MemberName="CopyDirectory">
      <MemberSignature Language="C#" Value="public void CopyDirectory (string sourceDirectoryName, string destinationDirectoryName, Microsoft.VisualBasic.FileIO.UIOption showUI, Microsoft.VisualBasic.FileIO.UICancelOption onUserCancel);" />
      <MemberSignature Language="ILAsm" Value=".method public instance void CopyDirectory(string sourceDirectoryName, string destinationDirectoryName, valuetype Microsoft.VisualBasic.FileIO.UIOption showUI, valuetype Microsoft.VisualBasic.FileIO.UICancelOption onUserCancel) cil managed" />
      <MemberSignature Language="DocId" Value="M:Microsoft.VisualBasic.MyServices.FileSystemProxy.CopyDirectory(System.String,System.String,Microsoft.VisualBasic.FileIO.UIOption,Microsoft.VisualBasic.FileIO.UICancelOption)" />
      <MemberSignature Language="VB.NET" Value="Public Sub CopyDirectory (sourceDirectoryName As String, destinationDirectoryName As String, showUI As UIOption, onUserCancel As UICancelOption)" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; void CopyDirectory(System::String ^ sourceDirectoryName, System::String ^ destinationDirectoryName, Microsoft::VisualBasic::FileIO::UIOption showUI, Microsoft::VisualBasic::FileIO::UICancelOption onUserCancel);" />
      <MemberSignature Language="F#" Value="member this.CopyDirectory : string * string * Microsoft.VisualBasic.FileIO.UIOption * Microsoft.VisualBasic.FileIO.UICancelOption -&gt; unit" Usage="fileSystemProxy.CopyDirectory (sourceDirectoryName, destinationDirectoryName, showUI, onUserCancel)" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>Microsoft.VisualBasic</AssemblyName>
        <AssemblyVersion>8.0.0.0</AssemblyVersion>
        <AssemblyVersion>10.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <AssemblyInfo>
        <AssemblyName>Microsoft.VisualBasic.Core</AssemblyName>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Void</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="sourceDirectoryName" Type="System.String" Index="0" FrameworkAlternate="netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;netframework-4.8" />
        <Parameter Name="destinationDirectoryName" Type="System.String" Index="1" FrameworkAlternate="netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;netframework-4.8" />
        <Parameter Name="showUI" Type="Microsoft.VisualBasic.FileIO.UIOption" Index="2" FrameworkAlternate="netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;netframework-4.8" />
        <Parameter Name="onUserCancel" Type="Microsoft.VisualBasic.FileIO.UICancelOption" Index="3" FrameworkAlternate="netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;netframework-4.8" />
      </Parameters>
      <Docs>
        <param name="sourceDirectoryName"><span data-ttu-id="08401-279">要复制的目录。</span><span class="sxs-lookup"><span data-stu-id="08401-279">The directory to be copied.</span></span></param>
        <param name="destinationDirectoryName"><span data-ttu-id="08401-280">应将目录复制到的位置。</span><span class="sxs-lookup"><span data-stu-id="08401-280">The location to which the directory should be copied.</span></span></param>
        <param name="showUI"><span data-ttu-id="08401-281">是否直观地跟踪操作的进度。</span><span class="sxs-lookup"><span data-stu-id="08401-281">Whether to visually track the operation's progress.</span></span> <span data-ttu-id="08401-282">默认值为 <see langword="UIOption.OnlyErrorDialogs" />。</span><span class="sxs-lookup"><span data-stu-id="08401-282">Default is <see langword="UIOption.OnlyErrorDialogs" />.</span></span></param>
        <param name="onUserCancel"><span data-ttu-id="08401-283">指定当用户在操作过程中单击“取消”时应执行的操作。</span><span class="sxs-lookup"><span data-stu-id="08401-283">Specifies what should be done if the user clicks **Cancel** during the operation.</span></span> <span data-ttu-id="08401-284">默认值为 <see cref="F:Microsoft.VisualBasic.FileIO.UICancelOption.ThrowException" />。</span><span class="sxs-lookup"><span data-stu-id="08401-284">Default is <see cref="F:Microsoft.VisualBasic.FileIO.UICancelOption.ThrowException" />.</span></span></param>
        <summary><span data-ttu-id="08401-285">将一个目录复制到另一个目录。</span><span class="sxs-lookup"><span data-stu-id="08401-285">Copies a directory to another directory.</span></span></summary>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="08401-286">此方法复制目录的内容以及目录本身。</span><span class="sxs-lookup"><span data-stu-id="08401-286">This method copies the contents of the directory as well as the directory itself.</span></span> <span data-ttu-id="08401-287">如果目标目录不存在，则创建它。</span><span class="sxs-lookup"><span data-stu-id="08401-287">If the target directory does not exist, it is created.</span></span> <span data-ttu-id="08401-288">如果在目标位置存在具有相同名称的目录，这两个目录的内容合并。</span><span class="sxs-lookup"><span data-stu-id="08401-288">If a directory with the same name exists in the target location, the contents of the two directories are merged.</span></span> <span data-ttu-id="08401-289">操作期间可为此目录指定新名称。</span><span class="sxs-lookup"><span data-stu-id="08401-289">You can specify a new name for the directory during the operation.</span></span>  
  
 <span data-ttu-id="08401-290">复制目录中的文件时，可能是由引发的异常导致的特定文件。</span><span class="sxs-lookup"><span data-stu-id="08401-290">When copying files within a directory, exceptions may be thrown that are caused by a specific file.</span></span> <span data-ttu-id="08401-291">当引发此类异常时，它们会被合并为一个异常的`Data`属性中存储的条目中的窗体<xref:System.Collections.IDictionary>其中文件或目录路径是键，特定的异常消息包含在相应的值。</span><span class="sxs-lookup"><span data-stu-id="08401-291">When such exceptions are thrown, they are consolidated into a single exception whose `Data` property holds entries in the form of an <xref:System.Collections.IDictionary> in which the file or directory path is the key and the specific exception message is contained in the corresponding value.</span></span> <span data-ttu-id="08401-292">使用`For…Each`枚举项。</span><span class="sxs-lookup"><span data-stu-id="08401-292">Use `For…Each` to enumerate through the entries.</span></span>  
  
 <span data-ttu-id="08401-293">下表列出了所涉及的任务的示例`My.Computer.FileSystem.CopyDirectory`方法。</span><span class="sxs-lookup"><span data-stu-id="08401-293">The following table lists examples of tasks involving the `My.Computer.FileSystem.CopyDirectory` method.</span></span>  
  
|<span data-ttu-id="08401-294">功能</span><span class="sxs-lookup"><span data-stu-id="08401-294">To</span></span>|<span data-ttu-id="08401-295">查看</span><span class="sxs-lookup"><span data-stu-id="08401-295">See</span></span>|  
|--------|---------|  
|<span data-ttu-id="08401-296">复制目录</span><span class="sxs-lookup"><span data-stu-id="08401-296">Copy a directory</span></span>|[<span data-ttu-id="08401-297">如何：将目录复制到另一个目录</span><span class="sxs-lookup"><span data-stu-id="08401-297">How to: Copy a Directory to Another Directory</span></span>](~/docs/visual-basic/developing-apps/programming/drives-directories-files/how-to-copy-a-directory-to-another-directory.md)|  
  
   
  
## Examples  
 <span data-ttu-id="08401-298">以下示例将复制目录`TestDirectory1`到`TestDirectory2`，覆盖现有文件。</span><span class="sxs-lookup"><span data-stu-id="08401-298">The following example copies the directory `TestDirectory1` into `TestDirectory2`, overwriting existing files.</span></span>  
  
 [!code-vb[VbVbcnMyFileSystem#49](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbcnMyFileSystem/VB/Class1.vb#49)]  
  
 <span data-ttu-id="08401-299">替换`C:\TestDirectory1`和`C:\TestDirectory2`路径和你想要复制的目录以及你想要将其复制的位置的名称。</span><span class="sxs-lookup"><span data-stu-id="08401-299">Replace `C:\TestDirectory1` and `C:\TestDirectory2` with the path and name of the directory you wish to copy and the location to which you wish to copy it.</span></span>  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentException"><span data-ttu-id="08401-300">路径由于以下原因之一无效：是零长度字符串；仅为空白；包含无效字符；是一个设备路径（以 \\\\.\\ 开头）。</span><span class="sxs-lookup"><span data-stu-id="08401-300">The path is not valid for one of the following reasons: it is a zero-length string; it contains only white space; it contains invalid characters; or it is a device path (starts with \\\\.\\).</span></span></exception>
        <exception cref="T:System.ArgumentNullException"><span data-ttu-id="08401-301"><paramref name="destinationDirectoryName" /> 或<paramref name="sourceDirectoryName" />是<see langword="Nothing" />或空字符串。</span><span class="sxs-lookup"><span data-stu-id="08401-301"><paramref name="destinationDirectoryName" /> or <paramref name="sourceDirectoryName" /> is <see langword="Nothing" /> or an empty string.</span></span></exception>
        <exception cref="T:System.IO.DirectoryNotFoundException"><span data-ttu-id="08401-302">源目录不存在。</span><span class="sxs-lookup"><span data-stu-id="08401-302">The source directory does not exist.</span></span></exception>
        <exception cref="T:System.IO.IOException"><span data-ttu-id="08401-303">源路径和目标路径是相同的。</span><span class="sxs-lookup"><span data-stu-id="08401-303">The source path and target path are the same.</span></span></exception>
        <exception cref="T:System.InvalidOperationException"><span data-ttu-id="08401-304">该操作是循环的。</span><span class="sxs-lookup"><span data-stu-id="08401-304">The operation is cyclic.</span></span></exception>
        <exception cref="T:System.IO.PathTooLongException"><span data-ttu-id="08401-305">路径超过系统定义的最大长度。</span><span class="sxs-lookup"><span data-stu-id="08401-305">The path exceeds the system-defined maximum length.</span></span></exception>
        <exception cref="T:System.NotSupportedException"><span data-ttu-id="08401-306">在路径中的文件夹名称包含冒号 （:），或格式无效。</span><span class="sxs-lookup"><span data-stu-id="08401-306">A folder name in the path contains a colon (:) or is in an invalid format.</span></span></exception>
        <exception cref="T:System.Security.SecurityException"><span data-ttu-id="08401-307">该用户缺少必要的权限查看该路径。</span><span class="sxs-lookup"><span data-stu-id="08401-307">The user lacks necessary permissions to view the path.</span></span></exception>
        <exception cref="T:System.UnauthorizedAccessException"><span data-ttu-id="08401-308">目标文件存在，但不能访问。</span><span class="sxs-lookup"><span data-stu-id="08401-308">A destination file exists but cannot be accessed.</span></span></exception>
        <exception cref="T:System.OperationCanceledException"><span data-ttu-id="08401-309"><paramref name="ShowUI" /> 设置为<see langword="UIOption.AllDialogs" />并且用户取消了操作，或不能复制目录中的一个或多个文件。</span><span class="sxs-lookup"><span data-stu-id="08401-309"><paramref name="ShowUI" /> is set to <see langword="UIOption.AllDialogs" /> and the user cancels the operation, or one or more files in the directory cannot be copied.</span></span></exception>
        <permission cref="T:System.Security.Permissions.FileIOPermission"><span data-ttu-id="08401-310">控制文件和文件夹的访问权限。</span><span class="sxs-lookup"><span data-stu-id="08401-310">Controls the ability to access files and folders.</span></span> <span data-ttu-id="08401-311">关联枚举： <see cref="F:System.Security.Permissions.PermissionState.Unrestricted" />。</span><span class="sxs-lookup"><span data-stu-id="08401-311">Associated enumeration: <see cref="F:System.Security.Permissions.PermissionState.Unrestricted" />.</span></span></permission>
        <permission cref="T:System.Security.Permissions.UIPermission"><span data-ttu-id="08401-312">控制与用户界面和剪贴板相关的权限。</span><span class="sxs-lookup"><span data-stu-id="08401-312">Controls the permissions related to user interfaces and the clipboard.</span></span> <span data-ttu-id="08401-313">关联枚举： <see cref="F:System.Security.Permissions.UIPermissionWindow.SafeSubWindows" />。</span><span class="sxs-lookup"><span data-stu-id="08401-313">Associated enumeration: <see cref="F:System.Security.Permissions.UIPermissionWindow.SafeSubWindows" />.</span></span></permission>
        <altmember cref="T:Microsoft.VisualBasic.FileIO.UICancelOption" />
        <related type="Article" href="~/docs/visual-basic/language-reference/objects/index.md"><span data-ttu-id="08401-314">对象 (Visual Basic)</span><span class="sxs-lookup"><span data-stu-id="08401-314">Objects (Visual Basic)</span></span></related>
        <related type="Article" href="~/docs/visual-basic/developing-apps/programming/drives-directories-files/how-to-get-the-collection-of-files-in-a-directory.md"><span data-ttu-id="08401-315">如何：在 Visual Basic 中获取目录中的文件集合</span><span class="sxs-lookup"><span data-stu-id="08401-315">How to: Get the Collection of Files in a Directory in Visual Basic</span></span></related>
        <related type="Article" href="~/docs/visual-basic/developing-apps/programming/drives-directories-files/how-to-parse-file-paths.md"><span data-ttu-id="08401-316">如何：在 Visual Basic 中分析文件路径</span><span class="sxs-lookup"><span data-stu-id="08401-316">How to: Parse File Paths in Visual Basic</span></span></related>
      </Docs>
    </Member>
    <MemberGroup MemberName="CopyFile">
      <AssemblyInfo>
        <AssemblyName>Microsoft.VisualBasic</AssemblyName>
        <AssemblyVersion>10.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Docs>
        <summary><span data-ttu-id="08401-317">将文件复制到新位置。</span><span class="sxs-lookup"><span data-stu-id="08401-317">Copies a file to a new location.</span></span></summary>
        <related type="Article" href="~/docs/visual-basic/language-reference/objects/index.md"><span data-ttu-id="08401-318">对象 (Visual Basic)</span><span class="sxs-lookup"><span data-stu-id="08401-318">Objects (Visual Basic)</span></span></related>
        <related type="Article" href="~/docs/visual-basic/developing-apps/programming/drives-directories-files/how-to-copy-files-with-a-specific-pattern-to-a-directory.md"><span data-ttu-id="08401-319">如何：在 Visual Basic 中将具有特定模式的文件复制到目录中</span><span class="sxs-lookup"><span data-stu-id="08401-319">How to: Copy Files with a Specific Pattern to a Directory in Visual Basic</span></span></related>
        <related type="Article" href="~/docs/visual-basic/developing-apps/programming/drives-directories-files/how-to-create-a-copy-of-a-file-in-the-same-directory.md"><span data-ttu-id="08401-320">如何：在同一目录中创建文件副本 (Visual Basic)</span><span class="sxs-lookup"><span data-stu-id="08401-320">How to: Create a Copy of a File in the Same Directory in Visual Basic</span></span></related>
        <related type="Article" href="~/docs/visual-basic/developing-apps/programming/drives-directories-files/how-to-copy-a-directory-to-another-directory.md"><span data-ttu-id="08401-321">如何：在 Visual Basic 中将一个目录复制到另一个目录</span><span class="sxs-lookup"><span data-stu-id="08401-321">How to: Copy a Directory to Another Directory in Visual Basic</span></span></related>
        <related type="Article" href="~/docs/visual-basic/developing-apps/programming/drives-directories-files/how-to-rename-a-file.md"><span data-ttu-id="08401-322">如何：在 Visual Basic 中重命名文件</span><span class="sxs-lookup"><span data-stu-id="08401-322">How to: Rename a File in Visual Basic</span></span></related>
      </Docs>
    </MemberGroup>
    <Member MemberName="CopyFile">
      <MemberSignature Language="C#" Value="public void CopyFile (string sourceFileName, string destinationFileName);" />
      <MemberSignature Language="ILAsm" Value=".method public instance void CopyFile(string sourceFileName, string destinationFileName) cil managed" />
      <MemberSignature Language="DocId" Value="M:Microsoft.VisualBasic.MyServices.FileSystemProxy.CopyFile(System.String,System.String)" />
      <MemberSignature Language="VB.NET" Value="Public Sub CopyFile (sourceFileName As String, destinationFileName As String)" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; void CopyFile(System::String ^ sourceFileName, System::String ^ destinationFileName);" />
      <MemberSignature Language="F#" Value="member this.CopyFile : string * string -&gt; unit" Usage="fileSystemProxy.CopyFile (sourceFileName, destinationFileName)" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>Microsoft.VisualBasic</AssemblyName>
        <AssemblyVersion>8.0.0.0</AssemblyVersion>
        <AssemblyVersion>10.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <AssemblyInfo>
        <AssemblyName>Microsoft.VisualBasic.Core</AssemblyName>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Void</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="sourceFileName" Type="System.String" Index="0" FrameworkAlternate="netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;netframework-4.8" />
        <Parameter Name="destinationFileName" Type="System.String" Index="1" FrameworkAlternate="netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;netframework-4.8" />
      </Parameters>
      <Docs>
        <param name="sourceFileName"><span data-ttu-id="08401-323">要复制的文件。</span><span class="sxs-lookup"><span data-stu-id="08401-323">The file to be copied.</span></span></param>
        <param name="destinationFileName"><span data-ttu-id="08401-324">应将文件复制到的位置。</span><span class="sxs-lookup"><span data-stu-id="08401-324">The location to which the file should be copied.</span></span></param>
        <summary><span data-ttu-id="08401-325">将文件复制到新位置。</span><span class="sxs-lookup"><span data-stu-id="08401-325">Copies a file to a new location.</span></span></summary>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="08401-326">`CopyFile` 不会保留 Ace （访问控制项）。</span><span class="sxs-lookup"><span data-stu-id="08401-326">`CopyFile` does not preserve ACEs (Access Control Entries).</span></span> <span data-ttu-id="08401-327">新创建的文件默认 Ace 继承在其中创建的目录。</span><span class="sxs-lookup"><span data-stu-id="08401-327">The newly created file inherits default ACEs from the directory in which it is created.</span></span>  
  
 <span data-ttu-id="08401-328">下表列出了所涉及的任务的示例`My.Computer.FileSystem.CopyFile`方法。</span><span class="sxs-lookup"><span data-stu-id="08401-328">The following table lists examples of tasks involving the `My.Computer.FileSystem.CopyFile` method.</span></span>  
  
|<span data-ttu-id="08401-329">功能</span><span class="sxs-lookup"><span data-stu-id="08401-329">To</span></span>|<span data-ttu-id="08401-330">查看</span><span class="sxs-lookup"><span data-stu-id="08401-330">See</span></span>|  
|--------|---------|  
|<span data-ttu-id="08401-331">将文件复制到相同的目录。</span><span class="sxs-lookup"><span data-stu-id="08401-331">Copy a file to the same directory.</span></span>|[<span data-ttu-id="08401-332">如何：在同一目录中创建文件副本</span><span class="sxs-lookup"><span data-stu-id="08401-332">How to: Create a Copy of a File in the Same Directory</span></span>](~/docs/visual-basic/developing-apps/programming/drives-directories-files/how-to-create-a-copy-of-a-file-in-the-same-directory.md)|  
|<span data-ttu-id="08401-333">将文件复制到其他目录。</span><span class="sxs-lookup"><span data-stu-id="08401-333">Copy a file to a different directory.</span></span>|[<span data-ttu-id="08401-334">如何：在不同的目录中创建文件的副本</span><span class="sxs-lookup"><span data-stu-id="08401-334">How to: Create a Copy of a File in a Different Directory</span></span>](~/docs/visual-basic/developing-apps/programming/drives-directories-files/how-to-create-a-copy-of-a-file-in-a-different-directory.md)|  
  
   
  
## Examples  
 <span data-ttu-id="08401-335">此示例将文件复制`Test.txt`到目录`TestFiles2`而不会覆盖现有文件。</span><span class="sxs-lookup"><span data-stu-id="08401-335">This example copies the file `Test.txt` to the directory `TestFiles2` without overwriting existing files.</span></span>  
  
 [!code-vb[VbRefFile#15](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbRefFile/VB/Class1.vb#15)]  
  
 <span data-ttu-id="08401-336">文件路径替换为要在代码中使用的路径。</span><span class="sxs-lookup"><span data-stu-id="08401-336">Replace the file paths with the paths you want to use in your code.</span></span>  
  
 <span data-ttu-id="08401-337">此示例将文件复制`Test.txt`到目录`TestFiles2`并将其重命名`NewFile.txt`。</span><span class="sxs-lookup"><span data-stu-id="08401-337">This example copies the file `Test.txt` to the directory `TestFiles2` and renames it `NewFile.txt`.</span></span>  
  
 [!code-vb[VbRefFile#16](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbRefFile/VB/Class1.vb#16)]  
  
 <span data-ttu-id="08401-338">文件路径替换为要在代码中使用的路径。</span><span class="sxs-lookup"><span data-stu-id="08401-338">Replace the file paths with the paths you want to use in your code.</span></span>  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentException"><span data-ttu-id="08401-339"><paramref name="destinationFileName" /> 包含路径信息。</span><span class="sxs-lookup"><span data-stu-id="08401-339"><paramref name="destinationFileName" /> contains path information.</span></span></exception>
        <exception cref="T:System.ArgumentNullException"><span data-ttu-id="08401-340"><paramref name="destinationFileName" /> 或<paramref name="sourceFileName" />是<see langword="Nothing" />或空字符串。</span><span class="sxs-lookup"><span data-stu-id="08401-340"><paramref name="destinationFileName" /> or <paramref name="sourceFileName" /> is <see langword="Nothing" /> or an empty string.</span></span></exception>
        <exception cref="T:System.IO.FileNotFoundException"><span data-ttu-id="08401-341">源文件无效或不存在。</span><span class="sxs-lookup"><span data-stu-id="08401-341">The source file is not valid or does not exist.</span></span></exception>
        <exception cref="T:System.IO.IOException"><span data-ttu-id="08401-342">具有相同名称的目标目录中的文件正在使用。</span><span class="sxs-lookup"><span data-stu-id="08401-342">A file in the target directory with the same name is in use.</span></span></exception>
        <exception cref="T:System.NotSupportedException"><span data-ttu-id="08401-343">在路径中的文件或目录名称包含冒号 （:），或格式无效。</span><span class="sxs-lookup"><span data-stu-id="08401-343">A file or directory name in the path contains a colon (:) or is in an invalid format.</span></span></exception>
        <exception cref="T:System.IO.PathTooLongException"><span data-ttu-id="08401-344">路径超过系统定义的最大长度。</span><span class="sxs-lookup"><span data-stu-id="08401-344">The path exceeds the system-defined maximum length.</span></span></exception>
        <exception cref="T:System.UnauthorizedAccessException"><span data-ttu-id="08401-345">用户没有所需的权限。</span><span class="sxs-lookup"><span data-stu-id="08401-345">The user does not have required permission.</span></span></exception>
        <exception cref="T:System.Security.SecurityException"><span data-ttu-id="08401-346">该用户缺少必要的权限查看该路径。</span><span class="sxs-lookup"><span data-stu-id="08401-346">The user lacks necessary permissions to view the path.</span></span></exception>
        <permission cref="T:System.Security.Permissions.EnvironmentPermission"><span data-ttu-id="08401-347">控制可以访问所有环境变量。</span><span class="sxs-lookup"><span data-stu-id="08401-347">Controls the ability to access all environment variables.</span></span> <span data-ttu-id="08401-348">关联枚举： <see cref="F:System.Security.Permissions.PermissionState.Unrestricted" />。</span><span class="sxs-lookup"><span data-stu-id="08401-348">Associated enumeration: <see cref="F:System.Security.Permissions.PermissionState.Unrestricted" />.</span></span></permission>
        <permission cref="T:System.Security.Permissions.FileIOPermission"><span data-ttu-id="08401-349">控制文件和文件夹的访问权限。</span><span class="sxs-lookup"><span data-stu-id="08401-349">Controls the ability to access files and folders.</span></span> <span data-ttu-id="08401-350">关联枚举： <see cref="F:System.Security.Permissions.PermissionState.Unrestricted" />。</span><span class="sxs-lookup"><span data-stu-id="08401-350">Associated enumeration: <see cref="F:System.Security.Permissions.PermissionState.Unrestricted" />.</span></span></permission>
        <permission cref="T:System.Security.Permissions.RegistryPermission"><span data-ttu-id="08401-351">控制访问注册表变量的能力。</span><span class="sxs-lookup"><span data-stu-id="08401-351">Controls the ability to access registry variables.</span></span> <span data-ttu-id="08401-352">关联枚举： <see cref="F:System.Security.Permissions.PermissionState.Unrestricted" />。</span><span class="sxs-lookup"><span data-stu-id="08401-352">Associated enumeration: <see cref="F:System.Security.Permissions.PermissionState.Unrestricted" />.</span></span></permission>
        <altmember cref="T:Microsoft.VisualBasic.FileIO.UICancelOption" />
        <related type="Article" href="~/docs/visual-basic/language-reference/objects/index.md"><span data-ttu-id="08401-353">对象 (Visual Basic)</span><span class="sxs-lookup"><span data-stu-id="08401-353">Objects (Visual Basic)</span></span></related>
        <related type="Article" href="~/docs/visual-basic/developing-apps/programming/drives-directories-files/how-to-copy-files-with-a-specific-pattern-to-a-directory.md"><span data-ttu-id="08401-354">如何：在 Visual Basic 中将具有特定模式的文件复制到目录中</span><span class="sxs-lookup"><span data-stu-id="08401-354">How to: Copy Files with a Specific Pattern to a Directory in Visual Basic</span></span></related>
        <related type="Article" href="~/docs/visual-basic/developing-apps/programming/drives-directories-files/how-to-create-a-copy-of-a-file-in-the-same-directory.md"><span data-ttu-id="08401-355">如何：在同一目录中创建文件副本 (Visual Basic)</span><span class="sxs-lookup"><span data-stu-id="08401-355">How to: Create a Copy of a File in the Same Directory in Visual Basic</span></span></related>
        <related type="Article" href="~/docs/visual-basic/developing-apps/programming/drives-directories-files/how-to-copy-a-directory-to-another-directory.md"><span data-ttu-id="08401-356">如何：在 Visual Basic 中将一个目录复制到另一个目录</span><span class="sxs-lookup"><span data-stu-id="08401-356">How to: Copy a Directory to Another Directory in Visual Basic</span></span></related>
        <related type="Article" href="~/docs/visual-basic/developing-apps/programming/drives-directories-files/how-to-rename-a-file.md"><span data-ttu-id="08401-357">如何：在 Visual Basic 中重命名文件</span><span class="sxs-lookup"><span data-stu-id="08401-357">How to: Rename a File in Visual Basic</span></span></related>
      </Docs>
    </Member>
    <Member MemberName="CopyFile">
      <MemberSignature Language="C#" Value="public void CopyFile (string sourceFileName, string destinationFileName, Microsoft.VisualBasic.FileIO.UIOption showUI);" />
      <MemberSignature Language="ILAsm" Value=".method public instance void CopyFile(string sourceFileName, string destinationFileName, valuetype Microsoft.VisualBasic.FileIO.UIOption showUI) cil managed" />
      <MemberSignature Language="DocId" Value="M:Microsoft.VisualBasic.MyServices.FileSystemProxy.CopyFile(System.String,System.String,Microsoft.VisualBasic.FileIO.UIOption)" />
      <MemberSignature Language="VB.NET" Value="Public Sub CopyFile (sourceFileName As String, destinationFileName As String, showUI As UIOption)" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; void CopyFile(System::String ^ sourceFileName, System::String ^ destinationFileName, Microsoft::VisualBasic::FileIO::UIOption showUI);" />
      <MemberSignature Language="F#" Value="member this.CopyFile : string * string * Microsoft.VisualBasic.FileIO.UIOption -&gt; unit" Usage="fileSystemProxy.CopyFile (sourceFileName, destinationFileName, showUI)" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>Microsoft.VisualBasic</AssemblyName>
        <AssemblyVersion>8.0.0.0</AssemblyVersion>
        <AssemblyVersion>10.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <AssemblyInfo>
        <AssemblyName>Microsoft.VisualBasic.Core</AssemblyName>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Void</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="sourceFileName" Type="System.String" Index="0" FrameworkAlternate="netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;netframework-4.8" />
        <Parameter Name="destinationFileName" Type="System.String" Index="1" FrameworkAlternate="netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;netframework-4.8" />
        <Parameter Name="showUI" Type="Microsoft.VisualBasic.FileIO.UIOption" Index="2" FrameworkAlternate="netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;netframework-4.8" />
      </Parameters>
      <Docs>
        <param name="sourceFileName"><span data-ttu-id="08401-358">要复制的文件。</span><span class="sxs-lookup"><span data-stu-id="08401-358">The file to be copied.</span></span></param>
        <param name="destinationFileName"><span data-ttu-id="08401-359">应将文件复制到的位置。</span><span class="sxs-lookup"><span data-stu-id="08401-359">The location to which the file should be copied.</span></span></param>
        <param name="showUI"><span data-ttu-id="08401-360">是否直观地跟踪操作的进度。</span><span class="sxs-lookup"><span data-stu-id="08401-360">Whether to visually track the operation's progress.</span></span> <span data-ttu-id="08401-361">默认值为 <see langword="UIOption.OnlyErrorDialogs" />。</span><span class="sxs-lookup"><span data-stu-id="08401-361">Default is <see langword="UIOption.OnlyErrorDialogs" />.</span></span></param>
        <summary><span data-ttu-id="08401-362">将文件复制到新位置。</span><span class="sxs-lookup"><span data-stu-id="08401-362">Copies a file to a new location.</span></span></summary>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="08401-363">`CopyFile` 不会保留 Ace （访问控制项）。</span><span class="sxs-lookup"><span data-stu-id="08401-363">`CopyFile` does not preserve ACEs (Access Control Entries).</span></span> <span data-ttu-id="08401-364">新创建的文件默认 Ace 继承在其中创建的目录。</span><span class="sxs-lookup"><span data-stu-id="08401-364">The newly created file inherits default ACEs from the directory in which it is created.</span></span>  
  
 <span data-ttu-id="08401-365">下表列出了所涉及的任务的示例`My.Computer.FileSystem.CopyFile`方法。</span><span class="sxs-lookup"><span data-stu-id="08401-365">The following table lists examples of tasks involving the `My.Computer.FileSystem.CopyFile` method.</span></span>  
  
|<span data-ttu-id="08401-366">功能</span><span class="sxs-lookup"><span data-stu-id="08401-366">To</span></span>|<span data-ttu-id="08401-367">查看</span><span class="sxs-lookup"><span data-stu-id="08401-367">See</span></span>|  
|--------|---------|  
|<span data-ttu-id="08401-368">将文件复制到相同的目录。</span><span class="sxs-lookup"><span data-stu-id="08401-368">Copy a file to the same directory.</span></span>|[<span data-ttu-id="08401-369">如何：在同一目录中创建文件副本</span><span class="sxs-lookup"><span data-stu-id="08401-369">How to: Create a Copy of a File in the Same Directory</span></span>](~/docs/visual-basic/developing-apps/programming/drives-directories-files/how-to-create-a-copy-of-a-file-in-the-same-directory.md)|  
|<span data-ttu-id="08401-370">将文件复制到其他目录。</span><span class="sxs-lookup"><span data-stu-id="08401-370">Copy a file to a different directory.</span></span>|[<span data-ttu-id="08401-371">如何：在不同的目录中创建文件的副本</span><span class="sxs-lookup"><span data-stu-id="08401-371">How to: Create a Copy of a File in a Different Directory</span></span>](~/docs/visual-basic/developing-apps/programming/drives-directories-files/how-to-create-a-copy-of-a-file-in-a-different-directory.md)|  
  
   
  
## Examples  
 <span data-ttu-id="08401-372">此示例将文件复制`Test.txt`到目录`TestFiles2`而不会覆盖现有文件。</span><span class="sxs-lookup"><span data-stu-id="08401-372">This example copies the file `Test.txt` to the directory `TestFiles2` without overwriting existing files.</span></span>  
  
 [!code-vb[VbRefFile#15](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbRefFile/VB/Class1.vb#15)]  
  
 <span data-ttu-id="08401-373">文件路径替换为要在代码中使用的路径。</span><span class="sxs-lookup"><span data-stu-id="08401-373">Replace the file paths with the paths you want to use in your code.</span></span>  
  
 <span data-ttu-id="08401-374">此示例将文件复制`Test.txt`到目录`TestFiles2`并将其重命名`NewFile.txt`。</span><span class="sxs-lookup"><span data-stu-id="08401-374">This example copies the file `Test.txt` to the directory `TestFiles2` and renames it `NewFile.txt`.</span></span>  
  
 [!code-vb[VbRefFile#16](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbRefFile/VB/Class1.vb#16)]  
  
 <span data-ttu-id="08401-375">文件路径替换为要在代码中使用的路径。</span><span class="sxs-lookup"><span data-stu-id="08401-375">Replace the file paths with the paths you want to use in your code.</span></span>  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentException"><span data-ttu-id="08401-376"><paramref name="destinationFileName" /> 包含路径信息。</span><span class="sxs-lookup"><span data-stu-id="08401-376"><paramref name="destinationFileName" /> contains path information.</span></span></exception>
        <exception cref="T:System.ArgumentNullException"><span data-ttu-id="08401-377"><paramref name="destinationFileName" /> 或<paramref name="sourceFileName" />是<see langword="Nothing" />或空字符串。</span><span class="sxs-lookup"><span data-stu-id="08401-377"><paramref name="destinationFileName" /> or <paramref name="sourceFileName" /> is <see langword="Nothing" /> or an empty string.</span></span></exception>
        <exception cref="T:System.IO.FileNotFoundException"><span data-ttu-id="08401-378">源文件无效或不存在。</span><span class="sxs-lookup"><span data-stu-id="08401-378">The source file is not valid or does not exist.</span></span></exception>
        <exception cref="T:System.IO.IOException"><span data-ttu-id="08401-379">目标文件存在并<paramref name="overwrite" />设置为<see langword="False" />。</span><span class="sxs-lookup"><span data-stu-id="08401-379">The destination file exists and <paramref name="overwrite" /> is set to <see langword="False" />.</span></span></exception>
        <exception cref="T:System.NotSupportedException"><span data-ttu-id="08401-380">在路径中的文件或目录名称包含冒号 （:），或格式无效。</span><span class="sxs-lookup"><span data-stu-id="08401-380">A file or directory name in the path contains a colon (:) or is in an invalid format.</span></span></exception>
        <exception cref="T:System.IO.PathTooLongException"><span data-ttu-id="08401-381">路径超过系统定义的最大长度。</span><span class="sxs-lookup"><span data-stu-id="08401-381">The path exceeds the system-defined maximum length.</span></span></exception>
        <exception cref="T:System.UnauthorizedAccessException"><span data-ttu-id="08401-382">用户没有所需的权限。</span><span class="sxs-lookup"><span data-stu-id="08401-382">The user does not have required permission.</span></span></exception>
        <exception cref="T:System.Security.SecurityException"><span data-ttu-id="08401-383">该用户缺少必要的权限查看该路径。</span><span class="sxs-lookup"><span data-stu-id="08401-383">The user lacks necessary permissions to view the path.</span></span></exception>
        <permission cref="T:System.Security.Permissions.EnvironmentPermission"><span data-ttu-id="08401-384">控制可以访问所有环境变量。</span><span class="sxs-lookup"><span data-stu-id="08401-384">Controls the ability to access all environment variables.</span></span> <span data-ttu-id="08401-385">关联枚举： <see cref="F:System.Security.Permissions.PermissionState.Unrestricted" />。</span><span class="sxs-lookup"><span data-stu-id="08401-385">Associated enumeration: <see cref="F:System.Security.Permissions.PermissionState.Unrestricted" />.</span></span></permission>
        <permission cref="T:System.Security.Permissions.FileIOPermission"><span data-ttu-id="08401-386">控制文件和文件夹的访问权限。</span><span class="sxs-lookup"><span data-stu-id="08401-386">Controls the ability to access files and folders.</span></span> <span data-ttu-id="08401-387">关联枚举： <see cref="F:System.Security.Permissions.PermissionState.Unrestricted" />。</span><span class="sxs-lookup"><span data-stu-id="08401-387">Associated enumeration: <see cref="F:System.Security.Permissions.PermissionState.Unrestricted" />.</span></span></permission>
        <permission cref="T:System.Security.Permissions.RegistryPermission"><span data-ttu-id="08401-388">控制访问注册表变量的能力。</span><span class="sxs-lookup"><span data-stu-id="08401-388">Controls the ability to access registry variables.</span></span> <span data-ttu-id="08401-389">关联枚举： <see cref="F:System.Security.Permissions.PermissionState.Unrestricted" />。</span><span class="sxs-lookup"><span data-stu-id="08401-389">Associated enumeration: <see cref="F:System.Security.Permissions.PermissionState.Unrestricted" />.</span></span></permission>
        <permission cref="T:System.Security.Permissions.UIPermission"><span data-ttu-id="08401-390">控制与用户界面和剪贴板相关的权限。</span><span class="sxs-lookup"><span data-stu-id="08401-390">Controls the permissions related to user interfaces and the clipboard.</span></span> <span data-ttu-id="08401-391">关联枚举： <see cref="F:System.Security.Permissions.UIPermissionWindow.SafeSubWindows" />。</span><span class="sxs-lookup"><span data-stu-id="08401-391">Associated enumeration: <see cref="F:System.Security.Permissions.UIPermissionWindow.SafeSubWindows" />.</span></span></permission>
        <altmember cref="T:Microsoft.VisualBasic.FileIO.UICancelOption" />
        <related type="Article" href="~/docs/visual-basic/language-reference/objects/index.md"><span data-ttu-id="08401-392">对象 (Visual Basic)</span><span class="sxs-lookup"><span data-stu-id="08401-392">Objects (Visual Basic)</span></span></related>
        <related type="Article" href="~/docs/visual-basic/developing-apps/programming/drives-directories-files/how-to-copy-files-with-a-specific-pattern-to-a-directory.md"><span data-ttu-id="08401-393">如何：在 Visual Basic 中将具有特定模式的文件复制到目录中</span><span class="sxs-lookup"><span data-stu-id="08401-393">How to: Copy Files with a Specific Pattern to a Directory in Visual Basic</span></span></related>
        <related type="Article" href="~/docs/visual-basic/developing-apps/programming/drives-directories-files/how-to-create-a-copy-of-a-file-in-the-same-directory.md"><span data-ttu-id="08401-394">如何：在同一目录中创建文件副本 (Visual Basic)</span><span class="sxs-lookup"><span data-stu-id="08401-394">How to: Create a Copy of a File in the Same Directory in Visual Basic</span></span></related>
        <related type="Article" href="~/docs/visual-basic/developing-apps/programming/drives-directories-files/how-to-copy-a-directory-to-another-directory.md"><span data-ttu-id="08401-395">如何：在 Visual Basic 中将一个目录复制到另一个目录</span><span class="sxs-lookup"><span data-stu-id="08401-395">How to: Copy a Directory to Another Directory in Visual Basic</span></span></related>
        <related type="Article" href="~/docs/visual-basic/developing-apps/programming/drives-directories-files/how-to-rename-a-file.md"><span data-ttu-id="08401-396">如何：在 Visual Basic 中重命名文件</span><span class="sxs-lookup"><span data-stu-id="08401-396">How to: Rename a File in Visual Basic</span></span></related>
      </Docs>
    </Member>
    <Member MemberName="CopyFile">
      <MemberSignature Language="C#" Value="public void CopyFile (string sourceFileName, string destinationFileName, bool overwrite);" />
      <MemberSignature Language="ILAsm" Value=".method public instance void CopyFile(string sourceFileName, string destinationFileName, bool overwrite) cil managed" />
      <MemberSignature Language="DocId" Value="M:Microsoft.VisualBasic.MyServices.FileSystemProxy.CopyFile(System.String,System.String,System.Boolean)" />
      <MemberSignature Language="VB.NET" Value="Public Sub CopyFile (sourceFileName As String, destinationFileName As String, overwrite As Boolean)" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; void CopyFile(System::String ^ sourceFileName, System::String ^ destinationFileName, bool overwrite);" />
      <MemberSignature Language="F#" Value="member this.CopyFile : string * string * bool -&gt; unit" Usage="fileSystemProxy.CopyFile (sourceFileName, destinationFileName, overwrite)" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>Microsoft.VisualBasic</AssemblyName>
        <AssemblyVersion>8.0.0.0</AssemblyVersion>
        <AssemblyVersion>10.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <AssemblyInfo>
        <AssemblyName>Microsoft.VisualBasic.Core</AssemblyName>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Void</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="sourceFileName" Type="System.String" Index="0" FrameworkAlternate="netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;netframework-4.8" />
        <Parameter Name="destinationFileName" Type="System.String" Index="1" FrameworkAlternate="netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;netframework-4.8" />
        <Parameter Name="overwrite" Type="System.Boolean" Index="2" FrameworkAlternate="netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;netframework-4.8" />
      </Parameters>
      <Docs>
        <param name="sourceFileName"><span data-ttu-id="08401-397">要复制的文件。</span><span class="sxs-lookup"><span data-stu-id="08401-397">The file to be copied.</span></span></param>
        <param name="destinationFileName"><span data-ttu-id="08401-398">应将文件复制到的位置。</span><span class="sxs-lookup"><span data-stu-id="08401-398">The location to which the file should be copied.</span></span></param>
        <param name="overwrite"><span data-ttu-id="08401-399"><see langword="True" /> 如果应覆盖现有文件;否则为<see langword="False" />。</span><span class="sxs-lookup"><span data-stu-id="08401-399"><see langword="True" /> if existing files should be overwritten; otherwise <see langword="False" />.</span></span> <span data-ttu-id="08401-400">默认值为 <see langword="False" />。</span><span class="sxs-lookup"><span data-stu-id="08401-400">Default is <see langword="False" />.</span></span></param>
        <summary><span data-ttu-id="08401-401">将文件复制到新位置。</span><span class="sxs-lookup"><span data-stu-id="08401-401">Copies a file to a new location.</span></span></summary>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="08401-402">`CopyFile` 不会保留 Ace （访问控制项）。</span><span class="sxs-lookup"><span data-stu-id="08401-402">`CopyFile` does not preserve ACEs (Access Control Entries).</span></span> <span data-ttu-id="08401-403">新创建的文件默认 Ace 继承在其中创建的目录。</span><span class="sxs-lookup"><span data-stu-id="08401-403">The newly created file inherits default ACEs from the directory in which it is created.</span></span>  
  
 <span data-ttu-id="08401-404">下表列出了所涉及的任务的示例`My.Computer.FileSystem.CopyFile`方法。</span><span class="sxs-lookup"><span data-stu-id="08401-404">The following table lists examples of tasks involving the `My.Computer.FileSystem.CopyFile` method.</span></span>  
  
|<span data-ttu-id="08401-405">功能</span><span class="sxs-lookup"><span data-stu-id="08401-405">To</span></span>|<span data-ttu-id="08401-406">查看</span><span class="sxs-lookup"><span data-stu-id="08401-406">See</span></span>|  
|--------|---------|  
|<span data-ttu-id="08401-407">将文件复制到相同的目录。</span><span class="sxs-lookup"><span data-stu-id="08401-407">Copy a file to the same directory.</span></span>|[<span data-ttu-id="08401-408">如何：在同一目录中创建文件副本</span><span class="sxs-lookup"><span data-stu-id="08401-408">How to: Create a Copy of a File in the Same Directory</span></span>](~/docs/visual-basic/developing-apps/programming/drives-directories-files/how-to-create-a-copy-of-a-file-in-the-same-directory.md)|  
|<span data-ttu-id="08401-409">将文件复制到其他目录。</span><span class="sxs-lookup"><span data-stu-id="08401-409">Copy a file to a different directory.</span></span>|[<span data-ttu-id="08401-410">如何：在不同的目录中创建文件的副本</span><span class="sxs-lookup"><span data-stu-id="08401-410">How to: Create a Copy of a File in a Different Directory</span></span>](~/docs/visual-basic/developing-apps/programming/drives-directories-files/how-to-create-a-copy-of-a-file-in-a-different-directory.md)|  
  
   
  
## Examples  
 <span data-ttu-id="08401-411">此示例将文件复制`Test.txt`到目录`TestFiles2`而不会覆盖现有文件。</span><span class="sxs-lookup"><span data-stu-id="08401-411">This example copies the file `Test.txt` to the directory `TestFiles2` without overwriting existing files.</span></span>  
  
 [!code-vb[VbRefFile#15](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbRefFile/VB/Class1.vb#15)]  
  
 <span data-ttu-id="08401-412">文件路径替换为要在代码中使用的路径。</span><span class="sxs-lookup"><span data-stu-id="08401-412">Replace the file paths with the paths you want to use in your code.</span></span>  
  
 <span data-ttu-id="08401-413">此示例将文件复制`Test.txt`到目录`TestFiles2`并将其重命名`NewFile.txt`。</span><span class="sxs-lookup"><span data-stu-id="08401-413">This example copies the file `Test.txt` to the directory `TestFiles2` and renames it `NewFile.txt`.</span></span>  
  
 [!code-vb[VbRefFile#16](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbRefFile/VB/Class1.vb#16)]  
  
 <span data-ttu-id="08401-414">文件路径替换为要在代码中使用的路径。</span><span class="sxs-lookup"><span data-stu-id="08401-414">Replace the file paths with the paths you want to use in your code.</span></span>  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentException"><span data-ttu-id="08401-415"><paramref name="destinationFileName" /> 包含路径信息。</span><span class="sxs-lookup"><span data-stu-id="08401-415"><paramref name="destinationFileName" /> contains path information.</span></span></exception>
        <exception cref="T:System.ArgumentNullException"><span data-ttu-id="08401-416"><paramref name="destinationFileName" /> 或<paramref name="sourceFileName" />是<see langword="Nothing" />或空字符串。</span><span class="sxs-lookup"><span data-stu-id="08401-416"><paramref name="destinationFileName" /> or <paramref name="sourceFileName" /> is <see langword="Nothing" /> or an empty string.</span></span></exception>
        <exception cref="T:System.IO.FileNotFoundException"><span data-ttu-id="08401-417">源文件无效或不存在。</span><span class="sxs-lookup"><span data-stu-id="08401-417">The source file is not valid or does not exist.</span></span></exception>
        <exception cref="T:System.IO.IOException"><span data-ttu-id="08401-418">目标文件存在并<paramref name="overwrite" />设置为<see langword="False" />。</span><span class="sxs-lookup"><span data-stu-id="08401-418">The destination file exists and <paramref name="overwrite" /> is set to <see langword="False" />.</span></span></exception>
        <exception cref="T:System.NotSupportedException"><span data-ttu-id="08401-419">在路径中的文件或目录名称包含冒号 （:），或格式无效。</span><span class="sxs-lookup"><span data-stu-id="08401-419">A file or directory name in the path contains a colon (:) or is in an invalid format.</span></span></exception>
        <exception cref="T:System.IO.PathTooLongException"><span data-ttu-id="08401-420">路径超过系统定义的最大长度。</span><span class="sxs-lookup"><span data-stu-id="08401-420">The path exceeds the system-defined maximum length.</span></span></exception>
        <exception cref="T:System.UnauthorizedAccessException"><span data-ttu-id="08401-421">用户没有所需的权限。</span><span class="sxs-lookup"><span data-stu-id="08401-421">The user does not have required permission.</span></span></exception>
        <exception cref="T:System.Security.SecurityException"><span data-ttu-id="08401-422">该用户缺少必要的权限查看该路径。</span><span class="sxs-lookup"><span data-stu-id="08401-422">The user lacks necessary permissions to view the path.</span></span></exception>
        <permission cref="T:System.Security.Permissions.EnvironmentPermission"><span data-ttu-id="08401-423">控制可以访问所有环境变量。</span><span class="sxs-lookup"><span data-stu-id="08401-423">Controls the ability to access all environment variables.</span></span> <span data-ttu-id="08401-424">关联枚举： <see cref="F:System.Security.Permissions.PermissionState.Unrestricted" />。</span><span class="sxs-lookup"><span data-stu-id="08401-424">Associated enumeration: <see cref="F:System.Security.Permissions.PermissionState.Unrestricted" />.</span></span></permission>
        <permission cref="T:System.Security.Permissions.FileIOPermission"><span data-ttu-id="08401-425">控制文件和文件夹的访问权限。</span><span class="sxs-lookup"><span data-stu-id="08401-425">Controls the ability to access files and folders.</span></span> <span data-ttu-id="08401-426">关联枚举： <see cref="F:System.Security.Permissions.PermissionState.Unrestricted" />。</span><span class="sxs-lookup"><span data-stu-id="08401-426">Associated enumeration: <see cref="F:System.Security.Permissions.PermissionState.Unrestricted" />.</span></span></permission>
        <permission cref="T:System.Security.Permissions.RegistryPermission"><span data-ttu-id="08401-427">控制访问注册表变量的能力。</span><span class="sxs-lookup"><span data-stu-id="08401-427">Controls the ability to access registry variables.</span></span> <span data-ttu-id="08401-428">关联枚举： <see cref="F:System.Security.Permissions.PermissionState.Unrestricted" />。</span><span class="sxs-lookup"><span data-stu-id="08401-428">Associated enumeration: <see cref="F:System.Security.Permissions.PermissionState.Unrestricted" />.</span></span></permission>
        <altmember cref="T:Microsoft.VisualBasic.FileIO.UICancelOption" />
        <related type="Article" href="~/docs/visual-basic/language-reference/objects/index.md"><span data-ttu-id="08401-429">对象 (Visual Basic)</span><span class="sxs-lookup"><span data-stu-id="08401-429">Objects (Visual Basic)</span></span></related>
        <related type="Article" href="~/docs/visual-basic/developing-apps/programming/drives-directories-files/how-to-copy-files-with-a-specific-pattern-to-a-directory.md"><span data-ttu-id="08401-430">如何：在 Visual Basic 中将具有特定模式的文件复制到目录中</span><span class="sxs-lookup"><span data-stu-id="08401-430">How to: Copy Files with a Specific Pattern to a Directory in Visual Basic</span></span></related>
        <related type="Article" href="~/docs/visual-basic/developing-apps/programming/drives-directories-files/how-to-create-a-copy-of-a-file-in-the-same-directory.md"><span data-ttu-id="08401-431">如何：在同一目录中创建文件副本 (Visual Basic)</span><span class="sxs-lookup"><span data-stu-id="08401-431">How to: Create a Copy of a File in the Same Directory in Visual Basic</span></span></related>
        <related type="Article" href="~/docs/visual-basic/developing-apps/programming/drives-directories-files/how-to-copy-a-directory-to-another-directory.md"><span data-ttu-id="08401-432">如何：在 Visual Basic 中将一个目录复制到另一个目录</span><span class="sxs-lookup"><span data-stu-id="08401-432">How to: Copy a Directory to Another Directory in Visual Basic</span></span></related>
        <related type="Article" href="~/docs/visual-basic/developing-apps/programming/drives-directories-files/how-to-rename-a-file.md"><span data-ttu-id="08401-433">如何：在 Visual Basic 中重命名文件</span><span class="sxs-lookup"><span data-stu-id="08401-433">How to: Rename a File in Visual Basic</span></span></related>
      </Docs>
    </Member>
    <Member MemberName="CopyFile">
      <MemberSignature Language="C#" Value="public void CopyFile (string sourceFileName, string destinationFileName, Microsoft.VisualBasic.FileIO.UIOption showUI, Microsoft.VisualBasic.FileIO.UICancelOption onUserCancel);" />
      <MemberSignature Language="ILAsm" Value=".method public instance void CopyFile(string sourceFileName, string destinationFileName, valuetype Microsoft.VisualBasic.FileIO.UIOption showUI, valuetype Microsoft.VisualBasic.FileIO.UICancelOption onUserCancel) cil managed" />
      <MemberSignature Language="DocId" Value="M:Microsoft.VisualBasic.MyServices.FileSystemProxy.CopyFile(System.String,System.String,Microsoft.VisualBasic.FileIO.UIOption,Microsoft.VisualBasic.FileIO.UICancelOption)" />
      <MemberSignature Language="VB.NET" Value="Public Sub CopyFile (sourceFileName As String, destinationFileName As String, showUI As UIOption, onUserCancel As UICancelOption)" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; void CopyFile(System::String ^ sourceFileName, System::String ^ destinationFileName, Microsoft::VisualBasic::FileIO::UIOption showUI, Microsoft::VisualBasic::FileIO::UICancelOption onUserCancel);" />
      <MemberSignature Language="F#" Value="member this.CopyFile : string * string * Microsoft.VisualBasic.FileIO.UIOption * Microsoft.VisualBasic.FileIO.UICancelOption -&gt; unit" Usage="fileSystemProxy.CopyFile (sourceFileName, destinationFileName, showUI, onUserCancel)" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>Microsoft.VisualBasic</AssemblyName>
        <AssemblyVersion>8.0.0.0</AssemblyVersion>
        <AssemblyVersion>10.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <AssemblyInfo>
        <AssemblyName>Microsoft.VisualBasic.Core</AssemblyName>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Void</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="sourceFileName" Type="System.String" Index="0" FrameworkAlternate="netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;netframework-4.8" />
        <Parameter Name="destinationFileName" Type="System.String" Index="1" FrameworkAlternate="netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;netframework-4.8" />
        <Parameter Name="showUI" Type="Microsoft.VisualBasic.FileIO.UIOption" Index="2" FrameworkAlternate="netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;netframework-4.8" />
        <Parameter Name="onUserCancel" Type="Microsoft.VisualBasic.FileIO.UICancelOption" Index="3" FrameworkAlternate="netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;netframework-4.8" />
      </Parameters>
      <Docs>
        <param name="sourceFileName"><span data-ttu-id="08401-434">要复制的文件。</span><span class="sxs-lookup"><span data-stu-id="08401-434">The file to be copied.</span></span></param>
        <param name="destinationFileName"><span data-ttu-id="08401-435">应将文件复制到的位置。</span><span class="sxs-lookup"><span data-stu-id="08401-435">The location to which the file should be copied.</span></span></param>
        <param name="showUI"><span data-ttu-id="08401-436">是否直观地跟踪操作的进度。</span><span class="sxs-lookup"><span data-stu-id="08401-436">Whether to visually track the operation's progress.</span></span> <span data-ttu-id="08401-437">默认值为 <see langword="UIOption.OnlyErrorDialogs" />。</span><span class="sxs-lookup"><span data-stu-id="08401-437">Default is <see langword="UIOption.OnlyErrorDialogs" />.</span></span></param>
        <param name="onUserCancel"><span data-ttu-id="08401-438">指定当用户在操作过程中单击“取消”时应执行的操作。</span><span class="sxs-lookup"><span data-stu-id="08401-438">Specifies what should be done if the user clicks **Cancel** during the operation.</span></span> <span data-ttu-id="08401-439">默认值为 <see cref="F:Microsoft.VisualBasic.FileIO.UICancelOption.ThrowException" />。</span><span class="sxs-lookup"><span data-stu-id="08401-439">Default is <see cref="F:Microsoft.VisualBasic.FileIO.UICancelOption.ThrowException" />.</span></span></param>
        <summary><span data-ttu-id="08401-440">将文件复制到新位置。</span><span class="sxs-lookup"><span data-stu-id="08401-440">Copies a file to a new location.</span></span></summary>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="08401-441">`CopyFile` 不会保留 Ace （访问控制项）。</span><span class="sxs-lookup"><span data-stu-id="08401-441">`CopyFile` does not preserve ACEs (Access Control Entries).</span></span> <span data-ttu-id="08401-442">新创建的文件默认 Ace 继承在其中创建的目录。</span><span class="sxs-lookup"><span data-stu-id="08401-442">The newly created file inherits default ACEs from the directory in which it is created.</span></span>  
  
 <span data-ttu-id="08401-443">下表列出了所涉及的任务的示例`My.Computer.FileSystem.CopyFile`方法。</span><span class="sxs-lookup"><span data-stu-id="08401-443">The following table lists examples of tasks involving the `My.Computer.FileSystem.CopyFile` method.</span></span>  
  
|<span data-ttu-id="08401-444">功能</span><span class="sxs-lookup"><span data-stu-id="08401-444">To</span></span>|<span data-ttu-id="08401-445">查看</span><span class="sxs-lookup"><span data-stu-id="08401-445">See</span></span>|  
|--------|---------|  
|<span data-ttu-id="08401-446">将文件复制到相同的目录。</span><span class="sxs-lookup"><span data-stu-id="08401-446">Copy a file to the same directory.</span></span>|[<span data-ttu-id="08401-447">如何：在同一目录中创建文件副本</span><span class="sxs-lookup"><span data-stu-id="08401-447">How to: Create a Copy of a File in the Same Directory</span></span>](~/docs/visual-basic/developing-apps/programming/drives-directories-files/how-to-create-a-copy-of-a-file-in-the-same-directory.md)|  
|<span data-ttu-id="08401-448">将文件复制到其他目录。</span><span class="sxs-lookup"><span data-stu-id="08401-448">Copy a file to a different directory.</span></span>|[<span data-ttu-id="08401-449">如何：在不同的目录中创建文件的副本</span><span class="sxs-lookup"><span data-stu-id="08401-449">How to: Create a Copy of a File in a Different Directory</span></span>](~/docs/visual-basic/developing-apps/programming/drives-directories-files/how-to-create-a-copy-of-a-file-in-a-different-directory.md)|  
  
   
  
## Examples  
 <span data-ttu-id="08401-450">此示例将文件复制`Test.txt`到目录`TestFiles2`而不会覆盖现有文件。</span><span class="sxs-lookup"><span data-stu-id="08401-450">This example copies the file `Test.txt` to the directory `TestFiles2` without overwriting existing files.</span></span>  
  
 [!code-vb[VbRefFile#15](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbRefFile/VB/Class1.vb#15)]  
  
 <span data-ttu-id="08401-451">文件路径替换为要在代码中使用的路径。</span><span class="sxs-lookup"><span data-stu-id="08401-451">Replace the file paths with the paths you want to use in your code.</span></span>  
  
 <span data-ttu-id="08401-452">此示例将文件复制`Test.txt`到目录`TestFiles2`并将其重命名`NewFile.txt`。</span><span class="sxs-lookup"><span data-stu-id="08401-452">This example copies the file `Test.txt` to the directory `TestFiles2` and renames it `NewFile.txt`.</span></span>  
  
 [!code-vb[VbRefFile#16](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbRefFile/VB/Class1.vb#16)]  
  
 <span data-ttu-id="08401-453">文件路径替换为要在代码中使用的路径。</span><span class="sxs-lookup"><span data-stu-id="08401-453">Replace the file paths with the paths you want to use in your code.</span></span>  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentException"><span data-ttu-id="08401-454"><paramref name="destinationFileName" /> 包含路径信息。</span><span class="sxs-lookup"><span data-stu-id="08401-454"><paramref name="destinationFileName" /> contains path information.</span></span></exception>
        <exception cref="T:System.ArgumentNullException"><span data-ttu-id="08401-455"><paramref name="destinationFileName" /> 或<paramref name="sourceFileName" />是<see langword="Nothing" />或空字符串。</span><span class="sxs-lookup"><span data-stu-id="08401-455"><paramref name="destinationFileName" /> or <paramref name="sourceFileName" /> is <see langword="Nothing" /> or an empty string.</span></span></exception>
        <exception cref="T:System.IO.FileNotFoundException"><span data-ttu-id="08401-456">源文件无效或不存在。</span><span class="sxs-lookup"><span data-stu-id="08401-456">The source file is not valid or does not exist.</span></span></exception>
        <exception cref="T:System.IO.IOException"><span data-ttu-id="08401-457">目标文件存在并<paramref name="overwrite" />设置为<see langword="False" />。</span><span class="sxs-lookup"><span data-stu-id="08401-457">The destination file exists and <paramref name="overwrite" /> is set to <see langword="False" />.</span></span></exception>
        <exception cref="T:System.NotSupportedException"><span data-ttu-id="08401-458">在路径中的文件或目录名称包含冒号 （:），或格式无效。</span><span class="sxs-lookup"><span data-stu-id="08401-458">A file or directory name in the path contains a colon (:) or is in an invalid format.</span></span></exception>
        <exception cref="T:System.IO.PathTooLongException"><span data-ttu-id="08401-459">路径超过系统定义的最大长度。</span><span class="sxs-lookup"><span data-stu-id="08401-459">The path exceeds the system-defined maximum length.</span></span></exception>
        <exception cref="T:System.UnauthorizedAccessException"><span data-ttu-id="08401-460">用户没有所需的权限。</span><span class="sxs-lookup"><span data-stu-id="08401-460">The user does not have required permission.</span></span></exception>
        <exception cref="T:System.Security.SecurityException"><span data-ttu-id="08401-461">该用户缺少必要的权限查看该路径。</span><span class="sxs-lookup"><span data-stu-id="08401-461">The user lacks necessary permissions to view the path.</span></span></exception>
        <exception cref="T:System.OperationCanceledException"><span data-ttu-id="08401-462"><paramref name="UICancelOption" /> 设置为<see langword="ThrowException" />，并且用户已取消操作或发生了 I/O 错误。</span><span class="sxs-lookup"><span data-stu-id="08401-462"><paramref name="UICancelOption" /> is set to <see langword="ThrowException" />, and the user has canceled the operation or an unspecified I/O error occurs.</span></span></exception>
        <permission cref="T:System.Security.Permissions.EnvironmentPermission"><span data-ttu-id="08401-463">控制可以访问所有环境变量。</span><span class="sxs-lookup"><span data-stu-id="08401-463">Controls the ability to access all environment variables.</span></span> <span data-ttu-id="08401-464">关联枚举： <see cref="F:System.Security.Permissions.PermissionState.Unrestricted" />。</span><span class="sxs-lookup"><span data-stu-id="08401-464">Associated enumeration: <see cref="F:System.Security.Permissions.PermissionState.Unrestricted" />.</span></span></permission>
        <permission cref="T:System.Security.Permissions.FileIOPermission"><span data-ttu-id="08401-465">控制文件和文件夹的访问权限。</span><span class="sxs-lookup"><span data-stu-id="08401-465">Controls the ability to access files and folders.</span></span> <span data-ttu-id="08401-466">关联枚举： <see cref="F:System.Security.Permissions.PermissionState.Unrestricted" />。</span><span class="sxs-lookup"><span data-stu-id="08401-466">Associated enumeration: <see cref="F:System.Security.Permissions.PermissionState.Unrestricted" />.</span></span></permission>
        <permission cref="T:System.Security.Permissions.RegistryPermission"><span data-ttu-id="08401-467">控制访问注册表变量的能力。</span><span class="sxs-lookup"><span data-stu-id="08401-467">Controls the ability to access registry variables.</span></span> <span data-ttu-id="08401-468">关联枚举： <see cref="F:System.Security.Permissions.PermissionState.Unrestricted" />。</span><span class="sxs-lookup"><span data-stu-id="08401-468">Associated enumeration: <see cref="F:System.Security.Permissions.PermissionState.Unrestricted" />.</span></span></permission>
        <permission cref="T:System.Security.Permissions.UIPermission"><span data-ttu-id="08401-469">控制与用户界面和剪贴板相关的权限。</span><span class="sxs-lookup"><span data-stu-id="08401-469">Controls the permissions related to user interfaces and the clipboard.</span></span> <span data-ttu-id="08401-470">关联枚举： <see cref="F:System.Security.Permissions.UIPermissionWindow.SafeSubWindows" />。</span><span class="sxs-lookup"><span data-stu-id="08401-470">Associated enumeration: <see cref="F:System.Security.Permissions.UIPermissionWindow.SafeSubWindows" />.</span></span></permission>
        <altmember cref="T:Microsoft.VisualBasic.FileIO.UICancelOption" />
        <related type="Article" href="~/docs/visual-basic/language-reference/objects/index.md"><span data-ttu-id="08401-471">对象 (Visual Basic)</span><span class="sxs-lookup"><span data-stu-id="08401-471">Objects (Visual Basic)</span></span></related>
        <related type="Article" href="~/docs/visual-basic/developing-apps/programming/drives-directories-files/how-to-copy-files-with-a-specific-pattern-to-a-directory.md"><span data-ttu-id="08401-472">如何：在 Visual Basic 中将具有特定模式的文件复制到目录中</span><span class="sxs-lookup"><span data-stu-id="08401-472">How to: Copy Files with a Specific Pattern to a Directory in Visual Basic</span></span></related>
        <related type="Article" href="~/docs/visual-basic/developing-apps/programming/drives-directories-files/how-to-create-a-copy-of-a-file-in-the-same-directory.md"><span data-ttu-id="08401-473">如何：在同一目录中创建文件副本 (Visual Basic)</span><span class="sxs-lookup"><span data-stu-id="08401-473">How to: Create a Copy of a File in the Same Directory in Visual Basic</span></span></related>
        <related type="Article" href="~/docs/visual-basic/developing-apps/programming/drives-directories-files/how-to-copy-a-directory-to-another-directory.md"><span data-ttu-id="08401-474">如何：在 Visual Basic 中将一个目录复制到另一个目录</span><span class="sxs-lookup"><span data-stu-id="08401-474">How to: Copy a Directory to Another Directory in Visual Basic</span></span></related>
        <related type="Article" href="~/docs/visual-basic/developing-apps/programming/drives-directories-files/how-to-rename-a-file.md"><span data-ttu-id="08401-475">如何：在 Visual Basic 中重命名文件</span><span class="sxs-lookup"><span data-stu-id="08401-475">How to: Rename a File in Visual Basic</span></span></related>
      </Docs>
    </Member>
    <Member MemberName="CreateDirectory">
      <MemberSignature Language="C#" Value="public void CreateDirectory (string directory);" />
      <MemberSignature Language="ILAsm" Value=".method public instance void CreateDirectory(string directory) cil managed" />
      <MemberSignature Language="DocId" Value="M:Microsoft.VisualBasic.MyServices.FileSystemProxy.CreateDirectory(System.String)" />
      <MemberSignature Language="VB.NET" Value="Public Sub CreateDirectory (directory As String)" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; void CreateDirectory(System::String ^ directory);" />
      <MemberSignature Language="F#" Value="member this.CreateDirectory : string -&gt; unit" Usage="fileSystemProxy.CreateDirectory directory" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>Microsoft.VisualBasic</AssemblyName>
        <AssemblyVersion>8.0.0.0</AssemblyVersion>
        <AssemblyVersion>10.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <AssemblyInfo>
        <AssemblyName>Microsoft.VisualBasic.Core</AssemblyName>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Void</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="directory" Type="System.String" Index="0" FrameworkAlternate="netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;netframework-4.8" />
      </Parameters>
      <Docs>
        <param name="directory"><span data-ttu-id="08401-476">名称和目录的位置。</span><span class="sxs-lookup"><span data-stu-id="08401-476">Name and location of the directory.</span></span></param>
        <summary><span data-ttu-id="08401-477">创建目录。</span><span class="sxs-lookup"><span data-stu-id="08401-477">Creates a directory.</span></span></summary>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="08401-478">如果该目录已存在，则不引发任何异常。</span><span class="sxs-lookup"><span data-stu-id="08401-478">If the directory already exists, no exception is thrown.</span></span>  
  
 <span data-ttu-id="08401-479">下表列出了所涉及的任务的示例`My.Computer.FileSystem.CreateDirectory`方法。</span><span class="sxs-lookup"><span data-stu-id="08401-479">The following table lists examples of tasks involving the `My.Computer.FileSystem.CreateDirectory` method.</span></span>  
  
|<span data-ttu-id="08401-480">功能</span><span class="sxs-lookup"><span data-stu-id="08401-480">To</span></span>|<span data-ttu-id="08401-481">查看</span><span class="sxs-lookup"><span data-stu-id="08401-481">See</span></span>|  
|--------|---------|  
|<span data-ttu-id="08401-482">创建目录</span><span class="sxs-lookup"><span data-stu-id="08401-482">Create a directory</span></span>|[<span data-ttu-id="08401-483">如何：创建一个目录</span><span class="sxs-lookup"><span data-stu-id="08401-483">How to: Create a Directory</span></span>](~/docs/visual-basic/developing-apps/programming/drives-directories-files/how-to-create-a-directory.md)|  
  
   
  
## Examples  
 <span data-ttu-id="08401-484">此示例将创建该目录， `NewDirectory`，请在`C:\Documents and Settings\All Users\Documents`。</span><span class="sxs-lookup"><span data-stu-id="08401-484">This example creates the directory, `NewDirectory`, in `C:\Documents and Settings\All Users\Documents`.</span></span>  
  
 [!code-vb[VbVbcnMyFileSystem#17](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbcnMyFileSystem/VB/Class1.vb#17)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentException"><span data-ttu-id="08401-485">目录名称格式不正确。</span><span class="sxs-lookup"><span data-stu-id="08401-485">The directory name is malformed.</span></span> <span data-ttu-id="08401-486">例如，它包含非法字符或仅为空白。</span><span class="sxs-lookup"><span data-stu-id="08401-486">For example, it contains illegal characters or is only white space.</span></span></exception>
        <exception cref="T:System.ArgumentNullException"><span data-ttu-id="08401-487"><paramref name="directory" /> 为 <see langword="Nothing" /> 或空字符串。</span><span class="sxs-lookup"><span data-stu-id="08401-487"><paramref name="directory" /> is <see langword="Nothing" /> or an empty string.</span></span></exception>
        <exception cref="T:System.IO.PathTooLongException"><span data-ttu-id="08401-488">目录名称过长。</span><span class="sxs-lookup"><span data-stu-id="08401-488">The directory name is too long.</span></span></exception>
        <exception cref="T:System.NotSupportedException"><span data-ttu-id="08401-489">目录名称是仅为冒号 （:）。</span><span class="sxs-lookup"><span data-stu-id="08401-489">The directory name is only a colon (:).</span></span></exception>
        <exception cref="T:System.IO.IOException"><span data-ttu-id="08401-490">要创建的父目录是目录的只读的</span><span class="sxs-lookup"><span data-stu-id="08401-490">The parent directory of the directory to be created is read-only</span></span></exception>
        <exception cref="T:System.UnauthorizedAccessException"><span data-ttu-id="08401-491">用户没有权限创建目录。</span><span class="sxs-lookup"><span data-stu-id="08401-491">The user does not have permission to create the directory.</span></span></exception>
        <permission cref="T:System.Security.Permissions.FileIOPermission"><span data-ttu-id="08401-492">控制文件和文件夹的访问权限。</span><span class="sxs-lookup"><span data-stu-id="08401-492">Controls the ability to access files and folders.</span></span> <span data-ttu-id="08401-493">关联枚举： <see cref="F:System.Security.Permissions.PermissionState.Unrestricted" />。</span><span class="sxs-lookup"><span data-stu-id="08401-493">Associated enumeration: <see cref="F:System.Security.Permissions.PermissionState.Unrestricted" />.</span></span></permission>
        <altmember cref="M:System.IO.Directory.CreateDirectory(System.String)" />
        <related type="Article" href="~/docs/visual-basic/language-reference/objects/index.md"><span data-ttu-id="08401-494">对象 (Visual Basic)</span><span class="sxs-lookup"><span data-stu-id="08401-494">Objects (Visual Basic)</span></span></related>
      </Docs>
    </Member>
    <Member MemberName="CurrentDirectory">
      <MemberSignature Language="C#" Value="public string CurrentDirectory { get; set; }" />
      <MemberSignature Language="ILAsm" Value=".property instance string CurrentDirectory" />
      <MemberSignature Language="DocId" Value="P:Microsoft.VisualBasic.MyServices.FileSystemProxy.CurrentDirectory" />
      <MemberSignature Language="VB.NET" Value="Public Property CurrentDirectory As String" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; property System::String ^ CurrentDirectory { System::String ^ get(); void set(System::String ^ value); };" />
      <MemberSignature Language="F#" Value="member this.CurrentDirectory : string with get, set" Usage="Microsoft.VisualBasic.MyServices.FileSystemProxy.CurrentDirectory" />
      <MemberType>Property</MemberType>
      <AssemblyInfo>
        <AssemblyName>Microsoft.VisualBasic</AssemblyName>
        <AssemblyVersion>8.0.0.0</AssemblyVersion>
        <AssemblyVersion>10.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <AssemblyInfo>
        <AssemblyName>Microsoft.VisualBasic.Core</AssemblyName>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.String</ReturnType>
      </ReturnValue>
      <Docs>
        <summary><span data-ttu-id="08401-495">获取或设置当前目录。</span><span class="sxs-lookup"><span data-stu-id="08401-495">Gets or sets the current directory.</span></span></summary>
        <value><span data-ttu-id="08401-496">文件 I/O 操作在当前目录。</span><span class="sxs-lookup"><span data-stu-id="08401-496">The current directory for file I/O operations.</span></span></value>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="08401-497">`CurrentDirectory` 是一个系统级环境变量。</span><span class="sxs-lookup"><span data-stu-id="08401-497">`CurrentDirectory` is a system-wide environment variable.</span></span>  
  
   
  
## Examples  
 <span data-ttu-id="08401-498">此示例返回当前目录，并将其显示在消息框中。</span><span class="sxs-lookup"><span data-stu-id="08401-498">This example returns the current directory and displays it in a message box.</span></span>  
  
 [!code-vb[VbVbcnMyFileSystem#18](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbcnMyFileSystem/VB/Class1.vb#18)]  
  
 <span data-ttu-id="08401-499">此示例将当前目录设置为`C:\TestDirectory`。</span><span class="sxs-lookup"><span data-stu-id="08401-499">This example sets the current directory to `C:\TestDirectory`.</span></span>  
  
 [!code-vb[VbVbcnMyFileSystem#19](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbcnMyFileSystem/VB/Class1.vb#19)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.IO.DirectoryNotFoundException"><span data-ttu-id="08401-500">路径不是有效的。</span><span class="sxs-lookup"><span data-stu-id="08401-500">The path is not valid.</span></span></exception>
        <exception cref="T:System.UnauthorizedAccessException"><span data-ttu-id="08401-501">该用户缺少必要的权限。</span><span class="sxs-lookup"><span data-stu-id="08401-501">The user lacks necessary permissions.</span></span></exception>
        <permission cref="T:System.Security.Permissions.FileIOPermission"><span data-ttu-id="08401-502">控制文件和文件夹的访问权限。</span><span class="sxs-lookup"><span data-stu-id="08401-502">Controls the ability to access files and folders.</span></span> <span data-ttu-id="08401-503">关联枚举： <see cref="F:System.Security.Permissions.PermissionState.Unrestricted" />。</span><span class="sxs-lookup"><span data-stu-id="08401-503">Associated enumeration: <see cref="F:System.Security.Permissions.PermissionState.Unrestricted" />.</span></span></permission>
        <related type="Article" href="~/docs/visual-basic/language-reference/objects/index.md"><span data-ttu-id="08401-504">对象 (Visual Basic)</span><span class="sxs-lookup"><span data-stu-id="08401-504">Objects (Visual Basic)</span></span></related>
      </Docs>
    </Member>
    <MemberGroup MemberName="DeleteDirectory">
      <AssemblyInfo>
        <AssemblyName>Microsoft.VisualBasic</AssemblyName>
        <AssemblyVersion>10.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Docs>
        <summary><span data-ttu-id="08401-505">删除目录。</span><span class="sxs-lookup"><span data-stu-id="08401-505">Deletes a directory.</span></span></summary>
      </Docs>
    </MemberGroup>
    <Member MemberName="DeleteDirectory">
      <MemberSignature Language="C#" Value="public void DeleteDirectory (string directory, Microsoft.VisualBasic.FileIO.DeleteDirectoryOption onDirectoryNotEmpty);" />
      <MemberSignature Language="ILAsm" Value=".method public instance void DeleteDirectory(string directory, valuetype Microsoft.VisualBasic.FileIO.DeleteDirectoryOption onDirectoryNotEmpty) cil managed" />
      <MemberSignature Language="DocId" Value="M:Microsoft.VisualBasic.MyServices.FileSystemProxy.DeleteDirectory(System.String,Microsoft.VisualBasic.FileIO.DeleteDirectoryOption)" />
      <MemberSignature Language="VB.NET" Value="Public Sub DeleteDirectory (directory As String, onDirectoryNotEmpty As DeleteDirectoryOption)" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; void DeleteDirectory(System::String ^ directory, Microsoft::VisualBasic::FileIO::DeleteDirectoryOption onDirectoryNotEmpty);" />
      <MemberSignature Language="F#" Value="member this.DeleteDirectory : string * Microsoft.VisualBasic.FileIO.DeleteDirectoryOption -&gt; unit" Usage="fileSystemProxy.DeleteDirectory (directory, onDirectoryNotEmpty)" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>Microsoft.VisualBasic</AssemblyName>
        <AssemblyVersion>8.0.0.0</AssemblyVersion>
        <AssemblyVersion>10.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <AssemblyInfo>
        <AssemblyName>Microsoft.VisualBasic.Core</AssemblyName>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Void</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="directory" Type="System.String" Index="0" FrameworkAlternate="netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;netframework-4.8" />
        <Parameter Name="onDirectoryNotEmpty" Type="Microsoft.VisualBasic.FileIO.DeleteDirectoryOption" Index="1" FrameworkAlternate="netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;netframework-4.8" />
      </Parameters>
      <Docs>
        <param name="directory"><span data-ttu-id="08401-506">要删除的目录。</span><span class="sxs-lookup"><span data-stu-id="08401-506">Directory to be deleted.</span></span></param>
        <param name="onDirectoryNotEmpty"><span data-ttu-id="08401-507">指定要删除的目录包含文件或目录时应采取的操作。</span><span class="sxs-lookup"><span data-stu-id="08401-507">Specifies what should be done when a directory that is to be deleted contains files or directories.</span></span> <span data-ttu-id="08401-508">默认值为 <see langword="DeleteDirectoryOption.DeleteAllContents" />。</span><span class="sxs-lookup"><span data-stu-id="08401-508">Default is <see langword="DeleteDirectoryOption.DeleteAllContents" />.</span></span></param>
        <summary><span data-ttu-id="08401-509">删除目录。</span><span class="sxs-lookup"><span data-stu-id="08401-509">Deletes a directory.</span></span></summary>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Examples  
 <span data-ttu-id="08401-510">该示例将删除目录`OldDirectory`只有当它为空。</span><span class="sxs-lookup"><span data-stu-id="08401-510">The example deletes the directory `OldDirectory` only if it is empty.</span></span>  
  
 [!code-vb[VbVbcnMyFileSystem#56](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbcnMyFileSystem/VB/Class1.vb#56)]  
  
 <span data-ttu-id="08401-511">此示例将删除目录`OldDirectory`和所有内容。</span><span class="sxs-lookup"><span data-stu-id="08401-511">This example deletes the directory `OldDirectory` and all of its contents.</span></span>  
  
 [!code-vb[VbVbcnMyFileSystem#57](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbcnMyFileSystem/VB/Class1.vb#57)]  
  
 <span data-ttu-id="08401-512">此示例将删除目录`OldDirectory`及其所有的内容，要求用户确认删除，但不会发送到的内容**回收站**。</span><span class="sxs-lookup"><span data-stu-id="08401-512">This example deletes the directory `OldDirectory` and all of its contents, asking the user to confirm the deletion, but does not send the contents to the **Recycle Bin**.</span></span>  
  
 [!code-vb[VbVbcnMyFileSystem#58](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbcnMyFileSystem/VB/Class1.vb#58)]  
  
 <span data-ttu-id="08401-513">此示例将删除目录`OldDirectory`及其所有发送到其内容**回收站**，但不显示操作的进度。</span><span class="sxs-lookup"><span data-stu-id="08401-513">This example deletes the directory `OldDirectory` and all of its contents, sending them to the **Recycle Bin**, but does not show the progress of the operation.</span></span>  
  
 [!code-vb[VbVbcnMyFileSystem#59](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbcnMyFileSystem/VB/Class1.vb#59)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentException"><span data-ttu-id="08401-514">路径是一个零长度字符串、 格式不正确、 仅包含空格，或包含无效字符 （包括通配符）。</span><span class="sxs-lookup"><span data-stu-id="08401-514">The path is a zero-length string, is malformed, contains only white space, or contains invalid characters (including wildcard characters).</span></span> <span data-ttu-id="08401-515">路径是设备路径（以 \\\\.\\ 开头）。</span><span class="sxs-lookup"><span data-stu-id="08401-515">The path is a device path (starts with \\\\.\\).</span></span></exception>
        <exception cref="T:System.ArgumentNullException"><span data-ttu-id="08401-516"><paramref name="directory" /> 为 <see langword="Nothing" /> 或空字符串。</span><span class="sxs-lookup"><span data-stu-id="08401-516"><paramref name="directory" /> is <see langword="Nothing" /> or an empty string.</span></span></exception>
        <exception cref="T:System.IO.DirectoryNotFoundException"><span data-ttu-id="08401-517">目录不存在，或者是一个文件。</span><span class="sxs-lookup"><span data-stu-id="08401-517">The directory does not exist or is a file.</span></span></exception>
        <exception cref="T:System.IO.IOException"><span data-ttu-id="08401-518">目录或子目录中的文件正在使用。</span><span class="sxs-lookup"><span data-stu-id="08401-518">A file in the directory or subdirectory is in use.</span></span></exception>
        <exception cref="T:System.NotSupportedException"><span data-ttu-id="08401-519">目录名称包含冒号 （:）。</span><span class="sxs-lookup"><span data-stu-id="08401-519">The directory name contains a colon (:).</span></span></exception>
        <exception cref="T:System.IO.PathTooLongException"><span data-ttu-id="08401-520">路径超过系统定义的最大长度。</span><span class="sxs-lookup"><span data-stu-id="08401-520">The path exceeds the system-defined maximum length.</span></span></exception>
        <exception cref="T:System.Security.SecurityException"><span data-ttu-id="08401-521">用户没有所需的权限。</span><span class="sxs-lookup"><span data-stu-id="08401-521">The user does not have required permissions.</span></span></exception>
        <exception cref="T:System.OperationCanceledException"><span data-ttu-id="08401-522">用户取消了操作或不能删除该目录。</span><span class="sxs-lookup"><span data-stu-id="08401-522">The user cancels the operation or the directory cannot be deleted.</span></span></exception>
        <permission cref="T:System.Security.Permissions.FileIOPermission"><span data-ttu-id="08401-523">控制文件和文件夹的访问权限。</span><span class="sxs-lookup"><span data-stu-id="08401-523">Controls the ability to access files and folders.</span></span> <span data-ttu-id="08401-524">关联枚举： <see cref="F:System.Security.Permissions.PermissionState.Unrestricted" />。</span><span class="sxs-lookup"><span data-stu-id="08401-524">Associated enumeration: <see cref="F:System.Security.Permissions.PermissionState.Unrestricted" />.</span></span></permission>
        <altmember cref="T:Microsoft.VisualBasic.FileIO.DeleteDirectoryOption" />
        <related type="Article" href="~/docs/visual-basic/language-reference/objects/index.md"><span data-ttu-id="08401-525">对象 (Visual Basic)</span><span class="sxs-lookup"><span data-stu-id="08401-525">Objects (Visual Basic)</span></span></related>
        <related type="Article" href="~/docs/visual-basic/developing-apps/programming/drives-directories-files/how-to-delete-a-file.md"><span data-ttu-id="08401-526">如何：在 Visual Basic 中删除文件</span><span class="sxs-lookup"><span data-stu-id="08401-526">How to: Delete a File in Visual Basic</span></span></related>
      </Docs>
    </Member>
    <Member MemberName="DeleteDirectory">
      <MemberSignature Language="C#" Value="public void DeleteDirectory (string directory, Microsoft.VisualBasic.FileIO.UIOption showUI, Microsoft.VisualBasic.FileIO.RecycleOption recycle);" />
      <MemberSignature Language="ILAsm" Value=".method public instance void DeleteDirectory(string directory, valuetype Microsoft.VisualBasic.FileIO.UIOption showUI, valuetype Microsoft.VisualBasic.FileIO.RecycleOption recycle) cil managed" />
      <MemberSignature Language="DocId" Value="M:Microsoft.VisualBasic.MyServices.FileSystemProxy.DeleteDirectory(System.String,Microsoft.VisualBasic.FileIO.UIOption,Microsoft.VisualBasic.FileIO.RecycleOption)" />
      <MemberSignature Language="VB.NET" Value="Public Sub DeleteDirectory (directory As String, showUI As UIOption, recycle As RecycleOption)" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; void DeleteDirectory(System::String ^ directory, Microsoft::VisualBasic::FileIO::UIOption showUI, Microsoft::VisualBasic::FileIO::RecycleOption recycle);" />
      <MemberSignature Language="F#" Value="member this.DeleteDirectory : string * Microsoft.VisualBasic.FileIO.UIOption * Microsoft.VisualBasic.FileIO.RecycleOption -&gt; unit" Usage="fileSystemProxy.DeleteDirectory (directory, showUI, recycle)" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>Microsoft.VisualBasic</AssemblyName>
        <AssemblyVersion>8.0.0.0</AssemblyVersion>
        <AssemblyVersion>10.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <AssemblyInfo>
        <AssemblyName>Microsoft.VisualBasic.Core</AssemblyName>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Void</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="directory" Type="System.String" Index="0" FrameworkAlternate="netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;netframework-4.8" />
        <Parameter Name="showUI" Type="Microsoft.VisualBasic.FileIO.UIOption" Index="1" FrameworkAlternate="netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;netframework-4.8" />
        <Parameter Name="recycle" Type="Microsoft.VisualBasic.FileIO.RecycleOption" Index="2" FrameworkAlternate="netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;netframework-4.8" />
      </Parameters>
      <Docs>
        <param name="directory"><span data-ttu-id="08401-527">要删除的目录。</span><span class="sxs-lookup"><span data-stu-id="08401-527">Directory to be deleted.</span></span></param>
        <param name="showUI"><span data-ttu-id="08401-528">指定是否操作的进度进行可视跟踪。</span><span class="sxs-lookup"><span data-stu-id="08401-528">Specifies whether to visually track the operation's progress.</span></span> <span data-ttu-id="08401-529">默认值为 <see langword="UIOption.OnlyErrorDialogs" />。</span><span class="sxs-lookup"><span data-stu-id="08401-529">Default is <see langword="UIOption.OnlyErrorDialogs" />.</span></span></param>
        <param name="recycle"><span data-ttu-id="08401-530">指定是否应将删除的文件发送到“回收站”。</span><span class="sxs-lookup"><span data-stu-id="08401-530">Specifies whether or not the deleted file should be sent to the **Recycle Bin**.</span></span> <span data-ttu-id="08401-531">默认值为 <see langword="RecycleOption.DeletePermanently" />。</span><span class="sxs-lookup"><span data-stu-id="08401-531">Default is <see langword="RecycleOption.DeletePermanently" />.</span></span></param>
        <summary><span data-ttu-id="08401-532">删除目录。</span><span class="sxs-lookup"><span data-stu-id="08401-532">Deletes a directory.</span></span></summary>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="08401-533">`showUI`和`recycle`不是用户交互，如 Windows 服务的应用程序中不支持参数。</span><span class="sxs-lookup"><span data-stu-id="08401-533">The `showUI` and `recycle` parameters are not supported in applications that are not user interactive, such as Windows Services.</span></span>  
  
   
  
## Examples  
 <span data-ttu-id="08401-534">该示例将删除目录`OldDirectory`只有当它为空。</span><span class="sxs-lookup"><span data-stu-id="08401-534">The example deletes the directory `OldDirectory` only if it is empty.</span></span>  
  
 [!code-vb[VbVbcnMyFileSystem#56](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbcnMyFileSystem/VB/Class1.vb#56)]  
  
 <span data-ttu-id="08401-535">此示例将删除目录`OldDirectory`和所有内容。</span><span class="sxs-lookup"><span data-stu-id="08401-535">This example deletes the directory `OldDirectory` and all of its contents.</span></span>  
  
 [!code-vb[VbVbcnMyFileSystem#57](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbcnMyFileSystem/VB/Class1.vb#57)]  
  
 <span data-ttu-id="08401-536">此示例将删除目录`OldDirectory`及其所有的内容，要求用户确认删除，但不会发送到的内容**回收站**。</span><span class="sxs-lookup"><span data-stu-id="08401-536">This example deletes the directory `OldDirectory` and all of its contents, asking the user to confirm the deletion, but does not send the contents to the **Recycle Bin**.</span></span>  
  
 [!code-vb[VbVbcnMyFileSystem#58](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbcnMyFileSystem/VB/Class1.vb#58)]  
  
 <span data-ttu-id="08401-537">此示例将删除目录`OldDirectory`及其所有发送到其内容**回收站**，但不显示操作的进度。</span><span class="sxs-lookup"><span data-stu-id="08401-537">This example deletes the directory `OldDirectory` and all of its contents, sending them to the **Recycle Bin**, but does not show the progress of the operation.</span></span>  
  
 [!code-vb[VbVbcnMyFileSystem#59](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbcnMyFileSystem/VB/Class1.vb#59)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentException"><span data-ttu-id="08401-538">路径是一个零长度字符串、 格式不正确、 仅包含空格，或包含无效字符 （包括通配符）。</span><span class="sxs-lookup"><span data-stu-id="08401-538">The path is a zero-length string, is malformed, contains only white space, or contains invalid characters (including wildcard characters).</span></span> <span data-ttu-id="08401-539">路径是设备路径（以 \\\\.\\ 开头）。</span><span class="sxs-lookup"><span data-stu-id="08401-539">The path is a device path (starts with \\\\.\\).</span></span></exception>
        <exception cref="T:System.ArgumentNullException"><span data-ttu-id="08401-540"><paramref name="directory" /> 为 <see langword="Nothing" /> 或空字符串。</span><span class="sxs-lookup"><span data-stu-id="08401-540"><paramref name="directory" /> is <see langword="Nothing" /> or an empty string.</span></span></exception>
        <exception cref="T:System.IO.DirectoryNotFoundException"><span data-ttu-id="08401-541">目录不存在，或者是一个文件。</span><span class="sxs-lookup"><span data-stu-id="08401-541">The directory does not exist or is a file.</span></span></exception>
        <exception cref="T:System.IO.IOException"><span data-ttu-id="08401-542">目录或子目录中的文件正在使用。</span><span class="sxs-lookup"><span data-stu-id="08401-542">A file in the directory or subdirectory is in use.</span></span></exception>
        <exception cref="T:System.NotSupportedException"><span data-ttu-id="08401-543">目录名称包含冒号 （:）。</span><span class="sxs-lookup"><span data-stu-id="08401-543">The directory name contains a colon (:).</span></span></exception>
        <exception cref="T:System.IO.PathTooLongException"><span data-ttu-id="08401-544">路径超过系统定义的最大长度。</span><span class="sxs-lookup"><span data-stu-id="08401-544">The path exceeds the system-defined maximum length.</span></span></exception>
        <exception cref="T:System.Security.SecurityException"><span data-ttu-id="08401-545">用户没有所需的权限。</span><span class="sxs-lookup"><span data-stu-id="08401-545">The user does not have required permissions.</span></span></exception>
        <exception cref="T:System.OperationCanceledException"><span data-ttu-id="08401-546">用户取消了操作或不能删除该目录。</span><span class="sxs-lookup"><span data-stu-id="08401-546">The user cancels the operation or the directory cannot be deleted.</span></span></exception>
        <permission cref="T:System.Security.Permissions.FileIOPermission"><span data-ttu-id="08401-547">控制文件和文件夹的访问权限。</span><span class="sxs-lookup"><span data-stu-id="08401-547">Controls the ability to access files and folders.</span></span> <span data-ttu-id="08401-548">关联枚举： <see cref="F:System.Security.Permissions.PermissionState.Unrestricted" />。</span><span class="sxs-lookup"><span data-stu-id="08401-548">Associated enumeration: <see cref="F:System.Security.Permissions.PermissionState.Unrestricted" />.</span></span></permission>
        <permission cref="T:System.Security.Permissions.UIPermission"><span data-ttu-id="08401-549">控制与用户界面和剪贴板相关的权限。</span><span class="sxs-lookup"><span data-stu-id="08401-549">Controls the permissions related to user interfaces and the clipboard.</span></span> <span data-ttu-id="08401-550">关联枚举： <see cref="F:System.Security.Permissions.UIPermissionWindow.SafeSubWindows" />。</span><span class="sxs-lookup"><span data-stu-id="08401-550">Associated enumeration: <see cref="F:System.Security.Permissions.UIPermissionWindow.SafeSubWindows" />.</span></span></permission>
        <altmember cref="T:Microsoft.VisualBasic.FileIO.RecycleOption" />
        <altmember cref="T:Microsoft.VisualBasic.FileIO.UIOption" />
        <related type="Article" href="~/docs/visual-basic/language-reference/objects/index.md"><span data-ttu-id="08401-551">对象 (Visual Basic)</span><span class="sxs-lookup"><span data-stu-id="08401-551">Objects (Visual Basic)</span></span></related>
        <related type="Article" href="~/docs/visual-basic/developing-apps/programming/drives-directories-files/how-to-delete-a-file.md"><span data-ttu-id="08401-552">如何：在 Visual Basic 中删除文件</span><span class="sxs-lookup"><span data-stu-id="08401-552">How to: Delete a File in Visual Basic</span></span></related>
      </Docs>
    </Member>
    <Member MemberName="DeleteDirectory">
      <MemberSignature Language="C#" Value="public void DeleteDirectory (string directory, Microsoft.VisualBasic.FileIO.UIOption showUI, Microsoft.VisualBasic.FileIO.RecycleOption recycle, Microsoft.VisualBasic.FileIO.UICancelOption onUserCancel);" />
      <MemberSignature Language="ILAsm" Value=".method public instance void DeleteDirectory(string directory, valuetype Microsoft.VisualBasic.FileIO.UIOption showUI, valuetype Microsoft.VisualBasic.FileIO.RecycleOption recycle, valuetype Microsoft.VisualBasic.FileIO.UICancelOption onUserCancel) cil managed" />
      <MemberSignature Language="DocId" Value="M:Microsoft.VisualBasic.MyServices.FileSystemProxy.DeleteDirectory(System.String,Microsoft.VisualBasic.FileIO.UIOption,Microsoft.VisualBasic.FileIO.RecycleOption,Microsoft.VisualBasic.FileIO.UICancelOption)" />
      <MemberSignature Language="VB.NET" Value="Public Sub DeleteDirectory (directory As String, showUI As UIOption, recycle As RecycleOption, onUserCancel As UICancelOption)" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; void DeleteDirectory(System::String ^ directory, Microsoft::VisualBasic::FileIO::UIOption showUI, Microsoft::VisualBasic::FileIO::RecycleOption recycle, Microsoft::VisualBasic::FileIO::UICancelOption onUserCancel);" />
      <MemberSignature Language="F#" Value="member this.DeleteDirectory : string * Microsoft.VisualBasic.FileIO.UIOption * Microsoft.VisualBasic.FileIO.RecycleOption * Microsoft.VisualBasic.FileIO.UICancelOption -&gt; unit" Usage="fileSystemProxy.DeleteDirectory (directory, showUI, recycle, onUserCancel)" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>Microsoft.VisualBasic</AssemblyName>
        <AssemblyVersion>8.0.0.0</AssemblyVersion>
        <AssemblyVersion>10.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <AssemblyInfo>
        <AssemblyName>Microsoft.VisualBasic.Core</AssemblyName>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Void</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="directory" Type="System.String" Index="0" FrameworkAlternate="netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;netframework-4.8" />
        <Parameter Name="showUI" Type="Microsoft.VisualBasic.FileIO.UIOption" Index="1" FrameworkAlternate="netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;netframework-4.8" />
        <Parameter Name="recycle" Type="Microsoft.VisualBasic.FileIO.RecycleOption" Index="2" FrameworkAlternate="netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;netframework-4.8" />
        <Parameter Name="onUserCancel" Type="Microsoft.VisualBasic.FileIO.UICancelOption" Index="3" FrameworkAlternate="netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;netframework-4.8" />
      </Parameters>
      <Docs>
        <param name="directory"><span data-ttu-id="08401-553">要删除的目录。</span><span class="sxs-lookup"><span data-stu-id="08401-553">Directory to be deleted.</span></span></param>
        <param name="showUI"><span data-ttu-id="08401-554">指定是否操作的进度进行可视跟踪。</span><span class="sxs-lookup"><span data-stu-id="08401-554">Specifies whether to visually track the operation's progress.</span></span> <span data-ttu-id="08401-555">默认值为 <see langword="UIOption.OnlyErrorDialogs" />。</span><span class="sxs-lookup"><span data-stu-id="08401-555">Default is <see langword="UIOption.OnlyErrorDialogs" />.</span></span></param>
        <param name="recycle"><span data-ttu-id="08401-556">指定是否应将删除的文件发送到“回收站”。</span><span class="sxs-lookup"><span data-stu-id="08401-556">Specifies whether or not the deleted file should be sent to the **Recycle Bin**.</span></span> <span data-ttu-id="08401-557">默认值为 <see langword="RecycleOption.DeletePermanently" />。</span><span class="sxs-lookup"><span data-stu-id="08401-557">Default is <see langword="RecycleOption.DeletePermanently" />.</span></span></param>
        <param name="onUserCancel"><span data-ttu-id="08401-558">指定在用户单击“取消”时是否引发异常。</span><span class="sxs-lookup"><span data-stu-id="08401-558">Specifies whether to throw an exception if the user clicks **Cancel**.</span></span></param>
        <summary><span data-ttu-id="08401-559">删除目录。</span><span class="sxs-lookup"><span data-stu-id="08401-559">Deletes a directory.</span></span></summary>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="08401-560">`showUI`， `recycle`，和`onUserCancel`不是用户交互，如 Windows 服务的应用程序中不支持参数。</span><span class="sxs-lookup"><span data-stu-id="08401-560">The `showUI`, `recycle`, and `onUserCancel` parameters are not supported in applications that are not user interactive, such as Windows Services.</span></span>  
  
   
  
## Examples  
 <span data-ttu-id="08401-561">该示例将删除目录`OldDirectory`只有当它为空。</span><span class="sxs-lookup"><span data-stu-id="08401-561">The example deletes the directory `OldDirectory` only if it is empty.</span></span>  
  
 [!code-vb[VbVbcnMyFileSystem#56](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbcnMyFileSystem/VB/Class1.vb#56)]  
  
 <span data-ttu-id="08401-562">此示例将删除目录`OldDirectory`和所有内容。</span><span class="sxs-lookup"><span data-stu-id="08401-562">This example deletes the directory `OldDirectory` and all of its contents.</span></span>  
  
 [!code-vb[VbVbcnMyFileSystem#57](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbcnMyFileSystem/VB/Class1.vb#57)]  
  
 <span data-ttu-id="08401-563">此示例将删除目录`OldDirectory`及其所有的内容，要求用户确认删除，但不会发送到的内容**回收站**。</span><span class="sxs-lookup"><span data-stu-id="08401-563">This example deletes the directory `OldDirectory` and all of its contents, asking the user to confirm the deletion, but does not send the contents to the **Recycle Bin**.</span></span>  
  
 [!code-vb[VbVbcnMyFileSystem#58](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbcnMyFileSystem/VB/Class1.vb#58)]  
  
 <span data-ttu-id="08401-564">此示例将删除目录`OldDirectory`及其所有发送到其内容**回收站**，但不显示操作的进度。</span><span class="sxs-lookup"><span data-stu-id="08401-564">This example deletes the directory `OldDirectory` and all of its contents, sending them to the **Recycle Bin**, but does not show the progress of the operation.</span></span>  
  
 [!code-vb[VbVbcnMyFileSystem#59](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbcnMyFileSystem/VB/Class1.vb#59)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentException"><span data-ttu-id="08401-565">路径是一个零长度字符串、 格式不正确、 仅包含空格，或包含无效字符 （包括通配符）。</span><span class="sxs-lookup"><span data-stu-id="08401-565">The path is a zero-length string, is malformed, contains only white space, or contains invalid characters (including wildcard characters).</span></span> <span data-ttu-id="08401-566">路径是设备路径（以 \\\\.\\ 开头）。</span><span class="sxs-lookup"><span data-stu-id="08401-566">The path is a device path (starts with \\\\.\\).</span></span></exception>
        <exception cref="T:System.ArgumentNullException"><span data-ttu-id="08401-567"><paramref name="directory" /> 为 <see langword="Nothing" /> 或空字符串。</span><span class="sxs-lookup"><span data-stu-id="08401-567"><paramref name="directory" /> is <see langword="Nothing" /> or an empty string.</span></span></exception>
        <exception cref="T:System.IO.DirectoryNotFoundException"><span data-ttu-id="08401-568">目录不存在，或者是一个文件。</span><span class="sxs-lookup"><span data-stu-id="08401-568">The directory does not exist or is a file.</span></span></exception>
        <exception cref="T:System.IO.IOException"><span data-ttu-id="08401-569">目录或子目录中的文件正在使用。</span><span class="sxs-lookup"><span data-stu-id="08401-569">A file in the directory or subdirectory is in use.</span></span></exception>
        <exception cref="T:System.NotSupportedException"><span data-ttu-id="08401-570">目录名称包含冒号 （:）。</span><span class="sxs-lookup"><span data-stu-id="08401-570">The directory name contains a colon (:).</span></span></exception>
        <exception cref="T:System.IO.PathTooLongException"><span data-ttu-id="08401-571">路径超过系统定义的最大长度。</span><span class="sxs-lookup"><span data-stu-id="08401-571">The path exceeds the system-defined maximum length.</span></span></exception>
        <exception cref="T:System.Security.SecurityException"><span data-ttu-id="08401-572">用户没有所需的权限。</span><span class="sxs-lookup"><span data-stu-id="08401-572">The user does not have required permissions.</span></span></exception>
        <exception cref="T:System.OperationCanceledException"><span data-ttu-id="08401-573">用户取消了操作或不能删除该目录。</span><span class="sxs-lookup"><span data-stu-id="08401-573">The user cancels the operation or the directory cannot be deleted.</span></span></exception>
        <permission cref="T:System.Security.Permissions.FileIOPermission"><span data-ttu-id="08401-574">控制文件和文件夹的访问权限。</span><span class="sxs-lookup"><span data-stu-id="08401-574">Controls the ability to access files and folders.</span></span> <span data-ttu-id="08401-575">关联枚举： <see cref="F:System.Security.Permissions.PermissionState.Unrestricted" />。</span><span class="sxs-lookup"><span data-stu-id="08401-575">Associated enumeration: <see cref="F:System.Security.Permissions.PermissionState.Unrestricted" />.</span></span></permission>
        <permission cref="T:System.Security.Permissions.UIPermission"><span data-ttu-id="08401-576">控制与用户界面和剪贴板相关的权限。</span><span class="sxs-lookup"><span data-stu-id="08401-576">Controls the permissions related to user interfaces and the clipboard.</span></span> <span data-ttu-id="08401-577">关联枚举： <see cref="F:System.Security.Permissions.UIPermissionWindow.SafeSubWindows" />。</span><span class="sxs-lookup"><span data-stu-id="08401-577">Associated enumeration: <see cref="F:System.Security.Permissions.UIPermissionWindow.SafeSubWindows" />.</span></span></permission>
        <altmember cref="T:Microsoft.VisualBasic.FileIO.UICancelOption" />
        <altmember cref="T:Microsoft.VisualBasic.FileIO.RecycleOption" />
        <altmember cref="T:Microsoft.VisualBasic.FileIO.UIOption" />
        <related type="Article" href="~/docs/visual-basic/language-reference/objects/index.md"><span data-ttu-id="08401-578">对象 (Visual Basic)</span><span class="sxs-lookup"><span data-stu-id="08401-578">Objects (Visual Basic)</span></span></related>
        <related type="Article" href="~/docs/visual-basic/developing-apps/programming/drives-directories-files/how-to-delete-a-file.md"><span data-ttu-id="08401-579">如何：在 Visual Basic 中删除文件</span><span class="sxs-lookup"><span data-stu-id="08401-579">How to: Delete a File in Visual Basic</span></span></related>
      </Docs>
    </Member>
    <MemberGroup MemberName="DeleteFile">
      <AssemblyInfo>
        <AssemblyName>Microsoft.VisualBasic</AssemblyName>
        <AssemblyVersion>10.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Docs>
        <summary><span data-ttu-id="08401-580">删除的文件。</span><span class="sxs-lookup"><span data-stu-id="08401-580">Deletes a file.</span></span></summary>
      </Docs>
    </MemberGroup>
    <Member MemberName="DeleteFile">
      <MemberSignature Language="C#" Value="public void DeleteFile (string file);" />
      <MemberSignature Language="ILAsm" Value=".method public instance void DeleteFile(string file) cil managed" />
      <MemberSignature Language="DocId" Value="M:Microsoft.VisualBasic.MyServices.FileSystemProxy.DeleteFile(System.String)" />
      <MemberSignature Language="VB.NET" Value="Public Sub DeleteFile (file As String)" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; void DeleteFile(System::String ^ file);" />
      <MemberSignature Language="F#" Value="member this.DeleteFile : string -&gt; unit" Usage="fileSystemProxy.DeleteFile file" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>Microsoft.VisualBasic</AssemblyName>
        <AssemblyVersion>8.0.0.0</AssemblyVersion>
        <AssemblyVersion>10.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <AssemblyInfo>
        <AssemblyName>Microsoft.VisualBasic.Core</AssemblyName>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Void</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="file" Type="System.String" Index="0" FrameworkAlternate="netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;netframework-4.8" />
      </Parameters>
      <Docs>
        <param name="file"><span data-ttu-id="08401-581">名称和要删除的文件的路径。</span><span class="sxs-lookup"><span data-stu-id="08401-581">Name and path of the file to be deleted.</span></span></param>
        <summary><span data-ttu-id="08401-582">删除的文件。</span><span class="sxs-lookup"><span data-stu-id="08401-582">Deletes a file.</span></span></summary>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="08401-583">下表列出了所涉及的任务的示例`My.Computer.FileSystem.DeleteFile`方法。</span><span class="sxs-lookup"><span data-stu-id="08401-583">The following table lists examples of tasks involving the `My.Computer.FileSystem.DeleteFile` method.</span></span>  
  
|<span data-ttu-id="08401-584">功能</span><span class="sxs-lookup"><span data-stu-id="08401-584">To</span></span>|<span data-ttu-id="08401-585">查看</span><span class="sxs-lookup"><span data-stu-id="08401-585">See</span></span>|  
|--------|---------|  
|<span data-ttu-id="08401-586">若要删除的文件</span><span class="sxs-lookup"><span data-stu-id="08401-586">To delete a file</span></span>|[<span data-ttu-id="08401-587">如何：删除文件</span><span class="sxs-lookup"><span data-stu-id="08401-587">How to: Delete a File</span></span>](~/docs/visual-basic/developing-apps/programming/drives-directories-files/how-to-delete-a-file.md)|  
  
   
  
## Examples  
 <span data-ttu-id="08401-588">此示例将删除该文件`Test.txt`。</span><span class="sxs-lookup"><span data-stu-id="08401-588">This example deletes the file `Test.txt`.</span></span>  
  
 [!code-vb[VbVbcnMyFileSystem#3](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbcnMyFileSystem/VB/Class1.vb#3)]  
  
 <span data-ttu-id="08401-589">此示例将删除该文件`Test.txt`，并允许用户确认应删除该文件。</span><span class="sxs-lookup"><span data-stu-id="08401-589">This example deletes the file `Test.txt` and allows the user to confirm that the file should be deleted.</span></span>  
  
 [!code-vb[VbVbcnMyFileSystem#4](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbcnMyFileSystem/VB/Class1.vb#4)]  
  
 <span data-ttu-id="08401-590">此示例将删除该文件`Test.txt`并将其发送到**回收站**。</span><span class="sxs-lookup"><span data-stu-id="08401-590">This example deletes the file `Test.txt` and sends it to the **Recycle Bin**.</span></span>  
  
 [!code-vb[VbVbcnMyFileSystem#5](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbcnMyFileSystem/VB/Class1.vb#5)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentException"><span data-ttu-id="08401-591">路径由于以下原因之一无效：是零长度字符串；仅为空白；包含无效字符；带有必须指定文件的尾部反斜杠；是设备路径（以 \\\\.\\ 开头）。</span><span class="sxs-lookup"><span data-stu-id="08401-591">The path is not valid for one of the following reasons: it is a zero-length string; it contains only white space; it contains invalid characters; it has a trailing slash where a file must be specified; or it is a device path (starts with \\\\.\\).</span></span></exception>
        <exception cref="T:System.ArgumentNullException"><span data-ttu-id="08401-592"><paramref name="file" /> 为 <see langword="Nothing" /> 或空字符串。</span><span class="sxs-lookup"><span data-stu-id="08401-592"><paramref name="file" /> is <see langword="Nothing" /> or an empty string.</span></span></exception>
        <exception cref="T:System.IO.PathTooLongException"><span data-ttu-id="08401-593">路径超过系统定义的最大长度。</span><span class="sxs-lookup"><span data-stu-id="08401-593">The path exceeds the system-defined maximum length.</span></span></exception>
        <exception cref="T:System.NotSupportedException"><span data-ttu-id="08401-594">在路径中的文件或目录名称包含冒号 （:），或格式无效。</span><span class="sxs-lookup"><span data-stu-id="08401-594">A file or directory name in the path contains a colon (:) or is in an invalid format.</span></span></exception>
        <exception cref="T:System.IO.IOException"><span data-ttu-id="08401-595">文件正在使用中。</span><span class="sxs-lookup"><span data-stu-id="08401-595">The file is in use.</span></span></exception>
        <exception cref="T:System.Security.SecurityException"><span data-ttu-id="08401-596">该用户缺少必要的权限查看该路径。</span><span class="sxs-lookup"><span data-stu-id="08401-596">The user lacks necessary permissions to view the path.</span></span></exception>
        <exception cref="T:System.IO.FileNotFoundException"><span data-ttu-id="08401-597">文件不存在。</span><span class="sxs-lookup"><span data-stu-id="08401-597">The file does not exist.</span></span></exception>
        <exception cref="T:System.UnauthorizedAccessException"><span data-ttu-id="08401-598">用户没有删除该文件的权限或该文件是只读的。</span><span class="sxs-lookup"><span data-stu-id="08401-598">The user does not have permission to delete the file or the file is read-only.</span></span></exception>
        <permission cref="T:System.Security.Permissions.FileIOPermission"><span data-ttu-id="08401-599">控制文件和文件夹的访问权限。</span><span class="sxs-lookup"><span data-stu-id="08401-599">Controls the ability to access files and folders.</span></span> <span data-ttu-id="08401-600">关联枚举： <see cref="F:System.Security.Permissions.PermissionState.Unrestricted" />。</span><span class="sxs-lookup"><span data-stu-id="08401-600">Associated enumeration: <see cref="F:System.Security.Permissions.PermissionState.Unrestricted" />.</span></span></permission>
        <related type="Article" href="~/docs/visual-basic/language-reference/objects/index.md"><span data-ttu-id="08401-601">对象 (Visual Basic)</span><span class="sxs-lookup"><span data-stu-id="08401-601">Objects (Visual Basic)</span></span></related>
        <related type="Article" href="~/docs/visual-basic/developing-apps/programming/drives-directories-files/how-to-delete-a-file.md"><span data-ttu-id="08401-602">如何：在 Visual Basic 中删除文件</span><span class="sxs-lookup"><span data-stu-id="08401-602">How to: Delete a File in Visual Basic</span></span></related>
      </Docs>
    </Member>
    <Member MemberName="DeleteFile">
      <MemberSignature Language="C#" Value="public void DeleteFile (string file, Microsoft.VisualBasic.FileIO.UIOption showUI, Microsoft.VisualBasic.FileIO.RecycleOption recycle);" />
      <MemberSignature Language="ILAsm" Value=".method public instance void DeleteFile(string file, valuetype Microsoft.VisualBasic.FileIO.UIOption showUI, valuetype Microsoft.VisualBasic.FileIO.RecycleOption recycle) cil managed" />
      <MemberSignature Language="DocId" Value="M:Microsoft.VisualBasic.MyServices.FileSystemProxy.DeleteFile(System.String,Microsoft.VisualBasic.FileIO.UIOption,Microsoft.VisualBasic.FileIO.RecycleOption)" />
      <MemberSignature Language="VB.NET" Value="Public Sub DeleteFile (file As String, showUI As UIOption, recycle As RecycleOption)" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; void DeleteFile(System::String ^ file, Microsoft::VisualBasic::FileIO::UIOption showUI, Microsoft::VisualBasic::FileIO::RecycleOption recycle);" />
      <MemberSignature Language="F#" Value="member this.DeleteFile : string * Microsoft.VisualBasic.FileIO.UIOption * Microsoft.VisualBasic.FileIO.RecycleOption -&gt; unit" Usage="fileSystemProxy.DeleteFile (file, showUI, recycle)" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>Microsoft.VisualBasic</AssemblyName>
        <AssemblyVersion>8.0.0.0</AssemblyVersion>
        <AssemblyVersion>10.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <AssemblyInfo>
        <AssemblyName>Microsoft.VisualBasic.Core</AssemblyName>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Void</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="file" Type="System.String" Index="0" FrameworkAlternate="netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;netframework-4.8" />
        <Parameter Name="showUI" Type="Microsoft.VisualBasic.FileIO.UIOption" Index="1" FrameworkAlternate="netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;netframework-4.8" />
        <Parameter Name="recycle" Type="Microsoft.VisualBasic.FileIO.RecycleOption" Index="2" FrameworkAlternate="netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;netframework-4.8" />
      </Parameters>
      <Docs>
        <param name="file"><span data-ttu-id="08401-603">名称和要删除的文件的路径。</span><span class="sxs-lookup"><span data-stu-id="08401-603">Name and path of the file to be deleted.</span></span></param>
        <param name="showUI"><span data-ttu-id="08401-604">是否直观地跟踪操作的进度。</span><span class="sxs-lookup"><span data-stu-id="08401-604">Whether to visually track the operation's progress.</span></span> <span data-ttu-id="08401-605">默认值为 <see langword="UIOption.OnlyErrorDialogs" />。</span><span class="sxs-lookup"><span data-stu-id="08401-605">Default is <see langword="UIOption.OnlyErrorDialogs" />.</span></span></param>
        <param name="recycle"><span data-ttu-id="08401-606">删除的文件是否应发送到“回收站”。</span><span class="sxs-lookup"><span data-stu-id="08401-606">Whether or not the deleted file should be sent to the **Recycle Bin**.</span></span> <span data-ttu-id="08401-607">默认值为 <see langword="RecycleOption.DeletePermanently" />。</span><span class="sxs-lookup"><span data-stu-id="08401-607">Default is <see langword="RecycleOption.DeletePermanently" />.</span></span></param>
        <summary><span data-ttu-id="08401-608">删除的文件。</span><span class="sxs-lookup"><span data-stu-id="08401-608">Deletes a file.</span></span></summary>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="08401-609">`showUI`和`recycle`不是用户交互，如 Windows 服务的应用程序中不支持参数。</span><span class="sxs-lookup"><span data-stu-id="08401-609">The `showUI` and `recycle` parameters are not supported in applications that are not user interactive, such as Windows Services.</span></span>  
  
 <span data-ttu-id="08401-610">下表列出了所涉及的任务的示例`My.Computer.FileSystem.DeleteFile`方法。</span><span class="sxs-lookup"><span data-stu-id="08401-610">The following table lists examples of tasks involving the `My.Computer.FileSystem.DeleteFile` method.</span></span>  
  
|<span data-ttu-id="08401-611">功能</span><span class="sxs-lookup"><span data-stu-id="08401-611">To</span></span>|<span data-ttu-id="08401-612">查看</span><span class="sxs-lookup"><span data-stu-id="08401-612">See</span></span>|  
|--------|---------|  
|<span data-ttu-id="08401-613">若要删除的文件</span><span class="sxs-lookup"><span data-stu-id="08401-613">To delete a file</span></span>|[<span data-ttu-id="08401-614">如何：删除文件</span><span class="sxs-lookup"><span data-stu-id="08401-614">How to: Delete a File</span></span>](~/docs/visual-basic/developing-apps/programming/drives-directories-files/how-to-delete-a-file.md)|  
  
   
  
## Examples  
 <span data-ttu-id="08401-615">此示例将删除该文件`Test.txt`。</span><span class="sxs-lookup"><span data-stu-id="08401-615">This example deletes the file `Test.txt`.</span></span>  
  
 [!code-vb[VbVbcnMyFileSystem#3](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbcnMyFileSystem/VB/Class1.vb#3)]  
  
 <span data-ttu-id="08401-616">此示例将删除该文件`Test.txt`，并允许用户确认应删除该文件。</span><span class="sxs-lookup"><span data-stu-id="08401-616">This example deletes the file `Test.txt` and allows the user to confirm that the file should be deleted.</span></span>  
  
 [!code-vb[VbVbcnMyFileSystem#4](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbcnMyFileSystem/VB/Class1.vb#4)]  
  
 <span data-ttu-id="08401-617">此示例将删除该文件`Test.txt`并将其发送到**回收站**。</span><span class="sxs-lookup"><span data-stu-id="08401-617">This example deletes the file `Test.txt` and sends it to the **Recycle Bin**.</span></span>  
  
 [!code-vb[VbVbcnMyFileSystem#5](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbcnMyFileSystem/VB/Class1.vb#5)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentException"><span data-ttu-id="08401-618">路径由于以下原因之一无效：是零长度字符串；仅为空白；包含无效字符；带有必须指定文件的尾部反斜杠；是设备路径（以 \\\\.\\ 开头）。</span><span class="sxs-lookup"><span data-stu-id="08401-618">The path is not valid for one of the following reasons: it is a zero-length string; it contains only white space; it contains invalid characters; it has a trailing slash where a file must be specified; or it is a device path (starts with \\\\.\\).</span></span></exception>
        <exception cref="T:System.ArgumentNullException"><span data-ttu-id="08401-619"><paramref name="file" /> 为 <see langword="Nothing" /> 或空字符串。</span><span class="sxs-lookup"><span data-stu-id="08401-619"><paramref name="file" /> is <see langword="Nothing" /> or an empty string.</span></span></exception>
        <exception cref="T:System.IO.PathTooLongException"><span data-ttu-id="08401-620">路径超过系统定义的最大长度。</span><span class="sxs-lookup"><span data-stu-id="08401-620">The path exceeds the system-defined maximum length.</span></span></exception>
        <exception cref="T:System.NotSupportedException"><span data-ttu-id="08401-621">在路径中的文件或目录名称包含冒号 （:），或格式无效。</span><span class="sxs-lookup"><span data-stu-id="08401-621">A file or directory name in the path contains a colon (:) or is in an invalid format.</span></span></exception>
        <exception cref="T:System.IO.IOException"><span data-ttu-id="08401-622">文件正在使用中。</span><span class="sxs-lookup"><span data-stu-id="08401-622">The file is in use.</span></span></exception>
        <exception cref="T:System.Security.SecurityException"><span data-ttu-id="08401-623">该用户缺少必要的权限查看该路径。</span><span class="sxs-lookup"><span data-stu-id="08401-623">The user lacks necessary permissions to view the path.</span></span></exception>
        <exception cref="T:System.IO.FileNotFoundException"><span data-ttu-id="08401-624">文件不存在。</span><span class="sxs-lookup"><span data-stu-id="08401-624">The file does not exist.</span></span></exception>
        <exception cref="T:System.UnauthorizedAccessException"><span data-ttu-id="08401-625">用户没有删除该文件的权限或该文件是只读的。</span><span class="sxs-lookup"><span data-stu-id="08401-625">The user does not have permission to delete the file or the file is read-only.</span></span></exception>
        <permission cref="T:System.Security.Permissions.FileIOPermission"><span data-ttu-id="08401-626">控制文件和文件夹的访问权限。</span><span class="sxs-lookup"><span data-stu-id="08401-626">Controls the ability to access files and folders.</span></span> <span data-ttu-id="08401-627">关联枚举： <see cref="F:System.Security.Permissions.PermissionState.Unrestricted" />。</span><span class="sxs-lookup"><span data-stu-id="08401-627">Associated enumeration: <see cref="F:System.Security.Permissions.PermissionState.Unrestricted" />.</span></span></permission>
        <permission cref="T:System.Security.Permissions.UIPermission"><span data-ttu-id="08401-628">控制与用户界面和剪贴板相关的权限。</span><span class="sxs-lookup"><span data-stu-id="08401-628">Controls the permissions related to user interfaces and the clipboard.</span></span> <span data-ttu-id="08401-629">关联枚举： <see cref="F:System.Security.Permissions.UIPermissionWindow.SafeSubWindows" />。</span><span class="sxs-lookup"><span data-stu-id="08401-629">Associated enumeration: <see cref="F:System.Security.Permissions.UIPermissionWindow.SafeSubWindows" />.</span></span></permission>
        <altmember cref="T:Microsoft.VisualBasic.FileIO.RecycleOption" />
        <altmember cref="T:Microsoft.VisualBasic.FileIO.UIOption" />
        <related type="Article" href="~/docs/visual-basic/language-reference/objects/index.md"><span data-ttu-id="08401-630">对象 (Visual Basic)</span><span class="sxs-lookup"><span data-stu-id="08401-630">Objects (Visual Basic)</span></span></related>
        <related type="Article" href="~/docs/visual-basic/developing-apps/programming/drives-directories-files/how-to-delete-a-file.md"><span data-ttu-id="08401-631">如何：在 Visual Basic 中删除文件</span><span class="sxs-lookup"><span data-stu-id="08401-631">How to: Delete a File in Visual Basic</span></span></related>
      </Docs>
    </Member>
    <Member MemberName="DeleteFile">
      <MemberSignature Language="C#" Value="public void DeleteFile (string file, Microsoft.VisualBasic.FileIO.UIOption showUI, Microsoft.VisualBasic.FileIO.RecycleOption recycle, Microsoft.VisualBasic.FileIO.UICancelOption onUserCancel);" />
      <MemberSignature Language="ILAsm" Value=".method public instance void DeleteFile(string file, valuetype Microsoft.VisualBasic.FileIO.UIOption showUI, valuetype Microsoft.VisualBasic.FileIO.RecycleOption recycle, valuetype Microsoft.VisualBasic.FileIO.UICancelOption onUserCancel) cil managed" />
      <MemberSignature Language="DocId" Value="M:Microsoft.VisualBasic.MyServices.FileSystemProxy.DeleteFile(System.String,Microsoft.VisualBasic.FileIO.UIOption,Microsoft.VisualBasic.FileIO.RecycleOption,Microsoft.VisualBasic.FileIO.UICancelOption)" />
      <MemberSignature Language="VB.NET" Value="Public Sub DeleteFile (file As String, showUI As UIOption, recycle As RecycleOption, onUserCancel As UICancelOption)" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; void DeleteFile(System::String ^ file, Microsoft::VisualBasic::FileIO::UIOption showUI, Microsoft::VisualBasic::FileIO::RecycleOption recycle, Microsoft::VisualBasic::FileIO::UICancelOption onUserCancel);" />
      <MemberSignature Language="F#" Value="member this.DeleteFile : string * Microsoft.VisualBasic.FileIO.UIOption * Microsoft.VisualBasic.FileIO.RecycleOption * Microsoft.VisualBasic.FileIO.UICancelOption -&gt; unit" Usage="fileSystemProxy.DeleteFile (file, showUI, recycle, onUserCancel)" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>Microsoft.VisualBasic</AssemblyName>
        <AssemblyVersion>8.0.0.0</AssemblyVersion>
        <AssemblyVersion>10.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <AssemblyInfo>
        <AssemblyName>Microsoft.VisualBasic.Core</AssemblyName>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Void</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="file" Type="System.String" Index="0" FrameworkAlternate="netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;netframework-4.8" />
        <Parameter Name="showUI" Type="Microsoft.VisualBasic.FileIO.UIOption" Index="1" FrameworkAlternate="netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;netframework-4.8" />
        <Parameter Name="recycle" Type="Microsoft.VisualBasic.FileIO.RecycleOption" Index="2" FrameworkAlternate="netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;netframework-4.8" />
        <Parameter Name="onUserCancel" Type="Microsoft.VisualBasic.FileIO.UICancelOption" Index="3" FrameworkAlternate="netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;netframework-4.8" />
      </Parameters>
      <Docs>
        <param name="file"><span data-ttu-id="08401-632">名称和要删除的文件的路径。</span><span class="sxs-lookup"><span data-stu-id="08401-632">Name and path of the file to be deleted.</span></span></param>
        <param name="showUI"><span data-ttu-id="08401-633">是否直观地跟踪操作的进度。</span><span class="sxs-lookup"><span data-stu-id="08401-633">Whether to visually track the operation's progress.</span></span> <span data-ttu-id="08401-634">默认值为 <see langword="UIOption.OnlyErrorDialogs" />。</span><span class="sxs-lookup"><span data-stu-id="08401-634">Default is <see langword="UIOption.OnlyErrorDialogs" />.</span></span></param>
        <param name="recycle"><span data-ttu-id="08401-635">删除的文件是否应发送到“回收站”。</span><span class="sxs-lookup"><span data-stu-id="08401-635">Whether or not the deleted file should be sent to the **Recycle Bin**.</span></span> <span data-ttu-id="08401-636">默认值为 <see langword="RecycleOption.DeletePermanently" />。</span><span class="sxs-lookup"><span data-stu-id="08401-636">Default is <see langword="RecycleOption.DeletePermanently" />.</span></span></param>
        <param name="onUserCancel"><span data-ttu-id="08401-637">指定当用户取消了操作时引发异常。</span><span class="sxs-lookup"><span data-stu-id="08401-637">Specifies whether or not an exception is thrown when the user cancels the operation.</span></span> <span data-ttu-id="08401-638">默认值为 <see langword="UICancelOption.ThrowException" />。</span><span class="sxs-lookup"><span data-stu-id="08401-638">Default is <see langword="UICancelOption.ThrowException" />.</span></span></param>
        <summary><span data-ttu-id="08401-639">删除的文件。</span><span class="sxs-lookup"><span data-stu-id="08401-639">Deletes a file.</span></span></summary>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="08401-640">`showUI`， `recycle`，和`onUserCancel`不是用户交互，如 Windows 服务的应用程序中不支持参数。</span><span class="sxs-lookup"><span data-stu-id="08401-640">The `showUI`, `recycle`, and `onUserCancel` parameters are not supported in applications that are not user interactive, such as Windows Services.</span></span>  
  
 <span data-ttu-id="08401-641">下表列出了所涉及的任务的示例`My.Computer.FileSystem.DeleteFile`方法。</span><span class="sxs-lookup"><span data-stu-id="08401-641">The following table lists examples of tasks involving the `My.Computer.FileSystem.DeleteFile` method.</span></span>  
  
|<span data-ttu-id="08401-642">功能</span><span class="sxs-lookup"><span data-stu-id="08401-642">To</span></span>|<span data-ttu-id="08401-643">查看</span><span class="sxs-lookup"><span data-stu-id="08401-643">See</span></span>|  
|--------|---------|  
|<span data-ttu-id="08401-644">若要删除的文件</span><span class="sxs-lookup"><span data-stu-id="08401-644">To delete a file</span></span>|[<span data-ttu-id="08401-645">如何：删除文件</span><span class="sxs-lookup"><span data-stu-id="08401-645">How to: Delete a File</span></span>](~/docs/visual-basic/developing-apps/programming/drives-directories-files/how-to-delete-a-file.md)|  
  
   
  
## Examples  
 <span data-ttu-id="08401-646">此示例将删除该文件`Test.txt`。</span><span class="sxs-lookup"><span data-stu-id="08401-646">This example deletes the file `Test.txt`.</span></span>  
  
 [!code-vb[VbVbcnMyFileSystem#3](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbcnMyFileSystem/VB/Class1.vb#3)]  
  
 <span data-ttu-id="08401-647">此示例将删除该文件`Test.txt`，并允许用户确认应删除该文件。</span><span class="sxs-lookup"><span data-stu-id="08401-647">This example deletes the file `Test.txt` and allows the user to confirm that the file should be deleted.</span></span>  
  
 [!code-vb[VbVbcnMyFileSystem#4](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbcnMyFileSystem/VB/Class1.vb#4)]  
  
 <span data-ttu-id="08401-648">此示例将删除该文件`Test.txt`并将其发送到**回收站**。</span><span class="sxs-lookup"><span data-stu-id="08401-648">This example deletes the file `Test.txt` and sends it to the **Recycle Bin**.</span></span>  
  
 [!code-vb[VbVbcnMyFileSystem#5](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbcnMyFileSystem/VB/Class1.vb#5)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentException"><span data-ttu-id="08401-649">路径由于以下原因之一无效：是零长度字符串；仅为空白；包含无效字符；带有必须指定文件的尾部反斜杠；是设备路径（以 \\\\.\\ 开头）。</span><span class="sxs-lookup"><span data-stu-id="08401-649">The path is not valid for one of the following reasons: it is a zero-length string; it contains only white space; it contains invalid characters; it has a trailing slash where a file must be specified; or it is a device path (starts with \\\\.\\).</span></span></exception>
        <exception cref="T:System.ArgumentNullException"><span data-ttu-id="08401-650"><paramref name="file" /> 为 <see langword="Nothing" /> 或空字符串。</span><span class="sxs-lookup"><span data-stu-id="08401-650"><paramref name="file" /> is <see langword="Nothing" /> or an empty string.</span></span></exception>
        <exception cref="T:System.IO.PathTooLongException"><span data-ttu-id="08401-651">路径超过系统定义的最大长度。</span><span class="sxs-lookup"><span data-stu-id="08401-651">The path exceeds the system-defined maximum length.</span></span></exception>
        <exception cref="T:System.NotSupportedException"><span data-ttu-id="08401-652">在路径中的文件或目录名称包含冒号 （:），或格式无效。</span><span class="sxs-lookup"><span data-stu-id="08401-652">A file or directory name in the path contains a colon (:) or is in an invalid format.</span></span></exception>
        <exception cref="T:System.IO.IOException"><span data-ttu-id="08401-653">文件正在使用中。</span><span class="sxs-lookup"><span data-stu-id="08401-653">The file is in use.</span></span></exception>
        <exception cref="T:System.Security.SecurityException"><span data-ttu-id="08401-654">该用户缺少必要的权限查看该路径。</span><span class="sxs-lookup"><span data-stu-id="08401-654">The user lacks necessary permissions to view the path.</span></span></exception>
        <exception cref="T:System.IO.FileNotFoundException"><span data-ttu-id="08401-655">文件不存在。</span><span class="sxs-lookup"><span data-stu-id="08401-655">The file does not exist.</span></span></exception>
        <exception cref="T:System.UnauthorizedAccessException"><span data-ttu-id="08401-656">用户没有删除该文件的权限或该文件是只读的。</span><span class="sxs-lookup"><span data-stu-id="08401-656">The user does not have permission to delete the file or the file is read-only.</span></span></exception>
        <exception cref="T:System.OperationCanceledException"><span data-ttu-id="08401-657">用户取消操作并<paramref name="onUserCancel" />设置为<see cref="F:Microsoft.VisualBasic.FileIO.UICancelOption.ThrowException" />。</span><span class="sxs-lookup"><span data-stu-id="08401-657">The user cancelled the operation and <paramref name="onUserCancel" /> is set to <see cref="F:Microsoft.VisualBasic.FileIO.UICancelOption.ThrowException" />.</span></span></exception>
        <permission cref="T:System.Security.Permissions.FileIOPermission"><span data-ttu-id="08401-658">控制文件和文件夹的访问权限。</span><span class="sxs-lookup"><span data-stu-id="08401-658">Controls the ability to access files and folders.</span></span> <span data-ttu-id="08401-659">关联枚举： <see cref="F:System.Security.Permissions.PermissionState.Unrestricted" />。</span><span class="sxs-lookup"><span data-stu-id="08401-659">Associated enumeration: <see cref="F:System.Security.Permissions.PermissionState.Unrestricted" />.</span></span></permission>
        <permission cref="T:System.Security.Permissions.UIPermission"><span data-ttu-id="08401-660">控制与用户界面和剪贴板相关的权限。</span><span class="sxs-lookup"><span data-stu-id="08401-660">Controls the permissions related to user interfaces and the clipboard.</span></span> <span data-ttu-id="08401-661">关联枚举： <see cref="F:System.Security.Permissions.UIPermissionWindow.SafeSubWindows" />。</span><span class="sxs-lookup"><span data-stu-id="08401-661">Associated enumeration: <see cref="F:System.Security.Permissions.UIPermissionWindow.SafeSubWindows" />.</span></span></permission>
        <altmember cref="T:Microsoft.VisualBasic.FileIO.UICancelOption" />
        <altmember cref="T:Microsoft.VisualBasic.FileIO.RecycleOption" />
        <altmember cref="T:Microsoft.VisualBasic.FileIO.UIOption" />
        <related type="Article" href="~/docs/visual-basic/language-reference/objects/index.md"><span data-ttu-id="08401-662">对象 (Visual Basic)</span><span class="sxs-lookup"><span data-stu-id="08401-662">Objects (Visual Basic)</span></span></related>
        <related type="Article" href="~/docs/visual-basic/developing-apps/programming/drives-directories-files/how-to-delete-a-file.md"><span data-ttu-id="08401-663">如何：在 Visual Basic 中删除文件</span><span class="sxs-lookup"><span data-stu-id="08401-663">How to: Delete a File in Visual Basic</span></span></related>
      </Docs>
    </Member>
    <Member MemberName="DirectoryExists">
      <MemberSignature Language="C#" Value="public bool DirectoryExists (string directory);" />
      <MemberSignature Language="ILAsm" Value=".method public instance bool DirectoryExists(string directory) cil managed" />
      <MemberSignature Language="DocId" Value="M:Microsoft.VisualBasic.MyServices.FileSystemProxy.DirectoryExists(System.String)" />
      <MemberSignature Language="VB.NET" Value="Public Function DirectoryExists (directory As String) As Boolean" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; bool DirectoryExists(System::String ^ directory);" />
      <MemberSignature Language="F#" Value="member this.DirectoryExists : string -&gt; bool" Usage="fileSystemProxy.DirectoryExists directory" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>Microsoft.VisualBasic</AssemblyName>
        <AssemblyVersion>8.0.0.0</AssemblyVersion>
        <AssemblyVersion>10.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <AssemblyInfo>
        <AssemblyName>Microsoft.VisualBasic.Core</AssemblyName>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Boolean</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="directory" Type="System.String" Index="0" FrameworkAlternate="netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;netframework-4.8" />
      </Parameters>
      <Docs>
        <param name="directory"><span data-ttu-id="08401-664">目录的路径。</span><span class="sxs-lookup"><span data-stu-id="08401-664">Path of the directory.</span></span></param>
        <summary><span data-ttu-id="08401-665">返回<see langword="True" />如果存在指定的目录。</span><span class="sxs-lookup"><span data-stu-id="08401-665">Returns <see langword="True" /> if the specified directory exists.</span></span></summary>
        <returns><span data-ttu-id="08401-666"><see langword="True" /> 如果目录存在，则否则为<see langword="False" />。</span><span class="sxs-lookup"><span data-stu-id="08401-666"><see langword="True" /> if the directory exists; otherwise <see langword="False" />.</span></span></returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Examples  
 <span data-ttu-id="08401-667">本示例可确定是否在目录`C:\backup\logs`存在，并检查其属性。</span><span class="sxs-lookup"><span data-stu-id="08401-667">This example determines whether the directory `C:\backup\logs` exists and checks its properties.</span></span>  
  
 [!code-vb[VbRefFile#13](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbRefFile/VB/Class1.vb#13)]  
  
 ]]></format>
        </remarks>
        <permission cref="T:System.Security.Permissions.FileIOPermission"><span data-ttu-id="08401-668">控制文件和文件夹的访问权限。</span><span class="sxs-lookup"><span data-stu-id="08401-668">Controls the ability to access files and folders.</span></span> <span data-ttu-id="08401-669">关联枚举： <see cref="F:System.Security.Permissions.PermissionState.Unrestricted" />。</span><span class="sxs-lookup"><span data-stu-id="08401-669">Associated enumeration: <see cref="F:System.Security.Permissions.PermissionState.Unrestricted" />.</span></span></permission>
        <related type="Article" href="~/docs/visual-basic/language-reference/objects/index.md"><span data-ttu-id="08401-670">对象 (Visual Basic)</span><span class="sxs-lookup"><span data-stu-id="08401-670">Objects (Visual Basic)</span></span></related>
        <related type="Article" href="~/docs/visual-basic/developing-apps/programming/drives-directories-files/creating-deleting-and-moving-files-and-directories.md"><span data-ttu-id="08401-671">创建、删除和移动文件和目录 (Visual Basic)</span><span class="sxs-lookup"><span data-stu-id="08401-671">Creating, Deleting, and Moving Files and Directories in Visual Basic</span></span></related>
        <related type="Article" href="~/docs/visual-basic/developing-apps/programming/drives-directories-files/walkthrough-manipulating-files-and-directories.md"><span data-ttu-id="08401-672">演练：在 Visual Basic 中操作文件和目录</span><span class="sxs-lookup"><span data-stu-id="08401-672">Walkthrough: Manipulating Files and Directories in Visual Basic</span></span></related>
      </Docs>
    </Member>
    <Member MemberName="Drives">
      <MemberSignature Language="C#" Value="public System.Collections.ObjectModel.ReadOnlyCollection&lt;System.IO.DriveInfo&gt; Drives { get; }" />
      <MemberSignature Language="ILAsm" Value=".property instance class System.Collections.ObjectModel.ReadOnlyCollection`1&lt;class System.IO.DriveInfo&gt; Drives" />
      <MemberSignature Language="DocId" Value="P:Microsoft.VisualBasic.MyServices.FileSystemProxy.Drives" />
      <MemberSignature Language="VB.NET" Value="Public ReadOnly Property Drives As ReadOnlyCollection(Of DriveInfo)" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; property System::Collections::ObjectModel::ReadOnlyCollection&lt;System::IO::DriveInfo ^&gt; ^ Drives { System::Collections::ObjectModel::ReadOnlyCollection&lt;System::IO::DriveInfo ^&gt; ^ get(); };" />
      <MemberSignature Language="F#" Value="member this.Drives : System.Collections.ObjectModel.ReadOnlyCollection&lt;System.IO.DriveInfo&gt;" Usage="Microsoft.VisualBasic.MyServices.FileSystemProxy.Drives" />
      <MemberType>Property</MemberType>
      <AssemblyInfo>
        <AssemblyName>Microsoft.VisualBasic</AssemblyName>
        <AssemblyVersion>8.0.0.0</AssemblyVersion>
        <AssemblyVersion>10.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <AssemblyInfo>
        <AssemblyName>Microsoft.VisualBasic.Core</AssemblyName>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Collections.ObjectModel.ReadOnlyCollection&lt;System.IO.DriveInfo&gt;</ReturnType>
      </ReturnValue>
      <Docs>
        <summary><span data-ttu-id="08401-673">返回所有可用的驱动器名称的只读集合。</span><span class="sxs-lookup"><span data-stu-id="08401-673">Returns a read-only collection of all available drive names.</span></span></summary>
        <value><span data-ttu-id="08401-674">所有可用驱动器作为只读集合<see cref="T:System.IO.DriveInfo" />对象。</span><span class="sxs-lookup"><span data-stu-id="08401-674">A read-only collection of all available drives as <see cref="T:System.IO.DriveInfo" /> objects.</span></span></value>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="08401-675">此属性返回的所有逻辑驱动器。</span><span class="sxs-lookup"><span data-stu-id="08401-675">This property returns all logical drives.</span></span>  
  
   
  
## Examples  
 <span data-ttu-id="08401-676">此示例显示在消息框中可用的驱动器名称。</span><span class="sxs-lookup"><span data-stu-id="08401-676">This example displays the available drive names in a message box.</span></span>  
  
 [!code-vb[VbRefFile#19](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbRefFile/VB/Class1.vb#19)]  
  
 ]]></format>
        </remarks>
        <altCompliant cref="None." />
        <permission cref="T:System.Security.Permissions.FileIOPermission"><span data-ttu-id="08401-677">控制文件和文件夹的访问权限。</span><span class="sxs-lookup"><span data-stu-id="08401-677">Controls the ability to access files and folders.</span></span> <span data-ttu-id="08401-678">关联枚举： <see cref="F:System.Security.Permissions.PermissionState.Unrestricted" />。</span><span class="sxs-lookup"><span data-stu-id="08401-678">Associated enumeration: <see cref="F:System.Security.Permissions.PermissionState.Unrestricted" />.</span></span></permission>
        <altmember cref="T:System.Collections.ObjectModel.ReadOnlyCollection`1" />
        <altmember cref="T:System.IO.DriveInfo" />
        <related type="Article" href="~/docs/visual-basic/language-reference/objects/index.md"><span data-ttu-id="08401-679">对象 (Visual Basic)</span><span class="sxs-lookup"><span data-stu-id="08401-679">Objects (Visual Basic)</span></span></related>
      </Docs>
    </Member>
    <Member MemberName="FileExists">
      <MemberSignature Language="C#" Value="public bool FileExists (string file);" />
      <MemberSignature Language="ILAsm" Value=".method public instance bool FileExists(string file) cil managed" />
      <MemberSignature Language="DocId" Value="M:Microsoft.VisualBasic.MyServices.FileSystemProxy.FileExists(System.String)" />
      <MemberSignature Language="VB.NET" Value="Public Function FileExists (file As String) As Boolean" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; bool FileExists(System::String ^ file);" />
      <MemberSignature Language="F#" Value="member this.FileExists : string -&gt; bool" Usage="fileSystemProxy.FileExists file" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>Microsoft.VisualBasic</AssemblyName>
        <AssemblyVersion>8.0.0.0</AssemblyVersion>
        <AssemblyVersion>10.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <AssemblyInfo>
        <AssemblyName>Microsoft.VisualBasic.Core</AssemblyName>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Boolean</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="file" Type="System.String" Index="0" FrameworkAlternate="netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;netframework-4.8" />
      </Parameters>
      <Docs>
        <param name="file"><span data-ttu-id="08401-680">名称和文件的路径。</span><span class="sxs-lookup"><span data-stu-id="08401-680">Name and path of the file.</span></span></param>
        <summary><span data-ttu-id="08401-681">返回<see langword="True" />如果存在指定的文件。</span><span class="sxs-lookup"><span data-stu-id="08401-681">Returns <see langword="True" /> if the specified file exists.</span></span></summary>
        <returns><span data-ttu-id="08401-682">返回<see langword="True" />如果该文件存在; 否则此方法返回<see langword="False" />。</span><span class="sxs-lookup"><span data-stu-id="08401-682">Returns <see langword="True" /> if the file exists; otherwise this method returns <see langword="False" />.</span></span></returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="08401-683">如果应用程序不具有足够权限来读取指定的文件，`FileExists`方法将返回`False`，而不考虑是否存在的路径; 该方法不会引发异常。</span><span class="sxs-lookup"><span data-stu-id="08401-683">If the application does not have sufficient permissions to read the specified file, the `FileExists` method returns `False`, regardless of the existence of the path; the method does not throw an exception.</span></span>  
  
   
  
## Examples  
 <span data-ttu-id="08401-684">此示例检查以查看是否在文件`Check.txt`存在，并且提供了一个消息框中的信息。</span><span class="sxs-lookup"><span data-stu-id="08401-684">This example checks to see whether or not the file `Check.txt` exists and supplies the information in a message box.</span></span>  
  
 [!code-vb[VbRefFile#20](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbRefFile/VB/Class1.vb#20)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentException"><span data-ttu-id="08401-685">文件名称以反斜杠 (\\) 结尾。</span><span class="sxs-lookup"><span data-stu-id="08401-685">The name of the file ends with a backslash (\\).</span></span></exception>
        <permission cref="T:System.Security.Permissions.FileIOPermission"><span data-ttu-id="08401-686">控制文件和文件夹的访问权限。</span><span class="sxs-lookup"><span data-stu-id="08401-686">Controls the ability to access files and folders.</span></span> <span data-ttu-id="08401-687">关联枚举： <see cref="F:System.Security.Permissions.PermissionState.Unrestricted" />。</span><span class="sxs-lookup"><span data-stu-id="08401-687">Associated enumeration: <see cref="F:System.Security.Permissions.PermissionState.Unrestricted" />.</span></span></permission>
        <related type="Article" href="~/docs/visual-basic/language-reference/objects/index.md"><span data-ttu-id="08401-688">对象 (Visual Basic)</span><span class="sxs-lookup"><span data-stu-id="08401-688">Objects (Visual Basic)</span></span></related>
        <related type="Article" href="~/docs/visual-basic/developing-apps/programming/drives-directories-files/creating-deleting-and-moving-files-and-directories.md"><span data-ttu-id="08401-689">创建、删除和移动文件和目录 (Visual Basic)</span><span class="sxs-lookup"><span data-stu-id="08401-689">Creating, Deleting, and Moving Files and Directories in Visual Basic</span></span></related>
        <related type="Article" href="~/docs/visual-basic/developing-apps/programming/drives-directories-files/walkthrough-manipulating-files-and-directories.md"><span data-ttu-id="08401-690">演练：在 Visual Basic 中操作文件和目录</span><span class="sxs-lookup"><span data-stu-id="08401-690">Walkthrough: Manipulating Files and Directories in Visual Basic</span></span></related>
      </Docs>
    </Member>
    <MemberGroup MemberName="FindInFiles">
      <AssemblyInfo>
        <AssemblyName>Microsoft.VisualBasic</AssemblyName>
        <AssemblyVersion>10.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Docs>
        <summary><span data-ttu-id="08401-691">返回表示包含指定的文本的文件的名称的字符串的只读集合。</span><span class="sxs-lookup"><span data-stu-id="08401-691">Returns a read-only collection of strings representing the names of files containing the specified text.</span></span></summary>
      </Docs>
    </MemberGroup>
    <Member MemberName="FindInFiles">
      <MemberSignature Language="C#" Value="public System.Collections.ObjectModel.ReadOnlyCollection&lt;string&gt; FindInFiles (string directory, string containsText, bool ignoreCase, Microsoft.VisualBasic.FileIO.SearchOption searchType);" />
      <MemberSignature Language="ILAsm" Value=".method public instance class System.Collections.ObjectModel.ReadOnlyCollection`1&lt;string&gt; FindInFiles(string directory, string containsText, bool ignoreCase, valuetype Microsoft.VisualBasic.FileIO.SearchOption searchType) cil managed" />
      <MemberSignature Language="DocId" Value="M:Microsoft.VisualBasic.MyServices.FileSystemProxy.FindInFiles(System.String,System.String,System.Boolean,Microsoft.VisualBasic.FileIO.SearchOption)" />
      <MemberSignature Language="VB.NET" Value="Public Function FindInFiles (directory As String, containsText As String, ignoreCase As Boolean, searchType As SearchOption) As ReadOnlyCollection(Of String)" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; System::Collections::ObjectModel::ReadOnlyCollection&lt;System::String ^&gt; ^ FindInFiles(System::String ^ directory, System::String ^ containsText, bool ignoreCase, Microsoft::VisualBasic::FileIO::SearchOption searchType);" />
      <MemberSignature Language="F#" Value="member this.FindInFiles : string * string * bool * Microsoft.VisualBasic.FileIO.SearchOption -&gt; System.Collections.ObjectModel.ReadOnlyCollection&lt;string&gt;" Usage="fileSystemProxy.FindInFiles (directory, containsText, ignoreCase, searchType)" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>Microsoft.VisualBasic</AssemblyName>
        <AssemblyVersion>8.0.0.0</AssemblyVersion>
        <AssemblyVersion>10.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <AssemblyInfo>
        <AssemblyName>Microsoft.VisualBasic.Core</AssemblyName>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Collections.ObjectModel.ReadOnlyCollection&lt;System.String&gt;</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="directory" Type="System.String" Index="0" FrameworkAlternate="netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;netframework-4.8" />
        <Parameter Name="containsText" Type="System.String" Index="1" FrameworkAlternate="netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;netframework-4.8" />
        <Parameter Name="ignoreCase" Type="System.Boolean" Index="2" FrameworkAlternate="netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;netframework-4.8" />
        <Parameter Name="searchType" Type="Microsoft.VisualBasic.FileIO.SearchOption" Index="3" FrameworkAlternate="netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;netframework-4.8" />
      </Parameters>
      <Docs>
        <param name="directory"><span data-ttu-id="08401-692">要搜索的目录。</span><span class="sxs-lookup"><span data-stu-id="08401-692">The directory to be searched.</span></span></param>
        <param name="containsText"><span data-ttu-id="08401-693">搜索文本。</span><span class="sxs-lookup"><span data-stu-id="08401-693">The search text.</span></span></param>
        <param name="ignoreCase"><span data-ttu-id="08401-694"><see langword="True" /> 如果搜索应区分大小写。否则为<see langword="False" />。</span><span class="sxs-lookup"><span data-stu-id="08401-694"><see langword="True" /> if the search should be case-sensitive; otherwise <see langword="False" />.</span></span> <span data-ttu-id="08401-695">默认值为 <see langword="True" />。</span><span class="sxs-lookup"><span data-stu-id="08401-695">Default is <see langword="True" />.</span></span></param>
        <param name="searchType"><span data-ttu-id="08401-696">是否包括子文件夹。</span><span class="sxs-lookup"><span data-stu-id="08401-696">Whether to include subfolders.</span></span> <span data-ttu-id="08401-697">默认值为 <see langword="SearchOption.SearchTopLevelOnly" />。</span><span class="sxs-lookup"><span data-stu-id="08401-697">Default is <see langword="SearchOption.SearchTopLevelOnly" />.</span></span></param>
        <summary><span data-ttu-id="08401-698">返回表示包含指定的文本的文件的名称的字符串的只读集合。</span><span class="sxs-lookup"><span data-stu-id="08401-698">Returns a read-only collection of strings representing the names of files containing the specified text.</span></span></summary>
        <returns><span data-ttu-id="08401-699">包含指定文本的文件名的只读集合。</span><span class="sxs-lookup"><span data-stu-id="08401-699">Read-only collection of the names of files containing the specified text.</span></span></returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="08401-700">如果没有找到与指定模式匹配的文件，则返回一个空集合。</span><span class="sxs-lookup"><span data-stu-id="08401-700">An empty collection is returned if no files matching the specified pattern are found.</span></span>  
  
 <span data-ttu-id="08401-701">下表列出了所涉及的任务的示例`My.Computer.FileSystem.FindInFiles`方法。</span><span class="sxs-lookup"><span data-stu-id="08401-701">The following table lists examples of tasks involving the `My.Computer.FileSystem.FindInFiles` method.</span></span>  
  
|<span data-ttu-id="08401-702">功能</span><span class="sxs-lookup"><span data-stu-id="08401-702">To</span></span>|<span data-ttu-id="08401-703">查看</span><span class="sxs-lookup"><span data-stu-id="08401-703">See</span></span>|  
|--------|---------|  
|<span data-ttu-id="08401-704">搜索包含特定字符串的文件的目录</span><span class="sxs-lookup"><span data-stu-id="08401-704">Search a directory for files containing a specific string</span></span>|[<span data-ttu-id="08401-705">演练：在 Visual Basic 中操作文件和目录</span><span class="sxs-lookup"><span data-stu-id="08401-705">Walkthrough: Manipulating Files and Directories in Visual Basic</span></span>](~/docs/visual-basic/developing-apps/programming/drives-directories-files/walkthrough-manipulating-files-and-directories.md)|  
  
   
  
## Examples  
 <span data-ttu-id="08401-706">此示例中搜索的目录`C:\TestDir`包含字符串的所有文件`"sample string"`，并显示在结果`ListBox1`。</span><span class="sxs-lookup"><span data-stu-id="08401-706">This example searches the directory `C:\TestDir` for any files containing the string `"sample string"` and displays the results in `ListBox1`.</span></span>  
  
 [!code-vb[VbRefFile#12](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbRefFile/VB/Class1.vb#12)]  
  
 <span data-ttu-id="08401-707">才能正常工作，项目必须包含`ListBox`名为`ListBox1`。</span><span class="sxs-lookup"><span data-stu-id="08401-707">In order to work, the project must contain a `ListBox` named `ListBox1`.</span></span>  
  
 ]]></format>
        </remarks>
        <altCompliant cref="None." />
        <exception cref="T:System.ArgumentException"><span data-ttu-id="08401-708">路径由于以下原因之一而无效：是零长度字符串；仅包含空白；包含无效字符；是一个设备路径（开头字符为 <c>\\.\</c>）。</span><span class="sxs-lookup"><span data-stu-id="08401-708">The path is not valid for one of the following reasons: it is a zero-length string; it contains only white space; it contains invalid characters; or it is a device path (starts with <c>\\.\</c>).</span></span></exception>
        <exception cref="T:System.ArgumentNullException"><span data-ttu-id="08401-709"><paramref name="directory" /> 为 <see langword="Nothing" /> 或空字符串。</span><span class="sxs-lookup"><span data-stu-id="08401-709"><paramref name="directory" /> is <see langword="Nothing" /> or an empty string.</span></span></exception>
        <exception cref="T:System.IO.DirectoryNotFoundException"><span data-ttu-id="08401-710">指定的目录不存在。</span><span class="sxs-lookup"><span data-stu-id="08401-710">The specified directory does not exist.</span></span></exception>
        <exception cref="T:System.IO.IOException"><span data-ttu-id="08401-711">指定的目录指向现有文件。</span><span class="sxs-lookup"><span data-stu-id="08401-711">The specified directory points to an existing file.</span></span></exception>
        <exception cref="T:System.IO.PathTooLongException"><span data-ttu-id="08401-712">路径超过系统定义的最大长度。</span><span class="sxs-lookup"><span data-stu-id="08401-712">The path exceeds the system-defined maximum length.</span></span></exception>
        <exception cref="T:System.NotSupportedException"><span data-ttu-id="08401-713">指定的目录路径包含冒号 （:），或格式无效。</span><span class="sxs-lookup"><span data-stu-id="08401-713">The specified directory path contains a colon (:) or is in an invalid format.</span></span></exception>
        <exception cref="T:System.Security.SecurityException"><span data-ttu-id="08401-714">该用户缺少必要的权限查看该路径。</span><span class="sxs-lookup"><span data-stu-id="08401-714">The user lacks necessary permissions to view the path.</span></span></exception>
        <exception cref="T:System.UnauthorizedAccessException"><span data-ttu-id="08401-715">该用户缺少必要的权限。</span><span class="sxs-lookup"><span data-stu-id="08401-715">The user lacks necessary permissions.</span></span></exception>
        <permission cref="T:System.Security.Permissions.FileIOPermission"><span data-ttu-id="08401-716">控制文件和文件夹的访问权限。</span><span class="sxs-lookup"><span data-stu-id="08401-716">Controls the ability to access files and folders.</span></span> <span data-ttu-id="08401-717">关联枚举： <see cref="F:System.Security.Permissions.PermissionState.Unrestricted" />。</span><span class="sxs-lookup"><span data-stu-id="08401-717">Associated enumeration: <see cref="F:System.Security.Permissions.PermissionState.Unrestricted" />.</span></span></permission>
        <altmember cref="T:Microsoft.VisualBasic.FileIO.SearchOption" />
        <altmember cref="T:System.Collections.ObjectModel.ReadOnlyCollection`1" />
        <related type="Article" href="~/docs/visual-basic/language-reference/objects/index.md"><span data-ttu-id="08401-718">对象 (Visual Basic)</span><span class="sxs-lookup"><span data-stu-id="08401-718">Objects (Visual Basic)</span></span></related>
        <related type="Article" href="~/docs/visual-basic/developing-apps/programming/drives-directories-files/walkthrough-manipulating-files-and-directories.md"><span data-ttu-id="08401-719">演练：在 Visual Basic 中操作文件和目录</span><span class="sxs-lookup"><span data-stu-id="08401-719">Walkthrough: Manipulating Files and Directories in Visual Basic</span></span></related>
      </Docs>
    </Member>
    <Member MemberName="FindInFiles">
      <MemberSignature Language="C#" Value="public System.Collections.ObjectModel.ReadOnlyCollection&lt;string&gt; FindInFiles (string directory, string containsText, bool ignoreCase, Microsoft.VisualBasic.FileIO.SearchOption searchType, params string[] fileWildcards);" />
      <MemberSignature Language="ILAsm" Value=".method public instance class System.Collections.ObjectModel.ReadOnlyCollection`1&lt;string&gt; FindInFiles(string directory, string containsText, bool ignoreCase, valuetype Microsoft.VisualBasic.FileIO.SearchOption searchType, string[] fileWildcards) cil managed" />
      <MemberSignature Language="DocId" Value="M:Microsoft.VisualBasic.MyServices.FileSystemProxy.FindInFiles(System.String,System.String,System.Boolean,Microsoft.VisualBasic.FileIO.SearchOption,System.String[])" />
      <MemberSignature Language="VB.NET" Value="Public Function FindInFiles (directory As String, containsText As String, ignoreCase As Boolean, searchType As SearchOption, ParamArray fileWildcards As String()) As ReadOnlyCollection(Of String)" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; System::Collections::ObjectModel::ReadOnlyCollection&lt;System::String ^&gt; ^ FindInFiles(System::String ^ directory, System::String ^ containsText, bool ignoreCase, Microsoft::VisualBasic::FileIO::SearchOption searchType, ... cli::array &lt;System::String ^&gt; ^ fileWildcards);" />
      <MemberSignature Language="F#" Value="member this.FindInFiles : string * string * bool * Microsoft.VisualBasic.FileIO.SearchOption * string[] -&gt; System.Collections.ObjectModel.ReadOnlyCollection&lt;string&gt;" Usage="fileSystemProxy.FindInFiles (directory, containsText, ignoreCase, searchType, fileWildcards)" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>Microsoft.VisualBasic</AssemblyName>
        <AssemblyVersion>8.0.0.0</AssemblyVersion>
        <AssemblyVersion>10.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <AssemblyInfo>
        <AssemblyName>Microsoft.VisualBasic.Core</AssemblyName>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Collections.ObjectModel.ReadOnlyCollection&lt;System.String&gt;</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="directory" Type="System.String" Index="0" FrameworkAlternate="netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;netframework-4.8" />
        <Parameter Name="containsText" Type="System.String" Index="1" FrameworkAlternate="netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;netframework-4.8" />
        <Parameter Name="ignoreCase" Type="System.Boolean" Index="2" FrameworkAlternate="netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;netframework-4.8" />
        <Parameter Name="searchType" Type="Microsoft.VisualBasic.FileIO.SearchOption" Index="3" FrameworkAlternate="netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;netframework-4.8" />
        <Parameter Name="fileWildcards" Type="System.String[]" Index="4" FrameworkAlternate="netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;netframework-4.8">
          <Attributes>
            <Attribute FrameworkAlternate="netframework-2.0">
              <AttributeName>System.ParamArray</AttributeName>
            </Attribute>
          </Attributes>
        </Parameter>
      </Parameters>
      <Docs>
        <param name="directory"><span data-ttu-id="08401-720">要搜索的目录。</span><span class="sxs-lookup"><span data-stu-id="08401-720">The directory to be searched.</span></span></param>
        <param name="containsText"><span data-ttu-id="08401-721">搜索文本。</span><span class="sxs-lookup"><span data-stu-id="08401-721">The search text.</span></span></param>
        <param name="ignoreCase"><span data-ttu-id="08401-722"><see langword="True" /> 如果搜索应区分大小写。否则为<see langword="False" />。</span><span class="sxs-lookup"><span data-stu-id="08401-722"><see langword="True" /> if the search should be case-sensitive; otherwise <see langword="False" />.</span></span> <span data-ttu-id="08401-723">默认值为 <see langword="True" />。</span><span class="sxs-lookup"><span data-stu-id="08401-723">Default is <see langword="True" />.</span></span></param>
        <param name="searchType"><span data-ttu-id="08401-724">是否包括子文件夹。</span><span class="sxs-lookup"><span data-stu-id="08401-724">Whether to include subfolders.</span></span> <span data-ttu-id="08401-725">默认值为 <see langword="SearchOption.SearchTopLevelOnly" />。</span><span class="sxs-lookup"><span data-stu-id="08401-725">Default is <see langword="SearchOption.SearchTopLevelOnly" />.</span></span></param>
        <param name="fileWildcards"><span data-ttu-id="08401-726">要匹配的模式。</span><span class="sxs-lookup"><span data-stu-id="08401-726">Pattern to be matched.</span></span></param>
        <summary><span data-ttu-id="08401-727">返回表示包含指定的文本的文件的名称的字符串的只读集合。</span><span class="sxs-lookup"><span data-stu-id="08401-727">Returns a read-only collection of strings representing the names of files containing the specified text.</span></span></summary>
        <returns><span data-ttu-id="08401-728">包含指定文本的文件名的只读集合。</span><span class="sxs-lookup"><span data-stu-id="08401-728">Read-only collection of the names of files containing the specified text.</span></span></returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="08401-729">如果没有找到与指定模式匹配的文件，则返回一个空集合。</span><span class="sxs-lookup"><span data-stu-id="08401-729">An empty collection is returned if no files matching the specified pattern are found.</span></span>  
  
 <span data-ttu-id="08401-730">下表列出了所涉及的任务的示例`My.Computer.FileSystem.FindInFiles`方法。</span><span class="sxs-lookup"><span data-stu-id="08401-730">The following table lists examples of tasks involving the `My.Computer.FileSystem.FindInFiles` method.</span></span>  
  
|<span data-ttu-id="08401-731">功能</span><span class="sxs-lookup"><span data-stu-id="08401-731">To</span></span>|<span data-ttu-id="08401-732">查看</span><span class="sxs-lookup"><span data-stu-id="08401-732">See</span></span>|  
|--------|---------|  
|<span data-ttu-id="08401-733">搜索包含特定字符串的文件的目录</span><span class="sxs-lookup"><span data-stu-id="08401-733">Search a directory for files containing a specific string</span></span>|[<span data-ttu-id="08401-734">演练：在 Visual Basic 中操作文件和目录</span><span class="sxs-lookup"><span data-stu-id="08401-734">Walkthrough: Manipulating Files and Directories in Visual Basic</span></span>](~/docs/visual-basic/developing-apps/programming/drives-directories-files/walkthrough-manipulating-files-and-directories.md)|  
  
   
  
## Examples  
 <span data-ttu-id="08401-735">此示例中搜索的目录`C:\TestDir`包含字符串的所有文件`"sample string"`，并显示在结果`ListBox1`。</span><span class="sxs-lookup"><span data-stu-id="08401-735">This example searches the directory `C:\TestDir` for any files containing the string `"sample string"` and displays the results in `ListBox1`.</span></span>  
  
 [!code-vb[VbRefFile#12](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbRefFile/VB/Class1.vb#12)]  
  
 <span data-ttu-id="08401-736">才能正常工作，项目必须包含`ListBox`名为`ListBox1`。</span><span class="sxs-lookup"><span data-stu-id="08401-736">In order to work, the project must contain a `ListBox` named `ListBox1`.</span></span>  
  
 ]]></format>
        </remarks>
        <altCompliant cref="None." />
        <exception cref="T:System.ArgumentException"><span data-ttu-id="08401-737">路径由于以下原因之一而无效：是零长度字符串；仅包含空白；包含无效字符；是一个设备路径（开头字符为 <c>\\.\</c>）。</span><span class="sxs-lookup"><span data-stu-id="08401-737">The path is not valid for one of the following reasons: it is a zero-length string; it contains only white space; it contains invalid characters; or it is a device path (starts with <c>\\.\</c>).</span></span></exception>
        <exception cref="T:System.ArgumentNullException"><span data-ttu-id="08401-738"><paramref name="directory" /> 为 <see langword="Nothing" /> 或空字符串。</span><span class="sxs-lookup"><span data-stu-id="08401-738"><paramref name="directory" /> is <see langword="Nothing" /> or an empty string.</span></span></exception>
        <exception cref="T:System.IO.DirectoryNotFoundException"><span data-ttu-id="08401-739">指定的目录不存在。</span><span class="sxs-lookup"><span data-stu-id="08401-739">The specified directory does not exist.</span></span></exception>
        <exception cref="T:System.IO.IOException"><span data-ttu-id="08401-740">指定的目录指向现有文件。</span><span class="sxs-lookup"><span data-stu-id="08401-740">The specified directory points to an existing file.</span></span></exception>
        <exception cref="T:System.IO.PathTooLongException"><span data-ttu-id="08401-741">路径超过系统定义的最大长度。</span><span class="sxs-lookup"><span data-stu-id="08401-741">The path exceeds the system-defined maximum length.</span></span></exception>
        <exception cref="T:System.NotSupportedException"><span data-ttu-id="08401-742">指定的目录路径包含冒号 （:），或格式无效。</span><span class="sxs-lookup"><span data-stu-id="08401-742">The specified directory path contains a colon (:) or is in an invalid format.</span></span></exception>
        <exception cref="T:System.Security.SecurityException"><span data-ttu-id="08401-743">该用户缺少必要的权限查看该路径。</span><span class="sxs-lookup"><span data-stu-id="08401-743">The user lacks necessary permissions to view the path.</span></span></exception>
        <exception cref="T:System.UnauthorizedAccessException"><span data-ttu-id="08401-744">该用户缺少必要的权限。</span><span class="sxs-lookup"><span data-stu-id="08401-744">The user lacks necessary permissions.</span></span></exception>
        <permission cref="T:System.Security.Permissions.FileIOPermission"><span data-ttu-id="08401-745">控制文件和文件夹的访问权限。</span><span class="sxs-lookup"><span data-stu-id="08401-745">Controls the ability to access files and folders.</span></span> <span data-ttu-id="08401-746">关联枚举： <see cref="F:System.Security.Permissions.PermissionState.Unrestricted" />。</span><span class="sxs-lookup"><span data-stu-id="08401-746">Associated enumeration: <see cref="F:System.Security.Permissions.PermissionState.Unrestricted" />.</span></span></permission>
        <altmember cref="T:Microsoft.VisualBasic.FileIO.SearchOption" />
        <altmember cref="T:System.Collections.ObjectModel.ReadOnlyCollection`1" />
        <related type="Article" href="~/docs/visual-basic/language-reference/objects/index.md"><span data-ttu-id="08401-747">对象 (Visual Basic)</span><span class="sxs-lookup"><span data-stu-id="08401-747">Objects (Visual Basic)</span></span></related>
        <related type="Article" href="~/docs/visual-basic/developing-apps/programming/drives-directories-files/walkthrough-manipulating-files-and-directories.md"><span data-ttu-id="08401-748">演练：在 Visual Basic 中操作文件和目录</span><span class="sxs-lookup"><span data-stu-id="08401-748">Walkthrough: Manipulating Files and Directories in Visual Basic</span></span></related>
      </Docs>
    </Member>
    <MemberGroup MemberName="GetDirectories">
      <AssemblyInfo>
        <AssemblyName>Microsoft.VisualBasic</AssemblyName>
        <AssemblyVersion>10.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Docs>
        <summary><span data-ttu-id="08401-749">返回表示目录内子目录的路径名称的字符串的集合。</span><span class="sxs-lookup"><span data-stu-id="08401-749">Returns a collection of strings representing the path names of subdirectories within a directory.</span></span></summary>
      </Docs>
    </MemberGroup>
    <Member MemberName="GetDirectories">
      <MemberSignature Language="C#" Value="public System.Collections.ObjectModel.ReadOnlyCollection&lt;string&gt; GetDirectories (string directory);" />
      <MemberSignature Language="ILAsm" Value=".method public instance class System.Collections.ObjectModel.ReadOnlyCollection`1&lt;string&gt; GetDirectories(string directory) cil managed" />
      <MemberSignature Language="DocId" Value="M:Microsoft.VisualBasic.MyServices.FileSystemProxy.GetDirectories(System.String)" />
      <MemberSignature Language="VB.NET" Value="Public Function GetDirectories (directory As String) As ReadOnlyCollection(Of String)" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; System::Collections::ObjectModel::ReadOnlyCollection&lt;System::String ^&gt; ^ GetDirectories(System::String ^ directory);" />
      <MemberSignature Language="F#" Value="member this.GetDirectories : string -&gt; System.Collections.ObjectModel.ReadOnlyCollection&lt;string&gt;" Usage="fileSystemProxy.GetDirectories directory" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>Microsoft.VisualBasic</AssemblyName>
        <AssemblyVersion>8.0.0.0</AssemblyVersion>
        <AssemblyVersion>10.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <AssemblyInfo>
        <AssemblyName>Microsoft.VisualBasic.Core</AssemblyName>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Collections.ObjectModel.ReadOnlyCollection&lt;System.String&gt;</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="directory" Type="System.String" Index="0" FrameworkAlternate="netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;netframework-4.8" />
      </Parameters>
      <Docs>
        <param name="directory"><span data-ttu-id="08401-750">名称和目录的路径。</span><span class="sxs-lookup"><span data-stu-id="08401-750">Name and path of directory.</span></span></param>
        <summary><span data-ttu-id="08401-751">返回表示目录内子目录的路径名称的字符串的集合。</span><span class="sxs-lookup"><span data-stu-id="08401-751">Returns a collection of strings representing the path names of subdirectories within a directory.</span></span></summary>
        <returns><span data-ttu-id="08401-752">指定的目录中，子目录路径名称的只读集合。</span><span class="sxs-lookup"><span data-stu-id="08401-752">Read-only collection of the path names of subdirectories within the specified directory.</span></span></returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="08401-753">下表列出了所涉及的任务的示例`My.Computer.FileSystem.GetDirectories`方法。</span><span class="sxs-lookup"><span data-stu-id="08401-753">The following table lists examples of tasks involving the `My.Computer.FileSystem.GetDirectories` method.</span></span>  
  
|<span data-ttu-id="08401-754">功能</span><span class="sxs-lookup"><span data-stu-id="08401-754">To</span></span>|<span data-ttu-id="08401-755">查看</span><span class="sxs-lookup"><span data-stu-id="08401-755">See</span></span>|  
|--------|---------|  
|<span data-ttu-id="08401-756">列表具有特定模式的子目录</span><span class="sxs-lookup"><span data-stu-id="08401-756">List subdirectories with a specific pattern</span></span>|[<span data-ttu-id="08401-757">如何：查找具有特定模式的子目录</span><span class="sxs-lookup"><span data-stu-id="08401-757">How to: Find Subdirectories with a Specific Pattern</span></span>](~/docs/visual-basic/developing-apps/programming/drives-directories-files/how-to-find-subdirectories-with-a-specific-pattern.md)|  
  
   
  
## Examples  
 <span data-ttu-id="08401-758">下面的示例返回所有目录中包含的单词的目录结构`Logs`名称中将它们添加到`ListBox1`。</span><span class="sxs-lookup"><span data-stu-id="08401-758">The following example returns all the directories in the directory structure that contain the word `Logs` in their names and adds them to `ListBox1`.</span></span>  
  
 [!code-vb[VbRefFile#10](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbRefFile/VB/Class1.vb#10)]  
  
 <span data-ttu-id="08401-759">此示例要求具有`ListBox`名为`ListBox1`窗体上。</span><span class="sxs-lookup"><span data-stu-id="08401-759">This example requires that you have a `ListBox` named `ListBox1` on your form.</span></span>  
  
 ]]></format>
        </remarks>
        <altCompliant cref="None." />
        <exception cref="T:System.ArgumentException"><span data-ttu-id="08401-760">路径由于以下原因之一无效：是零长度字符串；仅为空白；包含无效字符；是一个设备路径（以 \\\\.\\ 开头）。</span><span class="sxs-lookup"><span data-stu-id="08401-760">The path is not valid for one of the following reasons: it is a zero-length string; it contains only white space; it contains invalid characters; or it is a device path (starts with \\\\.\\).</span></span></exception>
        <exception cref="T:System.ArgumentNullException"><span data-ttu-id="08401-761"><paramref name="directory" /> 为 <see langword="Nothing" /> 或空字符串。</span><span class="sxs-lookup"><span data-stu-id="08401-761"><paramref name="directory" /> is <see langword="Nothing" /> or an empty string.</span></span></exception>
        <exception cref="T:System.IO.DirectoryNotFoundException"><span data-ttu-id="08401-762">指定的目录不存在。</span><span class="sxs-lookup"><span data-stu-id="08401-762">The specified directory does not exist.</span></span></exception>
        <exception cref="T:System.IO.IOException"><span data-ttu-id="08401-763">指定的目录指向现有文件。</span><span class="sxs-lookup"><span data-stu-id="08401-763">The specified directory points to an existing file.</span></span></exception>
        <exception cref="T:System.IO.PathTooLongException"><span data-ttu-id="08401-764">路径超过系统定义的最大长度。</span><span class="sxs-lookup"><span data-stu-id="08401-764">The path exceeds the system-defined maximum length.</span></span></exception>
        <exception cref="T:System.NotSupportedException"><span data-ttu-id="08401-765">在路径中的文件或目录名称包含冒号 （:），或格式无效。</span><span class="sxs-lookup"><span data-stu-id="08401-765">A file or directory name in the path contains a colon (:) or is in an invalid format.</span></span></exception>
        <exception cref="T:System.Security.SecurityException"><span data-ttu-id="08401-766">该用户缺少必要的权限查看该路径。</span><span class="sxs-lookup"><span data-stu-id="08401-766">The user lacks necessary permissions to view the path.</span></span></exception>
        <exception cref="T:System.UnauthorizedAccessException"><span data-ttu-id="08401-767">该用户缺少必要的权限。</span><span class="sxs-lookup"><span data-stu-id="08401-767">The user lacks necessary permissions.</span></span></exception>
        <permission cref="T:System.Security.Permissions.FileIOPermission"><span data-ttu-id="08401-768">控制文件和文件夹的访问权限。</span><span class="sxs-lookup"><span data-stu-id="08401-768">Controls the ability to access files and folders.</span></span> <span data-ttu-id="08401-769">关联枚举： <see cref="F:System.Security.Permissions.PermissionState.Unrestricted" />。</span><span class="sxs-lookup"><span data-stu-id="08401-769">Associated enumeration: <see cref="F:System.Security.Permissions.PermissionState.Unrestricted" />.</span></span></permission>
        <altmember cref="T:Microsoft.VisualBasic.FileIO.SearchOption" />
        <altmember cref="T:System.Collections.ObjectModel.ReadOnlyCollection`1" />
        <related type="Article" href="~/docs/visual-basic/language-reference/objects/index.md"><span data-ttu-id="08401-770">对象 (Visual Basic)</span><span class="sxs-lookup"><span data-stu-id="08401-770">Objects (Visual Basic)</span></span></related>
      </Docs>
    </Member>
    <Member MemberName="GetDirectories">
      <MemberSignature Language="C#" Value="public System.Collections.ObjectModel.ReadOnlyCollection&lt;string&gt; GetDirectories (string directory, Microsoft.VisualBasic.FileIO.SearchOption searchType, params string[] wildcards);" />
      <MemberSignature Language="ILAsm" Value=".method public instance class System.Collections.ObjectModel.ReadOnlyCollection`1&lt;string&gt; GetDirectories(string directory, valuetype Microsoft.VisualBasic.FileIO.SearchOption searchType, string[] wildcards) cil managed" />
      <MemberSignature Language="DocId" Value="M:Microsoft.VisualBasic.MyServices.FileSystemProxy.GetDirectories(System.String,Microsoft.VisualBasic.FileIO.SearchOption,System.String[])" />
      <MemberSignature Language="VB.NET" Value="Public Function GetDirectories (directory As String, searchType As SearchOption, ParamArray wildcards As String()) As ReadOnlyCollection(Of String)" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; System::Collections::ObjectModel::ReadOnlyCollection&lt;System::String ^&gt; ^ GetDirectories(System::String ^ directory, Microsoft::VisualBasic::FileIO::SearchOption searchType, ... cli::array &lt;System::String ^&gt; ^ wildcards);" />
      <MemberSignature Language="F#" Value="member this.GetDirectories : string * Microsoft.VisualBasic.FileIO.SearchOption * string[] -&gt; System.Collections.ObjectModel.ReadOnlyCollection&lt;string&gt;" Usage="fileSystemProxy.GetDirectories (directory, searchType, wildcards)" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>Microsoft.VisualBasic</AssemblyName>
        <AssemblyVersion>8.0.0.0</AssemblyVersion>
        <AssemblyVersion>10.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <AssemblyInfo>
        <AssemblyName>Microsoft.VisualBasic.Core</AssemblyName>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Collections.ObjectModel.ReadOnlyCollection&lt;System.String&gt;</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="directory" Type="System.String" Index="0" FrameworkAlternate="netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;netframework-4.8" />
        <Parameter Name="searchType" Type="Microsoft.VisualBasic.FileIO.SearchOption" Index="1" FrameworkAlternate="netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;netframework-4.8" />
        <Parameter Name="wildcards" Type="System.String[]" Index="2" FrameworkAlternate="netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;netframework-4.8">
          <Attributes>
            <Attribute FrameworkAlternate="netframework-2.0">
              <AttributeName>System.ParamArray</AttributeName>
            </Attribute>
          </Attributes>
        </Parameter>
      </Parameters>
      <Docs>
        <param name="directory"><span data-ttu-id="08401-771">名称和目录的路径。</span><span class="sxs-lookup"><span data-stu-id="08401-771">Name and path of directory.</span></span></param>
        <param name="searchType"><span data-ttu-id="08401-772">是否包括子文件夹。</span><span class="sxs-lookup"><span data-stu-id="08401-772">Whether to include subfolders.</span></span> <span data-ttu-id="08401-773">默认值为 <see langword="SearchOption.SearchTopLevelOnly" />。</span><span class="sxs-lookup"><span data-stu-id="08401-773">Default is <see langword="SearchOption.SearchTopLevelOnly" />.</span></span></param>
        <param name="wildcards"><span data-ttu-id="08401-774">若要与名称匹配的模式。</span><span class="sxs-lookup"><span data-stu-id="08401-774">Pattern to match names.</span></span></param>
        <summary><span data-ttu-id="08401-775">返回表示目录内子目录的路径名称的字符串的集合。</span><span class="sxs-lookup"><span data-stu-id="08401-775">Returns a collection of strings representing the path names of subdirectories within a directory.</span></span></summary>
        <returns><span data-ttu-id="08401-776">指定的目录中，子目录路径名称的只读集合。</span><span class="sxs-lookup"><span data-stu-id="08401-776">Read-only collection of the path names of subdirectories within the specified directory.</span></span></returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="08401-777">可以使用 `wildcards` 参数来指定特定模式。</span><span class="sxs-lookup"><span data-stu-id="08401-777">You can use the `wildcards` parameter to specify a specific pattern.</span></span> <span data-ttu-id="08401-778">如果要在搜索中包含子目录的内容，请将 `searchType` 参数设置为 `SearchAllSubDirectories`。</span><span class="sxs-lookup"><span data-stu-id="08401-778">If you would like to include the contents of subdirectories in the search, set the `searchType` parameter to `SearchAllSubDirectories`.</span></span>  
  
 <span data-ttu-id="08401-779">如果没有找到与指定模式匹配的目录，则返回一个空集合。</span><span class="sxs-lookup"><span data-stu-id="08401-779">An empty collection is returned if no directories matching the specified pattern are found.</span></span>  
  
 <span data-ttu-id="08401-780">下表列出了所涉及的任务的示例`My.Computer.FileSystem.GetDirectories`方法。</span><span class="sxs-lookup"><span data-stu-id="08401-780">The following table lists examples of tasks involving the `My.Computer.FileSystem.GetDirectories` method.</span></span>  
  
|<span data-ttu-id="08401-781">功能</span><span class="sxs-lookup"><span data-stu-id="08401-781">To</span></span>|<span data-ttu-id="08401-782">查看</span><span class="sxs-lookup"><span data-stu-id="08401-782">See</span></span>|  
|--------|---------|  
|<span data-ttu-id="08401-783">列表具有特定模式的子目录</span><span class="sxs-lookup"><span data-stu-id="08401-783">List subdirectories with a specific pattern</span></span>|[<span data-ttu-id="08401-784">如何：查找具有特定模式的子目录</span><span class="sxs-lookup"><span data-stu-id="08401-784">How to: Find Subdirectories with a Specific Pattern</span></span>](~/docs/visual-basic/developing-apps/programming/drives-directories-files/how-to-find-subdirectories-with-a-specific-pattern.md)|  
  
   
  
## Examples  
 <span data-ttu-id="08401-785">下面的示例返回所有目录中包含的单词的目录结构`Logs`名称中将它们添加到`ListBox1`。</span><span class="sxs-lookup"><span data-stu-id="08401-785">The following example returns all the directories in the directory structure that contain the word `Logs` in their names and adds them to `ListBox1`.</span></span>  
  
 [!code-vb[VbRefFile#10](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbRefFile/VB/Class1.vb#10)]  
  
 <span data-ttu-id="08401-786">此示例要求具有`ListBox`名为`ListBox1`窗体上。</span><span class="sxs-lookup"><span data-stu-id="08401-786">This example requires that you have a `ListBox` named `ListBox1` on your form.</span></span>  
  
 ]]></format>
        </remarks>
        <altCompliant cref="None." />
        <exception cref="T:System.ArgumentException"><span data-ttu-id="08401-787">路径由于以下原因之一无效：是零长度字符串；仅为空白；包含无效字符；是一个设备路径（以 \\\\.\\ 开头）。</span><span class="sxs-lookup"><span data-stu-id="08401-787">The path is not valid for one of the following reasons: it is a zero-length string; it contains only white space; it contains invalid characters; or it is a device path (starts with \\\\.\\).</span></span></exception>
        <exception cref="T:System.ArgumentNullException"><span data-ttu-id="08401-788">一个或多个指定的通配符是<see langword="Nothing" />，空字符串，或只包含空格。</span><span class="sxs-lookup"><span data-stu-id="08401-788">One or more of the specified wildcard characters is <see langword="Nothing" />, an empty string, or contains only spaces.</span></span></exception>
        <exception cref="T:System.IO.DirectoryNotFoundException"><span data-ttu-id="08401-789">指定的目录不存在。</span><span class="sxs-lookup"><span data-stu-id="08401-789">The specified directory does not exist.</span></span></exception>
        <exception cref="T:System.IO.IOException"><span data-ttu-id="08401-790">指定的目录指向现有文件。</span><span class="sxs-lookup"><span data-stu-id="08401-790">The specified directory points to an existing file.</span></span></exception>
        <exception cref="T:System.IO.PathTooLongException"><span data-ttu-id="08401-791">路径超过系统定义的最大长度。</span><span class="sxs-lookup"><span data-stu-id="08401-791">The path exceeds the system-defined maximum length.</span></span></exception>
        <exception cref="T:System.NotSupportedException"><span data-ttu-id="08401-792">在路径中的文件或目录名称包含冒号 （:），或格式无效。</span><span class="sxs-lookup"><span data-stu-id="08401-792">A file or directory name in the path contains a colon (:) or is in an invalid format.</span></span></exception>
        <exception cref="T:System.Security.SecurityException"><span data-ttu-id="08401-793">该用户缺少必要的权限查看该路径。</span><span class="sxs-lookup"><span data-stu-id="08401-793">The user lacks necessary permissions to view the path.</span></span></exception>
        <exception cref="T:System.UnauthorizedAccessException"><span data-ttu-id="08401-794">该用户缺少必要的权限。</span><span class="sxs-lookup"><span data-stu-id="08401-794">The user lacks necessary permissions.</span></span></exception>
        <permission cref="T:System.Security.Permissions.FileIOPermission"><span data-ttu-id="08401-795">控制文件和文件夹的访问权限。</span><span class="sxs-lookup"><span data-stu-id="08401-795">Controls the ability to access files and folders.</span></span> <span data-ttu-id="08401-796">关联枚举： <see cref="F:System.Security.Permissions.PermissionState.Unrestricted" />。</span><span class="sxs-lookup"><span data-stu-id="08401-796">Associated enumeration: <see cref="F:System.Security.Permissions.PermissionState.Unrestricted" />.</span></span></permission>
        <altmember cref="T:Microsoft.VisualBasic.FileIO.SearchOption" />
        <altmember cref="T:System.Collections.ObjectModel.ReadOnlyCollection`1" />
        <related type="Article" href="~/docs/visual-basic/language-reference/objects/index.md"><span data-ttu-id="08401-797">对象 (Visual Basic)</span><span class="sxs-lookup"><span data-stu-id="08401-797">Objects (Visual Basic)</span></span></related>
      </Docs>
    </Member>
    <Member MemberName="GetDirectoryInfo">
      <MemberSignature Language="C#" Value="public System.IO.DirectoryInfo GetDirectoryInfo (string directory);" />
      <MemberSignature Language="ILAsm" Value=".method public instance class System.IO.DirectoryInfo GetDirectoryInfo(string directory) cil managed" />
      <MemberSignature Language="DocId" Value="M:Microsoft.VisualBasic.MyServices.FileSystemProxy.GetDirectoryInfo(System.String)" />
      <MemberSignature Language="VB.NET" Value="Public Function GetDirectoryInfo (directory As String) As DirectoryInfo" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; System::IO::DirectoryInfo ^ GetDirectoryInfo(System::String ^ directory);" />
      <MemberSignature Language="F#" Value="member this.GetDirectoryInfo : string -&gt; System.IO.DirectoryInfo" Usage="fileSystemProxy.GetDirectoryInfo directory" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>Microsoft.VisualBasic</AssemblyName>
        <AssemblyVersion>8.0.0.0</AssemblyVersion>
        <AssemblyVersion>10.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <AssemblyInfo>
        <AssemblyName>Microsoft.VisualBasic.Core</AssemblyName>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.IO.DirectoryInfo</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="directory" Type="System.String" Index="0" FrameworkAlternate="netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;netframework-4.8" />
      </Parameters>
      <Docs>
        <param name="directory"><span data-ttu-id="08401-798"><see langword="String" />。</span><span class="sxs-lookup"><span data-stu-id="08401-798"><see langword="String" />.</span></span> <span data-ttu-id="08401-799">目录的路径。</span><span class="sxs-lookup"><span data-stu-id="08401-799">Path of directory.</span></span></param>
        <summary><span data-ttu-id="08401-800">返回<see cref="T:System.IO.DirectoryInfo" />对象为指定的路径。</span><span class="sxs-lookup"><span data-stu-id="08401-800">Returns a <see cref="T:System.IO.DirectoryInfo" /> object for the specified path.</span></span></summary>
        <returns><span data-ttu-id="08401-801"><see cref="T:System.IO.DirectoryInfo" /> 指定的路径的的对象。</span><span class="sxs-lookup"><span data-stu-id="08401-801"><see cref="T:System.IO.DirectoryInfo" /> object for the specified path.</span></span></returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="08401-802">如果目录不存在，不引发异常之前第一次属性<xref:System.IO.DirectoryInfo>访问对象。</span><span class="sxs-lookup"><span data-stu-id="08401-802">If the directory does not exist, an exception is not thrown until the first time a property on the <xref:System.IO.DirectoryInfo> object is accessed.</span></span>  
  
   
  
## Examples  
 <span data-ttu-id="08401-803">此示例将获取<xref:System.IO.DirectoryInfo>的目录对象`C:\Documents and Settings`并显示目录的创建时间、 上次访问时间和上次写入时间。</span><span class="sxs-lookup"><span data-stu-id="08401-803">This example gets a <xref:System.IO.DirectoryInfo> object for the directory `C:\Documents and Settings` and displays the directory's creation time, last access time, and last write time.</span></span>  
  
 [!code-vb[VbRefFile#7](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbRefFile/VB/Class1.vb#7)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentException"><span data-ttu-id="08401-804">路径由于以下原因之一无效：是零长度字符串；仅为空白；包含无效字符；是一个设备路径（以 \\\\.\\ 开头）。</span><span class="sxs-lookup"><span data-stu-id="08401-804">The path is not valid for one of the following reasons: it is a zero-length string; it contains only white space; it contains invalid characters; or it is a device path (starts with \\\\.\\).</span></span></exception>
        <exception cref="T:System.ArgumentNullException"><span data-ttu-id="08401-805"><paramref name="directory" /> 为 <see langword="Nothing" /> 或空字符串。</span><span class="sxs-lookup"><span data-stu-id="08401-805"><paramref name="directory" /> is <see langword="Nothing" /> or an empty string.</span></span></exception>
        <exception cref="T:System.IO.PathTooLongException"><span data-ttu-id="08401-806">路径超过系统定义的最大长度。</span><span class="sxs-lookup"><span data-stu-id="08401-806">The path exceeds the system-defined maximum length.</span></span></exception>
        <exception cref="T:System.NotSupportedException"><span data-ttu-id="08401-807">目录路径包含冒号 （:），或格式无效。</span><span class="sxs-lookup"><span data-stu-id="08401-807">The directory path contains a colon (:) or is in an invalid format.</span></span></exception>
        <exception cref="T:System.Security.SecurityException"><span data-ttu-id="08401-808">用户缺少必要的权限查看该路径</span><span class="sxs-lookup"><span data-stu-id="08401-808">The user lacks necessary permissions to view the path</span></span></exception>
        <permission cref="T:System.Security.Permissions.FileIOPermission"><span data-ttu-id="08401-809">控制文件和文件夹的访问权限。</span><span class="sxs-lookup"><span data-stu-id="08401-809">Controls the ability to access files and folders.</span></span> <span data-ttu-id="08401-810">关联枚举： <see cref="F:System.Security.Permissions.PermissionState.Unrestricted" />。</span><span class="sxs-lookup"><span data-stu-id="08401-810">Associated enumeration: <see cref="F:System.Security.Permissions.PermissionState.Unrestricted" />.</span></span></permission>
        <altmember cref="T:System.IO.DirectoryInfo" />
        <related type="Article" href="~/docs/visual-basic/language-reference/objects/index.md"><span data-ttu-id="08401-811">对象 (Visual Basic)</span><span class="sxs-lookup"><span data-stu-id="08401-811">Objects (Visual Basic)</span></span></related>
      </Docs>
    </Member>
    <Member MemberName="GetDriveInfo">
      <MemberSignature Language="C#" Value="public System.IO.DriveInfo GetDriveInfo (string drive);" />
      <MemberSignature Language="ILAsm" Value=".method public instance class System.IO.DriveInfo GetDriveInfo(string drive) cil managed" />
      <MemberSignature Language="DocId" Value="M:Microsoft.VisualBasic.MyServices.FileSystemProxy.GetDriveInfo(System.String)" />
      <MemberSignature Language="VB.NET" Value="Public Function GetDriveInfo (drive As String) As DriveInfo" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; System::IO::DriveInfo ^ GetDriveInfo(System::String ^ drive);" />
      <MemberSignature Language="F#" Value="member this.GetDriveInfo : string -&gt; System.IO.DriveInfo" Usage="fileSystemProxy.GetDriveInfo drive" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>Microsoft.VisualBasic</AssemblyName>
        <AssemblyVersion>8.0.0.0</AssemblyVersion>
        <AssemblyVersion>10.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <AssemblyInfo>
        <AssemblyName>Microsoft.VisualBasic.Core</AssemblyName>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.IO.DriveInfo</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="drive" Type="System.String" Index="0" FrameworkAlternate="netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;netframework-4.8" />
      </Parameters>
      <Docs>
        <param name="drive"><span data-ttu-id="08401-812">要检查的驱动器。</span><span class="sxs-lookup"><span data-stu-id="08401-812">Drive to be examined.</span></span></param>
        <summary><span data-ttu-id="08401-813">返回<see cref="T:System.IO.DriveInfo" />指定驱动器的对象。</span><span class="sxs-lookup"><span data-stu-id="08401-813">Returns a <see cref="T:System.IO.DriveInfo" /> object for the specified drive.</span></span></summary>
        <returns><span data-ttu-id="08401-814"><see cref="T:System.IO.DriveInfo" /> 指定驱动器的对象。</span><span class="sxs-lookup"><span data-stu-id="08401-814"><see cref="T:System.IO.DriveInfo" /> object for the specified drive.</span></span></returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="08401-815"><xref:System.IO.DriveInfo>类驱动器进行建模，并提供方法和属性来查询有关驱动器的信息。</span><span class="sxs-lookup"><span data-stu-id="08401-815">The <xref:System.IO.DriveInfo> class models a drive and provides methods and properties to query for drive information.</span></span> <span data-ttu-id="08401-816">使用<xref:System.IO.DriveInfo>来确定哪些驱动器可用，以及它们是哪种类型的驱动器。</span><span class="sxs-lookup"><span data-stu-id="08401-816">Use <xref:System.IO.DriveInfo> to determine what drives are available, and what type of drives they are.</span></span> <span data-ttu-id="08401-817">此外可以查询属性来确定容量和可用空间的驱动器上。</span><span class="sxs-lookup"><span data-stu-id="08401-817">You can also query the property to determine the capacity and available free space on the drive.</span></span>  
  
   
  
## Examples  
 <span data-ttu-id="08401-818">此示例获取<xref:System.IO.DriveInfo>C 驱动器的对象并使用它来显示与驱动器有关的信息。</span><span class="sxs-lookup"><span data-stu-id="08401-818">This example obtains a <xref:System.IO.DriveInfo> object for the C drive and uses it to display information about the drive.</span></span>  
  
 [!code-vb[VbRefFile#11](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbRefFile/VB/Class1.vb#11)]  
  
 <span data-ttu-id="08401-819">不同的驱动器类型的信息，请参阅<xref:System.IO.DriveType>。</span><span class="sxs-lookup"><span data-stu-id="08401-819">For information on the different drive types, see <xref:System.IO.DriveType>.</span></span>  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentException"><span data-ttu-id="08401-820">路径由于以下原因之一无效：是零长度字符串；仅为空白；包含无效字符；是一个设备路径（以 \\\\.\\ 开头）。</span><span class="sxs-lookup"><span data-stu-id="08401-820">The path is not valid for one of the following reasons: it is a zero-length string; it contains only white space; it contains invalid characters; or it is a device path (starts with \\\\.\\).</span></span></exception>
        <exception cref="T:System.ArgumentNullException"><span data-ttu-id="08401-821"><paramref name="drive" /> 为 <see langword="Nothing" /> 或空字符串。</span><span class="sxs-lookup"><span data-stu-id="08401-821"><paramref name="drive" /> is <see langword="Nothing" /> or an empty string.</span></span></exception>
        <exception cref="T:System.IO.PathTooLongException"><span data-ttu-id="08401-822">路径超过系统定义的最大长度。</span><span class="sxs-lookup"><span data-stu-id="08401-822">The path exceeds the system-defined maximum length.</span></span></exception>
        <exception cref="T:System.Security.SecurityException"><span data-ttu-id="08401-823">用户缺少必要的权限查看该路径</span><span class="sxs-lookup"><span data-stu-id="08401-823">The user lacks necessary permissions to view the path</span></span></exception>
        <permission cref="T:System.Security.Permissions.FileIOPermission"><span data-ttu-id="08401-824">控制文件和文件夹的访问权限。</span><span class="sxs-lookup"><span data-stu-id="08401-824">Controls the ability to access files and folders.</span></span> <span data-ttu-id="08401-825">关联枚举： <see cref="F:System.Security.Permissions.PermissionState.Unrestricted" />。</span><span class="sxs-lookup"><span data-stu-id="08401-825">Associated enumeration: <see cref="F:System.Security.Permissions.PermissionState.Unrestricted" />.</span></span></permission>
        <altmember cref="T:System.IO.DriveInfo" />
        <altmember cref="T:System.IO.DriveType" />
        <related type="Article" href="~/docs/visual-basic/language-reference/objects/index.md"><span data-ttu-id="08401-826">对象 (Visual Basic)</span><span class="sxs-lookup"><span data-stu-id="08401-826">Objects (Visual Basic)</span></span></related>
      </Docs>
    </Member>
    <Member MemberName="GetFileInfo">
      <MemberSignature Language="C#" Value="public System.IO.FileInfo GetFileInfo (string file);" />
      <MemberSignature Language="ILAsm" Value=".method public instance class System.IO.FileInfo GetFileInfo(string file) cil managed" />
      <MemberSignature Language="DocId" Value="M:Microsoft.VisualBasic.MyServices.FileSystemProxy.GetFileInfo(System.String)" />
      <MemberSignature Language="VB.NET" Value="Public Function GetFileInfo (file As String) As FileInfo" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; System::IO::FileInfo ^ GetFileInfo(System::String ^ file);" />
      <MemberSignature Language="F#" Value="member this.GetFileInfo : string -&gt; System.IO.FileInfo" Usage="fileSystemProxy.GetFileInfo file" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>Microsoft.VisualBasic</AssemblyName>
        <AssemblyVersion>8.0.0.0</AssemblyVersion>
        <AssemblyVersion>10.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <AssemblyInfo>
        <AssemblyName>Microsoft.VisualBasic.Core</AssemblyName>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.IO.FileInfo</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="file" Type="System.String" Index="0" FrameworkAlternate="netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;netframework-4.8" />
      </Parameters>
      <Docs>
        <param name="file"><span data-ttu-id="08401-827">名称和文件的路径。</span><span class="sxs-lookup"><span data-stu-id="08401-827">Name and path of the file.</span></span></param>
        <summary><span data-ttu-id="08401-828">返回<see cref="T:System.IO.FileInfo" />对象为指定的文件。</span><span class="sxs-lookup"><span data-stu-id="08401-828">Returns a <see cref="T:System.IO.FileInfo" /> object for the specified file.</span></span></summary>
        <returns><span data-ttu-id="08401-829"><see cref="T:System.IO.FileInfo" /> 指定的文件的的对象</span><span class="sxs-lookup"><span data-stu-id="08401-829"><see cref="T:System.IO.FileInfo" /> object for the specified file</span></span></returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="08401-830">如果该文件不存在; 不引发异常相反，它将引发第一次访问对象的属性。</span><span class="sxs-lookup"><span data-stu-id="08401-830">An exception is not thrown if the file does not exist; rather, it will be thrown the first time the object's properties are accessed.</span></span>  
  
 <span data-ttu-id="08401-831">下表列出的任务涉及示例`My.Computer.FileSystem.GetFileInfo`方法。</span><span class="sxs-lookup"><span data-stu-id="08401-831">The following table lists an example of a task involving the `My.Computer.FileSystem.GetFileInfo` method.</span></span>  
  
|<span data-ttu-id="08401-832">功能</span><span class="sxs-lookup"><span data-stu-id="08401-832">To</span></span>|<span data-ttu-id="08401-833">查看</span><span class="sxs-lookup"><span data-stu-id="08401-833">See</span></span>|  
|--------|---------|  
|<span data-ttu-id="08401-834">确定文件的名称和路径</span><span class="sxs-lookup"><span data-stu-id="08401-834">Determine a file's name and path</span></span>|[<span data-ttu-id="08401-835">如何：分析文件路径</span><span class="sxs-lookup"><span data-stu-id="08401-835">How to: Parse File Paths</span></span>](~/docs/visual-basic/developing-apps/programming/drives-directories-files/how-to-parse-file-paths.md)|  
  
   
  
## Examples  
 <span data-ttu-id="08401-836">此示例检索<xref:System.IO.FileInfo?displayProperty=nameWithType>文件的对象`MyLogFile.log`并使用它来报告文件的完整名称、 上次访问时间和长度。</span><span class="sxs-lookup"><span data-stu-id="08401-836">This example retrieves a <xref:System.IO.FileInfo?displayProperty=nameWithType> object for the file `MyLogFile.log` and uses it to report the file's full name, last access time, and length.</span></span>  
  
 [!code-vb[VbRefFile#1](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbRefFile/VB/Class1.vb#1)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentException"><span data-ttu-id="08401-837">路径名称格式不正确。</span><span class="sxs-lookup"><span data-stu-id="08401-837">The path name is malformed.</span></span> <span data-ttu-id="08401-838">例如，它包含无效字符或仅为空白。</span><span class="sxs-lookup"><span data-stu-id="08401-838">For example, it contains invalid characters or is only white space.</span></span> <span data-ttu-id="08401-839">文件名具有尾随斜杠标记。</span><span class="sxs-lookup"><span data-stu-id="08401-839">The file name has a trailing slash mark.</span></span></exception>
        <exception cref="T:System.ArgumentNullException"><span data-ttu-id="08401-840"><paramref name="file" /> 为 <see langword="Nothing" /> 或空字符串。</span><span class="sxs-lookup"><span data-stu-id="08401-840"><paramref name="file" /> is <see langword="Nothing" /> or an empty string.</span></span></exception>
        <exception cref="T:System.NotSupportedException"><span data-ttu-id="08401-841">路径包含字符串中间的冒号。</span><span class="sxs-lookup"><span data-stu-id="08401-841">The path contains a colon in the middle of the string.</span></span></exception>
        <exception cref="T:System.IO.PathTooLongException"><span data-ttu-id="08401-842">路径过长。</span><span class="sxs-lookup"><span data-stu-id="08401-842">The path is too long.</span></span></exception>
        <exception cref="T:System.Security.SecurityException"><span data-ttu-id="08401-843">该用户缺少必要的权限。</span><span class="sxs-lookup"><span data-stu-id="08401-843">The user lacks necessary permissions.</span></span></exception>
        <exception cref="T:System.UnauthorizedAccessException"><span data-ttu-id="08401-844">该用户缺少对文件的 ACL （访问控制列表） 访问。</span><span class="sxs-lookup"><span data-stu-id="08401-844">The user lacks ACL (access control list) access to the file.</span></span></exception>
        <permission cref="T:System.Security.Permissions.FileIOPermission"><span data-ttu-id="08401-845">控制文件和文件夹的访问权限。</span><span class="sxs-lookup"><span data-stu-id="08401-845">Controls the ability to access files and folders.</span></span> <span data-ttu-id="08401-846">关联枚举： <see cref="F:System.Security.Permissions.PermissionState.Unrestricted" />。</span><span class="sxs-lookup"><span data-stu-id="08401-846">Associated enumeration: <see cref="F:System.Security.Permissions.PermissionState.Unrestricted" />.</span></span></permission>
        <altmember cref="T:System.IO.FileInfo" />
        <related type="Article" href="~/docs/visual-basic/language-reference/objects/index.md"><span data-ttu-id="08401-847">对象 (Visual Basic)</span><span class="sxs-lookup"><span data-stu-id="08401-847">Objects (Visual Basic)</span></span></related>
        <related type="Article" href="~/docs/visual-basic/developing-apps/programming/drives-directories-files/walkthrough-manipulating-files-and-directories.md"><span data-ttu-id="08401-848">演练：在 Visual Basic 中操作文件和目录</span><span class="sxs-lookup"><span data-stu-id="08401-848">Walkthrough: Manipulating Files and Directories in Visual Basic</span></span></related>
      </Docs>
    </Member>
    <MemberGroup MemberName="GetFiles">
      <AssemblyInfo>
        <AssemblyName>Microsoft.VisualBasic</AssemblyName>
        <AssemblyVersion>10.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Docs>
        <summary><span data-ttu-id="08401-849">返回表示目录中的文件的名称的字符串的只读集合。</span><span class="sxs-lookup"><span data-stu-id="08401-849">Returns a read-only collection of strings representing the names of files within a directory.</span></span></summary>
      </Docs>
    </MemberGroup>
    <Member MemberName="GetFiles">
      <MemberSignature Language="C#" Value="public System.Collections.ObjectModel.ReadOnlyCollection&lt;string&gt; GetFiles (string directory);" />
      <MemberSignature Language="ILAsm" Value=".method public instance class System.Collections.ObjectModel.ReadOnlyCollection`1&lt;string&gt; GetFiles(string directory) cil managed" />
      <MemberSignature Language="DocId" Value="M:Microsoft.VisualBasic.MyServices.FileSystemProxy.GetFiles(System.String)" />
      <MemberSignature Language="VB.NET" Value="Public Function GetFiles (directory As String) As ReadOnlyCollection(Of String)" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; System::Collections::ObjectModel::ReadOnlyCollection&lt;System::String ^&gt; ^ GetFiles(System::String ^ directory);" />
      <MemberSignature Language="F#" Value="member this.GetFiles : string -&gt; System.Collections.ObjectModel.ReadOnlyCollection&lt;string&gt;" Usage="fileSystemProxy.GetFiles directory" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>Microsoft.VisualBasic</AssemblyName>
        <AssemblyVersion>8.0.0.0</AssemblyVersion>
        <AssemblyVersion>10.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <AssemblyInfo>
        <AssemblyName>Microsoft.VisualBasic.Core</AssemblyName>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Collections.ObjectModel.ReadOnlyCollection&lt;System.String&gt;</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="directory" Type="System.String" Index="0" FrameworkAlternate="netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;netframework-4.8" />
      </Parameters>
      <Docs>
        <param name="directory"><span data-ttu-id="08401-850">要搜索的目录。</span><span class="sxs-lookup"><span data-stu-id="08401-850">Directory to be searched.</span></span></param>
        <summary><span data-ttu-id="08401-851">返回表示目录中的文件的名称的字符串的只读集合。</span><span class="sxs-lookup"><span data-stu-id="08401-851">Returns a read-only collection of strings representing the names of files within a directory.</span></span></summary>
        <returns><span data-ttu-id="08401-852">从指定的目录的文件名称的只读集合。</span><span class="sxs-lookup"><span data-stu-id="08401-852">Read-only collection of file names from the specified directory.</span></span></returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="08401-853">如果没有找到与指定模式匹配的文件，则返回一个空集合。</span><span class="sxs-lookup"><span data-stu-id="08401-853">An empty collection is returned if no files matching the specified pattern are found.</span></span>  
  
 <span data-ttu-id="08401-854">下表列出了所涉及的任务的示例`My.Computer.FileSystem.GetFiles`方法。</span><span class="sxs-lookup"><span data-stu-id="08401-854">The following table lists examples of tasks involving the `My.Computer.FileSystem.GetFiles` method.</span></span>  
  
|<span data-ttu-id="08401-855">功能</span><span class="sxs-lookup"><span data-stu-id="08401-855">To</span></span>|<span data-ttu-id="08401-856">查看</span><span class="sxs-lookup"><span data-stu-id="08401-856">See</span></span>|  
|--------|---------|  
|<span data-ttu-id="08401-857">获取目录中的文件的集合</span><span class="sxs-lookup"><span data-stu-id="08401-857">Get the collection of files in a directory</span></span>|[<span data-ttu-id="08401-858">如何：获取目录中的文件集合</span><span class="sxs-lookup"><span data-stu-id="08401-858">How to: Get the Collection of Files in a Directory</span></span>](~/docs/visual-basic/developing-apps/programming/drives-directories-files/how-to-get-the-collection-of-files-in-a-directory.md)|  
|<span data-ttu-id="08401-859">在目录中查找具有特定模式的文件</span><span class="sxs-lookup"><span data-stu-id="08401-859">Find files with a specific pattern in a directory</span></span>|[<span data-ttu-id="08401-860">如何：查找具有特定模式的文件</span><span class="sxs-lookup"><span data-stu-id="08401-860">How to: Find Files with a Specific Pattern</span></span>](~/docs/visual-basic/developing-apps/programming/drives-directories-files/how-to-find-files-with-a-specific-pattern.md)|  
  
   
  
## Examples  
 <span data-ttu-id="08401-861">下面的示例返回目录中的所有文件，并将它们添加到 `ListBox1`。</span><span class="sxs-lookup"><span data-stu-id="08401-861">The following example returns all files in the directory and adds them to `ListBox1`.</span></span>  
  
 [!code-vb[VbRefFile#5](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbRefFile/VB/Class1.vb#5)]  
  
 <span data-ttu-id="08401-862">此示例要求具有`ListBox`名为`ListBox1`窗体上。</span><span class="sxs-lookup"><span data-stu-id="08401-862">This example requires that you have a `ListBox` named `ListBox1` on your form.</span></span>  
  
 <span data-ttu-id="08401-863">此示例返回所有文件扩展名的目录中`.txt`并将它们添加到`ListBox1`。</span><span class="sxs-lookup"><span data-stu-id="08401-863">This example returns all files in the directory with the extension `.txt` and adds them to `ListBox1`.</span></span>  
  
 [!code-vb[VbRefFile#6](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbRefFile/VB/Class1.vb#6)]  
  
 <span data-ttu-id="08401-864">此示例要求具有`ListBox`名为`ListBox1`窗体上。</span><span class="sxs-lookup"><span data-stu-id="08401-864">This example requires that you have a `ListBox` named `ListBox1` on your form.</span></span>  
  
 ]]></format>
        </remarks>
        <altCompliant cref="None." />
        <exception cref="T:System.ArgumentException"><span data-ttu-id="08401-865">路径由于以下原因之一无效：是零长度字符串；仅为空白；包含无效字符；是一个设备路径（以 \\\\.\\ 开头）。</span><span class="sxs-lookup"><span data-stu-id="08401-865">The path is not valid for one of the following reasons: it is a zero-length string; it contains only white space; it contains invalid characters; or it is a device path (starts with \\\\.\\).</span></span></exception>
        <exception cref="T:System.ArgumentNullException"><span data-ttu-id="08401-866"><paramref name="directory" /> 为 <see langword="Nothing" />。</span><span class="sxs-lookup"><span data-stu-id="08401-866"><paramref name="directory" /> is <see langword="Nothing" />.</span></span></exception>
        <exception cref="T:System.IO.DirectoryNotFoundException"><span data-ttu-id="08401-867">要搜索的目录不存在。</span><span class="sxs-lookup"><span data-stu-id="08401-867">The directory to search does not exist.</span></span></exception>
        <exception cref="T:System.IO.IOException"><span data-ttu-id="08401-868"><paramref name="directory" /> 指向某个现有文件。</span><span class="sxs-lookup"><span data-stu-id="08401-868"><paramref name="directory" /> points to an existing file.</span></span></exception>
        <exception cref="T:System.IO.PathTooLongException"><span data-ttu-id="08401-869">路径超过系统定义的最大长度。</span><span class="sxs-lookup"><span data-stu-id="08401-869">The path exceeds the system-defined maximum length.</span></span></exception>
        <exception cref="T:System.NotSupportedException"><span data-ttu-id="08401-870">在路径中的文件或目录名称包含冒号 （:），或格式无效。</span><span class="sxs-lookup"><span data-stu-id="08401-870">A file or directory name in the path contains a colon (:) or is in an invalid format.</span></span></exception>
        <exception cref="T:System.Security.SecurityException"><span data-ttu-id="08401-871">该用户缺少必要的权限查看该路径。</span><span class="sxs-lookup"><span data-stu-id="08401-871">The user lacks necessary permissions to view the path.</span></span></exception>
        <exception cref="T:System.UnauthorizedAccessException"><span data-ttu-id="08401-872">该用户缺少必要的权限。</span><span class="sxs-lookup"><span data-stu-id="08401-872">The user lacks necessary permissions.</span></span></exception>
        <permission cref="T:System.Security.Permissions.FileIOPermission"><span data-ttu-id="08401-873">控制文件和文件夹的访问权限。</span><span class="sxs-lookup"><span data-stu-id="08401-873">Controls the ability to access files and folders.</span></span> <span data-ttu-id="08401-874">关联枚举： <see cref="F:System.Security.Permissions.PermissionState.Unrestricted" />。</span><span class="sxs-lookup"><span data-stu-id="08401-874">Associated enumeration: <see cref="F:System.Security.Permissions.PermissionState.Unrestricted" />.</span></span></permission>
        <altmember cref="T:System.Collections.ObjectModel.ReadOnlyCollection`1" />
        <related type="Article" href="~/docs/visual-basic/language-reference/objects/index.md"><span data-ttu-id="08401-875">对象 (Visual Basic)</span><span class="sxs-lookup"><span data-stu-id="08401-875">Objects (Visual Basic)</span></span></related>
        <related type="Article" href="~/docs/visual-basic/developing-apps/programming/drives-directories-files/how-to-find-files-with-a-specific-pattern.md"><span data-ttu-id="08401-876">如何：在 Visual Basic 中查找具有特定模式的文件</span><span class="sxs-lookup"><span data-stu-id="08401-876">How to: Find Files with a Specific Pattern in Visual Basic</span></span></related>
        <related type="Article" href="~/docs/visual-basic/developing-apps/programming/drives-directories-files/how-to-get-the-collection-of-files-in-a-directory.md"><span data-ttu-id="08401-877">如何：在 Visual Basic 中获取目录中的文件集合</span><span class="sxs-lookup"><span data-stu-id="08401-877">How to: Get the Collection of Files in a Directory in Visual Basic</span></span></related>
      </Docs>
    </Member>
    <Member MemberName="GetFiles">
      <MemberSignature Language="C#" Value="public System.Collections.ObjectModel.ReadOnlyCollection&lt;string&gt; GetFiles (string directory, Microsoft.VisualBasic.FileIO.SearchOption searchType, params string[] wildcards);" />
      <MemberSignature Language="ILAsm" Value=".method public instance class System.Collections.ObjectModel.ReadOnlyCollection`1&lt;string&gt; GetFiles(string directory, valuetype Microsoft.VisualBasic.FileIO.SearchOption searchType, string[] wildcards) cil managed" />
      <MemberSignature Language="DocId" Value="M:Microsoft.VisualBasic.MyServices.FileSystemProxy.GetFiles(System.String,Microsoft.VisualBasic.FileIO.SearchOption,System.String[])" />
      <MemberSignature Language="VB.NET" Value="Public Function GetFiles (directory As String, searchType As SearchOption, ParamArray wildcards As String()) As ReadOnlyCollection(Of String)" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; System::Collections::ObjectModel::ReadOnlyCollection&lt;System::String ^&gt; ^ GetFiles(System::String ^ directory, Microsoft::VisualBasic::FileIO::SearchOption searchType, ... cli::array &lt;System::String ^&gt; ^ wildcards);" />
      <MemberSignature Language="F#" Value="member this.GetFiles : string * Microsoft.VisualBasic.FileIO.SearchOption * string[] -&gt; System.Collections.ObjectModel.ReadOnlyCollection&lt;string&gt;" Usage="fileSystemProxy.GetFiles (directory, searchType, wildcards)" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>Microsoft.VisualBasic</AssemblyName>
        <AssemblyVersion>8.0.0.0</AssemblyVersion>
        <AssemblyVersion>10.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <AssemblyInfo>
        <AssemblyName>Microsoft.VisualBasic.Core</AssemblyName>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Collections.ObjectModel.ReadOnlyCollection&lt;System.String&gt;</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="directory" Type="System.String" Index="0" FrameworkAlternate="netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;netframework-4.8" />
        <Parameter Name="searchType" Type="Microsoft.VisualBasic.FileIO.SearchOption" Index="1" FrameworkAlternate="netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;netframework-4.8" />
        <Parameter Name="wildcards" Type="System.String[]" Index="2" FrameworkAlternate="netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;netframework-4.8">
          <Attributes>
            <Attribute FrameworkAlternate="netframework-2.0">
              <AttributeName>System.ParamArray</AttributeName>
            </Attribute>
          </Attributes>
        </Parameter>
      </Parameters>
      <Docs>
        <param name="directory"><span data-ttu-id="08401-878">要搜索的目录。</span><span class="sxs-lookup"><span data-stu-id="08401-878">Directory to be searched.</span></span></param>
        <param name="searchType"><span data-ttu-id="08401-879">是否包括子文件夹。</span><span class="sxs-lookup"><span data-stu-id="08401-879">Whether to include subfolders.</span></span> <span data-ttu-id="08401-880">默认值为 <see langword="SearchOption.SearchTopLevelOnly" />。</span><span class="sxs-lookup"><span data-stu-id="08401-880">Default is <see langword="SearchOption.SearchTopLevelOnly" />.</span></span></param>
        <param name="wildcards"><span data-ttu-id="08401-881">要匹配的模式。</span><span class="sxs-lookup"><span data-stu-id="08401-881">Pattern to be matched.</span></span></param>
        <summary><span data-ttu-id="08401-882">返回表示目录中的文件的名称的字符串的只读集合。</span><span class="sxs-lookup"><span data-stu-id="08401-882">Returns a read-only collection of strings representing the names of files within a directory.</span></span></summary>
        <returns><span data-ttu-id="08401-883">从指定的目录的文件名称的只读集合。</span><span class="sxs-lookup"><span data-stu-id="08401-883">Read-only collection of file names from the specified directory.</span></span></returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="08401-884">如果没有找到与指定模式匹配的文件，则返回一个空集合。</span><span class="sxs-lookup"><span data-stu-id="08401-884">An empty collection is returned if no files matching the specified pattern are found.</span></span>  
  
 <span data-ttu-id="08401-885">下表列出了所涉及的任务的示例`My.Computer.FileSystem.GetFiles`方法。</span><span class="sxs-lookup"><span data-stu-id="08401-885">The following table lists examples of tasks involving the `My.Computer.FileSystem.GetFiles` method.</span></span>  
  
|<span data-ttu-id="08401-886">功能</span><span class="sxs-lookup"><span data-stu-id="08401-886">To</span></span>|<span data-ttu-id="08401-887">查看</span><span class="sxs-lookup"><span data-stu-id="08401-887">See</span></span>|  
|--------|---------|  
|<span data-ttu-id="08401-888">获取目录中的文件的集合</span><span class="sxs-lookup"><span data-stu-id="08401-888">Get the collection of files in a directory</span></span>|[<span data-ttu-id="08401-889">如何：获取目录中的文件集合</span><span class="sxs-lookup"><span data-stu-id="08401-889">How to: Get the Collection of Files in a Directory</span></span>](~/docs/visual-basic/developing-apps/programming/drives-directories-files/how-to-get-the-collection-of-files-in-a-directory.md)|  
|<span data-ttu-id="08401-890">在目录中查找具有特定模式的文件</span><span class="sxs-lookup"><span data-stu-id="08401-890">Find files with a specific pattern in a directory</span></span>|[<span data-ttu-id="08401-891">如何：查找具有特定模式的文件</span><span class="sxs-lookup"><span data-stu-id="08401-891">How to: Find Files with a Specific Pattern</span></span>](~/docs/visual-basic/developing-apps/programming/drives-directories-files/how-to-find-files-with-a-specific-pattern.md)|  
  
   
  
## Examples  
 <span data-ttu-id="08401-892">下面的示例返回目录中的所有文件，并将它们添加到 `ListBox1`。</span><span class="sxs-lookup"><span data-stu-id="08401-892">The following example returns all files in the directory and adds them to `ListBox1`.</span></span>  
  
 [!code-vb[VbRefFile#5](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbRefFile/VB/Class1.vb#5)]  
  
 <span data-ttu-id="08401-893">此示例要求具有`ListBox`名为`ListBox1`窗体上。</span><span class="sxs-lookup"><span data-stu-id="08401-893">This example requires that you have a `ListBox` named `ListBox1` on your form.</span></span>  
  
 <span data-ttu-id="08401-894">此示例返回所有文件扩展名的目录中`.txt`并将它们添加到`ListBox1`。</span><span class="sxs-lookup"><span data-stu-id="08401-894">This example returns all files in the directory with the extension `.txt` and adds them to `ListBox1`.</span></span>  
  
 [!code-vb[VbRefFile#6](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbRefFile/VB/Class1.vb#6)]  
  
 <span data-ttu-id="08401-895">此示例要求具有`ListBox`名为`ListBox1`窗体上。</span><span class="sxs-lookup"><span data-stu-id="08401-895">This example requires that you have a `ListBox` named `ListBox1` on your form.</span></span>  
  
 ]]></format>
        </remarks>
        <altCompliant cref="None." />
        <exception cref="T:System.ArgumentException"><span data-ttu-id="08401-896">路径由于以下原因之一无效：是零长度字符串；仅为空白；包含无效字符；是一个设备路径（以 \\\\.\\ 开头）。</span><span class="sxs-lookup"><span data-stu-id="08401-896">The path is not valid for one of the following reasons: it is a zero-length string; it contains only white space; it contains invalid characters; or it is a device path (starts with \\\\.\\).</span></span></exception>
        <exception cref="T:System.ArgumentNullException"><span data-ttu-id="08401-897"><paramref name="directory" /> 为 <see langword="Nothing" />。</span><span class="sxs-lookup"><span data-stu-id="08401-897"><paramref name="directory" /> is <see langword="Nothing" />.</span></span></exception>
        <exception cref="T:System.IO.DirectoryNotFoundException"><span data-ttu-id="08401-898">要搜索的目录不存在。</span><span class="sxs-lookup"><span data-stu-id="08401-898">The directory to search does not exist.</span></span></exception>
        <exception cref="T:System.IO.IOException"><span data-ttu-id="08401-899"><paramref name="directory" /> 指向某个现有文件。</span><span class="sxs-lookup"><span data-stu-id="08401-899"><paramref name="directory" /> points to an existing file.</span></span></exception>
        <exception cref="T:System.IO.PathTooLongException"><span data-ttu-id="08401-900">路径超过系统定义的最大长度。</span><span class="sxs-lookup"><span data-stu-id="08401-900">The path exceeds the system-defined maximum length.</span></span></exception>
        <exception cref="T:System.NotSupportedException"><span data-ttu-id="08401-901">在路径中的文件或目录名称包含冒号 （:），或格式无效。</span><span class="sxs-lookup"><span data-stu-id="08401-901">A file or directory name in the path contains a colon (:) or is in an invalid format.</span></span></exception>
        <exception cref="T:System.Security.SecurityException"><span data-ttu-id="08401-902">该用户缺少必要的权限查看该路径。</span><span class="sxs-lookup"><span data-stu-id="08401-902">The user lacks necessary permissions to view the path.</span></span></exception>
        <exception cref="T:System.UnauthorizedAccessException"><span data-ttu-id="08401-903">该用户缺少必要的权限。</span><span class="sxs-lookup"><span data-stu-id="08401-903">The user lacks necessary permissions.</span></span></exception>
        <permission cref="T:System.Security.Permissions.FileIOPermission"><span data-ttu-id="08401-904">控制文件和文件夹的访问权限。</span><span class="sxs-lookup"><span data-stu-id="08401-904">Controls the ability to access files and folders.</span></span> <span data-ttu-id="08401-905">关联枚举： <see cref="F:System.Security.Permissions.PermissionState.Unrestricted" />。</span><span class="sxs-lookup"><span data-stu-id="08401-905">Associated enumeration: <see cref="F:System.Security.Permissions.PermissionState.Unrestricted" />.</span></span></permission>
        <altmember cref="T:Microsoft.VisualBasic.FileIO.SearchOption" />
        <altmember cref="T:System.Collections.ObjectModel.ReadOnlyCollection`1" />
        <related type="Article" href="~/docs/visual-basic/language-reference/objects/index.md"><span data-ttu-id="08401-906">对象 (Visual Basic)</span><span class="sxs-lookup"><span data-stu-id="08401-906">Objects (Visual Basic)</span></span></related>
        <related type="Article" href="~/docs/visual-basic/developing-apps/programming/drives-directories-files/how-to-find-files-with-a-specific-pattern.md"><span data-ttu-id="08401-907">如何：在 Visual Basic 中查找具有特定模式的文件</span><span class="sxs-lookup"><span data-stu-id="08401-907">How to: Find Files with a Specific Pattern in Visual Basic</span></span></related>
        <related type="Article" href="~/docs/visual-basic/developing-apps/programming/drives-directories-files/how-to-get-the-collection-of-files-in-a-directory.md"><span data-ttu-id="08401-908">如何：在 Visual Basic 中获取目录中的文件集合</span><span class="sxs-lookup"><span data-stu-id="08401-908">How to: Get the Collection of Files in a Directory in Visual Basic</span></span></related>
      </Docs>
    </Member>
    <Member MemberName="GetName">
      <MemberSignature Language="C#" Value="public string GetName (string path);" />
      <MemberSignature Language="ILAsm" Value=".method public instance string GetName(string path) cil managed" />
      <MemberSignature Language="DocId" Value="M:Microsoft.VisualBasic.MyServices.FileSystemProxy.GetName(System.String)" />
      <MemberSignature Language="VB.NET" Value="Public Function GetName (path As String) As String" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; System::String ^ GetName(System::String ^ path);" />
      <MemberSignature Language="F#" Value="member this.GetName : string -&gt; string" Usage="fileSystemProxy.GetName path" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>Microsoft.VisualBasic</AssemblyName>
        <AssemblyVersion>8.0.0.0</AssemblyVersion>
        <AssemblyVersion>10.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <AssemblyInfo>
        <AssemblyName>Microsoft.VisualBasic.Core</AssemblyName>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.String</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="path" Type="System.String" Index="0" FrameworkAlternate="netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;netframework-4.8" />
      </Parameters>
      <Docs>
        <param name="path"><span data-ttu-id="08401-909">必需。</span><span class="sxs-lookup"><span data-stu-id="08401-909">Required.</span></span> <span data-ttu-id="08401-910">要分析的路径。</span><span class="sxs-lookup"><span data-stu-id="08401-910">Path to be parsed.</span></span> <span data-ttu-id="08401-911"><see langword="String" />。</span><span class="sxs-lookup"><span data-stu-id="08401-911"><see langword="String" />.</span></span></param>
        <summary><span data-ttu-id="08401-912">分析文件名称从提供的路径。</span><span class="sxs-lookup"><span data-stu-id="08401-912">Parses the file name out of the path provided.</span></span></summary>
        <returns><span data-ttu-id="08401-913">从指定的路径文件名。</span><span class="sxs-lookup"><span data-stu-id="08401-913">The file name from the specified path.</span></span></returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="08401-914">这是一个字符串操作;`FileSystem`不检查。</span><span class="sxs-lookup"><span data-stu-id="08401-914">This is a string operation; the `FileSystem` is not examined.</span></span>  
  
 <span data-ttu-id="08401-915">`GetName`方法忽略斜杠标记发生在路径的末尾。</span><span class="sxs-lookup"><span data-stu-id="08401-915">The `GetName` method ignores a slash mark occurring at the end of the path.</span></span>  
  
 <span data-ttu-id="08401-916">下表列出了所涉及的任务的示例`My.Computer.FileSystem.GetFileName`方法。</span><span class="sxs-lookup"><span data-stu-id="08401-916">The following table lists examples of tasks involving the `My.Computer.FileSystem.GetFileName` method.</span></span>  
  
|<span data-ttu-id="08401-917">功能</span><span class="sxs-lookup"><span data-stu-id="08401-917">To</span></span>|<span data-ttu-id="08401-918">查看</span><span class="sxs-lookup"><span data-stu-id="08401-918">See</span></span>|  
|--------|---------|  
|<span data-ttu-id="08401-919">分析文件路径</span><span class="sxs-lookup"><span data-stu-id="08401-919">Parse a file path</span></span>|[<span data-ttu-id="08401-920">如何：分析文件路径</span><span class="sxs-lookup"><span data-stu-id="08401-920">How to: Parse File Paths</span></span>](~/docs/visual-basic/developing-apps/programming/drives-directories-files/how-to-parse-file-paths.md)|  
  
   
  
## Examples  
 <span data-ttu-id="08401-921">下面的示例分析文件路径，并返回文件的名称。</span><span class="sxs-lookup"><span data-stu-id="08401-921">The following example parses a file path and returns the name of the file.</span></span>  
  
 [!code-vb[VbVbcnMyFileSystem#21](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbcnMyFileSystem/VB/Class1.vb#21)]  
  
 <span data-ttu-id="08401-922">将路径为`C:\Testdirectory\Testfile`与你想要分析的路径。</span><span class="sxs-lookup"><span data-stu-id="08401-922">Replace the path `C:\Testdirectory\Testfile` with the path you wish to parse.</span></span>  
  
 ]]></format>
        </remarks>
        <related type="Article" href="~/docs/visual-basic/language-reference/objects/index.md"><span data-ttu-id="08401-923">对象 (Visual Basic)</span><span class="sxs-lookup"><span data-stu-id="08401-923">Objects (Visual Basic)</span></span></related>
      </Docs>
    </Member>
    <Member MemberName="GetParentPath">
      <MemberSignature Language="C#" Value="public string GetParentPath (string path);" />
      <MemberSignature Language="ILAsm" Value=".method public instance string GetParentPath(string path) cil managed" />
      <MemberSignature Language="DocId" Value="M:Microsoft.VisualBasic.MyServices.FileSystemProxy.GetParentPath(System.String)" />
      <MemberSignature Language="VB.NET" Value="Public Function GetParentPath (path As String) As String" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; System::String ^ GetParentPath(System::String ^ path);" />
      <MemberSignature Language="F#" Value="member this.GetParentPath : string -&gt; string" Usage="fileSystemProxy.GetParentPath path" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>Microsoft.VisualBasic</AssemblyName>
        <AssemblyVersion>8.0.0.0</AssemblyVersion>
        <AssemblyVersion>10.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <AssemblyInfo>
        <AssemblyName>Microsoft.VisualBasic.Core</AssemblyName>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.String</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="path" Type="System.String" Index="0" FrameworkAlternate="netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;netframework-4.8" />
      </Parameters>
      <Docs>
        <param name="path"><span data-ttu-id="08401-924">要检查的路径。</span><span class="sxs-lookup"><span data-stu-id="08401-924">Path to be examined.</span></span></param>
        <summary><span data-ttu-id="08401-925">返回所提供的路径的父路径。</span><span class="sxs-lookup"><span data-stu-id="08401-925">Returns the parent path of the provided path.</span></span></summary>
        <returns><span data-ttu-id="08401-926">所提供的路径的父路径。</span><span class="sxs-lookup"><span data-stu-id="08401-926">The parent path of the provided path.</span></span></returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="08401-927">这是一个字符串操作;不检查文件系统。</span><span class="sxs-lookup"><span data-stu-id="08401-927">This is a string operation; the file system is not examined.</span></span>  
  
   
  
## Examples  
 <span data-ttu-id="08401-928">此示例将获取的父路径`C:\Backups\Tmp\Test`。</span><span class="sxs-lookup"><span data-stu-id="08401-928">This example gets the parent path for `C:\Backups\Tmp\Test`.</span></span>  
  
 [!code-vb[VbRefFile#17](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbRefFile/VB/Class1.vb#17)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentException"><span data-ttu-id="08401-929">路径不具有父路径，因为它是根路径。</span><span class="sxs-lookup"><span data-stu-id="08401-929">Path does not have a parent path because it is a root path.</span></span></exception>
        <exception cref="T:System.ArgumentNullException"><span data-ttu-id="08401-930"><paramref name="path" /> 为 <see langword="Nothing" />。</span><span class="sxs-lookup"><span data-stu-id="08401-930"><paramref name="path" /> is <see langword="Nothing" />.</span></span></exception>
        <exception cref="T:System.IO.PathTooLongException"><span data-ttu-id="08401-931">路径超过系统定义的最大长度。</span><span class="sxs-lookup"><span data-stu-id="08401-931">The path exceeds the system-defined maximum length.</span></span></exception>
        <exception cref="T:System.NotSupportedException"><span data-ttu-id="08401-932">在路径中的文件或目录名称包含冒号 （:），或格式无效。</span><span class="sxs-lookup"><span data-stu-id="08401-932">A file or directory name in the path contains a colon (:) or is in an invalid format.</span></span></exception>
        <related type="Article" href="~/docs/visual-basic/language-reference/objects/index.md"><span data-ttu-id="08401-933">对象 (Visual Basic)</span><span class="sxs-lookup"><span data-stu-id="08401-933">Objects (Visual Basic)</span></span></related>
        <related type="Article" href="~/docs/visual-basic/developing-apps/programming/drives-directories-files/how-to-parse-file-paths.md"><span data-ttu-id="08401-934">如何：在 Visual Basic 中分析文件路径</span><span class="sxs-lookup"><span data-stu-id="08401-934">How to: Parse File Paths in Visual Basic</span></span></related>
      </Docs>
    </Member>
    <Member MemberName="GetTempFileName">
      <MemberSignature Language="C#" Value="public string GetTempFileName ();" />
      <MemberSignature Language="ILAsm" Value=".method public instance string GetTempFileName() cil managed" />
      <MemberSignature Language="DocId" Value="M:Microsoft.VisualBasic.MyServices.FileSystemProxy.GetTempFileName" />
      <MemberSignature Language="VB.NET" Value="Public Function GetTempFileName () As String" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; System::String ^ GetTempFileName();" />
      <MemberSignature Language="F#" Value="member this.GetTempFileName : unit -&gt; string" Usage="fileSystemProxy.GetTempFileName " />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>Microsoft.VisualBasic</AssemblyName>
        <AssemblyVersion>8.0.0.0</AssemblyVersion>
        <AssemblyVersion>10.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <AssemblyInfo>
        <AssemblyName>Microsoft.VisualBasic.Core</AssemblyName>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.String</ReturnType>
      </ReturnValue>
      <Parameters />
      <Docs>
        <summary><span data-ttu-id="08401-935">创建唯一的命名磁盘上的零字节临时文件并返回该文件的完整路径。</span><span class="sxs-lookup"><span data-stu-id="08401-935">Creates a uniquely named zero-byte temporary file on disk and returns the full path of that file.</span></span></summary>
        <returns><span data-ttu-id="08401-936"><see langword="String" /> 包含临时文件的完整路径。</span><span class="sxs-lookup"><span data-stu-id="08401-936"><see langword="String" /> containing the full path of the temporary file.</span></span></returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="08401-937">此方法可用于创建临时文件。</span><span class="sxs-lookup"><span data-stu-id="08401-937">This method can be used to create a temporary file.</span></span>  
  
   
  
## Examples  
 <span data-ttu-id="08401-938">此示例中创建临时文件，并返回其路径。</span><span class="sxs-lookup"><span data-stu-id="08401-938">This example creates a temp file and returns its path.</span></span>  
  
 [!code-vb[VbVbcnMyFileSystem#12](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbcnMyFileSystem/VB/Class1.vb#12)]  
  
 ]]></format>
        </remarks>
        <permission cref="T:System.Security.Permissions.FileIOPermission"><span data-ttu-id="08401-939">控制文件和文件夹的访问权限。</span><span class="sxs-lookup"><span data-stu-id="08401-939">Controls the ability to access files and folders.</span></span> <span data-ttu-id="08401-940">关联枚举： <see cref="F:System.Security.Permissions.PermissionState.Unrestricted" />。</span><span class="sxs-lookup"><span data-stu-id="08401-940">Associated enumeration: <see cref="F:System.Security.Permissions.PermissionState.Unrestricted" />.</span></span></permission>
        <related type="Article" href="~/docs/visual-basic/language-reference/objects/index.md"><span data-ttu-id="08401-941">对象 (Visual Basic)</span><span class="sxs-lookup"><span data-stu-id="08401-941">Objects (Visual Basic)</span></span></related>
        <related type="Article" href="~/docs/visual-basic/developing-apps/programming/drives-directories-files/creating-deleting-and-moving-files-and-directories.md"><span data-ttu-id="08401-942">创建、删除和移动文件和目录 (Visual Basic)</span><span class="sxs-lookup"><span data-stu-id="08401-942">Creating, Deleting, and Moving Files and Directories in Visual Basic</span></span></related>
      </Docs>
    </Member>
    <MemberGroup MemberName="MoveDirectory">
      <AssemblyInfo>
        <AssemblyName>Microsoft.VisualBasic</AssemblyName>
        <AssemblyVersion>10.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Docs>
        <summary><span data-ttu-id="08401-943">将目录从一个位置移动到另一个。</span><span class="sxs-lookup"><span data-stu-id="08401-943">Moves a directory from one location to another.</span></span></summary>
      </Docs>
    </MemberGroup>
    <Member MemberName="MoveDirectory">
      <MemberSignature Language="C#" Value="public void MoveDirectory (string sourceDirectoryName, string destinationDirectoryName);" />
      <MemberSignature Language="ILAsm" Value=".method public instance void MoveDirectory(string sourceDirectoryName, string destinationDirectoryName) cil managed" />
      <MemberSignature Language="DocId" Value="M:Microsoft.VisualBasic.MyServices.FileSystemProxy.MoveDirectory(System.String,System.String)" />
      <MemberSignature Language="VB.NET" Value="Public Sub MoveDirectory (sourceDirectoryName As String, destinationDirectoryName As String)" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; void MoveDirectory(System::String ^ sourceDirectoryName, System::String ^ destinationDirectoryName);" />
      <MemberSignature Language="F#" Value="member this.MoveDirectory : string * string -&gt; unit" Usage="fileSystemProxy.MoveDirectory (sourceDirectoryName, destinationDirectoryName)" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>Microsoft.VisualBasic</AssemblyName>
        <AssemblyVersion>8.0.0.0</AssemblyVersion>
        <AssemblyVersion>10.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <AssemblyInfo>
        <AssemblyName>Microsoft.VisualBasic.Core</AssemblyName>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Void</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="sourceDirectoryName" Type="System.String" Index="0" FrameworkAlternate="netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;netframework-4.8" />
        <Parameter Name="destinationDirectoryName" Type="System.String" Index="1" FrameworkAlternate="netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;netframework-4.8" />
      </Parameters>
      <Docs>
        <param name="sourceDirectoryName"><span data-ttu-id="08401-944">要移动的目录的路径。</span><span class="sxs-lookup"><span data-stu-id="08401-944">Path of the directory to be moved.</span></span></param>
        <param name="destinationDirectoryName"><span data-ttu-id="08401-945">源目录移到其中的目录路径。</span><span class="sxs-lookup"><span data-stu-id="08401-945">Path of the directory to which the source directory is being moved.</span></span></param>
        <summary><span data-ttu-id="08401-946">将目录从一个位置移动到另一个。</span><span class="sxs-lookup"><span data-stu-id="08401-946">Moves a directory from one location to another.</span></span></summary>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="08401-947">如果尝试将移动一个目录不存在的目录，将创建目标结构。</span><span class="sxs-lookup"><span data-stu-id="08401-947">If an attempt is made to move a directory inside a directory that does not exist, the target structure will be created.</span></span>  
  
   
  
## Examples  
 <span data-ttu-id="08401-948">此示例将移动`Directory1`内`Directory2`。</span><span class="sxs-lookup"><span data-stu-id="08401-948">This example moves `Directory1` inside `Directory2`.</span></span>  
  
 [!code-vb[VbVbcnMyFileSystem#81](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbcnMyFileSystem/VB/Class1.vb#81)]  
  
 <span data-ttu-id="08401-949">此示例将移动`Directory1`内`Directory2`，如果它已存在，则覆盖该目录。</span><span class="sxs-lookup"><span data-stu-id="08401-949">This example moves `Directory1` inside `Directory2`, overwriting the directory if it already exists.</span></span>  
  
 [!code-vb[VbVbcnMyFileSystem#82](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbcnMyFileSystem/VB/Class1.vb#82)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentException"><span data-ttu-id="08401-950">路径由于以下原因之一无效：是零长度字符串；仅为空白；包含无效字符；是一个设备路径（以 \\\\.\\ 开头）。</span><span class="sxs-lookup"><span data-stu-id="08401-950">The path is not valid for one of the following reasons: it is a zero-length string; it contains only white space; it contains invalid characters; or it is a device path (starts with \\\\.\\).</span></span></exception>
        <exception cref="T:System.ArgumentNullException"><span data-ttu-id="08401-951"><paramref name="sourceDirectoryName" /> 或<paramref name="destinationDirectoryName" />是<see langword="Nothing" />或空字符串。</span><span class="sxs-lookup"><span data-stu-id="08401-951"><paramref name="sourceDirectoryName" /> or <paramref name="destinationDirectoryName" /> is <see langword="Nothing" /> or an empty string.</span></span></exception>
        <exception cref="T:System.IO.DirectoryNotFoundException"><span data-ttu-id="08401-952">目录不存在。</span><span class="sxs-lookup"><span data-stu-id="08401-952">The directory does not exist.</span></span></exception>
        <exception cref="T:System.IO.IOException"><span data-ttu-id="08401-953">源是一个根目录或源路径和目标路径是相同的。</span><span class="sxs-lookup"><span data-stu-id="08401-953">The source is a root directory or The source path and the target path are the same.</span></span></exception>
        <exception cref="T:System.IO.PathTooLongException"><span data-ttu-id="08401-954">路径超过系统定义的最大长度。</span><span class="sxs-lookup"><span data-stu-id="08401-954">The path exceeds the system-defined maximum length.</span></span></exception>
        <exception cref="T:System.InvalidOperationException"><span data-ttu-id="08401-955">该操作是循环的。</span><span class="sxs-lookup"><span data-stu-id="08401-955">The operation is cyclic.</span></span></exception>
        <exception cref="T:System.NotSupportedException"><span data-ttu-id="08401-956">在路径中的文件或目录名称包含冒号 （:），或格式无效。</span><span class="sxs-lookup"><span data-stu-id="08401-956">A file or directory name in the path contains a colon (:) or is in an invalid format.</span></span></exception>
        <exception cref="T:System.Security.SecurityException"><span data-ttu-id="08401-957">该用户缺少必要的权限查看该路径。</span><span class="sxs-lookup"><span data-stu-id="08401-957">The user lacks necessary permissions to view the path.</span></span></exception>
        <exception cref="T:System.UnauthorizedAccessException"><span data-ttu-id="08401-958">用户没有所需的权限。</span><span class="sxs-lookup"><span data-stu-id="08401-958">The user does not have required permission.</span></span></exception>
        <permission cref="T:System.Security.Permissions.FileIOPermission"><span data-ttu-id="08401-959">控制文件和文件夹的访问权限。</span><span class="sxs-lookup"><span data-stu-id="08401-959">Controls the ability to access files and folders.</span></span> <span data-ttu-id="08401-960">关联枚举： <see cref="F:System.Security.Permissions.PermissionState.Unrestricted" />。</span><span class="sxs-lookup"><span data-stu-id="08401-960">Associated enumeration: <see cref="F:System.Security.Permissions.PermissionState.Unrestricted" />.</span></span></permission>
        <altmember cref="M:Microsoft.VisualBasic.MyServices.FileSystemProxy.MoveFile(System.String,System.String)" />
        <altmember cref="M:Microsoft.VisualBasic.MyServices.FileSystemProxy.CopyDirectory(System.String,System.String)" />
        <related type="Article" href="~/docs/visual-basic/language-reference/objects/index.md"><span data-ttu-id="08401-961">对象 (Visual Basic)</span><span class="sxs-lookup"><span data-stu-id="08401-961">Objects (Visual Basic)</span></span></related>
        <related type="Article" href="~/docs/visual-basic/developing-apps/programming/drives-directories-files/creating-deleting-and-moving-files-and-directories.md"><span data-ttu-id="08401-962">创建、删除和移动文件和目录 (Visual Basic)</span><span class="sxs-lookup"><span data-stu-id="08401-962">Creating, Deleting, and Moving Files and Directories in Visual Basic</span></span></related>
      </Docs>
    </Member>
    <Member MemberName="MoveDirectory">
      <MemberSignature Language="C#" Value="public void MoveDirectory (string sourceDirectoryName, string destinationDirectoryName, Microsoft.VisualBasic.FileIO.UIOption showUI);" />
      <MemberSignature Language="ILAsm" Value=".method public instance void MoveDirectory(string sourceDirectoryName, string destinationDirectoryName, valuetype Microsoft.VisualBasic.FileIO.UIOption showUI) cil managed" />
      <MemberSignature Language="DocId" Value="M:Microsoft.VisualBasic.MyServices.FileSystemProxy.MoveDirectory(System.String,System.String,Microsoft.VisualBasic.FileIO.UIOption)" />
      <MemberSignature Language="VB.NET" Value="Public Sub MoveDirectory (sourceDirectoryName As String, destinationDirectoryName As String, showUI As UIOption)" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; void MoveDirectory(System::String ^ sourceDirectoryName, System::String ^ destinationDirectoryName, Microsoft::VisualBasic::FileIO::UIOption showUI);" />
      <MemberSignature Language="F#" Value="member this.MoveDirectory : string * string * Microsoft.VisualBasic.FileIO.UIOption -&gt; unit" Usage="fileSystemProxy.MoveDirectory (sourceDirectoryName, destinationDirectoryName, showUI)" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>Microsoft.VisualBasic</AssemblyName>
        <AssemblyVersion>8.0.0.0</AssemblyVersion>
        <AssemblyVersion>10.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <AssemblyInfo>
        <AssemblyName>Microsoft.VisualBasic.Core</AssemblyName>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Void</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="sourceDirectoryName" Type="System.String" Index="0" FrameworkAlternate="netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;netframework-4.8" />
        <Parameter Name="destinationDirectoryName" Type="System.String" Index="1" FrameworkAlternate="netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;netframework-4.8" />
        <Parameter Name="showUI" Type="Microsoft.VisualBasic.FileIO.UIOption" Index="2" FrameworkAlternate="netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;netframework-4.8" />
      </Parameters>
      <Docs>
        <param name="sourceDirectoryName"><span data-ttu-id="08401-963">要移动的目录的路径。</span><span class="sxs-lookup"><span data-stu-id="08401-963">Path of the directory to be moved.</span></span></param>
        <param name="destinationDirectoryName"><span data-ttu-id="08401-964">源目录移到其中的目录路径。</span><span class="sxs-lookup"><span data-stu-id="08401-964">Path of the directory to which the source directory is being moved.</span></span></param>
        <param name="showUI"><span data-ttu-id="08401-965">指定是否操作的进度进行可视跟踪。</span><span class="sxs-lookup"><span data-stu-id="08401-965">Specifies whether to visually track the operation's progress.</span></span> <span data-ttu-id="08401-966">默认值为 <see langword="UIOption.OnlyErrorDialogs" />。</span><span class="sxs-lookup"><span data-stu-id="08401-966">Default is <see langword="UIOption.OnlyErrorDialogs" />.</span></span></param>
        <summary><span data-ttu-id="08401-967">将目录从一个位置移动到另一个。</span><span class="sxs-lookup"><span data-stu-id="08401-967">Moves a directory from one location to another.</span></span></summary>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="08401-968">如果尝试将移动一个目录不存在的目录，将创建目标结构。</span><span class="sxs-lookup"><span data-stu-id="08401-968">If an attempt is made to move a directory inside a directory that does not exist, the target structure will be created.</span></span>  
  
   
  
## Examples  
 <span data-ttu-id="08401-969">此示例将移动`Directory1`内`Directory2`。</span><span class="sxs-lookup"><span data-stu-id="08401-969">This example moves `Directory1` inside `Directory2`.</span></span>  
  
 [!code-vb[VbVbcnMyFileSystem#81](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbcnMyFileSystem/VB/Class1.vb#81)]  
  
 <span data-ttu-id="08401-970">此示例将移动`Directory1`内`Directory2`，如果它已存在，则覆盖该目录。</span><span class="sxs-lookup"><span data-stu-id="08401-970">This example moves `Directory1` inside `Directory2`, overwriting the directory if it already exists.</span></span>  
  
 [!code-vb[VbVbcnMyFileSystem#82](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbcnMyFileSystem/VB/Class1.vb#82)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentException"><span data-ttu-id="08401-971">路径由于以下原因之一无效：是零长度字符串；仅为空白；包含无效字符；是一个设备路径（以 \\\\.\\ 开头）。</span><span class="sxs-lookup"><span data-stu-id="08401-971">The path is not valid for one of the following reasons: it is a zero-length string; it contains only white space; it contains invalid characters; or it is a device path (starts with \\\\.\\).</span></span></exception>
        <exception cref="T:System.ArgumentNullException"><span data-ttu-id="08401-972"><paramref name="sourceDirectoryName" /> 或<paramref name="destinationDirectoryName" />是<see langword="Nothing" />或空字符串。</span><span class="sxs-lookup"><span data-stu-id="08401-972"><paramref name="sourceDirectoryName" /> or <paramref name="destinationDirectoryName" /> is <see langword="Nothing" /> or an empty string.</span></span></exception>
        <exception cref="T:System.IO.DirectoryNotFoundException"><span data-ttu-id="08401-973">目录不存在。</span><span class="sxs-lookup"><span data-stu-id="08401-973">The directory does not exist.</span></span></exception>
        <exception cref="T:System.IO.IOException"><span data-ttu-id="08401-974">目标目录已存在，并且 <paramref name="overwrite" /> 设置为 <see langword="False" />。</span><span class="sxs-lookup"><span data-stu-id="08401-974">The target directory already exists and <paramref name="overwrite" /> is set to <see langword="False" />.</span></span></exception>
        <exception cref="T:System.IO.PathTooLongException"><span data-ttu-id="08401-975">路径超过系统定义的最大长度。</span><span class="sxs-lookup"><span data-stu-id="08401-975">The path exceeds the system-defined maximum length.</span></span></exception>
        <exception cref="T:System.InvalidOperationException"><span data-ttu-id="08401-976">该操作是循环的。</span><span class="sxs-lookup"><span data-stu-id="08401-976">The operation is cyclic.</span></span></exception>
        <exception cref="T:System.NotSupportedException"><span data-ttu-id="08401-977">在路径中的文件或目录名称包含冒号 （:），或格式无效。</span><span class="sxs-lookup"><span data-stu-id="08401-977">A file or directory name in the path contains a colon (:) or is in an invalid format.</span></span></exception>
        <exception cref="T:System.Security.SecurityException"><span data-ttu-id="08401-978">该用户缺少必要的权限查看该路径。</span><span class="sxs-lookup"><span data-stu-id="08401-978">The user lacks necessary permissions to view the path.</span></span></exception>
        <exception cref="T:System.UnauthorizedAccessException"><span data-ttu-id="08401-979">用户没有所需的权限。</span><span class="sxs-lookup"><span data-stu-id="08401-979">The user does not have required permission.</span></span></exception>
        <permission cref="T:System.Security.Permissions.FileIOPermission"><span data-ttu-id="08401-980">控制文件和文件夹的访问权限。</span><span class="sxs-lookup"><span data-stu-id="08401-980">Controls the ability to access files and folders.</span></span> <span data-ttu-id="08401-981">关联枚举： <see cref="F:System.Security.Permissions.PermissionState.Unrestricted" />。</span><span class="sxs-lookup"><span data-stu-id="08401-981">Associated enumeration: <see cref="F:System.Security.Permissions.PermissionState.Unrestricted" />.</span></span></permission>
        <permission cref="T:System.Security.Permissions.UIPermission"><span data-ttu-id="08401-982">控制与用户界面和剪贴板相关的权限。</span><span class="sxs-lookup"><span data-stu-id="08401-982">Controls the permissions related to user interfaces and the clipboard.</span></span> <span data-ttu-id="08401-983">关联枚举： <see cref="F:System.Security.Permissions.UIPermissionWindow.SafeSubWindows" />。</span><span class="sxs-lookup"><span data-stu-id="08401-983">Associated enumeration: <see cref="F:System.Security.Permissions.UIPermissionWindow.SafeSubWindows" />.</span></span></permission>
        <altmember cref="M:Microsoft.VisualBasic.MyServices.FileSystemProxy.MoveFile(System.String,System.String)" />
        <altmember cref="M:Microsoft.VisualBasic.MyServices.FileSystemProxy.CopyDirectory(System.String,System.String)" />
        <altmember cref="T:Microsoft.VisualBasic.FileIO.UIOption" />
        <related type="Article" href="~/docs/visual-basic/language-reference/objects/index.md"><span data-ttu-id="08401-984">对象 (Visual Basic)</span><span class="sxs-lookup"><span data-stu-id="08401-984">Objects (Visual Basic)</span></span></related>
        <related type="Article" href="~/docs/visual-basic/developing-apps/programming/drives-directories-files/creating-deleting-and-moving-files-and-directories.md"><span data-ttu-id="08401-985">创建、删除和移动文件和目录 (Visual Basic)</span><span class="sxs-lookup"><span data-stu-id="08401-985">Creating, Deleting, and Moving Files and Directories in Visual Basic</span></span></related>
      </Docs>
    </Member>
    <Member MemberName="MoveDirectory">
      <MemberSignature Language="C#" Value="public void MoveDirectory (string sourceDirectoryName, string destinationDirectoryName, bool overwrite);" />
      <MemberSignature Language="ILAsm" Value=".method public instance void MoveDirectory(string sourceDirectoryName, string destinationDirectoryName, bool overwrite) cil managed" />
      <MemberSignature Language="DocId" Value="M:Microsoft.VisualBasic.MyServices.FileSystemProxy.MoveDirectory(System.String,System.String,System.Boolean)" />
      <MemberSignature Language="VB.NET" Value="Public Sub MoveDirectory (sourceDirectoryName As String, destinationDirectoryName As String, overwrite As Boolean)" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; void MoveDirectory(System::String ^ sourceDirectoryName, System::String ^ destinationDirectoryName, bool overwrite);" />
      <MemberSignature Language="F#" Value="member this.MoveDirectory : string * string * bool -&gt; unit" Usage="fileSystemProxy.MoveDirectory (sourceDirectoryName, destinationDirectoryName, overwrite)" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>Microsoft.VisualBasic</AssemblyName>
        <AssemblyVersion>8.0.0.0</AssemblyVersion>
        <AssemblyVersion>10.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <AssemblyInfo>
        <AssemblyName>Microsoft.VisualBasic.Core</AssemblyName>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Void</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="sourceDirectoryName" Type="System.String" Index="0" FrameworkAlternate="netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;netframework-4.8" />
        <Parameter Name="destinationDirectoryName" Type="System.String" Index="1" FrameworkAlternate="netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;netframework-4.8" />
        <Parameter Name="overwrite" Type="System.Boolean" Index="2" FrameworkAlternate="netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;netframework-4.8" />
      </Parameters>
      <Docs>
        <param name="sourceDirectoryName"><span data-ttu-id="08401-986">要移动的目录的路径。</span><span class="sxs-lookup"><span data-stu-id="08401-986">Path of the directory to be moved.</span></span></param>
        <param name="destinationDirectoryName"><span data-ttu-id="08401-987">源目录移到其中的目录路径。</span><span class="sxs-lookup"><span data-stu-id="08401-987">Path of the directory to which the source directory is being moved.</span></span></param>
        <param name="overwrite"><span data-ttu-id="08401-988"><see langword="True" /> 如果应覆盖现有目录;否则为<see langword="False" />。</span><span class="sxs-lookup"><span data-stu-id="08401-988"><see langword="True" /> if existing directories should be overwritten; otherwise <see langword="False" />.</span></span> <span data-ttu-id="08401-989">默认值为 <see langword="False" />。</span><span class="sxs-lookup"><span data-stu-id="08401-989">Default is <see langword="False" />.</span></span></param>
        <summary><span data-ttu-id="08401-990">将目录从一个位置移动到另一个。</span><span class="sxs-lookup"><span data-stu-id="08401-990">Moves a directory from one location to another.</span></span></summary>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="08401-991">如果尝试将移动一个目录不存在的目录，将创建目标结构。</span><span class="sxs-lookup"><span data-stu-id="08401-991">If an attempt is made to move a directory inside a directory that does not exist, the target structure will be created.</span></span>  
  
   
  
## Examples  
 <span data-ttu-id="08401-992">此示例将移动`Directory1`内`Directory2`。</span><span class="sxs-lookup"><span data-stu-id="08401-992">This example moves `Directory1` inside `Directory2`.</span></span>  
  
 [!code-vb[VbVbcnMyFileSystem#81](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbcnMyFileSystem/VB/Class1.vb#81)]  
  
 <span data-ttu-id="08401-993">此示例将移动`Directory1`内`Directory2`，如果它已存在，则覆盖该目录。</span><span class="sxs-lookup"><span data-stu-id="08401-993">This example moves `Directory1` inside `Directory2`, overwriting the directory if it already exists.</span></span>  
  
 [!code-vb[VbVbcnMyFileSystem#82](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbcnMyFileSystem/VB/Class1.vb#82)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentException"><span data-ttu-id="08401-994">路径由于以下原因之一无效：是零长度字符串；仅为空白；包含无效字符；是一个设备路径（以 \\\\.\\ 开头）。</span><span class="sxs-lookup"><span data-stu-id="08401-994">The path is not valid for one of the following reasons: it is a zero-length string; it contains only white space; it contains invalid characters; or it is a device path (starts with \\\\.\\).</span></span></exception>
        <exception cref="T:System.ArgumentNullException"><span data-ttu-id="08401-995"><paramref name="sourceDirectoryName" /> 或<paramref name="destinationDirectoryName" />是<see langword="Nothing" />或空字符串。</span><span class="sxs-lookup"><span data-stu-id="08401-995"><paramref name="sourceDirectoryName" /> or <paramref name="destinationDirectoryName" /> is <see langword="Nothing" /> or an empty string.</span></span></exception>
        <exception cref="T:System.IO.DirectoryNotFoundException"><span data-ttu-id="08401-996">目录不存在。</span><span class="sxs-lookup"><span data-stu-id="08401-996">The directory does not exist.</span></span></exception>
        <exception cref="T:System.IO.IOException"><span data-ttu-id="08401-997">目标目录已存在，并且 <paramref name="overwrite" /> 设置为 <see langword="False" />。</span><span class="sxs-lookup"><span data-stu-id="08401-997">The target directory already exists and <paramref name="overwrite" /> is set to <see langword="False" />.</span></span></exception>
        <exception cref="T:System.IO.PathTooLongException"><span data-ttu-id="08401-998">路径超过系统定义的最大长度。</span><span class="sxs-lookup"><span data-stu-id="08401-998">The path exceeds the system-defined maximum length.</span></span></exception>
        <exception cref="T:System.InvalidOperationException"><span data-ttu-id="08401-999">该操作是循环的。</span><span class="sxs-lookup"><span data-stu-id="08401-999">The operation is cyclic.</span></span></exception>
        <exception cref="T:System.NotSupportedException"><span data-ttu-id="08401-1000">在路径中的文件或目录名称包含冒号 （:），或格式无效。</span><span class="sxs-lookup"><span data-stu-id="08401-1000">A file or directory name in the path contains a colon (:) or is in an invalid format.</span></span></exception>
        <exception cref="T:System.Security.SecurityException"><span data-ttu-id="08401-1001">该用户缺少必要的权限查看该路径。</span><span class="sxs-lookup"><span data-stu-id="08401-1001">The user lacks necessary permissions to view the path.</span></span></exception>
        <exception cref="T:System.UnauthorizedAccessException"><span data-ttu-id="08401-1002">用户没有所需的权限。</span><span class="sxs-lookup"><span data-stu-id="08401-1002">The user does not have required permission.</span></span></exception>
        <permission cref="T:System.Security.Permissions.FileIOPermission"><span data-ttu-id="08401-1003">控制文件和文件夹的访问权限。</span><span class="sxs-lookup"><span data-stu-id="08401-1003">Controls the ability to access files and folders.</span></span> <span data-ttu-id="08401-1004">关联枚举： <see cref="F:System.Security.Permissions.PermissionState.Unrestricted" />。</span><span class="sxs-lookup"><span data-stu-id="08401-1004">Associated enumeration: <see cref="F:System.Security.Permissions.PermissionState.Unrestricted" />.</span></span></permission>
        <altmember cref="M:Microsoft.VisualBasic.MyServices.FileSystemProxy.MoveFile(System.String,System.String)" />
        <altmember cref="M:Microsoft.VisualBasic.MyServices.FileSystemProxy.CopyDirectory(System.String,System.String)" />
        <related type="Article" href="~/docs/visual-basic/language-reference/objects/index.md"><span data-ttu-id="08401-1005">对象 (Visual Basic)</span><span class="sxs-lookup"><span data-stu-id="08401-1005">Objects (Visual Basic)</span></span></related>
        <related type="Article" href="~/docs/visual-basic/developing-apps/programming/drives-directories-files/creating-deleting-and-moving-files-and-directories.md"><span data-ttu-id="08401-1006">创建、删除和移动文件和目录 (Visual Basic)</span><span class="sxs-lookup"><span data-stu-id="08401-1006">Creating, Deleting, and Moving Files and Directories in Visual Basic</span></span></related>
      </Docs>
    </Member>
    <Member MemberName="MoveDirectory">
      <MemberSignature Language="C#" Value="public void MoveDirectory (string sourceDirectoryName, string destinationDirectoryName, Microsoft.VisualBasic.FileIO.UIOption showUI, Microsoft.VisualBasic.FileIO.UICancelOption onUserCancel);" />
      <MemberSignature Language="ILAsm" Value=".method public instance void MoveDirectory(string sourceDirectoryName, string destinationDirectoryName, valuetype Microsoft.VisualBasic.FileIO.UIOption showUI, valuetype Microsoft.VisualBasic.FileIO.UICancelOption onUserCancel) cil managed" />
      <MemberSignature Language="DocId" Value="M:Microsoft.VisualBasic.MyServices.FileSystemProxy.MoveDirectory(System.String,System.String,Microsoft.VisualBasic.FileIO.UIOption,Microsoft.VisualBasic.FileIO.UICancelOption)" />
      <MemberSignature Language="VB.NET" Value="Public Sub MoveDirectory (sourceDirectoryName As String, destinationDirectoryName As String, showUI As UIOption, onUserCancel As UICancelOption)" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; void MoveDirectory(System::String ^ sourceDirectoryName, System::String ^ destinationDirectoryName, Microsoft::VisualBasic::FileIO::UIOption showUI, Microsoft::VisualBasic::FileIO::UICancelOption onUserCancel);" />
      <MemberSignature Language="F#" Value="member this.MoveDirectory : string * string * Microsoft.VisualBasic.FileIO.UIOption * Microsoft.VisualBasic.FileIO.UICancelOption -&gt; unit" Usage="fileSystemProxy.MoveDirectory (sourceDirectoryName, destinationDirectoryName, showUI, onUserCancel)" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>Microsoft.VisualBasic</AssemblyName>
        <AssemblyVersion>8.0.0.0</AssemblyVersion>
        <AssemblyVersion>10.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <AssemblyInfo>
        <AssemblyName>Microsoft.VisualBasic.Core</AssemblyName>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Void</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="sourceDirectoryName" Type="System.String" Index="0" FrameworkAlternate="netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;netframework-4.8" />
        <Parameter Name="destinationDirectoryName" Type="System.String" Index="1" FrameworkAlternate="netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;netframework-4.8" />
        <Parameter Name="showUI" Type="Microsoft.VisualBasic.FileIO.UIOption" Index="2" FrameworkAlternate="netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;netframework-4.8" />
        <Parameter Name="onUserCancel" Type="Microsoft.VisualBasic.FileIO.UICancelOption" Index="3" FrameworkAlternate="netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;netframework-4.8" />
      </Parameters>
      <Docs>
        <param name="sourceDirectoryName"><span data-ttu-id="08401-1007">要移动的目录的路径。</span><span class="sxs-lookup"><span data-stu-id="08401-1007">Path of the directory to be moved.</span></span></param>
        <param name="destinationDirectoryName"><span data-ttu-id="08401-1008">源目录移到其中的目录路径。</span><span class="sxs-lookup"><span data-stu-id="08401-1008">Path of the directory to which the source directory is being moved.</span></span></param>
        <param name="showUI"><span data-ttu-id="08401-1009">指定是否操作的进度进行可视跟踪。</span><span class="sxs-lookup"><span data-stu-id="08401-1009">Specifies whether to visually track the operation's progress.</span></span> <span data-ttu-id="08401-1010">默认值为 <see langword="UIOption.OnlyErrorDialogs" />。</span><span class="sxs-lookup"><span data-stu-id="08401-1010">Default is <see langword="UIOption.OnlyErrorDialogs" />.</span></span></param>
        <param name="onUserCancel"><span data-ttu-id="08401-1011">指定当用户取消了操作时引发异常。</span><span class="sxs-lookup"><span data-stu-id="08401-1011">Specifies whether or not an exception is thrown when the user cancels the operation.</span></span> <span data-ttu-id="08401-1012">默认值为 <see langword="UICancelOption.ThrowException" />。</span><span class="sxs-lookup"><span data-stu-id="08401-1012">Default is <see langword="UICancelOption.ThrowException" />.</span></span></param>
        <summary><span data-ttu-id="08401-1013">将目录从一个位置移动到另一个。</span><span class="sxs-lookup"><span data-stu-id="08401-1013">Moves a directory from one location to another.</span></span></summary>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="08401-1014">如果尝试将移动一个目录不存在的目录，将创建目标结构。</span><span class="sxs-lookup"><span data-stu-id="08401-1014">If an attempt is made to move a directory inside a directory that does not exist, the target structure will be created.</span></span>  
  
   
  
## Examples  
 <span data-ttu-id="08401-1015">此示例将移动`Directory1`内`Directory2`。</span><span class="sxs-lookup"><span data-stu-id="08401-1015">This example moves `Directory1` inside `Directory2`.</span></span>  
  
 [!code-vb[VbVbcnMyFileSystem#81](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbcnMyFileSystem/VB/Class1.vb#81)]  
  
 <span data-ttu-id="08401-1016">此示例将移动`Directory1`内`Directory2`，如果它已存在，则覆盖该目录。</span><span class="sxs-lookup"><span data-stu-id="08401-1016">This example moves `Directory1` inside `Directory2`, overwriting the directory if it already exists.</span></span>  
  
 [!code-vb[VbVbcnMyFileSystem#82](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbcnMyFileSystem/VB/Class1.vb#82)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentException"><span data-ttu-id="08401-1017">路径由于以下原因之一无效：是零长度字符串；仅为空白；包含无效字符；是一个设备路径（以 \\\\.\\ 开头）。</span><span class="sxs-lookup"><span data-stu-id="08401-1017">The path is not valid for one of the following reasons: it is a zero-length string; it contains only white space; it contains invalid characters; or it is a device path (starts with \\\\.\\).</span></span></exception>
        <exception cref="T:System.ArgumentNullException"><span data-ttu-id="08401-1018"><paramref name="sourceDirectoryName" /> 或<paramref name="destinationDirectoryName" />是<see langword="Nothing" />或空字符串。</span><span class="sxs-lookup"><span data-stu-id="08401-1018"><paramref name="sourceDirectoryName" /> or <paramref name="destinationDirectoryName" /> is <see langword="Nothing" /> or an empty string.</span></span></exception>
        <exception cref="T:System.IO.DirectoryNotFoundException"><span data-ttu-id="08401-1019">目录不存在。</span><span class="sxs-lookup"><span data-stu-id="08401-1019">The directory does not exist.</span></span></exception>
        <exception cref="T:System.IO.IOException"><span data-ttu-id="08401-1020"><paramref name="onUserCancel" /> 设置为<see langword="ThrowException" />，无法复制子目录中的文件。</span><span class="sxs-lookup"><span data-stu-id="08401-1020"><paramref name="onUserCancel" /> is set to <see langword="ThrowException" /> and a subdirectory of the file cannot be copied.</span></span></exception>
        <exception cref="T:System.OperationCanceledException"><span data-ttu-id="08401-1021"><paramref name="onUserCancel" /> 设置为<see langword="ThrowException" />，并且用户取消了操作，或者不能完成操作。</span><span class="sxs-lookup"><span data-stu-id="08401-1021"><paramref name="onUserCancel" /> is set to <see langword="ThrowException" />, and the user cancels the operation, or the operation cannot be completed.</span></span></exception>
        <exception cref="T:System.Security.SecurityException"><span data-ttu-id="08401-1022">该用户缺少必要的权限查看该路径。</span><span class="sxs-lookup"><span data-stu-id="08401-1022">The user lacks necessary permissions to view the path.</span></span></exception>
        <exception cref="T:System.IO.PathTooLongException"><span data-ttu-id="08401-1023">路径超过系统定义的最大长度。</span><span class="sxs-lookup"><span data-stu-id="08401-1023">The path exceeds the system-defined maximum length.</span></span></exception>
        <exception cref="T:System.InvalidOperationException"><span data-ttu-id="08401-1024">该操作是循环的。</span><span class="sxs-lookup"><span data-stu-id="08401-1024">The operation is cyclic.</span></span></exception>
        <exception cref="T:System.NotSupportedException"><span data-ttu-id="08401-1025">在路径中的文件或目录名称包含冒号 （:），或格式无效。</span><span class="sxs-lookup"><span data-stu-id="08401-1025">A file or directory name in the path contains a colon (:) or is in an invalid format.</span></span></exception>
        <exception cref="T:System.UnauthorizedAccessException"><span data-ttu-id="08401-1026">用户没有所需的权限。</span><span class="sxs-lookup"><span data-stu-id="08401-1026">The user does not have required permission.</span></span></exception>
        <permission cref="T:System.Security.Permissions.FileIOPermission"><span data-ttu-id="08401-1027">控制文件和文件夹的访问权限。</span><span class="sxs-lookup"><span data-stu-id="08401-1027">Controls the ability to access files and folders.</span></span> <span data-ttu-id="08401-1028">关联枚举： <see cref="F:System.Security.Permissions.PermissionState.Unrestricted" />。</span><span class="sxs-lookup"><span data-stu-id="08401-1028">Associated enumeration: <see cref="F:System.Security.Permissions.PermissionState.Unrestricted" />.</span></span></permission>
        <permission cref="T:System.Security.Permissions.UIPermission"><span data-ttu-id="08401-1029">控制与用户界面和剪贴板相关的权限。</span><span class="sxs-lookup"><span data-stu-id="08401-1029">Controls the permissions related to user interfaces and the clipboard.</span></span> <span data-ttu-id="08401-1030">关联枚举： <see cref="F:System.Security.Permissions.UIPermissionWindow.SafeSubWindows" />。</span><span class="sxs-lookup"><span data-stu-id="08401-1030">Associated enumeration: <see cref="F:System.Security.Permissions.UIPermissionWindow.SafeSubWindows" />.</span></span></permission>
        <altmember cref="M:Microsoft.VisualBasic.MyServices.FileSystemProxy.MoveFile(System.String,System.String)" />
        <altmember cref="M:Microsoft.VisualBasic.MyServices.FileSystemProxy.CopyDirectory(System.String,System.String)" />
        <altmember cref="T:Microsoft.VisualBasic.FileIO.UIOption" />
        <altmember cref="T:Microsoft.VisualBasic.FileIO.UICancelOption" />
        <related type="Article" href="~/docs/visual-basic/language-reference/objects/index.md"><span data-ttu-id="08401-1031">对象 (Visual Basic)</span><span class="sxs-lookup"><span data-stu-id="08401-1031">Objects (Visual Basic)</span></span></related>
        <related type="Article" href="~/docs/visual-basic/developing-apps/programming/drives-directories-files/creating-deleting-and-moving-files-and-directories.md"><span data-ttu-id="08401-1032">创建、删除和移动文件和目录 (Visual Basic)</span><span class="sxs-lookup"><span data-stu-id="08401-1032">Creating, Deleting, and Moving Files and Directories in Visual Basic</span></span></related>
      </Docs>
    </Member>
    <MemberGroup MemberName="MoveFile">
      <AssemblyInfo>
        <AssemblyName>Microsoft.VisualBasic</AssemblyName>
        <AssemblyVersion>10.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Docs>
        <summary><span data-ttu-id="08401-1033">将文件移到新位置。</span><span class="sxs-lookup"><span data-stu-id="08401-1033">Moves a file to a new location.</span></span></summary>
      </Docs>
    </MemberGroup>
    <Member MemberName="MoveFile">
      <MemberSignature Language="C#" Value="public void MoveFile (string sourceFileName, string destinationFileName);" />
      <MemberSignature Language="ILAsm" Value=".method public instance void MoveFile(string sourceFileName, string destinationFileName) cil managed" />
      <MemberSignature Language="DocId" Value="M:Microsoft.VisualBasic.MyServices.FileSystemProxy.MoveFile(System.String,System.String)" />
      <MemberSignature Language="VB.NET" Value="Public Sub MoveFile (sourceFileName As String, destinationFileName As String)" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; void MoveFile(System::String ^ sourceFileName, System::String ^ destinationFileName);" />
      <MemberSignature Language="F#" Value="member this.MoveFile : string * string -&gt; unit" Usage="fileSystemProxy.MoveFile (sourceFileName, destinationFileName)" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>Microsoft.VisualBasic</AssemblyName>
        <AssemblyVersion>8.0.0.0</AssemblyVersion>
        <AssemblyVersion>10.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <AssemblyInfo>
        <AssemblyName>Microsoft.VisualBasic.Core</AssemblyName>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Void</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="sourceFileName" Type="System.String" Index="0" FrameworkAlternate="netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;netframework-4.8" />
        <Parameter Name="destinationFileName" Type="System.String" Index="1" FrameworkAlternate="netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;netframework-4.8" />
      </Parameters>
      <Docs>
        <param name="sourceFileName"><span data-ttu-id="08401-1034">要移动的文件的路径。</span><span class="sxs-lookup"><span data-stu-id="08401-1034">Path of the file to be moved.</span></span></param>
        <param name="destinationFileName"><span data-ttu-id="08401-1035">该文件应移入其中的目录路径。</span><span class="sxs-lookup"><span data-stu-id="08401-1035">Path of the directory into which the file should be moved.</span></span></param>
        <summary><span data-ttu-id="08401-1036">将文件移到新位置。</span><span class="sxs-lookup"><span data-stu-id="08401-1036">Moves a file to a new location.</span></span></summary>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="08401-1037">如果目标结构不存在，则创建它。</span><span class="sxs-lookup"><span data-stu-id="08401-1037">If the target structure does not exist, it is created.</span></span>  
  
 <span data-ttu-id="08401-1038">`MoveFile`方法保留 Ace （访问控制项） 仅当在移动文件同一个卷。</span><span class="sxs-lookup"><span data-stu-id="08401-1038">The `MoveFile` method preserves ACEs (Access Control Entries) only when moving the file within the same volume.</span></span> <span data-ttu-id="08401-1039">这包括成为直接移动 （直接 Ace 优先于继承的 Ace） 的 Ace 的继承的 Ace。</span><span class="sxs-lookup"><span data-stu-id="08401-1039">This includes inherited ACEs, which become direct ACEs when moved (direct ACEs take precedence over inherited ACEs).</span></span> <span data-ttu-id="08401-1040">如果卷之间移动文件，将不会复制 Ace。</span><span class="sxs-lookup"><span data-stu-id="08401-1040">If a file is moved between volumes, ACEs will not be copied.</span></span>  
  
 <span data-ttu-id="08401-1041">下表列出的任务涉及示例`My.Computer.FileSystem.MoveFile`方法。</span><span class="sxs-lookup"><span data-stu-id="08401-1041">The following table lists an example of a task involving the `My.Computer.FileSystem.MoveFile` method.</span></span>  
  
|<span data-ttu-id="08401-1042">功能</span><span class="sxs-lookup"><span data-stu-id="08401-1042">To</span></span>|<span data-ttu-id="08401-1043">查看</span><span class="sxs-lookup"><span data-stu-id="08401-1043">See</span></span>|  
|--------|---------|  
|<span data-ttu-id="08401-1044">移动文件</span><span class="sxs-lookup"><span data-stu-id="08401-1044">Move a file</span></span>|[<span data-ttu-id="08401-1045">如何：移动文件</span><span class="sxs-lookup"><span data-stu-id="08401-1045">How to: Move a File</span></span>](~/docs/visual-basic/developing-apps/programming/drives-directories-files/how-to-move-a-file.md)|  
  
   
  
## Examples  
 <span data-ttu-id="08401-1046">此示例会将文件移`Test.txt`从`TestDir1`到`TestDir2`。</span><span class="sxs-lookup"><span data-stu-id="08401-1046">This example moves the file `Test.txt` from `TestDir1` to `TestDir2`.</span></span>  
  
 [!code-vb[VbVbcnMyFileSystem#86](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbcnMyFileSystem/VB/Class1.vb#86)]  
  
 <span data-ttu-id="08401-1047">此示例会将文件移`Test.txt`从`TestDir1`到`TestDir2`并将其重命名`Test2.txt`。</span><span class="sxs-lookup"><span data-stu-id="08401-1047">This example moves the file `Test.txt` from `TestDir1` to `TestDir2` and renames it `Test2.txt`.</span></span>  
  
 [!code-vb[VbVbcnMyFileSystem#87](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbcnMyFileSystem/VB/Class1.vb#87)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentException"><span data-ttu-id="08401-1048">路径由于以下原因之一无效：是零长度字符串；仅为空白；包含无效字符；是一个设备路径（以 \\\\.\\ 开头）；以尾部反斜杠结尾。</span><span class="sxs-lookup"><span data-stu-id="08401-1048">The path is not valid for one of the following reasons: it is a zero-length string; it contains only white space; it contains invalid characters; or it is a device path (starts with \\\\.\\); it ends with a trailing slash.</span></span></exception>
        <exception cref="T:System.ArgumentNullException"><span data-ttu-id="08401-1049"><paramref name="destinationFileName" /> 为 <see langword="Nothing" /> 或空字符串。</span><span class="sxs-lookup"><span data-stu-id="08401-1049"><paramref name="destinationFileName" /> is <see langword="Nothing" /> or an empty string.</span></span></exception>
        <exception cref="T:System.IO.FileNotFoundException"><span data-ttu-id="08401-1050">源文件无效或不存在。</span><span class="sxs-lookup"><span data-stu-id="08401-1050">The source file is not valid or does not exist.</span></span></exception>
        <exception cref="T:System.IO.IOException"><span data-ttu-id="08401-1051">文件正由另一个进程使用或者出现 I/O 错误。</span><span class="sxs-lookup"><span data-stu-id="08401-1051">The file is in use by another process, or an I/O error occurs.</span></span></exception>
        <exception cref="T:System.IO.PathTooLongException"><span data-ttu-id="08401-1052">路径超过系统定义的最大长度。</span><span class="sxs-lookup"><span data-stu-id="08401-1052">The path exceeds the system-defined maximum length.</span></span></exception>
        <exception cref="T:System.NotSupportedException"><span data-ttu-id="08401-1053">在路径中的文件或目录名称包含冒号 （:），或格式无效。</span><span class="sxs-lookup"><span data-stu-id="08401-1053">A file or directory name in the path contains a colon (:) or is in an invalid format.</span></span></exception>
        <exception cref="T:System.Security.SecurityException"><span data-ttu-id="08401-1054">该用户缺少必要的权限查看该路径。</span><span class="sxs-lookup"><span data-stu-id="08401-1054">The user lacks necessary permissions to view the path.</span></span></exception>
        <permission cref="T:System.Security.Permissions.EnvironmentPermission"><span data-ttu-id="08401-1055">控制可以访问所有环境变量。</span><span class="sxs-lookup"><span data-stu-id="08401-1055">Controls the ability to access all environment variables.</span></span> <span data-ttu-id="08401-1056">关联枚举： <see cref="F:System.Security.Permissions.PermissionState.Unrestricted" />。</span><span class="sxs-lookup"><span data-stu-id="08401-1056">Associated enumeration: <see cref="F:System.Security.Permissions.PermissionState.Unrestricted" />.</span></span></permission>
        <permission cref="T:System.Security.Permissions.FileIOPermission"><span data-ttu-id="08401-1057">控制文件和文件夹的访问权限。</span><span class="sxs-lookup"><span data-stu-id="08401-1057">Controls the ability to access files and folders.</span></span> <span data-ttu-id="08401-1058">关联枚举： <see cref="F:System.Security.Permissions.PermissionState.Unrestricted" />。</span><span class="sxs-lookup"><span data-stu-id="08401-1058">Associated enumeration: <see cref="F:System.Security.Permissions.PermissionState.Unrestricted" />.</span></span></permission>
        <permission cref="T:System.Security.Permissions.RegistryPermission"><span data-ttu-id="08401-1059">控制访问注册表变量的能力。</span><span class="sxs-lookup"><span data-stu-id="08401-1059">Controls the ability to access registry variables.</span></span> <span data-ttu-id="08401-1060">关联枚举： <see cref="F:System.Security.Permissions.PermissionState.Unrestricted" />。</span><span class="sxs-lookup"><span data-stu-id="08401-1060">Associated enumeration: <see cref="F:System.Security.Permissions.PermissionState.Unrestricted" />.</span></span></permission>
        <related type="Article" href="~/docs/visual-basic/language-reference/objects/index.md"><span data-ttu-id="08401-1061">对象 (Visual Basic)</span><span class="sxs-lookup"><span data-stu-id="08401-1061">Objects (Visual Basic)</span></span></related>
        <related type="Article" href="~/docs/visual-basic/developing-apps/programming/drives-directories-files/creating-deleting-and-moving-files-and-directories.md"><span data-ttu-id="08401-1062">创建、删除和移动文件和目录 (Visual Basic)</span><span class="sxs-lookup"><span data-stu-id="08401-1062">Creating, Deleting, and Moving Files and Directories in Visual Basic</span></span></related>
      </Docs>
    </Member>
    <Member MemberName="MoveFile">
      <MemberSignature Language="C#" Value="public void MoveFile (string sourceFileName, string destinationFileName, Microsoft.VisualBasic.FileIO.UIOption showUI);" />
      <MemberSignature Language="ILAsm" Value=".method public instance void MoveFile(string sourceFileName, string destinationFileName, valuetype Microsoft.VisualBasic.FileIO.UIOption showUI) cil managed" />
      <MemberSignature Language="DocId" Value="M:Microsoft.VisualBasic.MyServices.FileSystemProxy.MoveFile(System.String,System.String,Microsoft.VisualBasic.FileIO.UIOption)" />
      <MemberSignature Language="VB.NET" Value="Public Sub MoveFile (sourceFileName As String, destinationFileName As String, showUI As UIOption)" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; void MoveFile(System::String ^ sourceFileName, System::String ^ destinationFileName, Microsoft::VisualBasic::FileIO::UIOption showUI);" />
      <MemberSignature Language="F#" Value="member this.MoveFile : string * string * Microsoft.VisualBasic.FileIO.UIOption -&gt; unit" Usage="fileSystemProxy.MoveFile (sourceFileName, destinationFileName, showUI)" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>Microsoft.VisualBasic</AssemblyName>
        <AssemblyVersion>8.0.0.0</AssemblyVersion>
        <AssemblyVersion>10.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <AssemblyInfo>
        <AssemblyName>Microsoft.VisualBasic.Core</AssemblyName>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Void</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="sourceFileName" Type="System.String" Index="0" FrameworkAlternate="netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;netframework-4.8" />
        <Parameter Name="destinationFileName" Type="System.String" Index="1" FrameworkAlternate="netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;netframework-4.8" />
        <Parameter Name="showUI" Type="Microsoft.VisualBasic.FileIO.UIOption" Index="2" FrameworkAlternate="netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;netframework-4.8" />
      </Parameters>
      <Docs>
        <param name="sourceFileName"><span data-ttu-id="08401-1063">要移动的文件的路径。</span><span class="sxs-lookup"><span data-stu-id="08401-1063">Path of the file to be moved.</span></span></param>
        <param name="destinationFileName"><span data-ttu-id="08401-1064">该文件应移入其中的目录路径。</span><span class="sxs-lookup"><span data-stu-id="08401-1064">Path of the directory into which the file should be moved.</span></span></param>
        <param name="showUI"><span data-ttu-id="08401-1065">指定是否操作的进度进行可视跟踪。</span><span class="sxs-lookup"><span data-stu-id="08401-1065">Specifies whether to visually track the operation's progress.</span></span> <span data-ttu-id="08401-1066">默认值为 <see langword="UIOption.OnlyErrorDialogs" />。</span><span class="sxs-lookup"><span data-stu-id="08401-1066">Default is <see langword="UIOption.OnlyErrorDialogs" />.</span></span></param>
        <summary><span data-ttu-id="08401-1067">将文件移到新位置。</span><span class="sxs-lookup"><span data-stu-id="08401-1067">Moves a file to a new location.</span></span></summary>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="08401-1068">如果目标结构不存在，则创建它。</span><span class="sxs-lookup"><span data-stu-id="08401-1068">If the target structure does not exist, it is created.</span></span>  
  
 <span data-ttu-id="08401-1069">`MoveFile`方法保留 Ace （访问控制项） 仅当在移动文件同一个卷。</span><span class="sxs-lookup"><span data-stu-id="08401-1069">The `MoveFile` method preserves ACEs (Access Control Entries) only when moving the file within the same volume.</span></span> <span data-ttu-id="08401-1070">这包括成为直接移动 （直接 Ace 优先于继承的 Ace） 的 Ace 的继承的 Ace。</span><span class="sxs-lookup"><span data-stu-id="08401-1070">This includes inherited ACEs, which become direct ACEs when moved (direct ACEs take precedence over inherited ACEs).</span></span> <span data-ttu-id="08401-1071">如果卷之间移动文件，将不会复制 Ace。</span><span class="sxs-lookup"><span data-stu-id="08401-1071">If a file is moved between volumes, ACEs will not be copied.</span></span>  
  
 <span data-ttu-id="08401-1072">下表列出的任务涉及示例`My.Computer.FileSystem.MoveFile`方法。</span><span class="sxs-lookup"><span data-stu-id="08401-1072">The following table lists an example of a task involving the `My.Computer.FileSystem.MoveFile` method.</span></span>  
  
|<span data-ttu-id="08401-1073">功能</span><span class="sxs-lookup"><span data-stu-id="08401-1073">To</span></span>|<span data-ttu-id="08401-1074">查看</span><span class="sxs-lookup"><span data-stu-id="08401-1074">See</span></span>|  
|--------|---------|  
|<span data-ttu-id="08401-1075">移动文件</span><span class="sxs-lookup"><span data-stu-id="08401-1075">Move a file</span></span>|[<span data-ttu-id="08401-1076">如何：移动文件</span><span class="sxs-lookup"><span data-stu-id="08401-1076">How to: Move a File</span></span>](~/docs/visual-basic/developing-apps/programming/drives-directories-files/how-to-move-a-file.md)|  
  
   
  
## Examples  
 <span data-ttu-id="08401-1077">此示例会将文件移`Test.txt`从`TestDir1`到`TestDir2`。</span><span class="sxs-lookup"><span data-stu-id="08401-1077">This example moves the file `Test.txt` from `TestDir1` to `TestDir2`.</span></span>  
  
 [!code-vb[VbVbcnMyFileSystem#86](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbcnMyFileSystem/VB/Class1.vb#86)]  
  
 <span data-ttu-id="08401-1078">此示例会将文件移`Test.txt`从`TestDir1`到`TestDir2`并将其重命名`Test2.txt`。</span><span class="sxs-lookup"><span data-stu-id="08401-1078">This example moves the file `Test.txt` from `TestDir1` to `TestDir2` and renames it `Test2.txt`.</span></span>  
  
 [!code-vb[VbVbcnMyFileSystem#87](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbcnMyFileSystem/VB/Class1.vb#87)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentException"><span data-ttu-id="08401-1079">路径由于以下原因之一无效：是零长度字符串；仅为空白；包含无效字符；是一个设备路径（以 \\\\.\\ 开头）；以尾部反斜杠结尾。</span><span class="sxs-lookup"><span data-stu-id="08401-1079">The path is not valid for one of the following reasons: it is a zero-length string; it contains only white space; it contains invalid characters; or it is a device path (starts with \\\\.\\); it ends with a trailing slash.</span></span></exception>
        <exception cref="T:System.ArgumentNullException"><span data-ttu-id="08401-1080"><paramref name="destinationFileName" /> 为 <see langword="Nothing" /> 或空字符串。</span><span class="sxs-lookup"><span data-stu-id="08401-1080"><paramref name="destinationFileName" /> is <see langword="Nothing" /> or an empty string.</span></span></exception>
        <exception cref="T:System.IO.FileNotFoundException"><span data-ttu-id="08401-1081">源文件无效或不存在。</span><span class="sxs-lookup"><span data-stu-id="08401-1081">The source file is not valid or does not exist.</span></span></exception>
        <exception cref="T:System.IO.IOException"><span data-ttu-id="08401-1082">文件正由另一个进程使用或者出现 I/O 错误。</span><span class="sxs-lookup"><span data-stu-id="08401-1082">The file is in use by another process, or an I/O error occurs.</span></span></exception>
        <exception cref="T:System.IO.PathTooLongException"><span data-ttu-id="08401-1083">路径超过系统定义的最大长度。</span><span class="sxs-lookup"><span data-stu-id="08401-1083">The path exceeds the system-defined maximum length.</span></span></exception>
        <exception cref="T:System.NotSupportedException"><span data-ttu-id="08401-1084">在路径中的文件或目录名称包含冒号 （:），或格式无效。</span><span class="sxs-lookup"><span data-stu-id="08401-1084">A file or directory name in the path contains a colon (:) or is in an invalid format.</span></span></exception>
        <exception cref="T:System.Security.SecurityException"><span data-ttu-id="08401-1085">该用户缺少必要的权限查看该路径。</span><span class="sxs-lookup"><span data-stu-id="08401-1085">The user lacks necessary permissions to view the path.</span></span></exception>
        <permission cref="T:System.Security.Permissions.EnvironmentPermission"><span data-ttu-id="08401-1086">控制可以访问所有环境变量。</span><span class="sxs-lookup"><span data-stu-id="08401-1086">Controls the ability to access all environment variables.</span></span> <span data-ttu-id="08401-1087">关联枚举： <see cref="F:System.Security.Permissions.PermissionState.Unrestricted" />。</span><span class="sxs-lookup"><span data-stu-id="08401-1087">Associated enumeration: <see cref="F:System.Security.Permissions.PermissionState.Unrestricted" />.</span></span></permission>
        <permission cref="T:System.Security.Permissions.FileIOPermission"><span data-ttu-id="08401-1088">控制文件和文件夹的访问权限。</span><span class="sxs-lookup"><span data-stu-id="08401-1088">Controls the ability to access files and folders.</span></span> <span data-ttu-id="08401-1089">关联枚举： <see cref="F:System.Security.Permissions.PermissionState.Unrestricted" />。</span><span class="sxs-lookup"><span data-stu-id="08401-1089">Associated enumeration: <see cref="F:System.Security.Permissions.PermissionState.Unrestricted" />.</span></span></permission>
        <permission cref="T:System.Security.Permissions.RegistryPermission"><span data-ttu-id="08401-1090">控制访问注册表变量的能力。</span><span class="sxs-lookup"><span data-stu-id="08401-1090">Controls the ability to access registry variables.</span></span> <span data-ttu-id="08401-1091">关联枚举： <see cref="F:System.Security.Permissions.PermissionState.Unrestricted" />。</span><span class="sxs-lookup"><span data-stu-id="08401-1091">Associated enumeration: <see cref="F:System.Security.Permissions.PermissionState.Unrestricted" />.</span></span></permission>
        <permission cref="T:System.Security.Permissions.UIPermission"><span data-ttu-id="08401-1092">控制与用户界面和剪贴板相关的权限。</span><span class="sxs-lookup"><span data-stu-id="08401-1092">Controls the permissions related to user interfaces and the clipboard.</span></span> <span data-ttu-id="08401-1093">关联枚举： <see cref="F:System.Security.Permissions.UIPermissionWindow.SafeSubWindows" />。</span><span class="sxs-lookup"><span data-stu-id="08401-1093">Associated enumeration: <see cref="F:System.Security.Permissions.UIPermissionWindow.SafeSubWindows" />.</span></span></permission>
        <altmember cref="T:Microsoft.VisualBasic.FileIO.UIOption" />
        <related type="Article" href="~/docs/visual-basic/language-reference/objects/index.md"><span data-ttu-id="08401-1094">对象 (Visual Basic)</span><span class="sxs-lookup"><span data-stu-id="08401-1094">Objects (Visual Basic)</span></span></related>
        <related type="Article" href="~/docs/visual-basic/developing-apps/programming/drives-directories-files/creating-deleting-and-moving-files-and-directories.md"><span data-ttu-id="08401-1095">创建、删除和移动文件和目录 (Visual Basic)</span><span class="sxs-lookup"><span data-stu-id="08401-1095">Creating, Deleting, and Moving Files and Directories in Visual Basic</span></span></related>
      </Docs>
    </Member>
    <Member MemberName="MoveFile">
      <MemberSignature Language="C#" Value="public void MoveFile (string sourceFileName, string destinationFileName, bool overwrite);" />
      <MemberSignature Language="ILAsm" Value=".method public instance void MoveFile(string sourceFileName, string destinationFileName, bool overwrite) cil managed" />
      <MemberSignature Language="DocId" Value="M:Microsoft.VisualBasic.MyServices.FileSystemProxy.MoveFile(System.String,System.String,System.Boolean)" />
      <MemberSignature Language="VB.NET" Value="Public Sub MoveFile (sourceFileName As String, destinationFileName As String, overwrite As Boolean)" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; void MoveFile(System::String ^ sourceFileName, System::String ^ destinationFileName, bool overwrite);" />
      <MemberSignature Language="F#" Value="member this.MoveFile : string * string * bool -&gt; unit" Usage="fileSystemProxy.MoveFile (sourceFileName, destinationFileName, overwrite)" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>Microsoft.VisualBasic</AssemblyName>
        <AssemblyVersion>8.0.0.0</AssemblyVersion>
        <AssemblyVersion>10.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <AssemblyInfo>
        <AssemblyName>Microsoft.VisualBasic.Core</AssemblyName>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Void</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="sourceFileName" Type="System.String" Index="0" FrameworkAlternate="netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;netframework-4.8" />
        <Parameter Name="destinationFileName" Type="System.String" Index="1" FrameworkAlternate="netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;netframework-4.8" />
        <Parameter Name="overwrite" Type="System.Boolean" Index="2" FrameworkAlternate="netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;netframework-4.8" />
      </Parameters>
      <Docs>
        <param name="sourceFileName"><span data-ttu-id="08401-1096">要移动的文件的路径。</span><span class="sxs-lookup"><span data-stu-id="08401-1096">Path of the file to be moved.</span></span></param>
        <param name="destinationFileName"><span data-ttu-id="08401-1097">该文件应移入其中的目录路径。</span><span class="sxs-lookup"><span data-stu-id="08401-1097">Path of the directory into which the file should be moved.</span></span></param>
        <param name="overwrite"><span data-ttu-id="08401-1098"><see langword="True" /> 若要覆盖现有文件;否则为<see langword="False" />。</span><span class="sxs-lookup"><span data-stu-id="08401-1098"><see langword="True" /> to overwrite existing files; otherwise <see langword="False" />.</span></span> <span data-ttu-id="08401-1099">默认值为 <see langword="False" />。</span><span class="sxs-lookup"><span data-stu-id="08401-1099">Default is <see langword="False" />.</span></span></param>
        <summary><span data-ttu-id="08401-1100">将文件移到新位置。</span><span class="sxs-lookup"><span data-stu-id="08401-1100">Moves a file to a new location.</span></span></summary>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="08401-1101">如果目标结构不存在，则创建它。</span><span class="sxs-lookup"><span data-stu-id="08401-1101">If the target structure does not exist, it is created.</span></span>  
  
 <span data-ttu-id="08401-1102">`MoveFile`方法保留 Ace （访问控制项） 仅当在移动文件同一个卷。</span><span class="sxs-lookup"><span data-stu-id="08401-1102">The `MoveFile` method preserves ACEs (Access Control Entries) only when moving the file within the same volume.</span></span> <span data-ttu-id="08401-1103">这包括成为直接移动 （直接 Ace 优先于继承的 Ace） 的 Ace 的继承的 Ace。</span><span class="sxs-lookup"><span data-stu-id="08401-1103">This includes inherited ACEs, which become direct ACEs when moved (direct ACEs take precedence over inherited ACEs).</span></span> <span data-ttu-id="08401-1104">如果卷之间移动文件，将不会复制 Ace。</span><span class="sxs-lookup"><span data-stu-id="08401-1104">If a file is moved between volumes, ACEs will not be copied.</span></span>  
  
 <span data-ttu-id="08401-1105">下表列出了任务涉及的一个例子`My.Computer.FileSystem.MoveFile`方法。</span><span class="sxs-lookup"><span data-stu-id="08401-1105">The following table lists an examples of a task involving the `My.Computer.FileSystem.MoveFile` method.</span></span>  
  
|<span data-ttu-id="08401-1106">功能</span><span class="sxs-lookup"><span data-stu-id="08401-1106">To</span></span>|<span data-ttu-id="08401-1107">查看</span><span class="sxs-lookup"><span data-stu-id="08401-1107">See</span></span>|  
|--------|---------|  
|<span data-ttu-id="08401-1108">移动文件</span><span class="sxs-lookup"><span data-stu-id="08401-1108">Move a file</span></span>|[<span data-ttu-id="08401-1109">如何：移动文件</span><span class="sxs-lookup"><span data-stu-id="08401-1109">How to: Move a File</span></span>](~/docs/visual-basic/developing-apps/programming/drives-directories-files/how-to-move-a-file.md)|  
  
   
  
## Examples  
 <span data-ttu-id="08401-1110">此示例会将文件移`Test.txt`从`TestDir1`到`TestDir2`。</span><span class="sxs-lookup"><span data-stu-id="08401-1110">This example moves the file `Test.txt` from `TestDir1` to `TestDir2`.</span></span>  
  
 [!code-vb[VbVbcnMyFileSystem#86](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbcnMyFileSystem/VB/Class1.vb#86)]  
  
 <span data-ttu-id="08401-1111">此示例会将文件移`Test.txt`从`TestDir1`到`TestDir2`并将其重命名`Test2.txt`。</span><span class="sxs-lookup"><span data-stu-id="08401-1111">This example moves the file `Test.txt` from `TestDir1` to `TestDir2` and renames it `Test2.txt`.</span></span>  
  
 [!code-vb[VbVbcnMyFileSystem#87](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbcnMyFileSystem/VB/Class1.vb#87)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentException"><span data-ttu-id="08401-1112">路径由于以下原因之一无效：是零长度字符串；仅为空白；包含无效字符；是一个设备路径（以 \\\\.\\ 开头）；以尾部反斜杠结尾。</span><span class="sxs-lookup"><span data-stu-id="08401-1112">The path is not valid for one of the following reasons: it is a zero-length string; it contains only white space; it contains invalid characters; or it is a device path (starts with \\\\.\\); it ends with a trailing slash.</span></span></exception>
        <exception cref="T:System.ArgumentNullException"><span data-ttu-id="08401-1113"><paramref name="destinationFileName" /> 为 <see langword="Nothing" /> 或空字符串。</span><span class="sxs-lookup"><span data-stu-id="08401-1113"><paramref name="destinationFileName" /> is <see langword="Nothing" /> or an empty string.</span></span></exception>
        <exception cref="T:System.IO.FileNotFoundException"><span data-ttu-id="08401-1114">源文件无效或不存在。</span><span class="sxs-lookup"><span data-stu-id="08401-1114">The source file is not valid or does not exist.</span></span></exception>
        <exception cref="T:System.IO.IOException"><span data-ttu-id="08401-1115">文件正由另一个进程使用或者出现 I/O 错误。</span><span class="sxs-lookup"><span data-stu-id="08401-1115">The file is in use by another process, or an I/O error occurs.</span></span></exception>
        <exception cref="T:System.IO.PathTooLongException"><span data-ttu-id="08401-1116">路径超过系统定义的最大长度。</span><span class="sxs-lookup"><span data-stu-id="08401-1116">The path exceeds the system-defined maximum length.</span></span></exception>
        <exception cref="T:System.NotSupportedException"><span data-ttu-id="08401-1117">在路径中的文件或目录名称包含冒号 （:），或格式无效。</span><span class="sxs-lookup"><span data-stu-id="08401-1117">A file or directory name in the path contains a colon (:) or is in an invalid format.</span></span></exception>
        <exception cref="T:System.Security.SecurityException"><span data-ttu-id="08401-1118">该用户缺少必要的权限查看该路径。</span><span class="sxs-lookup"><span data-stu-id="08401-1118">The user lacks necessary permissions to view the path.</span></span></exception>
        <permission cref="T:System.Security.Permissions.EnvironmentPermission"><span data-ttu-id="08401-1119">控制可以访问所有环境变量。</span><span class="sxs-lookup"><span data-stu-id="08401-1119">Controls the ability to access all environment variables.</span></span> <span data-ttu-id="08401-1120">关联枚举： <see cref="F:System.Security.Permissions.PermissionState.Unrestricted" />。</span><span class="sxs-lookup"><span data-stu-id="08401-1120">Associated enumeration: <see cref="F:System.Security.Permissions.PermissionState.Unrestricted" />.</span></span></permission>
        <permission cref="T:System.Security.Permissions.FileIOPermission"><span data-ttu-id="08401-1121">控制文件和文件夹的访问权限。</span><span class="sxs-lookup"><span data-stu-id="08401-1121">Controls the ability to access files and folders.</span></span> <span data-ttu-id="08401-1122">关联枚举： <see cref="F:System.Security.Permissions.PermissionState.Unrestricted" />。</span><span class="sxs-lookup"><span data-stu-id="08401-1122">Associated enumeration: <see cref="F:System.Security.Permissions.PermissionState.Unrestricted" />.</span></span></permission>
        <permission cref="T:System.Security.Permissions.RegistryPermission"><span data-ttu-id="08401-1123">控制访问注册表变量的能力。</span><span class="sxs-lookup"><span data-stu-id="08401-1123">Controls the ability to access registry variables.</span></span> <span data-ttu-id="08401-1124">关联枚举： <see cref="F:System.Security.Permissions.PermissionState.Unrestricted" />。</span><span class="sxs-lookup"><span data-stu-id="08401-1124">Associated enumeration: <see cref="F:System.Security.Permissions.PermissionState.Unrestricted" />.</span></span></permission>
        <related type="Article" href="~/docs/visual-basic/language-reference/objects/index.md"><span data-ttu-id="08401-1125">对象 (Visual Basic)</span><span class="sxs-lookup"><span data-stu-id="08401-1125">Objects (Visual Basic)</span></span></related>
        <related type="Article" href="~/docs/visual-basic/developing-apps/programming/drives-directories-files/creating-deleting-and-moving-files-and-directories.md"><span data-ttu-id="08401-1126">创建、删除和移动文件和目录 (Visual Basic)</span><span class="sxs-lookup"><span data-stu-id="08401-1126">Creating, Deleting, and Moving Files and Directories in Visual Basic</span></span></related>
      </Docs>
    </Member>
    <Member MemberName="MoveFile">
      <MemberSignature Language="C#" Value="public void MoveFile (string sourceFileName, string destinationFileName, Microsoft.VisualBasic.FileIO.UIOption showUI, Microsoft.VisualBasic.FileIO.UICancelOption onUserCancel);" />
      <MemberSignature Language="ILAsm" Value=".method public instance void MoveFile(string sourceFileName, string destinationFileName, valuetype Microsoft.VisualBasic.FileIO.UIOption showUI, valuetype Microsoft.VisualBasic.FileIO.UICancelOption onUserCancel) cil managed" />
      <MemberSignature Language="DocId" Value="M:Microsoft.VisualBasic.MyServices.FileSystemProxy.MoveFile(System.String,System.String,Microsoft.VisualBasic.FileIO.UIOption,Microsoft.VisualBasic.FileIO.UICancelOption)" />
      <MemberSignature Language="VB.NET" Value="Public Sub MoveFile (sourceFileName As String, destinationFileName As String, showUI As UIOption, onUserCancel As UICancelOption)" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; void MoveFile(System::String ^ sourceFileName, System::String ^ destinationFileName, Microsoft::VisualBasic::FileIO::UIOption showUI, Microsoft::VisualBasic::FileIO::UICancelOption onUserCancel);" />
      <MemberSignature Language="F#" Value="member this.MoveFile : string * string * Microsoft.VisualBasic.FileIO.UIOption * Microsoft.VisualBasic.FileIO.UICancelOption -&gt; unit" Usage="fileSystemProxy.MoveFile (sourceFileName, destinationFileName, showUI, onUserCancel)" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>Microsoft.VisualBasic</AssemblyName>
        <AssemblyVersion>8.0.0.0</AssemblyVersion>
        <AssemblyVersion>10.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <AssemblyInfo>
        <AssemblyName>Microsoft.VisualBasic.Core</AssemblyName>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Void</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="sourceFileName" Type="System.String" Index="0" FrameworkAlternate="netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;netframework-4.8" />
        <Parameter Name="destinationFileName" Type="System.String" Index="1" FrameworkAlternate="netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;netframework-4.8" />
        <Parameter Name="showUI" Type="Microsoft.VisualBasic.FileIO.UIOption" Index="2" FrameworkAlternate="netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;netframework-4.8" />
        <Parameter Name="onUserCancel" Type="Microsoft.VisualBasic.FileIO.UICancelOption" Index="3" FrameworkAlternate="netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;netframework-4.8" />
      </Parameters>
      <Docs>
        <param name="sourceFileName"><span data-ttu-id="08401-1127">要移动的文件的路径。</span><span class="sxs-lookup"><span data-stu-id="08401-1127">Path of the file to be moved.</span></span></param>
        <param name="destinationFileName"><span data-ttu-id="08401-1128">该文件应移入其中的目录路径。</span><span class="sxs-lookup"><span data-stu-id="08401-1128">Path of the directory into which the file should be moved.</span></span></param>
        <param name="showUI"><span data-ttu-id="08401-1129">指定是否操作的进度进行可视跟踪。</span><span class="sxs-lookup"><span data-stu-id="08401-1129">Specifies whether to visually track the operation's progress.</span></span> <span data-ttu-id="08401-1130">默认值为 <see langword="UIOption.OnlyErrorDialogs" />。</span><span class="sxs-lookup"><span data-stu-id="08401-1130">Default is <see langword="UIOption.OnlyErrorDialogs" />.</span></span></param>
        <param name="onUserCancel"><span data-ttu-id="08401-1131">指定当用户取消了操作时引发异常。</span><span class="sxs-lookup"><span data-stu-id="08401-1131">Specifies whether or not an exception is thrown when the user cancels the operation.</span></span> <span data-ttu-id="08401-1132">默认值为 <see langword="UICancelOption.ThrowException" />。</span><span class="sxs-lookup"><span data-stu-id="08401-1132">Default is <see langword="UICancelOption.ThrowException" />.</span></span></param>
        <summary><span data-ttu-id="08401-1133">将文件移到新位置。</span><span class="sxs-lookup"><span data-stu-id="08401-1133">Moves a file to a new location.</span></span></summary>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="08401-1134">如果目标结构不存在，则创建它。</span><span class="sxs-lookup"><span data-stu-id="08401-1134">If the target structure does not exist, it is created.</span></span>  
  
 <span data-ttu-id="08401-1135">`MoveFile`方法保留 Ace （访问控制项） 仅当在移动文件同一个卷。</span><span class="sxs-lookup"><span data-stu-id="08401-1135">The `MoveFile` method preserves ACEs (Access Control Entries) only when moving the file within the same volume.</span></span> <span data-ttu-id="08401-1136">这包括成为直接移动 （直接 Ace 优先于继承的 Ace） 的 Ace 的继承的 Ace。</span><span class="sxs-lookup"><span data-stu-id="08401-1136">This includes inherited ACEs, which become direct ACEs when moved (direct ACEs take precedence over inherited ACEs).</span></span> <span data-ttu-id="08401-1137">如果卷之间移动文件，将不会复制 Ace。</span><span class="sxs-lookup"><span data-stu-id="08401-1137">If a file is moved between volumes, ACEs will not be copied.</span></span>  
  
 <span data-ttu-id="08401-1138">下表列出的任务涉及示例`My.Computer.FileSystem.MoveFile`方法。</span><span class="sxs-lookup"><span data-stu-id="08401-1138">The following table lists an example of a task involving the `My.Computer.FileSystem.MoveFile` method.</span></span>  
  
|<span data-ttu-id="08401-1139">功能</span><span class="sxs-lookup"><span data-stu-id="08401-1139">To</span></span>|<span data-ttu-id="08401-1140">查看</span><span class="sxs-lookup"><span data-stu-id="08401-1140">See</span></span>|  
|--------|---------|  
|<span data-ttu-id="08401-1141">移动文件</span><span class="sxs-lookup"><span data-stu-id="08401-1141">Move a file</span></span>|[<span data-ttu-id="08401-1142">如何：移动文件</span><span class="sxs-lookup"><span data-stu-id="08401-1142">How to: Move a File</span></span>](~/docs/visual-basic/developing-apps/programming/drives-directories-files/how-to-move-a-file.md)|  
  
   
  
## Examples  
 <span data-ttu-id="08401-1143">此示例会将文件移`Test.txt`从`TestDir1`到`TestDir2`。</span><span class="sxs-lookup"><span data-stu-id="08401-1143">This example moves the file `Test.txt` from `TestDir1` to `TestDir2`.</span></span>  
  
 [!code-vb[VbVbcnMyFileSystem#86](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbcnMyFileSystem/VB/Class1.vb#86)]  
  
 <span data-ttu-id="08401-1144">此示例会将文件移`Test.txt`从`TestDir1`到`TestDir2`并将其重命名`Test2.txt`。</span><span class="sxs-lookup"><span data-stu-id="08401-1144">This example moves the file `Test.txt` from `TestDir1` to `TestDir2` and renames it `Test2.txt`.</span></span>  
  
 [!code-vb[VbVbcnMyFileSystem#87](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbcnMyFileSystem/VB/Class1.vb#87)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentException"><span data-ttu-id="08401-1145">路径由于以下原因之一无效：是零长度字符串；仅为空白；包含无效字符；是一个设备路径（以 \\\\.\\ 开头）；以尾部反斜杠结尾。</span><span class="sxs-lookup"><span data-stu-id="08401-1145">The path is not valid for one of the following reasons: it is a zero-length string; it contains only white space; it contains invalid characters; or it is a device path (starts with \\\\.\\); it ends with a trailing slash.</span></span></exception>
        <exception cref="T:System.ArgumentNullException"><span data-ttu-id="08401-1146"><paramref name="destinationFileName" /> 为 <see langword="Nothing" /> 或空字符串。</span><span class="sxs-lookup"><span data-stu-id="08401-1146"><paramref name="destinationFileName" /> is <see langword="Nothing" /> or an empty string.</span></span></exception>
        <exception cref="T:System.IO.FileNotFoundException"><span data-ttu-id="08401-1147">源文件无效或不存在。</span><span class="sxs-lookup"><span data-stu-id="08401-1147">The source file is not valid or does not exist.</span></span></exception>
        <exception cref="T:System.IO.IOException"><span data-ttu-id="08401-1148">文件正由另一个进程使用或者出现 I/O 错误。</span><span class="sxs-lookup"><span data-stu-id="08401-1148">The file is in use by another process, or an I/O error occurs.</span></span></exception>
        <exception cref="T:System.OperationCanceledException"><span data-ttu-id="08401-1149"><paramref name="onUserCancel" /> 设置为<see langword="ThrowException" />，并且用户已取消该操作或发生了 I/O 错误。</span><span class="sxs-lookup"><span data-stu-id="08401-1149"><paramref name="onUserCancel" /> is set to <see langword="ThrowException" />, and either the user has cancelled the operation or an unspecified I/O error occurs.</span></span></exception>
        <exception cref="T:System.IO.PathTooLongException"><span data-ttu-id="08401-1150">路径超过系统定义的最大长度。</span><span class="sxs-lookup"><span data-stu-id="08401-1150">The path exceeds the system-defined maximum length.</span></span></exception>
        <exception cref="T:System.NotSupportedException"><span data-ttu-id="08401-1151">在路径中的文件或目录名称包含冒号 （:），或格式无效。</span><span class="sxs-lookup"><span data-stu-id="08401-1151">A file or directory name in the path contains a colon (:) or is in an invalid format.</span></span></exception>
        <exception cref="T:System.Security.SecurityException"><span data-ttu-id="08401-1152">该用户缺少必要的权限查看该路径。</span><span class="sxs-lookup"><span data-stu-id="08401-1152">The user lacks necessary permissions to view the path.</span></span></exception>
        <permission cref="T:System.Security.Permissions.EnvironmentPermission"><span data-ttu-id="08401-1153">控制可以访问所有环境变量。</span><span class="sxs-lookup"><span data-stu-id="08401-1153">Controls the ability to access all environment variables.</span></span> <span data-ttu-id="08401-1154">关联枚举： <see cref="F:System.Security.Permissions.PermissionState.Unrestricted" />。</span><span class="sxs-lookup"><span data-stu-id="08401-1154">Associated enumeration: <see cref="F:System.Security.Permissions.PermissionState.Unrestricted" />.</span></span></permission>
        <permission cref="T:System.Security.Permissions.FileIOPermission"><span data-ttu-id="08401-1155">控制文件和文件夹的访问权限。</span><span class="sxs-lookup"><span data-stu-id="08401-1155">Controls the ability to access files and folders.</span></span> <span data-ttu-id="08401-1156">关联枚举： <see cref="F:System.Security.Permissions.PermissionState.Unrestricted" />。</span><span class="sxs-lookup"><span data-stu-id="08401-1156">Associated enumeration: <see cref="F:System.Security.Permissions.PermissionState.Unrestricted" />.</span></span></permission>
        <permission cref="T:System.Security.Permissions.RegistryPermission"><span data-ttu-id="08401-1157">控制访问注册表变量的能力。</span><span class="sxs-lookup"><span data-stu-id="08401-1157">Controls the ability to access registry variables.</span></span> <span data-ttu-id="08401-1158">关联枚举： <see cref="F:System.Security.Permissions.PermissionState.Unrestricted" />。</span><span class="sxs-lookup"><span data-stu-id="08401-1158">Associated enumeration: <see cref="F:System.Security.Permissions.PermissionState.Unrestricted" />.</span></span></permission>
        <permission cref="T:System.Security.Permissions.UIPermission"><span data-ttu-id="08401-1159">控制与用户界面和剪贴板相关的权限。</span><span class="sxs-lookup"><span data-stu-id="08401-1159">Controls the permissions related to user interfaces and the clipboard.</span></span> <span data-ttu-id="08401-1160">关联枚举： <see cref="F:System.Security.Permissions.UIPermissionWindow.SafeSubWindows" />。</span><span class="sxs-lookup"><span data-stu-id="08401-1160">Associated enumeration: <see cref="F:System.Security.Permissions.UIPermissionWindow.SafeSubWindows" />.</span></span></permission>
        <altmember cref="T:Microsoft.VisualBasic.FileIO.UIOption" />
        <altmember cref="T:Microsoft.VisualBasic.FileIO.UICancelOption" />
        <related type="Article" href="~/docs/visual-basic/developing-apps/programming/drives-directories-files/creating-deleting-and-moving-files-and-directories.md"><span data-ttu-id="08401-1161">创建、删除和移动文件和目录 (Visual Basic)</span><span class="sxs-lookup"><span data-stu-id="08401-1161">Creating, Deleting, and Moving Files and Directories in Visual Basic</span></span></related>
      </Docs>
    </Member>
    <MemberGroup MemberName="OpenTextFieldParser">
      <AssemblyInfo>
        <AssemblyName>Microsoft.VisualBasic</AssemblyName>
        <AssemblyVersion>10.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Docs>
        <summary><span data-ttu-id="08401-1162"><see langword="OpenTextFieldParser" />方法，可创建<see cref="T:Microsoft.VisualBasic.FileIO.TextFieldParser" />对象，使您能够轻松而高效地分析结构化的文本文件，例如日志。</span><span class="sxs-lookup"><span data-stu-id="08401-1162">The <see langword="OpenTextFieldParser" /> method allows you to create a <see cref="T:Microsoft.VisualBasic.FileIO.TextFieldParser" /> object, which provides a way to easily and efficiently parse structured text files, such as logs.</span></span> <span data-ttu-id="08401-1163"><see langword="TextFieldParser" />对象可以用于读取分隔和固定宽度文件。</span><span class="sxs-lookup"><span data-stu-id="08401-1163">The <see langword="TextFieldParser" /> object can be used to read both delimited and fixed-width files.</span></span></summary>
      </Docs>
    </MemberGroup>
    <Member MemberName="OpenTextFieldParser">
      <MemberSignature Language="C#" Value="public Microsoft.VisualBasic.FileIO.TextFieldParser OpenTextFieldParser (string file);" />
      <MemberSignature Language="ILAsm" Value=".method public instance class Microsoft.VisualBasic.FileIO.TextFieldParser OpenTextFieldParser(string file) cil managed" />
      <MemberSignature Language="DocId" Value="M:Microsoft.VisualBasic.MyServices.FileSystemProxy.OpenTextFieldParser(System.String)" />
      <MemberSignature Language="VB.NET" Value="Public Function OpenTextFieldParser (file As String) As TextFieldParser" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; Microsoft::VisualBasic::FileIO::TextFieldParser ^ OpenTextFieldParser(System::String ^ file);" />
      <MemberSignature Language="F#" Value="member this.OpenTextFieldParser : string -&gt; Microsoft.VisualBasic.FileIO.TextFieldParser" Usage="fileSystemProxy.OpenTextFieldParser file" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>Microsoft.VisualBasic</AssemblyName>
        <AssemblyVersion>8.0.0.0</AssemblyVersion>
        <AssemblyVersion>10.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <AssemblyInfo>
        <AssemblyName>Microsoft.VisualBasic.Core</AssemblyName>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>Microsoft.VisualBasic.FileIO.TextFieldParser</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="file" Type="System.String" Index="0" FrameworkAlternate="netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;netframework-4.8" />
      </Parameters>
      <Docs>
        <param name="file"><span data-ttu-id="08401-1164">要使用打开的文件<see langword="TextFieldParser" />。</span><span class="sxs-lookup"><span data-stu-id="08401-1164">The file to be opened with the <see langword="TextFieldParser" />.</span></span></param>
        <summary><span data-ttu-id="08401-1165"><see langword="OpenTextFieldParser" />方法，可创建<see cref="T:Microsoft.VisualBasic.FileIO.TextFieldParser" />对象，使您能够轻松而高效地分析结构化的文本文件，例如日志。</span><span class="sxs-lookup"><span data-stu-id="08401-1165">The <see langword="OpenTextFieldParser" /> method allows you to create a <see cref="T:Microsoft.VisualBasic.FileIO.TextFieldParser" /> object, which provides a way to easily and efficiently parse structured text files, such as logs.</span></span> <span data-ttu-id="08401-1166"><see langword="TextFieldParser" />对象可以用于读取分隔和固定宽度文件。</span><span class="sxs-lookup"><span data-stu-id="08401-1166">The <see langword="TextFieldParser" /> object can be used to read both delimited and fixed-width files.</span></span></summary>
        <returns><span data-ttu-id="08401-1167"><see cref="T:Microsoft.VisualBasic.FileIO.TextFieldParser" /> 若要读取指定的文件。</span><span class="sxs-lookup"><span data-stu-id="08401-1167"><see cref="T:Microsoft.VisualBasic.FileIO.TextFieldParser" /> to read the specified file.</span></span></returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="08401-1168">下表列出了所涉及的任务的示例`My.Computer.FileSystem.OpenTextFieldParser`方法。</span><span class="sxs-lookup"><span data-stu-id="08401-1168">The following table lists examples of tasks involving the `My.Computer.FileSystem.OpenTextFieldParser` method.</span></span>  
  
|<span data-ttu-id="08401-1169">功能</span><span class="sxs-lookup"><span data-stu-id="08401-1169">To</span></span>|<span data-ttu-id="08401-1170">查看</span><span class="sxs-lookup"><span data-stu-id="08401-1170">See</span></span>|  
|--------|---------|  
|<span data-ttu-id="08401-1171">从带分隔符的文本文件中读取</span><span class="sxs-lookup"><span data-stu-id="08401-1171">Read from a delimited text file</span></span>|[<span data-ttu-id="08401-1172">如何：读取逗号分隔的文本文件</span><span class="sxs-lookup"><span data-stu-id="08401-1172">How to: Read From Comma-Delimited Text Files</span></span>](~/docs/visual-basic/developing-apps/programming/drives-directories-files/how-to-read-from-comma-delimited-text-files.md)|  
|<span data-ttu-id="08401-1173">读取定宽文本文件</span><span class="sxs-lookup"><span data-stu-id="08401-1173">Read from a fixed-width text file</span></span>|[<span data-ttu-id="08401-1174">如何：读取固定宽度的文本文件</span><span class="sxs-lookup"><span data-stu-id="08401-1174">How to: Read From Fixed-width Text Files</span></span>](~/docs/visual-basic/developing-apps/programming/drives-directories-files/how-to-read-from-fixed-width-text-files.md)|  
|<span data-ttu-id="08401-1175">读取具有多种格式的文本文件</span><span class="sxs-lookup"><span data-stu-id="08401-1175">Read from a text file with multiple formats</span></span>|[<span data-ttu-id="08401-1176">如何：读取具有多种格式的文本文件</span><span class="sxs-lookup"><span data-stu-id="08401-1176">How to: Read From Text Files with Multiple Formats</span></span>](~/docs/visual-basic/developing-apps/programming/drives-directories-files/how-to-read-from-text-files-with-multiple-formats.md)|  
  
   
  
## Examples  
 <span data-ttu-id="08401-1177">此示例打开`TextFieldParser.reader`并使用它来从读取`C:\TestFolder1\Test1.txt`。</span><span class="sxs-lookup"><span data-stu-id="08401-1177">This example opens the `TextFieldParser.reader` and uses it to read from `C:\TestFolder1\Test1.txt`.</span></span>  
  
 [!code-vb[VbRefFile#18](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbRefFile/VB/Class1.vb#18)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentException"><span data-ttu-id="08401-1178">路径由于以下原因之一无效：是零长度字符串；仅为空白；包含无效字符；是一个设备路径（以 \\\\.\\ 开头）；以尾部反斜杠结尾。</span><span class="sxs-lookup"><span data-stu-id="08401-1178">The path is not valid for one of the following reasons: it is a zero-length string; it contains only white space; it contains invalid characters; or it is a device path (starts with \\\\.\\); it ends with a trailing slash.</span></span></exception>
        <exception cref="T:System.ArgumentNullException"><span data-ttu-id="08401-1179"><paramref name="file" /> 为 <see langword="Nothing" />。</span><span class="sxs-lookup"><span data-stu-id="08401-1179"><paramref name="file" /> is <see langword="Nothing" />.</span></span></exception>
        <exception cref="T:System.IO.FileNotFoundException"><span data-ttu-id="08401-1180">文件不存在。</span><span class="sxs-lookup"><span data-stu-id="08401-1180">The file does not exist.</span></span></exception>
        <exception cref="T:System.IO.IOException"><span data-ttu-id="08401-1181">文件正由另一个进程使用或者出现 I/O 错误。</span><span class="sxs-lookup"><span data-stu-id="08401-1181">The file is in use by another process, or an I/O error occurs.</span></span></exception>
        <exception cref="T:System.IO.PathTooLongException"><span data-ttu-id="08401-1182">路径超过系统定义的最大长度。</span><span class="sxs-lookup"><span data-stu-id="08401-1182">The path exceeds the system-defined maximum length.</span></span></exception>
        <exception cref="T:System.NotSupportedException"><span data-ttu-id="08401-1183">在路径中的文件或目录名称包含冒号 （:），或格式无效。</span><span class="sxs-lookup"><span data-stu-id="08401-1183">A file or directory name in the path contains a colon (:) or is in an invalid format.</span></span></exception>
        <exception cref="T:Microsoft.VisualBasic.FileIO.MalformedLineException"><span data-ttu-id="08401-1184">不能使用指定的格式分析某行。</span><span class="sxs-lookup"><span data-stu-id="08401-1184">A row cannot be parsed using the specified format.</span></span> <span data-ttu-id="08401-1185">此异常消息指定导致发生异常的行，同时将 <see cref="P:Microsoft.VisualBasic.FileIO.TextFieldParser.ErrorLine" /> 属性分配给该行中包含的文本。</span><span class="sxs-lookup"><span data-stu-id="08401-1185">The exception message specifies the line causing the exception, while the <see cref="P:Microsoft.VisualBasic.FileIO.TextFieldParser.ErrorLine" /> property is assigned the text contained in the line.</span></span></exception>
        <exception cref="T:System.Security.SecurityException"><span data-ttu-id="08401-1186">该用户缺少必要的权限查看该路径。</span><span class="sxs-lookup"><span data-stu-id="08401-1186">The user lacks necessary permissions to view the path.</span></span></exception>
        <permission cref="T:System.Security.Permissions.FileIOPermission"><span data-ttu-id="08401-1187">控制文件和文件夹的访问权限。</span><span class="sxs-lookup"><span data-stu-id="08401-1187">Controls the ability to access files and folders.</span></span> <span data-ttu-id="08401-1188">关联枚举： <see cref="F:System.Security.Permissions.PermissionState.Unrestricted" />。</span><span class="sxs-lookup"><span data-stu-id="08401-1188">Associated enumeration: <see cref="F:System.Security.Permissions.PermissionState.Unrestricted" />.</span></span></permission>
        <permission cref="T:System.Security.Permissions.SecurityPermission"><span data-ttu-id="08401-1189">描述一组应用于代码的安全权限。</span><span class="sxs-lookup"><span data-stu-id="08401-1189">Describes a set of security permissions applied to code.</span></span> <span data-ttu-id="08401-1190">关联枚举： <see cref="F:System.Security.Permissions.SecurityPermissionFlag.ControlEvidence" />。</span><span class="sxs-lookup"><span data-stu-id="08401-1190">Associated enumeration: <see cref="F:System.Security.Permissions.SecurityPermissionFlag.ControlEvidence" />.</span></span></permission>
        <altmember cref="T:Microsoft.VisualBasic.FileIO.TextFieldParser" />
        <related type="Article" href="~/docs/visual-basic/language-reference/objects/index.md"><span data-ttu-id="08401-1191">对象 (Visual Basic)</span><span class="sxs-lookup"><span data-stu-id="08401-1191">Objects (Visual Basic)</span></span></related>
        <related type="Article" href="~/docs/visual-basic/developing-apps/programming/drives-directories-files/how-to-read-from-text-files.md"><span data-ttu-id="08401-1192">如何：在 Visual Basic 中读取文本文件</span><span class="sxs-lookup"><span data-stu-id="08401-1192">How to: Read From Text Files in Visual Basic</span></span></related>
        <related type="Article" href="~/docs/visual-basic/developing-apps/programming/drives-directories-files/how-to-read-from-comma-delimited-text-files.md"><span data-ttu-id="08401-1193">如何：从逗号分隔的文本在 Visual Basic 中的文件中读取</span><span class="sxs-lookup"><span data-stu-id="08401-1193">How to: Read From Comma-Delimited Text Files in Visual Basic</span></span></related>
        <related type="Article" href="~/docs/visual-basic/developing-apps/programming/drives-directories-files/how-to-read-from-text-files-with-multiple-formats.md"><span data-ttu-id="08401-1194">如何：在 Visual Basic 中读取具有多种格式的文本文件</span><span class="sxs-lookup"><span data-stu-id="08401-1194">How to: Read From Text Files with Multiple Formats in Visual Basic</span></span></related>
        <related type="Article" href="~/docs/visual-basic/developing-apps/programming/drives-directories-files/reading-from-files.md"><span data-ttu-id="08401-1195">从文件读取 (Visual Basic)</span><span class="sxs-lookup"><span data-stu-id="08401-1195">Reading from Files in Visual Basic</span></span></related>
        <related type="Article" href="~/docs/visual-basic/developing-apps/programming/drives-directories-files/parsing-text-files-with-the-textfieldparser-object.md"><span data-ttu-id="08401-1196">使用 TextFieldParser 对象分析文本文件</span><span class="sxs-lookup"><span data-stu-id="08401-1196">Parsing Text Files with the TextFieldParser Object</span></span></related>
      </Docs>
    </Member>
    <Member MemberName="OpenTextFieldParser">
      <MemberSignature Language="C#" Value="public Microsoft.VisualBasic.FileIO.TextFieldParser OpenTextFieldParser (string file, params int[] fieldWidths);" />
      <MemberSignature Language="ILAsm" Value=".method public instance class Microsoft.VisualBasic.FileIO.TextFieldParser OpenTextFieldParser(string file, int32[] fieldWidths) cil managed" />
      <MemberSignature Language="DocId" Value="M:Microsoft.VisualBasic.MyServices.FileSystemProxy.OpenTextFieldParser(System.String,System.Int32[])" />
      <MemberSignature Language="VB.NET" Value="Public Function OpenTextFieldParser (file As String, ParamArray fieldWidths As Integer()) As TextFieldParser" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; Microsoft::VisualBasic::FileIO::TextFieldParser ^ OpenTextFieldParser(System::String ^ file, ... cli::array &lt;int&gt; ^ fieldWidths);" />
      <MemberSignature Language="F#" Value="member this.OpenTextFieldParser : string * int[] -&gt; Microsoft.VisualBasic.FileIO.TextFieldParser" Usage="fileSystemProxy.OpenTextFieldParser (file, fieldWidths)" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>Microsoft.VisualBasic</AssemblyName>
        <AssemblyVersion>8.0.0.0</AssemblyVersion>
        <AssemblyVersion>10.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <AssemblyInfo>
        <AssemblyName>Microsoft.VisualBasic.Core</AssemblyName>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>Microsoft.VisualBasic.FileIO.TextFieldParser</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="file" Type="System.String" Index="0" FrameworkAlternate="netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;netframework-4.8" />
        <Parameter Name="fieldWidths" Type="System.Int32[]" Index="1" FrameworkAlternate="netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;netframework-4.8">
          <Attributes>
            <Attribute FrameworkAlternate="netframework-2.0">
              <AttributeName>System.ParamArray</AttributeName>
            </Attribute>
          </Attributes>
        </Parameter>
      </Parameters>
      <Docs>
        <param name="file"><span data-ttu-id="08401-1197">要使用打开的文件<see langword="TextFieldParser" />。</span><span class="sxs-lookup"><span data-stu-id="08401-1197">The file to be opened with the <see langword="TextFieldParser" />.</span></span></param>
        <param name="fieldWidths"><span data-ttu-id="08401-1198">字段的宽度。</span><span class="sxs-lookup"><span data-stu-id="08401-1198">Widths of the fields.</span></span></param>
        <summary><span data-ttu-id="08401-1199"><see langword="OpenTextFieldParser" />方法，可创建<see cref="T:Microsoft.VisualBasic.FileIO.TextFieldParser" />对象，使您能够轻松而高效地分析结构化的文本文件，例如日志。</span><span class="sxs-lookup"><span data-stu-id="08401-1199">The <see langword="OpenTextFieldParser" /> method allows you to create a <see cref="T:Microsoft.VisualBasic.FileIO.TextFieldParser" /> object, which provides a way to easily and efficiently parse structured text files, such as logs.</span></span> <span data-ttu-id="08401-1200"><see langword="TextFieldParser" />对象可以用于读取分隔和固定宽度文件。</span><span class="sxs-lookup"><span data-stu-id="08401-1200">The <see langword="TextFieldParser" /> object can be used to read both delimited and fixed-width files.</span></span></summary>
        <returns><span data-ttu-id="08401-1201"><see cref="T:Microsoft.VisualBasic.FileIO.TextFieldParser" /> 若要读取指定的文件。</span><span class="sxs-lookup"><span data-stu-id="08401-1201"><see cref="T:Microsoft.VisualBasic.FileIO.TextFieldParser" /> to read the specified file.</span></span></returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="08401-1202">下表列出了所涉及的任务的示例`My.Computer.FileSystem.OpenTextFieldParser`方法。</span><span class="sxs-lookup"><span data-stu-id="08401-1202">The following table lists examples of tasks involving the `My.Computer.FileSystem.OpenTextFieldParser` method.</span></span>  
  
|<span data-ttu-id="08401-1203">功能</span><span class="sxs-lookup"><span data-stu-id="08401-1203">To</span></span>|<span data-ttu-id="08401-1204">查看</span><span class="sxs-lookup"><span data-stu-id="08401-1204">See</span></span>|  
|--------|---------|  
|<span data-ttu-id="08401-1205">从带分隔符的文本文件中读取</span><span class="sxs-lookup"><span data-stu-id="08401-1205">Read from a delimited text file</span></span>|[<span data-ttu-id="08401-1206">如何：读取逗号分隔的文本文件</span><span class="sxs-lookup"><span data-stu-id="08401-1206">How to: Read From Comma-Delimited Text Files</span></span>](~/docs/visual-basic/developing-apps/programming/drives-directories-files/how-to-read-from-comma-delimited-text-files.md)|  
|<span data-ttu-id="08401-1207">读取定宽文本文件</span><span class="sxs-lookup"><span data-stu-id="08401-1207">Read from a fixed-width text file</span></span>|[<span data-ttu-id="08401-1208">如何：读取固定宽度的文本文件</span><span class="sxs-lookup"><span data-stu-id="08401-1208">How to: Read From Fixed-width Text Files</span></span>](~/docs/visual-basic/developing-apps/programming/drives-directories-files/how-to-read-from-fixed-width-text-files.md)|  
|<span data-ttu-id="08401-1209">读取具有多种格式的文本文件</span><span class="sxs-lookup"><span data-stu-id="08401-1209">Read from a text file with multiple formats</span></span>|[<span data-ttu-id="08401-1210">如何：读取具有多种格式的文本文件</span><span class="sxs-lookup"><span data-stu-id="08401-1210">How to: Read From Text Files with Multiple Formats</span></span>](~/docs/visual-basic/developing-apps/programming/drives-directories-files/how-to-read-from-text-files-with-multiple-formats.md)|  
  
   
  
## Examples  
 <span data-ttu-id="08401-1211">此示例打开`TextFieldParser.reader`并使用它来从读取`C:\TestFolder1\Test1.txt`。</span><span class="sxs-lookup"><span data-stu-id="08401-1211">This example opens the `TextFieldParser.reader` and uses it to read from `C:\TestFolder1\Test1.txt`.</span></span>  
  
 [!code-vb[VbRefFile#18](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbRefFile/VB/Class1.vb#18)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentException"><span data-ttu-id="08401-1212">路径由于以下原因之一无效：是零长度字符串；仅为空白；包含无效字符；是一个设备路径（以 \\\\.\\ 开头）；以尾部反斜杠结尾。</span><span class="sxs-lookup"><span data-stu-id="08401-1212">The path is not valid for one of the following reasons: it is a zero-length string; it contains only white space; it contains invalid characters; or it is a device path (starts with \\\\.\\); it ends with a trailing slash.</span></span></exception>
        <exception cref="T:System.ArgumentNullException"><span data-ttu-id="08401-1213"><paramref name="file" /> 为 <see langword="Nothing" />。</span><span class="sxs-lookup"><span data-stu-id="08401-1213"><paramref name="file" /> is <see langword="Nothing" />.</span></span></exception>
        <exception cref="T:System.IO.FileNotFoundException"><span data-ttu-id="08401-1214">文件不存在。</span><span class="sxs-lookup"><span data-stu-id="08401-1214">The file does not exist.</span></span></exception>
        <exception cref="T:System.IO.IOException"><span data-ttu-id="08401-1215">文件正由另一个进程使用或者出现 I/O 错误。</span><span class="sxs-lookup"><span data-stu-id="08401-1215">The file is in use by another process, or an I/O error occurs.</span></span></exception>
        <exception cref="T:System.IO.PathTooLongException"><span data-ttu-id="08401-1216">路径超过系统定义的最大长度。</span><span class="sxs-lookup"><span data-stu-id="08401-1216">The path exceeds the system-defined maximum length.</span></span></exception>
        <exception cref="T:System.NotSupportedException"><span data-ttu-id="08401-1217">在路径中的文件或目录名称包含冒号 （:），或格式无效。</span><span class="sxs-lookup"><span data-stu-id="08401-1217">A file or directory name in the path contains a colon (:) or is in an invalid format.</span></span></exception>
        <exception cref="T:Microsoft.VisualBasic.FileIO.MalformedLineException"><span data-ttu-id="08401-1218">不能使用指定的格式分析某行。</span><span class="sxs-lookup"><span data-stu-id="08401-1218">A row cannot be parsed using the specified format.</span></span> <span data-ttu-id="08401-1219">此异常消息指定导致发生异常的行，同时将 <see cref="P:Microsoft.VisualBasic.FileIO.TextFieldParser.ErrorLine" /> 属性分配给该行中包含的文本。</span><span class="sxs-lookup"><span data-stu-id="08401-1219">The exception message specifies the line causing the exception, while the <see cref="P:Microsoft.VisualBasic.FileIO.TextFieldParser.ErrorLine" /> property is assigned the text contained in the line.</span></span></exception>
        <exception cref="T:System.Security.SecurityException"><span data-ttu-id="08401-1220">该用户缺少必要的权限查看该路径。</span><span class="sxs-lookup"><span data-stu-id="08401-1220">The user lacks necessary permissions to view the path.</span></span></exception>
        <permission cref="T:System.Security.Permissions.FileIOPermission"><span data-ttu-id="08401-1221">控制文件和文件夹的访问权限。</span><span class="sxs-lookup"><span data-stu-id="08401-1221">Controls the ability to access files and folders.</span></span> <span data-ttu-id="08401-1222">关联枚举： <see cref="F:System.Security.Permissions.PermissionState.Unrestricted" />。</span><span class="sxs-lookup"><span data-stu-id="08401-1222">Associated enumeration: <see cref="F:System.Security.Permissions.PermissionState.Unrestricted" />.</span></span></permission>
        <permission cref="T:System.Security.Permissions.SecurityPermission"><span data-ttu-id="08401-1223">描述一组应用于代码的安全权限。</span><span class="sxs-lookup"><span data-stu-id="08401-1223">Describes a set of security permissions applied to code.</span></span> <span data-ttu-id="08401-1224">关联枚举： <see cref="F:System.Security.Permissions.SecurityPermissionFlag.ControlEvidence" />。</span><span class="sxs-lookup"><span data-stu-id="08401-1224">Associated enumeration: <see cref="F:System.Security.Permissions.SecurityPermissionFlag.ControlEvidence" />.</span></span></permission>
        <altmember cref="T:Microsoft.VisualBasic.FileIO.TextFieldParser" />
        <related type="Article" href="~/docs/visual-basic/language-reference/objects/index.md"><span data-ttu-id="08401-1225">对象 (Visual Basic)</span><span class="sxs-lookup"><span data-stu-id="08401-1225">Objects (Visual Basic)</span></span></related>
        <related type="Article" href="~/docs/visual-basic/developing-apps/programming/drives-directories-files/how-to-read-from-text-files.md"><span data-ttu-id="08401-1226">如何：在 Visual Basic 中读取文本文件</span><span class="sxs-lookup"><span data-stu-id="08401-1226">How to: Read From Text Files in Visual Basic</span></span></related>
        <related type="Article" href="~/docs/visual-basic/developing-apps/programming/drives-directories-files/how-to-read-from-comma-delimited-text-files.md"><span data-ttu-id="08401-1227">如何：从逗号分隔的文本在 Visual Basic 中的文件中读取</span><span class="sxs-lookup"><span data-stu-id="08401-1227">How to: Read From Comma-Delimited Text Files in Visual Basic</span></span></related>
        <related type="Article" href="~/docs/visual-basic/developing-apps/programming/drives-directories-files/how-to-read-from-text-files-with-multiple-formats.md"><span data-ttu-id="08401-1228">如何：在 Visual Basic 中读取具有多种格式的文本文件</span><span class="sxs-lookup"><span data-stu-id="08401-1228">How to: Read From Text Files with Multiple Formats in Visual Basic</span></span></related>
        <related type="Article" href="~/docs/visual-basic/developing-apps/programming/drives-directories-files/reading-from-files.md"><span data-ttu-id="08401-1229">从文件读取 (Visual Basic)</span><span class="sxs-lookup"><span data-stu-id="08401-1229">Reading from Files in Visual Basic</span></span></related>
        <related type="Article" href="~/docs/visual-basic/developing-apps/programming/drives-directories-files/parsing-text-files-with-the-textfieldparser-object.md"><span data-ttu-id="08401-1230">使用 TextFieldParser 对象分析文本文件</span><span class="sxs-lookup"><span data-stu-id="08401-1230">Parsing Text Files with the TextFieldParser Object</span></span></related>
      </Docs>
    </Member>
    <Member MemberName="OpenTextFieldParser">
      <MemberSignature Language="C#" Value="public Microsoft.VisualBasic.FileIO.TextFieldParser OpenTextFieldParser (string file, params string[] delimiters);" />
      <MemberSignature Language="ILAsm" Value=".method public instance class Microsoft.VisualBasic.FileIO.TextFieldParser OpenTextFieldParser(string file, string[] delimiters) cil managed" />
      <MemberSignature Language="DocId" Value="M:Microsoft.VisualBasic.MyServices.FileSystemProxy.OpenTextFieldParser(System.String,System.String[])" />
      <MemberSignature Language="VB.NET" Value="Public Function OpenTextFieldParser (file As String, ParamArray delimiters As String()) As TextFieldParser" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; Microsoft::VisualBasic::FileIO::TextFieldParser ^ OpenTextFieldParser(System::String ^ file, ... cli::array &lt;System::String ^&gt; ^ delimiters);" />
      <MemberSignature Language="F#" Value="member this.OpenTextFieldParser : string * string[] -&gt; Microsoft.VisualBasic.FileIO.TextFieldParser" Usage="fileSystemProxy.OpenTextFieldParser (file, delimiters)" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>Microsoft.VisualBasic</AssemblyName>
        <AssemblyVersion>8.0.0.0</AssemblyVersion>
        <AssemblyVersion>10.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <AssemblyInfo>
        <AssemblyName>Microsoft.VisualBasic.Core</AssemblyName>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>Microsoft.VisualBasic.FileIO.TextFieldParser</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="file" Type="System.String" Index="0" FrameworkAlternate="netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;netframework-4.8" />
        <Parameter Name="delimiters" Type="System.String[]" Index="1" FrameworkAlternate="netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;netframework-4.8">
          <Attributes>
            <Attribute FrameworkAlternate="netframework-2.0">
              <AttributeName>System.ParamArray</AttributeName>
            </Attribute>
          </Attributes>
        </Parameter>
      </Parameters>
      <Docs>
        <param name="file"><span data-ttu-id="08401-1231">要使用打开的文件<see langword="TextFieldParser" />。</span><span class="sxs-lookup"><span data-stu-id="08401-1231">The file to be opened with the <see langword="TextFieldParser" />.</span></span></param>
        <param name="delimiters"><span data-ttu-id="08401-1232">字段分隔符。</span><span class="sxs-lookup"><span data-stu-id="08401-1232">Delimiters for the fields.</span></span></param>
        <summary><span data-ttu-id="08401-1233"><see langword="OpenTextFieldParser" />方法，可创建<see cref="T:Microsoft.VisualBasic.FileIO.TextFieldParser" />对象，使您能够轻松而高效地分析结构化的文本文件，例如日志。</span><span class="sxs-lookup"><span data-stu-id="08401-1233">The <see langword="OpenTextFieldParser" /> method allows you to create a <see cref="T:Microsoft.VisualBasic.FileIO.TextFieldParser" /> object, which provides a way to easily and efficiently parse structured text files, such as logs.</span></span> <span data-ttu-id="08401-1234"><see langword="TextFieldParser" />对象可以用于读取分隔和固定宽度文件。</span><span class="sxs-lookup"><span data-stu-id="08401-1234">The <see langword="TextFieldParser" /> object can be used to read both delimited and fixed-width files.</span></span></summary>
        <returns><span data-ttu-id="08401-1235"><see cref="T:Microsoft.VisualBasic.FileIO.TextFieldParser" /> 若要读取指定的文件。</span><span class="sxs-lookup"><span data-stu-id="08401-1235"><see cref="T:Microsoft.VisualBasic.FileIO.TextFieldParser" /> to read the specified file.</span></span></returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="08401-1236">下表列出了所涉及的任务的示例`My.Computer.FileSystem.OpenTextFieldParser`方法。</span><span class="sxs-lookup"><span data-stu-id="08401-1236">The following table lists examples of tasks involving the `My.Computer.FileSystem.OpenTextFieldParser` method.</span></span>  
  
|<span data-ttu-id="08401-1237">功能</span><span class="sxs-lookup"><span data-stu-id="08401-1237">To</span></span>|<span data-ttu-id="08401-1238">查看</span><span class="sxs-lookup"><span data-stu-id="08401-1238">See</span></span>|  
|--------|---------|  
|<span data-ttu-id="08401-1239">从带分隔符的文本文件中读取</span><span class="sxs-lookup"><span data-stu-id="08401-1239">Read from a delimited text file</span></span>|[<span data-ttu-id="08401-1240">如何：读取逗号分隔的文本文件</span><span class="sxs-lookup"><span data-stu-id="08401-1240">How to: Read From Comma-Delimited Text Files</span></span>](~/docs/visual-basic/developing-apps/programming/drives-directories-files/how-to-read-from-comma-delimited-text-files.md)|  
|<span data-ttu-id="08401-1241">读取定宽文本文件</span><span class="sxs-lookup"><span data-stu-id="08401-1241">Read from a fixed-width text file</span></span>|[<span data-ttu-id="08401-1242">如何：读取固定宽度的文本文件</span><span class="sxs-lookup"><span data-stu-id="08401-1242">How to: Read From Fixed-width Text Files</span></span>](~/docs/visual-basic/developing-apps/programming/drives-directories-files/how-to-read-from-fixed-width-text-files.md)|  
|<span data-ttu-id="08401-1243">读取具有多种格式的文本文件</span><span class="sxs-lookup"><span data-stu-id="08401-1243">Read from a text file with multiple formats</span></span>|[<span data-ttu-id="08401-1244">如何：读取具有多种格式的文本文件</span><span class="sxs-lookup"><span data-stu-id="08401-1244">How to: Read From Text Files with Multiple Formats</span></span>](~/docs/visual-basic/developing-apps/programming/drives-directories-files/how-to-read-from-text-files-with-multiple-formats.md)|  
  
   
  
## Examples  
 <span data-ttu-id="08401-1245">此示例打开`TextFieldParser.reader`并使用它来从读取`C:\TestFolder1\Test1.txt`。</span><span class="sxs-lookup"><span data-stu-id="08401-1245">This example opens the `TextFieldParser.reader` and uses it to read from `C:\TestFolder1\Test1.txt`.</span></span>  
  
 [!code-vb[VbRefFile#18](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbRefFile/VB/Class1.vb#18)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentException"><span data-ttu-id="08401-1246">路径由于以下原因之一无效：是零长度字符串；仅为空白；包含无效字符；是一个设备路径（以 \\\\.\\ 开头）；以尾部反斜杠结尾。</span><span class="sxs-lookup"><span data-stu-id="08401-1246">The path is not valid for one of the following reasons: it is a zero-length string; it contains only white space; it contains invalid characters; or it is a device path (starts with \\\\.\\); it ends with a trailing slash.</span></span></exception>
        <exception cref="T:System.ArgumentNullException"><span data-ttu-id="08401-1247"><paramref name="file" /> 为 <see langword="Nothing" />。</span><span class="sxs-lookup"><span data-stu-id="08401-1247"><paramref name="file" /> is <see langword="Nothing" />.</span></span></exception>
        <exception cref="T:System.IO.FileNotFoundException"><span data-ttu-id="08401-1248">文件不存在。</span><span class="sxs-lookup"><span data-stu-id="08401-1248">The file does not exist.</span></span></exception>
        <exception cref="T:System.IO.IOException"><span data-ttu-id="08401-1249">文件正由另一个进程使用或者出现 I/O 错误。</span><span class="sxs-lookup"><span data-stu-id="08401-1249">The file is in use by another process, or an I/O error occurs.</span></span></exception>
        <exception cref="T:System.IO.PathTooLongException"><span data-ttu-id="08401-1250">路径超过系统定义的最大长度。</span><span class="sxs-lookup"><span data-stu-id="08401-1250">The path exceeds the system-defined maximum length.</span></span></exception>
        <exception cref="T:System.NotSupportedException"><span data-ttu-id="08401-1251">在路径中的文件或目录名称包含冒号 （:），或格式无效。</span><span class="sxs-lookup"><span data-stu-id="08401-1251">A file or directory name in the path contains a colon (:) or is in an invalid format.</span></span></exception>
        <exception cref="T:Microsoft.VisualBasic.FileIO.MalformedLineException"><span data-ttu-id="08401-1252">不能使用指定的格式分析某行。</span><span class="sxs-lookup"><span data-stu-id="08401-1252">A row cannot be parsed using the specified format.</span></span> <span data-ttu-id="08401-1253">此异常消息指定导致发生异常的行，同时将 <see cref="P:Microsoft.VisualBasic.FileIO.TextFieldParser.ErrorLine" /> 属性分配给该行中包含的文本。</span><span class="sxs-lookup"><span data-stu-id="08401-1253">The exception message specifies the line causing the exception, while the <see cref="P:Microsoft.VisualBasic.FileIO.TextFieldParser.ErrorLine" /> property is assigned the text contained in the line.</span></span></exception>
        <exception cref="T:System.Security.SecurityException"><span data-ttu-id="08401-1254">该用户缺少必要的权限查看该路径。</span><span class="sxs-lookup"><span data-stu-id="08401-1254">The user lacks necessary permissions to view the path.</span></span></exception>
        <permission cref="T:System.Security.Permissions.FileIOPermission"><span data-ttu-id="08401-1255">控制文件和文件夹的访问权限。</span><span class="sxs-lookup"><span data-stu-id="08401-1255">Controls the ability to access files and folders.</span></span> <span data-ttu-id="08401-1256">关联枚举： <see cref="F:System.Security.Permissions.PermissionState.Unrestricted" />。</span><span class="sxs-lookup"><span data-stu-id="08401-1256">Associated enumeration: <see cref="F:System.Security.Permissions.PermissionState.Unrestricted" />.</span></span></permission>
        <permission cref="T:System.Security.Permissions.SecurityPermission"><span data-ttu-id="08401-1257">描述一组应用于代码的安全权限。</span><span class="sxs-lookup"><span data-stu-id="08401-1257">Describes a set of security permissions applied to code.</span></span> <span data-ttu-id="08401-1258">关联枚举： <see cref="F:System.Security.Permissions.SecurityPermissionFlag.ControlEvidence" />。</span><span class="sxs-lookup"><span data-stu-id="08401-1258">Associated enumeration: <see cref="F:System.Security.Permissions.SecurityPermissionFlag.ControlEvidence" />.</span></span></permission>
        <altmember cref="T:Microsoft.VisualBasic.FileIO.TextFieldParser" />
        <related type="Article" href="~/docs/visual-basic/language-reference/objects/index.md"><span data-ttu-id="08401-1259">对象 (Visual Basic)</span><span class="sxs-lookup"><span data-stu-id="08401-1259">Objects (Visual Basic)</span></span></related>
        <related type="Article" href="~/docs/visual-basic/developing-apps/programming/drives-directories-files/how-to-read-from-text-files.md"><span data-ttu-id="08401-1260">如何：在 Visual Basic 中读取文本文件</span><span class="sxs-lookup"><span data-stu-id="08401-1260">How to: Read From Text Files in Visual Basic</span></span></related>
        <related type="Article" href="~/docs/visual-basic/developing-apps/programming/drives-directories-files/how-to-read-from-comma-delimited-text-files.md"><span data-ttu-id="08401-1261">如何：从逗号分隔的文本在 Visual Basic 中的文件中读取</span><span class="sxs-lookup"><span data-stu-id="08401-1261">How to: Read From Comma-Delimited Text Files in Visual Basic</span></span></related>
        <related type="Article" href="~/docs/visual-basic/developing-apps/programming/drives-directories-files/how-to-read-from-text-files-with-multiple-formats.md"><span data-ttu-id="08401-1262">如何：在 Visual Basic 中读取具有多种格式的文本文件</span><span class="sxs-lookup"><span data-stu-id="08401-1262">How to: Read From Text Files with Multiple Formats in Visual Basic</span></span></related>
        <related type="Article" href="~/docs/visual-basic/developing-apps/programming/drives-directories-files/reading-from-files.md"><span data-ttu-id="08401-1263">从文件读取 (Visual Basic)</span><span class="sxs-lookup"><span data-stu-id="08401-1263">Reading from Files in Visual Basic</span></span></related>
        <related type="Article" href="~/docs/visual-basic/developing-apps/programming/drives-directories-files/parsing-text-files-with-the-textfieldparser-object.md"><span data-ttu-id="08401-1264">使用 TextFieldParser 对象分析文本文件</span><span class="sxs-lookup"><span data-stu-id="08401-1264">Parsing Text Files with the TextFieldParser Object</span></span></related>
      </Docs>
    </Member>
    <MemberGroup MemberName="OpenTextFileReader">
      <AssemblyInfo>
        <AssemblyName>Microsoft.VisualBasic</AssemblyName>
        <AssemblyVersion>10.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Docs>
        <summary><span data-ttu-id="08401-1265">此时将打开<see cref="T:System.IO.StreamReader" />要从文件读取对象。</span><span class="sxs-lookup"><span data-stu-id="08401-1265">Opens a <see cref="T:System.IO.StreamReader" /> object to read from a file.</span></span></summary>
      </Docs>
    </MemberGroup>
    <Member MemberName="OpenTextFileReader">
      <MemberSignature Language="C#" Value="public System.IO.StreamReader OpenTextFileReader (string file);" />
      <MemberSignature Language="ILAsm" Value=".method public instance class System.IO.StreamReader OpenTextFileReader(string file) cil managed" />
      <MemberSignature Language="DocId" Value="M:Microsoft.VisualBasic.MyServices.FileSystemProxy.OpenTextFileReader(System.String)" />
      <MemberSignature Language="VB.NET" Value="Public Function OpenTextFileReader (file As String) As StreamReader" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; System::IO::StreamReader ^ OpenTextFileReader(System::String ^ file);" />
      <MemberSignature Language="F#" Value="member this.OpenTextFileReader : string -&gt; System.IO.StreamReader" Usage="fileSystemProxy.OpenTextFileReader file" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>Microsoft.VisualBasic</AssemblyName>
        <AssemblyVersion>8.0.0.0</AssemblyVersion>
        <AssemblyVersion>10.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <AssemblyInfo>
        <AssemblyName>Microsoft.VisualBasic.Core</AssemblyName>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.IO.StreamReader</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="file" Type="System.String" Index="0" FrameworkAlternate="netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;netframework-4.8" />
      </Parameters>
      <Docs>
        <param name="file"><span data-ttu-id="08401-1266">要读取的文件。</span><span class="sxs-lookup"><span data-stu-id="08401-1266">File to be read.</span></span></param>
        <summary><span data-ttu-id="08401-1267">此时将打开<see cref="T:System.IO.StreamReader" />要从文件读取对象。</span><span class="sxs-lookup"><span data-stu-id="08401-1267">Opens a <see cref="T:System.IO.StreamReader" /> object to read from a file.</span></span></summary>
        <returns><span data-ttu-id="08401-1268"><see cref="T:System.IO.StreamReader" /> 要从文件中读取对象</span><span class="sxs-lookup"><span data-stu-id="08401-1268"><see cref="T:System.IO.StreamReader" /> object to read from the file</span></span></returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="08401-1269">只有文本文件可以使用读取<xref:System.IO.StreamReader>。</span><span class="sxs-lookup"><span data-stu-id="08401-1269">Only text files can be read with a <xref:System.IO.StreamReader>.</span></span>  
  
 <span data-ttu-id="08401-1270">下表列出了所涉及的任务的示例`My.Computer.FileSystem.OpenTextFileReader`方法。</span><span class="sxs-lookup"><span data-stu-id="08401-1270">The following table lists examples of tasks involving the `My.Computer.FileSystem.OpenTextFileReader` method.</span></span>  
  
|<span data-ttu-id="08401-1271">功能</span><span class="sxs-lookup"><span data-stu-id="08401-1271">To</span></span>|<span data-ttu-id="08401-1272">查看</span><span class="sxs-lookup"><span data-stu-id="08401-1272">See</span></span>|  
|--------|---------|  
|<span data-ttu-id="08401-1273">打开的文件 <xref:System.IO.StreamReader></span><span class="sxs-lookup"><span data-stu-id="08401-1273">Open a file with a <xref:System.IO.StreamReader></span></span>|[<span data-ttu-id="08401-1274">如何：从文件使用 StreamReader 读取文本</span><span class="sxs-lookup"><span data-stu-id="08401-1274">How to: Read Text from Files with a StreamReader</span></span>](~/docs/visual-basic/developing-apps/programming/drives-directories-files/how-to-read-text-from-files-with-a-streamreader.md)|  
  
   
  
## Examples  
 <span data-ttu-id="08401-1275">此示例打开文件`Testfile.txt`，读取一行，并显示在行`MessageBox`。</span><span class="sxs-lookup"><span data-stu-id="08401-1275">This example opens the file `Testfile.txt`, reads a line from it, and displays the line in a `MessageBox`.</span></span>  
  
 [!code-vb[VbRefFile#2](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbRefFile/VB/Class1.vb#2)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentException"><span data-ttu-id="08401-1276">文件名以反斜杠 (\\) 结尾。</span><span class="sxs-lookup"><span data-stu-id="08401-1276">The file name ends with a backslash (\\).</span></span></exception>
        <exception cref="T:System.IO.FileNotFoundException"><span data-ttu-id="08401-1277">找不到指定的文件。</span><span class="sxs-lookup"><span data-stu-id="08401-1277">The specified file cannot be found.</span></span></exception>
        <exception cref="T:System.Security.SecurityException"><span data-ttu-id="08401-1278">该用户缺少必要的权限来从文件中读取。</span><span class="sxs-lookup"><span data-stu-id="08401-1278">The user lacks necessary permissions to read from the file.</span></span></exception>
        <permission cref="T:System.Security.Permissions.FileIOPermission"><span data-ttu-id="08401-1279">控制文件和文件夹的访问权限。</span><span class="sxs-lookup"><span data-stu-id="08401-1279">Controls the ability to access files and folders.</span></span> <span data-ttu-id="08401-1280">关联枚举： <see cref="F:System.Security.Permissions.PermissionState.Unrestricted" />。</span><span class="sxs-lookup"><span data-stu-id="08401-1280">Associated enumeration: <see cref="F:System.Security.Permissions.PermissionState.Unrestricted" />.</span></span></permission>
        <altmember cref="T:System.Text.Encoding" />
        <altmember cref="T:System.IO.StreamReader" />
        <related type="Article" href="~/docs/visual-basic/language-reference/objects/index.md"><span data-ttu-id="08401-1281">对象 (Visual Basic)</span><span class="sxs-lookup"><span data-stu-id="08401-1281">Objects (Visual Basic)</span></span></related>
        <related type="Article" href="~/docs/visual-basic/developing-apps/programming/drives-directories-files/how-to-read-text-from-files-with-a-streamreader.md"><span data-ttu-id="08401-1282">如何：使用 StreamReader 读取文件中的文本 (Visual Basic)</span><span class="sxs-lookup"><span data-stu-id="08401-1282">How to: Read Text from Files with a StreamReader (Visual Basic)</span></span></related>
        <related type="Article" href="~/docs/visual-basic/developing-apps/programming/drives-directories-files/reading-from-files.md"><span data-ttu-id="08401-1283">从文件读取 (Visual Basic)</span><span class="sxs-lookup"><span data-stu-id="08401-1283">Reading from Files in Visual Basic</span></span></related>
      </Docs>
    </Member>
    <Member MemberName="OpenTextFileReader">
      <MemberSignature Language="C#" Value="public System.IO.StreamReader OpenTextFileReader (string file, System.Text.Encoding encoding);" />
      <MemberSignature Language="ILAsm" Value=".method public instance class System.IO.StreamReader OpenTextFileReader(string file, class System.Text.Encoding encoding) cil managed" />
      <MemberSignature Language="DocId" Value="M:Microsoft.VisualBasic.MyServices.FileSystemProxy.OpenTextFileReader(System.String,System.Text.Encoding)" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; System::IO::StreamReader ^ OpenTextFileReader(System::String ^ file, System::Text::Encoding ^ encoding);" />
      <MemberSignature Language="F#" Value="member this.OpenTextFileReader : string * System.Text.Encoding -&gt; System.IO.StreamReader" Usage="fileSystemProxy.OpenTextFileReader (file, encoding)" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>Microsoft.VisualBasic</AssemblyName>
        <AssemblyVersion>8.0.0.0</AssemblyVersion>
        <AssemblyVersion>10.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <AssemblyInfo>
        <AssemblyName>Microsoft.VisualBasic.Core</AssemblyName>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.IO.StreamReader</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="file" Type="System.String" Index="0" FrameworkAlternate="netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;netframework-4.8" />
        <Parameter Name="encoding" Type="System.Text.Encoding" Index="1" FrameworkAlternate="netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;netframework-4.8" />
      </Parameters>
      <Docs>
        <param name="file"><span data-ttu-id="08401-1284">要读取的文件。</span><span class="sxs-lookup"><span data-stu-id="08401-1284">File to be read.</span></span></param>
        <param name="encoding"><span data-ttu-id="08401-1285">要用于文件内容的编码。</span><span class="sxs-lookup"><span data-stu-id="08401-1285">The encoding to use for the file contents.</span></span> <span data-ttu-id="08401-1286">默认值为 ASCII。</span><span class="sxs-lookup"><span data-stu-id="08401-1286">Default is ASCII.</span></span></param>
        <summary><span data-ttu-id="08401-1287">此时将打开<see cref="T:System.IO.StreamReader" />要从文件读取对象。</span><span class="sxs-lookup"><span data-stu-id="08401-1287">Opens a <see cref="T:System.IO.StreamReader" /> object to read from a file.</span></span></summary>
        <returns><span data-ttu-id="08401-1288"><see cref="T:System.IO.StreamReader" /> 要从文件中读取对象</span><span class="sxs-lookup"><span data-stu-id="08401-1288"><see cref="T:System.IO.StreamReader" /> object to read from the file</span></span></returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="08401-1289">只有文本文件可以使用读取<xref:System.IO.StreamReader>。</span><span class="sxs-lookup"><span data-stu-id="08401-1289">Only text files can be read with a <xref:System.IO.StreamReader>.</span></span>  
  
 <span data-ttu-id="08401-1290">下表列出了所涉及的任务的示例`My.Computer.FileSystem.OpenTextFileReader`方法。</span><span class="sxs-lookup"><span data-stu-id="08401-1290">The following table lists examples of tasks involving the `My.Computer.FileSystem.OpenTextFileReader` method.</span></span>  
  
|<span data-ttu-id="08401-1291">功能</span><span class="sxs-lookup"><span data-stu-id="08401-1291">To</span></span>|<span data-ttu-id="08401-1292">查看</span><span class="sxs-lookup"><span data-stu-id="08401-1292">See</span></span>|  
|--------|---------|  
|<span data-ttu-id="08401-1293">打开的文件 <xref:System.IO.StreamReader></span><span class="sxs-lookup"><span data-stu-id="08401-1293">Open a file with a <xref:System.IO.StreamReader></span></span>|[<span data-ttu-id="08401-1294">如何：从文件使用 StreamReader 读取文本</span><span class="sxs-lookup"><span data-stu-id="08401-1294">How to: Read Text from Files with a StreamReader</span></span>](~/docs/visual-basic/developing-apps/programming/drives-directories-files/how-to-read-text-from-files-with-a-streamreader.md)|  
  
   
  
## Examples  
 <span data-ttu-id="08401-1295">此示例打开文件`Testfile.txt`，读取一行，并显示在行`MessageBox`。</span><span class="sxs-lookup"><span data-stu-id="08401-1295">This example opens the file `Testfile.txt`, reads a line from it, and displays the line in a `MessageBox`.</span></span>  
  
 [!code-vb[VbRefFile#2](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbRefFile/VB/Class1.vb#2)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentException"><span data-ttu-id="08401-1296">文件名以反斜杠 (\\) 结尾。</span><span class="sxs-lookup"><span data-stu-id="08401-1296">The file name ends with a backslash (\\).</span></span></exception>
        <exception cref="T:System.IO.FileNotFoundException"><span data-ttu-id="08401-1297">找不到指定的文件。</span><span class="sxs-lookup"><span data-stu-id="08401-1297">The specified file cannot be found.</span></span></exception>
        <exception cref="T:System.Security.SecurityException"><span data-ttu-id="08401-1298">该用户缺少必要的权限来从文件中读取。</span><span class="sxs-lookup"><span data-stu-id="08401-1298">The user lacks necessary permissions to read from the file.</span></span></exception>
        <permission cref="T:System.Security.Permissions.FileIOPermission"><span data-ttu-id="08401-1299">控制文件和文件夹的访问权限。</span><span class="sxs-lookup"><span data-stu-id="08401-1299">Controls the ability to access files and folders.</span></span> <span data-ttu-id="08401-1300">关联枚举： <see cref="F:System.Security.Permissions.PermissionState.Unrestricted" />。</span><span class="sxs-lookup"><span data-stu-id="08401-1300">Associated enumeration: <see cref="F:System.Security.Permissions.PermissionState.Unrestricted" />.</span></span></permission>
        <altmember cref="T:System.Text.Encoding" />
        <altmember cref="T:System.IO.StreamReader" />
        <related type="Article" href="~/docs/visual-basic/language-reference/objects/index.md"><span data-ttu-id="08401-1301">对象 (Visual Basic)</span><span class="sxs-lookup"><span data-stu-id="08401-1301">Objects (Visual Basic)</span></span></related>
        <related type="Article" href="~/docs/visual-basic/developing-apps/programming/drives-directories-files/how-to-read-text-from-files-with-a-streamreader.md"><span data-ttu-id="08401-1302">如何：使用 StreamReader 读取文件中的文本 (Visual Basic)</span><span class="sxs-lookup"><span data-stu-id="08401-1302">How to: Read Text from Files with a StreamReader (Visual Basic)</span></span></related>
        <related type="Article" href="~/docs/visual-basic/developing-apps/programming/drives-directories-files/reading-from-files.md"><span data-ttu-id="08401-1303">从文件读取 (Visual Basic)</span><span class="sxs-lookup"><span data-stu-id="08401-1303">Reading from Files in Visual Basic</span></span></related>
      </Docs>
    </Member>
    <MemberGroup MemberName="OpenTextFileWriter">
      <AssemblyInfo>
        <AssemblyName>Microsoft.VisualBasic</AssemblyName>
        <AssemblyVersion>10.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Docs>
        <summary><span data-ttu-id="08401-1304">此时将打开<see cref="T:System.IO.StreamWriter" />要写入到指定的文件对象。</span><span class="sxs-lookup"><span data-stu-id="08401-1304">Opens a <see cref="T:System.IO.StreamWriter" /> object to write to the specified file.</span></span></summary>
      </Docs>
    </MemberGroup>
    <Member MemberName="OpenTextFileWriter">
      <MemberSignature Language="C#" Value="public System.IO.StreamWriter OpenTextFileWriter (string file, bool append);" />
      <MemberSignature Language="ILAsm" Value=".method public instance class System.IO.StreamWriter OpenTextFileWriter(string file, bool append) cil managed" />
      <MemberSignature Language="DocId" Value="M:Microsoft.VisualBasic.MyServices.FileSystemProxy.OpenTextFileWriter(System.String,System.Boolean)" />
      <MemberSignature Language="VB.NET" Value="Public Function OpenTextFileWriter (file As String, append As Boolean) As StreamWriter" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; System::IO::StreamWriter ^ OpenTextFileWriter(System::String ^ file, bool append);" />
      <MemberSignature Language="F#" Value="member this.OpenTextFileWriter : string * bool -&gt; System.IO.StreamWriter" Usage="fileSystemProxy.OpenTextFileWriter (file, append)" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>Microsoft.VisualBasic</AssemblyName>
        <AssemblyVersion>8.0.0.0</AssemblyVersion>
        <AssemblyVersion>10.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <AssemblyInfo>
        <AssemblyName>Microsoft.VisualBasic.Core</AssemblyName>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.IO.StreamWriter</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="file" Type="System.String" Index="0" FrameworkAlternate="netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;netframework-4.8" />
        <Parameter Name="append" Type="System.Boolean" Index="1" FrameworkAlternate="netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;netframework-4.8" />
      </Parameters>
      <Docs>
        <param name="file"><span data-ttu-id="08401-1305">要写入到文件。</span><span class="sxs-lookup"><span data-stu-id="08401-1305">File to be written to.</span></span></param>
        <param name="append"><span data-ttu-id="08401-1306"><see langword="True" /> 要追加到该文件; 的内容<see langword="False" />覆盖该文件的内容。</span><span class="sxs-lookup"><span data-stu-id="08401-1306"><see langword="True" /> to append to the contents of the file; <see langword="False" /> to overwrite the contents of the file.</span></span> <span data-ttu-id="08401-1307">默认值为 <see langword="False" />。</span><span class="sxs-lookup"><span data-stu-id="08401-1307">Default is <see langword="False" />.</span></span></param>
        <summary><span data-ttu-id="08401-1308">此时将打开<see cref="T:System.IO.StreamWriter" />要写入到指定的文件对象。</span><span class="sxs-lookup"><span data-stu-id="08401-1308">Opens a <see cref="T:System.IO.StreamWriter" /> object to write to the specified file.</span></span></summary>
        <returns><span data-ttu-id="08401-1309"><see cref="T:System.IO.StreamWriter" /> 要写入到指定的文件的对象。</span><span class="sxs-lookup"><span data-stu-id="08401-1309"><see cref="T:System.IO.StreamWriter" /> object to write to the specified file.</span></span></returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="08401-1310">`OpenTextFileWriter`方法打开和初始化文件的流，然后返回<xref:System.IO.StreamWriter>该流的对象。</span><span class="sxs-lookup"><span data-stu-id="08401-1310">The `OpenTextFileWriter` method opens and initializes a stream for a file and then returns the <xref:System.IO.StreamWriter> object for that stream.</span></span> <span data-ttu-id="08401-1311">可以写入的流以根据需要多次并在完成时关闭它。</span><span class="sxs-lookup"><span data-stu-id="08401-1311">You can write to the steam as many times as necessary and then close it when you are finished.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="08401-1312">必须调用<xref:System.IO.StreamWriter.Close%2A>方法<xref:System.IO.StreamWriter>对象，以确保所有数据正确都写入基础流。</span><span class="sxs-lookup"><span data-stu-id="08401-1312">You must call the <xref:System.IO.StreamWriter.Close%2A> method on the <xref:System.IO.StreamWriter> object to make sure that all data is correctly written to the underlying stream.</span></span>  
  
 <span data-ttu-id="08401-1313">如果只有几个字符串写入文件，则可能是更易于使用<xref:Microsoft.VisualBasic.MyServices.FileSystemProxy.WriteAllText%2A>方法。</span><span class="sxs-lookup"><span data-stu-id="08401-1313">If you are writing only a few strings to a file, it might be simpler to use the <xref:Microsoft.VisualBasic.MyServices.FileSystemProxy.WriteAllText%2A> method.</span></span>  
  
 <span data-ttu-id="08401-1314">下表列出的任务涉及示例`My.Computer.FileSystem.OpenTextFileWriter`方法。</span><span class="sxs-lookup"><span data-stu-id="08401-1314">The following table lists an example of a task involving the `My.Computer.FileSystem.OpenTextFileWriter` method.</span></span>  
  
|<span data-ttu-id="08401-1315">功能</span><span class="sxs-lookup"><span data-stu-id="08401-1315">To</span></span>|<span data-ttu-id="08401-1316">查看</span><span class="sxs-lookup"><span data-stu-id="08401-1316">See</span></span>|  
|--------|---------|  
|<span data-ttu-id="08401-1317">向文件写入文本 `StreamWriter`</span><span class="sxs-lookup"><span data-stu-id="08401-1317">Write text to a file with a `StreamWriter`</span></span>|[<span data-ttu-id="08401-1318">如何：使用 StreamWriter 向文件写入文本</span><span class="sxs-lookup"><span data-stu-id="08401-1318">How to: Write Text to Files with a StreamWriter</span></span>](~/docs/visual-basic/developing-apps/programming/drives-directories-files/how-to-write-text-to-files-with-a-streamwriter.md)|  
  
   
  
## Examples  
 <span data-ttu-id="08401-1319">此示例打开<xref:System.IO.StreamWriter>与`My.Computer.FileSystem.OpenTextFileWriter`方法并使用它来将字符串写入文本文件`WriteLine`方法的`StreamWriter`类。</span><span class="sxs-lookup"><span data-stu-id="08401-1319">This example opens a <xref:System.IO.StreamWriter> with the `My.Computer.FileSystem.OpenTextFileWriter` method and uses it to write a string to a text file with the `WriteLine` method of the `StreamWriter` class.</span></span>  
  
 [!code-vb[VbRefFile#14](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbRefFile/VB/Class1.vb#14)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentException"><span data-ttu-id="08401-1320">文件名称以尾部反斜杠结尾。</span><span class="sxs-lookup"><span data-stu-id="08401-1320">The file name ends with a trailing slash.</span></span></exception>
        <permission cref="T:System.Security.Permissions.FileIOPermission"><span data-ttu-id="08401-1321">控制文件和文件夹的访问权限。</span><span class="sxs-lookup"><span data-stu-id="08401-1321">Controls the ability to access files and folders.</span></span> <span data-ttu-id="08401-1322">关联枚举： <see cref="F:System.Security.Permissions.PermissionState.Unrestricted" />。</span><span class="sxs-lookup"><span data-stu-id="08401-1322">Associated enumeration: <see cref="F:System.Security.Permissions.PermissionState.Unrestricted" />.</span></span></permission>
        <altmember cref="T:System.Text.Encoding" />
        <altmember cref="T:System.IO.StreamWriter" />
        <related type="Article" href="~/docs/visual-basic/language-reference/objects/index.md"><span data-ttu-id="08401-1323">对象 (Visual Basic)</span><span class="sxs-lookup"><span data-stu-id="08401-1323">Objects (Visual Basic)</span></span></related>
        <related type="Article" href="~/docs/visual-basic/developing-apps/programming/drives-directories-files/how-to-write-text-to-files-with-a-streamwriter.md"><span data-ttu-id="08401-1324">如何：向具有 Streamwriter (Visual Basic 中) 的文件写入文本</span><span class="sxs-lookup"><span data-stu-id="08401-1324">How to: Write Text to a File with a Streamwriter (Visual Basic)</span></span></related>
      </Docs>
    </Member>
    <Member MemberName="OpenTextFileWriter">
      <MemberSignature Language="C#" Value="public System.IO.StreamWriter OpenTextFileWriter (string file, bool append, System.Text.Encoding encoding);" />
      <MemberSignature Language="ILAsm" Value=".method public instance class System.IO.StreamWriter OpenTextFileWriter(string file, bool append, class System.Text.Encoding encoding) cil managed" />
      <MemberSignature Language="DocId" Value="M:Microsoft.VisualBasic.MyServices.FileSystemProxy.OpenTextFileWriter(System.String,System.Boolean,System.Text.Encoding)" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; System::IO::StreamWriter ^ OpenTextFileWriter(System::String ^ file, bool append, System::Text::Encoding ^ encoding);" />
      <MemberSignature Language="F#" Value="member this.OpenTextFileWriter : string * bool * System.Text.Encoding -&gt; System.IO.StreamWriter" Usage="fileSystemProxy.OpenTextFileWriter (file, append, encoding)" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>Microsoft.VisualBasic</AssemblyName>
        <AssemblyVersion>8.0.0.0</AssemblyVersion>
        <AssemblyVersion>10.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <AssemblyInfo>
        <AssemblyName>Microsoft.VisualBasic.Core</AssemblyName>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.IO.StreamWriter</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="file" Type="System.String" Index="0" FrameworkAlternate="netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;netframework-4.8" />
        <Parameter Name="append" Type="System.Boolean" Index="1" FrameworkAlternate="netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;netframework-4.8" />
        <Parameter Name="encoding" Type="System.Text.Encoding" Index="2" FrameworkAlternate="netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;netframework-4.8" />
      </Parameters>
      <Docs>
        <param name="file"><span data-ttu-id="08401-1325">要写入到文件。</span><span class="sxs-lookup"><span data-stu-id="08401-1325">File to be written to.</span></span></param>
        <param name="append"><span data-ttu-id="08401-1326"><see langword="True" /> 若要追加到文件; 中的内容<see langword="False" />覆盖该文件的内容。</span><span class="sxs-lookup"><span data-stu-id="08401-1326"><see langword="True" /> to append to the contents in the file; <see langword="False" /> to overwrite the contents of the file.</span></span> <span data-ttu-id="08401-1327">默认值为 <see langword="False" />。</span><span class="sxs-lookup"><span data-stu-id="08401-1327">Default is <see langword="False" />.</span></span></param>
        <param name="encoding"><span data-ttu-id="08401-1328">要在写入到文件中使用的编码。</span><span class="sxs-lookup"><span data-stu-id="08401-1328">Encoding to be used in writing to the file.</span></span> <span data-ttu-id="08401-1329">默认值为 ASCII。</span><span class="sxs-lookup"><span data-stu-id="08401-1329">Default is ASCII.</span></span></param>
        <summary><span data-ttu-id="08401-1330">此时将打开<see cref="T:System.IO.StreamWriter" />要写入到指定的文件。</span><span class="sxs-lookup"><span data-stu-id="08401-1330">Opens a <see cref="T:System.IO.StreamWriter" /> to write to the specified file.</span></span></summary>
        <returns><span data-ttu-id="08401-1331"><see cref="T:System.IO.StreamWriter" /> 要写入到指定的文件的对象。</span><span class="sxs-lookup"><span data-stu-id="08401-1331"><see cref="T:System.IO.StreamWriter" /> object to write to the specified file.</span></span></returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="08401-1332">`OpenTextFileWriter`方法打开和初始化文件的流，然后返回<xref:System.IO.StreamWriter>该流的对象。</span><span class="sxs-lookup"><span data-stu-id="08401-1332">The `OpenTextFileWriter` method opens and initializes a stream for a file and then returns the <xref:System.IO.StreamWriter> object for that stream.</span></span> <span data-ttu-id="08401-1333">可以写入的流以根据需要多次并在完成时关闭它。</span><span class="sxs-lookup"><span data-stu-id="08401-1333">You can write to the steam as many times as necessary and then close it when you are finished.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="08401-1334">必须调用<xref:System.IO.StreamWriter.Close%2A>方法<xref:System.IO.StreamWriter>对象，以确保所有数据正确都写入基础流。</span><span class="sxs-lookup"><span data-stu-id="08401-1334">You must call the <xref:System.IO.StreamWriter.Close%2A> method on the <xref:System.IO.StreamWriter> object to make sure that all data is correctly written to the underlying stream.</span></span>  
  
 <span data-ttu-id="08401-1335">如果只有几个字符串写入文件，则可能是更易于使用<xref:Microsoft.VisualBasic.MyServices.FileSystemProxy.WriteAllText%2A>方法。</span><span class="sxs-lookup"><span data-stu-id="08401-1335">If you are writing only a few strings to a file, it might be simpler to use the <xref:Microsoft.VisualBasic.MyServices.FileSystemProxy.WriteAllText%2A> method.</span></span>  
  
 <span data-ttu-id="08401-1336">下表列出的任务涉及示例`My.Computer.FileSystem.OpenTextFileWriter`方法。</span><span class="sxs-lookup"><span data-stu-id="08401-1336">The following table lists an example of a task involving the `My.Computer.FileSystem.OpenTextFileWriter` method.</span></span>  
  
|<span data-ttu-id="08401-1337">功能</span><span class="sxs-lookup"><span data-stu-id="08401-1337">To</span></span>|<span data-ttu-id="08401-1338">查看</span><span class="sxs-lookup"><span data-stu-id="08401-1338">See</span></span>|  
|--------|---------|  
|<span data-ttu-id="08401-1339">向文件写入文本 `StreamWriter`</span><span class="sxs-lookup"><span data-stu-id="08401-1339">Write text to a file with a `StreamWriter`</span></span>|[<span data-ttu-id="08401-1340">如何：使用 StreamWriter 向文件写入文本</span><span class="sxs-lookup"><span data-stu-id="08401-1340">How to: Write Text to Files with a StreamWriter</span></span>](~/docs/visual-basic/developing-apps/programming/drives-directories-files/how-to-write-text-to-files-with-a-streamwriter.md)|  
  
   
  
## Examples  
 <span data-ttu-id="08401-1341">此示例打开<xref:System.IO.StreamWriter>与`My.Computer.FileSystem.OpenTextFileWriter`方法并使用它来将字符串写入文本文件`WriteLine`方法的`StreamWriter`类。</span><span class="sxs-lookup"><span data-stu-id="08401-1341">This example opens a <xref:System.IO.StreamWriter> with the `My.Computer.FileSystem.OpenTextFileWriter` method and uses it to write a string to a text file with the `WriteLine` method of the `StreamWriter` class.</span></span>  
  
 [!code-vb[VbRefFile#14](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbRefFile/VB/Class1.vb#14)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentException"><span data-ttu-id="08401-1342">文件名称以尾部反斜杠结尾。</span><span class="sxs-lookup"><span data-stu-id="08401-1342">The file name ends with a trailing slash.</span></span></exception>
        <permission cref="T:System.Security.Permissions.FileIOPermission"><span data-ttu-id="08401-1343">控制文件和文件夹的访问权限。</span><span class="sxs-lookup"><span data-stu-id="08401-1343">Controls the ability to access files and folders.</span></span> <span data-ttu-id="08401-1344">关联枚举： <see cref="F:System.Security.Permissions.PermissionState.Unrestricted" />。</span><span class="sxs-lookup"><span data-stu-id="08401-1344">Associated enumeration: <see cref="F:System.Security.Permissions.PermissionState.Unrestricted" />.</span></span></permission>
        <altmember cref="T:System.Text.Encoding" />
        <altmember cref="T:System.IO.StreamWriter" />
        <related type="Article" href="~/docs/visual-basic/language-reference/objects/index.md"><span data-ttu-id="08401-1345">对象 (Visual Basic)</span><span class="sxs-lookup"><span data-stu-id="08401-1345">Objects (Visual Basic)</span></span></related>
        <related type="Article" href="~/docs/visual-basic/developing-apps/programming/drives-directories-files/how-to-write-text-to-files-with-a-streamwriter.md"><span data-ttu-id="08401-1346">如何：向具有 Streamwriter (Visual Basic 中) 的文件写入文本</span><span class="sxs-lookup"><span data-stu-id="08401-1346">How to: Write Text to a File with a Streamwriter (Visual Basic)</span></span></related>
      </Docs>
    </Member>
    <Member MemberName="ReadAllBytes">
      <MemberSignature Language="C#" Value="public byte[] ReadAllBytes (string file);" />
      <MemberSignature Language="ILAsm" Value=".method public instance unsigned int8[] ReadAllBytes(string file) cil managed" />
      <MemberSignature Language="DocId" Value="M:Microsoft.VisualBasic.MyServices.FileSystemProxy.ReadAllBytes(System.String)" />
      <MemberSignature Language="VB.NET" Value="Public Function ReadAllBytes (file As String) As Byte()" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; cli::array &lt;System::Byte&gt; ^ ReadAllBytes(System::String ^ file);" />
      <MemberSignature Language="F#" Value="member this.ReadAllBytes : string -&gt; byte[]" Usage="fileSystemProxy.ReadAllBytes file" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>Microsoft.VisualBasic</AssemblyName>
        <AssemblyVersion>8.0.0.0</AssemblyVersion>
        <AssemblyVersion>10.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <AssemblyInfo>
        <AssemblyName>Microsoft.VisualBasic.Core</AssemblyName>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Byte[]</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="file" Type="System.String" Index="0" FrameworkAlternate="netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;netframework-4.8" />
      </Parameters>
      <Docs>
        <param name="file"><span data-ttu-id="08401-1347">要读取的文件。</span><span class="sxs-lookup"><span data-stu-id="08401-1347">File to be read.</span></span></param>
        <summary><span data-ttu-id="08401-1348">字节数组的形式返回文件的内容。</span><span class="sxs-lookup"><span data-stu-id="08401-1348">Returns the contents of a file as a byte array.</span></span></summary>
        <returns><span data-ttu-id="08401-1349"><see langword="Byte" /> 数组，其中包含该文件的内容。</span><span class="sxs-lookup"><span data-stu-id="08401-1349"><see langword="Byte" /> array containing the contents of the file.</span></span></returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="08401-1350">`ReadAllBytes`方法的`My.Computer.FileSystem`对象使用户可以从二进制文件中读取。</span><span class="sxs-lookup"><span data-stu-id="08401-1350">The `ReadAllBytes` method of the `My.Computer.FileSystem` object allows you to read from a binary file.</span></span> <span data-ttu-id="08401-1351">该文件的内容作为字节数组返回。</span><span class="sxs-lookup"><span data-stu-id="08401-1351">The contents of the file are returned as a byte array.</span></span>  
  
 <span data-ttu-id="08401-1352">不要根据文件的名称来判断文件的内容。</span><span class="sxs-lookup"><span data-stu-id="08401-1352">Do not make decisions about the contents of the file based on the name of the file.</span></span> <span data-ttu-id="08401-1353">例如，文件 Form1.vb 可能不是 Visual Basic 源文件。</span><span class="sxs-lookup"><span data-stu-id="08401-1353">For example, the file Form1.vb may not be a Visual Basic source file.</span></span> <span data-ttu-id="08401-1354">在应用程序中使用输入的数据之前，需验证所有的输入内容。</span><span class="sxs-lookup"><span data-stu-id="08401-1354">Verify all inputs before using the data in your application.</span></span>  
  
 <span data-ttu-id="08401-1355">下表列出了所涉及的任务的示例`My.Computer.FileSystem.ReadAllBytes`方法。</span><span class="sxs-lookup"><span data-stu-id="08401-1355">The following table lists examples of tasks involving the `My.Computer.FileSystem.ReadAllBytes` method.</span></span>  
  
|<span data-ttu-id="08401-1356">功能</span><span class="sxs-lookup"><span data-stu-id="08401-1356">To</span></span>|<span data-ttu-id="08401-1357">查看</span><span class="sxs-lookup"><span data-stu-id="08401-1357">See</span></span>|  
|--------|---------|  
|<span data-ttu-id="08401-1358">从二进制文件读取</span><span class="sxs-lookup"><span data-stu-id="08401-1358">Read from a binary file</span></span>|[<span data-ttu-id="08401-1359">如何：读取二进制文件</span><span class="sxs-lookup"><span data-stu-id="08401-1359">How to: Read From Binary Files</span></span>](~/docs/visual-basic/developing-apps/programming/drives-directories-files/how-to-read-from-binary-files.md)|  
  
   
  
## Examples  
 <span data-ttu-id="08401-1360">此示例从文件读取 `C:/Documents and Settings/selfportrait.jpg.`</span><span class="sxs-lookup"><span data-stu-id="08401-1360">This example reads from the file `C:/Documents and Settings/selfportrait.jpg.`</span></span>  
  
 [!code-vb[VbVbcnMyFileSystem#33](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbcnMyFileSystem/VB/Class1.vb#33)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentException"><span data-ttu-id="08401-1361">路径由于以下原因之一无效：是零长度字符串；仅为空白；包含无效字符；是一个设备路径（以 \\\\.\\ 开头）；以尾部反斜杠结尾。</span><span class="sxs-lookup"><span data-stu-id="08401-1361">The path is not valid for one of the following reasons: it is a zero-length string; it contains only white space; it contains invalid characters; or it is a device path (starts with \\\\.\\); it ends with a trailing slash.</span></span></exception>
        <exception cref="T:System.ArgumentNullException"><span data-ttu-id="08401-1362"><paramref name="file" /> 为 <see langword="Nothing" />。</span><span class="sxs-lookup"><span data-stu-id="08401-1362"><paramref name="file" /> is <see langword="Nothing" />.</span></span></exception>
        <exception cref="T:System.IO.FileNotFoundException"><span data-ttu-id="08401-1363">文件不存在。</span><span class="sxs-lookup"><span data-stu-id="08401-1363">The file does not exist.</span></span></exception>
        <exception cref="T:System.IO.IOException"><span data-ttu-id="08401-1364">文件正由另一个进程使用或者出现 I/O 错误。</span><span class="sxs-lookup"><span data-stu-id="08401-1364">The file is in use by another process, or an I/O error occurs.</span></span></exception>
        <exception cref="T:System.IO.PathTooLongException"><span data-ttu-id="08401-1365">路径超过系统定义的最大长度。</span><span class="sxs-lookup"><span data-stu-id="08401-1365">The path exceeds the system-defined maximum length.</span></span></exception>
        <exception cref="T:System.NotSupportedException"><span data-ttu-id="08401-1366">在路径中的文件或目录名称包含冒号 （:），或格式无效。</span><span class="sxs-lookup"><span data-stu-id="08401-1366">A file or directory name in the path contains a colon (:) or is in an invalid format.</span></span></exception>
        <exception cref="T:System.OutOfMemoryException"><span data-ttu-id="08401-1367">不是内存不足，无法将字符串写入缓冲区。</span><span class="sxs-lookup"><span data-stu-id="08401-1367">There is not enough memory to write the string to buffer.</span></span></exception>
        <exception cref="T:System.Security.SecurityException"><span data-ttu-id="08401-1368">该用户缺少必要的权限查看该路径。</span><span class="sxs-lookup"><span data-stu-id="08401-1368">The user lacks necessary permissions to view the path.</span></span></exception>
        <permission cref="T:System.Security.Permissions.FileIOPermission"><span data-ttu-id="08401-1369">控制文件和文件夹的访问权限。</span><span class="sxs-lookup"><span data-stu-id="08401-1369">Controls the ability to access files and folders.</span></span> <span data-ttu-id="08401-1370">关联枚举： <see cref="F:System.Security.Permissions.PermissionState.Unrestricted" />。</span><span class="sxs-lookup"><span data-stu-id="08401-1370">Associated enumeration: <see cref="F:System.Security.Permissions.PermissionState.Unrestricted" />.</span></span></permission>
        <related type="Article" href="~/docs/visual-basic/language-reference/objects/index.md"><span data-ttu-id="08401-1371">对象 (Visual Basic)</span><span class="sxs-lookup"><span data-stu-id="08401-1371">Objects (Visual Basic)</span></span></related>
        <related type="Article" href="~/docs/visual-basic/developing-apps/programming/drives-directories-files/reading-from-files.md"><span data-ttu-id="08401-1372">从文件读取 (Visual Basic)</span><span class="sxs-lookup"><span data-stu-id="08401-1372">Reading from Files in Visual Basic</span></span></related>
      </Docs>
    </Member>
    <MemberGroup MemberName="ReadAllText">
      <AssemblyInfo>
        <AssemblyName>Microsoft.VisualBasic</AssemblyName>
        <AssemblyVersion>10.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Docs>
        <summary><span data-ttu-id="08401-1373">返回一个文本文件作为内容<see langword="String" />。</span><span class="sxs-lookup"><span data-stu-id="08401-1373">Returns the contents of a text file as a <see langword="String" />.</span></span></summary>
      </Docs>
    </MemberGroup>
    <Member MemberName="ReadAllText">
      <MemberSignature Language="C#" Value="public string ReadAllText (string file);" />
      <MemberSignature Language="ILAsm" Value=".method public instance string ReadAllText(string file) cil managed" />
      <MemberSignature Language="DocId" Value="M:Microsoft.VisualBasic.MyServices.FileSystemProxy.ReadAllText(System.String)" />
      <MemberSignature Language="VB.NET" Value="Public Function ReadAllText (file As String) As String" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; System::String ^ ReadAllText(System::String ^ file);" />
      <MemberSignature Language="F#" Value="member this.ReadAllText : string -&gt; string" Usage="fileSystemProxy.ReadAllText file" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>Microsoft.VisualBasic</AssemblyName>
        <AssemblyVersion>8.0.0.0</AssemblyVersion>
        <AssemblyVersion>10.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <AssemblyInfo>
        <AssemblyName>Microsoft.VisualBasic.Core</AssemblyName>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.String</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="file" Type="System.String" Index="0" FrameworkAlternate="netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;netframework-4.8" />
      </Parameters>
      <Docs>
        <param name="file"><span data-ttu-id="08401-1374">名称和要读取的文件的路径。</span><span class="sxs-lookup"><span data-stu-id="08401-1374">Name and path of the file to read.</span></span></param>
        <summary><span data-ttu-id="08401-1375">返回一个文本文件作为内容<see langword="String" />。</span><span class="sxs-lookup"><span data-stu-id="08401-1375">Returns the contents of a text file as a <see langword="String" />.</span></span></summary>
        <returns><span data-ttu-id="08401-1376"><see langword="String" /> 包含文件的内容。</span><span class="sxs-lookup"><span data-stu-id="08401-1376"><see langword="String" /> containing the contents of the file.</span></span></returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="08401-1377">通过 `ReadAllText` 对象的 `My.Computer.FileSystem` 方法，可以读取文本文件。</span><span class="sxs-lookup"><span data-stu-id="08401-1377">The `ReadAllText` method of the `My.Computer.FileSystem` object allows you to read from a text file.</span></span> <span data-ttu-id="08401-1378">以字符串形式返回文件的内容。</span><span class="sxs-lookup"><span data-stu-id="08401-1378">The contents of the file are returned as a string.</span></span>  
  
 <span data-ttu-id="08401-1379">文件编码可以是指定文件的内容将按类似 ASCII 或 utf-8 编码。</span><span class="sxs-lookup"><span data-stu-id="08401-1379">The file encoding can be specified if the contents of the file are in an encoding such as ASCII or UTF-8.</span></span> <span data-ttu-id="08401-1380">如果您要读取包含扩展字符的文件，则需要指定文件编码使用的另一个重载<xref:Microsoft.VisualBasic.MyServices.FileSystemProxy.ReadAllText%2A>方法。</span><span class="sxs-lookup"><span data-stu-id="08401-1380">If you are reading from a file with extended characters, you need to specify the file encoding using another overload of the <xref:Microsoft.VisualBasic.MyServices.FileSystemProxy.ReadAllText%2A> method.</span></span>  
  
 <span data-ttu-id="08401-1381">不要根据文件的名称来判断文件的内容。</span><span class="sxs-lookup"><span data-stu-id="08401-1381">Do not make decisions about the contents of the file based on the name of the file.</span></span> <span data-ttu-id="08401-1382">例如，文件 Form1.vb 可能不是 Visual Basic 源文件。</span><span class="sxs-lookup"><span data-stu-id="08401-1382">For example, the file Form1.vb may not be a Visual Basic source file.</span></span> <span data-ttu-id="08401-1383">在应用程序中使用输入的数据之前，需验证所有的输入内容。</span><span class="sxs-lookup"><span data-stu-id="08401-1383">Verify all inputs before using the data in your application.</span></span>  
  
 <span data-ttu-id="08401-1384">下表列出了所涉及的任务的示例`My.Computer.FileSystem.ReadAllText`方法。</span><span class="sxs-lookup"><span data-stu-id="08401-1384">The following table lists examples of tasks involving the `My.Computer.FileSystem.ReadAllText` method.</span></span>  
  
|<span data-ttu-id="08401-1385">功能</span><span class="sxs-lookup"><span data-stu-id="08401-1385">To</span></span>|<span data-ttu-id="08401-1386">查看</span><span class="sxs-lookup"><span data-stu-id="08401-1386">See</span></span>|  
|--------|---------|  
|<span data-ttu-id="08401-1387">从文本文件读取</span><span class="sxs-lookup"><span data-stu-id="08401-1387">Read from a text file</span></span>|[<span data-ttu-id="08401-1388">如何：读取文本文件</span><span class="sxs-lookup"><span data-stu-id="08401-1388">How to: Read from Text Files</span></span>](~/docs/visual-basic/developing-apps/programming/drives-directories-files/how-to-read-from-text-files.md)|  
  
   
  
## Examples  
 <span data-ttu-id="08401-1389">此示例读取的内容`Test.txt`转换为字符串，然后在消息框中显示内容。</span><span class="sxs-lookup"><span data-stu-id="08401-1389">This example reads the contents of `Test.txt` into a string and then displays it in a message box.</span></span>  
  
 [!code-vb[VbRefFile#8](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbRefFile/VB/Class1.vb#8)]  
  
 <span data-ttu-id="08401-1390">此示例读取 ASCII 文件的内容`Test.txt`转换为字符串，然后在消息框中显示内容。</span><span class="sxs-lookup"><span data-stu-id="08401-1390">This example reads the contents of the ASCII file `Test.txt` into a string and then displays it in a message box.</span></span>  
  
 [!code-vb[VbRefFile#9](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbRefFile/VB/Class1.vb#9)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentException"><span data-ttu-id="08401-1391">路径由于以下原因之一无效：是零长度字符串；仅为空白；包含无效字符；是一个设备路径（以 \\\\.\\ 开头）；以尾部反斜杠结尾。</span><span class="sxs-lookup"><span data-stu-id="08401-1391">The path is not valid for one of the following reasons: it is a zero-length string; it contains only white space; it contains invalid characters; or it is a device path (starts with \\\\.\\); it ends with a trailing slash.</span></span></exception>
        <exception cref="T:System.ArgumentNullException"><span data-ttu-id="08401-1392"><paramref name="file" /> 为 <see langword="Nothing" />。</span><span class="sxs-lookup"><span data-stu-id="08401-1392"><paramref name="file" /> is <see langword="Nothing" />.</span></span></exception>
        <exception cref="T:System.IO.FileNotFoundException"><span data-ttu-id="08401-1393">文件不存在。</span><span class="sxs-lookup"><span data-stu-id="08401-1393">The file does not exist.</span></span></exception>
        <exception cref="T:System.IO.IOException"><span data-ttu-id="08401-1394">文件正由另一个进程使用或者出现 I/O 错误。</span><span class="sxs-lookup"><span data-stu-id="08401-1394">The file is in use by another process, or an I/O error occurs.</span></span></exception>
        <exception cref="T:System.IO.PathTooLongException"><span data-ttu-id="08401-1395">路径超过系统定义的最大长度。</span><span class="sxs-lookup"><span data-stu-id="08401-1395">The path exceeds the system-defined maximum length.</span></span></exception>
        <exception cref="T:System.NotSupportedException"><span data-ttu-id="08401-1396">在路径中的文件或目录名称包含冒号 （:），或格式无效。</span><span class="sxs-lookup"><span data-stu-id="08401-1396">A file or directory name in the path contains a colon (:) or is in an invalid format.</span></span></exception>
        <exception cref="T:System.OutOfMemoryException"><span data-ttu-id="08401-1397">不是内存不足，无法将字符串写入缓冲区。</span><span class="sxs-lookup"><span data-stu-id="08401-1397">There is not enough memory to write the string to buffer.</span></span></exception>
        <exception cref="T:System.Security.SecurityException"><span data-ttu-id="08401-1398">该用户缺少必要的权限查看该路径。</span><span class="sxs-lookup"><span data-stu-id="08401-1398">The user lacks necessary permissions to view the path.</span></span></exception>
        <permission cref="T:System.Security.Permissions.FileIOPermission"><span data-ttu-id="08401-1399">控制文件和文件夹的访问权限。</span><span class="sxs-lookup"><span data-stu-id="08401-1399">Controls the ability to access files and folders.</span></span> <span data-ttu-id="08401-1400">关联枚举： <see cref="F:System.Security.Permissions.PermissionState.Unrestricted" />。</span><span class="sxs-lookup"><span data-stu-id="08401-1400">Associated enumeration: <see cref="F:System.Security.Permissions.PermissionState.Unrestricted" />.</span></span></permission>
        <altmember cref="T:System.Text.Encoding" />
        <altmember cref="M:Microsoft.VisualBasic.MyServices.FileSystemProxy.ReadAllText(System.String)" />
        <altmember cref="M:System.IO.StreamReader.#ctor(System.IO.Stream,System.Text.Encoding)" />
        <related type="Article" href="~/docs/visual-basic/language-reference/objects/index.md"><span data-ttu-id="08401-1401">对象 (Visual Basic)</span><span class="sxs-lookup"><span data-stu-id="08401-1401">Objects (Visual Basic)</span></span></related>
        <related type="Article" href="~/docs/visual-basic/developing-apps/programming/drives-directories-files/reading-from-files.md"><span data-ttu-id="08401-1402">从文件读取 (Visual Basic)</span><span class="sxs-lookup"><span data-stu-id="08401-1402">Reading from Files in Visual Basic</span></span></related>
        <related type="Article" href="~/docs/visual-basic/developing-apps/programming/drives-directories-files/how-to-read-text-from-files-with-a-streamreader.md"><span data-ttu-id="08401-1403">如何：使用 StreamReader 读取文件中的文本 (Visual Basic)</span><span class="sxs-lookup"><span data-stu-id="08401-1403">How to: Read Text from Files with a StreamReader (Visual Basic)</span></span></related>
        <related type="Article" href="~/docs/visual-basic/developing-apps/programming/drives-directories-files/troubleshooting-reading-from-and-writing-to-text-files.md"><span data-ttu-id="08401-1404">疑难解答：读取和写入文本文件</span><span class="sxs-lookup"><span data-stu-id="08401-1404">Troubleshooting: Reading from and Writing to Text Files</span></span></related>
        <related type="Article" href="~/docs/visual-basic/developing-apps/programming/drives-directories-files/walkthrough-manipulating-files-and-directories.md"><span data-ttu-id="08401-1405">演练：在 Visual Basic 中操作文件和目录</span><span class="sxs-lookup"><span data-stu-id="08401-1405">Walkthrough: Manipulating Files and Directories in Visual Basic</span></span></related>
        <related type="Article" href="~/docs/visual-basic/developing-apps/programming/drives-directories-files/file-encodings.md"><span data-ttu-id="08401-1406">文件编码</span><span class="sxs-lookup"><span data-stu-id="08401-1406">File Encodings</span></span></related>
      </Docs>
    </Member>
    <Member MemberName="ReadAllText">
      <MemberSignature Language="C#" Value="public string ReadAllText (string file, System.Text.Encoding encoding);" />
      <MemberSignature Language="ILAsm" Value=".method public instance string ReadAllText(string file, class System.Text.Encoding encoding) cil managed" />
      <MemberSignature Language="DocId" Value="M:Microsoft.VisualBasic.MyServices.FileSystemProxy.ReadAllText(System.String,System.Text.Encoding)" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; System::String ^ ReadAllText(System::String ^ file, System::Text::Encoding ^ encoding);" />
      <MemberSignature Language="F#" Value="member this.ReadAllText : string * System.Text.Encoding -&gt; string" Usage="fileSystemProxy.ReadAllText (file, encoding)" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>Microsoft.VisualBasic</AssemblyName>
        <AssemblyVersion>8.0.0.0</AssemblyVersion>
        <AssemblyVersion>10.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <AssemblyInfo>
        <AssemblyName>Microsoft.VisualBasic.Core</AssemblyName>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.String</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="file" Type="System.String" Index="0" FrameworkAlternate="netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;netframework-4.8" />
        <Parameter Name="encoding" Type="System.Text.Encoding" Index="1" FrameworkAlternate="netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;netframework-4.8" />
      </Parameters>
      <Docs>
        <param name="file"><span data-ttu-id="08401-1407">名称和要读取的文件的路径。</span><span class="sxs-lookup"><span data-stu-id="08401-1407">Name and path of the file to read.</span></span></param>
        <param name="encoding"><span data-ttu-id="08401-1408">要在读取文件中使用字符编码。</span><span class="sxs-lookup"><span data-stu-id="08401-1408">Character encoding to use in reading the file.</span></span> <span data-ttu-id="08401-1409">默认值为 utf-8。</span><span class="sxs-lookup"><span data-stu-id="08401-1409">Default is UTF-8.</span></span></param>
        <summary><span data-ttu-id="08401-1410">返回一个文本文件作为内容<see langword="String" />。</span><span class="sxs-lookup"><span data-stu-id="08401-1410">Returns the contents of a text file as a <see langword="String" />.</span></span></summary>
        <returns><span data-ttu-id="08401-1411"><see langword="String" /> 包含文件的内容。</span><span class="sxs-lookup"><span data-stu-id="08401-1411"><see langword="String" /> containing the contents of the file.</span></span></returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="08401-1412">通过 `ReadAllText` 对象的 `My.Computer.FileSystem` 方法，可以读取文本文件。</span><span class="sxs-lookup"><span data-stu-id="08401-1412">The `ReadAllText` method of the `My.Computer.FileSystem` object allows you to read from a text file.</span></span> <span data-ttu-id="08401-1413">以字符串形式返回文件的内容。</span><span class="sxs-lookup"><span data-stu-id="08401-1413">The contents of the file are returned as a string.</span></span>  
  
 <span data-ttu-id="08401-1414">文件编码可以是指定文件的内容将按类似 ASCII 或 utf-8 编码。</span><span class="sxs-lookup"><span data-stu-id="08401-1414">The file encoding can be specified if the contents of the file are in an encoding such as ASCII or UTF-8.</span></span> <span data-ttu-id="08401-1415">如果您要读取包含扩展字符的文件，您需要指定文件编码。</span><span class="sxs-lookup"><span data-stu-id="08401-1415">If you are reading from a file with extended characters, you need to specify the file encoding.</span></span>  
  
 <span data-ttu-id="08401-1416">不要根据文件的名称来判断文件的内容。</span><span class="sxs-lookup"><span data-stu-id="08401-1416">Do not make decisions about the contents of the file based on the name of the file.</span></span> <span data-ttu-id="08401-1417">例如，文件 Form1.vb 可能不是 Visual Basic 源文件。</span><span class="sxs-lookup"><span data-stu-id="08401-1417">For example, the file Form1.vb may not be a Visual Basic source file.</span></span> <span data-ttu-id="08401-1418">在应用程序中使用输入的数据之前，需验证所有的输入内容。</span><span class="sxs-lookup"><span data-stu-id="08401-1418">Verify all inputs before using the data in your application.</span></span>  
  
 <span data-ttu-id="08401-1419">下表列出了所涉及的任务的示例`My.Computer.FileSystem.ReadAllText`方法。</span><span class="sxs-lookup"><span data-stu-id="08401-1419">The following table lists examples of tasks involving the `My.Computer.FileSystem.ReadAllText` method.</span></span>  
  
|<span data-ttu-id="08401-1420">功能</span><span class="sxs-lookup"><span data-stu-id="08401-1420">To</span></span>|<span data-ttu-id="08401-1421">查看</span><span class="sxs-lookup"><span data-stu-id="08401-1421">See</span></span>|  
|--------|---------|  
|<span data-ttu-id="08401-1422">从文本文件读取</span><span class="sxs-lookup"><span data-stu-id="08401-1422">Read from a text file</span></span>|[<span data-ttu-id="08401-1423">如何：读取文本文件</span><span class="sxs-lookup"><span data-stu-id="08401-1423">How to: Read from Text Files</span></span>](~/docs/visual-basic/developing-apps/programming/drives-directories-files/how-to-read-from-text-files.md)|  
  
   
  
## Examples  
 <span data-ttu-id="08401-1424">此示例读取的内容`Test.txt`转换为字符串，然后在消息框中显示内容。</span><span class="sxs-lookup"><span data-stu-id="08401-1424">This example reads the contents of `Test.txt` into a string and then displays it in a message box.</span></span>  
  
 [!code-vb[VbRefFile#8](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbRefFile/VB/Class1.vb#8)]  
  
 <span data-ttu-id="08401-1425">此示例读取 ASCII 文件的内容`Test.txt`转换为字符串，然后在消息框中显示内容。</span><span class="sxs-lookup"><span data-stu-id="08401-1425">This example reads the contents of the ASCII file `Test.txt` into a string and then displays it in a message box.</span></span>  
  
 [!code-vb[VbRefFile#9](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbRefFile/VB/Class1.vb#9)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentException"><span data-ttu-id="08401-1426">路径由于以下原因之一无效：是零长度字符串；仅为空白；包含无效字符；是一个设备路径（以 \\\\.\\ 开头）；以尾部反斜杠结尾。</span><span class="sxs-lookup"><span data-stu-id="08401-1426">The path is not valid for one of the following reasons: it is a zero-length string; it contains only white space; it contains invalid characters; or it is a device path (starts with \\\\.\\); it ends with a trailing slash.</span></span></exception>
        <exception cref="T:System.ArgumentNullException"><span data-ttu-id="08401-1427"><paramref name="file" /> 为 <see langword="Nothing" />。</span><span class="sxs-lookup"><span data-stu-id="08401-1427"><paramref name="file" /> is <see langword="Nothing" />.</span></span></exception>
        <exception cref="T:System.IO.FileNotFoundException"><span data-ttu-id="08401-1428">文件不存在。</span><span class="sxs-lookup"><span data-stu-id="08401-1428">The file does not exist.</span></span></exception>
        <exception cref="T:System.IO.IOException"><span data-ttu-id="08401-1429">文件正由另一个进程使用或者出现 I/O 错误。</span><span class="sxs-lookup"><span data-stu-id="08401-1429">The file is in use by another process, or an I/O error occurs.</span></span></exception>
        <exception cref="T:System.IO.PathTooLongException"><span data-ttu-id="08401-1430">路径超过系统定义的最大长度。</span><span class="sxs-lookup"><span data-stu-id="08401-1430">The path exceeds the system-defined maximum length.</span></span></exception>
        <exception cref="T:System.NotSupportedException"><span data-ttu-id="08401-1431">在路径中的文件或目录名称包含冒号 （:），或格式无效。</span><span class="sxs-lookup"><span data-stu-id="08401-1431">A file or directory name in the path contains a colon (:) or is in an invalid format.</span></span></exception>
        <exception cref="T:System.OutOfMemoryException"><span data-ttu-id="08401-1432">不是内存不足，无法将字符串写入缓冲区。</span><span class="sxs-lookup"><span data-stu-id="08401-1432">There is not enough memory to write the string to buffer.</span></span></exception>
        <exception cref="T:System.Security.SecurityException"><span data-ttu-id="08401-1433">该用户缺少必要的权限查看该路径。</span><span class="sxs-lookup"><span data-stu-id="08401-1433">The user lacks necessary permissions to view the path.</span></span></exception>
        <permission cref="T:System.Security.Permissions.FileIOPermission"><span data-ttu-id="08401-1434">控制文件和文件夹的访问权限。</span><span class="sxs-lookup"><span data-stu-id="08401-1434">Controls the ability to access files and folders.</span></span> <span data-ttu-id="08401-1435">关联枚举： <see cref="F:System.Security.Permissions.PermissionState.Unrestricted" />。</span><span class="sxs-lookup"><span data-stu-id="08401-1435">Associated enumeration: <see cref="F:System.Security.Permissions.PermissionState.Unrestricted" />.</span></span></permission>
        <altmember cref="T:System.Text.Encoding" />
        <altmember cref="M:System.IO.StreamReader.#ctor(System.IO.Stream,System.Text.Encoding)" />
        <related type="Article" href="~/docs/visual-basic/language-reference/objects/index.md"><span data-ttu-id="08401-1436">对象 (Visual Basic)</span><span class="sxs-lookup"><span data-stu-id="08401-1436">Objects (Visual Basic)</span></span></related>
        <related type="Article" href="~/docs/visual-basic/developing-apps/programming/drives-directories-files/reading-from-files.md"><span data-ttu-id="08401-1437">从文件读取 (Visual Basic)</span><span class="sxs-lookup"><span data-stu-id="08401-1437">Reading from Files in Visual Basic</span></span></related>
        <related type="Article" href="~/docs/visual-basic/developing-apps/programming/drives-directories-files/how-to-read-text-from-files-with-a-streamreader.md"><span data-ttu-id="08401-1438">如何：使用 StreamReader 读取文件中的文本 (Visual Basic)</span><span class="sxs-lookup"><span data-stu-id="08401-1438">How to: Read Text from Files with a StreamReader (Visual Basic)</span></span></related>
        <related type="Article" href="~/docs/visual-basic/developing-apps/programming/drives-directories-files/troubleshooting-reading-from-and-writing-to-text-files.md"><span data-ttu-id="08401-1439">疑难解答：读取和写入文本文件</span><span class="sxs-lookup"><span data-stu-id="08401-1439">Troubleshooting: Reading from and Writing to Text Files</span></span></related>
        <related type="Article" href="~/docs/visual-basic/developing-apps/programming/drives-directories-files/walkthrough-manipulating-files-and-directories.md"><span data-ttu-id="08401-1440">演练：在 Visual Basic 中操作文件和目录</span><span class="sxs-lookup"><span data-stu-id="08401-1440">Walkthrough: Manipulating Files and Directories in Visual Basic</span></span></related>
        <related type="Article" href="~/docs/visual-basic/developing-apps/programming/drives-directories-files/file-encodings.md"><span data-ttu-id="08401-1441">文件编码</span><span class="sxs-lookup"><span data-stu-id="08401-1441">File Encodings</span></span></related>
      </Docs>
    </Member>
    <Member MemberName="RenameDirectory">
      <MemberSignature Language="C#" Value="public void RenameDirectory (string directory, string newName);" />
      <MemberSignature Language="ILAsm" Value=".method public instance void RenameDirectory(string directory, string newName) cil managed" />
      <MemberSignature Language="DocId" Value="M:Microsoft.VisualBasic.MyServices.FileSystemProxy.RenameDirectory(System.String,System.String)" />
      <MemberSignature Language="VB.NET" Value="Public Sub RenameDirectory (directory As String, newName As String)" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; void RenameDirectory(System::String ^ directory, System::String ^ newName);" />
      <MemberSignature Language="F#" Value="member this.RenameDirectory : string * string -&gt; unit" Usage="fileSystemProxy.RenameDirectory (directory, newName)" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>Microsoft.VisualBasic</AssemblyName>
        <AssemblyVersion>8.0.0.0</AssemblyVersion>
        <AssemblyVersion>10.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <AssemblyInfo>
        <AssemblyName>Microsoft.VisualBasic.Core</AssemblyName>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Void</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="directory" Type="System.String" Index="0" FrameworkAlternate="netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;netframework-4.8" />
        <Parameter Name="newName" Type="System.String" Index="1" FrameworkAlternate="netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;netframework-4.8" />
      </Parameters>
      <Docs>
        <param name="directory"><span data-ttu-id="08401-1442">路径和要重命名目录的名称。</span><span class="sxs-lookup"><span data-stu-id="08401-1442">Path and name of directory to be renamed.</span></span></param>
        <param name="newName"><span data-ttu-id="08401-1443">目录的新名称。</span><span class="sxs-lookup"><span data-stu-id="08401-1443">New name for directory.</span></span></param>
        <summary><span data-ttu-id="08401-1444">重命名目录。</span><span class="sxs-lookup"><span data-stu-id="08401-1444">Renames a directory.</span></span></summary>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="08401-1445">此方法不能用于移动目录;使用`MoveDirectory`方法来移动和重命名目录。</span><span class="sxs-lookup"><span data-stu-id="08401-1445">This method cannot be used to move a directory; use the `MoveDirectory` method to move and rename the directory.</span></span>  
  
   
  
## Examples  
 <span data-ttu-id="08401-1446">此示例将重命名`Test`目录`SecondTest`。</span><span class="sxs-lookup"><span data-stu-id="08401-1446">This example renames the `Test` directory to `SecondTest`.</span></span>  
  
 [!code-vb[VbVbcnMyFileSystem#13](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbcnMyFileSystem/VB/Class1.vb#13)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentException"><span data-ttu-id="08401-1447"><paramref name="newName" /> 包含路径信息。</span><span class="sxs-lookup"><span data-stu-id="08401-1447"><paramref name="newName" /> contains path information.</span></span></exception>
        <exception cref="T:System.ArgumentNullException"><span data-ttu-id="08401-1448"><paramref name="directory" /> 为 <see langword="Nothing" />。</span><span class="sxs-lookup"><span data-stu-id="08401-1448"><paramref name="directory" /> is <see langword="Nothing" />.</span></span>  
  
<span data-ttu-id="08401-1449">或</span><span class="sxs-lookup"><span data-stu-id="08401-1449">-or-</span></span> 
 <span data-ttu-id="08401-1450"><paramref name="newName" /> 为 <see langword="Nothing" /> 或空字符串。</span><span class="sxs-lookup"><span data-stu-id="08401-1450"><paramref name="newName" /> is <see langword="Nothing" /> or an empty string.</span></span></exception>
        <exception cref="T:System.IO.DirectoryNotFoundException"><span data-ttu-id="08401-1451">目录不存在。</span><span class="sxs-lookup"><span data-stu-id="08401-1451">The directory does not exist.</span></span></exception>
        <exception cref="T:System.IO.IOException"><span data-ttu-id="08401-1452">没有现有的文件或目录中指定的名称与<paramref name="newName" />。</span><span class="sxs-lookup"><span data-stu-id="08401-1452">There is an existing file or directory with the name specified in <paramref name="newName" />.</span></span></exception>
        <exception cref="T:System.IO.PathTooLongException"><span data-ttu-id="08401-1453">路径超过系统定义的最大长度。</span><span class="sxs-lookup"><span data-stu-id="08401-1453">The path exceeds the system-defined maximum length.</span></span></exception>
        <exception cref="T:System.NotSupportedException"><span data-ttu-id="08401-1454">在路径中的文件或目录名称包含冒号 （:），或格式无效。</span><span class="sxs-lookup"><span data-stu-id="08401-1454">A file or directory name in the path contains a colon (:) or is in an invalid format.</span></span></exception>
        <exception cref="T:System.Security.SecurityException"><span data-ttu-id="08401-1455">该用户缺少必要的权限查看该路径。</span><span class="sxs-lookup"><span data-stu-id="08401-1455">The user lacks necessary permissions to view the path.</span></span></exception>
        <exception cref="T:System.UnauthorizedAccessException"><span data-ttu-id="08401-1456">用户没有所需的权限。</span><span class="sxs-lookup"><span data-stu-id="08401-1456">The user does not have required permission.</span></span></exception>
        <permission cref="T:System.Security.Permissions.FileIOPermission"><span data-ttu-id="08401-1457">控制文件和文件夹的访问权限。</span><span class="sxs-lookup"><span data-stu-id="08401-1457">Controls the ability to access files and folders.</span></span> <span data-ttu-id="08401-1458">关联枚举： <see cref="F:System.Security.Permissions.PermissionState.Unrestricted" />。</span><span class="sxs-lookup"><span data-stu-id="08401-1458">Associated enumeration: <see cref="F:System.Security.Permissions.PermissionState.Unrestricted" />.</span></span></permission>
        <related type="Article" href="~/docs/visual-basic/language-reference/objects/index.md"><span data-ttu-id="08401-1459">对象 (Visual Basic)</span><span class="sxs-lookup"><span data-stu-id="08401-1459">Objects (Visual Basic)</span></span></related>
        <related type="Article" href="~/docs/visual-basic/developing-apps/programming/drives-directories-files/how-to-parse-file-paths.md"><span data-ttu-id="08401-1460">如何：在 Visual Basic 中分析文件路径</span><span class="sxs-lookup"><span data-stu-id="08401-1460">How to: Parse File Paths in Visual Basic</span></span></related>
        <related type="Article" href="~/docs/visual-basic/developing-apps/programming/drives-directories-files/creating-deleting-and-moving-files-and-directories.md"><span data-ttu-id="08401-1461">创建、删除和移动文件和目录 (Visual Basic)</span><span class="sxs-lookup"><span data-stu-id="08401-1461">Creating, Deleting, and Moving Files and Directories in Visual Basic</span></span></related>
      </Docs>
    </Member>
    <Member MemberName="RenameFile">
      <MemberSignature Language="C#" Value="public void RenameFile (string file, string newName);" />
      <MemberSignature Language="ILAsm" Value=".method public instance void RenameFile(string file, string newName) cil managed" />
      <MemberSignature Language="DocId" Value="M:Microsoft.VisualBasic.MyServices.FileSystemProxy.RenameFile(System.String,System.String)" />
      <MemberSignature Language="VB.NET" Value="Public Sub RenameFile (file As String, newName As String)" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; void RenameFile(System::String ^ file, System::String ^ newName);" />
      <MemberSignature Language="F#" Value="member this.RenameFile : string * string -&gt; unit" Usage="fileSystemProxy.RenameFile (file, newName)" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>Microsoft.VisualBasic</AssemblyName>
        <AssemblyVersion>8.0.0.0</AssemblyVersion>
        <AssemblyVersion>10.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <AssemblyInfo>
        <AssemblyName>Microsoft.VisualBasic.Core</AssemblyName>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Void</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="file" Type="System.String" Index="0" FrameworkAlternate="netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;netframework-4.8" />
        <Parameter Name="newName" Type="System.String" Index="1" FrameworkAlternate="netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;netframework-4.8" />
      </Parameters>
      <Docs>
        <param name="file"><span data-ttu-id="08401-1462">要重命名的文件。</span><span class="sxs-lookup"><span data-stu-id="08401-1462">File to be renamed.</span></span></param>
        <param name="newName"><span data-ttu-id="08401-1463">文件的新名称。</span><span class="sxs-lookup"><span data-stu-id="08401-1463">New name of file.</span></span></param>
        <summary><span data-ttu-id="08401-1464">重命名文件。</span><span class="sxs-lookup"><span data-stu-id="08401-1464">Renames a file.</span></span></summary>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="08401-1465">此方法不能用于移动文件；使用 <xref:Microsoft.VisualBasic.MyServices.FileSystemProxy.MoveFile%2A> 方法可移动并重命名文件。</span><span class="sxs-lookup"><span data-stu-id="08401-1465">This method cannot be used to move a file; use the <xref:Microsoft.VisualBasic.MyServices.FileSystemProxy.MoveFile%2A> method to move and rename the file.</span></span>  
  
 <span data-ttu-id="08401-1466">下表列出的任务涉及示例`My.Computer.FileSystem.RenameFile`方法。</span><span class="sxs-lookup"><span data-stu-id="08401-1466">The following table lists an example of a task involving the `My.Computer.FileSystem.RenameFile` method.</span></span>  
  
|<span data-ttu-id="08401-1467">功能</span><span class="sxs-lookup"><span data-stu-id="08401-1467">To</span></span>|<span data-ttu-id="08401-1468">查看</span><span class="sxs-lookup"><span data-stu-id="08401-1468">See</span></span>|  
|--------|---------|  
|<span data-ttu-id="08401-1469">重命名文件</span><span class="sxs-lookup"><span data-stu-id="08401-1469">Rename a file</span></span>|[<span data-ttu-id="08401-1470">如何：重命名文件</span><span class="sxs-lookup"><span data-stu-id="08401-1470">How to: Rename a File</span></span>](~/docs/visual-basic/developing-apps/programming/drives-directories-files/how-to-rename-a-file.md)|  
  
   
  
## Examples  
 <span data-ttu-id="08401-1471">此示例将文件重命名`Test.txt`到`SecondTest.txt`。</span><span class="sxs-lookup"><span data-stu-id="08401-1471">This example renames the file `Test.txt` to `SecondTest.txt`.</span></span>  
  
 [!code-vb[VbVbcnMyFileSystem#1](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbcnMyFileSystem/VB/Class1.vb#1)]  
  
 <span data-ttu-id="08401-1472">更改"`C:\Test.txt`"为你想要重命名该文件的路径和文件名称。</span><span class="sxs-lookup"><span data-stu-id="08401-1472">Change "`C:\Test.txt`" to the path and file name of the file that you want to rename.</span></span>  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentException"><span data-ttu-id="08401-1473"><paramref name="newName" /> 包含路径信息或以反斜杠 (\\) 结尾。</span><span class="sxs-lookup"><span data-stu-id="08401-1473"><paramref name="newName" /> contains path information or ends with a backslash (\\).</span></span></exception>
        <exception cref="T:System.ArgumentNullException"><span data-ttu-id="08401-1474"><paramref name="file" /> 为 <see langword="Nothing" />。</span><span class="sxs-lookup"><span data-stu-id="08401-1474"><paramref name="file" /> is <see langword="Nothing" />.</span></span>  
  
<span data-ttu-id="08401-1475">或</span><span class="sxs-lookup"><span data-stu-id="08401-1475">-or-</span></span> 
 <span data-ttu-id="08401-1476"><paramref name="newName" /> 为 <see langword="Nothing" /> 或空字符串。</span><span class="sxs-lookup"><span data-stu-id="08401-1476"><paramref name="newName" /> is <see langword="Nothing" /> or an empty string.</span></span></exception>
        <exception cref="T:System.IO.FileNotFoundException"><span data-ttu-id="08401-1477">文件不存在。</span><span class="sxs-lookup"><span data-stu-id="08401-1477">The file does not exist.</span></span></exception>
        <exception cref="T:System.IO.IOException"><span data-ttu-id="08401-1478">没有现有的文件或目录中指定的名称与<paramref name="newName" />。</span><span class="sxs-lookup"><span data-stu-id="08401-1478">There is an existing file or directory with the name specified in <paramref name="newName" />.</span></span></exception>
        <exception cref="T:System.IO.PathTooLongException"><span data-ttu-id="08401-1479">路径超过系统定义的最大长度。</span><span class="sxs-lookup"><span data-stu-id="08401-1479">The path exceeds the system-defined maximum length.</span></span></exception>
        <exception cref="T:System.NotSupportedException"><span data-ttu-id="08401-1480">在路径中的文件或目录名称包含冒号 （:），或格式无效。</span><span class="sxs-lookup"><span data-stu-id="08401-1480">A file or directory name in the path contains a colon (:) or is in an invalid format.</span></span></exception>
        <exception cref="T:System.Security.SecurityException"><span data-ttu-id="08401-1481">该用户缺少必要的权限查看该路径。</span><span class="sxs-lookup"><span data-stu-id="08401-1481">The user lacks necessary permissions to view the path.</span></span></exception>
        <exception cref="T:System.UnauthorizedAccessException"><span data-ttu-id="08401-1482">用户没有所需的权限。</span><span class="sxs-lookup"><span data-stu-id="08401-1482">The user does not have required permission.</span></span></exception>
        <permission cref="T:System.Security.Permissions.FileIOPermission"><span data-ttu-id="08401-1483">控制文件和文件夹的访问权限。</span><span class="sxs-lookup"><span data-stu-id="08401-1483">Controls the ability to access files and folders.</span></span> <span data-ttu-id="08401-1484">关联枚举： <see cref="F:System.Security.Permissions.PermissionState.Unrestricted" />。</span><span class="sxs-lookup"><span data-stu-id="08401-1484">Associated enumeration: <see cref="F:System.Security.Permissions.PermissionState.Unrestricted" />.</span></span></permission>
        <related type="Article" href="~/docs/visual-basic/language-reference/objects/index.md"><span data-ttu-id="08401-1485">对象 (Visual Basic)</span><span class="sxs-lookup"><span data-stu-id="08401-1485">Objects (Visual Basic)</span></span></related>
        <related type="Article" href="~/docs/visual-basic/developing-apps/programming/drives-directories-files/creating-deleting-and-moving-files-and-directories.md"><span data-ttu-id="08401-1486">创建、删除和移动文件和目录 (Visual Basic)</span><span class="sxs-lookup"><span data-stu-id="08401-1486">Creating, Deleting, and Moving Files and Directories in Visual Basic</span></span></related>
      </Docs>
    </Member>
    <Member MemberName="SpecialDirectories">
      <MemberSignature Language="C#" Value="public Microsoft.VisualBasic.MyServices.SpecialDirectoriesProxy SpecialDirectories { get; }" />
      <MemberSignature Language="ILAsm" Value=".property instance class Microsoft.VisualBasic.MyServices.SpecialDirectoriesProxy SpecialDirectories" />
      <MemberSignature Language="DocId" Value="P:Microsoft.VisualBasic.MyServices.FileSystemProxy.SpecialDirectories" />
      <MemberSignature Language="VB.NET" Value="Public ReadOnly Property SpecialDirectories As SpecialDirectoriesProxy" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; property Microsoft::VisualBasic::MyServices::SpecialDirectoriesProxy ^ SpecialDirectories { Microsoft::VisualBasic::MyServices::SpecialDirectoriesProxy ^ get(); };" />
      <MemberSignature Language="F#" Value="member this.SpecialDirectories : Microsoft.VisualBasic.MyServices.SpecialDirectoriesProxy" Usage="Microsoft.VisualBasic.MyServices.FileSystemProxy.SpecialDirectories" />
      <MemberType>Property</MemberType>
      <AssemblyInfo>
        <AssemblyName>Microsoft.VisualBasic</AssemblyName>
        <AssemblyVersion>8.0.0.0</AssemblyVersion>
        <AssemblyVersion>10.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <AssemblyInfo>
        <AssemblyName>Microsoft.VisualBasic.Core</AssemblyName>
        <AssemblyVersion>10.0.4.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>Microsoft.VisualBasic.MyServices.SpecialDirectoriesProxy</ReturnType>
      </ReturnValue>
      <Docs>
        <summary><span data-ttu-id="08401-1487">获取一个对象，提供用于访问经常属性引用的目录。</span><span class="sxs-lookup"><span data-stu-id="08401-1487">Gets an object that provides properties for accessing commonly referenced directories.</span></span></summary>
        <value><span data-ttu-id="08401-1488">此属性返回<see cref="T:Microsoft.VisualBasic.FileIO.SpecialDirectories" />计算机对象。</span><span class="sxs-lookup"><span data-stu-id="08401-1488">This property returns the <see cref="T:Microsoft.VisualBasic.FileIO.SpecialDirectories" /> object for the computer.</span></span></value>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Examples  
 <span data-ttu-id="08401-1489">此示例返回用户的桌面目录的文件路径，并将其显示。</span><span class="sxs-lookup"><span data-stu-id="08401-1489">This example returns the file path for the user's Desktop directory and displays it.</span></span>  
  
 [!code-vb[VbVbcnMyFileSystem#80](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbcnMyFileSystem/VB/Class1.vb#80)]  
  
 ]]></format>
        </remarks>
        <altmember cref="T:Microsoft.VisualBasic.FileIO.SpecialDirectories" />
        <related type="Article" href="~/docs/visual-basic/language-reference/objects/index.md"><span data-ttu-id="08401-1490">对象 (Visual Basic)</span><span class="sxs-lookup"><span data-stu-id="08401-1490">Objects (Visual Basic)</span></span></related>
      </Docs>
    </Member>
    <Member MemberName="WriteAllBytes">
      <MemberSignature Language="C#" Value="public void WriteAllBytes (string file, byte[] data, bool append);" />
      <MemberSignature Language="ILAsm" Value=".method public instance void WriteAllBytes(string file, unsigned int8[] data, bool append) cil managed" />
      <MemberSignature Language="DocId" Value="M:Microsoft.VisualBasic.MyServices.FileSystemProxy.WriteAllBytes(System.String,System.Byte[],System.Boolean)" />
      <MemberSignature Language="VB.NET" Value="Public Sub WriteAllBytes (file As String, data As Byte(), append As Boolean)" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; void WriteAllBytes(System::String ^ file, cli::array &lt;System::Byte&gt; ^ data, bool append);" />
      <MemberSignature Language="F#" Value="member this.WriteAllBytes : string * byte[] * bool -&gt; unit" Usage="fileSystemProxy.WriteAllBytes (file, data, append)" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>Microsoft.VisualBasic</AssemblyName>
        <AssemblyVersion>8.0.0.0</AssemblyVersion>
        <AssemblyVersion>10.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <AssemblyInfo>
        <AssemblyName>Microsoft.VisualBasic.Core</AssemblyName>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Void</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="file" Type="System.String" Index="0" FrameworkAlternate="netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;netframework-4.8" />
        <Parameter Name="data" Type="System.Byte[]" Index="1" FrameworkAlternate="netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;netframework-4.8" />
        <Parameter Name="append" Type="System.Boolean" Index="2" FrameworkAlternate="netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;netframework-4.8" />
      </Parameters>
      <Docs>
        <param name="file"><span data-ttu-id="08401-1491">路径和要写入到的文件的名称。</span><span class="sxs-lookup"><span data-stu-id="08401-1491">Path and name of the file to be written to.</span></span></param>
        <param name="data"><span data-ttu-id="08401-1492">要写入到文件数据。</span><span class="sxs-lookup"><span data-stu-id="08401-1492">Data to be written to the file.</span></span></param>
        <param name="append"><span data-ttu-id="08401-1493"><see langword="True" /> 要追加到该文件的内容;<see langword="False" />覆盖该文件的内容。</span><span class="sxs-lookup"><span data-stu-id="08401-1493"><see langword="True" /> to append to the file contents; <see langword="False" /> to overwrite the file contents.</span></span> <span data-ttu-id="08401-1494">默认值为 <see langword="False" />。</span><span class="sxs-lookup"><span data-stu-id="08401-1494">Default is <see langword="False" />.</span></span></param>
        <summary><span data-ttu-id="08401-1495">将数据写入二进制文件。</span><span class="sxs-lookup"><span data-stu-id="08401-1495">Writes data to a binary file.</span></span></summary>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="08401-1496">如果指定的路径，不包括文件名，不是有效的<xref:System.IO.DirectoryNotFoundException>将引发异常。</span><span class="sxs-lookup"><span data-stu-id="08401-1496">If the specified path, excluding the file name, is not valid, a <xref:System.IO.DirectoryNotFoundException> exception will be thrown.</span></span> <span data-ttu-id="08401-1497">如果路径有效，但该文件不存在，创建文件。</span><span class="sxs-lookup"><span data-stu-id="08401-1497">If the path is valid but the file does not exist, the file is created.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="08401-1498">`WriteAllBytes`方法打开文件、 向其中写入，，然后关闭它。</span><span class="sxs-lookup"><span data-stu-id="08401-1498">The `WriteAllBytes` method opens a file, writes to it, and then closes it.</span></span> <span data-ttu-id="08401-1499">使用的代码`WriteAllBytes`方法是使用的代码比简单<xref:System.IO.BinaryWriter>对象。</span><span class="sxs-lookup"><span data-stu-id="08401-1499">Code that uses the `WriteAllBytes` method is simpler than code that uses a <xref:System.IO.BinaryWriter> object.</span></span> <span data-ttu-id="08401-1500">但是，如果要将数据添加到使用一个循环，对文件<xref:System.IO.BinaryWriter>对象可以提供更好的性能，因为您只需打开和关闭该文件一次。</span><span class="sxs-lookup"><span data-stu-id="08401-1500">However, if you are adding data to a file using a loop, a <xref:System.IO.BinaryWriter> object can provide better performance because you only have to open and close the file once.</span></span>  
  
 <span data-ttu-id="08401-1501">下表列出的任务涉及示例`My.Computer.FileSystem.WriteAllBytes`方法。</span><span class="sxs-lookup"><span data-stu-id="08401-1501">The following table lists an example of a task involving the `My.Computer.FileSystem.WriteAllBytes` method.</span></span>  
  
|<span data-ttu-id="08401-1502">功能</span><span class="sxs-lookup"><span data-stu-id="08401-1502">To</span></span>|<span data-ttu-id="08401-1503">查看</span><span class="sxs-lookup"><span data-stu-id="08401-1503">See</span></span>|  
|--------|---------|  
|<span data-ttu-id="08401-1504">写入二进制文件</span><span class="sxs-lookup"><span data-stu-id="08401-1504">Write to a binary file</span></span>|[<span data-ttu-id="08401-1505">如何：写入二进制文件</span><span class="sxs-lookup"><span data-stu-id="08401-1505">How to: Write to Binary Files</span></span>](~/docs/visual-basic/developing-apps/programming/drives-directories-files/how-to-write-to-binary-files.md)|  
  
   
  
## Examples  
 <span data-ttu-id="08401-1506">本示例将附加的数据数组`CustomerData`文件`CollectedData`。</span><span class="sxs-lookup"><span data-stu-id="08401-1506">This example appends the data array `CustomerData` to the file `CollectedData`.</span></span>  
  
 [!code-vb[VbVbcnMyFileSystem#50](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbcnMyFileSystem/VB/Class1.vb#50)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentException"><span data-ttu-id="08401-1507">路径由于以下原因之一无效：是零长度字符串；仅为空白；包含无效字符；是一个设备路径（以 \\\\.\\ 开头）；以尾部反斜杠结尾。</span><span class="sxs-lookup"><span data-stu-id="08401-1507">The path is not valid for one of the following reasons: it is a zero-length string; it contains only white space; it contains invalid characters; or it is a device path (starts with \\\\.\\); it ends with a trailing slash.</span></span></exception>
        <exception cref="T:System.ArgumentNullException"><span data-ttu-id="08401-1508"><paramref name="file" /> 为 <see langword="Nothing" />。</span><span class="sxs-lookup"><span data-stu-id="08401-1508"><paramref name="file" /> is <see langword="Nothing" />.</span></span></exception>
        <exception cref="T:System.IO.FileNotFoundException"><span data-ttu-id="08401-1509">文件不存在。</span><span class="sxs-lookup"><span data-stu-id="08401-1509">The file does not exist.</span></span></exception>
        <exception cref="T:System.IO.IOException"><span data-ttu-id="08401-1510">文件正由另一个进程使用或者出现 I/O 错误。</span><span class="sxs-lookup"><span data-stu-id="08401-1510">The file is in use by another process, or an I/O error occurs.</span></span></exception>
        <exception cref="T:System.IO.PathTooLongException"><span data-ttu-id="08401-1511">路径超过系统定义的最大长度。</span><span class="sxs-lookup"><span data-stu-id="08401-1511">The path exceeds the system-defined maximum length.</span></span></exception>
        <exception cref="T:System.NotSupportedException"><span data-ttu-id="08401-1512">在路径中的文件或目录名称包含冒号 （:），或格式无效。</span><span class="sxs-lookup"><span data-stu-id="08401-1512">A file or directory name in the path contains a colon (:) or is in an invalid format.</span></span></exception>
        <exception cref="T:System.OutOfMemoryException"><span data-ttu-id="08401-1513">不是内存不足，无法将字符串写入缓冲区。</span><span class="sxs-lookup"><span data-stu-id="08401-1513">There is not enough memory to write the string to buffer.</span></span></exception>
        <exception cref="T:System.Security.SecurityException"><span data-ttu-id="08401-1514">该用户缺少必要的权限查看该路径。</span><span class="sxs-lookup"><span data-stu-id="08401-1514">The user lacks necessary permissions to view the path.</span></span></exception>
        <permission cref="T:System.Security.Permissions.FileIOPermission"><span data-ttu-id="08401-1515">控制文件和文件夹的访问权限。</span><span class="sxs-lookup"><span data-stu-id="08401-1515">Controls the ability to access files and folders.</span></span> <span data-ttu-id="08401-1516">关联枚举： <see cref="F:System.Security.Permissions.PermissionState.Unrestricted" />。</span><span class="sxs-lookup"><span data-stu-id="08401-1516">Associated enumeration: <see cref="F:System.Security.Permissions.PermissionState.Unrestricted" />.</span></span></permission>
        <related type="Article" href="~/docs/visual-basic/language-reference/objects/index.md"><span data-ttu-id="08401-1517">对象 (Visual Basic)</span><span class="sxs-lookup"><span data-stu-id="08401-1517">Objects (Visual Basic)</span></span></related>
        <related type="Article" href="~/docs/visual-basic/developing-apps/programming/drives-directories-files/how-to-write-to-binary-files.md"><span data-ttu-id="08401-1518">如何：写入到在 Visual Basic 中的二进制文件</span><span class="sxs-lookup"><span data-stu-id="08401-1518">How to: Write to a Binary File in Visual Basic</span></span></related>
        <related type="Article" href="~/docs/visual-basic/developing-apps/programming/drives-directories-files/writing-to-files.md"><span data-ttu-id="08401-1519">写入文件 (Visual Basic)</span><span class="sxs-lookup"><span data-stu-id="08401-1519">Writing to Files in Visual Basic</span></span></related>
      </Docs>
    </Member>
    <MemberGroup MemberName="WriteAllText">
      <AssemblyInfo>
        <AssemblyName>Microsoft.VisualBasic</AssemblyName>
        <AssemblyVersion>10.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Docs>
        <summary><span data-ttu-id="08401-1520">将文本写入文件。</span><span class="sxs-lookup"><span data-stu-id="08401-1520">Writes text to a file.</span></span></summary>
      </Docs>
    </MemberGroup>
    <Member MemberName="WriteAllText">
      <MemberSignature Language="C#" Value="public void WriteAllText (string file, string text, bool append);" />
      <MemberSignature Language="ILAsm" Value=".method public instance void WriteAllText(string file, string text, bool append) cil managed" />
      <MemberSignature Language="DocId" Value="M:Microsoft.VisualBasic.MyServices.FileSystemProxy.WriteAllText(System.String,System.String,System.Boolean)" />
      <MemberSignature Language="VB.NET" Value="Public Sub WriteAllText (file As String, text As String, append As Boolean)" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; void WriteAllText(System::String ^ file, System::String ^ text, bool append);" />
      <MemberSignature Language="F#" Value="member this.WriteAllText : string * string * bool -&gt; unit" Usage="fileSystemProxy.WriteAllText (file, text, append)" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>Microsoft.VisualBasic</AssemblyName>
        <AssemblyVersion>8.0.0.0</AssemblyVersion>
        <AssemblyVersion>10.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <AssemblyInfo>
        <AssemblyName>Microsoft.VisualBasic.Core</AssemblyName>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Void</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="file" Type="System.String" Index="0" FrameworkAlternate="netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;netframework-4.8" />
        <Parameter Name="text" Type="System.String" Index="1" FrameworkAlternate="netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;netframework-4.8" />
        <Parameter Name="append" Type="System.Boolean" Index="2" FrameworkAlternate="netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;netframework-4.8" />
      </Parameters>
      <Docs>
        <param name="file"><span data-ttu-id="08401-1521">要写入到文件。</span><span class="sxs-lookup"><span data-stu-id="08401-1521">File to be written to.</span></span></param>
        <param name="text"><span data-ttu-id="08401-1522">要写入到文件的文本。</span><span class="sxs-lookup"><span data-stu-id="08401-1522">Text to be written to file.</span></span></param>
        <param name="append"><span data-ttu-id="08401-1523"><see langword="True" /> 要追加到该文件; 的内容<see langword="False" />覆盖该文件的内容。</span><span class="sxs-lookup"><span data-stu-id="08401-1523"><see langword="True" /> to append to the contents of the file; <see langword="False" /> to overwrite the contents of the file.</span></span> <span data-ttu-id="08401-1524">默认值为 <see langword="False" />。</span><span class="sxs-lookup"><span data-stu-id="08401-1524">Default is <see langword="False" />.</span></span></param>
        <summary><span data-ttu-id="08401-1525">将文本写入文件。</span><span class="sxs-lookup"><span data-stu-id="08401-1525">Writes text to a file.</span></span></summary>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="08401-1526">使用 utf-8 编码写入到文件。</span><span class="sxs-lookup"><span data-stu-id="08401-1526">The UTF-8 encoding is used to write to the file.</span></span> <span data-ttu-id="08401-1527">若要指定不同的编码，使用的不同重载<xref:Microsoft.VisualBasic.MyServices.FileSystemProxy.WriteAllText%2A>方法。</span><span class="sxs-lookup"><span data-stu-id="08401-1527">To specify a different encoding, use a different overload of the <xref:Microsoft.VisualBasic.MyServices.FileSystemProxy.WriteAllText%2A> method.</span></span>  
  
 <span data-ttu-id="08401-1528">如果指定的文件不存在，则会创建一个。</span><span class="sxs-lookup"><span data-stu-id="08401-1528">If the specified file does not exist, it is created.</span></span>  
  
 <span data-ttu-id="08401-1529">如果指定的编码与现有文件的编码不匹配，则忽略指定的编码。</span><span class="sxs-lookup"><span data-stu-id="08401-1529">If the specified encoding does not match the existing encoding of the file, the specified coding is ignored.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="08401-1530">`WriteAllText`方法打开文件、 向其中写入，，然后关闭它。</span><span class="sxs-lookup"><span data-stu-id="08401-1530">The `WriteAllText` method opens a file, writes to it, and then closes it.</span></span> <span data-ttu-id="08401-1531">使用的代码`WriteAllText`方法是使用的代码比简单<xref:System.IO.StreamWriter>对象。</span><span class="sxs-lookup"><span data-stu-id="08401-1531">Code that uses the `WriteAllText` method is simpler than code that uses a <xref:System.IO.StreamWriter> object.</span></span> <span data-ttu-id="08401-1532">但是，如果您在向文件添加字符串，通过使用循环，<xref:System.IO.StreamWriter>对象可以提供更好的性能，因为您只需打开和关闭该文件一次。</span><span class="sxs-lookup"><span data-stu-id="08401-1532">However, if you are adding strings to a file by using a loop, a <xref:System.IO.StreamWriter> object can provide better performance because you only have to open and close the file one time.</span></span> <span data-ttu-id="08401-1533">有关更多信息，请参见 <xref:Microsoft.VisualBasic.MyServices.FileSystemProxy.OpenTextFileWriter%2A> 方法。</span><span class="sxs-lookup"><span data-stu-id="08401-1533">For more information, see the <xref:Microsoft.VisualBasic.MyServices.FileSystemProxy.OpenTextFileWriter%2A> method.</span></span>  
  
 <span data-ttu-id="08401-1534">下表列出了所涉及的任务的示例`My.Computer.FileSystem.WriteAllText`方法。</span><span class="sxs-lookup"><span data-stu-id="08401-1534">The following table lists examples of tasks involving the `My.Computer.FileSystem.WriteAllText` method.</span></span>  
  
|<span data-ttu-id="08401-1535">功能</span><span class="sxs-lookup"><span data-stu-id="08401-1535">To</span></span>|<span data-ttu-id="08401-1536">查看</span><span class="sxs-lookup"><span data-stu-id="08401-1536">See</span></span>|  
|--------|---------|  
|<span data-ttu-id="08401-1537">将文本写入文件</span><span class="sxs-lookup"><span data-stu-id="08401-1537">Write text to a file</span></span>|[<span data-ttu-id="08401-1538">如何：向文件写入文本</span><span class="sxs-lookup"><span data-stu-id="08401-1538">How to: Write Text to Files</span></span>](~/docs/visual-basic/developing-apps/programming/drives-directories-files/how-to-write-text-to-files.md)|  
|<span data-ttu-id="08401-1539">向文件中追加文本</span><span class="sxs-lookup"><span data-stu-id="08401-1539">Append text to a file</span></span>|[<span data-ttu-id="08401-1540">如何：向文本文件追加</span><span class="sxs-lookup"><span data-stu-id="08401-1540">How to: Append to Text Files</span></span>](~/docs/visual-basic/developing-apps/programming/drives-directories-files/how-to-append-to-text-files.md)|  
  
   
  
## Examples  
 <span data-ttu-id="08401-1541">此示例会将行写入`"This is new text to be added."`文件`Test.txt`，覆盖文件中的任何现有文本。</span><span class="sxs-lookup"><span data-stu-id="08401-1541">This example writes the line `"This is new text to be added."` to the file `Test.txt`, overwriting any existing text in the file.</span></span>  
  
 [!code-vb[VbRefFile#21](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbRefFile/VB/Class1.vb#21)]  
  
 <span data-ttu-id="08401-1542">此示例中的文件的文件名写入`Documents and Settings`文件夹到`FileList.txt`，插入一个回车符返回可读性更好的每个之间。</span><span class="sxs-lookup"><span data-stu-id="08401-1542">This example writes the names of the files in the `Documents and Settings` folder to `FileList.txt`, inserting a carriage return between each for better readability.</span></span>  
  
 [!code-vb[VbRefFile#22](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbRefFile/VB/Class1.vb#22)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentException"><span data-ttu-id="08401-1543">路径由于以下原因之一无效：是零长度字符串；仅为空白；包含无效字符；是一个设备路径（以 \\\\.\\ 开头）；以尾部反斜杠结尾。</span><span class="sxs-lookup"><span data-stu-id="08401-1543">The path is not valid for one of the following reasons: it is a zero-length string; it contains only white space; it contains invalid characters; or it is a device path (starts with \\\\.\\); it ends with a trailing slash.</span></span></exception>
        <exception cref="T:System.ArgumentNullException"><span data-ttu-id="08401-1544"><paramref name="file" /> 为 <see langword="Nothing" />。</span><span class="sxs-lookup"><span data-stu-id="08401-1544"><paramref name="file" /> is <see langword="Nothing" />.</span></span></exception>
        <exception cref="T:System.IO.FileNotFoundException"><span data-ttu-id="08401-1545">文件不存在。</span><span class="sxs-lookup"><span data-stu-id="08401-1545">The file does not exist.</span></span></exception>
        <exception cref="T:System.IO.IOException"><span data-ttu-id="08401-1546">文件正由另一个进程使用或者出现 I/O 错误。</span><span class="sxs-lookup"><span data-stu-id="08401-1546">The file is in use by another process, or an I/O error occurs.</span></span></exception>
        <exception cref="T:System.IO.PathTooLongException"><span data-ttu-id="08401-1547">路径超过系统定义的最大长度。</span><span class="sxs-lookup"><span data-stu-id="08401-1547">The path exceeds the system-defined maximum length.</span></span></exception>
        <exception cref="T:System.NotSupportedException"><span data-ttu-id="08401-1548">在路径中的文件或目录名称包含冒号 （:），或格式无效。</span><span class="sxs-lookup"><span data-stu-id="08401-1548">A file or directory name in the path contains a colon (:) or is in an invalid format.</span></span></exception>
        <exception cref="T:System.OutOfMemoryException"><span data-ttu-id="08401-1549">不是内存不足，无法将字符串写入缓冲区。</span><span class="sxs-lookup"><span data-stu-id="08401-1549">There is not enough memory to write the string to buffer.</span></span></exception>
        <exception cref="T:System.Security.SecurityException"><span data-ttu-id="08401-1550">该用户缺少必要的权限查看该路径。</span><span class="sxs-lookup"><span data-stu-id="08401-1550">The user lacks necessary permissions to view the path.</span></span></exception>
        <permission cref="T:System.Security.Permissions.FileIOPermission"><span data-ttu-id="08401-1551">控制文件和文件夹的访问权限。</span><span class="sxs-lookup"><span data-stu-id="08401-1551">Controls the ability to access files and folders.</span></span> <span data-ttu-id="08401-1552">关联枚举： <see cref="F:System.Security.Permissions.PermissionState.Unrestricted" />。</span><span class="sxs-lookup"><span data-stu-id="08401-1552">Associated enumeration: <see cref="F:System.Security.Permissions.PermissionState.Unrestricted" />.</span></span></permission>
        <altmember cref="T:System.Text.Encoding" />
        <altmember cref="M:Microsoft.VisualBasic.MyServices.FileSystemProxy.WriteAllText(System.String,System.String,System.Boolean)" />
        <related type="Article" href="~/docs/visual-basic/language-reference/objects/index.md"><span data-ttu-id="08401-1553">对象 (Visual Basic)</span><span class="sxs-lookup"><span data-stu-id="08401-1553">Objects (Visual Basic)</span></span></related>
        <related type="Article" href="~/docs/visual-basic/developing-apps/programming/drives-directories-files/writing-to-files.md"><span data-ttu-id="08401-1554">写入文件 (Visual Basic)</span><span class="sxs-lookup"><span data-stu-id="08401-1554">Writing to Files in Visual Basic</span></span></related>
      </Docs>
    </Member>
    <Member MemberName="WriteAllText">
      <MemberSignature Language="C#" Value="public void WriteAllText (string file, string text, bool append, System.Text.Encoding encoding);" />
      <MemberSignature Language="ILAsm" Value=".method public instance void WriteAllText(string file, string text, bool append, class System.Text.Encoding encoding) cil managed" />
      <MemberSignature Language="DocId" Value="M:Microsoft.VisualBasic.MyServices.FileSystemProxy.WriteAllText(System.String,System.String,System.Boolean,System.Text.Encoding)" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; void WriteAllText(System::String ^ file, System::String ^ text, bool append, System::Text::Encoding ^ encoding);" />
      <MemberSignature Language="F#" Value="member this.WriteAllText : string * string * bool * System.Text.Encoding -&gt; unit" Usage="fileSystemProxy.WriteAllText (file, text, append, encoding)" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>Microsoft.VisualBasic</AssemblyName>
        <AssemblyVersion>8.0.0.0</AssemblyVersion>
        <AssemblyVersion>10.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <AssemblyInfo>
        <AssemblyName>Microsoft.VisualBasic.Core</AssemblyName>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Void</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="file" Type="System.String" Index="0" FrameworkAlternate="netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;netframework-4.8" />
        <Parameter Name="text" Type="System.String" Index="1" FrameworkAlternate="netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;netframework-4.8" />
        <Parameter Name="append" Type="System.Boolean" Index="2" FrameworkAlternate="netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;netframework-4.8" />
        <Parameter Name="encoding" Type="System.Text.Encoding" Index="3" FrameworkAlternate="netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;netframework-4.8" />
      </Parameters>
      <Docs>
        <param name="file"><span data-ttu-id="08401-1555">要写入到文件。</span><span class="sxs-lookup"><span data-stu-id="08401-1555">File to be written to.</span></span></param>
        <param name="text"><span data-ttu-id="08401-1556">要写入到文件的文本。</span><span class="sxs-lookup"><span data-stu-id="08401-1556">Text to be written to file.</span></span></param>
        <param name="append"><span data-ttu-id="08401-1557"><see langword="True" /> 要追加到该文件; 的内容<see langword="False" />覆盖该文件的内容。</span><span class="sxs-lookup"><span data-stu-id="08401-1557"><see langword="True" /> to append to the contents of the file; <see langword="False" /> to overwrite the contents of the file.</span></span> <span data-ttu-id="08401-1558">默认值为 <see langword="False" />。</span><span class="sxs-lookup"><span data-stu-id="08401-1558">Default is <see langword="False" />.</span></span></param>
        <param name="encoding"><span data-ttu-id="08401-1559">写入文件时要使用何种编码。</span><span class="sxs-lookup"><span data-stu-id="08401-1559">What encoding to use when writing to file.</span></span> <span data-ttu-id="08401-1560">默认值为 utf-8。</span><span class="sxs-lookup"><span data-stu-id="08401-1560">Default is UTF-8.</span></span></param>
        <summary><span data-ttu-id="08401-1561">将文本写入文件。</span><span class="sxs-lookup"><span data-stu-id="08401-1561">Writes text to a file.</span></span></summary>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="08401-1562">如果指定的文件不存在，则会创建一个。</span><span class="sxs-lookup"><span data-stu-id="08401-1562">If the specified file does not exist, it is created.</span></span>  
  
 <span data-ttu-id="08401-1563">如果指定的编码与现有文件的编码不匹配，则忽略指定的编码。</span><span class="sxs-lookup"><span data-stu-id="08401-1563">If the specified encoding does not match the existing encoding of the file, the specified coding is ignored.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="08401-1564">`WriteAllText`方法打开文件、 向其中写入，，然后关闭它。</span><span class="sxs-lookup"><span data-stu-id="08401-1564">The `WriteAllText` method opens a file, writes to it, and then closes it.</span></span> <span data-ttu-id="08401-1565">使用的代码`WriteAllText`方法是使用的代码比简单<xref:System.IO.StreamWriter>对象。</span><span class="sxs-lookup"><span data-stu-id="08401-1565">Code that uses the `WriteAllText` method is simpler than code that uses a <xref:System.IO.StreamWriter> object.</span></span> <span data-ttu-id="08401-1566">但是，如果您在向文件添加字符串，通过使用循环，<xref:System.IO.StreamWriter>对象可以提供更好的性能，因为您只需打开和关闭该文件一次。</span><span class="sxs-lookup"><span data-stu-id="08401-1566">However, if you are adding strings to a file by using a loop, a <xref:System.IO.StreamWriter> object can provide better performance because you only have to open and close the file one time.</span></span> <span data-ttu-id="08401-1567">有关更多信息，请参见 <xref:Microsoft.VisualBasic.MyServices.FileSystemProxy.OpenTextFileWriter%2A> 方法。</span><span class="sxs-lookup"><span data-stu-id="08401-1567">For more information, see the <xref:Microsoft.VisualBasic.MyServices.FileSystemProxy.OpenTextFileWriter%2A> method.</span></span>  
  
 <span data-ttu-id="08401-1568">下表列出了所涉及的任务的示例`My.Computer.FileSystem.WriteAllText`方法。</span><span class="sxs-lookup"><span data-stu-id="08401-1568">The following table lists examples of tasks involving the `My.Computer.FileSystem.WriteAllText` method.</span></span>  
  
|<span data-ttu-id="08401-1569">功能</span><span class="sxs-lookup"><span data-stu-id="08401-1569">To</span></span>|<span data-ttu-id="08401-1570">查看</span><span class="sxs-lookup"><span data-stu-id="08401-1570">See</span></span>|  
|--------|---------|  
|<span data-ttu-id="08401-1571">将文本写入文件</span><span class="sxs-lookup"><span data-stu-id="08401-1571">Write text to a file</span></span>|[<span data-ttu-id="08401-1572">如何：向文件写入文本</span><span class="sxs-lookup"><span data-stu-id="08401-1572">How to: Write Text to Files</span></span>](~/docs/visual-basic/developing-apps/programming/drives-directories-files/how-to-write-text-to-files.md)|  
|<span data-ttu-id="08401-1573">向文件中追加文本</span><span class="sxs-lookup"><span data-stu-id="08401-1573">Append text to a file</span></span>|[<span data-ttu-id="08401-1574">如何：向文本文件追加</span><span class="sxs-lookup"><span data-stu-id="08401-1574">How to: Append to Text Files</span></span>](~/docs/visual-basic/developing-apps/programming/drives-directories-files/how-to-append-to-text-files.md)|  
  
   
  
## Examples  
 <span data-ttu-id="08401-1575">此示例会将行写入`"This is new text to be added."`文件`Test.txt`，覆盖文件中的任何现有文本。</span><span class="sxs-lookup"><span data-stu-id="08401-1575">This example writes the line `"This is new text to be added."` to the file `Test.txt`, overwriting any existing text in the file.</span></span>  
  
 [!code-vb[VbRefFile#21](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbRefFile/VB/Class1.vb#21)]  
  
 <span data-ttu-id="08401-1576">此示例中的文件的文件名写入`Documents and Settings`文件夹到`FileList.txt`，插入一个回车符返回可读性更好的每个之间。</span><span class="sxs-lookup"><span data-stu-id="08401-1576">This example writes the names of the files in the `Documents and Settings` folder to `FileList.txt`, inserting a carriage return between each for better readability.</span></span>  
  
 [!code-vb[VbRefFile#22](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbRefFile/VB/Class1.vb#22)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentException"><span data-ttu-id="08401-1577">路径由于以下原因之一无效：是零长度字符串；仅为空白；包含无效字符；是一个设备路径（以 \\\\.\\ 开头）；以尾部反斜杠结尾。</span><span class="sxs-lookup"><span data-stu-id="08401-1577">The path is not valid for one of the following reasons: it is a zero-length string; it contains only white space; it contains invalid characters; or it is a device path (starts with \\\\.\\); it ends with a trailing slash.</span></span></exception>
        <exception cref="T:System.ArgumentNullException"><span data-ttu-id="08401-1578"><paramref name="file" /> 为 <see langword="Nothing" />。</span><span class="sxs-lookup"><span data-stu-id="08401-1578"><paramref name="file" /> is <see langword="Nothing" />.</span></span></exception>
        <exception cref="T:System.IO.FileNotFoundException"><span data-ttu-id="08401-1579">文件不存在。</span><span class="sxs-lookup"><span data-stu-id="08401-1579">The file does not exist.</span></span></exception>
        <exception cref="T:System.IO.IOException"><span data-ttu-id="08401-1580">文件正由另一个进程使用或者出现 I/O 错误。</span><span class="sxs-lookup"><span data-stu-id="08401-1580">The file is in use by another process, or an I/O error occurs.</span></span></exception>
        <exception cref="T:System.IO.PathTooLongException"><span data-ttu-id="08401-1581">路径超过系统定义的最大长度。</span><span class="sxs-lookup"><span data-stu-id="08401-1581">The path exceeds the system-defined maximum length.</span></span></exception>
        <exception cref="T:System.NotSupportedException"><span data-ttu-id="08401-1582">在路径中的文件或目录名称包含冒号 （:），或格式无效。</span><span class="sxs-lookup"><span data-stu-id="08401-1582">A file or directory name in the path contains a colon (:) or is in an invalid format.</span></span></exception>
        <exception cref="T:System.OutOfMemoryException"><span data-ttu-id="08401-1583">不是内存不足，无法将字符串写入缓冲区。</span><span class="sxs-lookup"><span data-stu-id="08401-1583">There is not enough memory to write the string to buffer.</span></span></exception>
        <exception cref="T:System.Security.SecurityException"><span data-ttu-id="08401-1584">该用户缺少必要的权限查看该路径。</span><span class="sxs-lookup"><span data-stu-id="08401-1584">The user lacks necessary permissions to view the path.</span></span></exception>
        <permission cref="T:System.Security.Permissions.FileIOPermission"><span data-ttu-id="08401-1585">控制文件和文件夹的访问权限。</span><span class="sxs-lookup"><span data-stu-id="08401-1585">Controls the ability to access files and folders.</span></span> <span data-ttu-id="08401-1586">关联枚举： <see cref="F:System.Security.Permissions.PermissionState.Unrestricted" />。</span><span class="sxs-lookup"><span data-stu-id="08401-1586">Associated enumeration: <see cref="F:System.Security.Permissions.PermissionState.Unrestricted" />.</span></span></permission>
        <altmember cref="T:System.Text.Encoding" />
        <related type="Article" href="~/docs/visual-basic/language-reference/objects/index.md"><span data-ttu-id="08401-1587">对象 (Visual Basic)</span><span class="sxs-lookup"><span data-stu-id="08401-1587">Objects (Visual Basic)</span></span></related>
        <related type="Article" href="~/docs/visual-basic/developing-apps/programming/drives-directories-files/writing-to-files.md"><span data-ttu-id="08401-1588">写入文件 (Visual Basic)</span><span class="sxs-lookup"><span data-stu-id="08401-1588">Writing to Files in Visual Basic</span></span></related>
      </Docs>
    </Member>
  </Members>
</Type>