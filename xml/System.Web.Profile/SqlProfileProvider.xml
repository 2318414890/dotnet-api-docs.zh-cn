<Type Name="SqlProfileProvider" FullName="System.Web.Profile.SqlProfileProvider">
  <Metadata><Meta Name="ms.openlocfilehash" Value="847d18071427116221020934aefb652b85d97f10" /><Meta Name="ms.sourcegitcommit" Value="c5fd6b431a16f0412349201a0e93a9eacddf4b35" /><Meta Name="ms.translationtype" Value="HT" /><Meta Name="ms.contentlocale" Value="zh-CN" /><Meta Name="ms.lasthandoff" Value="12/14/2018" /><Meta Name="ms.locfileid" Value="53395378" /></Metadata><TypeSignature Language="C#" Value="public class SqlProfileProvider : System.Web.Profile.ProfileProvider" />
  <TypeSignature Language="ILAsm" Value=".class public auto ansi beforefieldinit SqlProfileProvider extends System.Web.Profile.ProfileProvider" />
  <TypeSignature Language="DocId" Value="T:System.Web.Profile.SqlProfileProvider" />
  <TypeSignature Language="VB.NET" Value="Public Class SqlProfileProvider&#xA;Inherits ProfileProvider" />
  <TypeSignature Language="C++ CLI" Value="public ref class SqlProfileProvider : System::Web::Profile::ProfileProvider" />
  <TypeSignature Language="F#" Value="type SqlProfileProvider = class&#xA;    inherit ProfileProvider" />
  <AssemblyInfo>
    <AssemblyName>System.Web</AssemblyName>
    <AssemblyVersion>2.0.0.0</AssemblyVersion>
    <AssemblyVersion>4.0.0.0</AssemblyVersion>
  </AssemblyInfo>
  <Base>
    <BaseTypeName>System.Web.Profile.ProfileProvider</BaseTypeName>
  </Base>
  <Interfaces />
  <Docs>
    <summary>对 ASP.NET 应用程序的配置文件信息在 SQL Server 数据库中的存储进行管理。</summary>
    <remarks>
      <format type="text/markdown"><![CDATA[  
  
## Remarks  
 ASP.NET 配置文件用于存储和检索数据源，如数据库中的用户设置。 使用访问用户配置文件<xref:System.Web.HttpContext.Profile%2A>属性与当前<xref:System.Web.HttpContext>。 使用配置文件提供程序管理配置文件信息和属性值。  
  
 <xref:System.Web.Profile.SqlProfileProvider> ASP.NET 使用类来存储和检索配置文件使用 SQL Server 数据库的 ASP.NET 应用程序的设置。 若要使用<xref:System.Web.Profile.SqlProfileProvider>，必须先创建使用的 SQL Server 数据库<xref:System.Web.Profile.SqlProfileProvider>。 若要创建使用的数据库<xref:System.Web.Profile.SqlProfileProvider>，运行 aspnet_regsql.exe 工具，它位于 [*驱动器*:] \WINDOWS\Microsoft.NET\Framework\\ `2.0versionNumber`文件夹，并指定 **-A p**选项。 以下命令演示了如何使用 aspnet_regsql.exe 可执行文件：  
  
```  
aspnet_regsql.exe -A p  
```  
  
 上面的示例中不会指定创建的数据库的名称，因此将使用默认名称。 默认数据库名称为 Aspnetdb。  
  
 计算机配置包含默认<xref:System.Web.Profile.SqlProfileProvider>名为 AspNetSqlProvider 连接到本地计算机上的 SQL Server 的实例。 可以使用该提供程序，此实例，也可以指定自己的 Web.config 文件中的 ASP.NET 应用程序。  
  
> [!NOTE]
>  如果使用集成的安全性的连接字符串配置配置文件提供程序，ASP.NET 应用程序的进程帐户必须有权连接到 SQL Server 数据库。  
  
   
  
## Examples  
 下面的代码示例显示了配置为使用 ASP.NET 应用程序的 Web.config 文件<xref:System.Web.Profile.SqlProfileProvider>。  
  
```  
<configuration>  
  <connectionStrings>  
    <add name="SqlServices" connectionString=  
      "Data Source=localhost;Integrated Security=SSPI;Initial Catalog=aspnetdb;" />  
  </connectionStrings>  
  
  <system.web>  
    <authentication mode="Forms" >  
      <forms loginUrl="login.aspx" name=".ASPXFORMSAUTH" />  
    </authentication>  
    <authorization>  
      <deny users="?" />  
    </authorization>  
    <membership defaultProvider="SqlProvider"   
      userIsOnlineTimeWindow="15">  
      <providers>  
        <clear/>  
        <add name="SqlProvider"   
          type="System.Web.Security.SqlMembershipProvider"   
          connectionStringName="SqlServices"  
          applicationName="SampleApplication"  
          enablePasswordRetrieval="true"  
          enablePasswordReset="true"  
          passwordFormat="Encrypted"  
          requiresQuestionAndAnswer="true" />  
      </providers>  
    </membership>  
  
    <profile defaultProvider="SqlProvider">  
      <providers>  
        <clear />  
        <add name="SqlProvider"  
          type="System.Web.Profile.SqlProfileProvider"  
          connectionStringName="SqlServices"  
          applicationName="SampleApplication"  
          description="SqlProfileProvider for SampleApplication" />  
      </providers>  
  
      <properties>  
        <add name="ZipCode" />  
        <add name="CityAndState" />  
      </properties>  
    </profile>  
  </system.web>  
</configuration>  
```  
  
 ]]></format>
    </remarks>
    <related type="Article" href="https://msdn.microsoft.com/library/89439440-92ea-48c3-a4bd-dea40307899d">ASP.NET 配置文件属性概述</related>
  </Docs>
  <Members>
    <Member MemberName=".ctor">
      <MemberSignature Language="C#" Value="public SqlProfileProvider ();" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig specialname rtspecialname instance void .ctor() cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Web.Profile.SqlProfileProvider.#ctor" />
      <MemberSignature Language="VB.NET" Value="Public Sub New ()" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; SqlProfileProvider();" />
      <MemberType>Constructor</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Web</AssemblyName>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Attributes>
        <Attribute FrameworkAlternate="netframework-4.0">
          <AttributeName>System.Runtime.TargetedPatchingOptOut("Performance critical to inline this type of method across NGen image boundaries")</AttributeName>
        </Attribute>
      </Attributes>
      <Parameters />
      <Docs>
        <summary>创建 <see cref="T:System.Web.Profile.SqlProfileProvider" /> 类的实例。</summary>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 ASP.NET 调用<xref:System.Web.Profile.SqlProfileProvider.%23ctor%2A>构造函数创建的实例<xref:System.Web.Profile.SqlProfileProvider>类使用该应用程序的配置文件中指定的值。 此构造函数不是要在代码中使用。  
  
 ]]></format>
        </remarks>
        <related type="Article" href="https://msdn.microsoft.com/library/89439440-92ea-48c3-a4bd-dea40307899d">ASP.NET 配置文件属性概述</related>
      </Docs>
    </Member>
    <Member MemberName="ApplicationName">
      <MemberSignature Language="C#" Value="public override string ApplicationName { get; set; }" />
      <MemberSignature Language="ILAsm" Value=".property instance string ApplicationName" />
      <MemberSignature Language="DocId" Value="P:System.Web.Profile.SqlProfileProvider.ApplicationName" />
      <MemberSignature Language="VB.NET" Value="Public Overrides Property ApplicationName As String" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; virtual property System::String ^ ApplicationName { System::String ^ get(); void set(System::String ^ value); };" />
      <MemberSignature Language="F#" Value="member this.ApplicationName : string with get, set" Usage="System.Web.Profile.SqlProfileProvider.ApplicationName" />
      <MemberType>Property</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Web</AssemblyName>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Attributes>
        <Attribute FrameworkAlternate="netframework-4.0">
          <AttributeName>get: System.Runtime.TargetedPatchingOptOut("Performance critical to inline this type of method across NGen image boundaries")</AttributeName>
        </Attribute>
      </Attributes>
      <ReturnValue>
        <ReturnType>System.String</ReturnType>
      </ReturnValue>
      <Docs>
        <summary>获取或设置要存储和检索其配置文件信息的应用程序的名称。</summary>
        <value>要存储和检索其配置文件信息的应用程序的名称。 默认为 <see cref="P:System.Web.Hosting.HostingEnvironment.ApplicationVirtualPath" /> 值。</value>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <xref:System.Web.Profile.SqlProfileProvider.ApplicationName%2A>属性由<xref:System.Web.Profile.SqlProfileProvider>若要将配置文件信息与不同的应用程序相关联。 这使多个应用程序可以使用相同的数据库来存储用户信息而无需重复的用户之间发生冲突。 多个 ASP.NET 应用程序可以通过指定相同的值中使用相同的用户数据库<xref:System.Web.Profile.SqlProfileProvider.ApplicationName%2A>属性。 <xref:System.Web.Profile.SqlProfileProvider.ApplicationName%2A>可以以编程方式设置属性或者可以在 Web 应用程序使用的配置文件中以声明方式设置`applicationName`属性。  
  
 如果没有为指定值`applicationName`Web 应用程序，在配置文件中的属性则<xref:System.Web.Hosting.HostingEnvironment.ApplicationVirtualPath%2A>值用于 ASP.NET 应用程序。 对于非 ASP.NET 应用程序，默认值是<xref:System.Diagnostics.ProcessModule.ModuleName%2A>不带文件扩展名值。  
  
> [!CAUTION]
>  因为一个默认配置文件提供程序实例用于所有服务的请求<xref:System.Web.HttpApplication>对象，可以有多个请求同时执行，并尝试设置<xref:System.Web.Profile.SqlProfileProvider.ApplicationName%2A>属性值。 <xref:System.Web.Profile.SqlProfileProvider.ApplicationName%2A>属性不是线程安全的多个写入操作，且不断变化<xref:System.Web.Profile.SqlProfileProvider.ApplicationName%2A>属性值可能会导致多个用户的应用程序的意外行为。 建议您避免编写代码，使用户能够设置<xref:System.Web.Profile.SqlProfileProvider.ApplicationName%2A>属性除非必要，否则。 应用程序的示例情况<xref:System.Web.Profile.SqlProfileProvider.ApplicationName%2A>属性可能需要是管理多个应用程序的配置文件数据的管理应用程序。 此类应用程序应在单用户应用程序并不是 Web 应用程序。  
  
   
  
## Examples  
 下面的代码示例显示了中的元素`system.web`的 ASP.NET 应用程序的 Web.config 文件部分。 指定应用程序的<xref:System.Web.Profile.SqlProfileProvider>实例并设置<xref:System.Web.Profile.SqlProfileProvider.ApplicationName%2A>属性值设置为`MyApplication`。  
  
```  
<profile defaultProvider="SqlProvider">  
  <providers>  
    <add name="SqlProvider"  
      type="System.Web.Profile.SqlProfileProvider"  
      connectionStringName="SqlServices"  
      applicationName="MyApplication" />  
   </providers>  
</profile>  
```  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.Web.HttpException">不具有 <see cref="P:System.Web.Profile.SqlProfileProvider.ApplicationName" /> ASP.NET 承载权限的调用方尝试设置 <see cref="F:System.Web.AspNetHostingPermissionLevel.High" /> 属性。</exception>
        <exception cref="T:System.Configuration.Provider.ProviderException">尝试将 <see cref="P:System.Web.Profile.SqlProfileProvider.ApplicationName" /> 属性设置为长于 256 个字符的字符串。</exception>
        <related type="Article" href="https://msdn.microsoft.com/library/89439440-92ea-48c3-a4bd-dea40307899d">ASP.NET 配置文件属性概述</related>
      </Docs>
    </Member>
    <Member MemberName="DeleteInactiveProfiles">
      <MemberSignature Language="C#" Value="public override int DeleteInactiveProfiles (System.Web.Profile.ProfileAuthenticationOption authenticationOption, DateTime userInactiveSinceDate);" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig virtual instance int32 DeleteInactiveProfiles(valuetype System.Web.Profile.ProfileAuthenticationOption authenticationOption, valuetype System.DateTime userInactiveSinceDate) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Web.Profile.SqlProfileProvider.DeleteInactiveProfiles(System.Web.Profile.ProfileAuthenticationOption,System.DateTime)" />
      <MemberSignature Language="VB.NET" Value="Public Overrides Function DeleteInactiveProfiles (authenticationOption As ProfileAuthenticationOption, userInactiveSinceDate As DateTime) As Integer" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; override int DeleteInactiveProfiles(System::Web::Profile::ProfileAuthenticationOption authenticationOption, DateTime userInactiveSinceDate);" />
      <MemberSignature Language="F#" Value="override this.DeleteInactiveProfiles : System.Web.Profile.ProfileAuthenticationOption * DateTime -&gt; int" Usage="sqlProfileProvider.DeleteInactiveProfiles (authenticationOption, userInactiveSinceDate)" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Web</AssemblyName>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Int32</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="authenticationOption" Type="System.Web.Profile.ProfileAuthenticationOption" />
        <Parameter Name="userInactiveSinceDate" Type="System.DateTime" />
      </Parameters>
      <Docs>
        <param name="authenticationOption"><see cref="T:System.Web.Profile.ProfileAuthenticationOption" /> 值之一，指定是删除匿名配置文件、已验证的配置文件还是同时删除这两种类型的配置文件。</param>
        <param name="userInactiveSinceDate">一个 <see cref="T:System.DateTime" />，确定将哪些用户配置文件视为处于不活动状态。 如果用户配置文件的 <see cref="P:System.Web.Profile.ProfileInfo.LastActivityDate" /> 与此日期和时间相同，或在此日期和时间之前，则此配置文件被视为处于不活动状态。</param>
        <summary>删除上次活动日期出现在指定日期和时间之前的配置文件的用户配置文件数据。</summary>
        <returns>从数据源中删除的配置文件的数目。</returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <xref:System.Web.Profile.SqlProfileProvider.DeleteInactiveProfiles%2A>方法用于从指定的应用程序的数据源中删除未使用的配置文件数据`applicationName`配置文件中的属性。 使用`authenticationOption`参数来指定是否仅匿名配置文件，仅经过身份验证配置文件或要搜索的所有配置文件。 搜索的配置文件，所有与配置文件<xref:System.Web.Profile.ProfileInfo.LastActivityDate%2A>当天或之前指定发生这种情况`userInactiveSinceDate`删除参数值。  
  
 在调用期间执行数据库更新<xref:System.Web.Profile.SqlProfileProvider.DeleteInactiveProfiles%2A>方法将在事务内完成。 如果遇到错误，则回滚事务并不执行任何更新。  
  
   
  
## Examples  
 下面的代码示例显示了 ASP.NET 页面，用于管理不活动配置文件。 提供了一个按钮来删除自指定的日期考虑到一个配置文件处于非活动状态起未访问过的所有配置文件。  
  
 [!code-aspx-csharp[System.Web.Profile.SqlProfileProvider#4](~/samples/snippets/csharp/VS_Snippets_WebNet/System.Web.Profile.SqlProfileProvider/CS/DeleteInactiveProfilescs.aspx#4)]
 [!code-aspx-vb[System.Web.Profile.SqlProfileProvider#4](~/samples/snippets/visualbasic/VS_Snippets_WebNet/System.Web.Profile.SqlProfileProvider/VB/DeleteInactiveProfilesvb.aspx#4)]  
  
 ]]></format>
        </remarks>
        <related type="Article" href="https://msdn.microsoft.com/library/89439440-92ea-48c3-a4bd-dea40307899d">ASP.NET 配置文件属性概述</related>
      </Docs>
    </Member>
    <MemberGroup MemberName="DeleteProfiles">
      <AssemblyInfo>
        <AssemblyName>System.Web</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Docs>
        <summary>从数据源中删除配置文件属性和信息。</summary>
        <related type="Article" href="https://msdn.microsoft.com/library/89439440-92ea-48c3-a4bd-dea40307899d">ASP.NET 配置文件属性概述</related>
      </Docs>
    </MemberGroup>
    <Member MemberName="DeleteProfiles">
      <MemberSignature Language="C#" Value="public override int DeleteProfiles (string[] usernames);" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig virtual instance int32 DeleteProfiles(string[] usernames) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Web.Profile.SqlProfileProvider.DeleteProfiles(System.String[])" />
      <MemberSignature Language="VB.NET" Value="Public Overrides Function DeleteProfiles (usernames As String()) As Integer" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; override int DeleteProfiles(cli::array &lt;System::String ^&gt; ^ usernames);" />
      <MemberSignature Language="F#" Value="override this.DeleteProfiles : string[] -&gt; int" Usage="sqlProfileProvider.DeleteProfiles usernames" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Web</AssemblyName>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Int32</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="usernames" Type="System.String[]" />
      </Parameters>
      <Docs>
        <param name="usernames">要删除的配置文件的用户名字符串数组。</param>
        <summary>从数据源中删除提供的一系列用户名的配置文件属性和信息。</summary>
        <returns>从数据源中删除的配置文件的数目。</returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <xref:System.Web.Profile.SqlProfileProvider.DeleteProfiles%2A>方法从指定的应用程序数据源中删除所有个人资料信息和属性指定配置文件的`applicationName`配置文件中的属性。 要删除的配置文件列表指定为用户名称的字符串数组。 如果在用户名中的数据源中存在的配置文件属性和信息`usernames`参数，将其删除。  
  
 返回值可能不同于指定的数组的长度`usernames`。 这指示指定的数组中的配置文件的一些`usernames`了已从数据存储区中删除。  
  
 在调用期间执行数据库更新<xref:System.Web.Profile.SqlProfileProvider.DeleteProfiles%2A>方法将在事务内完成。 如果遇到错误，则回滚事务并不执行任何更新。  
  
   
  
## Examples  
 下面的代码示例显示了 ASP.NET 页面，用于管理不活动配置文件。 一个<xref:System.Web.UI.WebControls.GridView>控件显示返回的非活动配置文件。 每一行<xref:System.Web.UI.WebControls.GridView>控件包含一个按钮，从数据源通过调用中删除该行的配置文件<xref:System.Web.Profile.SqlProfileProvider.DeleteProfiles%2A>方法。  
  
 [!code-aspx-csharp[System.Web.Profile.SqlProfileProvider#4](~/samples/snippets/csharp/VS_Snippets_WebNet/System.Web.Profile.SqlProfileProvider/CS/DeleteInactiveProfilescs.aspx#4)]
 [!code-aspx-vb[System.Web.Profile.SqlProfileProvider#4](~/samples/snippets/visualbasic/VS_Snippets_WebNet/System.Web.Profile.SqlProfileProvider/VB/DeleteInactiveProfilesvb.aspx#4)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentException"><paramref name="usernames" /> 的长度为零。  
  
或 
<paramref name="usernames" /> 中的一个项目为空字符串 ("")、长度超过 256 个字符或包含逗号。  
  
- 或 - 
<paramref name="usernames" /> 中的两个或更多个项目具有相同的值。</exception>
        <exception cref="T:System.ArgumentNullException"><paramref name="usernames" /> 为 <see langword="null" />。  
  
- 或 - 
<paramref name="usernames" /> 中的一个项目为 <see langword="null" />。</exception>
        <related type="Article" href="https://msdn.microsoft.com/library/89439440-92ea-48c3-a4bd-dea40307899d">ASP.NET 配置文件属性概述</related>
      </Docs>
    </Member>
    <Member MemberName="DeleteProfiles">
      <MemberSignature Language="C#" Value="public override int DeleteProfiles (System.Web.Profile.ProfileInfoCollection profiles);" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig virtual instance int32 DeleteProfiles(class System.Web.Profile.ProfileInfoCollection profiles) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Web.Profile.SqlProfileProvider.DeleteProfiles(System.Web.Profile.ProfileInfoCollection)" />
      <MemberSignature Language="VB.NET" Value="Public Overrides Function DeleteProfiles (profiles As ProfileInfoCollection) As Integer" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; override int DeleteProfiles(System::Web::Profile::ProfileInfoCollection ^ profiles);" />
      <MemberSignature Language="F#" Value="override this.DeleteProfiles : System.Web.Profile.ProfileInfoCollection -&gt; int" Usage="sqlProfileProvider.DeleteProfiles profiles" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Web</AssemblyName>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Int32</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="profiles" Type="System.Web.Profile.ProfileInfoCollection" />
      </Parameters>
      <Docs>
        <param name="profiles">一个 <see cref="T:System.Web.Profile.ProfileInfoCollection" />，包含要删除的配置文件的配置文件信息。</param>
        <summary>从数据源中删除提供的一系列配置文件的配置文件属性和信息。</summary>
        <returns>从数据源中删除的配置文件的数目。</returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <xref:System.Web.Profile.SqlProfileProvider.DeleteProfiles%2A>方法从指定的应用程序数据源中删除所有个人资料信息和属性指定配置文件的`applicationName`配置文件中的属性。 使用指定的配置文件，以删除列表<xref:System.Web.Profile.ProfileInfoCollection>作为传递`profiles`参数。 一个<xref:System.Web.Profile.ProfileInfoCollection>可以从返回<xref:System.Web.Profile.SqlProfileProvider.GetAllProfiles%2A>， <xref:System.Web.Profile.SqlProfileProvider.GetAllInactiveProfiles%2A>， <xref:System.Web.Profile.SqlProfileProvider.FindProfilesByUserName%2A>，和<xref:System.Web.Profile.SqlProfileProvider.FindInactiveProfilesByUserName%2A>方法。  
  
 返回值可能不同于<xref:System.Web.Profile.ProfileInfoCollection.Count%2A>值提供的<xref:System.Web.Profile.ProfileInfoCollection>。 这指示中指定的配置文件的一些<xref:System.Web.Profile.ProfileInfoCollection>不再在数据存储中找到。  
  
 在调用期间执行数据库更新<xref:System.Web.Profile.SqlProfileProvider.DeleteProfiles%2A>方法将在事务内完成。 如果遇到错误，则回滚事务并不执行任何更新。  
  
   
  
## Examples  
 下面的代码示例允许用户使用的配置文件中搜索<xref:System.Web.Profile.SqlProfileProvider.FindProfilesByUserName%2A>和<xref:System.Web.Profile.SqlProfileProvider.FindInactiveProfilesByUserName%2A>方法。 用户可以删除通过调用返回的配置文件<xref:System.Web.Profile.SqlProfileProvider.DeleteProfiles%2A>方法。  
  
 [!code-aspx-csharp[System.Web.Profile.SqlProfileProvider#5](~/samples/snippets/csharp/VS_Snippets_WebNet/System.Web.Profile.SqlProfileProvider/CS/FindProfilesByUserNamecs.aspx#5)]
 [!code-aspx-vb[System.Web.Profile.SqlProfileProvider#5](~/samples/snippets/visualbasic/VS_Snippets_WebNet/System.Web.Profile.SqlProfileProvider/VB/FindProfilesByUserNamevb.aspx#5)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentException"><paramref name="profiles" /> 的 <see cref="P:System.Web.Profile.ProfileInfoCollection.Count" /> 值为零。  
  
或 
<paramref name="profiles" /> 中的一个 <see cref="T:System.Web.Profile.ProfileInfo" /> 对象具有一个为空字符串 ("")、长度超过 256 个字符或包含逗号的 <see cref="P:System.Web.Profile.ProfileInfo.UserName" />。</exception>
        <exception cref="T:System.ArgumentNullException"><paramref name="profiles" /> 为 <see langword="null" />。  
  
- 或 - 
<paramref name="profiles" /> 中的一个 <see cref="T:System.Web.Profile.ProfileInfo" /> 对象具有一个为 <see langword="null" /> 的 <see cref="P:System.Web.Profile.ProfileInfo.UserName" />。</exception>
        <related type="Article" href="https://msdn.microsoft.com/library/89439440-92ea-48c3-a4bd-dea40307899d">ASP.NET 配置文件属性概述</related>
      </Docs>
    </Member>
    <Member MemberName="FindInactiveProfilesByUserName">
      <MemberSignature Language="C#" Value="public override System.Web.Profile.ProfileInfoCollection FindInactiveProfilesByUserName (System.Web.Profile.ProfileAuthenticationOption authenticationOption, string usernameToMatch, DateTime userInactiveSinceDate, int pageIndex, int pageSize, out int totalRecords);" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig virtual instance class System.Web.Profile.ProfileInfoCollection FindInactiveProfilesByUserName(valuetype System.Web.Profile.ProfileAuthenticationOption authenticationOption, string usernameToMatch, valuetype System.DateTime userInactiveSinceDate, int32 pageIndex, int32 pageSize, [out] int32&amp; totalRecords) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Web.Profile.SqlProfileProvider.FindInactiveProfilesByUserName(System.Web.Profile.ProfileAuthenticationOption,System.String,System.DateTime,System.Int32,System.Int32,System.Int32@)" />
      <MemberSignature Language="VB.NET" Value="Public Overrides Function FindInactiveProfilesByUserName (authenticationOption As ProfileAuthenticationOption, usernameToMatch As String, userInactiveSinceDate As DateTime, pageIndex As Integer, pageSize As Integer, ByRef totalRecords As Integer) As ProfileInfoCollection" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; override System::Web::Profile::ProfileInfoCollection ^ FindInactiveProfilesByUserName(System::Web::Profile::ProfileAuthenticationOption authenticationOption, System::String ^ usernameToMatch, DateTime userInactiveSinceDate, int pageIndex, int pageSize, [Runtime::InteropServices::Out] int % totalRecords);" />
      <MemberSignature Language="F#" Value="override this.FindInactiveProfilesByUserName : System.Web.Profile.ProfileAuthenticationOption * string * DateTime * int * int *  -&gt; System.Web.Profile.ProfileInfoCollection" Usage="sqlProfileProvider.FindInactiveProfilesByUserName (authenticationOption, usernameToMatch, userInactiveSinceDate, pageIndex, pageSize, totalRecords)" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Web</AssemblyName>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Web.Profile.ProfileInfoCollection</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="authenticationOption" Type="System.Web.Profile.ProfileAuthenticationOption" />
        <Parameter Name="usernameToMatch" Type="System.String" />
        <Parameter Name="userInactiveSinceDate" Type="System.DateTime" />
        <Parameter Name="pageIndex" Type="System.Int32" />
        <Parameter Name="pageSize" Type="System.Int32" />
        <Parameter Name="totalRecords" Type="System.Int32" RefType="out" />
      </Parameters>
      <Docs>
        <param name="authenticationOption"><see cref="T:System.Web.Profile.ProfileAuthenticationOption" /> 值之一，指定是返回匿名配置文件、经过身份验证的配置文件还是同时返回这两种类型的配置文件。</param>
        <param name="usernameToMatch">要搜索的用户名。</param>
        <param name="userInactiveSinceDate">一个 <see cref="T:System.DateTime" />，确定将哪些用户配置文件视为处于不活动状态。 如果用户配置文件的 <see cref="P:System.Web.Profile.ProfileInfo.LastActivityDate" /> 与此日期和时间相同，或在此日期和时间之前，则此配置文件被视为处于不活动状态。</param>
        <param name="pageIndex">要返回的结果页的索引。 <paramref name="pageIndex" /> 从零开始。</param>
        <param name="pageSize">要返回的结果页的大小。</param>
        <param name="totalRecords">此方法返回时，会包含一个表示配置文件总数的整数。 此参数未经初始化即被传递。</param>
        <summary>检索一些配置文件的配置文件信息，在这些配置文件中，上次活动日期与指定的日期和时间相同或在其之前，而且配置文件的用户名与指定的名称匹配。</summary>
        <returns>包含不活动配置文件的用户配置文件信息的 <see cref="T:System.Web.Profile.ProfileInfoCollection" />，这些不活动配置文件中的用户名与提供的 <paramref name="usernameToMatch" /> 参数相匹配。</returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <xref:System.Web.Profile.SqlProfileProvider.FindInactiveProfilesByUserName%2A>方法用于检索有关指定的应用程序未使用的用户配置文件的个人资料信息`applicationName`配置文件中的属性。 此方法将只检索配置文件为其配置文件的用户名与提供`usernameToMatch`参数值。 使用`authenticationOption`参数来指定是否仅匿名配置文件，仅经过身份验证配置文件或要搜索的所有配置文件。 搜索的配置文件，所有与配置文件<xref:System.Web.Profile.ProfileInfo.LastActivityDate%2A>发生这种情况之前指定`userInactiveSinceDate`返回参数值。  
  
 <xref:System.Web.Profile.SqlProfileProvider>搜索的匹配项`usernameToMatch`参数值使用`LIKE`关键字，并支持通配符，例如百分号 （%）。 例如，如果`usernameToMatch`参数设置为"user1"，则返回为配置文件的用户名称为"user1"的配置文件信息，如果它存在。 如果`usernameToMatch`参数设置为"user %"，则返回"user1"、"user2"、"user_admin"等的配置文件的用户名的配置文件信息。 用户自己的配置文件已添加到数据存储中的顺序返回。  
  
 返回的结果<xref:System.Web.Profile.SqlProfileProvider.FindInactiveProfilesByUserName%2A>受到`pageIndex`和`pageSize`参数。 `pageSize`参数标识的最大数目<xref:System.Web.Profile.ProfileInfo>对象中返回<xref:System.Web.Profile.ProfileInfoCollection>。 `pageIndex`参数标识要返回的结果页; 0 标识的第一页。 `totalRecords`参数是`out`参数设置为已配置的非活动状态的用户配置文件的总数`applicationName`根据`authenticationOption`和`userInactiveSinceDate`参数。 例如，如果有已配置的 13 个用户`applicationName`，并`pageIndex`值为 1`pageSize`为 5，<xref:System.Web.Profile.ProfileInfoCollection>返回将包含第六到第十个不活动配置文件。 `totalRecords`参数将设置为 13。  
  
   
  
## Examples  
 下面的代码示例允许用户提供`usernameToMatch`值和一个<xref:System.Web.Profile.ProfileAuthenticationOption>和检索配置文件的任何匹配的配置文件信息。 该示例还允许用户指定是否以独占方式返回不活动配置文件。 如果用户指定仅不活动配置文件<xref:System.Web.Profile.SqlProfileProvider.FindInactiveProfilesByUserName%2A>方法是调用; 否则为<xref:System.Web.Profile.SqlProfileProvider.FindProfilesByUserName%2A>调用方法。  
  
 [!code-aspx-csharp[System.Web.Profile.SqlProfileProvider#5](~/samples/snippets/csharp/VS_Snippets_WebNet/System.Web.Profile.SqlProfileProvider/CS/FindProfilesByUserNamecs.aspx#5)]
 [!code-aspx-vb[System.Web.Profile.SqlProfileProvider#5](~/samples/snippets/visualbasic/VS_Snippets_WebNet/System.Web.Profile.SqlProfileProvider/VB/FindProfilesByUserNamevb.aspx#5)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentNullException"><paramref name="usernameToMatch" /> 为 <see langword="null" />。</exception>
        <exception cref="T:System.ArgumentException"><paramref name="usernameToMatch" /> 为空字符串 ("") 或超过 256 个字符。  
  
- 或 - 
 <paramref name="pageIndex" /> 小于零。  
  
或 
 <paramref name="pageSize" /> 小于一。  
  
或 
 <paramref name="pageIndex" /> 和 <paramref name="pageSize" /> 的乘积大于 <see cref="F:System.Int32.MaxValue" />。</exception>
        <related type="Article" href="https://msdn.microsoft.com/library/89439440-92ea-48c3-a4bd-dea40307899d">ASP.NET 配置文件属性概述</related>
      </Docs>
    </Member>
    <Member MemberName="FindProfilesByUserName">
      <MemberSignature Language="C#" Value="public override System.Web.Profile.ProfileInfoCollection FindProfilesByUserName (System.Web.Profile.ProfileAuthenticationOption authenticationOption, string usernameToMatch, int pageIndex, int pageSize, out int totalRecords);" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig virtual instance class System.Web.Profile.ProfileInfoCollection FindProfilesByUserName(valuetype System.Web.Profile.ProfileAuthenticationOption authenticationOption, string usernameToMatch, int32 pageIndex, int32 pageSize, [out] int32&amp; totalRecords) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Web.Profile.SqlProfileProvider.FindProfilesByUserName(System.Web.Profile.ProfileAuthenticationOption,System.String,System.Int32,System.Int32,System.Int32@)" />
      <MemberSignature Language="VB.NET" Value="Public Overrides Function FindProfilesByUserName (authenticationOption As ProfileAuthenticationOption, usernameToMatch As String, pageIndex As Integer, pageSize As Integer, ByRef totalRecords As Integer) As ProfileInfoCollection" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; override System::Web::Profile::ProfileInfoCollection ^ FindProfilesByUserName(System::Web::Profile::ProfileAuthenticationOption authenticationOption, System::String ^ usernameToMatch, int pageIndex, int pageSize, [Runtime::InteropServices::Out] int % totalRecords);" />
      <MemberSignature Language="F#" Value="override this.FindProfilesByUserName : System.Web.Profile.ProfileAuthenticationOption * string * int * int *  -&gt; System.Web.Profile.ProfileInfoCollection" Usage="sqlProfileProvider.FindProfilesByUserName (authenticationOption, usernameToMatch, pageIndex, pageSize, totalRecords)" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Web</AssemblyName>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Web.Profile.ProfileInfoCollection</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="authenticationOption" Type="System.Web.Profile.ProfileAuthenticationOption" />
        <Parameter Name="usernameToMatch" Type="System.String" />
        <Parameter Name="pageIndex" Type="System.Int32" />
        <Parameter Name="pageSize" Type="System.Int32" />
        <Parameter Name="totalRecords" Type="System.Int32" RefType="out" />
      </Parameters>
      <Docs>
        <param name="authenticationOption"><see cref="T:System.Web.Profile.ProfileAuthenticationOption" /> 值之一，指定是返回匿名配置文件、经过身份验证的配置文件还是同时返回这两种类型的配置文件。</param>
        <param name="usernameToMatch">要搜索的用户名。</param>
        <param name="pageIndex">要返回的结果页的索引。 <paramref name="pageIndex" /> 从零开始。</param>
        <param name="pageSize">要返回的结果页的大小。</param>
        <param name="totalRecords">此方法返回时，会包含一个表示配置文件总数的整数。 此参数未经初始化即被传递。</param>
        <summary>检索用户名与指定名称匹配的配置文件的配置文件信息。</summary>
        <returns>包含配置文件中的用户配置文件信息的 <see cref="T:System.Web.Profile.ProfileInfoCollection" />，其中的用户名与提供的 <paramref name="usernameToMatch" /> 参数相匹配。</returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <xref:System.Web.Profile.SqlProfileProvider.FindInactiveProfilesByUserName%2A>方法将返回为其配置文件的用户名匹配所提供的配置文件信息的列表`usernameToMatch`已配置的参数值<xref:System.Web.Profile.SqlProfileProvider.ApplicationName%2A>。 使用`authenticationOption`参数来指定是否仅匿名配置文件，仅经过身份验证配置文件或要搜索的所有配置文件。  
  
 <xref:System.Web.Profile.SqlProfileProvider>搜索的匹配项`usernameToMatch`参数值使用`LIKE`关键字，并支持通配符，例如百分号 （%）。 例如，如果`usernameToMatch`参数设置为"user1"，则返回为配置文件的用户名称为"user1"的配置文件信息，如果它存在。 如果`usernameToMatch`参数设置为"user %"，则返回"user1"、"user2"、"user_admin"等的配置文件的用户名的配置文件信息。 用户自己的配置文件已添加到数据存储中的顺序返回。  
  
 返回的结果<xref:System.Web.Profile.SqlProfileProvider.FindProfilesByUserName%2A>受到`pageIndex`和`pageSize`参数。 `pageSize`参数标识的最大数目<xref:System.Web.Profile.ProfileInfo>对象中返回<xref:System.Web.Profile.ProfileInfoCollection>。 `pageIndex`参数标识要返回的结果页; 0 标识的第一页。 `totalRecords`参数是`out`参数设置为指定的应用程序的非活动状态的用户配置文件的总数`applicationName`属性中配置文件中，基于`authenticationOption`和`userInactiveSinceDate`参数。 例如，如果有已配置的 13 个用户`applicationName`，并`pageIndex`值为 1`pageSize`为 5，<xref:System.Web.Profile.ProfileInfoCollection>返回将包含第六到第十个配置文件。 `totalRecords`参数将设置为 13。  
  
   
  
## Examples  
 下面的代码示例允许用户提供`usernameToMatch`值和一个<xref:System.Web.Profile.ProfileAuthenticationOption>和检索配置文件的任何匹配的配置文件信息。 该示例还允许用户指定是否以独占方式返回不活动配置文件。 如果用户指定仅不活动配置文件<xref:System.Web.Profile.SqlProfileProvider.FindInactiveProfilesByUserName%2A>方法是调用; 否则为<xref:System.Web.Profile.SqlProfileProvider.FindProfilesByUserName%2A>调用方法。  
  
 [!code-aspx-csharp[System.Web.Profile.SqlProfileProvider#5](~/samples/snippets/csharp/VS_Snippets_WebNet/System.Web.Profile.SqlProfileProvider/CS/FindProfilesByUserNamecs.aspx#5)]
 [!code-aspx-vb[System.Web.Profile.SqlProfileProvider#5](~/samples/snippets/visualbasic/VS_Snippets_WebNet/System.Web.Profile.SqlProfileProvider/VB/FindProfilesByUserNamevb.aspx#5)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentNullException"><paramref name="usernameToMatch" /> 为 <see langword="null" />。</exception>
        <exception cref="T:System.ArgumentException"><paramref name="usernameToMatch" /> 为空字符串 ("") 或超过 256 个字符。  
  
或 
 <paramref name="pageIndex" /> 小于零。  
  
- 或 - 
 <paramref name="pageSize" /> 小于一。  
  
- 或 - 
 <paramref name="pageIndex" /> 和 <paramref name="pageSize" /> 的乘积大于 <see cref="F:System.Int32.MaxValue" />。</exception>
        <related type="Article" href="https://msdn.microsoft.com/library/89439440-92ea-48c3-a4bd-dea40307899d">ASP.NET 配置文件属性概述</related>
      </Docs>
    </Member>
    <Member MemberName="GetAllInactiveProfiles">
      <MemberSignature Language="C#" Value="public override System.Web.Profile.ProfileInfoCollection GetAllInactiveProfiles (System.Web.Profile.ProfileAuthenticationOption authenticationOption, DateTime userInactiveSinceDate, int pageIndex, int pageSize, out int totalRecords);" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig virtual instance class System.Web.Profile.ProfileInfoCollection GetAllInactiveProfiles(valuetype System.Web.Profile.ProfileAuthenticationOption authenticationOption, valuetype System.DateTime userInactiveSinceDate, int32 pageIndex, int32 pageSize, [out] int32&amp; totalRecords) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Web.Profile.SqlProfileProvider.GetAllInactiveProfiles(System.Web.Profile.ProfileAuthenticationOption,System.DateTime,System.Int32,System.Int32,System.Int32@)" />
      <MemberSignature Language="VB.NET" Value="Public Overrides Function GetAllInactiveProfiles (authenticationOption As ProfileAuthenticationOption, userInactiveSinceDate As DateTime, pageIndex As Integer, pageSize As Integer, ByRef totalRecords As Integer) As ProfileInfoCollection" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; override System::Web::Profile::ProfileInfoCollection ^ GetAllInactiveProfiles(System::Web::Profile::ProfileAuthenticationOption authenticationOption, DateTime userInactiveSinceDate, int pageIndex, int pageSize, [Runtime::InteropServices::Out] int % totalRecords);" />
      <MemberSignature Language="F#" Value="override this.GetAllInactiveProfiles : System.Web.Profile.ProfileAuthenticationOption * DateTime * int * int *  -&gt; System.Web.Profile.ProfileInfoCollection" Usage="sqlProfileProvider.GetAllInactiveProfiles (authenticationOption, userInactiveSinceDate, pageIndex, pageSize, totalRecords)" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Web</AssemblyName>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Web.Profile.ProfileInfoCollection</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="authenticationOption" Type="System.Web.Profile.ProfileAuthenticationOption" />
        <Parameter Name="userInactiveSinceDate" Type="System.DateTime" />
        <Parameter Name="pageIndex" Type="System.Int32" />
        <Parameter Name="pageSize" Type="System.Int32" />
        <Parameter Name="totalRecords" Type="System.Int32" RefType="out" />
      </Parameters>
      <Docs>
        <param name="authenticationOption"><see cref="T:System.Web.Profile.ProfileAuthenticationOption" /> 值之一，指定是返回匿名配置文件、经过身份验证的配置文件还是同时返回这两种类型的配置文件。</param>
        <param name="userInactiveSinceDate">一个 <see cref="T:System.DateTime" />，确定将哪些用户配置文件视为处于不活动状态。 如果用户配置文件的 <see cref="P:System.Web.Profile.ProfileInfo.LastActivityDate" /> 与此日期和时间相同，或在此日期和时间之前，则此配置文件被视为处于不活动状态。</param>
        <param name="pageIndex">要返回的结果页的索引。 <paramref name="pageIndex" /> 从零开始。</param>
        <param name="pageSize">要返回的结果页的大小。</param>
        <param name="totalRecords">此方法返回时，会包含一个表示配置文件总数的整数。 此参数未经初始化即被传递。</param>
        <summary>对于上次活动日期与指定的日期和时间相同或在其之前的配置文件，检索它们的用户配置文件数据。</summary>
        <returns>一个 <see cref="T:System.Web.Profile.ProfileInfoCollection" />，包含有关不活动的配置文件的用户配置文件信息。</returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <xref:System.Web.Profile.SqlProfileProvider.GetAllInactiveProfiles%2A>方法用于从指定的应用程序的未使用的用户配置文件的数据源中检索配置文件信息`applicationName`配置文件中的属性。 使用`authenticationOption`参数来指定是否仅匿名配置文件，仅经过身份验证配置文件或要搜索的所有配置文件。 搜索的配置文件，所有与配置文件<xref:System.Web.Profile.ProfileInfo.LastActivityDate%2A>发生这种情况之前指定`userInactiveSinceDate`返回参数值。  
  
 返回的结果<xref:System.Web.Profile.SqlProfileProvider.GetAllInactiveProfiles%2A>受到`pageIndex`和`pageSize`参数。 `pageSize`参数标识的最大数目<xref:System.Web.Profile.ProfileInfo>对象中返回<xref:System.Web.Profile.ProfileInfoCollection>。 `pageIndex`参数标识要返回的结果页; 0 标识的第一页。 `totalRecords`参数是`out`参数设置为已配置的非活动状态的用户配置文件的总数`applicationName`根据`authenticationOption`和`userInactiveSinceDate`参数。 例如，如果有已配置的 13 个用户`applicationName`，并`pageIndex`值为 1`pageSize`为 5，<xref:System.Web.Profile.ProfileInfoCollection>返回将包含第六到第十个不活动配置文件。 `totalRecords`参数将设置为 13。  
  
   
  
## Examples  
 下面的代码示例显示了 ASP.NET 页面，用于管理不活动配置文件。 提供了一个按钮来删除非活动状态的所有配置文件。 是否将配置文件视为处于非活动状态基于为指定的日期`userInactiveSinceDate`参数。  
  
 [!code-aspx-csharp[System.Web.Profile.SqlProfileProvider#4](~/samples/snippets/csharp/VS_Snippets_WebNet/System.Web.Profile.SqlProfileProvider/CS/DeleteInactiveProfilescs.aspx#4)]
 [!code-aspx-vb[System.Web.Profile.SqlProfileProvider#4](~/samples/snippets/visualbasic/VS_Snippets_WebNet/System.Web.Profile.SqlProfileProvider/VB/DeleteInactiveProfilesvb.aspx#4)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentException"><paramref name="pageIndex" /> 小于零。  
  
- 或 - 
 <paramref name="pageSize" /> 小于一。  
  
- 或 - 
 <paramref name="pageIndex" /> 和 <paramref name="pageSize" /> 的乘积大于 <see cref="F:System.Int32.MaxValue" />。</exception>
        <related type="Article" href="https://msdn.microsoft.com/library/89439440-92ea-48c3-a4bd-dea40307899d">ASP.NET 配置文件属性概述</related>
      </Docs>
    </Member>
    <Member MemberName="GetAllProfiles">
      <MemberSignature Language="C#" Value="public override System.Web.Profile.ProfileInfoCollection GetAllProfiles (System.Web.Profile.ProfileAuthenticationOption authenticationOption, int pageIndex, int pageSize, out int totalRecords);" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig virtual instance class System.Web.Profile.ProfileInfoCollection GetAllProfiles(valuetype System.Web.Profile.ProfileAuthenticationOption authenticationOption, int32 pageIndex, int32 pageSize, [out] int32&amp; totalRecords) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Web.Profile.SqlProfileProvider.GetAllProfiles(System.Web.Profile.ProfileAuthenticationOption,System.Int32,System.Int32,System.Int32@)" />
      <MemberSignature Language="VB.NET" Value="Public Overrides Function GetAllProfiles (authenticationOption As ProfileAuthenticationOption, pageIndex As Integer, pageSize As Integer, ByRef totalRecords As Integer) As ProfileInfoCollection" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; override System::Web::Profile::ProfileInfoCollection ^ GetAllProfiles(System::Web::Profile::ProfileAuthenticationOption authenticationOption, int pageIndex, int pageSize, [Runtime::InteropServices::Out] int % totalRecords);" />
      <MemberSignature Language="F#" Value="override this.GetAllProfiles : System.Web.Profile.ProfileAuthenticationOption * int * int *  -&gt; System.Web.Profile.ProfileInfoCollection" Usage="sqlProfileProvider.GetAllProfiles (authenticationOption, pageIndex, pageSize, totalRecords)" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Web</AssemblyName>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Web.Profile.ProfileInfoCollection</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="authenticationOption" Type="System.Web.Profile.ProfileAuthenticationOption" />
        <Parameter Name="pageIndex" Type="System.Int32" />
        <Parameter Name="pageSize" Type="System.Int32" />
        <Parameter Name="totalRecords" Type="System.Int32" RefType="out" />
      </Parameters>
      <Docs>
        <param name="authenticationOption"><see cref="T:System.Web.Profile.ProfileAuthenticationOption" /> 值之一，指定是返回匿名配置文件、经过身份验证的配置文件还是同时返回这两种类型的配置文件。</param>
        <param name="pageIndex">要返回的结果页的索引。 <paramref name="pageIndex" /> 从零开始。</param>
        <param name="pageSize">要返回的结果页的大小。</param>
        <param name="totalRecords">此方法返回时，会包含一个表示配置文件总数的整数。 此参数未经初始化即被传递。</param>
        <summary>在数据源中检索配置文件的用户配置文件数据。</summary>
        <returns>一个 <see cref="T:System.Web.Profile.ProfileInfoCollection" />，包含数据源中所有配置文件的用户配置文件信息。</returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <xref:System.Web.Profile.SqlProfileProvider.GetAllProfiles%2A>方法用于从指定的应用程序的数据源中检索配置文件的个人资料信息`applicationName`配置文件中的属性。 使用`authenticationOption`参数来指定是否仅匿名配置文件，仅经过身份验证配置文件或要搜索的所有配置文件。  
  
 返回的结果<xref:System.Web.Profile.SqlProfileProvider.GetAllInactiveProfiles%2A>受到`pageIndex`和`pageSize`参数。 `pageSize`参数标识的最大数目<xref:System.Web.Profile.ProfileInfo>对象中返回<xref:System.Web.Profile.ProfileInfoCollection>。 `pageIndex`参数标识要返回的结果页; 0 标识的第一页。 `totalRecords`参数是`out`参数设置为已配置的非活动状态的用户配置文件的总数`applicationName`根据`authenticationOption`和`userInactiveSinceDate`参数。 例如，如果有已配置的 13 个用户`applicationName`，并`pageIndex`值为 1`pageSize`为 5，<xref:System.Web.Profile.ProfileInfoCollection>返回将包含第六到第十个配置文件。 `totalRecords`参数将设置为 13。  
  
   
  
## Examples  
 下面的代码示例显示所有已配置的配置文件的配置文件信息`applicationName`中的数据页。  
  
 [!code-aspx-csharp[System.Web.Profile.SqlProfileProvider#3](~/samples/snippets/csharp/VS_Snippets_WebNet/System.Web.Profile.SqlProfileProvider/CS/ShowProfilescs.aspx#3)]
 [!code-aspx-vb[System.Web.Profile.SqlProfileProvider#3](~/samples/snippets/visualbasic/VS_Snippets_WebNet/System.Web.Profile.SqlProfileProvider/VB/ShowProfilesvb.aspx#3)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentException"><paramref name="pageIndex" /> 小于零。  
  
或 
 <paramref name="pageSize" /> 小于一。  
  
- 或 - 
 <paramref name="pageIndex" /> 和 <paramref name="pageSize" /> 的乘积大于 <see cref="F:System.Int32.MaxValue" />。</exception>
        <related type="Article" href="https://msdn.microsoft.com/library/89439440-92ea-48c3-a4bd-dea40307899d">ASP.NET 配置文件属性概述</related>
      </Docs>
    </Member>
    <Member MemberName="GetNumberOfInactiveProfiles">
      <MemberSignature Language="C#" Value="public override int GetNumberOfInactiveProfiles (System.Web.Profile.ProfileAuthenticationOption authenticationOption, DateTime userInactiveSinceDate);" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig virtual instance int32 GetNumberOfInactiveProfiles(valuetype System.Web.Profile.ProfileAuthenticationOption authenticationOption, valuetype System.DateTime userInactiveSinceDate) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Web.Profile.SqlProfileProvider.GetNumberOfInactiveProfiles(System.Web.Profile.ProfileAuthenticationOption,System.DateTime)" />
      <MemberSignature Language="VB.NET" Value="Public Overrides Function GetNumberOfInactiveProfiles (authenticationOption As ProfileAuthenticationOption, userInactiveSinceDate As DateTime) As Integer" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; override int GetNumberOfInactiveProfiles(System::Web::Profile::ProfileAuthenticationOption authenticationOption, DateTime userInactiveSinceDate);" />
      <MemberSignature Language="F#" Value="override this.GetNumberOfInactiveProfiles : System.Web.Profile.ProfileAuthenticationOption * DateTime -&gt; int" Usage="sqlProfileProvider.GetNumberOfInactiveProfiles (authenticationOption, userInactiveSinceDate)" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Web</AssemblyName>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Int32</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="authenticationOption" Type="System.Web.Profile.ProfileAuthenticationOption" />
        <Parameter Name="userInactiveSinceDate" Type="System.DateTime" />
      </Parameters>
      <Docs>
        <param name="authenticationOption"><see cref="T:System.Web.Profile.ProfileAuthenticationOption" /> 值之一，指定是返回匿名配置文件、经过身份验证的配置文件还是同时返回这两种类型的配置文件。</param>
        <param name="userInactiveSinceDate">一个 <see cref="T:System.DateTime" />，确定将哪些用户配置文件视为处于不活动状态。 如果用户配置文件的 <see cref="P:System.Web.Profile.ProfileInfo.LastActivityDate" /> 与此日期和时间相同，或在此日期和时间之前，则此配置文件被视为处于不活动状态。</param>
        <summary>获取数据源中上次活动日期与指定的 <paramref name="userInactiveSinceDate" /> 相同或在其之前的配置文件的数量。</summary>
        <returns>数据源中上次活动日期出现在指定日期和时间之前的配置文件的数量。</returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <xref:System.Web.Profile.SqlProfileProvider.GetNumberOfInactiveProfiles%2A>方法用于从指定的应用程序的数据源检索的所有未使用的用户配置文件计数`applicationName`配置文件中的属性。 使用`authenticationOption`参数来指定是否仅匿名配置文件，仅经过身份验证配置文件或要搜索的所有配置文件。 搜索配置文件中，使用的所有配置文件<xref:System.Web.Profile.ProfileInfo.LastActivityDate%2A>当天或之前指定发生这种情况`userInactiveSinceDate`参数值进行计数。  
  
   
  
## Examples  
 下面的代码示例允许用户查看和删除基于搜索条件的活动和非活动配置文件信息。 使用的结果显示的不活动配置文件计数<xref:System.Web.Profile.SqlProfileProvider.GetNumberOfInactiveProfiles%2A>方法。  
  
 [!code-aspx-csharp[System.Web.Profile.SqlProfileProvider#5](~/samples/snippets/csharp/VS_Snippets_WebNet/System.Web.Profile.SqlProfileProvider/CS/FindProfilesByUserNamecs.aspx#5)]
 [!code-aspx-vb[System.Web.Profile.SqlProfileProvider#5](~/samples/snippets/visualbasic/VS_Snippets_WebNet/System.Web.Profile.SqlProfileProvider/VB/FindProfilesByUserNamevb.aspx#5)]  
  
 ]]></format>
        </remarks>
        <related type="Article" href="https://msdn.microsoft.com/library/89439440-92ea-48c3-a4bd-dea40307899d">ASP.NET 配置文件属性概述</related>
      </Docs>
    </Member>
    <Member MemberName="GetPropertyValues">
      <MemberSignature Language="C#" Value="public override System.Configuration.SettingsPropertyValueCollection GetPropertyValues (System.Configuration.SettingsContext sc, System.Configuration.SettingsPropertyCollection properties);" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig virtual instance class System.Configuration.SettingsPropertyValueCollection GetPropertyValues(class System.Configuration.SettingsContext sc, class System.Configuration.SettingsPropertyCollection properties) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Web.Profile.SqlProfileProvider.GetPropertyValues(System.Configuration.SettingsContext,System.Configuration.SettingsPropertyCollection)" />
      <MemberSignature Language="VB.NET" Value="Public Overrides Function GetPropertyValues (sc As SettingsContext, properties As SettingsPropertyCollection) As SettingsPropertyValueCollection" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; override System::Configuration::SettingsPropertyValueCollection ^ GetPropertyValues(System::Configuration::SettingsContext ^ sc, System::Configuration::SettingsPropertyCollection ^ properties);" />
      <MemberSignature Language="F#" Value="abstract member GetPropertyValues : System.Configuration.SettingsContext * System.Configuration.SettingsPropertyCollection -&gt; System.Configuration.SettingsPropertyValueCollection&#xA;override this.GetPropertyValues : System.Configuration.SettingsContext * System.Configuration.SettingsPropertyCollection -&gt; System.Configuration.SettingsPropertyValueCollection" Usage="sqlProfileProvider.GetPropertyValues (sc, properties)" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Web</AssemblyName>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Configuration.SettingsPropertyValueCollection</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="sc" Type="System.Configuration.SettingsContext" />
        <Parameter Name="properties" Type="System.Configuration.SettingsPropertyCollection" />
      </Parameters>
      <Docs>
        <param name="sc">包含用户配置文件信息的 <see cref="T:System.Configuration.SettingsContext" />。</param>
        <param name="properties">一个 <see cref="T:System.Configuration.SettingsPropertyCollection" />，包含要检索的属性的配置文件信息。</param>
        <summary>从 SQL Server 配置文件数据库检索配置文件属性信息和值。</summary>
        <returns>包含配置文件属性信息和值的 <see cref="T:System.Configuration.SettingsPropertyValueCollection" />。</returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <xref:System.Web.Profile.SqlProfileProvider.GetPropertyValues%2A>方法可供<xref:System.Web.Profile.ProfileBase>类来检索当前请求管理的配置文件属性<xref:System.Web.Profile.SqlProfileProvider>。 从指定的应用程序的数据源返回属性值`applicationName`配置文件中的属性。 作为一系列返回属性值和其他属性信息<xref:System.Configuration.SettingsPropertyValue>对象。  
  
   
  
## Examples  
 下面的代码示例列出了配置文件属性和当前配置文件中标识的值。  
  
 [!code-csharp[System.Web.Profile.SqlProfileProvider#1](~/samples/snippets/csharp/VS_Snippets_WebNet/System.Web.Profile.SqlProfileProvider/CS/getpropertyvaluescs.aspx#1)]
 [!code-vb[System.Web.Profile.SqlProfileProvider#1](~/samples/snippets/visualbasic/VS_Snippets_WebNet/System.Web.Profile.SqlProfileProvider/VB/getpropertyvaluesvb.aspx#1)]  
  
 ]]></format>
        </remarks>
        <related type="Article" href="https://msdn.microsoft.com/library/89439440-92ea-48c3-a4bd-dea40307899d">ASP.NET 配置文件属性概述</related>
      </Docs>
    </Member>
    <Member MemberName="Initialize">
      <MemberSignature Language="C#" Value="public override void Initialize (string name, System.Collections.Specialized.NameValueCollection config);" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig virtual instance void Initialize(string name, class System.Collections.Specialized.NameValueCollection config) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Web.Profile.SqlProfileProvider.Initialize(System.String,System.Collections.Specialized.NameValueCollection)" />
      <MemberSignature Language="VB.NET" Value="Public Overrides Sub Initialize (name As String, config As NameValueCollection)" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; override void Initialize(System::String ^ name, System::Collections::Specialized::NameValueCollection ^ config);" />
      <MemberSignature Language="F#" Value="abstract member Initialize : string * System.Collections.Specialized.NameValueCollection -&gt; unit&#xA;override this.Initialize : string * System.Collections.Specialized.NameValueCollection -&gt; unit" Usage="sqlProfileProvider.Initialize (name, config)" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Web</AssemblyName>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Void</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="name" Type="System.String" />
        <Parameter Name="config" Type="System.Collections.Specialized.NameValueCollection" />
      </Parameters>
      <Docs>
        <param name="name">要初始化的 <see cref="T:System.Web.Profile.SqlProfileProvider" /> 实例的名称。</param>
        <param name="config">一个 <see cref="T:System.Collections.Specialized.NameValueCollection" />，包含配置文件提供程序的配置选项的名称和值。</param>
        <summary>利用在 ASP.NET 应用程序的配置文件中指定的属性值初始化 SQL Server 配置文件提供程序。 此方法不能直接在代码中使用。</summary>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 ASP.NET 使用此方法来初始化<xref:System.Web.Profile.SqlProfileProvider>ASP.NET 应用程序配置文件 (Web.config) 中指定的属性值。 此方法不能直接在代码中使用。  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.Configuration.Provider.ProviderException"><see langword="connectionStringName" /> 特性是一个空字符串 ("")，或者未在此 <see cref="T:System.Web.Profile.SqlProfileProvider" /> 实例的应用程序配置文件中指定。  
  
- 或 - 
在 <see langword="connectionStringName" /> 特性值中指定的连接字符串的值为空，或者指定的 <see langword="connectionStringName" /> 值在此 <see cref="T:System.Web.Profile.SqlProfileProvider" /> 实例的应用程序配置文件中不存在。  
  
- 或 - 
<see langword="applicationName" /> 特性值超过了 256 个字符。  
  
- 或 - 
该 <see cref="T:System.Web.Profile.SqlProfileProvider" /> 实例的应用程序配置文件包含无法识别的特性。</exception>
        <exception cref="T:System.ArgumentNullException"><paramref name="config" /> 为 <see langword="null" />。</exception>
        <exception cref="T:System.Web.HttpException">当前信任级别低于 <see cref="F:System.Web.AspNetHostingPermissionLevel.Low" />。</exception>
        <related type="Article" href="https://msdn.microsoft.com/library/89439440-92ea-48c3-a4bd-dea40307899d">ASP.NET 配置文件属性概述</related>
      </Docs>
    </Member>
    <Member MemberName="SetPropertyValues">
      <MemberSignature Language="C#" Value="public override void SetPropertyValues (System.Configuration.SettingsContext sc, System.Configuration.SettingsPropertyValueCollection properties);" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig virtual instance void SetPropertyValues(class System.Configuration.SettingsContext sc, class System.Configuration.SettingsPropertyValueCollection properties) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Web.Profile.SqlProfileProvider.SetPropertyValues(System.Configuration.SettingsContext,System.Configuration.SettingsPropertyValueCollection)" />
      <MemberSignature Language="VB.NET" Value="Public Overrides Sub SetPropertyValues (sc As SettingsContext, properties As SettingsPropertyValueCollection)" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; override void SetPropertyValues(System::Configuration::SettingsContext ^ sc, System::Configuration::SettingsPropertyValueCollection ^ properties);" />
      <MemberSignature Language="F#" Value="abstract member SetPropertyValues : System.Configuration.SettingsContext * System.Configuration.SettingsPropertyValueCollection -&gt; unit&#xA;override this.SetPropertyValues : System.Configuration.SettingsContext * System.Configuration.SettingsPropertyValueCollection -&gt; unit" Usage="sqlProfileProvider.SetPropertyValues (sc, properties)" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Web</AssemblyName>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Void</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="sc" Type="System.Configuration.SettingsContext" />
        <Parameter Name="properties" Type="System.Configuration.SettingsPropertyValueCollection" />
      </Parameters>
      <Docs>
        <param name="sc">包含用户配置文件信息的 <see cref="T:System.Configuration.SettingsContext" />。</param>
        <param name="properties">一个 <see cref="T:System.Configuration.SettingsPropertyValueCollection" />，包含要更新的属性的配置文件信息和值。</param>
        <summary>利用指定的属性值更新 SQL Server 配置文件数据库。</summary>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <xref:System.Web.Profile.SqlProfileProvider.SetPropertyValues%2A> ASP.NET 配置文件服务使用方法时设置当前请求的属性值更新 SQL Server 配置文件数据库。 在指定的应用程序的数据源设置的属性值`applicationName`配置文件中的属性。 配置文件属性信息和更新的值<xref:System.Web.Profile.SqlProfileProvider>指定为一系列<xref:System.Configuration.SettingsPropertyValue>对象。  
  
   
  
## Examples  
 下面的代码示例使用<xref:System.Web.Profile.SqlProfileProvider.SetPropertyValues%2A>方法来修改配置文件属性值。  
  
 [!code-csharp[System.Web.Profile.SqlProfileProvider#2](~/samples/snippets/csharp/VS_Snippets_WebNet/System.Web.Profile.SqlProfileProvider/CS/setpropertyvaluescs.aspx#2)]
 [!code-vb[System.Web.Profile.SqlProfileProvider#2](~/samples/snippets/visualbasic/VS_Snippets_WebNet/System.Web.Profile.SqlProfileProvider/VB/setpropertyvaluesvb.aspx#2)]  
  
 ]]></format>
        </remarks>
        <related type="Article" href="https://msdn.microsoft.com/library/89439440-92ea-48c3-a4bd-dea40307899d">ASP.NET 配置文件属性概述</related>
      </Docs>
    </Member>
  </Members>
</Type>