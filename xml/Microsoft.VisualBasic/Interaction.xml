<Type Name="Interaction" FullName="Microsoft.VisualBasic.Interaction">
  <Metadata>
    <Meta Name="ms.openlocfilehash" Value="cec0c607fc2b7dd375bd0d2fa79de046945ffe69" />
    <Meta Name="ms.sourcegitcommit" Value="3907f9a5780957d9c85af2e54c0a5bc2a5bf19ab" />
    <Meta Name="ms.translationtype" Value="HT" />
    <Meta Name="ms.contentlocale" Value="zh-CN" />
    <Meta Name="ms.lasthandoff" Value="06/14/2018" />
    <Meta Name="ms.locfileid" Value="34174283" />
  </Metadata>
  <TypeSignature Language="C#" Value="public sealed class Interaction" />
  <TypeSignature Language="ILAsm" Value=".class public auto ansi sealed beforefieldinit Interaction extends System.Object" />
  <TypeSignature Language="DocId" Value="T:Microsoft.VisualBasic.Interaction" />
  <TypeSignature Language="VB.NET" Value="Public Module Interaction" />
  <TypeSignature Language="C++ CLI" Value="public ref class Interaction sealed" />
  <AssemblyInfo>
    <AssemblyName>Microsoft.VisualBasic</AssemblyName>
    <AssemblyVersion>10.0.0.0</AssemblyVersion>
  </AssemblyInfo>
  <Base>
    <BaseTypeName>System.Object</BaseTypeName>
  </Base>
  <Interfaces />
  <Attributes>
    <Attribute>
      <AttributeName>Microsoft.VisualBasic.CompilerServices.StandardModule</AttributeName>
    </Attribute>
  </Attributes>
  <Docs>
    <summary>
      <span data-ttu-id="978c1-101">
        <see langword="Interaction" /> 模块包含用于与对象、应用程序和系统交互的过程。</span>
      <span class="sxs-lookup">
        <span data-stu-id="978c1-101">The <see langword="Interaction" /> module contains procedures used to interact with objects, applications, and systems.</span>
      </span>
    </summary>
    <remarks>
      <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="978c1-102">此模块支持的 Visual Basic 语言关键字和运行其他程序，调用方法或属性，从计算机提示音、 提供命令行字符串、 操作 COM 对象，并控制对话框的运行时库成员。</span><span class="sxs-lookup"><span data-stu-id="978c1-102">This module supports the Visual Basic language keywords and run-time library members that run other programs, call a method or property, sound a beep from the computer, provide a command-line string, manipulate COM objects, and control dialog boxes.</span></span>  
  
   
  
## Examples  
 <span data-ttu-id="978c1-103">下面的示例使用`Shell`要运行由用户指定的应用程序函数。</span><span class="sxs-lookup"><span data-stu-id="978c1-103">The following example uses the `Shell` function to run an application specified by the user.</span></span> <span data-ttu-id="978c1-104">指定<xref:Microsoft.VisualBasic.AppWinStyle.NormalFocus?displayProperty=nameWithType>为第二个自变量在正常大小中打开应用程序，并给予它焦点。</span><span class="sxs-lookup"><span data-stu-id="978c1-104">Specifying <xref:Microsoft.VisualBasic.AppWinStyle.NormalFocus?displayProperty=nameWithType> as the second argument opens the application in normal size and gives it the focus.</span></span>  
  
```vb  
Dim procID As Integer  
' Run calculator.  
procID = Shell("C:\Windows\system32\calc.exe", AppWinStyle.NormalFocus)  
' The preceding path is for Windows XP.  
' The Windows 2000 path is C:\WINNT\system32\calc.exe.  
```  
  
 ]]></format>
    </remarks>
  </Docs>
  <Members>
    <MemberGroup MemberName="AppActivate">
      <AssemblyInfo>
        <AssemblyName>Microsoft.VisualBasic</AssemblyName>
        <AssemblyVersion>10.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Docs>
        <summary>
          <span data-ttu-id="978c1-105">激活已经正在运行的应用程序。</span>
          <span class="sxs-lookup">
            <span data-stu-id="978c1-105">Activates an application that is already running.</span>
          </span>
        </summary>
      </Docs>
    </MemberGroup>
    <Member MemberName="AppActivate">
      <MemberSignature Language="C#" Value="public static void AppActivate (int ProcessId);" />
      <MemberSignature Language="ILAsm" Value=".method public static void AppActivate(int32 ProcessId) cil managed" />
      <MemberSignature Language="DocId" Value="M:Microsoft.VisualBasic.Interaction.AppActivate(System.Int32)" />
      <MemberSignature Language="VB.NET" Value="Public Sub AppActivate (ProcessId As Integer)" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; static void AppActivate(int ProcessId);" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>Microsoft.VisualBasic</AssemblyName>
        <AssemblyVersion>10.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Attributes>
        <Attribute>
          <AttributeName>System.Security.SecuritySafeCritical</AttributeName>
        </Attribute>
      </Attributes>
      <ReturnValue>
        <ReturnType>System.Void</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="ProcessId" Type="System.Int32" />
      </Parameters>
      <Docs>
        <param name="ProcessId">
          <span data-ttu-id="978c1-106">
            <see langword="Integer" />，指定分配给该进程的 Win32 进程 ID 号。</span>
          <span class="sxs-lookup">
            <span data-stu-id="978c1-106">
              <see langword="Integer" /> specifying the Win32 process ID number assigned to this process.</span>
          </span>
          <span data-ttu-id="978c1-107">可以使用 <see cref="M:Microsoft.VisualBasic.Interaction.Shell(System.String,Microsoft.VisualBasic.AppWinStyle,System.Boolean,System.Int32)" /> 返回的 ID，前提是该 ID 不为零。</span>
          <span class="sxs-lookup">
            <span data-stu-id="978c1-107">You can use the ID returned by the <see cref="M:Microsoft.VisualBasic.Interaction.Shell(System.String,Microsoft.VisualBasic.AppWinStyle,System.Boolean,System.Int32)" />, provided it is not zero.</span>
          </span>
        </param>
        <summary>
          <span data-ttu-id="978c1-108">激活已经正在运行的应用程序。</span>
          <span class="sxs-lookup">
            <span data-stu-id="978c1-108">Activates an application that is already running.</span>
          </span>
        </summary>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="978c1-109">你使用`AppActivate`将应用程序的活动窗口引入焦点。</span><span class="sxs-lookup"><span data-stu-id="978c1-109">You use `AppActivate` to bring an application's active window into focus.</span></span> <span data-ttu-id="978c1-110">不可能具有一个句柄或活动窗口时，对的引用，或甚至知道哪个窗口在给定时刻处于活动状态。</span><span class="sxs-lookup"><span data-stu-id="978c1-110">You might not have a handle or a reference to the active window, or even know which window is active at a given moment.</span></span> <span data-ttu-id="978c1-111">在这种情况下，不能使用<xref:System.Windows.Forms.Control.Focus%2A>方法。</span><span class="sxs-lookup"><span data-stu-id="978c1-111">In such a case, you cannot use the <xref:System.Windows.Forms.Control.Focus%2A> method.</span></span>  
  
 <span data-ttu-id="978c1-112">`AppActivate`函数将焦点更改到命名的应用程序或窗口，但不会影响是否它被最大化或最小化。</span><span class="sxs-lookup"><span data-stu-id="978c1-112">The `AppActivate` function changes the focus to the named application or window but does not affect whether it is maximized or minimized.</span></span> <span data-ttu-id="978c1-113">当用户执行某些操作，以将焦点更改或关闭窗口时，焦点移动的激活的应用程序窗口外。</span><span class="sxs-lookup"><span data-stu-id="978c1-113">Focus moves away from the activated application window when the user takes some action to change the focus or close the window.</span></span> <span data-ttu-id="978c1-114">你可以使用`Shell`函数来启动应用程序和设置窗口样式。</span><span class="sxs-lookup"><span data-stu-id="978c1-114">You can use the `Shell` function to start an application and set the window style.</span></span>  
  
 <span data-ttu-id="978c1-115">如果你使用`Title`参数，`AppActivate`使用不区分大小写的比较，但要求的标题栏的内容完全匹配。</span><span class="sxs-lookup"><span data-stu-id="978c1-115">If you use the `Title` parameter, `AppActivate` uses a case-insensitive comparison but otherwise requires an exact match with the contents of the title bar.</span></span> <span data-ttu-id="978c1-116">它首先查找顶级窗口，然后通过子窗口。</span><span class="sxs-lookup"><span data-stu-id="978c1-116">It first looks through the top-level windows and then through the child windows.</span></span> <span data-ttu-id="978c1-117">如果它找不到匹配项，则会引发<xref:System.ArgumentException>。</span><span class="sxs-lookup"><span data-stu-id="978c1-117">If it cannot find a match, it throws an <xref:System.ArgumentException>.</span></span>  
  
 <span data-ttu-id="978c1-118">你可以使用`AppActivate`仅与拥有 windows 的过程。</span><span class="sxs-lookup"><span data-stu-id="978c1-118">You can use `AppActivate` only with processes that own windows.</span></span> <span data-ttu-id="978c1-119">大多数的控制台应用程序都不具有的窗口，这意味着，它们不会出现在列表中处理`AppActivate`搜索。</span><span class="sxs-lookup"><span data-stu-id="978c1-119">Most console applications do not own windows, which means that they do not appear in the list of processes that `AppActivate` searches.</span></span> <span data-ttu-id="978c1-120">从一个控制台应用程序运行时，系统将创建一个单独的进程运行该应用程序，并将输出返回到控制台进程。</span><span class="sxs-lookup"><span data-stu-id="978c1-120">When running from a console application, the system creates a separate process to run the application and returns the output to the console process.</span></span> <span data-ttu-id="978c1-121">因此，当你请求的当前进程 ID，你获得此单独的进程的进程 ID，而不是控制台应用程序的进程 id。</span><span class="sxs-lookup"><span data-stu-id="978c1-121">Consequently, when you request the current process ID, you get the process ID of this separate process, rather than the console application's process ID.</span></span>  
  
 <span data-ttu-id="978c1-122">在运行时，`AppActivate`函数激活任何运行的应用程序具有匹配标题`Title`或进程 id 相匹配`ProcessId`。</span><span class="sxs-lookup"><span data-stu-id="978c1-122">At run time, the `AppActivate` function activates any running application with a title that matches `Title` or with a process ID that matches `ProcessId`.</span></span> <span data-ttu-id="978c1-123">如果没有任何确切匹配项，则会激活任何应用程序，其标题字符串结尾`Title`。</span><span class="sxs-lookup"><span data-stu-id="978c1-123">If there is no exact match, it activates any application whose title string ends with `Title`.</span></span> <span data-ttu-id="978c1-124">如果没有名为的多个应用程序`Title`、`AppActivate`函数随机选择一个用于激活。</span><span class="sxs-lookup"><span data-stu-id="978c1-124">If there is more than one application named `Title`, the `AppActivate` function arbitrarily chooses one to activate.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="978c1-125">`AppActivate`函数需要`UIPermission`在<xref:System.Security.Permissions.UIPermissionWindow.SafeTopLevelWindows>级别，这可能会影响在部分信任情况下其执行。</span><span class="sxs-lookup"><span data-stu-id="978c1-125">The `AppActivate` function requires `UIPermission` at the <xref:System.Security.Permissions.UIPermissionWindow.SafeTopLevelWindows> level, which may affect its execution in partial-trust situations.</span></span> <span data-ttu-id="978c1-126">有关详细信息，请参阅<xref:System.Security.Permissions.UIPermission>。</span><span class="sxs-lookup"><span data-stu-id="978c1-126">For more information, see <xref:System.Security.Permissions.UIPermission> .</span></span>  
  
   
  
## Examples  
 <span data-ttu-id="978c1-127">此示例演示如何的各种用法`AppActivate`函数来激活应用程序窗口。</span><span class="sxs-lookup"><span data-stu-id="978c1-127">This example illustrates various uses of the `AppActivate` function to activate an application window.</span></span> <span data-ttu-id="978c1-128">如果未运行 Notepad 进程，本示例将引发<xref:System.ArgumentException>。</span><span class="sxs-lookup"><span data-stu-id="978c1-128">If a Notepad process is not running, the example throws an <xref:System.ArgumentException>.</span></span> <span data-ttu-id="978c1-129">`Shell`过程假定应用程序都位于指定的路径。</span><span class="sxs-lookup"><span data-stu-id="978c1-129">The `Shell` procedure assumes the applications are in the paths specified.</span></span>  
  
 [!code-vb[VbVbalrCatRef#11](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbalrCatRef/VB/Class1.vb#11)]  
  
 ]]></format>
        </remarks>
        <altmember cref="M:Microsoft.VisualBasic.Interaction.Shell(System.String,Microsoft.VisualBasic.AppWinStyle,System.Boolean,System.Int32)" />
        <altmember cref="M:System.Windows.Forms.Control.Focus" />
        <altmember cref="T:System.ArgumentException" />
      </Docs>
    </Member>
    <Member MemberName="AppActivate">
      <MemberSignature Language="C#" Value="public static void AppActivate (string Title);" />
      <MemberSignature Language="ILAsm" Value=".method public static void AppActivate(string Title) cil managed" />
      <MemberSignature Language="DocId" Value="M:Microsoft.VisualBasic.Interaction.AppActivate(System.String)" />
      <MemberSignature Language="VB.NET" Value="Public Sub AppActivate (Title As String)" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; static void AppActivate(System::String ^ Title);" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>Microsoft.VisualBasic</AssemblyName>
        <AssemblyVersion>10.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Attributes>
        <Attribute>
          <AttributeName>System.Security.SecuritySafeCritical</AttributeName>
        </Attribute>
      </Attributes>
      <ReturnValue>
        <ReturnType>System.Void</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="Title" Type="System.String" />
      </Parameters>
      <Docs>
        <param name="Title">
          <span data-ttu-id="978c1-130">
            <see langword="String" /> 表达式，用于指定要激活的应用程序的标题栏中的标题。</span>
          <span class="sxs-lookup">
            <span data-stu-id="978c1-130">
              <see langword="String" /> expression specifying the title in the title bar of the application you want to activate.</span>
          </span>
          <span data-ttu-id="978c1-131">可以使用启动应用程序后分配给该应用程序的标题。</span>
          <span class="sxs-lookup">
            <span data-stu-id="978c1-131">You can use the title assigned to the application when it was launched.</span>
          </span>
        </param>
        <summary>
          <span data-ttu-id="978c1-132">激活已经正在运行的应用程序。</span>
          <span class="sxs-lookup">
            <span data-stu-id="978c1-132">Activates an application that is already running.</span>
          </span>
        </summary>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="978c1-133">你使用`AppActivate`将应用程序的活动窗口引入焦点。</span><span class="sxs-lookup"><span data-stu-id="978c1-133">You use `AppActivate` to bring an application's active window into focus.</span></span> <span data-ttu-id="978c1-134">不可能具有一个句柄或活动窗口时，对的引用，或甚至知道哪个窗口在给定时刻处于活动状态。</span><span class="sxs-lookup"><span data-stu-id="978c1-134">You might not have a handle or a reference to the active window, or even know which window is active at a given moment.</span></span> <span data-ttu-id="978c1-135">在这种情况下，不能使用<xref:System.Windows.Forms.Control.Focus%2A>方法。</span><span class="sxs-lookup"><span data-stu-id="978c1-135">In such a case, you cannot use the <xref:System.Windows.Forms.Control.Focus%2A> method.</span></span>  
  
 <span data-ttu-id="978c1-136">`AppActivate`函数将焦点更改到命名的应用程序或窗口，但不会影响是否它被最大化或最小化。</span><span class="sxs-lookup"><span data-stu-id="978c1-136">The `AppActivate` function changes the focus to the named application or window but does not affect whether it is maximized or minimized.</span></span> <span data-ttu-id="978c1-137">当用户执行某些操作，以将焦点更改或关闭窗口时，焦点移动的激活的应用程序窗口外。</span><span class="sxs-lookup"><span data-stu-id="978c1-137">Focus moves away from the activated application window when the user takes some action to change the focus or close the window.</span></span> <span data-ttu-id="978c1-138">你可以使用`Shell`函数来启动应用程序和设置窗口样式。</span><span class="sxs-lookup"><span data-stu-id="978c1-138">You can use the `Shell` function to start an application and set the window style.</span></span>  
  
 <span data-ttu-id="978c1-139">如果你使用`Title`参数，`AppActivate`使用不区分大小写的比较，但要求的标题栏的内容完全匹配。</span><span class="sxs-lookup"><span data-stu-id="978c1-139">If you use the `Title` parameter, `AppActivate` uses a case-insensitive comparison but otherwise requires an exact match with the contents of the title bar.</span></span> <span data-ttu-id="978c1-140">它首先查找顶级窗口，然后通过子窗口。</span><span class="sxs-lookup"><span data-stu-id="978c1-140">It first looks through the top-level windows and then through the child windows.</span></span> <span data-ttu-id="978c1-141">如果它找不到匹配项，则会引发<xref:System.ArgumentException>。</span><span class="sxs-lookup"><span data-stu-id="978c1-141">If it cannot find a match, it throws an <xref:System.ArgumentException>.</span></span>  
  
 <span data-ttu-id="978c1-142">你可以使用`AppActivate`仅与拥有 windows 的过程。</span><span class="sxs-lookup"><span data-stu-id="978c1-142">You can use `AppActivate` only with processes that own windows.</span></span> <span data-ttu-id="978c1-143">大多数的控制台应用程序都不具有的窗口，这意味着，它们不会出现在列表中处理`AppActivate`搜索。</span><span class="sxs-lookup"><span data-stu-id="978c1-143">Most console applications do not own windows, which means that they do not appear in the list of processes that `AppActivate` searches.</span></span> <span data-ttu-id="978c1-144">从一个控制台应用程序运行时，系统将创建一个单独的进程运行该应用程序，并将输出返回到控制台进程。</span><span class="sxs-lookup"><span data-stu-id="978c1-144">When running from a console application, the system creates a separate process to run the application and returns the output to the console process.</span></span> <span data-ttu-id="978c1-145">因此，当你请求的当前进程 ID，你获得此单独的进程的进程 ID，而不是控制台应用程序的进程 id。</span><span class="sxs-lookup"><span data-stu-id="978c1-145">Consequently, when you request the current process ID, you get the process ID of this separate process, rather than the console application's process ID.</span></span>  
  
 <span data-ttu-id="978c1-146">在运行时，`AppActivate`函数激活任何运行的应用程序具有匹配标题`Title`或进程 id 相匹配`ProcessId`。</span><span class="sxs-lookup"><span data-stu-id="978c1-146">At run time, the `AppActivate` function activates any running application with a title that matches `Title` or with a process ID that matches `ProcessId`.</span></span> <span data-ttu-id="978c1-147">如果没有任何确切匹配项，则会激活任何应用程序，其标题字符串结尾`Title`。</span><span class="sxs-lookup"><span data-stu-id="978c1-147">If there is no exact match, it activates any application whose title string ends with `Title`.</span></span> <span data-ttu-id="978c1-148">如果没有名为的多个应用程序`Title`、`AppActivate`函数随机选择一个用于激活。</span><span class="sxs-lookup"><span data-stu-id="978c1-148">If there is more than one application named `Title`, the `AppActivate` function arbitrarily chooses one to activate.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="978c1-149">`AppActivate`函数需要`UIPermission`在<xref:System.Security.Permissions.UIPermissionWindow.SafeTopLevelWindows>级别，这可能会影响在部分信任情况下其执行。</span><span class="sxs-lookup"><span data-stu-id="978c1-149">The `AppActivate` function requires `UIPermission` at the <xref:System.Security.Permissions.UIPermissionWindow.SafeTopLevelWindows> level, which may affect its execution in partial-trust situations.</span></span> <span data-ttu-id="978c1-150">有关详细信息，请参阅<xref:System.Security.Permissions.UIPermission>。</span><span class="sxs-lookup"><span data-stu-id="978c1-150">For more information, see <xref:System.Security.Permissions.UIPermission> .</span></span>  
  
   
  
## Examples  
 <span data-ttu-id="978c1-151">此示例演示如何的各种用法`AppActivate`函数来激活应用程序窗口。</span><span class="sxs-lookup"><span data-stu-id="978c1-151">This example illustrates various uses of the `AppActivate` function to activate an application window.</span></span> <span data-ttu-id="978c1-152">如果未运行 Notepad 进程，本示例将引发<xref:System.ArgumentException>。</span><span class="sxs-lookup"><span data-stu-id="978c1-152">If a Notepad process is not running, the example throws an <xref:System.ArgumentException>.</span></span> <span data-ttu-id="978c1-153">`Shell`过程假定应用程序都位于指定的路径。</span><span class="sxs-lookup"><span data-stu-id="978c1-153">The `Shell` procedure assumes the applications are in the paths specified.</span></span>  
  
 [!code-vb[VbVbalrCatRef#11](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbalrCatRef/VB/Class1.vb#11)]  
  
 ]]></format>
        </remarks>
        <altmember cref="M:Microsoft.VisualBasic.Interaction.Shell(System.String,Microsoft.VisualBasic.AppWinStyle,System.Boolean,System.Int32)" />
        <altmember cref="M:System.Windows.Forms.Control.Focus" />
        <altmember cref="T:System.ArgumentException" />
      </Docs>
    </Member>
    <Member MemberName="Beep">
      <MemberSignature Language="C#" Value="public static void Beep ();" />
      <MemberSignature Language="ILAsm" Value=".method public static void Beep() cil managed" />
      <MemberSignature Language="DocId" Value="M:Microsoft.VisualBasic.Interaction.Beep" />
      <MemberSignature Language="VB.NET" Value="Public Sub Beep ()" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; static void Beep();" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>Microsoft.VisualBasic</AssemblyName>
        <AssemblyVersion>10.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Attributes>
        <Attribute>
          <AttributeName>System.Security.SecuritySafeCritical</AttributeName>
        </Attribute>
      </Attributes>
      <ReturnValue>
        <ReturnType>System.Void</ReturnType>
      </ReturnValue>
      <Parameters />
      <Docs>
        <summary>
          <span data-ttu-id="978c1-154">通过计算机扬声器提示音。</span>
          <span class="sxs-lookup">
            <span data-stu-id="978c1-154">Sounds a tone through the computer's speaker.</span>
          </span>
        </summary>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="978c1-155">音调和提示音的持续时间取决于你的硬件和系统软件，因此不同计算机之间。</span><span class="sxs-lookup"><span data-stu-id="978c1-155">The pitch and duration of the beep depend on your hardware and system software and therefore vary among computers.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="978c1-156">`Beep`函数需要`UIPermission`在<xref:System.Security.Permissions.UIPermissionWindow.SafeTopLevelWindows>级别，这可能会影响在部分信任情况下其执行。</span><span class="sxs-lookup"><span data-stu-id="978c1-156">The `Beep` function requires `UIPermission` at the <xref:System.Security.Permissions.UIPermissionWindow.SafeTopLevelWindows> level, which may affect its execution in partial-trust situations.</span></span> <span data-ttu-id="978c1-157">有关详情，请参阅<xref:System.Security.Permissions.UIPermission>。</span><span class="sxs-lookup"><span data-stu-id="978c1-157">For more information, see <xref:System.Security.Permissions.UIPermission>.</span></span>  
  
   
  
## Examples  
 <span data-ttu-id="978c1-158">此示例使用 `Beep` 函数通过计算机的扬声器发出音调。</span><span class="sxs-lookup"><span data-stu-id="978c1-158">This example uses the `Beep` function to sound a tone through the computer's speaker.</span></span>  
  
 [!code-vb[VbVbalrCatRef#59](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbalrCatRef/VB/Class1.vb#59)]  
  
 ]]></format>
        </remarks>
      </Docs>
    </Member>
    <Member MemberName="CallByName">
      <MemberSignature Language="C#" Value="public static object CallByName (object ObjectRef, string ProcName, Microsoft.VisualBasic.CallType UseCallType, params object[] Args);" />
      <MemberSignature Language="ILAsm" Value=".method public static object CallByName(object ObjectRef, string ProcName, valuetype Microsoft.VisualBasic.CallType UseCallType, object[] Args) cil managed" />
      <MemberSignature Language="DocId" Value="M:Microsoft.VisualBasic.Interaction.CallByName(System.Object,System.String,Microsoft.VisualBasic.CallType,System.Object[])" />
      <MemberSignature Language="VB.NET" Value="Public Function CallByName (ObjectRef As Object, ProcName As String, UseCallType As CallType, ParamArray Args As Object()) As Object" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; static System::Object ^ CallByName(System::Object ^ ObjectRef, System::String ^ ProcName, Microsoft::VisualBasic::CallType UseCallType, ... cli::array &lt;System::Object ^&gt; ^ Args);" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>Microsoft.VisualBasic</AssemblyName>
        <AssemblyVersion>10.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Object</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="ObjectRef" Type="System.Object" />
        <Parameter Name="ProcName" Type="System.String" />
        <Parameter Name="UseCallType" Type="Microsoft.VisualBasic.CallType" />
        <Parameter Name="Args" Type="System.Object[]">
          <Attributes>
            <Attribute>
              <AttributeName>System.ParamArray</AttributeName>
            </Attribute>
          </Attributes>
        </Parameter>
      </Parameters>
      <Docs>
        <param name="ObjectRef">
          <span data-ttu-id="978c1-159">必须的。</span>
          <span class="sxs-lookup">
            <span data-stu-id="978c1-159">Required.</span>
          </span>
          <span data-ttu-id="978c1-160">
            <see langword="Object" />。</span>
          <span class="sxs-lookup">
            <span data-stu-id="978c1-160">
              <see langword="Object" />.</span>
          </span>
          <span data-ttu-id="978c1-161">一个指向公开属性或方法的对象的指针。</span>
          <span class="sxs-lookup">
            <span data-stu-id="978c1-161">A pointer to the object exposing the property or method.</span>
          </span>
        </param>
        <param name="ProcName">
          <span data-ttu-id="978c1-162">必须的。</span>
          <span class="sxs-lookup">
            <span data-stu-id="978c1-162">Required.</span>
          </span>
          <span data-ttu-id="978c1-163">
            <see langword="String" />。</span>
          <span class="sxs-lookup">
            <span data-stu-id="978c1-163">
              <see langword="String" />.</span>
          </span>
          <span data-ttu-id="978c1-164">一个字符串表达式，包含对象的属性或方法的名称。</span>
          <span class="sxs-lookup">
            <span data-stu-id="978c1-164">A string expression containing the name of the property or method on the object.</span>
          </span>
        </param>
        <param name="UseCallType">
          <span data-ttu-id="978c1-165">必须的。</span>
          <span class="sxs-lookup">
            <span data-stu-id="978c1-165">Required.</span>
          </span>
          <span data-ttu-id="978c1-166">类型 <see cref="T:Microsoft.VisualBasic.CallType" /> 的一个枚举成员，它表示正在被调用的过程的类型。</span>
          <span class="sxs-lookup">
            <span data-stu-id="978c1-166">An enumeration member of type <see cref="T:Microsoft.VisualBasic.CallType" /> representing the type of procedure being called.</span>
          </span>
          <span data-ttu-id="978c1-167">
            <see langword="CallType" /> 的值可以是 <see langword="Method" />、<see langword="Get" /> 或 <see langword="Set" />。</span>
          <span class="sxs-lookup">
            <span data-stu-id="978c1-167">The value of <see langword="CallType" /> can be <see langword="Method" />, <see langword="Get" />, or <see langword="Set" />.</span>
          </span>
        </param>
        <param name="Args">
          <span data-ttu-id="978c1-168">可选。</span>
          <span class="sxs-lookup">
            <span data-stu-id="978c1-168">Optional.</span>
          </span>
          <span data-ttu-id="978c1-169">
            <see langword="ParamArray" />。</span>
          <span class="sxs-lookup">
            <span data-stu-id="978c1-169">
              <see langword="ParamArray" />.</span>
          </span>
          <span data-ttu-id="978c1-170">一个形参数组，包含要传递给正在调用的属性或方法的实参。</span>
          <span class="sxs-lookup">
            <span data-stu-id="978c1-170">A parameter array containing the arguments to be passed to the property or method being called.</span>
          </span>
        </param>
        <summary>
          <span data-ttu-id="978c1-171">执行对象的方法，或者设置或返回对象的属性。</span>
          <span class="sxs-lookup">
            <span data-stu-id="978c1-171">Executes a method on an object, or sets or returns a property on an object.</span>
          </span>
        </summary>
        <returns>
          <span data-ttu-id="978c1-172">执行对象的方法，或者设置或返回对象的属性。</span>
          <span class="sxs-lookup">
            <span data-stu-id="978c1-172">Executes a method on an object, or sets or returns a property on an object.</span>
          </span>
        </returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="978c1-173">`CallByName`函数用于在运行时获取的属性、 设置属性，或调用方法。</span><span class="sxs-lookup"><span data-stu-id="978c1-173">The `CallByName` function is used at runtime to get a property, set a property, or invoke a method.</span></span>  
  
   
  
## Examples  
 <span data-ttu-id="978c1-174">在下面的示例中，使用第一行`CallByName`设置`Text`属性文本框中的，第二行中检索的值`Text`属性，并且第三个行调用`Move`方法来移动文本框。</span><span class="sxs-lookup"><span data-stu-id="978c1-174">In the following example, the first line uses `CallByName` to set the `Text` property of a text box, the second line retrieves the value of the `Text` property, and the third line invokes the `Move` method to move the text box.</span></span>  
  
 [!code-vb[VbVbalrFunctions#99](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbalrFunctions/VB/Class1.vb#99)]  
  
 [!code-vb[VbVbalrFunctions#20](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbalrFunctions/VB/Class1.vb#20)]  
  
 <span data-ttu-id="978c1-175">下一个示例使用`CallByName`函数以调用`Add`和`Item`集合对象的方法。</span><span class="sxs-lookup"><span data-stu-id="978c1-175">The next example uses the `CallByName` function to invoke the `Add` and `Item` methods of a collection object.</span></span>  
  
 [!code-vb[VbVbalrFunctions#21](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbalrFunctions/VB/Class1.vb#21)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentException">
          <span data-ttu-id="978c1-176">无效 <paramref name="UseCallType" /> 值；必须为 <see langword="Method" />、<see langword="Get" /> 或 <see langword="Set" />。</span>
          <span class="sxs-lookup">
            <span data-stu-id="978c1-176">Invalid <paramref name="UseCallType" /> value; must be <see langword="Method" />, <see langword="Get" />, or <see langword="Set" />.</span>
          </span>
        </exception>
        <altmember cref="T:Microsoft.VisualBasic.CallType" />
        <altmember cref="T:System.ArgumentException" />
      </Docs>
    </Member>
    <Member MemberName="Choose">
      <MemberSignature Language="C#" Value="public static object Choose (double Index, params object[] Choice);" />
      <MemberSignature Language="ILAsm" Value=".method public static object Choose(float64 Index, object[] Choice) cil managed" />
      <MemberSignature Language="DocId" Value="M:Microsoft.VisualBasic.Interaction.Choose(System.Double,System.Object[])" />
      <MemberSignature Language="VB.NET" Value="Public Function Choose (Index As Double, ParamArray Choice As Object()) As Object" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; static System::Object ^ Choose(double Index, ... cli::array &lt;System::Object ^&gt; ^ Choice);" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>Microsoft.VisualBasic</AssemblyName>
        <AssemblyVersion>10.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Object</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="Index" Type="System.Double" />
        <Parameter Name="Choice" Type="System.Object[]">
          <Attributes>
            <Attribute>
              <AttributeName>System.ParamArray</AttributeName>
            </Attribute>
          </Attributes>
        </Parameter>
      </Parameters>
      <Docs>
        <param name="Index">
          <span data-ttu-id="978c1-177">必须的。</span>
          <span class="sxs-lookup">
            <span data-stu-id="978c1-177">Required.</span>
          </span>
          <span data-ttu-id="978c1-178">
            <see langword="Double" />。</span>
          <span class="sxs-lookup">
            <span data-stu-id="978c1-178">
              <see langword="Double" />.</span>
          </span>
          <span data-ttu-id="978c1-179">数值表达式，它得出的值在 1 和 <c>Choice</c> 参数中传递的元素数目之间。</span>
          <span class="sxs-lookup">
            <span data-stu-id="978c1-179">Numeric expression that results in a value between 1 and the number of elements passed in the <c>Choice</c> argument.</span>
          </span>
        </param>
        <param name="Choice">
          <span data-ttu-id="978c1-180">必须的。</span>
          <span class="sxs-lookup">
            <span data-stu-id="978c1-180">Required.</span>
          </span>
          <span data-ttu-id="978c1-181">
            <see langword="Object" /> 参数数组。</span>
          <span class="sxs-lookup">
            <span data-stu-id="978c1-181">
              <see langword="Object" /> parameter array.</span>
          </span>
          <span data-ttu-id="978c1-182">可以为以逗号分隔的 <see langword="Object" /> 变量或表达式列表或一维 <see langword="Object" /> 元素数组提供计算为 <see langword="Object" /> 数据类型的单个变量或表达式。</span>
          <span class="sxs-lookup">
            <span data-stu-id="978c1-182">You can supply either a single variable or an expression that evaluates to the <see langword="Object" /> data type, to a list of <see langword="Object" /> variables or expressions separated by commas, or to a single-dimensional array of <see langword="Object" /> elements.</span>
          </span>
        </param>
        <summary>
          <span data-ttu-id="978c1-183">从参数列表中选择和返回一个值。</span>
          <span class="sxs-lookup">
            <span data-stu-id="978c1-183">Selects and returns a value from a list of arguments.</span>
          </span>
        </summary>
        <returns>
          <span data-ttu-id="978c1-184">从参数列表中选择和返回一个值。</span>
          <span class="sxs-lookup">
            <span data-stu-id="978c1-184">Selects and returns a value from a list of arguments.</span>
          </span>
        </returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="978c1-185">`Choose`函数将返回列表中传递的成员`Choice()`、 基于值的`Index`。</span><span class="sxs-lookup"><span data-stu-id="978c1-185">The `Choose` function returns a member of the list passed in `Choice()`, based on the value of `Index`.</span></span> <span data-ttu-id="978c1-186">选择列表的第一个成员时`Index`为 1。</span><span class="sxs-lookup"><span data-stu-id="978c1-186">The first member of the list is selected when `Index` is 1.</span></span> <span data-ttu-id="978c1-187">选择列表的最后一个成员时`Index`是`UBound`(`Choice()`)。</span><span class="sxs-lookup"><span data-stu-id="978c1-187">The last member of the list is selected when `Index` is `UBound`(`Choice()`).</span></span> <span data-ttu-id="978c1-188">如果`Index`超出这些限制，`Choose`返回`Nothing`。</span><span class="sxs-lookup"><span data-stu-id="978c1-188">If `Index` is outside these limits, `Choose` returns `Nothing`.</span></span>  
  
 <span data-ttu-id="978c1-189">如果`Index`不是整数，它正在评估之前四舍五入为最接近的整数。</span><span class="sxs-lookup"><span data-stu-id="978c1-189">If `Index` is not a whole number, it is rounded to the nearest whole number before being evaluated.</span></span>  
  
 <span data-ttu-id="978c1-190">你可以使用`Choose`以查找可能的匹配项的列表中的值。</span><span class="sxs-lookup"><span data-stu-id="978c1-190">You can use `Choose` to look up a value in a list of possibilities.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="978c1-191">自变量列表中的表达式可以包括函数调用。</span><span class="sxs-lookup"><span data-stu-id="978c1-191">The expressions in the argument list can include function calls.</span></span> <span data-ttu-id="978c1-192">作为准备调用的自变量列表的一部分`Choose`，Visual Basic 编译器在每个表达式中调用每个函数。</span><span class="sxs-lookup"><span data-stu-id="978c1-192">As part of preparing the argument list for the call to `Choose`, the Visual Basic compiler calls every function in every expression.</span></span> <span data-ttu-id="978c1-193">这意味着您不能依赖于特定函数，如果通过选择不同的表达式不调用`Index`。</span><span class="sxs-lookup"><span data-stu-id="978c1-193">This means that you cannot rely on a particular function not being called if a different expression is selected by `Index`.</span></span>  
  
   
  
## Examples  
 <span data-ttu-id="978c1-194">此示例使用`Choose`函数来显示中响应传递给该过程中的索引名称`Ind`参数。</span><span class="sxs-lookup"><span data-stu-id="978c1-194">This example uses the `Choose` function to display a name in response to an index passed into the procedure in the `Ind` parameter.</span></span>  
  
 [!code-vb[VbVbalrFunctions#22](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbalrFunctions/VB/Class1.vb#22)]  
  
 ]]></format>
        </remarks>
        <altmember cref="M:Microsoft.VisualBasic.Interaction.IIf(System.Boolean,System.Object,System.Object)" />
        <altmember cref="M:Microsoft.VisualBasic.Interaction.Switch(System.Object[])" />
      </Docs>
    </Member>
    <Member MemberName="Command">
      <MemberSignature Language="C#" Value="public static string Command ();" />
      <MemberSignature Language="ILAsm" Value=".method public static string Command() cil managed" />
      <MemberSignature Language="DocId" Value="M:Microsoft.VisualBasic.Interaction.Command" />
      <MemberSignature Language="VB.NET" Value="Public Function Command () As String" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; static System::String ^ Command();" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>Microsoft.VisualBasic</AssemblyName>
        <AssemblyVersion>10.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Attributes>
        <Attribute>
          <AttributeName>System.Security.SecuritySafeCritical</AttributeName>
        </Attribute>
      </Attributes>
      <ReturnValue>
        <ReturnType>System.String</ReturnType>
      </ReturnValue>
      <Parameters />
      <Docs>
        <summary>
          <span data-ttu-id="978c1-195">返回命令行的参数部分，该命令行用于启动 Visual Basic 或启动使用 Visual Basic 开发的可执行程序。</span>
          <span class="sxs-lookup">
            <span data-stu-id="978c1-195">Returns the argument portion of the command line used to start Visual Basic or an executable program developed with Visual Basic.</span>
          </span>
          <span data-ttu-id="978c1-196">
            <see langword="My" /> 功能可以提供比 <see langword="Command" /> 函数更高的效率和更好的性能。</span>
          <span class="sxs-lookup">
            <span data-stu-id="978c1-196">The <see langword="My" /> feature provides greater productivity and performance than the <see langword="Command" /> function.</span>
          </span>
          <span data-ttu-id="978c1-197">有关详情，请参阅<see cref="P:Microsoft.VisualBasic.ApplicationServices.ConsoleApplicationBase.CommandLineArgs" />。</span>
          <span class="sxs-lookup">
            <span data-stu-id="978c1-197">For more information, see <see cref="P:Microsoft.VisualBasic.ApplicationServices.ConsoleApplicationBase.CommandLineArgs" />.</span>
          </span>
        </summary>
        <returns>
          <span data-ttu-id="978c1-198">返回命令行的参数部分，该命令行用于启动 Visual Basic 或启动使用 Visual Basic 开发的可执行程序。</span>
          <span class="sxs-lookup">
            <span data-stu-id="978c1-198">Returns the argument portion of the command line used to start Visual Basic or an executable program developed with Visual Basic.</span>
          </span>
          <span data-ttu-id="978c1-199">
            <see langword="My" /> 功能可以提供比 <see langword="Command" /> 函数更高的效率和更好的性能。</span>
          <span class="sxs-lookup">
            <span data-stu-id="978c1-199">The <see langword="My" /> feature provides greater productivity and performance than the <see langword="Command" /> function.</span>
          </span>
          <span data-ttu-id="978c1-200">有关详情，请参阅<see cref="P:Microsoft.VisualBasic.ApplicationServices.ConsoleApplicationBase.CommandLineArgs" />。</span>
          <span class="sxs-lookup">
            <span data-stu-id="978c1-200">For more information, see <see cref="P:Microsoft.VisualBasic.ApplicationServices.ConsoleApplicationBase.CommandLineArgs" />.</span>
          </span>
        </returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="978c1-201">返回自变量后，你可以搜索常用分隔符，例如空格、 向前或向后斜杠、 连字符或引号引起来，拆分或搜索单个参数的字符串。</span><span class="sxs-lookup"><span data-stu-id="978c1-201">After the arguments are returned, you can search for common delimiters, such as spaces, backward or forward slashes, hyphens, or quotation marks, to split or search the string for individual parameters.</span></span>  
  
 <span data-ttu-id="978c1-202">为应用程序使用 Visual Basic 开发和编译为.exe 文件，`Command`函数返回出现在命令行，在此窗体应用程序的名称之后的任何自变量： `MyApp(cmdlineargs)`。</span><span class="sxs-lookup"><span data-stu-id="978c1-202">For applications developed with Visual Basic and compiled to an .exe file, the `Command` function returns any arguments that appear after the name of the application on the command line, in this form: `MyApp(cmdlineargs)`.</span></span>  
  
   
  
## Examples  
 <span data-ttu-id="978c1-203">此示例使用`Command`函数以返回包含数组的对象中的命令行自变量。</span><span class="sxs-lookup"><span data-stu-id="978c1-203">This example uses the `Command` function to return the command-line arguments in an object that contains an array.</span></span>  
  
 [!code-vb[VbVbalrCatRef#58](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbalrCatRef/VB/Class1.vb#58)]  
  
 ]]></format>
        </remarks>
        <altmember cref="M:System.Environment.GetCommandLineArgs" />
        <altmember cref="P:Microsoft.VisualBasic.ApplicationServices.ConsoleApplicationBase.CommandLineArgs" />
      </Docs>
    </Member>
    <Member MemberName="CreateObject">
      <MemberSignature Language="C#" Value="public static object CreateObject (string ProgId, string ServerName = &quot;&quot;);" />
      <MemberSignature Language="ILAsm" Value=".method public static object CreateObject(string ProgId, string ServerName) cil managed" />
      <MemberSignature Language="DocId" Value="M:Microsoft.VisualBasic.Interaction.CreateObject(System.String,System.String)" />
      <MemberSignature Language="VB.NET" Value="Public Function CreateObject (ProgId As String, Optional ServerName As String = &quot;&quot;) As Object" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>Microsoft.VisualBasic</AssemblyName>
        <AssemblyVersion>10.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Attributes>
        <Attribute>
          <AttributeName>System.Security.SecuritySafeCritical</AttributeName>
        </Attribute>
      </Attributes>
      <ReturnValue>
        <ReturnType>System.Object</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="ProgId" Type="System.String" />
        <Parameter Name="ServerName" Type="System.String" />
      </Parameters>
      <Docs>
        <param name="ProgId">
          <span data-ttu-id="978c1-204">必须的。</span>
          <span class="sxs-lookup">
            <span data-stu-id="978c1-204">Required.</span>
          </span>
          <span data-ttu-id="978c1-205">
            <see langword="String" />。</span>
          <span class="sxs-lookup">
            <span data-stu-id="978c1-205">
              <see langword="String" />.</span>
          </span>
          <span data-ttu-id="978c1-206">要创建的对象的程序 ID。</span>
          <span class="sxs-lookup">
            <span data-stu-id="978c1-206">The program ID of the object to create.</span>
          </span>
        </param>
        <param name="ServerName">
          <span data-ttu-id="978c1-207">可选。</span>
          <span class="sxs-lookup">
            <span data-stu-id="978c1-207">Optional.</span>
          </span>
          <span data-ttu-id="978c1-208">
            <see langword="String" />。</span>
          <span class="sxs-lookup">
            <span data-stu-id="978c1-208">
              <see langword="String" />.</span>
          </span>
          <span data-ttu-id="978c1-209">要在其上创建对象的网络服务器的名称。</span>
          <span class="sxs-lookup">
            <span data-stu-id="978c1-209">The name of the network server where the object will be created.</span>
          </span>
          <span data-ttu-id="978c1-210">如果 <c>ServerName</c> 是空字符串 ("")，则使用本地计算机。</span>
          <span class="sxs-lookup">
            <span data-stu-id="978c1-210">If <c>ServerName</c> is an empty string (""), the local computer is used.</span>
          </span>
        </param>
        <summary>
          <span data-ttu-id="978c1-211">创建并返回对 COM 对象的引用。</span>
          <span class="sxs-lookup">
            <span data-stu-id="978c1-211">Creates and returns a reference to a COM object.</span>
          </span>
          <span data-ttu-id="978c1-212">不能在 Visual Basic 中使用 <see langword="CreateObject" /> 创建这些类的实例，除非将类显式公开为 COM 组件。</span>
          <span class="sxs-lookup">
            <span data-stu-id="978c1-212">
              <see langword="CreateObject" /> cannot be used to create instances of classes in Visual Basic unless those classes are explicitly exposed as COM components.</span>
          </span>
        </summary>
        <returns>
          <span data-ttu-id="978c1-213">创建并返回对 COM 对象的引用。</span>
          <span class="sxs-lookup">
            <span data-stu-id="978c1-213">Creates and returns a reference to a COM object.</span>
          </span>
          <span data-ttu-id="978c1-214">不能在 Visual Basic 中使用 <see langword="CreateObject" /> 创建这些类的实例，除非将类显式公开为 COM 组件。</span>
          <span class="sxs-lookup">
            <span data-stu-id="978c1-214">
              <see langword="CreateObject" /> cannot be used to create instances of classes in Visual Basic unless those classes are explicitly exposed as COM components.</span>
          </span>
        </returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="978c1-215">若要创建 COM 组件的实例，请将返回的对象分配`CreateObject`给对象变量：</span><span class="sxs-lookup"><span data-stu-id="978c1-215">To create an instance of a COM component, assign the object returned by `CreateObject` to an object variable:</span></span>  
  
```vb  
Sub CreateADODB()  
   Dim adoApp As Object  
   adoApp = CreateObject("ADODB.Connection")  
End Sub  
```  
  
 <span data-ttu-id="978c1-216">用于存储返回的对象的对象变量的类型可能会影响应用程序的性能。</span><span class="sxs-lookup"><span data-stu-id="978c1-216">The type of object variable you use to store the returned object can affect your application's performance.</span></span> <span data-ttu-id="978c1-217">声明的对象变量`As Object`子句创建一个可以包含对任何类型的对象的引用的变量。</span><span class="sxs-lookup"><span data-stu-id="978c1-217">Declaring an object variable with the `As Object` clause creates a variable that can contain a reference to any type of object.</span></span> <span data-ttu-id="978c1-218">但是，通过该变量的对象访问权限是*后期绑定*，绑定，即在程序运行时发生。</span><span class="sxs-lookup"><span data-stu-id="978c1-218">However, access to the object through that variable is *late-bound*, that is, the binding occurs when your program runs.</span></span> <span data-ttu-id="978c1-219">原因有很多应避免后期绑定，包括应用程序的性能变慢。</span><span class="sxs-lookup"><span data-stu-id="978c1-219">There are many reasons you should avoid late binding, including slower application performance.</span></span>  
  
 <span data-ttu-id="978c1-220">你可以创建导致早期绑定对象变量-即，绑定时将编译该程序。</span><span class="sxs-lookup"><span data-stu-id="978c1-220">You can create an object variable that results in early binding—that is, binding when the program is compiled.</span></span> <span data-ttu-id="978c1-221">为此，请添加对从你的对象的类型库的引用**COM**选项卡**添加引用**对话框中，在**项目**菜单。</span><span class="sxs-lookup"><span data-stu-id="978c1-221">To do so, add a reference to the type library for your object from the **COM** tab of the **Add Reference** dialog box on the **Project** menu.</span></span> <span data-ttu-id="978c1-222">然后，声明你的对象的特定类型的对象变量。</span><span class="sxs-lookup"><span data-stu-id="978c1-222">Then declare the object variable of the specific type of your object.</span></span> <span data-ttu-id="978c1-223">在大多数情况下，它会更加高效使用`Dim`语句和主互操作程序集，以创建对象，它是使用比`CreateObject`函数。</span><span class="sxs-lookup"><span data-stu-id="978c1-223">In most cases, it is more efficient to use the `Dim` statement and a primary interop assembly to create objects than it is to use the `CreateObject` function.</span></span>  
  
## <a name="interacting-with-unmanaged-code"></a><span data-ttu-id="978c1-224">与非托管代码交互</span><span class="sxs-lookup"><span data-stu-id="978c1-224">Interacting with Unmanaged Code</span></span>  
 <span data-ttu-id="978c1-225">另一个问题是 COM 对象使用非托管的代码，而无需公共语言运行时的优势的代码。</span><span class="sxs-lookup"><span data-stu-id="978c1-225">Another issue is that COM objects use unmanaged code — code without the benefit of the common language runtime.</span></span> <span data-ttu-id="978c1-226">有了一定程度的复杂性中会涉及到混合与非托管代码的托管的代码的 Visual Basic 使用从 com。</span><span class="sxs-lookup"><span data-stu-id="978c1-226">There is a fair degree of complexity involved in mixing the managed code of Visual Basic with unmanaged code from COM.</span></span> <span data-ttu-id="978c1-227">在添加对 COM 对象的引用时，Visual Basic 中搜索的主互操作程序集 (PIA) 该库;如果它找到一个，然后，它使用它。</span><span class="sxs-lookup"><span data-stu-id="978c1-227">When you add a reference to a COM object, Visual Basic searches for a primary interop assembly (PIA) for that library; if it finds one, then it uses it.</span></span> <span data-ttu-id="978c1-228">如果找不到 PIA，它创建一个包含本地互操作性类对于 COM 库中的每个类的互操作性程序集。</span><span class="sxs-lookup"><span data-stu-id="978c1-228">If it does not find a PIA, then it creates an interoperability assembly that contains local interoperability classes for each class in the COM library.</span></span> <span data-ttu-id="978c1-229">有关详细信息，请参阅[在.NET Framework 应用程序的 COM 互操作性](~/docs/visual-basic/programming-guide/com-interop/com-interoperability-in-net-framework-applications.md)。</span><span class="sxs-lookup"><span data-stu-id="978c1-229">For more information, see [COM Interoperability in .NET Framework Applications](~/docs/visual-basic/programming-guide/com-interop/com-interoperability-in-net-framework-applications.md).</span></span>  
  
 <span data-ttu-id="978c1-230">通常应使用强绑定的对象和尽可能的主互操作程序集。</span><span class="sxs-lookup"><span data-stu-id="978c1-230">You should generally use strongly bound objects and primary interop assemblies whenever possible.</span></span> <span data-ttu-id="978c1-231">使用下面的示例`CreateObject`演示的 Microsoft Office 对象具有函数仅目的。</span><span class="sxs-lookup"><span data-stu-id="978c1-231">The examples below use the `CreateObject` function with Microsoft Office objects for demonstration purposes only.</span></span> <span data-ttu-id="978c1-232">但是，这些对象是易于使用且更可靠，与相应的主互操作程序集一起使用时。</span><span class="sxs-lookup"><span data-stu-id="978c1-232">However, these objects are easier to use and more reliable when used with the appropriate primary interop assembly.</span></span>  
  
## <a name="creating-an-object-on-a-remote-computer"></a><span data-ttu-id="978c1-233">在远程计算机上创建的对象</span><span class="sxs-lookup"><span data-stu-id="978c1-233">Creating an Object on a Remote Computer</span></span>  
 <span data-ttu-id="978c1-234">通过将传递到计算机的名称，可以在远程网络计算机上创建的对象`ServerName`参数`CreateObject`函数。</span><span class="sxs-lookup"><span data-stu-id="978c1-234">You can create an object on a remote networked computer by passing the name of the computer to the `ServerName` argument of the `CreateObject` function.</span></span> <span data-ttu-id="978c1-235">该名称是相同的共享名称的计算机名称部分： 共享名为"\\\MyServer\Public，" `ServerName` "相同。"</span><span class="sxs-lookup"><span data-stu-id="978c1-235">That name is the same as the Machine Name portion of a share name: for a share named "\\\MyServer\Public," `ServerName` is "MyServer."</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="978c1-236">请参阅 COM 文档 （请参阅 Microsoft Developer Network） 使应用程序可访问远程网络计算机上的其他信息。</span><span class="sxs-lookup"><span data-stu-id="978c1-236">Refer to COM documentation (see Microsoft Developer Network) for additional information on making an application accessible on a remote networked computer.</span></span> <span data-ttu-id="978c1-237">你可能需要添加针对你的应用程序的注册表项。</span><span class="sxs-lookup"><span data-stu-id="978c1-237">You may need to add a registry key for your application.</span></span>  
  
 <span data-ttu-id="978c1-238">下面的代码返回的 Excel 实例的版本号在名为的远程计算机上运行`MyServer`:</span><span class="sxs-lookup"><span data-stu-id="978c1-238">The following code returns the version number of an instance of Excel running on a remote computer named `MyServer`:</span></span>  
  
```vb  
Sub CreateRemoteExcelObj()  
    Dim xlApp As Object  
    ' Replace string "\\MyServer" with name of the remote computer.  
    xlApp = CreateObject("Excel.Application", "\\MyServer")  
    MsgBox(xlApp.Version)  
End Sub  
```  
  
 <span data-ttu-id="978c1-239">如果远程服务器名称不正确，或者如果不可用，则发生运行时错误。</span><span class="sxs-lookup"><span data-stu-id="978c1-239">If the remote server name is incorrect, or if it is unavailable, a run-time error occurs.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="978c1-240">使用`CreateObject`对象的任何当前实例时。</span><span class="sxs-lookup"><span data-stu-id="978c1-240">Use `CreateObject` when there is no current instance of the object.</span></span> <span data-ttu-id="978c1-241">如果尚未运行对象的实例，启动的新实例，并创建指定类型的对象。</span><span class="sxs-lookup"><span data-stu-id="978c1-241">If an instance of the object is already running, a new instance is started, and an object of the specified type is created.</span></span> <span data-ttu-id="978c1-242">若要使用的当前实例，或启动应用程序并将其加载文件，请使用`GetObject`函数。</span><span class="sxs-lookup"><span data-stu-id="978c1-242">To use the current instance, or to start the application and have it load a file, use the `GetObject` function.</span></span> <span data-ttu-id="978c1-243">如果对象已将自己注册为单实例对象，该对象的一个实例创建了，无论多次`CreateObject`执行。</span><span class="sxs-lookup"><span data-stu-id="978c1-243">If an object has registered itself as a single-instance object, only one instance of the object is created, no matter how many times `CreateObject` is executed.</span></span>  
  
## <a name="creating-framework-objects"></a><span data-ttu-id="978c1-244">创建 Framework 对象</span><span class="sxs-lookup"><span data-stu-id="978c1-244">Creating Framework Objects</span></span>  
 <span data-ttu-id="978c1-245">你可以使用`CreateObject`函数只能用于创建 COM 对象。</span><span class="sxs-lookup"><span data-stu-id="978c1-245">You can use the `CreateObject` function only to create a COM object.</span></span> <span data-ttu-id="978c1-246">用于创建.NET Framework 对象，没有确切的等效机制时<xref:System.Activator>中<xref:System>命名空间包含用于创建本地或远程对象的方法。</span><span class="sxs-lookup"><span data-stu-id="978c1-246">While there is no exact equivalent mechanism for creating a .NET Framework object, the <xref:System.Activator> in the <xref:System> namespace contains methods to create local or remote objects.</span></span> <span data-ttu-id="978c1-247">具体而言，<xref:System.Activator.CreateInstance%2A>方法或<xref:System.Activator.CreateInstanceFrom%2A>方法可能会很有用。</span><span class="sxs-lookup"><span data-stu-id="978c1-247">In particular, the <xref:System.Activator.CreateInstance%2A> method or the <xref:System.Activator.CreateInstanceFrom%2A> method might be useful.</span></span>  
  
> [!IMPORTANT]
>  <span data-ttu-id="978c1-248">`CreateObject`函数需要非托管的代码的权限，这可能会影响在部分信任情况下其执行。</span><span class="sxs-lookup"><span data-stu-id="978c1-248">The `CreateObject` function requires unmanaged code permission, which might affect its execution in partial-trust situations.</span></span> <span data-ttu-id="978c1-249">有关详细信息，请参阅<xref:System.Security.Permissions.SecurityPermission>和[代码访问权限](http://msdn.microsoft.com/library/e5ae402f-6dda-4732-bbe8-77296630f675)。</span><span class="sxs-lookup"><span data-stu-id="978c1-249">For more information, see <xref:System.Security.Permissions.SecurityPermission> and [Code Access Permissions](http://msdn.microsoft.com/library/e5ae402f-6dda-4732-bbe8-77296630f675).</span></span>  
  
   
  
## Examples  
 <span data-ttu-id="978c1-250">下面的示例使用`CreateObject`函数来创建 Microsoft Excel 工作表，并将工作表保存到文件。</span><span class="sxs-lookup"><span data-stu-id="978c1-250">The following example uses the `CreateObject` function to create a Microsoft Excel worksheet and saves the worksheet to a file.</span></span> <span data-ttu-id="978c1-251">若要使用此示例，必须在运行此程序的计算机上安装 Excel。</span><span class="sxs-lookup"><span data-stu-id="978c1-251">To use this example, Excel must be installed on the computer where this program runs.</span></span> <span data-ttu-id="978c1-252">此外，你必须添加对从该类型库的引用**COM**选项卡**添加引用**对话框中，在**项目**菜单。</span><span class="sxs-lookup"><span data-stu-id="978c1-252">Also, you must add a reference to the type library from the **COM** tab of the **Add Reference** dialog box on the **Project** menu.</span></span> <span data-ttu-id="978c1-253">类型库的名称根据您的计算机上安装 Excel 的版本而异。</span><span class="sxs-lookup"><span data-stu-id="978c1-253">The name of the type library varies depending on the version of Excel installed on your computer.</span></span> <span data-ttu-id="978c1-254">例如，名为的类型库的 Microsoft Excel 2002 **Microsoft Excel 10.0 对象库**。</span><span class="sxs-lookup"><span data-stu-id="978c1-254">For example, the type library for Microsoft Excel 2002 is named **Microsoft Excel 10.0 Object Library**.</span></span>  
  
 [!code-vb[VbVbalrExcelObject#1](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbalrExcelObject/VB/Class1.vb#1)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.Exception">
          <span data-ttu-id="978c1-255">服务器不可用。</span>
          <span class="sxs-lookup">
            <span data-stu-id="978c1-255">Server is unavailable</span>
          </span>
        </exception>
        <exception cref="T:System.IO.FileNotFoundException">
          <span data-ttu-id="978c1-256">不存在指定类型的对象。</span>
          <span class="sxs-lookup">
            <span data-stu-id="978c1-256">No object of the specified type exists</span>
          </span>
        </exception>
        <altmember cref="M:Microsoft.VisualBasic.Interaction.GetObject(System.String,System.String)" />
        <altmember cref="T:System.Exception" />
        <altmember cref="T:System.IO.FileNotFoundException" />
        <altmember cref="T:System.Activator" />
        <altmember cref="Overload:System.Activator.CreateInstance" />
        <altmember cref="Overload:System.Activator.CreateInstanceFrom" />
      </Docs>
    </Member>
    <Member MemberName="DeleteSetting">
      <MemberSignature Language="C#" Value="public static void DeleteSetting (string AppName, string Section = null, string Key = null);" />
      <MemberSignature Language="ILAsm" Value=".method public static void DeleteSetting(string AppName, string Section, string Key) cil managed" />
      <MemberSignature Language="DocId" Value="M:Microsoft.VisualBasic.Interaction.DeleteSetting(System.String,System.String,System.String)" />
      <MemberSignature Language="VB.NET" Value="Public Sub DeleteSetting (AppName As String, Optional Section As String = null, Optional Key As String = null)" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>Microsoft.VisualBasic</AssemblyName>
        <AssemblyVersion>10.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Void</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="AppName" Type="System.String" />
        <Parameter Name="Section" Type="System.String" />
        <Parameter Name="Key" Type="System.String" />
      </Parameters>
      <Docs>
        <param name="AppName">
          <span data-ttu-id="978c1-257">必须的。</span>
          <span class="sxs-lookup">
            <span data-stu-id="978c1-257">Required.</span>
          </span>
          <span data-ttu-id="978c1-258">
            <see langword="String" /> 表达式，包含应用节或项设置的应用程序或项目的名称。</span>
          <span class="sxs-lookup">
            <span data-stu-id="978c1-258">
              <see langword="String" /> expression containing the name of the application or project to which the section or key setting applies.</span>
          </span>
        </param>
        <param name="Section">
          <span data-ttu-id="978c1-259">必须的。</span>
          <span class="sxs-lookup">
            <span data-stu-id="978c1-259">Required.</span>
          </span>
          <span data-ttu-id="978c1-260">
            <see langword="String" /> 表达式，包含要从中删除项设置的节的名称。</span>
          <span class="sxs-lookup">
            <span data-stu-id="978c1-260">
              <see langword="String" /> expression containing the name of the section from which the key setting is being deleted.</span>
          </span>
          <span data-ttu-id="978c1-261">如果仅提供了 <c>AppName</c> 和 <c>Section</c>，则将删除指定的节以及所有相关的项设置。</span>
          <span class="sxs-lookup">
            <span data-stu-id="978c1-261">If only <c>AppName</c> and <c>Section</c> are provided, the specified section is deleted along with all related key settings.</span>
          </span>
        </param>
        <param name="Key">
          <span data-ttu-id="978c1-262">可选。</span>
          <span class="sxs-lookup">
            <span data-stu-id="978c1-262">Optional.</span>
          </span>
          <span data-ttu-id="978c1-263">
            <see langword="String" /> 表达式，包含要删除的项设置的名称。</span>
          <span class="sxs-lookup">
            <span data-stu-id="978c1-263">
              <see langword="String" /> expression containing the name of the key setting being deleted.</span>
          </span>
        </param>
        <summary>
          <span data-ttu-id="978c1-264">从 Windows 注册表中某个应用程序的项中删除一个节或一个项设置。</span>
          <span class="sxs-lookup">
            <span data-stu-id="978c1-264">Deletes a section or key setting from an application's entry in the Windows registry.</span>
          </span>
          <span data-ttu-id="978c1-265">与 <see langword="DeleteSetting" /> 函数相比，<see langword="My" /> 功能在注册表操作方面可为你提供更高的效率和更好的性能。</span>
          <span class="sxs-lookup">
            <span data-stu-id="978c1-265">The <see langword="My" /> feature gives you greater productivity and performance in registry operations than the <see langword="DeleteSetting" /> function.</span>
          </span>
          <span data-ttu-id="978c1-266">有关详细信息，请参阅<see cref="P:Microsoft.VisualBasic.Devices.ServerComputer.Registry" />。</span>
          <span class="sxs-lookup">
            <span data-stu-id="978c1-266">For more information, see <see cref="P:Microsoft.VisualBasic.Devices.ServerComputer.Registry" /> .</span>
          </span>
        </summary>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="978c1-267">如果提供了所有参数，则删除指定的设置。</span><span class="sxs-lookup"><span data-stu-id="978c1-267">If all arguments are provided, the specified setting is deleted.</span></span> <span data-ttu-id="978c1-268">如果你尝试使用，则会发生运行时错误`DeleteSetting`上不存在的节或键设置。</span><span class="sxs-lookup"><span data-stu-id="978c1-268">A run-time error occurs if you attempt to use `DeleteSetting` on a nonexistent section or key setting.</span></span>  
  
 <span data-ttu-id="978c1-269">`DeleteSetting` 要求在消息由于其下运行，用户登录上`HKEY_LOCAL_USER`注册表项，用户在以交互方式登录之前处于非活动状态。</span><span class="sxs-lookup"><span data-stu-id="978c1-269">`DeleteSetting` requires that a user be logged on since it operates under the `HKEY_LOCAL_USER` registry key, which is not active until a user logs on interactively.</span></span>  
  
 <span data-ttu-id="978c1-270">要从非交互式进程 （如 Mtx.exe) 访问的注册表设置应存储下`HKEY_LOCAL_MACHINE\Software\`或`HKEY_USER\DEFAULT\Software`注册表项。</span><span class="sxs-lookup"><span data-stu-id="978c1-270">Registry settings that are to be accessed from a non-interactive process (such as Mtx.exe) should be stored under either the `HKEY_LOCAL_MACHINE\Software\` or the `HKEY_USER\DEFAULT\Software` registry keys.</span></span>  
  
   
  
## Examples  
 <span data-ttu-id="978c1-271">下面的示例首先使用`SaveSetting`过程使在 Windows 注册表中的条目`MyApp`应用程序，然后使用`DeleteSetting`函数以将它们删除。</span><span class="sxs-lookup"><span data-stu-id="978c1-271">The following example first uses the `SaveSetting` procedure to make entries in the Windows registry for the `MyApp` application, and then uses the `DeleteSetting` function to remove them.</span></span> <span data-ttu-id="978c1-272">因为没有`Key`指定参数时，整个`Startup`部分将被删除，包括的分区名称和所有其密钥。</span><span class="sxs-lookup"><span data-stu-id="978c1-272">Because no `Key` argument is specified, the whole `Startup` section is deleted, including the section name and all of its keys.</span></span>  
  
 [!code-vb[VbVbalrCatRef#45](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbalrCatRef/VB/Class1.vb#45)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentException">
          <span data-ttu-id="978c1-273">用户没有登录。</span>
          <span class="sxs-lookup">
            <span data-stu-id="978c1-273">User is not logged in.</span>
          </span>
        </exception>
        <altmember cref="M:Microsoft.VisualBasic.Interaction.GetAllSettings(System.String,System.String)" />
        <altmember cref="M:Microsoft.VisualBasic.Interaction.GetSetting(System.String,System.String,System.String,System.String)" />
        <altmember cref="M:Microsoft.VisualBasic.Interaction.SaveSetting(System.String,System.String,System.String,System.String)" />
        <altmember cref="T:System.ArgumentException" />
      </Docs>
    </Member>
    <MemberGroup MemberName="Environ">
      <AssemblyInfo>
        <AssemblyName>Microsoft.VisualBasic</AssemblyName>
        <AssemblyVersion>10.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Docs>
        <summary>
          <span data-ttu-id="978c1-274">返回与操作系统环境变量关联的字符串。</span>
          <span class="sxs-lookup">
            <span data-stu-id="978c1-274">Returns the string associated with an operating-system environment variable.</span>
          </span>
        </summary>
      </Docs>
    </MemberGroup>
    <Member MemberName="Environ">
      <MemberSignature Language="C#" Value="public static string Environ (int Expression);" />
      <MemberSignature Language="ILAsm" Value=".method public static string Environ(int32 Expression) cil managed" />
      <MemberSignature Language="DocId" Value="M:Microsoft.VisualBasic.Interaction.Environ(System.Int32)" />
      <MemberSignature Language="VB.NET" Value="Public Function Environ (Expression As Integer) As String" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; static System::String ^ Environ(int Expression);" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>Microsoft.VisualBasic</AssemblyName>
        <AssemblyVersion>10.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Attributes>
        <Attribute>
          <AttributeName>System.Security.SecuritySafeCritical</AttributeName>
        </Attribute>
      </Attributes>
      <ReturnValue>
        <ReturnType>System.String</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="Expression" Type="System.Int32" />
      </Parameters>
      <Docs>
        <param name="Expression">
          <span data-ttu-id="978c1-275">必须的。</span>
          <span class="sxs-lookup">
            <span data-stu-id="978c1-275">Required.</span>
          </span>
          <span data-ttu-id="978c1-276">此表达式用于计算包含环境变量名称的字符串，或对应于环境字符串表中环境字符串的数字顺序的整数。</span>
          <span class="sxs-lookup">
            <span data-stu-id="978c1-276">Expression that evaluates either a string containing the name of an environment variable, or an integer corresponding to the numeric order of an environment string in the environment-string table.</span>
          </span>
        </param>
        <summary>
          <span data-ttu-id="978c1-277">返回与操作系统环境变量关联的字符串。</span>
          <span class="sxs-lookup">
            <span data-stu-id="978c1-277">Returns the string associated with an operating-system environment variable.</span>
          </span>
        </summary>
        <returns>
          <span data-ttu-id="978c1-278">返回与操作系统环境变量关联的字符串。</span>
          <span class="sxs-lookup">
            <span data-stu-id="978c1-278">Returns the string associated with an operating-system environment variable.</span>
          </span>
        </returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="978c1-279">如果`Expression`包含一个字符串，<xref:Microsoft.VisualBasic.Interaction.Environ%2A>函数返回分配给指定的环境字符串的文本-即，后面等号 （=） 该环境变量的环境字符串表中的文本。</span><span class="sxs-lookup"><span data-stu-id="978c1-279">If `Expression` contains a string, the <xref:Microsoft.VisualBasic.Interaction.Environ%2A> function returns the text assigned to the specified environment string—that is, the text following the equal sign (=) in the environment-string table for that environment variable.</span></span> <span data-ttu-id="978c1-280">如果中的字符串`Expression`找不到在环境字符串表中，一个零长度字符串 ("") 返回。</span><span class="sxs-lookup"><span data-stu-id="978c1-280">If the string in `Expression` cannot be found in the environment-string table, a zero-length string ("") is returned.</span></span>  
  
 <span data-ttu-id="978c1-281">如果`Expression`包含一个整数，占用环境字符串表中的数字位置返回的字符串。</span><span class="sxs-lookup"><span data-stu-id="978c1-281">If `Expression` contains an integer, the string occupying that numeric position in the environment-string table is returned.</span></span> <span data-ttu-id="978c1-282">在这种情况下，<xref:Microsoft.VisualBasic.Interaction.Environ%2A>返回所有文本，包括环境变量的名称。</span><span class="sxs-lookup"><span data-stu-id="978c1-282">In this case, <xref:Microsoft.VisualBasic.Interaction.Environ%2A> returns all of the text, including the name of the environment variable.</span></span> <span data-ttu-id="978c1-283">如果在指定的位置中没有任何环境字符串<xref:Microsoft.VisualBasic.Interaction.Environ%2A>返回一个零长度字符串。</span><span class="sxs-lookup"><span data-stu-id="978c1-283">If there is no environment string in the specified position, <xref:Microsoft.VisualBasic.Interaction.Environ%2A> returns a zero-length string.</span></span>  
  
> [!IMPORTANT]
>  <span data-ttu-id="978c1-284"><xref:Microsoft.VisualBasic.Interaction.Environ%2A>函数需要环境权限，这可能会影响在部分信任情况下其执行。</span><span class="sxs-lookup"><span data-stu-id="978c1-284">The <xref:Microsoft.VisualBasic.Interaction.Environ%2A> function requires environment permission, which might affect its execution in partial-trust situations.</span></span> <span data-ttu-id="978c1-285">有关详细信息，请参阅<xref:System.Security.Permissions.SecurityPermission>和[代码访问权限](http://msdn.microsoft.com/library/e5ae402f-6dda-4732-bbe8-77296630f675)。</span><span class="sxs-lookup"><span data-stu-id="978c1-285">For more information, see <xref:System.Security.Permissions.SecurityPermission> and [Code Access Permissions](http://msdn.microsoft.com/library/e5ae402f-6dda-4732-bbe8-77296630f675).</span></span>  
  
   
  
## Examples  
 <span data-ttu-id="978c1-286">此示例使用<xref:Microsoft.VisualBasic.Interaction.Environ%2A>函数提供的项编号和长度`PATH`环境字符串表中的语句。</span><span class="sxs-lookup"><span data-stu-id="978c1-286">This example uses the <xref:Microsoft.VisualBasic.Interaction.Environ%2A> function to supply the entry number and length of the `PATH` statement from the environment-string table.</span></span>  
  
 [!code-vb[VbVbalrCatRef#28](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbalrCatRef/VB/Class1.vb#28)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentException">
          <span data-ttu-id="978c1-287">缺少 <paramref name="Expression" />。</span>
          <span class="sxs-lookup">
            <span data-stu-id="978c1-287">
              <paramref name="Expression" /> is missing.</span>
          </span>
        </exception>
        <altmember cref="T:System.ArgumentException" />
      </Docs>
    </Member>
    <Member MemberName="Environ">
      <MemberSignature Language="C#" Value="public static string Environ (string Expression);" />
      <MemberSignature Language="ILAsm" Value=".method public static string Environ(string Expression) cil managed" />
      <MemberSignature Language="DocId" Value="M:Microsoft.VisualBasic.Interaction.Environ(System.String)" />
      <MemberSignature Language="VB.NET" Value="Public Function Environ (Expression As String) As String" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; static System::String ^ Environ(System::String ^ Expression);" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>Microsoft.VisualBasic</AssemblyName>
        <AssemblyVersion>10.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.String</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="Expression" Type="System.String" />
      </Parameters>
      <Docs>
        <param name="Expression">
          <span data-ttu-id="978c1-288">必须的。</span>
          <span class="sxs-lookup">
            <span data-stu-id="978c1-288">Required.</span>
          </span>
          <span data-ttu-id="978c1-289">此表达式用于计算包含环境变量名称的字符串，或对应于环境字符串表中环境字符串的数字顺序的整数。</span>
          <span class="sxs-lookup">
            <span data-stu-id="978c1-289">Expression that evaluates either a string containing the name of an environment variable, or an integer corresponding to the numeric order of an environment string in the environment-string table.</span>
          </span>
        </param>
        <summary>
          <span data-ttu-id="978c1-290">返回与操作系统环境变量关联的字符串。</span>
          <span class="sxs-lookup">
            <span data-stu-id="978c1-290">Returns the string associated with an operating-system environment variable.</span>
          </span>
        </summary>
        <returns>
          <span data-ttu-id="978c1-291">返回与操作系统环境变量关联的字符串。</span>
          <span class="sxs-lookup">
            <span data-stu-id="978c1-291">Returns the string associated with an operating-system environment variable.</span>
          </span>
        </returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="978c1-292">如果`Expression`包含一个字符串，<xref:Microsoft.VisualBasic.Interaction.Environ%2A>函数返回分配给指定的环境字符串的文本-即，后面等号 （=） 该环境变量的环境字符串表中的文本。</span><span class="sxs-lookup"><span data-stu-id="978c1-292">If `Expression` contains a string, the <xref:Microsoft.VisualBasic.Interaction.Environ%2A> function returns the text assigned to the specified environment string—that is, the text following the equal sign (=) in the environment-string table for that environment variable.</span></span> <span data-ttu-id="978c1-293">如果中的字符串`Expression`找不到在环境字符串表中，一个零长度字符串 ("") 返回。</span><span class="sxs-lookup"><span data-stu-id="978c1-293">If the string in `Expression` cannot be found in the environment-string table, a zero-length string ("") is returned.</span></span>  
  
 <span data-ttu-id="978c1-294">如果`Expression`包含一个整数，占用环境字符串表中的数字位置返回的字符串。</span><span class="sxs-lookup"><span data-stu-id="978c1-294">If `Expression` contains an integer, the string occupying that numeric position in the environment-string table is returned.</span></span> <span data-ttu-id="978c1-295">在这种情况下，<xref:Microsoft.VisualBasic.Interaction.Environ%2A>返回所有文本，包括环境变量的名称。</span><span class="sxs-lookup"><span data-stu-id="978c1-295">In this case, <xref:Microsoft.VisualBasic.Interaction.Environ%2A> returns all of the text, including the name of the environment variable.</span></span> <span data-ttu-id="978c1-296">如果在指定的位置中没有任何环境字符串<xref:Microsoft.VisualBasic.Interaction.Environ%2A>返回一个零长度字符串。</span><span class="sxs-lookup"><span data-stu-id="978c1-296">If there is no environment string in the specified position, <xref:Microsoft.VisualBasic.Interaction.Environ%2A> returns a zero-length string.</span></span>  
  
> [!IMPORTANT]
>  <span data-ttu-id="978c1-297"><xref:Microsoft.VisualBasic.Interaction.Environ%2A>函数需要环境权限，这可能会影响在部分信任情况下其执行。</span><span class="sxs-lookup"><span data-stu-id="978c1-297">The <xref:Microsoft.VisualBasic.Interaction.Environ%2A> function requires environment permission, which might affect its execution in partial-trust situations.</span></span> <span data-ttu-id="978c1-298">有关详细信息，请参阅<xref:System.Security.Permissions.SecurityPermission>和[代码访问权限](http://msdn.microsoft.com/library/e5ae402f-6dda-4732-bbe8-77296630f675)。</span><span class="sxs-lookup"><span data-stu-id="978c1-298">For more information, see <xref:System.Security.Permissions.SecurityPermission> and [Code Access Permissions](http://msdn.microsoft.com/library/e5ae402f-6dda-4732-bbe8-77296630f675).</span></span>  
  
   
  
## Examples  
 <span data-ttu-id="978c1-299">此示例使用<xref:Microsoft.VisualBasic.Interaction.Environ%2A>函数提供的项编号和长度`PATH`环境字符串表中的语句。</span><span class="sxs-lookup"><span data-stu-id="978c1-299">This example uses the <xref:Microsoft.VisualBasic.Interaction.Environ%2A> function to supply the entry number and length of the `PATH` statement from the environment-string table.</span></span>  
  
 [!code-vb[VbVbalrCatRef#28](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbalrCatRef/VB/Class1.vb#28)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentException">
          <span data-ttu-id="978c1-300">缺少 <paramref name="Expression" />。</span>
          <span class="sxs-lookup">
            <span data-stu-id="978c1-300">
              <paramref name="Expression" /> is missing.</span>
          </span>
        </exception>
        <altmember cref="T:System.ArgumentException" />
      </Docs>
    </Member>
    <Member MemberName="GetAllSettings">
      <MemberSignature Language="C#" Value="public static string[,] GetAllSettings (string AppName, string Section);" />
      <MemberSignature Language="ILAsm" Value=".method public static string[,] GetAllSettings(string AppName, string Section) cil managed" />
      <MemberSignature Language="DocId" Value="M:Microsoft.VisualBasic.Interaction.GetAllSettings(System.String,System.String)" />
      <MemberSignature Language="VB.NET" Value="Public Function GetAllSettings (AppName As String, Section As String) As String(,)" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; static cli::array &lt;System::String ^, 2&gt; ^ GetAllSettings(System::String ^ AppName, System::String ^ Section);" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>Microsoft.VisualBasic</AssemblyName>
        <AssemblyVersion>10.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.String[,]</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="AppName" Type="System.String" />
        <Parameter Name="Section" Type="System.String" />
      </Parameters>
      <Docs>
        <param name="AppName">
          <span data-ttu-id="978c1-301">必须的。</span>
          <span class="sxs-lookup">
            <span data-stu-id="978c1-301">Required.</span>
          </span>
          <span data-ttu-id="978c1-302">
            <see langword="String" /> 表达式，包含请求其项设置的应用程序或项目的名称。</span>
          <span class="sxs-lookup">
            <span data-stu-id="978c1-302">
              <see langword="String" /> expression containing the name of the application or project whose key settings are requested.</span>
          </span>
        </param>
        <param name="Section">
          <span data-ttu-id="978c1-303">必须的。</span>
          <span class="sxs-lookup">
            <span data-stu-id="978c1-303">Required.</span>
          </span>
          <span data-ttu-id="978c1-304">一个 <see langword="String" /> 表达式，其中包含请求其关键设置的节的名称。</span>
          <span class="sxs-lookup">
            <span data-stu-id="978c1-304">
              <see langword="String" /> expression containing the name of the section whose key settings are requested.</span>
          </span>
          <span data-ttu-id="978c1-305">
            <see langword="GetAllSettings" /> 返回一个包含二维字符串数组的对象。</span>
          <span class="sxs-lookup">
            <span data-stu-id="978c1-305">
              <see langword="GetAllSettings" /> returns an object that contains a two-dimensional array of strings.</span>
          </span>
          <span data-ttu-id="978c1-306">这些字符串包含指定节中的所有项设置及其相应的值。</span>
          <span class="sxs-lookup">
            <span data-stu-id="978c1-306">The strings contain all the key settings in the specified section, plus their corresponding values.</span>
          </span>
        </param>
        <summary>
          <span data-ttu-id="978c1-307">从 Windows 注册表中某个应用程序的项返回项设置及其各自的值（最初通过 <see langword="SaveSetting" /> 创建）的列表。</span>
          <span class="sxs-lookup">
            <span data-stu-id="978c1-307">Returns a list of key settings and their respective values (originally created with <see langword="SaveSetting" />) from an application's entry in the Windows registry.</span>
          </span>
          <span data-ttu-id="978c1-308">与 <see langword="My" /> 相比，<see langword="GetAllSettings" /> 功能在注册表操作方面可为您提供更高的效率和更好的性能。</span>
          <span class="sxs-lookup">
            <span data-stu-id="978c1-308">Using the <see langword="My" /> feature gives you greater productivity and performance in registry operations than <see langword="GetAllSettings" />.</span>
          </span>
          <span data-ttu-id="978c1-309">有关详情，请参阅<see cref="P:Microsoft.VisualBasic.Devices.ServerComputer.Registry" />。</span>
          <span class="sxs-lookup">
            <span data-stu-id="978c1-309">For more information, see <see cref="P:Microsoft.VisualBasic.Devices.ServerComputer.Registry" />.</span>
          </span>
        </summary>
        <returns>
          <span data-ttu-id="978c1-310">从 Windows 注册表中某个应用程序的项返回项设置及其各自的值（最初通过 <see langword="SaveSetting" /> 创建）的列表。</span>
          <span class="sxs-lookup">
            <span data-stu-id="978c1-310">Returns a list of key settings and their respective values (originally created with <see langword="SaveSetting" />) from an application's entry in the Windows registry.</span>
          </span>
          <span data-ttu-id="978c1-311">与 <see langword="My" /> 相比，<see langword="GetAllSettings" /> 功能在注册表操作方面可为您提供更高的效率和更好的性能。</span>
          <span class="sxs-lookup">
            <span data-stu-id="978c1-311">Using the <see langword="My" /> feature gives you greater productivity and performance in registry operations than <see langword="GetAllSettings" />.</span>
          </span>
          <span data-ttu-id="978c1-312">有关详情，请参阅<see cref="P:Microsoft.VisualBasic.Devices.ServerComputer.Registry" />。</span>
          <span class="sxs-lookup">
            <span data-stu-id="978c1-312">For more information, see <see cref="P:Microsoft.VisualBasic.Devices.ServerComputer.Registry" />.</span>
          </span>
        </returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="978c1-313">`GetAllSettings` 返回未初始化`Object`如果`AppName`或`Section`不存在。</span><span class="sxs-lookup"><span data-stu-id="978c1-313">`GetAllSettings` returns an uninitialized `Object` if either `AppName` or `Section` does not exist.</span></span>  
  
 <span data-ttu-id="978c1-314">因为它将在下操作`HKEY_LOCAL_USER`注册表项，处于不活动状态直到用户以交互方式登录，`GetAllSettings`要求登录用户上。</span><span class="sxs-lookup"><span data-stu-id="978c1-314">Because it operates under the `HKEY_LOCAL_USER` registry key, which is not active until a user logs on interactively, `GetAllSettings` requires that a user be logged on.</span></span>  
  
 <span data-ttu-id="978c1-315">要从非交互式进程 （如 Mtx.exe) 访问的注册表设置应存储下`HKEY_LOCAL_MACHINE\Software\`或`HKEY_USER\DEFAULT\Software`注册表项。</span><span class="sxs-lookup"><span data-stu-id="978c1-315">Registry settings that are to be accessed from a non-interactive process (such as Mtx.exe) should be stored under either the `HKEY_LOCAL_MACHINE\Software\` or the `HKEY_USER\DEFAULT\Software` registry keys.</span></span>  
  
   
  
## Examples  
 <span data-ttu-id="978c1-316">此示例首先使用`SaveSetting`函数使在 Windows 注册表中是否为指定的应用程序中的条目`AppName`，然后使用`GetAllSettings`函数以显示的设置。</span><span class="sxs-lookup"><span data-stu-id="978c1-316">This example first uses the `SaveSetting` function to make entries in the Windows registry for the application specified as `AppName`, then uses the `GetAllSettings` function to display the settings.</span></span> <span data-ttu-id="978c1-317">请注意该应用程序名称和`Section`名称不能使用检索`GetAllSettings`。</span><span class="sxs-lookup"><span data-stu-id="978c1-317">Note that application names and `Section` names cannot be retrieved with `GetAllSettings`.</span></span> <span data-ttu-id="978c1-318">最后，`DeleteSetting`函数中删除应用程序的条目。</span><span class="sxs-lookup"><span data-stu-id="978c1-318">Finally, the `DeleteSetting` function removes the application's entries.</span></span>  
  
 [!code-vb[VbVbalrCatRef#68](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbalrCatRef/VB/Class1.vb#68)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentException">
          <span data-ttu-id="978c1-319">用户没有登录。</span>
          <span class="sxs-lookup">
            <span data-stu-id="978c1-319">User is not logged in.</span>
          </span>
        </exception>
        <altmember cref="M:Microsoft.VisualBasic.Interaction.DeleteSetting(System.String,System.String,System.String)" />
        <altmember cref="M:Microsoft.VisualBasic.Interaction.GetSetting(System.String,System.String,System.String,System.String)" />
        <altmember cref="M:Microsoft.VisualBasic.Interaction.SaveSetting(System.String,System.String,System.String,System.String)" />
        <altmember cref="T:System.ArgumentException" />
      </Docs>
    </Member>
    <Member MemberName="GetObject">
      <MemberSignature Language="C#" Value="public static object GetObject (string PathName = null, string Class = null);" />
      <MemberSignature Language="ILAsm" Value=".method public static object GetObject(string PathName, string Class) cil managed" />
      <MemberSignature Language="DocId" Value="M:Microsoft.VisualBasic.Interaction.GetObject(System.String,System.String)" />
      <MemberSignature Language="VB.NET" Value="Public Function GetObject (Optional PathName As String = null, Optional Class As String = null) As Object" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>Microsoft.VisualBasic</AssemblyName>
        <AssemblyVersion>10.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Attributes>
        <Attribute>
          <AttributeName>System.Security.SecuritySafeCritical</AttributeName>
        </Attribute>
      </Attributes>
      <ReturnValue>
        <ReturnType>System.Object</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="PathName" Type="System.String" />
        <Parameter Name="Class" Type="System.String" />
      </Parameters>
      <Docs>
        <param name="PathName">
          <span data-ttu-id="978c1-320">可选。</span>
          <span class="sxs-lookup">
            <span data-stu-id="978c1-320">Optional.</span>
          </span>
          <span data-ttu-id="978c1-321">
            <see langword="String" />。</span>
          <span class="sxs-lookup">
            <span data-stu-id="978c1-321">
              <see langword="String" />.</span>
          </span>
          <span data-ttu-id="978c1-322">包含要检索的对象的文件的完整路径和名称。</span>
          <span class="sxs-lookup">
            <span data-stu-id="978c1-322">The full path and name of the file containing the object to retrieve.</span>
          </span>
          <span data-ttu-id="978c1-323">如果省略 <c>PathName</c>，则必须有 <c>Class</c>。</span>
          <span class="sxs-lookup">
            <span data-stu-id="978c1-323">If <c>PathName</c> is omitted, <c>Class</c> is required.</span>
          </span>
        </param>
        <param name="Class">
          <span data-ttu-id="978c1-324">如果未提供 <c>PathName</c>，则为必需项。</span>
          <span class="sxs-lookup">
            <span data-stu-id="978c1-324">Required if <c>PathName</c> is not supplied.</span>
          </span>
          <span data-ttu-id="978c1-325">
            <see langword="String" />。</span>
          <span class="sxs-lookup">
            <span data-stu-id="978c1-325">
              <see langword="String" />.</span>
          </span>
          <span data-ttu-id="978c1-326">表示对象的类的字符串。</span>
          <span class="sxs-lookup">
            <span data-stu-id="978c1-326">A string representing the class of the object.</span>
          </span>
          <span data-ttu-id="978c1-327">
            <c>Class</c> 参数具有以下语法和部件：<c>appname</c><c>。</c><c>objecttype</c> [1|1] 参数 [1|2] 描述 [2|1] <c>appname</c> [2|2] 是必需的。</span>
          <span class="sxs-lookup">
            <span data-stu-id="978c1-327">The <c>Class</c> argument has the following syntax and parts:  <c>appname</c><c>.</c><c>objecttype</c>  [1|1] Parameter  [1|2] Description  [2|1] <c>appname</c>  [2|2] Required.</span>
          </span>
          <span data-ttu-id="978c1-328">
            <see langword="String" />。</span>
          <span class="sxs-lookup">
            <span data-stu-id="978c1-328">
              <see langword="String" />.</span>
          </span>
          <span data-ttu-id="978c1-329">提供对象的应用程序的名称。</span>
          <span class="sxs-lookup">
            <span data-stu-id="978c1-329">The name of the application providing the object.</span>
          </span>
          <span data-ttu-id="978c1-330">[3|1] <c>objecttype</c> [3|2] 是必需的。</span>
          <span class="sxs-lookup">
            <span data-stu-id="978c1-330">[3|1] <c>objecttype</c>  [3|2] Required.</span>
          </span>
          <span data-ttu-id="978c1-331">
            <see langword="String" />。</span>
          <span class="sxs-lookup">
            <span data-stu-id="978c1-331">
              <see langword="String" />.</span>
          </span>
          <span data-ttu-id="978c1-332">要创建的对象的类型或类。</span>
          <span class="sxs-lookup">
            <span data-stu-id="978c1-332">The type or class of object to create.</span>
          </span>
        </param>
        <summary>
          <span data-ttu-id="978c1-333">返回对 COM 组件提供的对象的引用。</span>
          <span class="sxs-lookup">
            <span data-stu-id="978c1-333">Returns a reference to an object provided by a COM component.</span>
          </span>
        </summary>
        <returns>
          <span data-ttu-id="978c1-334">返回对 COM 组件提供的对象的引用。</span>
          <span class="sxs-lookup">
            <span data-stu-id="978c1-334">Returns a reference to an object provided by a COM component.</span>
          </span>
        </returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="978c1-335">使用`GetObject`函数以从文件加载 COM 组件的实例。</span><span class="sxs-lookup"><span data-stu-id="978c1-335">Use the `GetObject` function to load an instance of a COM component from a file.</span></span> <span data-ttu-id="978c1-336">下面的示例阐释了这一点。</span><span class="sxs-lookup"><span data-stu-id="978c1-336">The following example illustrates this.</span></span>  
  
```vb  
Dim CADObject As Object  
CADObject = GetObject("C:\CAD\schema.cad")  
```  
  
 <span data-ttu-id="978c1-337">当此代码运行时，使用指定关联的应用程序`PathName`启动和激活指定的文件中的对象。</span><span class="sxs-lookup"><span data-stu-id="978c1-337">When this code runs, the application associated with the specified `PathName` is started and the object in the specified file is activated.</span></span>  
  
## <a name="default-cases"></a><span data-ttu-id="978c1-338">默认情况下</span><span class="sxs-lookup"><span data-stu-id="978c1-338">Default Cases</span></span>  
 <span data-ttu-id="978c1-339">如果`PathName`是零长度字符串 (`""`)，`GetObject`返回指定的类类型的新对象实例。</span><span class="sxs-lookup"><span data-stu-id="978c1-339">If `PathName` is a zero-length string (`""`), `GetObject` returns a new object instance of the specified class type.</span></span> <span data-ttu-id="978c1-340">如果`PathName`省略参数，则`GetObject`返回中指定的类类型的当前处于活动状态对象`Class`。</span><span class="sxs-lookup"><span data-stu-id="978c1-340">If the `PathName` argument is omitted, `GetObject` returns a currently active object of the class type specified in `Class`.</span></span> <span data-ttu-id="978c1-341">如果不存在的对象指定的类型，就会出错。</span><span class="sxs-lookup"><span data-stu-id="978c1-341">If no object of the specified type exists, an error occurs.</span></span>  
  
## <a name="accessing-a-subobject"></a><span data-ttu-id="978c1-342">访问子对象</span><span class="sxs-lookup"><span data-stu-id="978c1-342">Accessing a Subobject</span></span>  
 <span data-ttu-id="978c1-343">某些应用程序，可以激活与文件相关联的子对象。</span><span class="sxs-lookup"><span data-stu-id="978c1-343">Some applications allow you to activate a subobject associated with a file.</span></span> <span data-ttu-id="978c1-344">若要执行此操作，将添加感叹号 (`!`) 到末尾的文件名称并遵循它与一个字符串，标识文件的一部分，你想要激活。</span><span class="sxs-lookup"><span data-stu-id="978c1-344">To do this, add an exclamation point (`!`) to the end of the file name and follow it with a string that identifies the part of the file you want to activate.</span></span> <span data-ttu-id="978c1-345">有关如何创建此字符串的信息，请参阅创建对象的应用程序的文档。</span><span class="sxs-lookup"><span data-stu-id="978c1-345">For information on how to create this string, see the documentation for the application that created the object.</span></span>  
  
 <span data-ttu-id="978c1-346">例如，一个绘图应用程序中可能有存储在文件中的图形的多个层。</span><span class="sxs-lookup"><span data-stu-id="978c1-346">For example, in a drawing application you might have multiple layers to a drawing stored in a file.</span></span> <span data-ttu-id="978c1-347">你可以使用以下代码来激活调用`schema.cad`。</span><span class="sxs-lookup"><span data-stu-id="978c1-347">You could use the following code to activate a layer within a drawing called `schema.cad`.</span></span>  
  
```vb  
layerObject = GetObject("C:\CAD\schema.cad!Layer3")  
```  
  
## <a name="specifying-a-class"></a><span data-ttu-id="978c1-348">指定的类</span><span class="sxs-lookup"><span data-stu-id="978c1-348">Specifying a Class</span></span>  
 <span data-ttu-id="978c1-349">如果不指定对象的`Class`，自动化确定启动和对象的应用程序，若要激活，依据你提供的文件名称。</span><span class="sxs-lookup"><span data-stu-id="978c1-349">If you do not specify the object's `Class`, Automation determines the application to start and the object to activate, based on the file name you provide.</span></span> <span data-ttu-id="978c1-350">但是，某些文件，可以支持多个对象的类。</span><span class="sxs-lookup"><span data-stu-id="978c1-350">Some files, however, can support more than one class of object.</span></span> <span data-ttu-id="978c1-351">例如，绘图可能支持三种不同类型的对象：`Application`对象，`Drawing`对象，和一个`Toolbar`对象，这些全部都是相同的文件的一部分。</span><span class="sxs-lookup"><span data-stu-id="978c1-351">For example, a drawing might support three different types of objects: an `Application` object, a `Drawing` object, and a `Toolbar` object, all of which are part of the same file.</span></span> <span data-ttu-id="978c1-352">若要指定想要激活的对象文件中，使用可选`Class`自变量。</span><span class="sxs-lookup"><span data-stu-id="978c1-352">To specify which object in a file you want to activate, use the optional `Class` argument.</span></span> <span data-ttu-id="978c1-353">下面的示例阐释了这一点。</span><span class="sxs-lookup"><span data-stu-id="978c1-353">The following example illustrates this.</span></span>  
  
```vb  
Dim drawObj As Object  
drawObj = GetObject("C:\Drawings\sample.drw", "Figment.Drawing")  
```  
  
 <span data-ttu-id="978c1-354">在前面的示例中，`Figment`是一个绘图应用程序的名称和`Drawing`是它支持的对象类型之一。</span><span class="sxs-lookup"><span data-stu-id="978c1-354">In the preceding example, `Figment` is the name of a drawing application and `Drawing` is one of the object types it supports.</span></span>  
  
## <a name="using-the-object"></a><span data-ttu-id="978c1-355">使用对象</span><span class="sxs-lookup"><span data-stu-id="978c1-355">Using the Object</span></span>  
 <span data-ttu-id="978c1-356">一旦激活一个对象，你在引用该代码使用对象变量声明。</span><span class="sxs-lookup"><span data-stu-id="978c1-356">Once an object is activated, you refer to it in code using the object variable you declared.</span></span> <span data-ttu-id="978c1-357">在前面的示例中，你可以访问使用对象变量的新对象的属性和方法`drawObj`。</span><span class="sxs-lookup"><span data-stu-id="978c1-357">In the preceding example, you access properties and methods of the new object using the object variable `drawObj`.</span></span> <span data-ttu-id="978c1-358">下面的示例阐释了这一点。</span><span class="sxs-lookup"><span data-stu-id="978c1-358">The following example illustrates this.</span></span>  
  
```vb  
drawObj.Line(9, 90)  
drawObj.InsertText(9, 100, "Hello, world.")  
drawObj.SaveAs("C:\Drawings\sample.drw")  
```  
  
> [!NOTE]
>  <span data-ttu-id="978c1-359">使用`GetObject`函数对象的当前实例时，或如果你想要使用已加载的文件创建对象。</span><span class="sxs-lookup"><span data-stu-id="978c1-359">Use the `GetObject` function when there is a current instance of the object or if you want to create the object with a file loaded.</span></span> <span data-ttu-id="978c1-360">如果没有当前实例，并且您不希望开始使用的对象加载的文件，请使用<xref:Microsoft.VisualBasic.Interaction.CreateObject%2A>函数。</span><span class="sxs-lookup"><span data-stu-id="978c1-360">If there is no current instance, and you do not want the object started with a file loaded, use the <xref:Microsoft.VisualBasic.Interaction.CreateObject%2A> function.</span></span>  
>   
>  <span data-ttu-id="978c1-361">如果对象已将自己注册为 ActiveX 单实例对象，该对象的一个实例创建了，无论多次`CreateObject`调用。</span><span class="sxs-lookup"><span data-stu-id="978c1-361">If an object has registered itself as an ActiveX single-instance object, only one instance of the object is created, no matter how many times `CreateObject` is called.</span></span> <span data-ttu-id="978c1-362">对于单实例对象，`GetObject`始终返回同一个实例调用使用零长度字符串时 (`""`) 语法，并导致的错误，如果`PathName`忽略自变量。</span><span class="sxs-lookup"><span data-stu-id="978c1-362">With a single-instance object, `GetObject` always returns the same instance when called with the zero-length string (`""`) syntax, and it causes an error if the `PathName` argument is omitted.</span></span> <span data-ttu-id="978c1-363">不能使用`GetObject`以获得对使用 Visual Basic 创建的类的引用。</span><span class="sxs-lookup"><span data-stu-id="978c1-363">You cannot use `GetObject` to obtain a reference to a class created with Visual Basic.</span></span>  
  
> [!IMPORTANT]
>  <span data-ttu-id="978c1-364">`GetObject`函数需要非托管的代码的权限，这可能会影响在部分信任情况下其执行。</span><span class="sxs-lookup"><span data-stu-id="978c1-364">The `GetObject` function requires unmanaged code permission, which might affect its execution in partial-trust situations.</span></span> <span data-ttu-id="978c1-365">有关详细信息，请参阅<xref:System.Security.Permissions.SecurityPermission>和[代码访问权限](http://msdn.microsoft.com/library/e5ae402f-6dda-4732-bbe8-77296630f675)。</span><span class="sxs-lookup"><span data-stu-id="978c1-365">For more information, see <xref:System.Security.Permissions.SecurityPermission> and [Code Access Permissions](http://msdn.microsoft.com/library/e5ae402f-6dda-4732-bbe8-77296630f675).</span></span>  
  
   
  
## Examples  
 <span data-ttu-id="978c1-366">下面的示例使用`GetObject`函数来获取对特定的 Microsoft Excel 工作表的引用 (`excelObj`)。</span><span class="sxs-lookup"><span data-stu-id="978c1-366">The following example uses the `GetObject` function to obtain a reference to a specific Microsoft Excel worksheet (`excelObj`).</span></span> <span data-ttu-id="978c1-367">它使用工作表的`Application`属性以使 Excel 可见，以关闭它，并执行其他操作。</span><span class="sxs-lookup"><span data-stu-id="978c1-367">It uses the worksheet's `Application` property to make Excel visible, to close it, and to perform other actions.</span></span> <span data-ttu-id="978c1-368">使用两个 API 调用，`detectExcel`过程查找 Excel 中，并且如果它正在运行，进入它正在运行对象表中。</span><span class="sxs-lookup"><span data-stu-id="978c1-368">Using two API calls, the `detectExcel` procedure looks for Excel, and if it is running, enters it in the Running Object table.</span></span> <span data-ttu-id="978c1-369">首次调用`GetObject`如果 Excel 尚未运行，它在此示例会导致错误会导致`excelWasNotRunning`标志设置为`True`。</span><span class="sxs-lookup"><span data-stu-id="978c1-369">The first call to `GetObject` causes an error if Excel is not already running, which in this example causes the `excelWasNotRunning` flag to be set to `True`.</span></span> <span data-ttu-id="978c1-370">第二次调用`GetObject`指定要打开的文件。</span><span class="sxs-lookup"><span data-stu-id="978c1-370">The second call to `GetObject` specifies a file to open.</span></span> <span data-ttu-id="978c1-371">如果尚未运行 Excel，第二个调用启动外接程序，并返回到指定的文件中，由表示工作表的引用`test.xls`。</span><span class="sxs-lookup"><span data-stu-id="978c1-371">If Excel is not already running, the second call starts it and returns a reference to the worksheet represented by the specified file, `test.xls`.</span></span> <span data-ttu-id="978c1-372">文件必须存在于指定的位置;否则，Visual Basic 将引发<xref:System.IO.FileNotFoundException>。</span><span class="sxs-lookup"><span data-stu-id="978c1-372">The file must exist in the specified location; otherwise, Visual Basic throws a <xref:System.IO.FileNotFoundException>.</span></span> <span data-ttu-id="978c1-373">接下来，示例代码使 Excel 和包含指定的工作表可见的窗口。</span><span class="sxs-lookup"><span data-stu-id="978c1-373">Next, the example code makes both Excel and the window containing the specified worksheet visible.</span></span>  
  
 <span data-ttu-id="978c1-374">此示例需要`Option Strict Off`由于它使用后期绑定，其中对象均分配到类型的变量`Object`。</span><span class="sxs-lookup"><span data-stu-id="978c1-374">This example requires `Option Strict Off` because it uses late binding, where objects are assigned to variables of type `Object`.</span></span> <span data-ttu-id="978c1-375">你可以指定`Option Strict On`声明特定对象类型的对象，如果添加对从 Excel 类型库的引用和**COM**选项卡**添加引用**对话框**项目**Visual Studio 中的菜单。</span><span class="sxs-lookup"><span data-stu-id="978c1-375">You can specify `Option Strict On` and declare objects of specific object types if you add a reference to the Excel type library from the **COM** tab of the **Add Reference** dialog box of the **Project** menu in Visual Studio.</span></span>  
  
 [!code-vb[VbVbalrExcelObject#2](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbalrExcelObject/VB/Class1.vb#2)]  
  
 [!code-vb[VbVbalrExcelObject#4](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbalrExcelObject/VB/Class1.vb#4)]  
  
 [!code-vb[VbVbalrExcelObject#5](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbalrExcelObject/VB/Class1.vb#5)]  
  
 <span data-ttu-id="978c1-376">当调用`getExcel`函数，进行检查以查看是否已运行 Excel。</span><span class="sxs-lookup"><span data-stu-id="978c1-376">When you call the `getExcel` function, a check is made to see if Excel is already running.</span></span> <span data-ttu-id="978c1-377">如果不是这样，然后创建实例。</span><span class="sxs-lookup"><span data-stu-id="978c1-377">If it is not, then an instance is created.</span></span>  
  
> [!IMPORTANT]
>  <span data-ttu-id="978c1-378">为简单起见，前面的示例假定任何窗口调用`XLMAIN`属于 Microsoft Excel 的实例。</span><span class="sxs-lookup"><span data-stu-id="978c1-378">For simplicity, the preceding example assumes that any window called `XLMAIN` belongs to an instance of Microsoft Excel.</span></span> <span data-ttu-id="978c1-379">如果另一个对象，可能通过非法篡改启动具有该名称创建一个窗口，它将接收适用于 Excel 的所有消息。</span><span class="sxs-lookup"><span data-stu-id="978c1-379">If another object, possibly launched by illicit tampering, created a window with that name, it would receive all the messages you intended for Excel.</span></span> <span data-ttu-id="978c1-380">在要用于生产的应用，你应包括一些更严格的测试来验证是否`XLMAIN`实际上属于 Excel。</span><span class="sxs-lookup"><span data-stu-id="978c1-380">In an application to be used for production, you should include some more rigorous testing to verify that `XLMAIN` really belongs to Excel.</span></span>  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.Exception">
          <span data-ttu-id="978c1-381">不存在指定类类型的对象。</span>
          <span class="sxs-lookup">
            <span data-stu-id="978c1-381">No object of the specified class type exists.</span>
          </span>
        </exception>
        <exception cref="T:System.IO.FileNotFoundException">
          <span data-ttu-id="978c1-382">不存在具有指定路径和文件名的对象。</span>
          <span class="sxs-lookup">
            <span data-stu-id="978c1-382">No object with the specified path and file name exists.</span>
          </span>
        </exception>
        <altmember cref="M:Microsoft.VisualBasic.Interaction.CreateObject(System.String,System.String)" />
        <altmember cref="T:System.Exception" />
        <altmember cref="T:System.IO.FileNotFoundException" />
      </Docs>
    </Member>
    <Member MemberName="GetSetting">
      <MemberSignature Language="C#" Value="public static string GetSetting (string AppName, string Section, string Key, string Default = &quot;&quot;);" />
      <MemberSignature Language="ILAsm" Value=".method public static string GetSetting(string AppName, string Section, string Key, string Default) cil managed" />
      <MemberSignature Language="DocId" Value="M:Microsoft.VisualBasic.Interaction.GetSetting(System.String,System.String,System.String,System.String)" />
      <MemberSignature Language="VB.NET" Value="Public Function GetSetting (AppName As String, Section As String, Key As String, Optional Default As String = &quot;&quot;) As String" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>Microsoft.VisualBasic</AssemblyName>
        <AssemblyVersion>10.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.String</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="AppName" Type="System.String" />
        <Parameter Name="Section" Type="System.String" />
        <Parameter Name="Key" Type="System.String" />
        <Parameter Name="Default" Type="System.String" />
      </Parameters>
      <Docs>
        <param name="AppName">
          <span data-ttu-id="978c1-383">必须的。</span>
          <span class="sxs-lookup">
            <span data-stu-id="978c1-383">Required.</span>
          </span>
          <span data-ttu-id="978c1-384">
            <see langword="String" /> 表达式，包含请求其项设置的应用程序或项目的名称。</span>
          <span class="sxs-lookup">
            <span data-stu-id="978c1-384">
              <see langword="String" /> expression containing the name of the application or project whose key setting is requested.</span>
          </span>
        </param>
        <param name="Section">
          <span data-ttu-id="978c1-385">必须的。</span>
          <span class="sxs-lookup">
            <span data-stu-id="978c1-385">Required.</span>
          </span>
          <span data-ttu-id="978c1-386">
            <see langword="String" /> 表达式，包含在其中找到项设置的节的名称。</span>
          <span class="sxs-lookup">
            <span data-stu-id="978c1-386">
              <see langword="String" /> expression containing the name of the section in which the key setting is found.</span>
          </span>
        </param>
        <param name="Key">
          <span data-ttu-id="978c1-387">必须的。</span>
          <span class="sxs-lookup">
            <span data-stu-id="978c1-387">Required.</span>
          </span>
          <span data-ttu-id="978c1-388">
            <see langword="String" /> 表达式，包含要返回的项设置的名称。</span>
          <span class="sxs-lookup">
            <span data-stu-id="978c1-388">
              <see langword="String" /> expression containing the name of the key setting to return.</span>
          </span>
        </param>
        <param name="Default">
          <span data-ttu-id="978c1-389">可选。</span>
          <span class="sxs-lookup">
            <span data-stu-id="978c1-389">Optional.</span>
          </span>
          <span data-ttu-id="978c1-390">包含要返回的值的表达式（如果没有在 <c>Key</c> 设置中设置值）。</span>
          <span class="sxs-lookup">
            <span data-stu-id="978c1-390">Expression containing the value to return if no value is set in the <c>Key</c> setting.</span>
          </span>
          <span data-ttu-id="978c1-391">如果省略，则假定 <c>Default</c> 为零长度字符串 ("")。</span>
          <span class="sxs-lookup">
            <span data-stu-id="978c1-391">If omitted, <c>Default</c> is assumed to be a zero-length string ("").</span>
          </span>
        </param>
        <summary>
          <span data-ttu-id="978c1-392">从 Windows 注册表中应用程序的项返回项设置值。</span>
          <span class="sxs-lookup">
            <span data-stu-id="978c1-392">Returns a key setting value from an application's entry in the Windows registry.</span>
          </span>
          <span data-ttu-id="978c1-393">与 <see langword="My" /> 相比，<see langword="GetAllSettings" /> 功能在注册表操作方面可为您提供更高的效率和更好的性能。</span>
          <span class="sxs-lookup">
            <span data-stu-id="978c1-393">The <see langword="My" /> feature gives you greater productivity and performance in registry operations than <see langword="GetAllSettings" />.</span>
          </span>
          <span data-ttu-id="978c1-394">有关详情，请参阅<see cref="P:Microsoft.VisualBasic.Devices.ServerComputer.Registry" />。</span>
          <span class="sxs-lookup">
            <span data-stu-id="978c1-394">For more information, see <see cref="P:Microsoft.VisualBasic.Devices.ServerComputer.Registry" />.</span>
          </span>
        </summary>
        <returns>
          <span data-ttu-id="978c1-395">从 Windows 注册表中应用程序的项返回项设置值。</span>
          <span class="sxs-lookup">
            <span data-stu-id="978c1-395">Returns a key setting value from an application's entry in the Windows registry.</span>
          </span>
          <span data-ttu-id="978c1-396">与 <see langword="My" /> 相比，<see langword="GetAllSettings" /> 功能在注册表操作方面可为您提供更高的效率和更好的性能。</span>
          <span class="sxs-lookup">
            <span data-stu-id="978c1-396">The <see langword="My" /> feature gives you greater productivity and performance in registry operations than <see langword="GetAllSettings" />.</span>
          </span>
        </returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="978c1-397">如果任一项中名为`GetSetting`自变量不存在，`GetSetting`返回的值`Default`。</span><span class="sxs-lookup"><span data-stu-id="978c1-397">If any of the items named in the `GetSetting` arguments do not exist, `GetSetting` returns a value of `Default`.</span></span>  
  
 <span data-ttu-id="978c1-398">因为它将在下操作`HKEY_LOCAL_USER`注册表项，处于不活动状态直到用户以交互方式登录，`GetSetting`要求登录用户上。</span><span class="sxs-lookup"><span data-stu-id="978c1-398">Because it operates under the `HKEY_LOCAL_USER` registry key, which is not active until a user logs on interactively, `GetSetting` requires that a user be logged on.</span></span>  
  
 <span data-ttu-id="978c1-399">要从非交互式进程 （如 Mtx.exe) 访问的注册表设置应存储下`HKEY_LOCAL_MACHINE\Software\`或`HKEY_USER\DEFAULT\Software`注册表项。</span><span class="sxs-lookup"><span data-stu-id="978c1-399">Registry settings that are to be accessed from a non-interactive process (such as Mtx.exe) should be stored under either the `HKEY_LOCAL_MACHINE\Software\` or the `HKEY_USER\DEFAULT\Software` registry keys.</span></span>  
  
 <span data-ttu-id="978c1-400">`GetSetting` 需要`Read` <xref:System.Security.Permissions.RegistryPermission> 。</span><span class="sxs-lookup"><span data-stu-id="978c1-400">`GetSetting` requires `Read`<xref:System.Security.Permissions.RegistryPermission> .</span></span>  
  
   
  
## Examples  
 <span data-ttu-id="978c1-401">此示例首先使用`SaveSetting`函数使在 Windows 注册表中是否为指定的应用程序中的条目`AppName`，然后使用`GetSetting`函数来显示设置之一。</span><span class="sxs-lookup"><span data-stu-id="978c1-401">This example first uses the `SaveSetting` function to make entries in the Windows registry for the application specified as `AppName`, and then uses the `GetSetting` function to display one of the settings.</span></span> <span data-ttu-id="978c1-402">因为`Default`指定参数时，某些值一定要返回。</span><span class="sxs-lookup"><span data-stu-id="978c1-402">Because the `Default` argument is specified, some value is guaranteed to be returned.</span></span> <span data-ttu-id="978c1-403">请注意，`Section`名称不能使用检索`GetSetting`。</span><span class="sxs-lookup"><span data-stu-id="978c1-403">Notice that `Section` names cannot be retrieved with `GetSetting`.</span></span> <span data-ttu-id="978c1-404">最后，`DeleteSetting`函数中删除应用程序的所有条目。</span><span class="sxs-lookup"><span data-stu-id="978c1-404">Finally, the `DeleteSetting` function removes all the application's entries.</span></span>  
  
 [!code-vb[VbVbalrCatRef#61](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbalrCatRef/VB/Class1.vb#61)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentException">
          <span data-ttu-id="978c1-405">一个或多个参数不是 <see langword="String" /> 表达式，或用户没有登录。</span>
          <span class="sxs-lookup">
            <span data-stu-id="978c1-405">One or more arguments are not <see langword="String" /> expressions, or user is not logged in.</span>
          </span>
        </exception>
        <altmember cref="M:Microsoft.VisualBasic.Interaction.DeleteSetting(System.String,System.String,System.String)" />
        <altmember cref="M:Microsoft.VisualBasic.Interaction.GetAllSettings(System.String,System.String)" />
        <altmember cref="M:Microsoft.VisualBasic.Interaction.SaveSetting(System.String,System.String,System.String,System.String)" />
        <altmember cref="T:System.ArgumentException" />
        <altmember cref="T:System.Security.Permissions.RegistryPermission" />
      </Docs>
    </Member>
    <Member MemberName="IIf">
      <MemberSignature Language="C#" Value="public static object IIf (bool Expression, object TruePart, object FalsePart);" />
      <MemberSignature Language="ILAsm" Value=".method public static object IIf(bool Expression, object TruePart, object FalsePart) cil managed" />
      <MemberSignature Language="DocId" Value="M:Microsoft.VisualBasic.Interaction.IIf(System.Boolean,System.Object,System.Object)" />
      <MemberSignature Language="VB.NET" Value="Public Function IIf (Expression As Boolean, TruePart As Object, FalsePart As Object) As Object" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; static System::Object ^ IIf(bool Expression, System::Object ^ TruePart, System::Object ^ FalsePart);" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>Microsoft.VisualBasic</AssemblyName>
        <AssemblyVersion>10.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Object</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="Expression" Type="System.Boolean" />
        <Parameter Name="TruePart" Type="System.Object" />
        <Parameter Name="FalsePart" Type="System.Object" />
      </Parameters>
      <Docs>
        <param name="Expression">
          <span data-ttu-id="978c1-406">必须的。</span>
          <span class="sxs-lookup">
            <span data-stu-id="978c1-406">Required.</span>
          </span>
          <span data-ttu-id="978c1-407">
            <see langword="Boolean" />。</span>
          <span class="sxs-lookup">
            <span data-stu-id="978c1-407">
              <see langword="Boolean" />.</span>
          </span>
          <span data-ttu-id="978c1-408">要计算的表达式。</span>
          <span class="sxs-lookup">
            <span data-stu-id="978c1-408">The expression you want to evaluate.</span>
          </span>
        </param>
        <param name="TruePart">
          <span data-ttu-id="978c1-409">必须的。</span>
          <span class="sxs-lookup">
            <span data-stu-id="978c1-409">Required.</span>
          </span>
          <span data-ttu-id="978c1-410">
            <see langword="Object" />。</span>
          <span class="sxs-lookup">
            <span data-stu-id="978c1-410">
              <see langword="Object" />.</span>
          </span>
          <span data-ttu-id="978c1-411">如果 <c>Expression</c> 的计算结果为 <see langword="True" />，则返回。</span>
          <span class="sxs-lookup">
            <span data-stu-id="978c1-411">Returned if <c>Expression</c> evaluates to <see langword="True" />.</span>
          </span>
        </param>
        <param name="FalsePart">
          <span data-ttu-id="978c1-412">必须的。</span>
          <span class="sxs-lookup">
            <span data-stu-id="978c1-412">Required.</span>
          </span>
          <span data-ttu-id="978c1-413">
            <see langword="Object" />。</span>
          <span class="sxs-lookup">
            <span data-stu-id="978c1-413">
              <see langword="Object" />.</span>
          </span>
          <span data-ttu-id="978c1-414">如果 <c>Expression</c> 的计算结果为 <see langword="False" />，则返回。</span>
          <span class="sxs-lookup">
            <span data-stu-id="978c1-414">Returned if <c>Expression</c> evaluates to <see langword="False" />.</span>
          </span>
        </param>
        <summary>
          <span data-ttu-id="978c1-415">根据表达式的计算，返回两个对象中的一个。</span>
          <span class="sxs-lookup">
            <span data-stu-id="978c1-415">Returns one of two objects, depending on the evaluation of an expression.</span>
          </span>
        </summary>
        <returns>
          <span data-ttu-id="978c1-416">根据表达式的计算，返回两个对象中的一个。</span>
          <span class="sxs-lookup">
            <span data-stu-id="978c1-416">Returns one of two objects, depending on the evaluation of an expression.</span>
          </span>
        </returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="978c1-417">`IIf`函数提供了三元存在对应[条件运算符:？:](http://msdn.microsoft.com/library/88643ee8-7100-4f86-880a-705ec22b6271) Visual c + +。</span><span class="sxs-lookup"><span data-stu-id="978c1-417">The `IIf` function provides a counterpart for the ternary [Conditional Operator: ? :](http://msdn.microsoft.com/library/88643ee8-7100-4f86-880a-705ec22b6271) in Visual C++.</span></span>  
  
   
  
## Examples  
 <span data-ttu-id="978c1-418">此示例使用`IIf`函数来评估`testMe`参数`checkIt`过程并返回 word"大型"如果量为大于 1000年; 否则，它将返回单词"小"。</span><span class="sxs-lookup"><span data-stu-id="978c1-418">This example uses the `IIf` function to evaluate the `testMe` parameter of the `checkIt` procedure and returns the word "Large" if the amount is greater than 1000; otherwise, it returns the word "Small".</span></span>  
  
 [!code-vb[VbVbalrFunctions#33](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbalrFunctions/VB/Class1.vb#33)]  
  
 <span data-ttu-id="978c1-419">请注意，如果`Option Strict`是`On`，必须使用`CStr`关键字可以显式转换从返回`Object`到`String`。</span><span class="sxs-lookup"><span data-stu-id="978c1-419">Note that if `Option Strict` is `On`, you must use the `CStr` keyword to explicitly convert the return from `Object` to `String`.</span></span>  
  
 ]]></format>
        </remarks>
        <altmember cref="M:Microsoft.VisualBasic.Interaction.Choose(System.Double,System.Object[])" />
        <altmember cref="M:Microsoft.VisualBasic.Interaction.Switch(System.Object[])" />
      </Docs>
    </Member>
    <Member MemberName="InputBox">
      <MemberSignature Language="C#" Value="public static string InputBox (string Prompt, string Title = &quot;&quot;, string DefaultResponse = &quot;&quot;, int XPos = -1, int YPos = -1);" />
      <MemberSignature Language="ILAsm" Value=".method public static string InputBox(string Prompt, string Title, string DefaultResponse, int32 XPos, int32 YPos) cil managed" />
      <MemberSignature Language="DocId" Value="M:Microsoft.VisualBasic.Interaction.InputBox(System.String,System.String,System.String,System.Int32,System.Int32)" />
      <MemberSignature Language="VB.NET" Value="Public Function InputBox (Prompt As String, Optional Title As String = &quot;&quot;, Optional DefaultResponse As String = &quot;&quot;, Optional XPos As Integer = -1, Optional YPos As Integer = -1) As String" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>Microsoft.VisualBasic</AssemblyName>
        <AssemblyVersion>10.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.String</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="Prompt" Type="System.String" />
        <Parameter Name="Title" Type="System.String" />
        <Parameter Name="DefaultResponse" Type="System.String" />
        <Parameter Name="XPos" Type="System.Int32" />
        <Parameter Name="YPos" Type="System.Int32" />
      </Parameters>
      <Docs>
        <param name="Prompt">
          <span data-ttu-id="978c1-420">必选的 <see langword="String" /> 表达式，作为消息显示在对话框中。</span>
          <span class="sxs-lookup">
            <span data-stu-id="978c1-420">Required <see langword="String" /> expression displayed as the message in the dialog box.</span>
          </span>
          <span data-ttu-id="978c1-421">
            <c>Prompt</c> 的最大长度大约为 1024 个字符，具体取决于所用字符的宽度。</span>
          <span class="sxs-lookup">
            <span data-stu-id="978c1-421">The maximum length of <c>Prompt</c> is approximately 1024 characters, depending on the width of the characters used.</span>
          </span>
          <span data-ttu-id="978c1-422">如果 <c>Prompt</c> 包含多行，可以使用回车符 (<see langword="Chr(" />13<see langword=")" />) 或换行符 (<see langword="Chr(" />10<see langword=")" />)，或组合使用回车符/换行符 (<see langword="Chr(" />13<see langword=")" /> &amp; <see langword="Chr(" />10<see langword=")" />) 来分隔每行。</span>
          <span class="sxs-lookup">
            <span data-stu-id="978c1-422">If <c>Prompt</c> consists of more than one line, you can separate the lines using a carriage return character (<see langword="Chr(" />13<see langword=")" />), a line feed character (<see langword="Chr(" />10<see langword=")" />), or a carriage return/line feed combination (<see langword="Chr(" />13<see langword=")" /> &amp; <see langword="Chr(" />10<see langword=")" />) between each line.</span>
          </span>
        </param>
        <param name="Title">
          <span data-ttu-id="978c1-423">可选。</span>
          <span class="sxs-lookup">
            <span data-stu-id="978c1-423">Optional.</span>
          </span>
          <span data-ttu-id="978c1-424">显示在对话框标题栏中的 <see langword="String" /> 表达式。</span>
          <span class="sxs-lookup">
            <span data-stu-id="978c1-424">
              <see langword="String" /> expression displayed in the title bar of the dialog box.</span>
          </span>
          <span data-ttu-id="978c1-425">如果省略 <c>Title</c>，则标题栏中显示应用程序名称。</span>
          <span class="sxs-lookup">
            <span data-stu-id="978c1-425">If you omit <c>Title</c>, the application name is placed in the title bar.</span>
          </span>
        </param>
        <param name="DefaultResponse">
          <span data-ttu-id="978c1-426">可选。</span>
          <span class="sxs-lookup">
            <span data-stu-id="978c1-426">Optional.</span>
          </span>
          <span data-ttu-id="978c1-427">
            <see langword="String" /> 表达式。如果未提供其他输入，则作为默认响应显示在文本框中。</span>
          <span class="sxs-lookup">
            <span data-stu-id="978c1-427">
              <see langword="String" /> expression displayed in the text box as the default response if no other input is provided.</span>
          </span>
          <span data-ttu-id="978c1-428">如果省略 <c>DefaultResponse</c>，则显示的文本框为空。</span>
          <span class="sxs-lookup">
            <span data-stu-id="978c1-428">If you omit <c>DefaultResponse</c>, the displayed text box is empty.</span>
          </span>
        </param>
        <param name="XPos">
          <span data-ttu-id="978c1-429">可选。</span>
          <span class="sxs-lookup">
            <span data-stu-id="978c1-429">Optional.</span>
          </span>
          <span data-ttu-id="978c1-430">数值表达式，指定屏幕左边缘与对话框左边缘之间的距离（以缇为单位）。</span>
          <span class="sxs-lookup">
            <span data-stu-id="978c1-430">Numeric expression that specifies, in twips, the distance of the left edge of the dialog box from the left edge of the screen.</span>
          </span>
          <span data-ttu-id="978c1-431">如果省略 <c>XPos</c>，则对话框水平居中。</span>
          <span class="sxs-lookup">
            <span data-stu-id="978c1-431">If you omit <c>XPos</c>, the dialog box is centered horizontally.</span>
          </span>
        </param>
        <param name="YPos">
          <span data-ttu-id="978c1-432">可选。</span>
          <span class="sxs-lookup">
            <span data-stu-id="978c1-432">Optional.</span>
          </span>
          <span data-ttu-id="978c1-433">数值表达式，指定屏幕顶部与对话框上边缘之间的距离（以缇为单位）。</span>
          <span class="sxs-lookup">
            <span data-stu-id="978c1-433">Numeric expression that specifies, in twips, the distance of the upper edge of the dialog box from the top of the screen.</span>
          </span>
          <span data-ttu-id="978c1-434">如果省略 <c>YPos</c>，则对话框垂直定位在屏幕向下大约三分之一处。</span>
          <span class="sxs-lookup">
            <span data-stu-id="978c1-434">If you omit <c>YPos</c>, the dialog box is positioned vertically approximately one-third of the way down the screen.</span>
          </span>
        </param>
        <summary>
          <span data-ttu-id="978c1-435">在对话框中显示提示，等待用户输入文本或单击按钮，然后返回包含文本框内容的字符串。</span>
          <span class="sxs-lookup">
            <span data-stu-id="978c1-435">Displays a prompt in a dialog box, waits for the user to input text or click a button, and then returns a string containing the contents of the text box.</span>
          </span>
        </summary>
        <returns>
          <span data-ttu-id="978c1-436">在对话框中显示提示，等待用户输入文本或单击按钮，然后返回包含文本框内容的字符串。</span>
          <span class="sxs-lookup">
            <span data-stu-id="978c1-436">Displays a prompt in a dialog box, waits for the user to input text or click a button, and then returns a string containing the contents of the text box.</span>
          </span>
        </returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="978c1-437">如果用户单击**取消**，则返回一个零长度字符串。</span><span class="sxs-lookup"><span data-stu-id="978c1-437">If the user clicks **Cancel**, a zero-length string is returned.</span></span>  
  
 <span data-ttu-id="978c1-438">若要指定多个第一个参数，必须使用`InputBox`在表达式中的函数。</span><span class="sxs-lookup"><span data-stu-id="978c1-438">To specify more than the first argument, you must use the `InputBox` function in an expression.</span></span> <span data-ttu-id="978c1-439">如果省略任何位置的自变量，你必须保留相应的逗号分隔符。</span><span class="sxs-lookup"><span data-stu-id="978c1-439">If you omit any positional arguments, you must retain the corresponding comma delimiter.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="978c1-440">`InputBox`函数需要`UIPermission`在<xref:System.Security.Permissions.UIPermissionWindow.SafeTopLevelWindows>级别，这可能会影响在部分信任情况下其执行。</span><span class="sxs-lookup"><span data-stu-id="978c1-440">The `InputBox` function requires `UIPermission` at the <xref:System.Security.Permissions.UIPermissionWindow.SafeTopLevelWindows> level, which may affect its execution in partial-trust situations.</span></span> <span data-ttu-id="978c1-441">有关详细信息，请参阅和<xref:System.Security.Permissions.UIPermission>。</span><span class="sxs-lookup"><span data-stu-id="978c1-441">For more information, see  and <xref:System.Security.Permissions.UIPermission> .</span></span>  
  
   
  
## Examples  
 <span data-ttu-id="978c1-442">此示例演示使用各种方式`InputBox`函数来提示用户输入的值。</span><span class="sxs-lookup"><span data-stu-id="978c1-442">This example shows various ways to use the `InputBox` function to prompt the user to enter a value.</span></span> <span data-ttu-id="978c1-443">如果 x 和 y 位置省略，则对话框自动居中在相应轴。</span><span class="sxs-lookup"><span data-stu-id="978c1-443">If the x and y positions are omitted, the dialog box is automatically centered for the respective axes.</span></span> <span data-ttu-id="978c1-444">变量`MyValue`包含由用户输入，如果用户单击确定或按 ENTER 键的值。</span><span class="sxs-lookup"><span data-stu-id="978c1-444">The variable `MyValue` contains the value entered by the user if the user clicks OK or presses the ENTER key.</span></span>  
  
 [!code-vb[VbVbalrCatRef#67](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbalrCatRef/VB/Class1.vb#67)]  
  
 ]]></format>
        </remarks>
        <altmember cref="M:Microsoft.VisualBasic.Interaction.MsgBox(System.Object,Microsoft.VisualBasic.MsgBoxStyle,System.Object)" />
        <altmember cref="M:Microsoft.VisualBasic.Strings.Chr(System.Int32)" />
        <altmember cref="M:Microsoft.VisualBasic.Strings.ChrW(System.Int32)" />
      </Docs>
    </Member>
    <Member MemberName="MsgBox">
      <MemberSignature Language="C#" Value="public static Microsoft.VisualBasic.MsgBoxResult MsgBox (object Prompt, Microsoft.VisualBasic.MsgBoxStyle Buttons = Microsoft.VisualBasic.MsgBoxStyle.ApplicationModal, object Title = null);" />
      <MemberSignature Language="ILAsm" Value=".method public static valuetype Microsoft.VisualBasic.MsgBoxResult MsgBox(object Prompt, valuetype Microsoft.VisualBasic.MsgBoxStyle Buttons, object Title) cil managed" />
      <MemberSignature Language="DocId" Value="M:Microsoft.VisualBasic.Interaction.MsgBox(System.Object,Microsoft.VisualBasic.MsgBoxStyle,System.Object)" />
      <MemberSignature Language="VB.NET" Value="Public Function MsgBox (Prompt As Object, Optional Buttons As MsgBoxStyle = Microsoft.VisualBasic.MsgBoxStyle.ApplicationModal, Optional Title As Object = null) As MsgBoxResult" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>Microsoft.VisualBasic</AssemblyName>
        <AssemblyVersion>10.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>Microsoft.VisualBasic.MsgBoxResult</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="Prompt" Type="System.Object" />
        <Parameter Name="Buttons" Type="Microsoft.VisualBasic.MsgBoxStyle" />
        <Parameter Name="Title" Type="System.Object" />
      </Parameters>
      <Docs>
        <param name="Prompt">
          <span data-ttu-id="978c1-445">必须的。</span>
          <span class="sxs-lookup">
            <span data-stu-id="978c1-445">Required.</span>
          </span>
          <span data-ttu-id="978c1-446">作为消息显示在对话框中的 <see langword="String" /> 表达式。</span>
          <span class="sxs-lookup">
            <span data-stu-id="978c1-446">
              <see langword="String" /> expression displayed as the message in the dialog box.</span>
          </span>
          <span data-ttu-id="978c1-447">
            <c>Prompt</c> 的最大长度大约为 1024 个字符，具体取决于所用字符的宽度。</span>
          <span class="sxs-lookup">
            <span data-stu-id="978c1-447">The maximum length of <c>Prompt</c> is approximately 1024 characters, depending on the width of the characters used.</span>
          </span>
          <span data-ttu-id="978c1-448">如果 <c>Prompt</c> 包含多行，可以使用回车符 (<see langword="Chr(" />13<see langword=")" />) 或换行符 (<see langword="Chr(" />10<see langword=")" />)，或组合使用回车符/换行符 (<see langword="Chr(" />13<see langword=")" /> &amp; <see langword="Chr(" />10<see langword=")" />) 来分隔每行。</span>
          <span class="sxs-lookup">
            <span data-stu-id="978c1-448">If <c>Prompt</c> consists of more than one line, you can separate the lines using a carriage return character (<see langword="Chr(" />13<see langword=")" />), a line feed character (<see langword="Chr(" />10<see langword=")" />), or a carriage return/linefeed character combination (<see langword="Chr(" />13<see langword=")" /> &amp; <see langword="Chr(" />10<see langword=")" />) between each line.</span>
          </span>
        </param>
        <param name="Buttons">
          <span data-ttu-id="978c1-449">可选。</span>
          <span class="sxs-lookup">
            <span data-stu-id="978c1-449">Optional.</span>
          </span>
          <span data-ttu-id="978c1-450">数值表达式，它是值的总和，指定显示的按钮数目及按钮类型，使用的图标样式，默认按钮的标识以及消息框的样式等。</span>
          <span class="sxs-lookup">
            <span data-stu-id="978c1-450">Numeric expression that is the sum of values specifying the number and type of buttons to display, the icon style to use, the identity of the default button, and the modality of the message box.</span>
          </span>
          <span data-ttu-id="978c1-451">如果省略 <c>Buttons</c>，则默认值为 0。</span>
          <span class="sxs-lookup">
            <span data-stu-id="978c1-451">If you omit <c>Buttons</c>, the default value is zero.</span>
          </span>
        </param>
        <param name="Title">
          <span data-ttu-id="978c1-452">可选。</span>
          <span class="sxs-lookup">
            <span data-stu-id="978c1-452">Optional.</span>
          </span>
          <span data-ttu-id="978c1-453">显示在对话框标题栏中的 <see langword="String" /> 表达式。</span>
          <span class="sxs-lookup">
            <span data-stu-id="978c1-453">
              <see langword="String" /> expression displayed in the title bar of the dialog box.</span>
          </span>
          <span data-ttu-id="978c1-454">如果省略 <c>Title</c>，则标题栏中显示应用程序名称。</span>
          <span class="sxs-lookup">
            <span data-stu-id="978c1-454">If you omit <c>Title</c>, the application name is placed in the title bar.</span>
          </span>
        </param>
        <summary>
          <span data-ttu-id="978c1-455">在对话框中显示消息，等待用户单击按钮，然后返回一个整数，该整数指示用户单击的按钮。</span>
          <span class="sxs-lookup">
            <span data-stu-id="978c1-455">Displays a message in a dialog box, waits for the user to click a button, and then returns an integer indicating which button the user clicked.</span>
          </span>
        </summary>
        <returns>
          <span data-ttu-id="978c1-456">
            <list type="table">
              <item>
                <term> 常数  </term>
                <description> 值  </description>
              </item>
              <item>
                <term>
                  <see langword="OK" />
                </term>
                <description> 1  </description>
              </item>
              <item>
                <term>
                  <see langword="Cancel" />
                </term>
                <description> 2  </description>
              </item>
              <item>
                <term>
                  <see langword="Abort" />
                </term>
                <description> 3  </description>
              </item>
              <item>
                <term>
                  <see langword="Retry" />
                </term>
                <description> 4  </description>
              </item>
              <item>
                <term>
                  <see langword="Ignore" />
                </term>
                <description> 5  </description>
              </item>
              <item>
                <term>
                  <see langword="Yes" />
                </term>
                <description> 6  </description>
              </item>
              <item>
                <term>
                  <see langword="No" />
                </term>
                <description> 7  </description>
              </item>
            </list>
          </span>
          <span class="sxs-lookup">
            <span data-stu-id="978c1-456">
              <list type="table">
                <item>
                  <term> Constant  </term>
                  <description> Value  </description>
                </item>
                <item>
                  <term>
                    <see langword="OK" />
                  </term>
                  <description> 1  </description>
                </item>
                <item>
                  <term>
                    <see langword="Cancel" />
                  </term>
                  <description> 2  </description>
                </item>
                <item>
                  <term>
                    <see langword="Abort" />
                  </term>
                  <description> 3  </description>
                </item>
                <item>
                  <term>
                    <see langword="Retry" />
                  </term>
                  <description> 4  </description>
                </item>
                <item>
                  <term>
                    <see langword="Ignore" />
                  </term>
                  <description> 5  </description>
                </item>
                <item>
                  <term>
                    <see langword="Yes" />
                  </term>
                  <description> 6  </description>
                </item>
                <item>
                  <term>
                    <see langword="No" />
                  </term>
                  <description> 7  </description>
                </item>
              </list>
            </span>
          </span>
        </returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="978c1-457">如果省略任何位置的自变量，你必须保留相应的逗号分隔符。</span><span class="sxs-lookup"><span data-stu-id="978c1-457">If you omit any positional arguments, you must retain the corresponding comma delimiter.</span></span>  
  
 <span data-ttu-id="978c1-458">如果对话框显示**取消**按钮，则按 ESC 键具有相同的效果与单击**取消**</span><span class="sxs-lookup"><span data-stu-id="978c1-458">If the dialog box displays a **Cancel** button, pressing the ESC key has the same effect as clicking **Cancel**</span></span>  
  
 <span data-ttu-id="978c1-459">如果对话框包含**帮助**按钮，在对话框中提供区分上下文的帮助。</span><span class="sxs-lookup"><span data-stu-id="978c1-459">If the dialog box contains a **Help** button, context-sensitive Help is provided for the dialog box.</span></span> <span data-ttu-id="978c1-460">但是，在关闭其他任一按钮前，不会返回任何值。</span><span class="sxs-lookup"><span data-stu-id="978c1-460">However, no value is returned until one of the other buttons is chosen.</span></span> <span data-ttu-id="978c1-461">在 Windows 窗体应用程序中，选择**帮助**按钮执行<xref:System.Windows.Forms.Control.HelpRequested>窗体的事件。</span><span class="sxs-lookup"><span data-stu-id="978c1-461">In Windows Form applications, choosing the **Help** button executes the <xref:System.Windows.Forms.Control.HelpRequested> event for the form.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="978c1-462">`MsgBox`函数需要`UIPermission`在<xref:System.Security.Permissions.UIPermissionWindow.SafeTopLevelWindows>级别，这可能会影响在部分信任情况下其执行。</span><span class="sxs-lookup"><span data-stu-id="978c1-462">The `MsgBox` function requires `UIPermission` at the <xref:System.Security.Permissions.UIPermissionWindow.SafeTopLevelWindows> level, which may affect its execution in partial-trust situations.</span></span> <span data-ttu-id="978c1-463">有关详情，请参阅<xref:System.Security.Permissions.UIPermission>。</span><span class="sxs-lookup"><span data-stu-id="978c1-463">For more information, see <xref:System.Security.Permissions.UIPermission>.</span></span>  
  
 <span data-ttu-id="978c1-464">`MsgBoxStyle`下表列出了枚举值。</span><span class="sxs-lookup"><span data-stu-id="978c1-464">The `MsgBoxStyle` enumeration values are listed in the following table.</span></span>  
  
|<span data-ttu-id="978c1-465">成员</span><span class="sxs-lookup"><span data-stu-id="978c1-465">Member</span></span>|<span data-ttu-id="978c1-466">“值”</span><span class="sxs-lookup"><span data-stu-id="978c1-466">Value</span></span>|<span data-ttu-id="978c1-467">描述</span><span class="sxs-lookup"><span data-stu-id="978c1-467">Description</span></span>|  
|-|-|-|  
|<span data-ttu-id="978c1-468">成员</span><span class="sxs-lookup"><span data-stu-id="978c1-468">Member</span></span>|<span data-ttu-id="978c1-469">“值”</span><span class="sxs-lookup"><span data-stu-id="978c1-469">Value</span></span>|<span data-ttu-id="978c1-470">描述</span><span class="sxs-lookup"><span data-stu-id="978c1-470">Description</span></span>|  
|`OKOnly`|<span data-ttu-id="978c1-471">0</span><span class="sxs-lookup"><span data-stu-id="978c1-471">0</span></span>|<span data-ttu-id="978c1-472">仅显示确定按钮。</span><span class="sxs-lookup"><span data-stu-id="978c1-472">Displays OK button only.</span></span>|  
|`OKCancel`|<span data-ttu-id="978c1-473">1</span><span class="sxs-lookup"><span data-stu-id="978c1-473">1</span></span>|<span data-ttu-id="978c1-474">显示确定和取消按钮。</span><span class="sxs-lookup"><span data-stu-id="978c1-474">Displays OK and Cancel buttons.</span></span>|  
|`AbortRetryIgnore`|<span data-ttu-id="978c1-475">2</span><span class="sxs-lookup"><span data-stu-id="978c1-475">2</span></span>|<span data-ttu-id="978c1-476">显示中止、 重试，和忽略按钮。</span><span class="sxs-lookup"><span data-stu-id="978c1-476">Displays Abort, Retry, and Ignore buttons.</span></span>|  
|`YesNoCancel`|<span data-ttu-id="978c1-477">3</span><span class="sxs-lookup"><span data-stu-id="978c1-477">3</span></span>|<span data-ttu-id="978c1-478">显示是、 否和取消按钮。</span><span class="sxs-lookup"><span data-stu-id="978c1-478">Displays Yes, No, and Cancel buttons.</span></span>|  
|`YesNo`|<span data-ttu-id="978c1-479">4</span><span class="sxs-lookup"><span data-stu-id="978c1-479">4</span></span>|<span data-ttu-id="978c1-480">显示是和无按钮。</span><span class="sxs-lookup"><span data-stu-id="978c1-480">Displays Yes and No buttons.</span></span>|  
|`RetryCancel`|<span data-ttu-id="978c1-481">5</span><span class="sxs-lookup"><span data-stu-id="978c1-481">5</span></span>|<span data-ttu-id="978c1-482">显示重试和取消按钮。</span><span class="sxs-lookup"><span data-stu-id="978c1-482">Displays Retry and Cancel buttons.</span></span>|  
|`Critical`|<span data-ttu-id="978c1-483">16</span><span class="sxs-lookup"><span data-stu-id="978c1-483">16</span></span>|<span data-ttu-id="978c1-484">显示关键消息图标。</span><span class="sxs-lookup"><span data-stu-id="978c1-484">Displays Critical Message icon.</span></span>|  
|`Question`|<span data-ttu-id="978c1-485">32</span><span class="sxs-lookup"><span data-stu-id="978c1-485">32</span></span>|<span data-ttu-id="978c1-486">显示警告查询图标。</span><span class="sxs-lookup"><span data-stu-id="978c1-486">Displays Warning Query icon.</span></span>|  
|`Exclamation`|<span data-ttu-id="978c1-487">48</span><span class="sxs-lookup"><span data-stu-id="978c1-487">48</span></span>|<span data-ttu-id="978c1-488">显示警告消息图标。</span><span class="sxs-lookup"><span data-stu-id="978c1-488">Displays Warning Message icon.</span></span>|  
|`Information`|<span data-ttu-id="978c1-489">64</span><span class="sxs-lookup"><span data-stu-id="978c1-489">64</span></span>|<span data-ttu-id="978c1-490">显示信息性消息图标。</span><span class="sxs-lookup"><span data-stu-id="978c1-490">Displays Information Message icon.</span></span>|  
|`DefaultButton1`|<span data-ttu-id="978c1-491">0</span><span class="sxs-lookup"><span data-stu-id="978c1-491">0</span></span>|<span data-ttu-id="978c1-492">第一个按钮是默认值。</span><span class="sxs-lookup"><span data-stu-id="978c1-492">First button is default.</span></span>|  
|`DefaultButton2`|<span data-ttu-id="978c1-493">256</span><span class="sxs-lookup"><span data-stu-id="978c1-493">256</span></span>|<span data-ttu-id="978c1-494">第二个按钮是默认值。</span><span class="sxs-lookup"><span data-stu-id="978c1-494">Second button is default.</span></span>|  
|`DefaultButton3`|<span data-ttu-id="978c1-495">512</span><span class="sxs-lookup"><span data-stu-id="978c1-495">512</span></span>|<span data-ttu-id="978c1-496">第三个按钮是默认值。</span><span class="sxs-lookup"><span data-stu-id="978c1-496">Third button is default.</span></span>|  
|`ApplicationModal`|<span data-ttu-id="978c1-497">0</span><span class="sxs-lookup"><span data-stu-id="978c1-497">0</span></span>|<span data-ttu-id="978c1-498">应用程序是模式。</span><span class="sxs-lookup"><span data-stu-id="978c1-498">Application is modal.</span></span> <span data-ttu-id="978c1-499">用户必须响应此消息框，才能继续在当前应用程序中的工作。</span><span class="sxs-lookup"><span data-stu-id="978c1-499">The user must respond to the message box before continuing work in the current application.</span></span>|  
|`SystemModal`|<span data-ttu-id="978c1-500">4096</span><span class="sxs-lookup"><span data-stu-id="978c1-500">4096</span></span>|<span data-ttu-id="978c1-501">系统为模式。</span><span class="sxs-lookup"><span data-stu-id="978c1-501">System is modal.</span></span> <span data-ttu-id="978c1-502">所有应用程序挂起，直到用户响应消息框。</span><span class="sxs-lookup"><span data-stu-id="978c1-502">All applications are suspended until the user responds to the message box.</span></span>|  
|`MsgBoxSetForeground`|<span data-ttu-id="978c1-503">65536</span><span class="sxs-lookup"><span data-stu-id="978c1-503">65536</span></span>|<span data-ttu-id="978c1-504">指定消息框窗口中作为前台窗口。</span><span class="sxs-lookup"><span data-stu-id="978c1-504">Specifies the message box window as the foreground window.</span></span>|  
|`MsgBoxRight`|<span data-ttu-id="978c1-505">524288</span><span class="sxs-lookup"><span data-stu-id="978c1-505">524288</span></span>|<span data-ttu-id="978c1-506">文本为右对齐。</span><span class="sxs-lookup"><span data-stu-id="978c1-506">Text is right-aligned.</span></span>|  
|`MsgBoxRtlReading`|<span data-ttu-id="978c1-507">1048576</span><span class="sxs-lookup"><span data-stu-id="978c1-507">1048576</span></span>|<span data-ttu-id="978c1-508">指定文本应显示为右到左读取希伯来语和阿拉伯语系统上。</span><span class="sxs-lookup"><span data-stu-id="978c1-508">Specifies text should appear as right-to-left reading on Hebrew and Arabic systems.</span></span>|  
  
 <span data-ttu-id="978c1-509">第一组值 (0 – 5) 描述的数量和类型的对话框中显示的按钮。</span><span class="sxs-lookup"><span data-stu-id="978c1-509">The first group of values (0–5) describes the number and type of buttons displayed in the dialog box.</span></span> <span data-ttu-id="978c1-510">第二个组 （16、 32、 48、 64） 描述图标样式。</span><span class="sxs-lookup"><span data-stu-id="978c1-510">The second group (16, 32, 48, 64) describes the icon style.</span></span> <span data-ttu-id="978c1-511">第三个组 （0、 256、 512） 确定哪个按钮为默认值。</span><span class="sxs-lookup"><span data-stu-id="978c1-511">The third group (0, 256, 512) determines which button is the default.</span></span> <span data-ttu-id="978c1-512">第四个组 （0，4096） 确定消息框的模式和第五个组指定消息框窗口为前台窗口时，以及对齐方式和文本的方向。</span><span class="sxs-lookup"><span data-stu-id="978c1-512">The fourth group (0, 4096) determines the modality of the message box, and the fifth group specifies whether or not the message box window is the foreground window, along with the alignment and direction of the text.</span></span> <span data-ttu-id="978c1-513">添加编号，以创建最终值时`Buttons`自变量，每个组中使用只有一个数。</span><span class="sxs-lookup"><span data-stu-id="978c1-513">When adding numbers to create a final value for the `Buttons` argument, use only one number from each group.</span></span>  
  
   
  
## Examples  
 <span data-ttu-id="978c1-514">此示例使用`MsgBox`函数来使用是和没有按钮的对话框中显示的严重错误消息。</span><span class="sxs-lookup"><span data-stu-id="978c1-514">This example uses the `MsgBox` function to display a critical-error message in a dialog box with Yes and No buttons.</span></span> <span data-ttu-id="978c1-515">否按钮指定为默认响应。</span><span class="sxs-lookup"><span data-stu-id="978c1-515">The No button is specified as the default response.</span></span> <span data-ttu-id="978c1-516">这是通过组合`MsgBox`为一个数值表达式的常量值。</span><span class="sxs-lookup"><span data-stu-id="978c1-516">This is done by combining the `MsgBox` constant values into one numeric expression.</span></span> <span data-ttu-id="978c1-517">在这种情况下，添加 4 (是/否按钮组合) 和 16 (**关键消息**窗口) 和 256 （第二个按钮为默认按钮） 得到 276 的总计。</span><span class="sxs-lookup"><span data-stu-id="978c1-517">In this case, adding 4 (the Yes/No button combination) and 16 (the **Critical Message** window) and 256 (the second button as default button) gives a total of 276.</span></span> <span data-ttu-id="978c1-518">返回的值`MsgBox`函数取决于用户所选择的按钮: 是返回 6; 的值任何返回的值为 7。</span><span class="sxs-lookup"><span data-stu-id="978c1-518">The value returned by the `MsgBox` function depends on the button chosen by the user: Yes returns a value of 6; No returns a value of 7.</span></span>  
  
 [!code-vb[VbVbalrCatRef#20](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbalrCatRef/VB/Class1.vb#20)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentException">
          <span data-ttu-id="978c1-519">
            <paramref name="Prompt" /> 不是一个 <see langword="String" /> 表达式，或者 <paramref name="Title" /> 无效。</span>
          <span class="sxs-lookup">
            <span data-stu-id="978c1-519">
              <paramref name="Prompt" /> is not a <see langword="String" /> expression, or <paramref name="Title" /> is invalid.</span>
          </span>
        </exception>
        <exception cref="T:System.InvalidOperationException">
          <span data-ttu-id="978c1-520">进程不是以 User Interactive 模式运行。</span>
          <span class="sxs-lookup">
            <span data-stu-id="978c1-520">Process is not running in User Interactive mode.</span>
          </span>
        </exception>
        <exception cref="T:System.ComponentModel.InvalidEnumArgumentException">
          <span data-ttu-id="978c1-521">一个或多个参数，而不是 <see langword="MsgBoxResult" /> 或 <see langword="MsgBoxStyle" /> 枚举的成员。</span>
          <span class="sxs-lookup">
            <span data-stu-id="978c1-521">One or more parameters not a member of <see langword="MsgBoxResult" /> or <see langword="MsgBoxStyle" /> enumeration.</span>
          </span>
        </exception>
        <altmember cref="M:Microsoft.VisualBasic.Interaction.InputBox(System.String,System.String,System.String,System.Int32,System.Int32)" />
        <altmember cref="M:System.Windows.Forms.MessageBox.Show(System.String)" />
      </Docs>
    </Member>
    <Member MemberName="Partition">
      <MemberSignature Language="C#" Value="public static string Partition (long Number, long Start, long Stop, long Interval);" />
      <MemberSignature Language="ILAsm" Value=".method public static string Partition(int64 Number, int64 Start, int64 Stop, int64 Interval) cil managed" />
      <MemberSignature Language="DocId" Value="M:Microsoft.VisualBasic.Interaction.Partition(System.Int64,System.Int64,System.Int64,System.Int64)" />
      <MemberSignature Language="VB.NET" Value="Public Function Partition (Number As Long, Start As Long, Stop As Long, Interval As Long) As String" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; static System::String ^ Partition(long Number, long Start, long Stop, long Interval);" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>Microsoft.VisualBasic</AssemblyName>
        <AssemblyVersion>10.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.String</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="Number" Type="System.Int64" />
        <Parameter Name="Start" Type="System.Int64" />
        <Parameter Name="Stop" Type="System.Int64" />
        <Parameter Name="Interval" Type="System.Int64" />
      </Parameters>
      <Docs>
        <param name="Number">
          <span data-ttu-id="978c1-522">必须的。</span>
          <span class="sxs-lookup">
            <span data-stu-id="978c1-522">Required.</span>
          </span>
          <span data-ttu-id="978c1-523">
            <see langword="Long" />。</span>
          <span class="sxs-lookup">
            <span data-stu-id="978c1-523">
              <see langword="Long" />.</span>
          </span>
          <span data-ttu-id="978c1-524">要在一个计算范围中找到的整数。</span>
          <span class="sxs-lookup">
            <span data-stu-id="978c1-524">Whole number that you want to locate within one of the calculated ranges.</span>
          </span>
        </param>
        <param name="Start">
          <span data-ttu-id="978c1-525">必须的。</span>
          <span class="sxs-lookup">
            <span data-stu-id="978c1-525">Required.</span>
          </span>
          <span data-ttu-id="978c1-526">
            <see langword="Long" />。</span>
          <span class="sxs-lookup">
            <span data-stu-id="978c1-526">
              <see langword="Long" />.</span>
          </span>
          <span data-ttu-id="978c1-527">一个整数，指示计算出的范围集的开始值。</span>
          <span class="sxs-lookup">
            <span data-stu-id="978c1-527">Whole number that indicates the start of the set of calculated ranges.</span>
          </span>
          <span data-ttu-id="978c1-528">
            <c>Start</c> 不能小于 0。</span>
          <span class="sxs-lookup">
            <span data-stu-id="978c1-528">
              <c>Start</c> cannot be less than 0.</span>
          </span>
        </param>
        <param name="Stop">
          <span data-ttu-id="978c1-529">必须的。</span>
          <span class="sxs-lookup">
            <span data-stu-id="978c1-529">Required.</span>
          </span>
          <span data-ttu-id="978c1-530">
            <see langword="Long" />。</span>
          <span class="sxs-lookup">
            <span data-stu-id="978c1-530">
              <see langword="Long" />.</span>
          </span>
          <span data-ttu-id="978c1-531">一个整数，指示计算出的范围集的结束值。</span>
          <span class="sxs-lookup">
            <span data-stu-id="978c1-531">Whole number that indicates the end of the set of calculated ranges.</span>
          </span>
          <span data-ttu-id="978c1-532">
            <c>Stop</c> 不能小于或等于 <c>Start</c>。</span>
          <span class="sxs-lookup">
            <span data-stu-id="978c1-532">
              <c>Stop</c> cannot be less than or equal to <c>Start</c>.</span>
          </span>
        </param>
        <param name="Interval">
          <span data-ttu-id="978c1-533">必须的。</span>
          <span class="sxs-lookup">
            <span data-stu-id="978c1-533">Required.</span>
          </span>
          <span data-ttu-id="978c1-534">
            <see langword="Long" />。</span>
          <span class="sxs-lookup">
            <span data-stu-id="978c1-534">
              <see langword="Long" />.</span>
          </span>
          <span data-ttu-id="978c1-535">一个整数，指示在 <c>Start</c> 和 <c>Stop</c> 之间计算的每个范围大小。</span>
          <span class="sxs-lookup">
            <span data-stu-id="978c1-535">Whole number that indicates the size of each range calculated between <c>Start</c> and <c>Stop</c>.</span>
          </span>
          <span data-ttu-id="978c1-536">
            <c>Interval</c> 不能小于 1。</span>
          <span class="sxs-lookup">
            <span data-stu-id="978c1-536">
              <c>Interval</c> cannot be less than 1.</span>
          </span>
        </param>
        <summary>
          <span data-ttu-id="978c1-537">返回一个字符串，该字符串表示包含某个数字的计算范围。</span>
          <span class="sxs-lookup">
            <span data-stu-id="978c1-537">Returns a string representing the calculated range that contains a number.</span>
          </span>
        </summary>
        <returns>
          <span data-ttu-id="978c1-538">返回一个字符串，该字符串表示包含某个数字的计算范围。</span>
          <span class="sxs-lookup">
            <span data-stu-id="978c1-538">Returns a string representing the calculated range that contains a number.</span>
          </span>
        </returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="978c1-539">`Partition`函数计算的一组数值范围，各包含由指定的值的数目`Interval`。</span><span class="sxs-lookup"><span data-stu-id="978c1-539">The `Partition` function calculates a set of numeric ranges, each containing the number of values specified by `Interval`.</span></span> <span data-ttu-id="978c1-540">第一个范围开始`Start`，并在最后一个范围结束`Stop`。</span><span class="sxs-lookup"><span data-stu-id="978c1-540">The first range begins at `Start`, and the last range ends at `Stop`.</span></span> <span data-ttu-id="978c1-541">`Partition`函数然后确定哪一个范围包含`Number`并返回一个描述该范围内的字符串。</span><span class="sxs-lookup"><span data-stu-id="978c1-541">The `Partition` function then identifies which range contains `Number` and returns a string describing that range.</span></span> <span data-ttu-id="978c1-542">范围表示为字符串中"*较*:*值*"，其中低范围的末尾 (*较*) 与高端分隔 (*值*) 以冒号 （:）。</span><span class="sxs-lookup"><span data-stu-id="978c1-542">The range is represented in the string as "*lowervalue*:*uppervalue*", where the low end of the range (*lowervalue*) is separated from the high end (*uppervalue*) by a colon (:).</span></span>  
  
 <span data-ttu-id="978c1-543">如有必要，`Partition`函数将插入前的前导空格*较*和*值*，以便它们都具有相同数量的字符的字符串表示形式的值 （作为`Stop` + 1)。</span><span class="sxs-lookup"><span data-stu-id="978c1-543">If necessary, the `Partition` function inserts leading spaces before *lowervalue* and *uppervalue* so that they both have the same number of characters as the string representation of the value (`Stop` + 1).</span></span> <span data-ttu-id="978c1-544">这可确保： 如果你使用的输出`Partition`的多个值具有函数`Number`，将在任何后续排序操作过程正确处理结果的文本。</span><span class="sxs-lookup"><span data-stu-id="978c1-544">This ensures that if you use the output of the `Partition` function with several values of `Number`, the resulting text will be handled properly during any subsequent sort operation.</span></span>  
  
 <span data-ttu-id="978c1-545">下表显示使用三组计算的范围某些示例字符串`Start`， `Stop`，和`Interval`。</span><span class="sxs-lookup"><span data-stu-id="978c1-545">The following table shows some sample strings for ranges calculated using three sets of `Start`, `Stop`, and `Interval`.</span></span> <span data-ttu-id="978c1-546">"第一个范围"和"最后一个范围"列显示在给定的值时可能的最低和最高范围`Start`和`Stop`。</span><span class="sxs-lookup"><span data-stu-id="978c1-546">The "First range" and "Last range" columns show the lowest and highest ranges possible given the values of `Start` and `Stop`.</span></span> <span data-ttu-id="978c1-547">"之前第一个范围"和"之后最后一个范围"列显示返回的值的字符串`Number`小于`Start`和大于`Stop`分别。</span><span class="sxs-lookup"><span data-stu-id="978c1-547">The "Before first range" and "After last range" columns show the strings returned for values of `Number` less than `Start` and greater than `Stop`, respectively.</span></span>  
  
|`Start`|`Stop`|`Interval`|<span data-ttu-id="978c1-548">第一个范围之前</span><span class="sxs-lookup"><span data-stu-id="978c1-548">Before first range</span></span>|<span data-ttu-id="978c1-549">第一个范围</span><span class="sxs-lookup"><span data-stu-id="978c1-549">First range</span></span>|<span data-ttu-id="978c1-550">最后一个范围</span><span class="sxs-lookup"><span data-stu-id="978c1-550">Last range</span></span>|<span data-ttu-id="978c1-551">最后一个范围之后</span><span class="sxs-lookup"><span data-stu-id="978c1-551">After last range</span></span>|  
|-|-|-|-|-|-|-|  
|<span data-ttu-id="978c1-552">0</span><span class="sxs-lookup"><span data-stu-id="978c1-552">0</span></span>|<span data-ttu-id="978c1-553">99</span><span class="sxs-lookup"><span data-stu-id="978c1-553">99</span></span>|<span data-ttu-id="978c1-554">5</span><span class="sxs-lookup"><span data-stu-id="978c1-554">5</span></span>|<span data-ttu-id="978c1-555">"   : -1"</span><span class="sxs-lookup"><span data-stu-id="978c1-555">"   : -1"</span></span>|<span data-ttu-id="978c1-556">"0: 4"</span><span class="sxs-lookup"><span data-stu-id="978c1-556">"  0:  4"</span></span>|<span data-ttu-id="978c1-557">"95: 99"</span><span class="sxs-lookup"><span data-stu-id="978c1-557">" 95: 99"</span></span>|<span data-ttu-id="978c1-558">"100:"</span><span class="sxs-lookup"><span data-stu-id="978c1-558">"100:   "</span></span>|  
|<span data-ttu-id="978c1-559">20</span><span class="sxs-lookup"><span data-stu-id="978c1-559">20</span></span>|<span data-ttu-id="978c1-560">199</span><span class="sxs-lookup"><span data-stu-id="978c1-560">199</span></span>|<span data-ttu-id="978c1-561">10</span><span class="sxs-lookup"><span data-stu-id="978c1-561">10</span></span>|<span data-ttu-id="978c1-562">": 19 英寸</span><span class="sxs-lookup"><span data-stu-id="978c1-562">"   : 19"</span></span>|<span data-ttu-id="978c1-563">"20: 29"</span><span class="sxs-lookup"><span data-stu-id="978c1-563">" 20: 29"</span></span>|<span data-ttu-id="978c1-564">"190:199"</span><span class="sxs-lookup"><span data-stu-id="978c1-564">"190:199"</span></span>|<span data-ttu-id="978c1-565">"200:"</span><span class="sxs-lookup"><span data-stu-id="978c1-565">"200:   "</span></span>|  
|<span data-ttu-id="978c1-566">100</span><span class="sxs-lookup"><span data-stu-id="978c1-566">100</span></span>|<span data-ttu-id="978c1-567">1010</span><span class="sxs-lookup"><span data-stu-id="978c1-567">1010</span></span>|<span data-ttu-id="978c1-568">20</span><span class="sxs-lookup"><span data-stu-id="978c1-568">20</span></span>|<span data-ttu-id="978c1-569">": 99"</span><span class="sxs-lookup"><span data-stu-id="978c1-569">"    : 99"</span></span>|<span data-ttu-id="978c1-570">"100: 119"</span><span class="sxs-lookup"><span data-stu-id="978c1-570">" 100: 119"</span></span>|<span data-ttu-id="978c1-571">"1000:1010"</span><span class="sxs-lookup"><span data-stu-id="978c1-571">"1000:1010"</span></span>|<span data-ttu-id="978c1-572">"1011年:"</span><span class="sxs-lookup"><span data-stu-id="978c1-572">"1011:    "</span></span>|  
  
 <span data-ttu-id="978c1-573">在上表中，第三行显示结果时`Start`和`Stop`定义一组不能由均匀划分的数字`Interval`。</span><span class="sxs-lookup"><span data-stu-id="978c1-573">In the preceding table, the third line shows the result when `Start` and `Stop` define a set of numbers that cannot be evenly divided by `Interval`.</span></span> <span data-ttu-id="978c1-574">最后一个范围结束`Stop`，使其仅有 11 个字符，即使`Interval`为 20。</span><span class="sxs-lookup"><span data-stu-id="978c1-574">The last range ends at `Stop`, making it only 11 numbers long, even though `Interval` is 20.</span></span>  
  
 <span data-ttu-id="978c1-575">如果`Interval`为 1，范围是"`Number`:`Number`"，而不管`Start`和`Stop`自变量。</span><span class="sxs-lookup"><span data-stu-id="978c1-575">If `Interval` is 1, the range is "`Number`:`Number`", regardless of the `Start` and `Stop` arguments.</span></span> <span data-ttu-id="978c1-576">例如，如果`Number`是 267，`Stop`为 1000，和`Interval`为 1，`Partition`返回"267: 267"。</span><span class="sxs-lookup"><span data-stu-id="978c1-576">For example, if `Number` is 267, `Stop` is 1000, and `Interval` is 1, `Partition` returns " 267: 267".</span></span>  
  
 <span data-ttu-id="978c1-577">`Partition` 构建数据库查询时，可以很有用。</span><span class="sxs-lookup"><span data-stu-id="978c1-577">`Partition` can be useful when constructing database queries.</span></span> <span data-ttu-id="978c1-578">你可以创建一个选择查询以显示多少订单出现在各种值的范围，例如，使用发票值从 1 到 1000、 1001年到 2000 中，依次类推。</span><span class="sxs-lookup"><span data-stu-id="978c1-578">You can create a SELECT query that shows how many orders occur within various value ranges, for example with invoice values from 1 to 1000, 1001 to 2000, and so on.</span></span>  
  
   
  
## Examples  
 <span data-ttu-id="978c1-579">下面的示例设置了一系列的范围几十 1950 到 2049年。</span><span class="sxs-lookup"><span data-stu-id="978c1-579">The following example sets up a series of ranges for decades from 1950 through 2049.</span></span> <span data-ttu-id="978c1-580">它将定位的值`year`中的适当的范围和返回`String`显示范围的值。</span><span class="sxs-lookup"><span data-stu-id="978c1-580">It locates the value of `year` within the appropriate range and returns a `String` value showing the range.</span></span> <span data-ttu-id="978c1-581">如果`year`具有值为 1984，例如，`Partition`返回"1980: 1989"。</span><span class="sxs-lookup"><span data-stu-id="978c1-581">If `year` has a value of 1984, for example, `Partition` returns "1980:1989".</span></span>  
  
 [!code-vb[VbVbalrFunctions#45](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbalrFunctions/VB/Class1.vb#45)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentException">
          <span data-ttu-id="978c1-582">
            <paramref name="Start" /> &lt; 0、<paramref name="Stop" /> &lt;= <paramref name="Start" /> 或 <paramref name="Interval" /> &lt; 1。</span>
          <span class="sxs-lookup">
            <span data-stu-id="978c1-582">
              <paramref name="Start" /> &lt; 0, <paramref name="Stop" /> &lt;= <paramref name="Start" />, or <paramref name="Interval" /> &lt; 1.</span>
          </span>
        </exception>
      </Docs>
    </Member>
    <Member MemberName="SaveSetting">
      <MemberSignature Language="C#" Value="public static void SaveSetting (string AppName, string Section, string Key, string Setting);" />
      <MemberSignature Language="ILAsm" Value=".method public static void SaveSetting(string AppName, string Section, string Key, string Setting) cil managed" />
      <MemberSignature Language="DocId" Value="M:Microsoft.VisualBasic.Interaction.SaveSetting(System.String,System.String,System.String,System.String)" />
      <MemberSignature Language="VB.NET" Value="Public Sub SaveSetting (AppName As String, Section As String, Key As String, Setting As String)" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; static void SaveSetting(System::String ^ AppName, System::String ^ Section, System::String ^ Key, System::String ^ Setting);" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>Microsoft.VisualBasic</AssemblyName>
        <AssemblyVersion>10.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Void</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="AppName" Type="System.String" />
        <Parameter Name="Section" Type="System.String" />
        <Parameter Name="Key" Type="System.String" />
        <Parameter Name="Setting" Type="System.String" />
      </Parameters>
      <Docs>
        <param name="AppName">
          <span data-ttu-id="978c1-583">必须的。</span>
          <span class="sxs-lookup">
            <span data-stu-id="978c1-583">Required.</span>
          </span>
          <span data-ttu-id="978c1-584">
            <see langword="String" /> 表达式，包含应用该设置的应用程序或项目的名称。</span>
          <span class="sxs-lookup">
            <span data-stu-id="978c1-584">
              <see langword="String" /> expression containing the name of the application or project to which the setting applies.</span>
          </span>
        </param>
        <param name="Section">
          <span data-ttu-id="978c1-585">必须的。</span>
          <span class="sxs-lookup">
            <span data-stu-id="978c1-585">Required.</span>
          </span>
          <span data-ttu-id="978c1-586">
            <see langword="String" /> 表达式，包含在其中保存项设置的节的名称。</span>
          <span class="sxs-lookup">
            <span data-stu-id="978c1-586">
              <see langword="String" /> expression containing the name of the section in which the key setting is being saved.</span>
          </span>
        </param>
        <param name="Key">
          <span data-ttu-id="978c1-587">必须的。</span>
          <span class="sxs-lookup">
            <span data-stu-id="978c1-587">Required.</span>
          </span>
          <span data-ttu-id="978c1-588">
            <see langword="String" /> 表达式，包含将保存的项设置的名称。</span>
          <span class="sxs-lookup">
            <span data-stu-id="978c1-588">
              <see langword="String" /> expression containing the name of the key setting being saved.</span>
          </span>
        </param>
        <param name="Setting">
          <span data-ttu-id="978c1-589">必须的。</span>
          <span class="sxs-lookup">
            <span data-stu-id="978c1-589">Required.</span>
          </span>
          <span data-ttu-id="978c1-590">包含值的表达式，<c>Key</c> 将被设置为该值。</span>
          <span class="sxs-lookup">
            <span data-stu-id="978c1-590">Expression containing the value to which <c>Key</c> is being set.</span>
          </span>
        </param>
        <summary>
          <span data-ttu-id="978c1-591">在 Windows 注册表中保存或创建应用程序项。</span>
          <span class="sxs-lookup">
            <span data-stu-id="978c1-591">Saves or creates an application entry in the Windows registry.</span>
          </span>
          <span data-ttu-id="978c1-592">与 <see langword="My" /> 相比，<see langword="SaveSetting" /> 功能在注册表操作方面可为您提供更高的效率和更好的性能。</span>
          <span class="sxs-lookup">
            <span data-stu-id="978c1-592">The <see langword="My" /> feature gives you greater productivity and performance in registry operations than <see langword="SaveSetting" />.</span>
          </span>
          <span data-ttu-id="978c1-593">有关详情，请参阅<see cref="P:Microsoft.VisualBasic.Devices.ServerComputer.Registry" />。</span>
          <span class="sxs-lookup">
            <span data-stu-id="978c1-593">For more information, see <see cref="P:Microsoft.VisualBasic.Devices.ServerComputer.Registry" />.</span>
          </span>
        </summary>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="978c1-594">`SaveSetting`函数添加的关键`HKEY_CURRENT_USER\Software\VB and VBA Program Settings`。</span><span class="sxs-lookup"><span data-stu-id="978c1-594">The `SaveSetting` function adds the key to `HKEY_CURRENT_USER\Software\VB and VBA Program Settings`.</span></span>  
  
 <span data-ttu-id="978c1-595">如果出于任何原因而无法保存的项设置，就会出错。</span><span class="sxs-lookup"><span data-stu-id="978c1-595">If the key setting cannot be saved for any reason, an error occurs.</span></span>  
  
 <span data-ttu-id="978c1-596">`SaveSetting` 要求在消息由于其下运行，用户登录上`HKEY_LOCAL_USER`注册表项，用户在以交互方式登录之前处于非活动状态。</span><span class="sxs-lookup"><span data-stu-id="978c1-596">`SaveSetting` requires that a user be logged on since it operates under the `HKEY_LOCAL_USER` registry key, which is not active until a user logs on interactively.</span></span>  
  
 <span data-ttu-id="978c1-597">要从非交互式进程 （如 Mtx.exe) 访问的注册表设置应存储下`HKEY_LOCAL_MACHINE\Software\`或`HKEY_USER\DEFAULT\Software`注册表项。</span><span class="sxs-lookup"><span data-stu-id="978c1-597">Registry settings that are to be accessed from a non-interactive process (such as Mtx.exe) should be stored under either the `HKEY_LOCAL_MACHINE\Software\` or the `HKEY_USER\DEFAULT\Software` registry keys.</span></span>  
  
 <span data-ttu-id="978c1-598">`SaveSetting` 需要`Write`和`Create` <xref:System.Security.Permissions.RegistryPermission> 。</span><span class="sxs-lookup"><span data-stu-id="978c1-598">`SaveSetting` requires `Write` and `Create`<xref:System.Security.Permissions.RegistryPermission> .</span></span>  
  
   
  
## Examples  
 <span data-ttu-id="978c1-599">下面的示例首先使用`SaveSetting`函数以在 Windows 注册表中供使条目`MyApp`应用程序，然后使用`DeleteSetting`函数以将它们删除。</span><span class="sxs-lookup"><span data-stu-id="978c1-599">The following example first uses the `SaveSetting` function to make entries in the Windows registry for the `MyApp` application, and then uses the `DeleteSetting` function to remove them.</span></span>  
  
 [!code-vb[VbVbalrCatRef#56](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbalrCatRef/VB/Class1.vb#56)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentException">
          <span data-ttu-id="978c1-600">未能创建注册表项，或用户没有登录。</span>
          <span class="sxs-lookup">
            <span data-stu-id="978c1-600">Key registry could not be created, or user is not logged in.</span>
          </span>
        </exception>
        <altmember cref="M:Microsoft.VisualBasic.Interaction.DeleteSetting(System.String,System.String,System.String)" />
        <altmember cref="M:Microsoft.VisualBasic.Interaction.GetAllSettings(System.String,System.String)" />
        <altmember cref="M:Microsoft.VisualBasic.Interaction.GetSetting(System.String,System.String,System.String,System.String)" />
        <altmember cref="T:System.Security.Permissions.RegistryPermission" />
      </Docs>
    </Member>
    <Member MemberName="Shell">
      <MemberSignature Language="C#" Value="public static int Shell (string PathName, Microsoft.VisualBasic.AppWinStyle Style = Microsoft.VisualBasic.AppWinStyle.MinimizedFocus, bool Wait = false, int Timeout = -1);" />
      <MemberSignature Language="ILAsm" Value=".method public static int32 Shell(string PathName, valuetype Microsoft.VisualBasic.AppWinStyle Style, bool Wait, int32 Timeout) cil managed" />
      <MemberSignature Language="DocId" Value="M:Microsoft.VisualBasic.Interaction.Shell(System.String,Microsoft.VisualBasic.AppWinStyle,System.Boolean,System.Int32)" />
      <MemberSignature Language="VB.NET" Value="Public Function Shell (PathName As String, Optional Style As AppWinStyle = Microsoft.VisualBasic.AppWinStyle.MinimizedFocus, Optional Wait As Boolean = false, Optional Timeout As Integer = -1) As Integer" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>Microsoft.VisualBasic</AssemblyName>
        <AssemblyVersion>10.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Attributes>
        <Attribute>
          <AttributeName>System.Security.SecuritySafeCritical</AttributeName>
        </Attribute>
      </Attributes>
      <ReturnValue>
        <ReturnType>System.Int32</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="PathName" Type="System.String" />
        <Parameter Name="Style" Type="Microsoft.VisualBasic.AppWinStyle" />
        <Parameter Name="Wait" Type="System.Boolean" />
        <Parameter Name="Timeout" Type="System.Int32" />
      </Parameters>
      <Docs>
        <param name="PathName">
          <span data-ttu-id="978c1-601">必须的。</span>
          <span class="sxs-lookup">
            <span data-stu-id="978c1-601">Required.</span>
          </span>
          <span data-ttu-id="978c1-602">
            <see langword="String" />。</span>
          <span class="sxs-lookup">
            <span data-stu-id="978c1-602">
              <see langword="String" />.</span>
          </span>
          <span data-ttu-id="978c1-603">要执行的程序的名称，以及所有必需的参数和命令行开关。</span>
          <span class="sxs-lookup">
            <span data-stu-id="978c1-603">Name of the program to execute, together with any required arguments and command-line switches.</span>
          </span>
          <span data-ttu-id="978c1-604">
            <c>PathName</c> 也可以包含驱动器和目录路径或文件夹。</span>
          <span class="sxs-lookup">
            <span data-stu-id="978c1-604">
              <c>PathName</c> can also include the drive and the directory path or folder.</span>
          </span>
          <span data-ttu-id="978c1-605">如果不知道程序的路径，则可以使用 <see cref="Overload:Microsoft.VisualBasic.FileIO.FileSystem.GetFiles" /> 进行定位。</span>
          <span class="sxs-lookup">
            <span data-stu-id="978c1-605">If you do not know the path to the program, you can use the <see cref="Overload:Microsoft.VisualBasic.FileIO.FileSystem.GetFiles" /> to locate it.</span>
          </span>
          <span data-ttu-id="978c1-606">例如，你可以调用 <c>My.Computer.FileSystem.GetFiles("C:\", True, "testFile.txt")</c>，这将返回驱动器 C:\\ 上任意位置每个名为 <c>testFile.txt</c> 的文件的完整路径。</span>
          <span class="sxs-lookup">
            <span data-stu-id="978c1-606">For example, you can call <c>My.Computer.FileSystem.GetFiles("C:\", True, "testFile.txt")</c>, which returns the full path of every file named <c>testFile.txt</c> anywhere on drive C:\\.</span>
          </span>
        </param>
        <param name="Style">
          <span data-ttu-id="978c1-607">可选。</span>
          <span class="sxs-lookup">
            <span data-stu-id="978c1-607">Optional.</span>
          </span>
          <span data-ttu-id="978c1-608">
            <see langword="AppWinStyle" />。</span>
          <span class="sxs-lookup">
            <span data-stu-id="978c1-608">
              <see langword="AppWinStyle" />.</span>
          </span>
          <span data-ttu-id="978c1-609">从 <see cref="T:Microsoft.VisualBasic.AppWinStyle" /> 中选择的一个值，该值指定将要在其中运行程序的窗口的样式。</span>
          <span class="sxs-lookup">
            <span data-stu-id="978c1-609">A value chosen from the <see cref="T:Microsoft.VisualBasic.AppWinStyle" /> specifying the style of the window in which the program is to run.</span>
          </span>
          <span data-ttu-id="978c1-610">如果省略 <c>Style</c>，<see langword="Shell" /> 将使用 <see langword="AppWinStyle.MinimizedFocus" />启动最小化且带焦点的程序。</span>
          <span class="sxs-lookup">
            <span data-stu-id="978c1-610">If <c>Style</c> is omitted, <see langword="Shell" /> uses <see langword="AppWinStyle.MinimizedFocus" />, which starts the program minimized and with focus.</span>
          </span>
        </param>
        <param name="Wait">
          <span data-ttu-id="978c1-611">可选。</span>
          <span class="sxs-lookup">
            <span data-stu-id="978c1-611">Optional.</span>
          </span>
          <span data-ttu-id="978c1-612">
            <see langword="Boolean" />。</span>
          <span class="sxs-lookup">
            <span data-stu-id="978c1-612">
              <see langword="Boolean" />.</span>
          </span>
          <span data-ttu-id="978c1-613">一个指示 <see langword="Shell" /> 函数是否应等待程序完成的值。</span>
          <span class="sxs-lookup">
            <span data-stu-id="978c1-613">A value indicating whether the <see langword="Shell" /> function should wait for completion of the program.</span>
          </span>
          <span data-ttu-id="978c1-614">如果省略 <c>Wait</c>，则 <see langword="Shell" /> 将使用 <see langword="False" />。</span>
          <span class="sxs-lookup">
            <span data-stu-id="978c1-614">If <c>Wait</c> is omitted, <see langword="Shell" /> uses <see langword="False" />.</span>
          </span>
        </param>
        <param name="Timeout">
          <span data-ttu-id="978c1-615">可选。</span>
          <span class="sxs-lookup">
            <span data-stu-id="978c1-615">Optional.</span>
          </span>
          <span data-ttu-id="978c1-616">
            <see langword="Integer" />。</span>
          <span class="sxs-lookup">
            <span data-stu-id="978c1-616">
              <see langword="Integer" />.</span>
          </span>
          <span data-ttu-id="978c1-617">如果 <c>Wait</c> 为 <see langword="True" />，则为等待完成的毫秒数。</span>
          <span class="sxs-lookup">
            <span data-stu-id="978c1-617">The number of milliseconds to wait for completion if <c>Wait</c> is <see langword="True" />.</span>
          </span>
          <span data-ttu-id="978c1-618">如果省略 <c>Timeout</c>，则 <see langword="Shell" /> 使用 -1，表示没有超时并且 <see langword="Shell" /> 到程序结束时才返回。</span>
          <span class="sxs-lookup">
            <span data-stu-id="978c1-618">If <c>Timeout</c> is omitted, <see langword="Shell" /> uses -1, which means there is no timeout and <see langword="Shell" /> does not return until the program finishes.</span>
          </span>
          <span data-ttu-id="978c1-619">因此，如果省略 <c>Timeout</c> 或将其设置为 -1，则 <see langword="Shell" /> 可能永远不会将控件返回给你的程序。</span>
          <span class="sxs-lookup">
            <span data-stu-id="978c1-619">Therefore, if you omit <c>Timeout</c> or set it to -1, it is possible that <see langword="Shell" /> might never return control to your program.</span>
          </span>
        </param>
        <summary>
          <span data-ttu-id="978c1-620">运行一个可执行程序，并且如果该程序仍在运行则返回一个包含该程序的进程 ID 的整数。</span>
          <span class="sxs-lookup">
            <span data-stu-id="978c1-620">Runs an executable program and returns an integer containing the program's process ID if it is still running.</span>
          </span>
        </summary>
        <returns>
          <span data-ttu-id="978c1-621">运行一个可执行程序，并且如果该程序仍在运行则返回一个包含该程序的进程 ID 的整数。</span>
          <span class="sxs-lookup">
            <span data-stu-id="978c1-621">Runs an executable program and returns an integer containing the program's process ID if it is still running.</span>
          </span>
        </returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="978c1-622">返回值`Shell`函数取决于程序是否在名为`PathName`仍在执行时`Shell`返回。</span><span class="sxs-lookup"><span data-stu-id="978c1-622">The return value of the `Shell` function depends on whether the program named in `PathName` is still executing when `Shell` returns.</span></span> <span data-ttu-id="978c1-623">如果你设置`Wait`到`True`和在程序完成之前在超时到期，`Shell`返回零。</span><span class="sxs-lookup"><span data-stu-id="978c1-623">If you set `Wait` to `True` and the program finishes before the timeout expires, `Shell` returns zero.</span></span> <span data-ttu-id="978c1-624">如果在超时过期，或者如果省略`Wait`或将其设置为`False`，`Shell`返回该程序的进程 ID。</span><span class="sxs-lookup"><span data-stu-id="978c1-624">If the timeout expires, or if you omit `Wait` or set it to `False`, `Shell` returns the process ID of the program.</span></span> <span data-ttu-id="978c1-625">进程 ID 是唯一的编号标识正在运行的程序。</span><span class="sxs-lookup"><span data-stu-id="978c1-625">The process ID is a unique number that identifies the running program.</span></span>  
  
## <a name="failure-to-start"></a><span data-ttu-id="978c1-626">启动失败</span><span class="sxs-lookup"><span data-stu-id="978c1-626">Failure to Start</span></span>  
 <span data-ttu-id="978c1-627">如果`Shell`函数无法启动指定的程序中，<xref:System.IO.FileNotFoundException>发生错误。</span><span class="sxs-lookup"><span data-stu-id="978c1-627">If the `Shell` function cannot start the named program, a <xref:System.IO.FileNotFoundException> error occurs.</span></span> <span data-ttu-id="978c1-628">可以这样做，例如，如果尝试以运行是 16 位的程序，如`command.com`，从应用程序中使用<xref:System.Windows.Forms?displayProperty=nameWithType>。</span><span class="sxs-lookup"><span data-stu-id="978c1-628">This can happen, for example, when you attempt to run a 16-bit program, such as `command.com`, from an application using <xref:System.Windows.Forms?displayProperty=nameWithType>.</span></span> <span data-ttu-id="978c1-629">要解决此问题，你可以运行调用所需的 16 位程序的 32 位程序。</span><span class="sxs-lookup"><span data-stu-id="978c1-629">For a workaround, you can run a 32-bit program that calls the desired 16-bit program.</span></span> <span data-ttu-id="978c1-630">情况下`command.com`，你可以运行`cmd.exe`作为替代方法。</span><span class="sxs-lookup"><span data-stu-id="978c1-630">In the case of `command.com`, you can run `cmd.exe` as an alternative.</span></span>  
  
## <a name="waiting-for-completion"></a><span data-ttu-id="978c1-631">等待完成</span><span class="sxs-lookup"><span data-stu-id="978c1-631">Waiting for Completion</span></span>  
 <span data-ttu-id="978c1-632">默认情况下，`Shell`函数以异步方式运行程序。</span><span class="sxs-lookup"><span data-stu-id="978c1-632">By default, the `Shell` function runs the program asynchronously.</span></span> <span data-ttu-id="978c1-633">这意味着程序开始使用`Shell`函数可能无法完成执行之后的语句之前`Shell`执行函数。</span><span class="sxs-lookup"><span data-stu-id="978c1-633">This means that a program started with the `Shell` function might not finish executing before the statements following the `Shell` function are executed.</span></span> <span data-ttu-id="978c1-634">如果你想要等待计划完成，然后你继续，请设置`Wait`到`True`。</span><span class="sxs-lookup"><span data-stu-id="978c1-634">If you want to wait for the program to finish before you continue, set `Wait` to `True`.</span></span>  
  
## <a name="determining-the-exit-code"></a><span data-ttu-id="978c1-635">确定的退出代码</span><span class="sxs-lookup"><span data-stu-id="978c1-635">Determining the Exit Code</span></span>  
 <span data-ttu-id="978c1-636">进程可以返回*退出代码*终止时。</span><span class="sxs-lookup"><span data-stu-id="978c1-636">A process can return an *exit code* when it terminates.</span></span> <span data-ttu-id="978c1-637">但是，不能使用`Shell`检索此退出代码，因为`Shell`如果等待终止，则返回零，还因为进程运行在不同的对象中`Shell`。</span><span class="sxs-lookup"><span data-stu-id="978c1-637">However, you cannot use `Shell` to retrieve this exit code, because `Shell` returns zero if it waits for termination, and also because the process runs in a different object from `Shell`.</span></span>  
  
 <span data-ttu-id="978c1-638">若要检索的进程的退出代码，必须编写你自己的代码来启动过程并等待终止。</span><span class="sxs-lookup"><span data-stu-id="978c1-638">To retrieve the exit code from a process, you must write your own code to initiate the process and wait for termination.</span></span> <span data-ttu-id="978c1-639">下面的示例演示如何启动过程，等待它终止，然后检索其退出代码。</span><span class="sxs-lookup"><span data-stu-id="978c1-639">The following example shows how to initiate a process, wait for it to terminate, and retrieve its exit code.</span></span>  
  
```vb  
Dim procID As Integer  
Dim newProc As Diagnostics.Process  
newProc = Diagnostics.Process.Start("C:\WINDOWS\NOTEPAD.EXE")  
procID = newProc.Id  
newProc.WaitForExit()  
Dim procEC As Integer = -1  
If newProc.HasExited Then  
    procEC = newProc.ExitCode  
End If  
MsgBox("Process with ID " & CStr(ProcID) & _  
    " terminated with exit code " & CStr(procEC))  
```  
  
## <a name="protecting-the-file-specification"></a><span data-ttu-id="978c1-640">保护的文件规范</span><span class="sxs-lookup"><span data-stu-id="978c1-640">Protecting the File Specification</span></span>  
 <span data-ttu-id="978c1-641">如以下示例所示，应始终用引号引起来，将整个路径和文件名规范。</span><span class="sxs-lookup"><span data-stu-id="978c1-641">You should always enclose the entire path and file specification in quotation marks, as the following example shows.</span></span>  
  
```vb  
ID = Shell("""C:\Program Files\display.exe"" -a -q", , True, 100000)  
```  
  
 <span data-ttu-id="978c1-642">每对相邻两个双引号 (`" "`) 字符串内文本解释为字符串中的一个双引号字符。</span><span class="sxs-lookup"><span data-stu-id="978c1-642">Each pair of adjacent double quotation marks (`" "`) within the string literal is interpreted as one double quotation character in the string.</span></span> <span data-ttu-id="978c1-643">因此，前面的示例表示以下字符串到`Shell`函数：</span><span class="sxs-lookup"><span data-stu-id="978c1-643">Therefore, the preceding example presents the following string to the `Shell` function:</span></span>  
  
```console  
"C:\Program Files\display.exe" -a -q  
```  
  
 <span data-ttu-id="978c1-644">如果你没有用引号引起来的路径，Windows 将查找名为的文件`Program.exe`在 C:\ 目录中，而不是`display.exe`C:\Program Files 目录中。</span><span class="sxs-lookup"><span data-stu-id="978c1-644">If you did not have the path enclosed in quotation marks, Windows would look for a file called `Program.exe` in the C:\ directory, instead of `display.exe` in the C:\Program Files directory.</span></span>  
  
> [!IMPORTANT]
>  <span data-ttu-id="978c1-645">如果你不要将路径和文件名规范括在引号内，如果该文件名或路径节点包含空格将安全风险。</span><span class="sxs-lookup"><span data-stu-id="978c1-645">If you do not enclose the path and file specification in quotation marks, there is a security risk if the file name or a path node contains spaces.</span></span> <span data-ttu-id="978c1-646">在前面的示例中，路径节点`\Program Files`中包含空格。</span><span class="sxs-lookup"><span data-stu-id="978c1-646">In the preceding example, the path node `\Program Files` includes a space.</span></span> <span data-ttu-id="978c1-647">如果规范未在单引号中，名为的程序`Program.exe`已安装在 c:\\，例如通过非法篡改，Windows 将执行它而不是`display.exe`。</span><span class="sxs-lookup"><span data-stu-id="978c1-647">If the specification were not inside quotation marks and a program named `Program.exe` had been installed in C:\\, for example by illicit tampering, Windows would execute it instead of `display.exe`.</span></span>  
  
> [!IMPORTANT]
>  <span data-ttu-id="978c1-648">`Shell`函数需要非托管的代码的权限，这可能会影响在部分信任情况下其执行。</span><span class="sxs-lookup"><span data-stu-id="978c1-648">The `Shell` function requires unmanaged code permission, which might affect its execution in partial-trust situations.</span></span> <span data-ttu-id="978c1-649">有关详细信息，请参阅<xref:System.Security.Permissions.SecurityPermission>和[代码访问权限](http://msdn.microsoft.com/library/e5ae402f-6dda-4732-bbe8-77296630f675)。</span><span class="sxs-lookup"><span data-stu-id="978c1-649">For more information, see <xref:System.Security.Permissions.SecurityPermission> and [Code Access Permissions](http://msdn.microsoft.com/library/e5ae402f-6dda-4732-bbe8-77296630f675).</span></span>  
  
   
  
## Examples  
 <span data-ttu-id="978c1-650">下面的示例使用`Shell`要运行由用户指定的应用程序函数。</span><span class="sxs-lookup"><span data-stu-id="978c1-650">The following example uses the `Shell` function to run an application specified by the user.</span></span> <span data-ttu-id="978c1-651">指定<xref:Microsoft.VisualBasic.AppWinStyle.NormalFocus?displayProperty=nameWithType>为第二个自变量在正常大小中打开应用程序，并给予它焦点。</span><span class="sxs-lookup"><span data-stu-id="978c1-651">Specifying <xref:Microsoft.VisualBasic.AppWinStyle.NormalFocus?displayProperty=nameWithType> as the second argument opens the application in normal size and gives it the focus.</span></span>  
  
 [!code-vb[VbVbalrFunctions#47](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbalrFunctions/VB/Class1.vb#47)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentException">
          <span data-ttu-id="978c1-652">
            <paramref name="Style" /> 不在 0 到 9（包含 0 和 9）范围内。</span>
          <span class="sxs-lookup">
            <span data-stu-id="978c1-652">
              <paramref name="Style" /> is not within range 0 through 9, inclusive.</span>
          </span>
        </exception>
        <exception cref="T:System.IO.FileNotFoundException">
          <span data-ttu-id="978c1-653">
            <see langword="Shell" /> 找不到 <paramref name="PathName" /> 文件。</span>
          <span class="sxs-lookup">
            <span data-stu-id="978c1-653">
              <see langword="Shell" /> cannot find the <paramref name="PathName" /> file.</span>
          </span>
        </exception>
        <exception cref="T:System.NullReferenceException">
          <span data-ttu-id="978c1-654">
            <paramref name="PathName" /> 为 <see langword="Nothing" />。</span>
          <span class="sxs-lookup">
            <span data-stu-id="978c1-654">
              <paramref name="PathName" /> is <see langword="Nothing" />.</span>
          </span>
        </exception>
        <altmember cref="T:Microsoft.VisualBasic.AppWinStyle" />
        <altmember cref="T:System.ArgumentException" />
        <altmember cref="T:System.IO.FileNotFoundException" />
        <altmember cref="T:System.NullReferenceException" />
        <altmember cref="Overload:Microsoft.VisualBasic.FileIO.FileSystem.GetFiles" />
        <altmember cref="Overload:Microsoft.VisualBasic.Interaction.AppActivate" />
      </Docs>
    </Member>
    <Member MemberName="Switch">
      <MemberSignature Language="C#" Value="public static object Switch (params object[] VarExpr);" />
      <MemberSignature Language="ILAsm" Value=".method public static object Switch(object[] VarExpr) cil managed" />
      <MemberSignature Language="DocId" Value="M:Microsoft.VisualBasic.Interaction.Switch(System.Object[])" />
      <MemberSignature Language="VB.NET" Value="Public Function Switch (ParamArray VarExpr As Object()) As Object" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; static System::Object ^ Switch(... cli::array &lt;System::Object ^&gt; ^ VarExpr);" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>Microsoft.VisualBasic</AssemblyName>
        <AssemblyVersion>10.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Object</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="VarExpr" Type="System.Object[]">
          <Attributes>
            <Attribute>
              <AttributeName>System.ParamArray</AttributeName>
            </Attribute>
          </Attributes>
        </Parameter>
      </Parameters>
      <Docs>
        <param name="VarExpr">
          <span data-ttu-id="978c1-655">必须的。</span>
          <span class="sxs-lookup">
            <span data-stu-id="978c1-655">Required.</span>
          </span>
          <span data-ttu-id="978c1-656">
            <see langword="Object" /> 参数数组。</span>
          <span class="sxs-lookup">
            <span data-stu-id="978c1-656">
              <see langword="Object" /> parameter array.</span>
          </span>
          <span data-ttu-id="978c1-657">必须具有偶数个元素。</span>
          <span class="sxs-lookup">
            <span data-stu-id="978c1-657">Must have an even number of elements.</span>
          </span>
          <span data-ttu-id="978c1-658">可以提供以逗号分隔的 <see langword="Object" /> 变量或表达式的列表，或一维 <see langword="Object" /> 元素数组。</span>
          <span class="sxs-lookup">
            <span data-stu-id="978c1-658">You can supply a list of <see langword="Object" /> variables or expressions separated by commas, or a single-dimensional array of <see langword="Object" /> elements.</span>
          </span>
        </param>
        <summary>
          <span data-ttu-id="978c1-659">计算表达式列表，并返回与列表中第一个为 <see langword="Object" /> 的表达式对应的 <see langword="True" /> 值。</span>
          <span class="sxs-lookup">
            <span data-stu-id="978c1-659">Evaluates a list of expressions and returns an <see langword="Object" /> value corresponding to the first expression in the list that is <see langword="True" />.</span>
          </span>
        </summary>
        <returns>
          <span data-ttu-id="978c1-660">计算表达式列表，并返回与列表中第一个为 <see langword="Object" /> 的表达式对应的 <see langword="True" /> 值。</span>
          <span class="sxs-lookup">
            <span data-stu-id="978c1-660">Evaluates a list of expressions and returns an <see langword="Object" /> value corresponding to the first expression in the list that is <see langword="True" />.</span>
          </span>
        </returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="978c1-661">自变量提供给`VarExpr`成对的表达式和值组成。</span><span class="sxs-lookup"><span data-stu-id="978c1-661">The argument supplied to `VarExpr` consists of paired expressions and values.</span></span> <span data-ttu-id="978c1-662">`Switch`函数的计算结果奇数表达式从低到中的最高索引`VarExpr`，并返回与计算结果为第一个表达式相关联的偶数值`True`。</span><span class="sxs-lookup"><span data-stu-id="978c1-662">The `Switch` function evaluates the odd-numbered expressions from lowest to highest index in `VarExpr`, and returns the even-numbered value associated with the first expression that evaluates to `True`.</span></span> <span data-ttu-id="978c1-663">例如，如果`VarExpr(0)`是`True`，`Switch`返回`VarExpr(1)`，并且如果`VarExpr(0)`是`False`但`VarExpr(2)`是`True`，`Switch`返回`VarExpr(3)`，依次类推。</span><span class="sxs-lookup"><span data-stu-id="978c1-663">For example, if `VarExpr(0)` is `True`, `Switch` returns `VarExpr(1)`, and if `VarExpr(0)` is `False` but `VarExpr(2)` is `True`, `Switch` returns `VarExpr(3)`, and so on.</span></span>  
  
 <span data-ttu-id="978c1-664">如果未提供`VarExpr`自变量，`Switch`返回`Nothing`。</span><span class="sxs-lookup"><span data-stu-id="978c1-664">If you do not supply the `VarExpr` argument, `Switch` returns `Nothing`.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="978c1-665">自变量列表中的表达式可以包括函数调用。</span><span class="sxs-lookup"><span data-stu-id="978c1-665">The expressions in the argument list can include function calls.</span></span> <span data-ttu-id="978c1-666">作为准备调用的自变量列表的一部分`Switch`，Visual Basic 编译器在每个表达式中调用每个函数。</span><span class="sxs-lookup"><span data-stu-id="978c1-666">As part of preparing the argument list for the call to `Switch`, the Visual Basic compiler calls every function in every expression.</span></span> <span data-ttu-id="978c1-667">这意味着您不能依赖于特定函数参数列表中前面的表达式为时未调用`True`。</span><span class="sxs-lookup"><span data-stu-id="978c1-667">This means that you cannot rely on a particular function not being called if an expression earlier in the argument list is `True`.</span></span>  
  
   
  
## Examples  
 <span data-ttu-id="978c1-668">下面的示例使用`Switch`函数以返回与匹配的城市名称的语言的名称。</span><span class="sxs-lookup"><span data-stu-id="978c1-668">The following example uses the `Switch` function to return the name of a language that matches the name of a city.</span></span> <span data-ttu-id="978c1-669">它要求`Option Strict`是`Off`。</span><span class="sxs-lookup"><span data-stu-id="978c1-669">It requires that `Option Strict` be `Off`.</span></span>  
  
 [!code-vb[VbVbalrFunctions#48](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbalrFunctions/VB/Class1.vb#48)]  
  
 <span data-ttu-id="978c1-670">因为<xref:System.Diagnostics>命名空间还包含一个名为类<xref:System.Diagnostics.Switch>，调用`Switch`函数必须用限定<xref:Microsoft.VisualBasic>命名空间。</span><span class="sxs-lookup"><span data-stu-id="978c1-670">Because the <xref:System.Diagnostics> namespace also contains a class called <xref:System.Diagnostics.Switch>, a call to the `Switch` function must be qualified with the <xref:Microsoft.VisualBasic> namespace.</span></span>  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentException">
          <span data-ttu-id="978c1-671">参数数目为奇数。</span>
          <span class="sxs-lookup">
            <span data-stu-id="978c1-671">Number of arguments is odd.</span>
          </span>
        </exception>
        <altmember cref="M:Microsoft.VisualBasic.Interaction.Choose(System.Double,System.Object[])" />
        <altmember cref="M:Microsoft.VisualBasic.Interaction.IIf(System.Boolean,System.Object,System.Object)" />
      </Docs>
    </Member>
  </Members>
</Type>