<Type Name="InPlaceHostingManager" FullName="System.Deployment.Application.InPlaceHostingManager">
  <Metadata>
    <Meta Name="ms.openlocfilehash" Value="318b3adb922726e41d39a80b9e59598efbc9e92e" />
    <Meta Name="ms.sourcegitcommit" Value="4b4804968da1dfdf71c501075a5b66957b54f2e8" />
    <Meta Name="ms.translationtype" Value="HT" />
    <Meta Name="ms.contentlocale" Value="zh-CN" />
    <Meta Name="ms.lasthandoff" Value="04/27/2018" />
    <Meta Name="ms.locfileid" Value="32037165" />
  </Metadata>
  <TypeSignature Language="C#" Value="public class InPlaceHostingManager : IDisposable" />
  <TypeSignature Language="ILAsm" Value=".class public auto ansi beforefieldinit InPlaceHostingManager extends System.Object implements class System.IDisposable" />
  <TypeSignature Language="DocId" Value="T:System.Deployment.Application.InPlaceHostingManager" />
  <TypeSignature Language="VB.NET" Value="Public Class InPlaceHostingManager&#xA;Implements IDisposable" />
  <TypeSignature Language="C++ CLI" Value="public ref class InPlaceHostingManager : IDisposable" />
  <AssemblyInfo>
    <AssemblyName>System.Deployment</AssemblyName>
    <AssemblyVersion>4.0.0.0</AssemblyVersion>
  </AssemblyInfo>
  <Base>
    <BaseTypeName>System.Object</BaseTypeName>
  </Base>
  <Interfaces>
    <Interface>
      <InterfaceName>System.IDisposable</InterfaceName>
    </Interface>
  </Interfaces>
  <Docs>
    <summary>
      <span data-ttu-id="d45c4-101">在计算机上安装或更新 ClickOnce 部署。</span>
      <span class="sxs-lookup">
        <span data-stu-id="d45c4-101">Install or update a ClickOnce deployment on a computer.</span>
      </span>
    </summary>
    <remarks>
      <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="d45c4-102">你可以使用<xref:System.Deployment.Application.InPlaceHostingManager>编写程序该安装[!INCLUDE[ndptecclick](~/includes/ndptecclick-md.md)]应用程序以编程方式。</span><span class="sxs-lookup"><span data-stu-id="d45c4-102">You can use <xref:System.Deployment.Application.InPlaceHostingManager> to write programs that install [!INCLUDE[ndptecclick](~/includes/ndptecclick-md.md)] applications programmatically.</span></span> <span data-ttu-id="d45c4-103">例如，你可以在受控的系统管理软件 (SMS) 环境中或在需要将执行若干个在本地计算机上的预安装或安装后操作的复杂安装的情况下使用此类。</span><span class="sxs-lookup"><span data-stu-id="d45c4-103">For example, you can use this class in a controlled system management software (SMS) environment or in situations where you need a complex installation that performs a number of pre-installation or post-installation operations on the local computer.</span></span> <span data-ttu-id="d45c4-104">通常情况下，你将想要使用此类的成员以特定顺序：</span><span class="sxs-lookup"><span data-stu-id="d45c4-104">Generally, you will want to use the members of this class in a specific order:</span></span>  
  
1.  <span data-ttu-id="d45c4-105">创建 <xref:System.Deployment.Application.InPlaceHostingManager> 的一个新实例。</span><span class="sxs-lookup"><span data-stu-id="d45c4-105">Create a new instance of <xref:System.Deployment.Application.InPlaceHostingManager>.</span></span>  
  
2.  <span data-ttu-id="d45c4-106">通过下载部署清单<xref:System.Deployment.Application.InPlaceHostingManager.GetManifestAsync%2A>。</span><span class="sxs-lookup"><span data-stu-id="d45c4-106">Download the deployment manifest by using <xref:System.Deployment.Application.InPlaceHostingManager.GetManifestAsync%2A>.</span></span>  
  
3.  <span data-ttu-id="d45c4-107">应用程序可以通过运行具有相应权限的检查<xref:System.Deployment.Application.InPlaceHostingManager.AssertApplicationRequirements%2A>。</span><span class="sxs-lookup"><span data-stu-id="d45c4-107">Check that the application can be run with the appropriate permissions by using <xref:System.Deployment.Application.InPlaceHostingManager.AssertApplicationRequirements%2A>.</span></span>  
  
4.  <span data-ttu-id="d45c4-108">下载并安装该应用程序使用<xref:System.Deployment.Application.InPlaceHostingManager.DownloadApplicationAsync%2A>。</span><span class="sxs-lookup"><span data-stu-id="d45c4-108">Download and install the application by using <xref:System.Deployment.Application.InPlaceHostingManager.DownloadApplicationAsync%2A>.</span></span>  
  
-   <span data-ttu-id="d45c4-109">如果你调用任意这些参数无序，它们将引发异常。</span><span class="sxs-lookup"><span data-stu-id="d45c4-109">If you call any of these parameters out of order, they will throw an exception.</span></span>  
  
 <span data-ttu-id="d45c4-110"><xref:System.Deployment.Application.InPlaceHostingManager> 可以安装[!INCLUDE[ndptecclick](~/includes/ndptecclick-md.md)]应用程序，但是不能执行它。</span><span class="sxs-lookup"><span data-stu-id="d45c4-110"><xref:System.Deployment.Application.InPlaceHostingManager> can install a [!INCLUDE[ndptecclick](~/includes/ndptecclick-md.md)] application, but cannot execute it.</span></span> <span data-ttu-id="d45c4-111">一些方法在此类，如<xref:System.Deployment.Application.InPlaceHostingManager.Execute%2A>，仅供使用下载基于 Windows Presentation Foundation 应用程序，在 Web 浏览器中运行时。</span><span class="sxs-lookup"><span data-stu-id="d45c4-111">Some methods in this class, such as <xref:System.Deployment.Application.InPlaceHostingManager.Execute%2A>, are reserved for use when downloading a Windows Presentation Foundation-based application that runs inside a Web browser.</span></span>  
  
 <span data-ttu-id="d45c4-112">若要使用<xref:System.Deployment.Application.InPlaceHostingManager>要下载并安装应用程序，你必须确保证书以签署[!INCLUDE[ndptecclick](~/includes/ndptecclick-md.md)]你打算安装的应用程序为受信任的发布服务器已安装客户端计算机上。</span><span class="sxs-lookup"><span data-stu-id="d45c4-112">To use <xref:System.Deployment.Application.InPlaceHostingManager> to download and install applications, you must make sure that the certificate for signing the [!INCLUDE[ndptecclick](~/includes/ndptecclick-md.md)] applications you plan to install is already installed on client computers as a trusted publisher.</span></span> <span data-ttu-id="d45c4-113">受信任的发布服务器上的详细信息，请参阅[受信任的应用程序部署概述](http://msdn.microsoft.com/library/b24a1702-8fbe-45b1-87a0-9618a0708f1d)。</span><span class="sxs-lookup"><span data-stu-id="d45c4-113">For more information on trusted publishers, see [Trusted Application Deployment Overview](http://msdn.microsoft.com/library/b24a1702-8fbe-45b1-87a0-9618a0708f1d).</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="d45c4-114">当前没有可防止产品限制<xref:System.Deployment.Application.InPlaceHostingManager>从调试代码使用 Visual Studio 时正常工作。</span><span class="sxs-lookup"><span data-stu-id="d45c4-114">There is currently a product limitation that prevents <xref:System.Deployment.Application.InPlaceHostingManager> from working correctly when you debug your code using Visual Studio.</span></span> <span data-ttu-id="d45c4-115">如果使用 F5 键调试应用程序在 Visual Studio 中的，在调用时，该示例将引发不明原因的异常<xref:System.Deployment.Application.InPlaceHostingManager.DownloadApplicationAsync%2A>。</span><span class="sxs-lookup"><span data-stu-id="d45c4-115">If you debug your application in Visual Studio by using the F5 key, the sample will throw mysterious exceptions when you call <xref:System.Deployment.Application.InPlaceHostingManager.DownloadApplicationAsync%2A>.</span></span> <span data-ttu-id="d45c4-116">使用 Visual Studio 进行调试，而不进行调试，启动应用程序，然后附加调试器。</span><span class="sxs-lookup"><span data-stu-id="d45c4-116">To debug using Visual Studio, start the application without debugging, and then attach the debugger.</span></span> <span data-ttu-id="d45c4-117">或者，你可以使用另一个调试器，WinDbg 等。</span><span class="sxs-lookup"><span data-stu-id="d45c4-117">Alternatively, you can use another debugger, such as WinDbg.</span></span>  
  
   
  
## Examples  
 <span data-ttu-id="d45c4-118">下面的代码示例演示如何使用<xref:System.Deployment.Application.InPlaceHostingManager>安装[!INCLUDE[ndptecclick](~/includes/ndptecclick-md.md)]以编程方式在客户端计算机上应用程序。</span><span class="sxs-lookup"><span data-stu-id="d45c4-118">The following code example shows how to use <xref:System.Deployment.Application.InPlaceHostingManager> to install a [!INCLUDE[ndptecclick](~/includes/ndptecclick-md.md)] application programmatically on a client computer.</span></span>  
  
 [!code-csharp[System.Deployment.Application.InPlaceHostingManager#1](~/samples/snippets/csharp/VS_Snippets_Winforms/System.Deployment.Application.InPlaceHostingManager/CS/Form1.cs#1)]
 [!code-vb[System.Deployment.Application.InPlaceHostingManager#1](~/samples/snippets/visualbasic/VS_Snippets_Winforms/System.Deployment.Application.InPlaceHostingManager/VB/Form1.vb#1)]  
  
 ]]></format>
    </remarks>
  </Docs>
  <Members>
    <MemberGroup MemberName=".ctor">
      <AssemblyInfo>
        <AssemblyName>System.Deployment</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Docs>
        <summary>
          <span data-ttu-id="d45c4-119">创建 <see cref="T:System.Deployment.Application.InPlaceHostingManager" /> 的一个新实例以下载和安装指定的应用程序。</span>
          <span class="sxs-lookup">
            <span data-stu-id="d45c4-119">Creates a new instance of <see cref="T:System.Deployment.Application.InPlaceHostingManager" /> to download and install the specified application.</span>
          </span>
        </summary>
      </Docs>
    </MemberGroup>
    <Member MemberName=".ctor">
      <MemberSignature Language="C#" Value="public InPlaceHostingManager (Uri deploymentManifest);" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig specialname rtspecialname instance void .ctor(class System.Uri deploymentManifest) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Deployment.Application.InPlaceHostingManager.#ctor(System.Uri)" />
      <MemberSignature Language="VB.NET" Value="Public Sub New (deploymentManifest As Uri)" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; InPlaceHostingManager(Uri ^ deploymentManifest);" />
      <MemberType>Constructor</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Deployment</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Parameters>
        <Parameter Name="deploymentManifest" Type="System.Uri" />
      </Parameters>
      <Docs>
        <param name="deploymentManifest">
          <span data-ttu-id="d45c4-120">指向 [!INCLUDE[ndptecclick](~/includes/ndptecclick-md.md)] 应用程序的部署清单的统一资源标识符 (<see cref="T:System.Uri" />)。</span>
          <span class="sxs-lookup">
            <span data-stu-id="d45c4-120">A Uniform Resource Identifier (<see cref="T:System.Uri" />) to a [!INCLUDE[ndptecclick](~/includes/ndptecclick-md.md)] application's deployment manifest.</span>
          </span>
        </param>
        <summary>
          <span data-ttu-id="d45c4-121">创建 <see cref="T:System.Deployment.Application.InPlaceHostingManager" /> 的一个新实例以下载和安装浏览器承载的指定应用程序。</span>
          <span class="sxs-lookup">
            <span data-stu-id="d45c4-121">Creates a new instance of <see cref="T:System.Deployment.Application.InPlaceHostingManager" /> to download and install the specified browser-hosted application.</span>
          </span>
        </summary>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="d45c4-122">当你想要下载的基于 Windows Presentation Foundation 应用程序托管在 Web 浏览器中使用此构造函数。</span><span class="sxs-lookup"><span data-stu-id="d45c4-122">This constructor is used when you want to download a Windows Presentation Foundation-based application that is hosted in a Web browser.</span></span> <span data-ttu-id="d45c4-123">若要下载的基于 Windows 窗体的应用程序使用部署[!INCLUDE[ndptecclick](~/includes/ndptecclick-md.md)]，使用<xref:System.Deployment.Application.InPlaceHostingManager.%23ctor%2A>具有构造函数`launchInHostProcess`参数设置为`false`。</span><span class="sxs-lookup"><span data-stu-id="d45c4-123">To download Windows Forms-based applications that are deployed using [!INCLUDE[ndptecclick](~/includes/ndptecclick-md.md)], use the <xref:System.Deployment.Application.InPlaceHostingManager.%23ctor%2A> constructor with the `launchInHostProcess` parameter set to `false`.</span></span>  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.PlatformNotSupportedException">
          <span data-ttu-id="d45c4-124">
            <see cref="T:System.Deployment.Application.InPlaceHostingManager" /> 只能用于 Windows XP 或更高版本的 Windows 操作系统中。</span>
          <span class="sxs-lookup">
            <span data-stu-id="d45c4-124">
              <see cref="T:System.Deployment.Application.InPlaceHostingManager" /> can be used only in Windows XP or in later versions of the Windows operating system.</span>
          </span>
        </exception>
        <exception cref="T:System.ArgumentNullException">
          <span data-ttu-id="d45c4-125">无法为 <paramref name="deploymentManifest" /> 参数传递 <see langword="null" />。</span>
          <span class="sxs-lookup">
            <span data-stu-id="d45c4-125">Cannot pass <see langword="null" /> for the <paramref name="deploymentManifest" /> argument.</span>
          </span>
        </exception>
        <exception cref="T:System.ArgumentException">
          <span data-ttu-id="d45c4-126">
            <paramref name="deploymentManifest" /> 使用不受 [!INCLUDE[ndptecclick](~/includes/ndptecclick-md.md)] 支持的 URI 方案。</span>
          <span class="sxs-lookup">
            <span data-stu-id="d45c4-126">
              <paramref name="deploymentManifest" /> uses a URI scheme that is not supported by [!INCLUDE[ndptecclick](~/includes/ndptecclick-md.md)].</span>
          </span>
        </exception>
      </Docs>
    </Member>
    <Member MemberName=".ctor">
      <MemberSignature Language="C#" Value="public InPlaceHostingManager (Uri deploymentManifest, bool launchInHostProcess);" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig specialname rtspecialname instance void .ctor(class System.Uri deploymentManifest, bool launchInHostProcess) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Deployment.Application.InPlaceHostingManager.#ctor(System.Uri,System.Boolean)" />
      <MemberSignature Language="VB.NET" Value="Public Sub New (deploymentManifest As Uri, launchInHostProcess As Boolean)" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; InPlaceHostingManager(Uri ^ deploymentManifest, bool launchInHostProcess);" />
      <MemberType>Constructor</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Deployment</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Parameters>
        <Parameter Name="deploymentManifest" Type="System.Uri" />
        <Parameter Name="launchInHostProcess" Type="System.Boolean" />
      </Parameters>
      <Docs>
        <param name="deploymentManifest">
          <span data-ttu-id="d45c4-127">指向将安装的应用程序的部署清单的统一资源标识符 (URI)。</span>
          <span class="sxs-lookup">
            <span data-stu-id="d45c4-127">The Uniform Resource Identifier (URI) to the deployment manifest of the application that will be installed.</span>
          </span>
        </param>
        <param name="launchInHostProcess">
          <span data-ttu-id="d45c4-128">此应用程序是否将在主机（如 Web 浏览器）中运行。</span>
          <span class="sxs-lookup">
            <span data-stu-id="d45c4-128">Whether this application will be run in a host, such as a Web browser.</span>
          </span>
          <span data-ttu-id="d45c4-129">对于独立应用程序，将此值设置为 <see langword="false" />。</span>
          <span class="sxs-lookup">
            <span data-stu-id="d45c4-129">For a stand-alone application, set this value to <see langword="false" />.</span>
          </span>
        </param>
        <summary>
          <span data-ttu-id="d45c4-130">创建 <see cref="T:System.Deployment.Application.InPlaceHostingManager" /> 的一个新实例以下载和安装指定的应用程序，该应用程序可以是基于 Windows 窗体的独立应用程序，也可以是承载在 Web 浏览器中的应用程序。</span>
          <span class="sxs-lookup">
            <span data-stu-id="d45c4-130">Creates a new instance of <see cref="T:System.Deployment.Application.InPlaceHostingManager" /> to download and install the specified application, which can be either a stand-alone Windows Forms-based application or an application hosted in a Web browser.</span>
          </span>
        </summary>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Examples  
 <span data-ttu-id="d45c4-131">下面的代码示例演示如何创建的实例<xref:System.Deployment.Application.InPlaceHostingManager>，可以从下载基于 Windows 窗体的应用程序使用部署[!INCLUDE[ndptecclick](~/includes/ndptecclick-md.md)]。</span><span class="sxs-lookup"><span data-stu-id="d45c4-131">The following code example demonstrates how to create an instance of <xref:System.Deployment.Application.InPlaceHostingManager> that allows you to download Windows Forms-based applications deployed using [!INCLUDE[ndptecclick](~/includes/ndptecclick-md.md)].</span></span>  
  
 [!code-csharp[System.Deployment.Application.InPlaceHostingManager#2](~/samples/snippets/csharp/VS_Snippets_Winforms/System.Deployment.Application.InPlaceHostingManager/CS/Form1.cs#2)]
 [!code-vb[System.Deployment.Application.InPlaceHostingManager#2](~/samples/snippets/visualbasic/VS_Snippets_Winforms/System.Deployment.Application.InPlaceHostingManager/VB/Form1.vb#2)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.PlatformNotSupportedException">
          <span data-ttu-id="d45c4-132">
            <see cref="T:System.Deployment.Application.InPlaceHostingManager" /> 只能用于 Windows XP 或更高版本的 Windows 操作系统中。</span>
          <span class="sxs-lookup">
            <span data-stu-id="d45c4-132">
              <see cref="T:System.Deployment.Application.InPlaceHostingManager" /> can be used only in Windows XP or in later versions of the Windows operating system.</span>
          </span>
        </exception>
        <exception cref="T:System.ArgumentNullException">
          <span data-ttu-id="d45c4-133">无法为 <paramref name="deploymentManifest" /> 参数传递 <see langword="null" />。</span>
          <span class="sxs-lookup">
            <span data-stu-id="d45c4-133">Cannot pass <see langword="null" /> for the <paramref name="deploymentManifest" /> argument.</span>
          </span>
        </exception>
        <exception cref="T:System.ArgumentException">
          <span data-ttu-id="d45c4-134">
            <paramref name="deploymentManifest" /> 使用不受 [!INCLUDE[ndptecclick](~/includes/ndptecclick-md.md)] 支持的 URI 方案。</span>
          <span class="sxs-lookup">
            <span data-stu-id="d45c4-134">
              <paramref name="deploymentManifest" /> uses a URI scheme that is not supported by [!INCLUDE[ndptecclick](~/includes/ndptecclick-md.md)].</span>
          </span>
        </exception>
      </Docs>
    </Member>
    <MemberGroup MemberName="AssertApplicationRequirements">
      <AssemblyInfo>
        <AssemblyName>System.Deployment</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Docs>
        <summary>
          <span data-ttu-id="d45c4-135">确定 ClickOnce 应用程序是否具有合适的权限和平台依赖项，以便在本地计算机上运行。</span>
          <span class="sxs-lookup">
            <span data-stu-id="d45c4-135">Determines whether the ClickOnce application has the appropriate permissions and platform dependencies to run on the local computer.</span>
          </span>
        </summary>
      </Docs>
    </MemberGroup>
    <Member MemberName="AssertApplicationRequirements">
      <MemberSignature Language="C#" Value="public void AssertApplicationRequirements ();" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig instance void AssertApplicationRequirements() cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Deployment.Application.InPlaceHostingManager.AssertApplicationRequirements" />
      <MemberSignature Language="VB.NET" Value="Public Sub AssertApplicationRequirements ()" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; void AssertApplicationRequirements();" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Deployment</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Void</ReturnType>
      </ReturnValue>
      <Parameters />
      <Docs>
        <summary>
          <span data-ttu-id="d45c4-136">确定 [!INCLUDE[ndptecclick](~/includes/ndptecclick-md.md)] 应用程序是否具有合适的权限和平台依赖项，以便在本地计算机上运行。</span>
          <span class="sxs-lookup">
            <span data-stu-id="d45c4-136">Determines whether the [!INCLUDE[ndptecclick](~/includes/ndptecclick-md.md)] application has the appropriate permissions and platform dependencies to run on the local computer.</span>
          </span>
        </summary>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="d45c4-137">必须调用<xref:System.Deployment.Application.InPlaceHostingManager.AssertApplicationRequirements%2A>后<xref:System.Deployment.Application.InPlaceHostingManager.GetManifestAsync%2A>成功返回。</span><span class="sxs-lookup"><span data-stu-id="d45c4-137">You must call <xref:System.Deployment.Application.InPlaceHostingManager.AssertApplicationRequirements%2A> after <xref:System.Deployment.Application.InPlaceHostingManager.GetManifestAsync%2A> returns successfully.</span></span> <span data-ttu-id="d45c4-138">您不能调用<xref:System.Deployment.Application.InPlaceHostingManager.DownloadApplicationAsync%2A>除非调用<xref:System.Deployment.Application.InPlaceHostingManager.AssertApplicationRequirements%2A>，并无错误返回。</span><span class="sxs-lookup"><span data-stu-id="d45c4-138">You must not call <xref:System.Deployment.Application.InPlaceHostingManager.DownloadApplicationAsync%2A> unless you call <xref:System.Deployment.Application.InPlaceHostingManager.AssertApplicationRequirements%2A>, and it returns without error.</span></span>  
  
   
  
## Examples  
 <span data-ttu-id="d45c4-139">下面的代码示例演示如何将<xref:System.Deployment.Application.InPlaceHostingManager.AssertApplicationRequirements%2A>，它调用了成功的正文中<xref:System.Deployment.Application.InPlaceHostingManager.GetManifestCompleted>事件处理程序。</span><span class="sxs-lookup"><span data-stu-id="d45c4-139">The following code example demonstrates the use of <xref:System.Deployment.Application.InPlaceHostingManager.AssertApplicationRequirements%2A>, which it calls in the body of a successful <xref:System.Deployment.Application.InPlaceHostingManager.GetManifestCompleted> event handler.</span></span>  
  
 [!code-csharp[System.Deployment.Application.InPlaceHostingManager#3](~/samples/snippets/csharp/VS_Snippets_Winforms/System.Deployment.Application.InPlaceHostingManager/CS/Form1.cs#3)]
 [!code-vb[System.Deployment.Application.InPlaceHostingManager#3](~/samples/snippets/visualbasic/VS_Snippets_Winforms/System.Deployment.Application.InPlaceHostingManager/VB/Form1.vb#3)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.InvalidOperationException">
          <span data-ttu-id="d45c4-140">在 <see cref="M:System.Deployment.Application.InPlaceHostingManager.GetManifestAsync" /> 方法之前调用此方法时引发。</span>
          <span class="sxs-lookup">
            <span data-stu-id="d45c4-140">Raised if this method is called before the <see cref="M:System.Deployment.Application.InPlaceHostingManager.GetManifestAsync" /> method.</span>
          </span>
        </exception>
      </Docs>
    </Member>
    <Member MemberName="AssertApplicationRequirements">
      <MemberSignature Language="C#" Value="public void AssertApplicationRequirements (bool grantApplicationTrust);" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig instance void AssertApplicationRequirements(bool grantApplicationTrust) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Deployment.Application.InPlaceHostingManager.AssertApplicationRequirements(System.Boolean)" />
      <MemberSignature Language="VB.NET" Value="Public Sub AssertApplicationRequirements (grantApplicationTrust As Boolean)" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; void AssertApplicationRequirements(bool grantApplicationTrust);" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Deployment</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Void</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="grantApplicationTrust" Type="System.Boolean" />
      </Parameters>
      <Docs>
        <param name="grantApplicationTrust">
          <span data-ttu-id="d45c4-141">如果为 <see langword="true" />，应用程序将尝试将其权限提升至所需级别。</span>
          <span class="sxs-lookup">
            <span data-stu-id="d45c4-141">If <see langword="true" />, the application will attempt to elevate its permissions to the required level.</span>
          </span>
        </param>
        <summary>
          <span data-ttu-id="d45c4-142">确定 [!INCLUDE[ndptecclick](~/includes/ndptecclick-md.md)] 应用程序是否具有合适的权限和平台依赖项，以便在本地计算机上运行。</span>
          <span class="sxs-lookup">
            <span data-stu-id="d45c4-142">Determines whether the [!INCLUDE[ndptecclick](~/includes/ndptecclick-md.md)] application has the appropriate permissions and platform dependencies to run on the local computer.</span>
          </span>
        </summary>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="d45c4-143">如果`grantApplicationTrust`是`true`，<xref:System.Deployment.Application.InPlaceHostingManager>将授予应用程序提升的权限是否需要它们。</span><span class="sxs-lookup"><span data-stu-id="d45c4-143">If `grantApplicationTrust` is `true`, <xref:System.Deployment.Application.InPlaceHostingManager> will grant the application elevated permissions if it requires them.</span></span> <span data-ttu-id="d45c4-144">这种情况只有<xref:System.Deployment.Application.InPlaceHostingManager>能够授予这些权限。</span><span class="sxs-lookup"><span data-stu-id="d45c4-144">This is only possible if <xref:System.Deployment.Application.InPlaceHostingManager> is able to grant those permissions.</span></span> <span data-ttu-id="d45c4-145">例如，如果[!INCLUDE[ndptecclick](~/includes/ndptecclick-md.md)]应用程序正在安装作为更大的包的一部分，并且安装程序已被授予完全信任，<xref:System.Deployment.Application.InPlaceHostingManager>将能够授予[!INCLUDE[ndptecclick](~/includes/ndptecclick-md.md)]应用程序完全信任。</span><span class="sxs-lookup"><span data-stu-id="d45c4-145">For example, if a [!INCLUDE[ndptecclick](~/includes/ndptecclick-md.md)] application is being installed as part of a larger package and the installer has been granted full trust, <xref:System.Deployment.Application.InPlaceHostingManager> will be able to grant the [!INCLUDE[ndptecclick](~/includes/ndptecclick-md.md)] application full trust.</span></span> <span data-ttu-id="d45c4-146">如果`grantApplicationTrust`是`false`，应用程序将不授予任何权限。</span><span class="sxs-lookup"><span data-stu-id="d45c4-146">If `grantApplicationTrust` is `false`, the application will not be granted any permissions.</span></span>  
  
 ]]></format>
        </remarks>
      </Docs>
    </Member>
    <Member MemberName="CancelAsync">
      <MemberSignature Language="C#" Value="public void CancelAsync ();" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig instance void CancelAsync() cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Deployment.Application.InPlaceHostingManager.CancelAsync" />
      <MemberSignature Language="VB.NET" Value="Public Sub CancelAsync ()" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; void CancelAsync();" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Deployment</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Void</ReturnType>
      </ReturnValue>
      <Parameters />
      <Docs>
        <summary>
          <span data-ttu-id="d45c4-147">取消异步下载操作。</span>
          <span class="sxs-lookup">
            <span data-stu-id="d45c4-147">Cancels an asynchronous download operation.</span>
          </span>
        </summary>
        <remarks>To be added.</remarks>
      </Docs>
    </Member>
    <Member MemberName="Dispose">
      <MemberSignature Language="C#" Value="public void Dispose ();" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig newslot virtual instance void Dispose() cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Deployment.Application.InPlaceHostingManager.Dispose" />
      <MemberSignature Language="VB.NET" Value="Public Sub Dispose ()" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; virtual void Dispose();" />
      <MemberType>Method</MemberType>
      <Implements>
        <InterfaceMember>M:System.IDisposable.Dispose</InterfaceMember>
      </Implements>
      <AssemblyInfo>
        <AssemblyName>System.Deployment</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Void</ReturnType>
      </ReturnValue>
      <Parameters />
      <Docs>
        <summary>
          <span data-ttu-id="d45c4-148">释放由 <see cref="T:System.Deployment.Application.InPlaceHostingManager" /> 使用的所有资源。</span>
          <span class="sxs-lookup">
            <span data-stu-id="d45c4-148">Releases all resources used by the <see cref="T:System.Deployment.Application.InPlaceHostingManager" />.</span>
          </span>
        </summary>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="d45c4-149">在完成使用 <xref:System.Deployment.Application.InPlaceHostingManager.Dispose%2A> 后，应调用 <xref:System.Deployment.Application.InPlaceHostingManager>。</span><span class="sxs-lookup"><span data-stu-id="d45c4-149">Call <xref:System.Deployment.Application.InPlaceHostingManager.Dispose%2A> when you are finished using the <xref:System.Deployment.Application.InPlaceHostingManager>.</span></span> <span data-ttu-id="d45c4-150"><xref:System.Deployment.Application.InPlaceHostingManager.Dispose%2A> 方法使 <xref:System.Deployment.Application.InPlaceHostingManager> 处于不可用状态。</span><span class="sxs-lookup"><span data-stu-id="d45c4-150">The <xref:System.Deployment.Application.InPlaceHostingManager.Dispose%2A> method leaves the <xref:System.Deployment.Application.InPlaceHostingManager> in an unusable state.</span></span> <span data-ttu-id="d45c4-151">在调用<xref:System.Deployment.Application.InPlaceHostingManager.Dispose%2A>，必须释放对所有引用<xref:System.Deployment.Application.InPlaceHostingManager>以便垃圾回收器才能回收的内存，<xref:System.Deployment.Application.InPlaceHostingManager>占用。</span><span class="sxs-lookup"><span data-stu-id="d45c4-151">After calling <xref:System.Deployment.Application.InPlaceHostingManager.Dispose%2A>, you must release all references to the <xref:System.Deployment.Application.InPlaceHostingManager> so the garbage collector can reclaim the memory that the <xref:System.Deployment.Application.InPlaceHostingManager> was occupying.</span></span> <span data-ttu-id="d45c4-152">有关详细信息，请参阅[清洗向上非托管资源](~/docs/standard/garbage-collection/unmanaged.md)和[实现 Dispose 方法](~/docs/standard/garbage-collection/implementing-dispose.md)。</span><span class="sxs-lookup"><span data-stu-id="d45c4-152">For more information, see [Cleaning Up Unmanaged Resources](~/docs/standard/garbage-collection/unmanaged.md) and [Implementing a Dispose Method](~/docs/standard/garbage-collection/implementing-dispose.md).</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="d45c4-153">每次释放对 <xref:System.Deployment.Application.InPlaceHostingManager.Dispose%2A> 的最后一个引用前，均应调用 <xref:System.Deployment.Application.InPlaceHostingManager>。</span><span class="sxs-lookup"><span data-stu-id="d45c4-153">Always call <xref:System.Deployment.Application.InPlaceHostingManager.Dispose%2A> before you release your last reference to the <xref:System.Deployment.Application.InPlaceHostingManager>.</span></span> <span data-ttu-id="d45c4-154">否则，在垃圾回收器调用 <xref:System.Deployment.Application.InPlaceHostingManager> 对象的 `Finalize` 方法之前，该对象正在使用的资源不会被释放。</span><span class="sxs-lookup"><span data-stu-id="d45c4-154">Otherwise, the resources it is using will not be freed until the garbage collector calls the <xref:System.Deployment.Application.InPlaceHostingManager> object's `Finalize` method.</span></span>  
  
 ]]></format>
        </remarks>
      </Docs>
    </Member>
    <Member MemberName="DownloadApplicationAsync">
      <MemberSignature Language="C#" Value="public void DownloadApplicationAsync ();" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig instance void DownloadApplicationAsync() cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Deployment.Application.InPlaceHostingManager.DownloadApplicationAsync" />
      <MemberSignature Language="VB.NET" Value="Public Sub DownloadApplicationAsync ()" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; void DownloadApplicationAsync();" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Deployment</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Void</ReturnType>
      </ReturnValue>
      <Parameters />
      <Docs>
        <summary>
          <span data-ttu-id="d45c4-155">在后台下载应用程序更新。</span>
          <span class="sxs-lookup">
            <span data-stu-id="d45c4-155">Downloads an application update in the background.</span>
          </span>
        </summary>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="d45c4-156">你必须调用此方法之后调用<xref:System.Deployment.Application.InPlaceHostingManager.AssertApplicationRequirements%2A>。</span><span class="sxs-lookup"><span data-stu-id="d45c4-156">You must call this method after calling <xref:System.Deployment.Application.InPlaceHostingManager.AssertApplicationRequirements%2A>.</span></span>  
  
   
  
## Examples  
 <span data-ttu-id="d45c4-157">下面的代码示例演示如何将<xref:System.Deployment.Application.InPlaceHostingManager.DownloadApplicationAsync%2A>，它调用的成功末尾<xref:System.Deployment.Application.InPlaceHostingManager.GetManifestCompleted>事件处理程序。</span><span class="sxs-lookup"><span data-stu-id="d45c4-157">The following code example demonstrates the use of <xref:System.Deployment.Application.InPlaceHostingManager.DownloadApplicationAsync%2A>, which it calls at the end of a successful <xref:System.Deployment.Application.InPlaceHostingManager.GetManifestCompleted> event handler.</span></span>  
  
 <span data-ttu-id="d45c4-158">下面的代码示例假定已定义并已创建的实例<xref:System.Deployment.Application.InPlaceHostingManager>名为`iphm`。</span><span class="sxs-lookup"><span data-stu-id="d45c4-158">The following code examples assume that you have already defined and created an instance of <xref:System.Deployment.Application.InPlaceHostingManager> named `iphm`.</span></span>  
  
 [!code-csharp[System.Deployment.Application.InPlaceHostingManager#3](~/samples/snippets/csharp/VS_Snippets_Winforms/System.Deployment.Application.InPlaceHostingManager/CS/Form1.cs#3)]
 [!code-vb[System.Deployment.Application.InPlaceHostingManager#3](~/samples/snippets/visualbasic/VS_Snippets_Winforms/System.Deployment.Application.InPlaceHostingManager/VB/Form1.vb#3)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.InvalidOperationException">
          <span data-ttu-id="d45c4-159">在 <see cref="M:System.Deployment.Application.InPlaceHostingManager.GetManifestAsync" /> 和 <see cref="M:System.Deployment.Application.InPlaceHostingManager.AssertApplicationRequirements" /> 方法之前调用此方法时引发。</span>
          <span class="sxs-lookup">
            <span data-stu-id="d45c4-159">Raised if this method is called before the <see cref="M:System.Deployment.Application.InPlaceHostingManager.GetManifestAsync" /> and <see cref="M:System.Deployment.Application.InPlaceHostingManager.AssertApplicationRequirements" /> methods.</span>
          </span>
        </exception>
      </Docs>
    </Member>
    <Member MemberName="DownloadApplicationCompleted">
      <MemberSignature Language="C#" Value="public event EventHandler&lt;System.Deployment.Application.DownloadApplicationCompletedEventArgs&gt; DownloadApplicationCompleted;" />
      <MemberSignature Language="ILAsm" Value=".event class System.EventHandler`1&lt;class System.Deployment.Application.DownloadApplicationCompletedEventArgs&gt; DownloadApplicationCompleted" />
      <MemberSignature Language="DocId" Value="E:System.Deployment.Application.InPlaceHostingManager.DownloadApplicationCompleted" />
      <MemberSignature Language="VB.NET" Value="Public Event DownloadApplicationCompleted As EventHandler(Of DownloadApplicationCompletedEventArgs) " />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; event EventHandler&lt;System::Deployment::Application::DownloadApplicationCompletedEventArgs ^&gt; ^ DownloadApplicationCompleted;" />
      <MemberType>Event</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Deployment</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.EventHandler&lt;System.Deployment.Application.DownloadApplicationCompletedEventArgs&gt;</ReturnType>
      </ReturnValue>
      <Docs>
        <summary>
          <span data-ttu-id="d45c4-160">应用程序向本地计算机下载完成时发生。</span>
          <span class="sxs-lookup">
            <span data-stu-id="d45c4-160">Occurs when the application has finished downloading to the local computer.</span>
          </span>
        </summary>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="d45c4-161">如果你安装基于 Windows 窗体的应用程序，你将需要指示用户启动应用程序本身;你无法以编程方式启动基于 Windows 窗体的应用程序使用<xref:System.Deployment.Application.InPlaceHostingManager.Execute%2A>方法。</span><span class="sxs-lookup"><span data-stu-id="d45c4-161">If you are installing a Windows Forms-based application, you will need to instruct users to launch the application themselves; you cannot start Windows Forms-based applications programmatically by using the <xref:System.Deployment.Application.InPlaceHostingManager.Execute%2A> method.</span></span>  
  
   
  
## Examples  
 <span data-ttu-id="d45c4-162">下面的代码示例演示的处理程序<xref:System.Deployment.Application.InPlaceHostingManager.DownloadApplicationCompleted>事件。</span><span class="sxs-lookup"><span data-stu-id="d45c4-162">The following code example demonstrates a handler for the <xref:System.Deployment.Application.InPlaceHostingManager.DownloadApplicationCompleted> event.</span></span>  
  
 [!code-csharp[System.Deployment.Application.InPlaceHostingManager#7](~/samples/snippets/csharp/VS_Snippets_Winforms/System.Deployment.Application.InPlaceHostingManager/CS/Form1.cs#7)]
 [!code-vb[System.Deployment.Application.InPlaceHostingManager#7](~/samples/snippets/visualbasic/VS_Snippets_Winforms/System.Deployment.Application.InPlaceHostingManager/VB/Form1.vb#7)]  
  
 ]]></format>
        </remarks>
      </Docs>
    </Member>
    <Member MemberName="DownloadProgressChanged">
      <MemberSignature Language="C#" Value="public event EventHandler&lt;System.Deployment.Application.DownloadProgressChangedEventArgs&gt; DownloadProgressChanged;" />
      <MemberSignature Language="ILAsm" Value=".event class System.EventHandler`1&lt;class System.Deployment.Application.DownloadProgressChangedEventArgs&gt; DownloadProgressChanged" />
      <MemberSignature Language="DocId" Value="E:System.Deployment.Application.InPlaceHostingManager.DownloadProgressChanged" />
      <MemberSignature Language="VB.NET" Value="Public Event DownloadProgressChanged As EventHandler(Of DownloadProgressChangedEventArgs) " />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; event EventHandler&lt;System::Deployment::Application::DownloadProgressChangedEventArgs ^&gt; ^ DownloadProgressChanged;" />
      <MemberType>Event</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Deployment</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.EventHandler&lt;System.Deployment.Application.DownloadProgressChangedEventArgs&gt;</ReturnType>
      </ReturnValue>
      <Docs>
        <summary>
          <span data-ttu-id="d45c4-163">更改应用程序或清单下载状态时发生。</span>
          <span class="sxs-lookup">
            <span data-stu-id="d45c4-163">Occurs when there is a change in the status of an application or manifest download.</span>
          </span>
        </summary>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="d45c4-164">在控制台应用程序中，事件分配给线程池中的线程。</span><span class="sxs-lookup"><span data-stu-id="d45c4-164">In a console application, events are assigned to threads from a thread pool.</span></span> <span data-ttu-id="d45c4-165">因此，你可能会收到进度更新事件无序，与后续事件显示降低与之前的事件进行比较。</span><span class="sxs-lookup"><span data-stu-id="d45c4-165">Therefore, you might receive progress update events out of order, with a subsequent event showing a decrease compared with a previous event.</span></span> <span data-ttu-id="d45c4-166">不，您将看到在基于 Windows 窗体的应用程序，这种行为，因为 Windows 窗体中的事件从用户界面 (UI) 线程的消息队列按顺序处理。</span><span class="sxs-lookup"><span data-stu-id="d45c4-166">You will not see such behavior in a Windows Forms-based application, because events in Windows Forms are processed sequentially out of the user interface (UI) thread's message queue.</span></span>  
  
   
  
## Examples  
 <span data-ttu-id="d45c4-167">下面的代码示例演示如何更新<xref:System.Windows.Forms.ToolStripProgressBar>包含在<xref:System.Windows.Forms.StatusStrip>。</span><span class="sxs-lookup"><span data-stu-id="d45c4-167">The following code example demonstrates how to update a <xref:System.Windows.Forms.ToolStripProgressBar> that is contained within a <xref:System.Windows.Forms.StatusStrip>.</span></span>  
  
 [!code-csharp[System.Deployment.Application.InPlaceHostingManager#6](~/samples/snippets/csharp/VS_Snippets_Winforms/System.Deployment.Application.InPlaceHostingManager/CS/Form1.cs#6)]
 [!code-vb[System.Deployment.Application.InPlaceHostingManager#6](~/samples/snippets/visualbasic/VS_Snippets_Winforms/System.Deployment.Application.InPlaceHostingManager/VB/Form1.vb#6)]  
  
 ]]></format>
        </remarks>
      </Docs>
    </Member>
    <Member MemberName="Execute">
      <MemberSignature Language="C#" Value="public System.Runtime.Remoting.ObjectHandle Execute ();" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig instance class System.Runtime.Remoting.ObjectHandle Execute() cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Deployment.Application.InPlaceHostingManager.Execute" />
      <MemberSignature Language="VB.NET" Value="Public Function Execute () As ObjectHandle" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; System::Runtime::Remoting::ObjectHandle ^ Execute();" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Deployment</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Runtime.Remoting.ObjectHandle</ReturnType>
      </ReturnValue>
      <Parameters />
      <Docs>
        <summary>
          <span data-ttu-id="d45c4-168">当且仅当 [!INCLUDE[ndptecclick](~/includes/ndptecclick-md.md)] 应用程序是一个在 Web 浏览器中运行的基于 Windows Presentation Foundation 的应用程序时，才启动该应用程序。</span>
          <span class="sxs-lookup">
            <span data-stu-id="d45c4-168">Launches the [!INCLUDE[ndptecclick](~/includes/ndptecclick-md.md)] application, if and only if it is a Windows Presentation Foundation-based application running in a Web browser.</span>
          </span>
        </summary>
        <returns>
          <span data-ttu-id="d45c4-169">对应于已启动应用程序的 <see cref="T:System.Runtime.Remoting.ObjectHandle" />。</span>
          <span class="sxs-lookup">
            <span data-stu-id="d45c4-169">An <see cref="T:System.Runtime.Remoting.ObjectHandle" /> corresponding to the launched application.</span>
          </span>
        </returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="d45c4-170">此方法是仅对基于 Windows Presentation Foundation 应用程序可以承载于 Web 浏览器有效 (即，其部署清单定义`hostInBrowser`XML 元素)。</span><span class="sxs-lookup"><span data-stu-id="d45c4-170">This method is valid only for Windows Presentation Foundation-based applications that can be hosted in a Web browser (that is, their deployment manifests define the `hostInBrowser` XML element).</span></span>  
  
 ]]></format>
        </remarks>
      </Docs>
    </Member>
    <Member MemberName="GetManifestAsync">
      <MemberSignature Language="C#" Value="public void GetManifestAsync ();" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig instance void GetManifestAsync() cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Deployment.Application.InPlaceHostingManager.GetManifestAsync" />
      <MemberSignature Language="VB.NET" Value="Public Sub GetManifestAsync ()" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; void GetManifestAsync();" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Deployment</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Void</ReturnType>
      </ReturnValue>
      <Parameters />
      <Docs>
        <summary>
          <span data-ttu-id="d45c4-171">在后台下载 [!INCLUDE[ndptecclick](~/includes/ndptecclick-md.md)] 应用程序的部署清单，并在操作完成或遇到错误时引发事件。</span>
          <span class="sxs-lookup">
            <span data-stu-id="d45c4-171">Downloads the deployment manifest of the [!INCLUDE[ndptecclick](~/includes/ndptecclick-md.md)] application in the background, and raises an event when the operation has either completed or encountered an error.</span>
          </span>
        </summary>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="d45c4-172">若要接收通知的此事件完成时，创建的事件处理程序<xref:System.Deployment.Application.InPlaceHostingManager.GetManifestCompleted>事件。</span><span class="sxs-lookup"><span data-stu-id="d45c4-172">To receive notification of when this event completes, create an event handler for the <xref:System.Deployment.Application.InPlaceHostingManager.GetManifestCompleted> event.</span></span> <span data-ttu-id="d45c4-173">如果此事件被调用，并且没有错误由<xref:System.Deployment.Application.GetManifestCompletedEventArgs>，接下来应调用<xref:System.Deployment.Application.InPlaceHostingManager.AssertApplicationRequirements%2A>以验证应用程序将有权在本地计算机上运行。</span><span class="sxs-lookup"><span data-stu-id="d45c4-173">If this event is called, and no error is indicated by <xref:System.Deployment.Application.GetManifestCompletedEventArgs>, you should next call <xref:System.Deployment.Application.InPlaceHostingManager.AssertApplicationRequirements%2A> to verify that the application will have permission to run on the local computer.</span></span>  
  
   
  
## Examples  
 <span data-ttu-id="d45c4-174">下面的代码示例演示如何调用<xref:System.Deployment.Application.InPlaceHostingManager.GetManifestAsync%2A>方法。</span><span class="sxs-lookup"><span data-stu-id="d45c4-174">The following code examples demonstrate how to call the <xref:System.Deployment.Application.InPlaceHostingManager.GetManifestAsync%2A> method.</span></span> <span data-ttu-id="d45c4-175">处理程序<xref:System.Deployment.Application.InPlaceHostingManager.GetManifestCompleted>事件回调检查以查看清单下载已成功完成，并且如果是这样，通过提示用户有关应用程序的其他信息。</span><span class="sxs-lookup"><span data-stu-id="d45c4-175">The handler for the <xref:System.Deployment.Application.InPlaceHostingManager.GetManifestCompleted> event callback checks to see if the manifest download completed successfully, and if so, prompts the user with additional information about the application.</span></span> <span data-ttu-id="d45c4-176">如果用户同意以便继续安装，该处理程序调用<xref:System.Deployment.Application.InPlaceHostingManager.DownloadApplicationAsync%2A>。</span><span class="sxs-lookup"><span data-stu-id="d45c4-176">If the user agrees to continue the installation, the handler calls <xref:System.Deployment.Application.InPlaceHostingManager.DownloadApplicationAsync%2A>.</span></span>  
  
 <span data-ttu-id="d45c4-177">下面的代码示例假定已定义并已创建的实例<xref:System.Deployment.Application.InPlaceHostingManager>名为`iphm`。</span><span class="sxs-lookup"><span data-stu-id="d45c4-177">The following code examples assume that you have already defined and created an instance of <xref:System.Deployment.Application.InPlaceHostingManager> named `iphm`.</span></span>  
  
 [!code-csharp[System.Deployment.Application.InPlaceHostingManager#3](~/samples/snippets/csharp/VS_Snippets_Winforms/System.Deployment.Application.InPlaceHostingManager/CS/Form1.cs#3)]
 [!code-vb[System.Deployment.Application.InPlaceHostingManager#3](~/samples/snippets/visualbasic/VS_Snippets_Winforms/System.Deployment.Application.InPlaceHostingManager/VB/Form1.vb#3)]  
  
 [!code-csharp[System.Deployment.Application.InPlaceHostingManager#4](~/samples/snippets/csharp/VS_Snippets_Winforms/System.Deployment.Application.InPlaceHostingManager/CS/Form1.cs#4)]  
  
 ]]></format>
        </remarks>
      </Docs>
    </Member>
    <Member MemberName="GetManifestCompleted">
      <MemberSignature Language="C#" Value="public event EventHandler&lt;System.Deployment.Application.GetManifestCompletedEventArgs&gt; GetManifestCompleted;" />
      <MemberSignature Language="ILAsm" Value=".event class System.EventHandler`1&lt;class System.Deployment.Application.GetManifestCompletedEventArgs&gt; GetManifestCompleted" />
      <MemberSignature Language="DocId" Value="E:System.Deployment.Application.InPlaceHostingManager.GetManifestCompleted" />
      <MemberSignature Language="VB.NET" Value="Public Event GetManifestCompleted As EventHandler(Of GetManifestCompletedEventArgs) " />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; event EventHandler&lt;System::Deployment::Application::GetManifestCompletedEventArgs ^&gt; ^ GetManifestCompleted;" />
      <MemberType>Event</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Deployment</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.EventHandler&lt;System.Deployment.Application.GetManifestCompletedEventArgs&gt;</ReturnType>
      </ReturnValue>
      <Docs>
        <summary>
          <span data-ttu-id="d45c4-178">部署清单已下载到本地计算机时发生。</span>
          <span class="sxs-lookup">
            <span data-stu-id="d45c4-178">Occurs when the deployment manifest has been downloaded to the local computer.</span>
          </span>
        </summary>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="d45c4-179">使用<xref:System.ComponentModel.AsyncCompletedEventArgs.Error%2A>属性<xref:System.Deployment.Application.GetManifestCompletedEventArgs>以检查是否<xref:System.Deployment.Application.InPlaceHostingManager.GetManifestAsync%2A>已成功完成还是返回了错误。</span><span class="sxs-lookup"><span data-stu-id="d45c4-179">Use the <xref:System.ComponentModel.AsyncCompletedEventArgs.Error%2A> property of <xref:System.Deployment.Application.GetManifestCompletedEventArgs> to check whether <xref:System.Deployment.Application.InPlaceHostingManager.GetManifestAsync%2A> completed successfully or returned an error.</span></span> <span data-ttu-id="d45c4-180">如果<xref:System.ComponentModel.AsyncCompletedEventArgs.Error%2A>为 null，<xref:System.Deployment.Application.InPlaceHostingManager.GetManifestAsync%2A>已成功完成，并且你可以调用<xref:System.Deployment.Application.InPlaceHostingManager.AssertApplicationRequirements%2A>。</span><span class="sxs-lookup"><span data-stu-id="d45c4-180">If <xref:System.ComponentModel.AsyncCompletedEventArgs.Error%2A> is null, <xref:System.Deployment.Application.InPlaceHostingManager.GetManifestAsync%2A> completed successfully, and you can call <xref:System.Deployment.Application.InPlaceHostingManager.AssertApplicationRequirements%2A>.</span></span>  
  
   
  
## Examples  
 <span data-ttu-id="d45c4-181">下面的代码示例演示如何调用<xref:System.Deployment.Application.InPlaceHostingManager.GetManifestAsync%2A>方法。</span><span class="sxs-lookup"><span data-stu-id="d45c4-181">The following code examples demonstrate how to call the <xref:System.Deployment.Application.InPlaceHostingManager.GetManifestAsync%2A> method.</span></span> <span data-ttu-id="d45c4-182">处理程序<xref:System.Deployment.Application.InPlaceHostingManager.GetManifestCompleted>事件回调检查以查看清单下载已成功完成，并且如果是这样，通过提示用户有关应用程序的其他信息。</span><span class="sxs-lookup"><span data-stu-id="d45c4-182">The handler for the <xref:System.Deployment.Application.InPlaceHostingManager.GetManifestCompleted> event callback checks to see if the manifest download completed successfully, and if so, prompts the user with additional information about the application.</span></span> <span data-ttu-id="d45c4-183">如果用户同意以便继续安装，该处理程序调用<xref:System.Deployment.Application.InPlaceHostingManager.DownloadApplicationAsync%2A>。</span><span class="sxs-lookup"><span data-stu-id="d45c4-183">If the user agrees to continue the installation, the handler calls <xref:System.Deployment.Application.InPlaceHostingManager.DownloadApplicationAsync%2A>.</span></span>  
  
 <span data-ttu-id="d45c4-184">下面的代码示例假定已定义并已创建的实例<xref:System.Deployment.Application.InPlaceHostingManager>名为`iphm`。</span><span class="sxs-lookup"><span data-stu-id="d45c4-184">The following code examples assume that you have already defined and created an instance of <xref:System.Deployment.Application.InPlaceHostingManager> named `iphm`.</span></span>  
  
 [!code-csharp[System.Deployment.Application.InPlaceHostingManager#2](~/samples/snippets/csharp/VS_Snippets_Winforms/System.Deployment.Application.InPlaceHostingManager/CS/Form1.cs#2)]
 [!code-vb[System.Deployment.Application.InPlaceHostingManager#2](~/samples/snippets/visualbasic/VS_Snippets_Winforms/System.Deployment.Application.InPlaceHostingManager/VB/Form1.vb#2)]  
  
 [!code-csharp[System.Deployment.Application.InPlaceHostingManager#3](~/samples/snippets/csharp/VS_Snippets_Winforms/System.Deployment.Application.InPlaceHostingManager/CS/Form1.cs#3)]
 [!code-vb[System.Deployment.Application.InPlaceHostingManager#3](~/samples/snippets/visualbasic/VS_Snippets_Winforms/System.Deployment.Application.InPlaceHostingManager/VB/Form1.vb#3)]  
  
 ]]></format>
        </remarks>
      </Docs>
    </Member>
    <Member MemberName="UninstallCustomAddIn">
      <MemberSignature Language="C#" Value="public static void UninstallCustomAddIn (string subscriptionId);" />
      <MemberSignature Language="ILAsm" Value=".method public static hidebysig void UninstallCustomAddIn(string subscriptionId) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Deployment.Application.InPlaceHostingManager.UninstallCustomAddIn(System.String)" />
      <MemberSignature Language="VB.NET" Value="Public Shared Sub UninstallCustomAddIn (subscriptionId As String)" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; static void UninstallCustomAddIn(System::String ^ subscriptionId);" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Deployment</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Void</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="subscriptionId" Type="System.String" />
      </Parameters>
      <Docs>
        <param name="subscriptionId">
          <span data-ttu-id="d45c4-185">一个包含订阅标识符的字符串，它指示要移除的外接程序。</span>
          <span class="sxs-lookup">
            <span data-stu-id="d45c4-185">A string that contains a subscription identifier, which indicates the add-in to remove.</span>
          </span>
        </param>
        <summary>
          <span data-ttu-id="d45c4-186">删除应用程序中以前安装的用户定义组件。</span>
          <span class="sxs-lookup">
            <span data-stu-id="d45c4-186">Removes a previously installed user-defined component of an application.</span>
          </span>
        </summary>
        <remarks>To be added.</remarks>
        <exception cref="T:System.ArgumentException">
          <span data-ttu-id="d45c4-187">
            <paramref name="subscriptionId" /> 不是有效的订阅标识，或者不包括名称、公钥标记、处理器架构和版本号。</span>
          <span class="sxs-lookup">
            <span data-stu-id="d45c4-187">
              <paramref name="subscriptionId" /> is not a valid subscription identity, or does not include a name, public key token, processor architecture, and version number.</span>
          </span>
        </exception>
        <exception cref="T:System.ArgumentNullException">
          <span data-ttu-id="d45c4-188">
            <paramref name="subscriptionId" /> 为 <see langword="null" />。</span>
          <span class="sxs-lookup">
            <span data-stu-id="d45c4-188">
              <paramref name="subscriptionId" /> is <see langword="null" />.</span>
          </span>
        </exception>
      </Docs>
    </Member>
    <Member MemberName="UninstallCustomUXApplication">
      <MemberSignature Language="C#" Value="public static void UninstallCustomUXApplication (string subscriptionId);" />
      <MemberSignature Language="ILAsm" Value=".method public static hidebysig void UninstallCustomUXApplication(string subscriptionId) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Deployment.Application.InPlaceHostingManager.UninstallCustomUXApplication(System.String)" />
      <MemberSignature Language="VB.NET" Value="Public Shared Sub UninstallCustomUXApplication (subscriptionId As String)" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; static void UninstallCustomUXApplication(System::String ^ subscriptionId);" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Deployment</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Void</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="subscriptionId" Type="System.String" />
      </Parameters>
      <Docs>
        <param name="subscriptionId">
          <span data-ttu-id="d45c4-189">一个包含订阅标识符的字符串，指示要移除的 [!INCLUDE[ndptecclick](~/includes/ndptecclick-md.md)] 应用程序。</span>
          <span class="sxs-lookup">
            <span data-stu-id="d45c4-189">A string that contains a subscription identifier, which indicates the [!INCLUDE[ndptecclick](~/includes/ndptecclick-md.md)] application to remove.</span>
          </span>
        </param>
        <summary>
          <span data-ttu-id="d45c4-190">删除 [!INCLUDE[ndptecclick](~/includes/ndptecclick-md.md)] 应用程序，该应用程序包含 &lt;customUX&gt; 元素。</span>
          <span class="sxs-lookup">
            <span data-stu-id="d45c4-190">Removes a [!INCLUDE[ndptecclick](~/includes/ndptecclick-md.md)] application that includes the &lt;customUX&gt; element.</span>
          </span>
        </summary>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="d45c4-191">此方法卸载以前安装[!INCLUDE[ndptecclick](~/includes/ndptecclick-md.md)]使用应用程序`<customUX>`中的元素[&lt;入口点&gt;元素](http://msdn.microsoft.com/library/10ad3083-10c1-4189-a870-9bba2eab244f)。</span><span class="sxs-lookup"><span data-stu-id="d45c4-191">This method uninstalls a previously installed [!INCLUDE[ndptecclick](~/includes/ndptecclick-md.md)] application that uses the `<customUX>` element in the [&lt;entryPoint&gt; Element](http://msdn.microsoft.com/library/10ad3083-10c1-4189-a870-9bba2eab244f).</span></span>  
  
 <span data-ttu-id="d45c4-192">自定义安装程序不创建的添加或删除程序条目[!INCLUDE[ndptecclick](~/includes/ndptecclick-md.md)]应用程序必须存储在中找到的订阅标识符<xref:System.Deployment.Application.GetManifestCompletedEventArgs.SubscriptionIdentity%2A>在安装过程中的属性。</span><span class="sxs-lookup"><span data-stu-id="d45c4-192">Custom installers that do not create an Add or Remove Programs entry for the [!INCLUDE[ndptecclick](~/includes/ndptecclick-md.md)] application must store the subscription identifier found in the <xref:System.Deployment.Application.GetManifestCompletedEventArgs.SubscriptionIdentity%2A> property during installation.</span></span>  
  
 ]]></format>
        </remarks>
      </Docs>
    </Member>
  </Members>
</Type>