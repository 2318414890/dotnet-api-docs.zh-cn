<Type Name="SqlPersonalizationProvider" FullName="System.Web.UI.WebControls.WebParts.SqlPersonalizationProvider">
  <Metadata>
    <Meta Name="ms.openlocfilehash" Value="367db112a98e9be168fcc204b91d613affb59941" />
    <Meta Name="ms.sourcegitcommit" Value="6a0b904069161bbaec4ffd02aa7d9cf38c61e72e" />
    <Meta Name="ms.translationtype" Value="HT" />
    <Meta Name="ms.contentlocale" Value="zh-CN" />
    <Meta Name="ms.lasthandoff" Value="06/24/2018" />
    <Meta Name="ms.locfileid" Value="36385242" />
  </Metadata>
  <TypeSignature Language="C#" Value="public class SqlPersonalizationProvider : System.Web.UI.WebControls.WebParts.PersonalizationProvider" />
  <TypeSignature Language="ILAsm" Value=".class public auto ansi beforefieldinit SqlPersonalizationProvider extends System.Web.UI.WebControls.WebParts.PersonalizationProvider" />
  <TypeSignature Language="DocId" Value="T:System.Web.UI.WebControls.WebParts.SqlPersonalizationProvider" />
  <TypeSignature Language="VB.NET" Value="Public Class SqlPersonalizationProvider&#xA;Inherits PersonalizationProvider" />
  <TypeSignature Language="C++ CLI" Value="public ref class SqlPersonalizationProvider : System::Web::UI::WebControls::WebParts::PersonalizationProvider" />
  <TypeSignature Language="F#" Value="type SqlPersonalizationProvider = class&#xA;    inherit PersonalizationProvider" />
  <AssemblyInfo>
    <AssemblyName>System.Web</AssemblyName>
    <AssemblyVersion>4.0.0.0</AssemblyVersion>
  </AssemblyInfo>
  <Base>
    <BaseTypeName>System.Web.UI.WebControls.WebParts.PersonalizationProvider</BaseTypeName>
  </Base>
  <Interfaces />
  <Docs>
    <summary>Implements a personalization provider that uses Microsoft SQL Server.</summary>
    <remarks>
      <format type="text/markdown"><![CDATA[  
  
## Remarks  
 此类定义个性化设置提供程序使用 Microsoft SQL Server 所需的功能。 个性化设置提供程序加载和存储代表个性化数据<xref:System.Web.UI.WebControls.WebParts.WebPartPersonalization>实例。 此类实现读取和写入到运行 SQL Server 的计算机的逻辑和实现所有抽象方法中也定义<xref:System.Web.UI.WebControls.WebParts.PersonalizationProvider>。 个性化设置提供程序的详细信息，请参阅<xref:System.Web.UI.WebControls.WebParts.PersonalizationProvider>。  
  
 使用 SQL Server 的 Web 部件个性化设置的数据设计依赖于存在两个常见的 SQL 数据库表，并且其支持存储过程，对于大多数基于 SQL 的功能实现共享。 这些表和视图安装和卸载使用以下脚本：  
  
-   installpagepersonalization.sql – 安装个性化表、 视图和相关的存储的过程。  
  
-   uninstallpagepersonalization.sql – 卸载个性化表、 视图和相关的存储的过程。  
  
 务必要注意个性化设置将失败，如果 Web 应用程序未运行在默认信任级别的<xref:System.Web.AspNetHostingPermissionLevel.Medium>或更高版本 (你可以在 Web.config 文件中使用设置自定义信任级别`<trust level="" />`元素)。 <xref:System.Web.UI.WebControls.WebParts.PersonalizationAdministration>和<xref:System.Web.UI.WebControls.WebParts.SqlPersonalizationProvider>类这两个信任级别的检查<xref:System.Web.AspNetHostingPermissionLevel.Low>初始化时。 如果你配置你的应用程序运行在的信任级别的<xref:System.Web.AspNetHostingPermissionLevel.Low>，并使用默认<xref:System.Web.UI.WebControls.WebParts.SqlPersonalizationProvider>提供程序来管理你的应用程序，个性化数据将应用程序尝试访问个性化数据的第一个时间失败，因为在中运行 ASP.NET 工作进程<xref:System.Web.AspNetHostingPermissionLevel.Low>信任没有调入的各个类中所必需的权限<xref:System.Data.SqlClient>命名空间。  
  
 ]]></format>
    </remarks>
    <altmember cref="T:System.Web.UI.WebControls.WebParts.PersonalizationProvider" />
  </Docs>
  <Members>
    <Member MemberName=".ctor">
      <MemberSignature Language="C#" Value="public SqlPersonalizationProvider ();" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig specialname rtspecialname instance void .ctor() cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Web.UI.WebControls.WebParts.SqlPersonalizationProvider.#ctor" />
      <MemberSignature Language="VB.NET" Value="Public Sub New ()" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; SqlPersonalizationProvider();" />
      <MemberType>Constructor</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Web</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Parameters />
      <Docs>
        <summary>Initializes a new instance of the <see cref="T:System.Web.UI.WebControls.WebParts.SqlPersonalizationProvider" /> class.</summary>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <xref:System.Web.UI.WebControls.WebParts.SqlPersonalizationProvider.%23ctor%2A> ASP.NET 创建的实例将调用构造函数<xref:System.Web.UI.WebControls.WebParts.SqlPersonalizationProvider>为应用程序的配置中指定的类。 此构造函数不应在代码中使用。  
  
 ]]></format>
        </remarks>
      </Docs>
    </Member>
    <Member MemberName="ApplicationName">
      <MemberSignature Language="C#" Value="public override string ApplicationName { get; set; }" />
      <MemberSignature Language="ILAsm" Value=".property instance string ApplicationName" />
      <MemberSignature Language="DocId" Value="P:System.Web.UI.WebControls.WebParts.SqlPersonalizationProvider.ApplicationName" />
      <MemberSignature Language="VB.NET" Value="Public Overrides Property ApplicationName As String" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; virtual property System::String ^ ApplicationName { System::String ^ get(); void set(System::String ^ value); };" />
      <MemberSignature Language="F#" Value="member this.ApplicationName : string with get, set" Usage="System.Web.UI.WebControls.WebParts.SqlPersonalizationProvider.ApplicationName" />
      <MemberType>Property</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Web</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.String</ReturnType>
      </ReturnValue>
      <Docs>
        <summary>Gets or sets the name of the application to store and retrieve personalization information for.</summary>
        <value>要存储和检索个性化设置信息的应用程序名称。 默认值是<see cref="P:System.Web.Hosting.HostingEnvironment.ApplicationVirtualPath" />当前属性值<see cref="P:System.Web.HttpContext.Request" />。</value>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <xref:System.Web.UI.WebControls.WebParts.SqlPersonalizationProvider.ApplicationName%2A>属性由<xref:System.Web.UI.WebControls.WebParts.SqlPersonalizationProvider>类对用户信息进行分组。 通过限定与应用程序名称的用户信息，你可以存储在单个数据库的多个应用程序的信息，而不会遇到重复的用户名称之间的冲突。 此外，多个 ASP.NET 应用程序可以通过指定相同的值中使用相同的用户数据库<xref:System.Web.UI.WebControls.WebParts.SqlPersonalizationProvider.ApplicationName%2A>属性。 <xref:System.Web.UI.WebControls.WebParts.SqlPersonalizationProvider.ApplicationName%2A>可以以编程方式设置属性或可以在 Web 应用程序使用的配置文件中以声明方式设置`applicationName`属性中`<providers>`部分。  
  
 如果没有为指定值`applicationName`Web 应用程序的配置文件中的属性则<xref:System.Web.Hosting.HostingEnvironment.ApplicationVirtualPath%2A>使用对应用程序所做的第一个请求的属性值。  
  
> [!CAUTION]
>  因为服务的所有请求使用单个默认个性化设置提供程序实例<xref:System.Web.HttpApplication>对象，您可以有多个请求并发执行，并尝试设置<xref:System.Web.UI.WebControls.WebParts.SqlPersonalizationProvider.ApplicationName%2A>属性值。 <xref:System.Web.UI.WebControls.WebParts.SqlPersonalizationProvider.ApplicationName%2A>属性不是线程安全用于多个写操作，并更改<xref:System.Web.UI.WebControls.WebParts.SqlPersonalizationProvider.ApplicationName%2A>属性值可能会导致多个用户的应用程序的意外行为。 建议你避免代码，以允许用户设置<xref:System.Web.UI.WebControls.WebParts.SqlPersonalizationProvider.ApplicationName%2A>属性所需除外。 应用程序的示例设置<xref:System.Web.UI.WebControls.WebParts.SqlPersonalizationProvider.ApplicationName%2A>属性可能需要是管理应用程序管理多个应用程序的个性化数据。 此类应用程序应为单用户应用程序和不是 Web 应用程序。  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.Configuration.Provider.ProviderException">The property was set to a string with a length greater than 256 characters.</exception>
      </Docs>
    </Member>
    <Member MemberName="FindState">
      <MemberSignature Language="C#" Value="public override System.Web.UI.WebControls.WebParts.PersonalizationStateInfoCollection FindState (System.Web.UI.WebControls.WebParts.PersonalizationScope scope, System.Web.UI.WebControls.WebParts.PersonalizationStateQuery query, int pageIndex, int pageSize, out int totalRecords);" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig virtual instance class System.Web.UI.WebControls.WebParts.PersonalizationStateInfoCollection FindState(valuetype System.Web.UI.WebControls.WebParts.PersonalizationScope scope, class System.Web.UI.WebControls.WebParts.PersonalizationStateQuery query, int32 pageIndex, int32 pageSize, [out] int32&amp; totalRecords) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Web.UI.WebControls.WebParts.SqlPersonalizationProvider.FindState(System.Web.UI.WebControls.WebParts.PersonalizationScope,System.Web.UI.WebControls.WebParts.PersonalizationStateQuery,System.Int32,System.Int32,System.Int32@)" />
      <MemberSignature Language="VB.NET" Value="Public Overrides Function FindState (scope As PersonalizationScope, query As PersonalizationStateQuery, pageIndex As Integer, pageSize As Integer, ByRef totalRecords As Integer) As PersonalizationStateInfoCollection" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; override System::Web::UI::WebControls::WebParts::PersonalizationStateInfoCollection ^ FindState(System::Web::UI::WebControls::WebParts::PersonalizationScope scope, System::Web::UI::WebControls::WebParts::PersonalizationStateQuery ^ query, int pageIndex, int pageSize, [Runtime::InteropServices::Out] int % totalRecords);" />
      <MemberSignature Language="F#" Value="override this.FindState : System.Web.UI.WebControls.WebParts.PersonalizationScope * System.Web.UI.WebControls.WebParts.PersonalizationStateQuery * int * int *  -&gt; System.Web.UI.WebControls.WebParts.PersonalizationStateInfoCollection" Usage="sqlPersonalizationProvider.FindState (scope, query, pageIndex, pageSize, totalRecords)" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Web</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Web.UI.WebControls.WebParts.PersonalizationStateInfoCollection</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="scope" Type="System.Web.UI.WebControls.WebParts.PersonalizationScope" />
        <Parameter Name="query" Type="System.Web.UI.WebControls.WebParts.PersonalizationStateQuery" />
        <Parameter Name="pageIndex" Type="System.Int32" />
        <Parameter Name="pageSize" Type="System.Int32" />
        <Parameter Name="totalRecords" Type="System.Int32&amp;" RefType="out" />
      </Parameters>
      <Docs>
        <param name="scope">A <see cref="T:System.Web.UI.WebControls.WebParts.PersonalizationScope" /> indicating the personalization information to be queried. This value cannot be <see langword="null" />.</param>
        <param name="query">A <see cref="T:System.Web.UI.WebControls.WebParts.PersonalizationStateQuery" /> containing a query. This value can be <see langword="null" />.</param>
        <param name="pageIndex">The location where the query starts.</param>
        <param name="pageSize">The number of records to return.</param>
        <param name="totalRecords">The total number of records available.</param>
        <summary>Returns a collection containing zero or more <see cref="T:System.Web.UI.WebControls.WebParts.PersonalizationStateInfo" />-derived objects, based on the specified scope and parameters.</summary>
        <returns>A <see cref="T:System.Web.UI.WebControls.WebParts.PersonalizationStateInfoCollection" /> containing zero or more <see cref="T:System.Web.UI.WebControls.WebParts.PersonalizationStateInfo" />-derived objects.</returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 受约束的返回的项集`pageSize`和`pageIndex`参数，其中`pageSize`控制要返回的记录数和`pageIndex`控制要返回哪些记录。 例如，`pageIndex`为 0 和`pageSize`25 个，则将返回前 25 个匹配项，而`pageIndex`的 1 和`pageSize`25 个，则会返回匹配项 26-50。 如果你想要获取所有可用的记录，设置`pageIndex`为 0，和`pageSize`到<xref:System.Int32.MaxValue>。  
  
 <xref:System.Web.UI.WebControls.WebParts.PersonalizationStateInfo>-派生的对象返回的字母顺序排序的<xref:System.Web.UI.WebControls.WebParts.PersonalizationStateInfo.Path%2A>和<xref:System.Web.UI.WebControls.WebParts.UserPersonalizationStateInfo.Username%2A>，不管是在升序排序。  
  
 此方法将查询通配符字符传递给基础数据存储区。 当前依赖于每个提供程序处理如星号 （*）、 百分号 （%） 或下划线 (_) 字符的方式是支持通配符。  
  
 通常情况下，对于符合 SQL 数据存储区中，你可以执行通配符搜索部分路径带有通配符字符开头，结束时，或在搜索字符串文本的中间显示<xref:System.Web.UI.WebControls.WebParts.PersonalizationStateQuery.PathToMatch%2A>属性。 例如，若要查找以"~/approot"开头的所有路径<xref:System.Web.UI.WebControls.WebParts.PersonalizationStateQuery.PathToMatch%2A>属性将设置为"~/approot%"。  
  
 同样，对部分用户名通配符搜索可以显示的文本字符串中的任意位置的通配符字符<xref:System.Web.UI.WebControls.WebParts.PersonalizationStateQuery.UsernameToMatch%2A>属性。 例如，若要查找与"John"开头的所有用户名称<xref:System.Web.UI.WebControls.WebParts.PersonalizationStateQuery.UsernameToMatch%2A>参数将如下所示"John %"。  
  
 以下查询限制也适用：  
  
-   如果仅`scope`提供，和`query`是`null`或上的所有属性`query`返回`null`或默认值，则指示匹配的所有记录`scope`返回参数。  
  
-   如果<xref:System.Web.UI.WebControls.WebParts.PersonalizationStateQuery.PathToMatch%2A>属性不是`null`，返回的记录也是匹配的筛选基于的路径<xref:System.Web.UI.WebControls.WebParts.PersonalizationStateQuery.PathToMatch%2A>属性值。  
  
-   如果<xref:System.Web.UI.WebControls.WebParts.PersonalizationStateQuery.UsernameToMatch%2A>属性不是`null`，返回的记录也是匹配的筛选基于的用户名称<xref:System.Web.UI.WebControls.WebParts.PersonalizationStateQuery.UsernameToMatch%2A>属性值。  
  
-   如果<xref:System.Web.UI.WebControls.WebParts.PersonalizationStateQuery.UserInactiveSinceDate%2A>属性是否不等于<xref:System.DateTime.MaxValue>，则返回的记录还筛选以返回与非活动用户关联的那些记录。 比较包括记录其中<xref:System.Web.UI.WebControls.WebParts.UserPersonalizationStateInfo.LastActivityDate%2A>属性小于或等于<xref:System.Web.UI.WebControls.WebParts.PersonalizationStateQuery.UserInactiveSinceDate%2A>属性。  
  
 请注意，此方法不会验证查询参数的组合。 例如，代码可以请求一组共享的范围中的特定用户名称与关联的个性化状态记录。 由于用户名不与共享信息相关联，则返回的集合将为空。  
  
 有可能会返回非空集合的参数组合包括：  
  
-   <xref:System.Web.UI.WebControls.WebParts.PersonalizationScope.Shared> 与结合使用的作用域<xref:System.Web.UI.WebControls.WebParts.PersonalizationStateQuery.PathToMatch%2A>。  
  
-   <xref:System.Web.UI.WebControls.WebParts.PersonalizationScope.User> 作用域中的任意或全部的值组合<xref:System.Web.UI.WebControls.WebParts.PersonalizationStateQuery.PathToMatch%2A>， <xref:System.Web.UI.WebControls.WebParts.PersonalizationStateQuery.UsernameToMatch%2A>，和<xref:System.Web.UI.WebControls.WebParts.PersonalizationStateQuery.UserInactiveSinceDate%2A>属性。  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentException">
          <paramref name="pageIndex" /> is less than zero.  \- or -  <paramref name="pageSize" /> is less than or equal to zero.  \- or -  The combination of <paramref name="pageIndex" /> and <paramref name="pageSize" /> results in a value greater than <see cref="F:System.Int32.MaxValue" />.  \- or -  <see cref="P:System.Web.UI.WebControls.WebParts.PersonalizationStateQuery.PathToMatch" /> is non-<see langword="null" /> and is an empty string ("") after trimming.  \- or -  The length of <see cref="P:System.Web.UI.WebControls.WebParts.PersonalizationStateQuery.PathToMatch" /> is greater than 256 characters when the value is non-<see langword="null" />.  \- or -  <see cref="P:System.Web.UI.WebControls.WebParts.PersonalizationStateQuery.UsernameToMatch" /> is non-<see langword="null" /> and is an empty string after trimming.  \- or -  The length of <see cref="P:System.Web.UI.WebControls.WebParts.PersonalizationStateQuery.UsernameToMatch" /> is greater than 256 characters when the value is non-<see langword="null" />.</exception>
        <exception cref="T:System.ArgumentOutOfRangeException">The <paramref name="scope" /> specified is not a valid value from the <see cref="T:System.Web.UI.WebControls.WebParts.PersonalizationScope" /> enumeration.</exception>
      </Docs>
    </Member>
    <Member MemberName="GetCountOfState">
      <MemberSignature Language="C#" Value="public override int GetCountOfState (System.Web.UI.WebControls.WebParts.PersonalizationScope scope, System.Web.UI.WebControls.WebParts.PersonalizationStateQuery query);" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig virtual instance int32 GetCountOfState(valuetype System.Web.UI.WebControls.WebParts.PersonalizationScope scope, class System.Web.UI.WebControls.WebParts.PersonalizationStateQuery query) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Web.UI.WebControls.WebParts.SqlPersonalizationProvider.GetCountOfState(System.Web.UI.WebControls.WebParts.PersonalizationScope,System.Web.UI.WebControls.WebParts.PersonalizationStateQuery)" />
      <MemberSignature Language="VB.NET" Value="Public Overrides Function GetCountOfState (scope As PersonalizationScope, query As PersonalizationStateQuery) As Integer" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; override int GetCountOfState(System::Web::UI::WebControls::WebParts::PersonalizationScope scope, System::Web::UI::WebControls::WebParts::PersonalizationStateQuery ^ query);" />
      <MemberSignature Language="F#" Value="override this.GetCountOfState : System.Web.UI.WebControls.WebParts.PersonalizationScope * System.Web.UI.WebControls.WebParts.PersonalizationStateQuery -&gt; int" Usage="sqlPersonalizationProvider.GetCountOfState (scope, query)" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Web</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Int32</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="scope" Type="System.Web.UI.WebControls.WebParts.PersonalizationScope" />
        <Parameter Name="query" Type="System.Web.UI.WebControls.WebParts.PersonalizationStateQuery" />
      </Parameters>
      <Docs>
        <param name="scope">A <see cref="T:System.Web.UI.WebControls.WebParts.PersonalizationScope" /> indicating the personalization information to be queried. This value cannot be <see langword="null" />.</param>
        <param name="query">A <see cref="T:System.Web.UI.WebControls.WebParts.PersonalizationStateQuery" /> containing a query. This value can be <see langword="null" />.</param>
        <summary>Returns a count of the number of rows in the underlying data store that exist for the specified <paramref name="scope" /> parameter.</summary>
        <returns>The number of rows in the underlying data store that exist for the specified <paramref name="scope" /> parameter.</returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 此方法将查询通配符字符传递给基础数据存储区。 当前依赖于每个提供程序处理如星号 （*）、 百分号 （%） 或下划线 (_) 字符的方式是支持通配符。  
  
 通常情况下，对于符合 SQL 数据存储区中，你可以执行通配符搜索部分路径带有通配符字符开头，结束时，或在搜索字符串文本的中间显示<xref:System.Web.UI.WebControls.WebParts.PersonalizationStateQuery.PathToMatch%2A>属性。 例如，若要查找以"~/approot"开头的所有路径<xref:System.Web.UI.WebControls.WebParts.PersonalizationStateQuery.PathToMatch%2A>属性将设置为"~/approot%"。  
  
 同样，对部分用户名通配符搜索可以显示的文本字符串中的任意位置的通配符字符<xref:System.Web.UI.WebControls.WebParts.PersonalizationStateQuery.UsernameToMatch%2A>属性。 例如，若要查找与"John"开头的所有用户名称<xref:System.Web.UI.WebControls.WebParts.PersonalizationStateQuery.UsernameToMatch%2A>参数将如下所示"John %"。  
  
 以下查询限制也适用：  
  
-   如果仅`scope`提供，和`query`是`null`或上的所有属性`query`返回`null`或默认值，则指示匹配的所有记录`scope`返回参数。  
  
-   如果<xref:System.Web.UI.WebControls.WebParts.PersonalizationStateQuery.PathToMatch%2A>属性不是`null`，返回的记录也是匹配的筛选基于的路径<xref:System.Web.UI.WebControls.WebParts.PersonalizationStateQuery.PathToMatch%2A>属性值。  
  
-   如果<xref:System.Web.UI.WebControls.WebParts.PersonalizationStateQuery.UsernameToMatch%2A>不`null`，返回的记录也是匹配的筛选基于的用户名称<xref:System.Web.UI.WebControls.WebParts.PersonalizationStateQuery.UsernameToMatch%2A>属性值。  
  
-   如果<xref:System.Web.UI.WebControls.WebParts.PersonalizationStateQuery.UserInactiveSinceDate%2A>属性是否不等于<xref:System.DateTime.MaxValue>，则返回的记录还筛选以返回与非活动用户关联的那些记录。 比较包括记录其中<xref:System.Web.UI.WebControls.WebParts.UserPersonalizationStateInfo.LastActivityDate%2A>属性小于或等于<xref:System.Web.UI.WebControls.WebParts.PersonalizationStateQuery.UserInactiveSinceDate%2A>属性。  
  
 请注意，此方法不会验证查询参数的组合。 例如，代码可以请求与共享的作用域中的非活动用户相关联的状态记录数。 因为没有非活动的自定义项的概念，因此返回的计数将为零。  
  
 有可能会返回非空集合的参数组合包括：  
  
-   <xref:System.Web.UI.WebControls.WebParts.PersonalizationScope.Shared> 与结合使用的作用域<xref:System.Web.UI.WebControls.WebParts.PersonalizationStateQuery.PathToMatch%2A>。  
  
-   <xref:System.Web.UI.WebControls.WebParts.PersonalizationScope.User> 作用域中的任意或全部的值组合<xref:System.Web.UI.WebControls.WebParts.PersonalizationStateQuery.PathToMatch%2A>， <xref:System.Web.UI.WebControls.WebParts.PersonalizationStateQuery.UsernameToMatch%2A>，和<xref:System.Web.UI.WebControls.WebParts.PersonalizationStateQuery.UserInactiveSinceDate%2A>属性。  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentException">
          <see cref="P:System.Web.UI.WebControls.WebParts.PersonalizationStateQuery.PathToMatch" /> is non-<see langword="null" /> and is an empty string ("") after trimming.  \- or -  The length of <see cref="P:System.Web.UI.WebControls.WebParts.PersonalizationStateQuery.PathToMatch" /> is greater than 256 characters when the value is non-<see langword="null" />.  \- or -  <see cref="P:System.Web.UI.WebControls.WebParts.PersonalizationStateQuery.UsernameToMatch" /> is non-<see langword="null" /> and is an empty string after trimming.  \- or -  The length of <see cref="P:System.Web.UI.WebControls.WebParts.PersonalizationStateQuery.UsernameToMatch" /> is greater than 256 characters when the value is non-<see langword="null" />.</exception>
        <exception cref="T:System.ArgumentOutOfRangeException">The <paramref name="scope" /> specified is not a valid value from the <see cref="T:System.Web.UI.WebControls.WebParts.PersonalizationScope" /> enumeration.</exception>
      </Docs>
    </Member>
    <Member MemberName="Initialize">
      <MemberSignature Language="C#" Value="public override void Initialize (string name, System.Collections.Specialized.NameValueCollection configSettings);" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig virtual instance void Initialize(string name, class System.Collections.Specialized.NameValueCollection configSettings) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Web.UI.WebControls.WebParts.SqlPersonalizationProvider.Initialize(System.String,System.Collections.Specialized.NameValueCollection)" />
      <MemberSignature Language="VB.NET" Value="Public Overrides Sub Initialize (name As String, configSettings As NameValueCollection)" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; override void Initialize(System::String ^ name, System::Collections::Specialized::NameValueCollection ^ configSettings);" />
      <MemberSignature Language="F#" Value="override this.Initialize : string * System.Collections.Specialized.NameValueCollection -&gt; unit" Usage="sqlPersonalizationProvider.Initialize (name, configSettings)" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Web</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Void</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="name" Type="System.String" />
        <Parameter Name="configSettings" Type="System.Collections.Specialized.NameValueCollection" />
      </Parameters>
      <Docs>
        <param name="name">The application name as it appears in the configuration file.</param>
        <param name="configSettings">The configuration settings for the application.</param>
        <summary>Implements the initialization procedures required for a Microsoft SQL Server personalization provider. This method is not intended to be used directly from your code.</summary>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 此方法提供的初始化过程与 SQL 数据库使用个性化和不应在代码中直接使用。  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.Configuration.Provider.ProviderException">No connection string is configured for the provider.  \- or -  The connection string for the provider cannot be found.  \- or -  There are additional attributes on the provider's <see langword="&lt;add&gt;" /> element beyond those described in the configuration settings.  \- or -  The length of the application name is greater than 256 characters.  \- or -  The application domain hosting the application is running at a trust level below <see cref="F:System.Web.AspNetHostingPermissionLevel.Medium" /> trust.</exception>
        <exception cref="T:System.ArgumentNullException">
          <paramref name="configSettings" /> is <see langword="null" />.</exception>
      </Docs>
    </Member>
    <Member MemberName="LoadPersonalizationBlobs">
      <MemberSignature Language="C#" Value="protected override void LoadPersonalizationBlobs (System.Web.UI.WebControls.WebParts.WebPartManager webPartManager, string path, string userName, ref byte[] sharedDataBlob, ref byte[] userDataBlob);" />
      <MemberSignature Language="ILAsm" Value=".method familyhidebysig virtual instance void LoadPersonalizationBlobs(class System.Web.UI.WebControls.WebParts.WebPartManager webPartManager, string path, string userName, unsigned int8[]&amp; sharedDataBlob, unsigned int8[]&amp; userDataBlob) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Web.UI.WebControls.WebParts.SqlPersonalizationProvider.LoadPersonalizationBlobs(System.Web.UI.WebControls.WebParts.WebPartManager,System.String,System.String,System.Byte[]@,System.Byte[]@)" />
      <MemberSignature Language="C++ CLI" Value="protected:&#xA; override void LoadPersonalizationBlobs(System::Web::UI::WebControls::WebParts::WebPartManager ^ webPartManager, System::String ^ path, System::String ^ userName, cli::array &lt;System::Byte&gt; ^ % sharedDataBlob, cli::array &lt;System::Byte&gt; ^ % userDataBlob);" />
      <MemberSignature Language="F#" Value="override this.LoadPersonalizationBlobs : System.Web.UI.WebControls.WebParts.WebPartManager * string * string *  *  -&gt; unit" Usage="sqlPersonalizationProvider.LoadPersonalizationBlobs (webPartManager, path, userName, sharedDataBlob, userDataBlob)" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Web</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Void</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="webPartManager" Type="System.Web.UI.WebControls.WebParts.WebPartManager" />
        <Parameter Name="path" Type="System.String" />
        <Parameter Name="userName" Type="System.String" />
        <Parameter Name="sharedDataBlob" Type="System.Byte[]&amp;" RefType="ref" />
        <Parameter Name="userDataBlob" Type="System.Byte[]&amp;" RefType="ref" />
      </Parameters>
      <Docs>
        <param name="webPartManager">The <see cref="T:System.Web.UI.WebControls.WebParts.WebPartManager" /> managing the personalization data.</param>
        <param name="path">The path for personalization information in the <see cref="F:System.Web.UI.WebControls.WebParts.PersonalizationScope.Shared" /> scope to be used as the retrieval key.</param>
        <param name="userName">The user name for personalization information in the <see cref="F:System.Web.UI.WebControls.WebParts.PersonalizationScope.User" /> scope to be used as the retrieval key.</param>
        <param name="sharedDataBlob">The returned data for the <see cref="F:System.Web.UI.WebControls.WebParts.PersonalizationScope.Shared" /> scope.</param>
        <param name="userDataBlob">The returned data for the <see cref="F:System.Web.UI.WebControls.WebParts.PersonalizationScope.User" /> scope.</param>
        <summary>Loads personalization data from the underlying data store, based on the specified parameters.</summary>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 此方法使用`webPartManager`， `path`，和`username`参数作为检索关键字。 返回的数据包含：  
  
-   <xref:System.Web.UI.WebControls.WebParts.PersonalizationScope.Shared>中返回的数据`sharedDataBlob`参数。  
  
-   具体取决于键值，<xref:System.Web.UI.WebControls.WebParts.PersonalizationScope.User>中返回数据`userDataBlob`参数。 非`null`值`userName`参数指示<xref:System.Web.UI.WebControls.WebParts.PersonalizationScope.User>还检索数据。  
  
 <xref:System.Web.UI.WebControls.WebParts.SqlPersonalizationProvider>自动更新对象<xref:System.Web.UI.WebControls.WebParts.UserPersonalizationStateInfo.LastActivityDate%2A>中的列`aspnet_Users`每个时间特定于用户的个性化数据加载的页面请求的上下文中的数据库的表。 此行为允许使用其他 ASP.NET 功能<xref:System.Web.UI.WebControls.WebParts.UserPersonalizationStateInfo.LastActivityDate%2A>属性时管理陈旧数据记录在站点上以及确定最近的用户活动。  
  
 ]]></format>
        </remarks>
      </Docs>
    </Member>
    <Member MemberName="ResetPersonalizationBlob">
      <MemberSignature Language="C#" Value="protected override void ResetPersonalizationBlob (System.Web.UI.WebControls.WebParts.WebPartManager webPartManager, string path, string userName);" />
      <MemberSignature Language="ILAsm" Value=".method familyhidebysig virtual instance void ResetPersonalizationBlob(class System.Web.UI.WebControls.WebParts.WebPartManager webPartManager, string path, string userName) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Web.UI.WebControls.WebParts.SqlPersonalizationProvider.ResetPersonalizationBlob(System.Web.UI.WebControls.WebParts.WebPartManager,System.String,System.String)" />
      <MemberSignature Language="C++ CLI" Value="protected:&#xA; override void ResetPersonalizationBlob(System::Web::UI::WebControls::WebParts::WebPartManager ^ webPartManager, System::String ^ path, System::String ^ userName);" />
      <MemberSignature Language="F#" Value="override this.ResetPersonalizationBlob : System.Web.UI.WebControls.WebParts.WebPartManager * string * string -&gt; unit" Usage="sqlPersonalizationProvider.ResetPersonalizationBlob (webPartManager, path, userName)" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Web</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Void</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="webPartManager" Type="System.Web.UI.WebControls.WebParts.WebPartManager" />
        <Parameter Name="path" Type="System.String" />
        <Parameter Name="userName" Type="System.String" />
      </Parameters>
      <Docs>
        <param name="webPartManager">The <see cref="T:System.Web.UI.WebControls.WebParts.WebPartManager" /> managing the personalization data.</param>
        <param name="path">The path for personalization information in the <see cref="F:System.Web.UI.WebControls.WebParts.PersonalizationScope.Shared" /> scope to be used as the retrieval key.</param>
        <param name="userName">The user name for personalization information in the <see cref="F:System.Web.UI.WebControls.WebParts.PersonalizationScope.User" /> scope to be used as the retrieval key.</param>
        <summary>Deletes personalization data from the underlying data store.</summary>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <xref:System.Web.UI.WebControls.WebParts.WebPartPersonalization> 使用此方法时 Web 站点用户选择重置 Web 部件页面上的数据从数据库中删除个性化数据。 如果`username`为非`null`，与数据<xref:System.Web.UI.WebControls.WebParts.PersonalizationScope.User>作用域数据是已删除; 否则为与数据<xref:System.Web.UI.WebControls.WebParts.PersonalizationScope.Shared>删除作用域。  
  
 <xref:System.Web.UI.WebControls.WebParts.SqlPersonalizationProvider>自动更新对象<xref:System.Web.UI.WebControls.WebParts.UserPersonalizationStateInfo.LastActivityDate%2A>中的列`aspnet_Users`从一个页面请求的上下文中的数据库中删除每个时间特定于用户的个性化数据的表。 此行为允许使用其他 ASP.NET 功能<xref:System.Web.UI.WebControls.WebParts.UserPersonalizationStateInfo.LastActivityDate%2A>时管理陈旧数据记录在站点上以及确定最近的用户活动的值。  
  
 ]]></format>
        </remarks>
      </Docs>
    </Member>
    <Member MemberName="ResetState">
      <MemberSignature Language="C#" Value="public override int ResetState (System.Web.UI.WebControls.WebParts.PersonalizationScope scope, string[] paths, string[] usernames);" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig virtual instance int32 ResetState(valuetype System.Web.UI.WebControls.WebParts.PersonalizationScope scope, string[] paths, string[] usernames) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Web.UI.WebControls.WebParts.SqlPersonalizationProvider.ResetState(System.Web.UI.WebControls.WebParts.PersonalizationScope,System.String[],System.String[])" />
      <MemberSignature Language="VB.NET" Value="Public Overrides Function ResetState (scope As PersonalizationScope, paths As String(), usernames As String()) As Integer" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; override int ResetState(System::Web::UI::WebControls::WebParts::PersonalizationScope scope, cli::array &lt;System::String ^&gt; ^ paths, cli::array &lt;System::String ^&gt; ^ usernames);" />
      <MemberSignature Language="F#" Value="override this.ResetState : System.Web.UI.WebControls.WebParts.PersonalizationScope * string[] * string[] -&gt; int" Usage="sqlPersonalizationProvider.ResetState (scope, paths, usernames)" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Web</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Int32</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="scope" Type="System.Web.UI.WebControls.WebParts.PersonalizationScope" />
        <Parameter Name="paths" Type="System.String[]" />
        <Parameter Name="usernames" Type="System.String[]" />
      </Parameters>
      <Docs>
        <param name="scope">A <see cref="T:System.Web.UI.WebControls.WebParts.PersonalizationScope" /> indicating the personalization information to be queried. This value cannot be <see langword="null" />.</param>
        <param name="paths">The paths for personalization information in the <see cref="F:System.Web.UI.WebControls.WebParts.PersonalizationScope.Shared" /> scope to be deleted.</param>
        <param name="usernames">The user names for personalization information in the <see cref="F:System.Web.UI.WebControls.WebParts.PersonalizationScope.User" /> scope to be deleted.</param>
        <summary>Deletes personalization state information from the underlying data store, based on the specified parameters.</summary>
        <returns>The number of rows deleted.</returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 此方法不支持任何通配符。  
  
 允许仅以下的参数组合：  
  
-   `scope`参数设置，并且所有其他参数设置为`null`。 此组合中删除与由个性化设置作用域关联的所有 Web 部件个性化数据`scope`。  
  
-   `scope`参数设置，和`paths`参数包含至少一个值。 此组合中删除指定的路径或由的个性化设置作用域中的路径的所有 Web 部件个性化数据`scope`。  
  
-   `scope`参数设置为<xref:System.Web.UI.WebControls.WebParts.PersonalizationScope.User>、`paths`参数已设置且只包含一个路径和`usernames`参数包含至少一个值。 此组合中删除所有用户个性化设置给定路径或多个用户中包含与该键关联的 Web 部件数据`usernames`。  
  
-   `scope`参数设置为<xref:System.Web.UI.WebControls.WebParts.PersonalizationScope.User>、`paths`参数是`null`，和`usernames`参数包含至少一个值。 此组合跨所有路径或多个用户中包含与关联中删除所有的每个用户个性化 Web 部件数据`usernames`。  
  
 参数值的任何其他组合无效，将引发<xref:System.ArgumentException>异常。 例如，不允许使用以下两个组合：  
  
-   `usernames`参数不能提供时`scope`参数设置为<xref:System.Web.UI.WebControls.WebParts.PersonalizationScope.Shared>。  
  
-   `paths`参数不能包含多个条目时`usernames`参数不是`null`。  
  
 `paths`和`usernames`包含在各自数组参数必须满足以下的验证规则。 如果任何验证规则失败的任何成员的参数数组中，<xref:System.ArgumentException>引发异常。 验证规则包括：  
  
-   `null` 不允许值。  
  
-   空字符串 ("") 不允许在修整字符串后。  
  
-   中包含没有用户名`usernames`参数可以包含逗号。  
  
-   中的任何路径的长度`paths`参数不能大于 256 个字符。  
  
-   在任何用户名称的长度`usernames`参数不能大于 256 个字符。  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentException">Either the <paramref name="paths" /> or the <paramref name="usernames" /> parameter is an empty array.  \- or -  The <paramref name="paths" /> and <paramref name="usernames" /> parameters contained within the respective arrays do not meet the validation rules.</exception>
        <exception cref="T:System.ArgumentOutOfRangeException">The <paramref name="scope" /> specified is not a member of the <see cref="T:System.Web.UI.WebControls.WebParts.PersonalizationScope" /> enumeration.</exception>
      </Docs>
    </Member>
    <Member MemberName="ResetUserState">
      <MemberSignature Language="C#" Value="public override int ResetUserState (string path, DateTime userInactiveSinceDate);" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig virtual instance int32 ResetUserState(string path, valuetype System.DateTime userInactiveSinceDate) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Web.UI.WebControls.WebParts.SqlPersonalizationProvider.ResetUserState(System.String,System.DateTime)" />
      <MemberSignature Language="VB.NET" Value="Public Overrides Function ResetUserState (path As String, userInactiveSinceDate As DateTime) As Integer" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; override int ResetUserState(System::String ^ path, DateTime userInactiveSinceDate);" />
      <MemberSignature Language="F#" Value="override this.ResetUserState : string * DateTime -&gt; int" Usage="sqlPersonalizationProvider.ResetUserState (path, userInactiveSinceDate)" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Web</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Int32</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="path" Type="System.String" />
        <Parameter Name="userInactiveSinceDate" Type="System.DateTime" />
      </Parameters>
      <Docs>
        <param name="path">The path of the personalization data to be deleted. This value can be <see langword="null" /> but cannot be an empty string ("").</param>
        <param name="userInactiveSinceDate">The date indicating the last activity.</param>
        <summary>Deletes user personalization data from the underlying data store, based on the specified parameters.</summary>
        <returns>The count of rows deleted from the underlying data store.</returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 此方法的参数具有以下限制：  
  
-   `path`参数不能包含通配符字符。  
  
-   如果`path`参数为非`null`，然后仅每用户个性化设置记录与关联`path`将被删除。  
  
-   与在指定的日期后被视为处于非活动状态的用户相关联的仅每用户个性化设置记录`userInactiveSinceDate`参数将被删除。 确切的比较就是删除记录其中<xref:System.Web.UI.WebControls.WebParts.UserPersonalizationStateInfo.LastActivityDate%2A>属性小于或等于`userInactiveSinceDate`参数。  
  
-   如果提供了两个参数，则不会删除这两个约束相匹配的记录。  
  
-   `path`参数可以为`null`。  
  
-   `path`参数修整后不能为空字符串。  
  
-   <xref:System.Web.UI.WebControls.WebParts.PersonalizationStateQuery.UserInactiveSinceDate%2A>属性不能为`null`。  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentException">
          <paramref name="path" /> is an empty string.  \- or -  The path is greater than 256 characters in length.</exception>
      </Docs>
    </Member>
    <Member MemberName="SavePersonalizationBlob">
      <MemberSignature Language="C#" Value="protected override void SavePersonalizationBlob (System.Web.UI.WebControls.WebParts.WebPartManager webPartManager, string path, string userName, byte[] dataBlob);" />
      <MemberSignature Language="ILAsm" Value=".method familyhidebysig virtual instance void SavePersonalizationBlob(class System.Web.UI.WebControls.WebParts.WebPartManager webPartManager, string path, string userName, unsigned int8[] dataBlob) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Web.UI.WebControls.WebParts.SqlPersonalizationProvider.SavePersonalizationBlob(System.Web.UI.WebControls.WebParts.WebPartManager,System.String,System.String,System.Byte[])" />
      <MemberSignature Language="C++ CLI" Value="protected:&#xA; override void SavePersonalizationBlob(System::Web::UI::WebControls::WebParts::WebPartManager ^ webPartManager, System::String ^ path, System::String ^ userName, cli::array &lt;System::Byte&gt; ^ dataBlob);" />
      <MemberSignature Language="F#" Value="override this.SavePersonalizationBlob : System.Web.UI.WebControls.WebParts.WebPartManager * string * string * byte[] -&gt; unit" Usage="sqlPersonalizationProvider.SavePersonalizationBlob (webPartManager, path, userName, dataBlob)" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Web</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Void</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="webPartManager" Type="System.Web.UI.WebControls.WebParts.WebPartManager" />
        <Parameter Name="path" Type="System.String" />
        <Parameter Name="userName" Type="System.String" />
        <Parameter Name="dataBlob" Type="System.Byte[]" />
      </Parameters>
      <Docs>
        <param name="webPartManager">The <see cref="T:System.Web.UI.WebControls.WebParts.WebPartManager" /> managing the personalization data.</param>
        <param name="path">A <see cref="T:System.Web.UI.WebControls.WebParts.PersonalizationScope" /> indicating the personalization information to be saved. This value cannot be <see langword="null" />.</param>
        <param name="userName">The user name for personalization information in the <see cref="F:System.Web.UI.WebControls.WebParts.PersonalizationScope.User" /> scope to be used as the key.</param>
        <param name="dataBlob">The byte array of data to be saved.</param>
        <summary>Saves raw personalization data to the underlying Microsoft SQL Server database.</summary>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 如果将非`null`提供用户名称，则`dataBlob`参数包含个性化设置数据<xref:System.Web.UI.WebControls.WebParts.PersonalizationScope.User>范围; 否则为`dataBlob`假定包含的数据<xref:System.Web.UI.WebControls.WebParts.PersonalizationScope.Shared>作用域。  
  
 <xref:System.Web.UI.WebControls.WebParts.SqlPersonalizationProvider>自动更新对象<xref:System.Web.UI.WebControls.WebParts.UserPersonalizationStateInfo.LastActivityDate%2A>中的列`aspnet_Users`每个时间特定于用户的个性化数据保存到一个页面请求的上下文中的数据库的表。 此行为允许使用其他 ASP.NET 功能<xref:System.Web.UI.WebControls.WebParts.UserPersonalizationStateInfo.LastActivityDate%2A>属性时管理陈旧数据记录在站点上以及确定最近的用户活动。  
  
 ]]></format>
        </remarks>
      </Docs>
    </Member>
  </Members>
</Type>