<Type Name="PersonalizationAdministration" FullName="System.Web.UI.WebControls.WebParts.PersonalizationAdministration">
  <Metadata>
    <Meta Name="ms.openlocfilehash" Value="acb0bd0fa0195b14b03b67b77fb03f0600d39648" />
    <Meta Name="ms.sourcegitcommit" Value="5a49536d99d2d0b54e4cb7280870903e043272df" />
    <Meta Name="ms.translationtype" Value="HT" />
    <Meta Name="ms.contentlocale" Value="zh-CN" />
    <Meta Name="ms.lasthandoff" Value="07/03/2018" />
    <Meta Name="ms.locfileid" Value="37538394" />
  </Metadata>
  <TypeSignature Language="C#" Value="public static class PersonalizationAdministration" />
  <TypeSignature Language="ILAsm" Value=".class public auto ansi abstract sealed beforefieldinit PersonalizationAdministration extends System.Object" />
  <TypeSignature Language="DocId" Value="T:System.Web.UI.WebControls.WebParts.PersonalizationAdministration" />
  <TypeSignature Language="VB.NET" Value="Public Class PersonalizationAdministration" />
  <TypeSignature Language="C++ CLI" Value="public ref class PersonalizationAdministration abstract sealed" />
  <TypeSignature Language="F#" Value="type PersonalizationAdministration = class" />
  <AssemblyInfo>
    <AssemblyName>System.Web</AssemblyName>
    <AssemblyVersion>2.0.0.0</AssemblyVersion>
    <AssemblyVersion>4.0.0.0</AssemblyVersion>
  </AssemblyInfo>
  <Base>
    <BaseTypeName>System.Object</BaseTypeName>
  </Base>
  <Interfaces />
  <Docs>
    <summary>Implements management and administrative functionality for Web Parts personalization. This class cannot be inherited.</summary>
    <remarks>
      <format type="text/markdown"><![CDATA[  
  
## Remarks  
 此类提供多个静态方法和属性公开为 Web 部件个性化设置的管理功能。 这些方法应用于配置中的默认个性化设置提供程序<xref:System.Web.UI.WebControls.WebParts.WebPartManager>Web 部件控件的控件。 如果你需要管理充当个性化设置提供程序的多个数据存储，你应直接在单独的个性化设置提供程序类使用方法。 请注意，集合的配置个性化设置提供程序<xref:System.Web.UI.WebControls.WebParts.WebPartManager>控件是可从<xref:System.Web.UI.WebControls.WebParts.PersonalizationAdministration.Providers%2A>静态属性。  
  
 务必要注意，如果 Web 应用程序不会运行在默认信任级别，个性化设置将失败<xref:System.Web.AspNetHostingPermissionLevel.Medium>或更高版本 (可以在 Web.config 文件中使用设置自定义信任级别`<trust level="" />`元素)。 <xref:System.Web.UI.WebControls.WebParts.PersonalizationAdministration>并<xref:System.Web.UI.WebControls.WebParts.SqlPersonalizationProvider>这两个类检查的信任等级<xref:System.Web.AspNetHostingPermissionLevel.Low>初始化时。 如果将应用程序运行在信任级别的配置<xref:System.Web.AspNetHostingPermissionLevel.Low>，并使用默认<xref:System.Web.UI.WebControls.WebParts.SqlPersonalizationProvider>提供程序来管理你的应用程序的个性化设置数据将应用程序尝试访问个性化设置数据的第一个时间失败，因为 ASP.NET 辅助进程中运行<xref:System.Web.AspNetHostingPermissionLevel.Low>信任不具有的各个类中调用所必需的权限<xref:System.Data.SqlClient>命名空间。  
  
   
  
## Examples  
 下面的代码示例演示如何使用多种方法在<xref:System.Web.UI.WebControls.WebParts.PersonalizationAdministration>类。 此示例包含一个.aspx 页面，引用名为的 Web 部件用户控件`Persadmin.ascx`。 下面的代码提供的示例.aspx 文件。  
  
 [!code-aspx-csharp[WebParts_PersAdmin#7](~/samples/snippets/csharp/VS_Snippets_WebNet/WebParts_PersAdmin/CS/defaultcs.aspx#7)]  
  
 此代码提供`Persadmin.ascx`控件。  
  
> [!IMPORTANT]
>  此示例具有一个接受用户输入的文本框，这是一个潜在的安全威胁。 默认情况下，ASP.NET 网页验证用户输入是否不包含脚本或 HTML 元素。 有关详细信息，请参阅[脚本侵入概述](http://msdn.microsoft.com/library/772c7312-211a-4eb3-8d6e-eec0aa1dcc07)。  
  
 [!code-aspx-csharp[WebParts_PersAdmin#1](~/samples/snippets/csharp/VS_Snippets_WebNet/WebParts_PersAdmin/CS/PersAdmin.ascx#1)]  
  
 ]]></format>
    </remarks>
    <altmember cref="T:System.Web.UI.WebControls.WebParts.WebPartPersonalization" />
  </Docs>
  <Members>
    <Member MemberName="ApplicationName">
      <MemberSignature Language="C#" Value="public static string ApplicationName { get; set; }" />
      <MemberSignature Language="ILAsm" Value=".property string ApplicationName" />
      <MemberSignature Language="DocId" Value="P:System.Web.UI.WebControls.WebParts.PersonalizationAdministration.ApplicationName" />
      <MemberSignature Language="VB.NET" Value="Public Shared Property ApplicationName As String" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; static property System::String ^ ApplicationName { System::String ^ get(); void set(System::String ^ value); };" />
      <MemberSignature Language="F#" Value="member this.ApplicationName : string with get, set" Usage="System.Web.UI.WebControls.WebParts.PersonalizationAdministration.ApplicationName" />
      <MemberType>Property</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Web</AssemblyName>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.String</ReturnType>
      </ReturnValue>
      <Docs>
        <summary>Gets or sets the name of the application specified by the provider.</summary>
        <value>应用程序的名称。</value>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 应用程序名称会影响数据检索和保存的个性化设置提供程序，并允许多个应用程序通过设置一个相同的应用程序的名称，共享数据或数据通过指定的同一数据库中的不同分区应用程序名称。 在 Web.config 或 System.config 文件的个性化设置提供程序部分中找到该应用程序名称。  
  
> [!CAUTION]
>  因为服务的所有请求使用单个默认配置文件提供程序实例<xref:System.Web.HttpApplication>对象，可以有多个请求同时执行，并尝试设置<xref:System.Web.UI.WebControls.WebParts.PersonalizationAdministration.ApplicationName%2A>属性值。 <xref:System.Web.UI.WebControls.WebParts.PersonalizationAdministration.ApplicationName%2A>属性不是线程安全的多个写入操作，并更改<xref:System.Web.UI.WebControls.WebParts.PersonalizationAdministration.ApplicationName%2A>属性值可能会导致多个用户的应用程序的意外行为。 建议您避免代码，以允许用户设置<xref:System.Web.UI.WebControls.WebParts.PersonalizationAdministration.ApplicationName%2A>属性所需除外。 应用程序的示例情况<xref:System.Web.UI.WebControls.WebParts.PersonalizationAdministration.ApplicationName%2A>属性可能需要是管理多个应用程序的配置文件数据的管理应用程序。 此类应用程序应在单用户应用程序并不是 Web 应用程序。  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentException">The provider for a personalization provider defined in configuration is not of the correct type.</exception>
        <exception cref="T:System.Configuration.ConfigurationErrorsException">A configuration exception occurred while attempting to create and initialize an instance of one of the configured personalization providers.  \- or -  The default personalization provider defined in configuration could not be found.</exception>
        <altmember cref="T:System.Web.UI.WebControls.WebParts.WebPartPersonalization" />
      </Docs>
    </Member>
    <MemberGroup MemberName="FindInactiveUserState">
      <AssemblyInfo>
        <AssemblyName>System.Web</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Docs>
        <summary>Returns a collection of per-user personalization state information for inactive users, based on the specified parameters.</summary>
        <altmember cref="T:System.Web.UI.WebControls.WebParts.WebPartPersonalization" />
      </Docs>
    </MemberGroup>
    <Member MemberName="FindInactiveUserState">
      <MemberSignature Language="C#" Value="public static System.Web.UI.WebControls.WebParts.PersonalizationStateInfoCollection FindInactiveUserState (string pathToMatch, string usernameToMatch, DateTime userInactiveSinceDate);" />
      <MemberSignature Language="ILAsm" Value=".method public static hidebysig class System.Web.UI.WebControls.WebParts.PersonalizationStateInfoCollection FindInactiveUserState(string pathToMatch, string usernameToMatch, valuetype System.DateTime userInactiveSinceDate) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Web.UI.WebControls.WebParts.PersonalizationAdministration.FindInactiveUserState(System.String,System.String,System.DateTime)" />
      <MemberSignature Language="VB.NET" Value="Public Shared Function FindInactiveUserState (pathToMatch As String, usernameToMatch As String, userInactiveSinceDate As DateTime) As PersonalizationStateInfoCollection" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; static System::Web::UI::WebControls::WebParts::PersonalizationStateInfoCollection ^ FindInactiveUserState(System::String ^ pathToMatch, System::String ^ usernameToMatch, DateTime userInactiveSinceDate);" />
      <MemberSignature Language="F#" Value="static member FindInactiveUserState : string * string * DateTime -&gt; System.Web.UI.WebControls.WebParts.PersonalizationStateInfoCollection" Usage="System.Web.UI.WebControls.WebParts.PersonalizationAdministration.FindInactiveUserState (pathToMatch, usernameToMatch, userInactiveSinceDate)" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Web</AssemblyName>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Web.UI.WebControls.WebParts.PersonalizationStateInfoCollection</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="pathToMatch" Type="System.String" />
        <Parameter Name="usernameToMatch" Type="System.String" />
        <Parameter Name="userInactiveSinceDate" Type="System.DateTime" />
      </Parameters>
      <Docs>
        <param name="pathToMatch">The path of the page to match.</param>
        <param name="usernameToMatch">The user name to match that has personalization data associated with the page.</param>
        <param name="userInactiveSinceDate">The last date a user's personalization information was accessed.</param>
        <summary>Returns a collection of per-user personalization state information for inactive users, based on the specified parameters.</summary>
        <returns>A <see cref="T:System.Web.UI.WebControls.WebParts.PersonalizationStateInfoCollection" /> that contains per-user personalization state information.</returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 此方法返回的集合<xref:System.Web.UI.WebControls.WebParts.UserPersonalizationStateInfo>实例，每用户个性化设置状态信息位置`pathToMatch`参数值匹配的页上，路径`usernameToMatch`具有关联的个性化设置数据的用户名称匹配页上和用户被视为处于非活动状态。 换而言之，对于每个返回记录用户的<xref:System.Web.UI.WebControls.WebParts.UserPersonalizationStateInfo.LastActivityDate%2A>属性值是否小于或等于`userInactiveSinceDate`。 返回的集合仅包含<xref:System.Web.UI.WebControls.WebParts.UserPersonalizationStateInfo>实例。  
  
 此方法将查询通配符字符传递给基础数据存储区。 对通配符字符的支持是当前依赖于每个提供程序如何处理字符，如星号 （*）、 百分号 （%） 或下划线 (_)。  
  
 通常情况下，对于符合 SQL 数据存储，你可以执行通配符搜索分部路径上加上使其不显示在开头、 末尾或搜索字符串文本中的中间的通配符<xref:System.Web.UI.WebControls.WebParts.PersonalizationStateQuery.PathToMatch%2A>属性。 例如，若要查找以"~/vdir"开头的所有路径<xref:System.Web.UI.WebControls.WebParts.PersonalizationStateQuery.PathToMatch%2A>属性将设置为"~/vdir%"。  
  
 同样，对部分用户名执行通配符搜索可以允许显示的文本字符串中的任意位置的通配符字符<xref:System.Web.UI.WebControls.WebParts.PersonalizationStateQuery.UsernameToMatch%2A>属性。 例如，若要查找与"John"开头的所有用户名称<xref:System.Web.UI.WebControls.WebParts.PersonalizationStateQuery.UsernameToMatch%2A>属性如下所示"John %"。  
  
 使用默认的个性化设置提供程序， <xref:System.Web.UI.WebControls.WebParts.PersonalizationStateInfo>-派生的对象返回按字母顺序，并按升序排序的路径和用户名称的组合。 集合中对象的顺序确定提供程序。  
  
 如果`userInactiveSinceDate`是<xref:System.DateTime.MaxValue>，则此方法的返回的值不等效于<xref:System.Web.UI.WebControls.WebParts.PersonalizationAdministration.FindUserState%2A>。  
  
 这两`pathToMatch`并`usernameToMatch`可以是`null`。 `usernameToMatch`参数可以包含逗号 （，），因为某些数据存储，例如运行 Microsoft SQL Server，允许使用逗号作为通配符。  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentException">
          <paramref name="pathToMatch" /> or <paramref name="usernameToMatch" /> before or after trimming is an empty string ("").  \- or -  The provider for a personalization provider defined in configuration is not of the correct type.  \- or -  The length of the string of any parameter is greater than 256 characters.</exception>
        <exception cref="T:System.Configuration.ConfigurationErrorsException">A configuration exception occurred while attempting to create and initialize an instance of one of the configured personalization providers.  \- or -  The default personalization provider defined in configuration could not be found.</exception>
        <altmember cref="T:System.Web.UI.WebControls.WebParts.WebPartPersonalization" />
      </Docs>
    </Member>
    <Member MemberName="FindInactiveUserState">
      <MemberSignature Language="C#" Value="public static System.Web.UI.WebControls.WebParts.PersonalizationStateInfoCollection FindInactiveUserState (string pathToMatch, string usernameToMatch, DateTime userInactiveSinceDate, int pageIndex, int pageSize, out int totalRecords);" />
      <MemberSignature Language="ILAsm" Value=".method public static hidebysig class System.Web.UI.WebControls.WebParts.PersonalizationStateInfoCollection FindInactiveUserState(string pathToMatch, string usernameToMatch, valuetype System.DateTime userInactiveSinceDate, int32 pageIndex, int32 pageSize, [out] int32&amp; totalRecords) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Web.UI.WebControls.WebParts.PersonalizationAdministration.FindInactiveUserState(System.String,System.String,System.DateTime,System.Int32,System.Int32,System.Int32@)" />
      <MemberSignature Language="VB.NET" Value="Public Shared Function FindInactiveUserState (pathToMatch As String, usernameToMatch As String, userInactiveSinceDate As DateTime, pageIndex As Integer, pageSize As Integer, ByRef totalRecords As Integer) As PersonalizationStateInfoCollection" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; static System::Web::UI::WebControls::WebParts::PersonalizationStateInfoCollection ^ FindInactiveUserState(System::String ^ pathToMatch, System::String ^ usernameToMatch, DateTime userInactiveSinceDate, int pageIndex, int pageSize, [Runtime::InteropServices::Out] int % totalRecords);" />
      <MemberSignature Language="F#" Value="static member FindInactiveUserState : string * string * DateTime * int * int *  -&gt; System.Web.UI.WebControls.WebParts.PersonalizationStateInfoCollection" Usage="System.Web.UI.WebControls.WebParts.PersonalizationAdministration.FindInactiveUserState (pathToMatch, usernameToMatch, userInactiveSinceDate, pageIndex, pageSize, totalRecords)" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Web</AssemblyName>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Web.UI.WebControls.WebParts.PersonalizationStateInfoCollection</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="pathToMatch" Type="System.String" />
        <Parameter Name="usernameToMatch" Type="System.String" />
        <Parameter Name="userInactiveSinceDate" Type="System.DateTime" />
        <Parameter Name="pageIndex" Type="System.Int32" />
        <Parameter Name="pageSize" Type="System.Int32" />
        <Parameter Name="totalRecords" Type="System.Int32&amp;" RefType="out" />
      </Parameters>
      <Docs>
        <param name="pathToMatch">The path of the page to match.</param>
        <param name="usernameToMatch">The user name to match that has personalization data associated with the page.</param>
        <param name="userInactiveSinceDate">The last date personalization information was accessed.</param>
        <param name="pageIndex">The zero-based index of the page of results to return.</param>
        <param name="pageSize">The number of records to return.</param>
        <param name="totalRecords">The total number of records available.</param>
        <summary>Returns a collection of per-user personalization state information for inactive users, based on the specified parameters.</summary>
        <returns>A <see cref="T:System.Web.UI.WebControls.WebParts.PersonalizationStateInfoCollection" /> that contains per-user personalization state information.</returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 此方法返回的集合<xref:System.Web.UI.WebControls.WebParts.UserPersonalizationStateInfo>实例，每用户个性化设置状态信息位置`pathToMatch`参数值匹配的页上，路径`usernameToMatch`具有关联的个性化设置数据的用户名称匹配页上和用户被视为处于非活动状态。 换而言之，对于每个返回记录用户的<xref:System.Web.UI.WebControls.WebParts.UserPersonalizationStateInfo.LastActivityDate%2A>属性值是否小于或等于`userInactiveSinceDate`。 集合仅包含<xref:System.Web.UI.WebControls.WebParts.UserPersonalizationStateInfo>实例。  
  
 此方法将参数通配符字符传递给基础个性化设置提供程序，那么，如何在数据存储区处理这些字符取决于提供程序如何处理字符，如星号 （*）、 百分号 （%） 或下划线 (_)。  
  
 通常情况下，对于符合 SQL 数据存储，你可以执行通配符搜索分部路径上加上使其不显示在开头、 末尾或搜索字符串文本中的中间的通配符<xref:System.Web.UI.WebControls.WebParts.PersonalizationStateQuery.PathToMatch%2A>属性。 例如，若要查找以"~/vdir"开头的所有路径<xref:System.Web.UI.WebControls.WebParts.PersonalizationStateQuery.PathToMatch%2A>属性将设置为"~/vdir%"。  
  
 同样，对部分用户名执行通配符搜索可以允许显示的文本字符串中的任意位置的通配符字符<xref:System.Web.UI.WebControls.WebParts.PersonalizationStateQuery.UsernameToMatch%2A>属性。 例如，若要查找与"John"开头的所有用户名称<xref:System.Web.UI.WebControls.WebParts.PersonalizationStateQuery.UsernameToMatch%2A>属性如下所示"John %"。  
  
 使用默认的个性化设置提供程序， <xref:System.Web.UI.WebControls.WebParts.PersonalizationStateInfo>-派生的对象返回按字母顺序，并按升序排序的路径和用户名称的组合。 集合中对象的顺序确定提供程序。  
  
 如果`userInactiveSinceDate`是<xref:System.DateTime.MaxValue>，则此方法的返回的值不等效于<xref:System.Web.UI.WebControls.WebParts.PersonalizationAdministration.FindUserState%2A>。  
  
 这两`pathToMatch`并`usernameToMatch`可以是`null`。 `usernameToMatch`参数可以具有逗号 （，），因为某些数据存储，例如运行 Microsoft SQL Server，允许使用逗号作为通配符。  
  
 返回的数据受到`pageIndex`并`pageSize`，其中`pageIndex`控制要返回哪些记录和`pageSize`控制要返回的记录数。 例如，如果`pageIndex`设置为 0 和`pageSize`已设置为 25，返回的数据将是前 25 个项。 如果`pageIndex`设置为 1 和`pageSize`已设置为 25，返回的数据将是 26 到 50 个项。 `totalRecords`参数返回可用的记录总数。  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentException">
          <paramref name="pathToMatch" /> or <paramref name="usernameToMatch" /> before or after trimming is an empty string ("").  \- or -  <paramref name="pageIndex" /> is less than zero  \- or -  <paramref name="pageSize" /> is less than or equal to zero.  \- or -  the combination of <paramref name="pageIndex" /> and <paramref name="pageSize" /> exceeds <see cref="F:System.Int32.MaxValue" />.  \- or -  The provider for a personalization provider defined in configuration is not of the correct type.  \- or -  The length of the string of any parameter is greater than 256 characters.</exception>
        <exception cref="T:System.Configuration.ConfigurationErrorsException">A configuration exception occurred while attempting to create and initialize an instance of one of the configured personalization providers.  \- or -  The default personalization provider defined in configuration could not be found.</exception>
        <altmember cref="T:System.Web.UI.WebControls.WebParts.WebPartPersonalization" />
      </Docs>
    </Member>
    <MemberGroup MemberName="FindSharedState">
      <AssemblyInfo>
        <AssemblyName>System.Web</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Docs>
        <summary>Returns a collection of shared personalization state information based on the specified parameters.</summary>
        <altmember cref="T:System.Web.UI.WebControls.WebParts.WebPartPersonalization" />
      </Docs>
    </MemberGroup>
    <Member MemberName="FindSharedState">
      <MemberSignature Language="C#" Value="public static System.Web.UI.WebControls.WebParts.PersonalizationStateInfoCollection FindSharedState (string pathToMatch);" />
      <MemberSignature Language="ILAsm" Value=".method public static hidebysig class System.Web.UI.WebControls.WebParts.PersonalizationStateInfoCollection FindSharedState(string pathToMatch) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Web.UI.WebControls.WebParts.PersonalizationAdministration.FindSharedState(System.String)" />
      <MemberSignature Language="VB.NET" Value="Public Shared Function FindSharedState (pathToMatch As String) As PersonalizationStateInfoCollection" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; static System::Web::UI::WebControls::WebParts::PersonalizationStateInfoCollection ^ FindSharedState(System::String ^ pathToMatch);" />
      <MemberSignature Language="F#" Value="static member FindSharedState : string -&gt; System.Web.UI.WebControls.WebParts.PersonalizationStateInfoCollection" Usage="System.Web.UI.WebControls.WebParts.PersonalizationAdministration.FindSharedState pathToMatch" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Web</AssemblyName>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Web.UI.WebControls.WebParts.PersonalizationStateInfoCollection</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="pathToMatch" Type="System.String" />
      </Parameters>
      <Docs>
        <param name="pathToMatch">The path of the page to match.</param>
        <summary>Returns a collection of shared personalization state information based on the specified path.</summary>
        <returns>A <see cref="T:System.Web.UI.WebControls.WebParts.PersonalizationStateInfoCollection" /> that contains shared personalization state information.</returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 此方法返回的集合<xref:System.Web.UI.WebControls.WebParts.UserPersonalizationStateInfo>实例`pathToMatch`值匹配具有共享个性化设置状态数据页的路径。 集合仅包含<xref:System.Web.UI.WebControls.WebParts.SharedPersonalizationStateInfo>实例。  
  
 此方法将参数通配符字符传递给基础个性化设置提供程序，那么，如何在数据存储区处理这些字符取决于提供程序如何处理字符，如星号 （*）、 百分号 （%） 或下划线 (_)。  
  
 通常情况下，对于符合 SQL 数据存储，你可以执行通配符搜索分部路径上加上使其不显示在开头、 末尾或搜索字符串文本中的中间的通配符<xref:System.Web.UI.WebControls.WebParts.PersonalizationStateQuery.PathToMatch%2A>属性。 例如，若要查找以"~/vdir"开头的所有路径<xref:System.Web.UI.WebControls.WebParts.PersonalizationStateQuery.PathToMatch%2A>属性将设置为"~/vdir%"。  
  
 使用默认的个性化设置提供程序， <xref:System.Web.UI.WebControls.WebParts.PersonalizationStateInfo>-派生的对象返回按字母顺序，并按升序排序的路径和用户名称的组合。 集合中对象的顺序取决于提供程序。  
  
 `pathToMatch`参数可以是`null`。 如果设置为`null`，在执行查询时，会忽略此参数。  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentException">
          <paramref name="pathToMatch" /> is an empty string ("") either before or after trimming.  \- or -  The provider for a personalization provider defined in configuration is not of the correct type.  \- or -  The length of the string of any parameter is greater than 256 characters.</exception>
        <exception cref="T:System.Configuration.ConfigurationErrorsException">A configuration exception occurred while attempting to create and initialize an instance of one of the configured personalization providers.  \- or -  The default personalization provider defined in configuration could not be found.</exception>
        <altmember cref="T:System.Web.UI.WebControls.WebParts.WebPartPersonalization" />
      </Docs>
    </Member>
    <Member MemberName="FindSharedState">
      <MemberSignature Language="C#" Value="public static System.Web.UI.WebControls.WebParts.PersonalizationStateInfoCollection FindSharedState (string pathToMatch, int pageIndex, int pageSize, out int totalRecords);" />
      <MemberSignature Language="ILAsm" Value=".method public static hidebysig class System.Web.UI.WebControls.WebParts.PersonalizationStateInfoCollection FindSharedState(string pathToMatch, int32 pageIndex, int32 pageSize, [out] int32&amp; totalRecords) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Web.UI.WebControls.WebParts.PersonalizationAdministration.FindSharedState(System.String,System.Int32,System.Int32,System.Int32@)" />
      <MemberSignature Language="VB.NET" Value="Public Shared Function FindSharedState (pathToMatch As String, pageIndex As Integer, pageSize As Integer, ByRef totalRecords As Integer) As PersonalizationStateInfoCollection" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; static System::Web::UI::WebControls::WebParts::PersonalizationStateInfoCollection ^ FindSharedState(System::String ^ pathToMatch, int pageIndex, int pageSize, [Runtime::InteropServices::Out] int % totalRecords);" />
      <MemberSignature Language="F#" Value="static member FindSharedState : string * int * int *  -&gt; System.Web.UI.WebControls.WebParts.PersonalizationStateInfoCollection" Usage="System.Web.UI.WebControls.WebParts.PersonalizationAdministration.FindSharedState (pathToMatch, pageIndex, pageSize, totalRecords)" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Web</AssemblyName>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Web.UI.WebControls.WebParts.PersonalizationStateInfoCollection</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="pathToMatch" Type="System.String" />
        <Parameter Name="pageIndex" Type="System.Int32" />
        <Parameter Name="pageSize" Type="System.Int32" />
        <Parameter Name="totalRecords" Type="System.Int32&amp;" RefType="out" />
      </Parameters>
      <Docs>
        <param name="pathToMatch">The path of the page to match.</param>
        <param name="pageIndex">The zero-based index of the page of results to return.</param>
        <param name="pageSize">The number of records to return.</param>
        <param name="totalRecords">The total number of records available.</param>
        <summary>Returns a collection of shared personalization state information based on the specified parameters.</summary>
        <returns>A <see cref="T:System.Web.UI.WebControls.WebParts.PersonalizationStateInfoCollection" /> that contains shared personalization state information.</returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 此方法返回的集合<xref:System.Web.UI.WebControls.WebParts.UserPersonalizationStateInfo>实例`pathToMatch`值匹配具有共享个性化设置状态数据页的路径。 集合仅包含<xref:System.Web.UI.WebControls.WebParts.SharedPersonalizationStateInfo>实例。  
  
 此方法将参数通配符字符传递给基础个性化设置提供程序，那么，如何在数据存储区处理这些字符取决于提供程序如何处理字符，如星号 （*）、 百分号 （%） 或下划线 (_)。  
  
 通常情况下，对于符合 SQL 数据存储，你可以执行通配符搜索分部路径上加上使其不显示在开头、 末尾或搜索字符串文本中的中间的通配符<xref:System.Web.UI.WebControls.WebParts.PersonalizationStateQuery.PathToMatch%2A>属性。 例如，若要查找以"~/vdir"开头的所有路径<xref:System.Web.UI.WebControls.WebParts.PersonalizationStateQuery.PathToMatch%2A>属性将设置为"~/vdir%"。  
  
 使用默认的个性化设置提供程序， <xref:System.Web.UI.WebControls.WebParts.PersonalizationStateInfo>-派生的对象返回按字母顺序，并按升序排序的路径和用户名称的组合。 集合中对象的顺序确定提供程序。  
  
 `pathToMatch`参数可以是`null`。 如果设置为`null`，在执行查询时，会忽略此参数。  
  
 返回的数据受到`pageIndex`并`pageSize`，其中`pageIndex`控制要返回哪些记录和`pageSize`控制要返回的记录数。 例如，如果`pageIndex`设置为 0 和`pageSize`已设置为 25，返回的数据将是前 25 个项。 如果`pageIndex`设置为 1 和`pageSize`已设置为 25，返回的数据将是 26 到 50 个项。 `totalRecords`参数返回可用的记录总数。  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentException">
          <paramref name="pathToMatch" /> before or after trimming is an empty string ("").  \- or -  <paramref name="pageIndex" /> is less than zero.  \- or -  <paramref name="pageSize" /> is less than or equal to zero.  \- or -  The combination of <paramref name="pageIndex" /> and <paramref name="pageSize" /> exceeds <see cref="F:System.Int32.MaxValue" />.  \- or -  The provider for a personalization provider defined in configuration is not of the correct type.  \- or -  The length of the string of any parameter is greater than 256 characters.</exception>
        <exception cref="T:System.Configuration.ConfigurationErrorsException">A configuration exception occurred while attempting to create and initialize an instance of one of the configured personalization providers.  \- or -  The default personalization provider defined in configuration could not be found.</exception>
        <altmember cref="T:System.Web.UI.WebControls.WebParts.WebPartPersonalization" />
      </Docs>
    </Member>
    <MemberGroup MemberName="FindUserState">
      <AssemblyInfo>
        <AssemblyName>System.Web</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Docs>
        <summary>Returns a collection of per-user personalization state information based on the specified parameters.</summary>
        <altmember cref="T:System.Web.UI.WebControls.WebParts.WebPartPersonalization" />
      </Docs>
    </MemberGroup>
    <Member MemberName="FindUserState">
      <MemberSignature Language="C#" Value="public static System.Web.UI.WebControls.WebParts.PersonalizationStateInfoCollection FindUserState (string pathToMatch, string usernameToMatch);" />
      <MemberSignature Language="ILAsm" Value=".method public static hidebysig class System.Web.UI.WebControls.WebParts.PersonalizationStateInfoCollection FindUserState(string pathToMatch, string usernameToMatch) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Web.UI.WebControls.WebParts.PersonalizationAdministration.FindUserState(System.String,System.String)" />
      <MemberSignature Language="VB.NET" Value="Public Shared Function FindUserState (pathToMatch As String, usernameToMatch As String) As PersonalizationStateInfoCollection" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; static System::Web::UI::WebControls::WebParts::PersonalizationStateInfoCollection ^ FindUserState(System::String ^ pathToMatch, System::String ^ usernameToMatch);" />
      <MemberSignature Language="F#" Value="static member FindUserState : string * string -&gt; System.Web.UI.WebControls.WebParts.PersonalizationStateInfoCollection" Usage="System.Web.UI.WebControls.WebParts.PersonalizationAdministration.FindUserState (pathToMatch, usernameToMatch)" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Web</AssemblyName>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Web.UI.WebControls.WebParts.PersonalizationStateInfoCollection</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="pathToMatch" Type="System.String" />
        <Parameter Name="usernameToMatch" Type="System.String" />
      </Parameters>
      <Docs>
        <param name="pathToMatch">The path of the page to match.</param>
        <param name="usernameToMatch">The user name to match that has personalization data associated with the page.</param>
        <summary>Returns a collection of per-user personalization state information based on the user name and page path.</summary>
        <returns>A <see cref="T:System.Web.UI.WebControls.WebParts.PersonalizationStateInfoCollection" /> that contains per-user personalization state information.</returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 此方法返回的集合<xref:System.Web.UI.WebControls.WebParts.UserPersonalizationStateInfo>实例的位置`pathToMatch`参数值匹配的页上，路径和`usernameToMatch`匹配具有与该页关联的个性化设置数据的用户名称。 集合仅包含<xref:System.Web.UI.WebControls.WebParts.UserPersonalizationStateInfo>实例。  
  
 此方法将参数通配符字符传递给基础个性化设置提供程序，那么，如何在数据存储区处理这些字符取决于提供程序如何处理字符，如星号 （*）、 百分号 （%） 或下划线 (_)。  
  
 通常情况下，对于符合 SQL 数据存储，你可以执行通配符搜索分部路径上加上使其不显示在开头、 末尾或搜索字符串文本中的中间的通配符<xref:System.Web.UI.WebControls.WebParts.PersonalizationStateQuery.PathToMatch%2A>属性。 例如，若要查找以"~/vdir"开头的所有路径<xref:System.Web.UI.WebControls.WebParts.PersonalizationStateQuery.PathToMatch%2A>属性将设置为"~/vdir%"。  
  
 同样，对部分用户名执行通配符搜索可以允许显示的文本字符串中的任意位置的通配符字符<xref:System.Web.UI.WebControls.WebParts.PersonalizationStateQuery.UsernameToMatch%2A>属性。 例如，若要查找与"John"开头的所有用户名称<xref:System.Web.UI.WebControls.WebParts.PersonalizationStateQuery.UsernameToMatch%2A>属性如下所示"John %"。  
  
 使用默认的个性化设置提供程序， <xref:System.Web.UI.WebControls.WebParts.PersonalizationStateInfo>-派生的对象返回按字母顺序，并按升序排序的路径和用户名称的组合。 集合中对象的顺序取决于提供程序。  
  
 这两`pathToMatch`并`usernameToMatch`可以是`null`。 `usernameToMatch`参数可以具有逗号 （，），因为某些数据存储，例如运行 Microsoft SQL Server，允许使用逗号作为通配符。  
  
   
  
## Examples  
 下面的代码示例演示如何使用 <xref:System.Web.UI.WebControls.WebParts.PersonalizationAdministration.FindUserState%2A> 方法。 完整的示例可在<xref:System.Web.UI.WebControls.WebParts.PersonalizationAdministration>类概述主题。  
  
> [!IMPORTANT]
>  此示例具有一个接受用户输入的文本框，这是一个潜在的安全威胁。 默认情况下，ASP.NET 网页验证用户输入是否不包含脚本或 HTML 元素。 有关详细信息，请参阅[脚本侵入概述](http://msdn.microsoft.com/library/772c7312-211a-4eb3-8d6e-eec0aa1dcc07)。  
  
 [!code-csharp[WebParts_PersAdmin#2](~/samples/snippets/csharp/VS_Snippets_WebNet/WebParts_PersAdmin/CS/PersAdmin.ascx#2)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentException">
          <paramref name="pathToMatch" /> or <paramref name="usernameToMatch" /> before or after trimming is an empty string ("").  \- or -  The provider for a personalization provider defined in configuration is not of the correct type.  \- or -  The length of the string of any parameter is greater than 256 characters.</exception>
        <exception cref="T:System.Configuration.ConfigurationErrorsException">A configuration exception occurred while attempting to create and initialize an instance of one of the configured personalization providers.  \- or -  The default personalization provider defined in configuration could not be found.</exception>
        <altmember cref="T:System.Web.UI.WebControls.WebParts.WebPartPersonalization" />
      </Docs>
    </Member>
    <Member MemberName="FindUserState">
      <MemberSignature Language="C#" Value="public static System.Web.UI.WebControls.WebParts.PersonalizationStateInfoCollection FindUserState (string pathToMatch, string usernameToMatch, int pageIndex, int pageSize, out int totalRecords);" />
      <MemberSignature Language="ILAsm" Value=".method public static hidebysig class System.Web.UI.WebControls.WebParts.PersonalizationStateInfoCollection FindUserState(string pathToMatch, string usernameToMatch, int32 pageIndex, int32 pageSize, [out] int32&amp; totalRecords) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Web.UI.WebControls.WebParts.PersonalizationAdministration.FindUserState(System.String,System.String,System.Int32,System.Int32,System.Int32@)" />
      <MemberSignature Language="VB.NET" Value="Public Shared Function FindUserState (pathToMatch As String, usernameToMatch As String, pageIndex As Integer, pageSize As Integer, ByRef totalRecords As Integer) As PersonalizationStateInfoCollection" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; static System::Web::UI::WebControls::WebParts::PersonalizationStateInfoCollection ^ FindUserState(System::String ^ pathToMatch, System::String ^ usernameToMatch, int pageIndex, int pageSize, [Runtime::InteropServices::Out] int % totalRecords);" />
      <MemberSignature Language="F#" Value="static member FindUserState : string * string * int * int *  -&gt; System.Web.UI.WebControls.WebParts.PersonalizationStateInfoCollection" Usage="System.Web.UI.WebControls.WebParts.PersonalizationAdministration.FindUserState (pathToMatch, usernameToMatch, pageIndex, pageSize, totalRecords)" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Web</AssemblyName>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Web.UI.WebControls.WebParts.PersonalizationStateInfoCollection</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="pathToMatch" Type="System.String" />
        <Parameter Name="usernameToMatch" Type="System.String" />
        <Parameter Name="pageIndex" Type="System.Int32" />
        <Parameter Name="pageSize" Type="System.Int32" />
        <Parameter Name="totalRecords" Type="System.Int32&amp;" RefType="out" />
      </Parameters>
      <Docs>
        <param name="pathToMatch">The path of the page to match.</param>
        <param name="usernameToMatch">The user name to match that has personalization data associated with the page.</param>
        <param name="pageIndex">The zero-based index of the page of results to return.</param>
        <param name="pageSize">The number of records to return.</param>
        <param name="totalRecords">The total number or records available.</param>
        <summary>Returns a collection of per-user personalization state information based on the specified parameters.</summary>
        <returns>A <see cref="T:System.Web.UI.WebControls.WebParts.PersonalizationStateInfoCollection" /> that contains per-user personalization state information.</returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 此方法返回的集合<xref:System.Web.UI.WebControls.WebParts.UserPersonalizationStateInfo>实例的位置`pathToMatch`参数值匹配的页的路径和`usernameToMatch`匹配具有与该页关联的个性化设置数据的用户名称。 集合仅包含<xref:System.Web.UI.WebControls.WebParts.UserPersonalizationStateInfo>实例。  
  
 此方法将参数通配符字符传递给基础个性化设置提供程序，那么，如何在数据存储区处理这些字符取决于提供程序作为一个星号 （*）、 百分号 （%） 或下划线 (_) 处理字符的方式。  
  
 通常情况下，对于符合 SQL 数据存储，你可以执行通配符搜索分部路径上加上使其不显示在开头、 末尾或搜索字符串文本中的中间的通配符<xref:System.Web.UI.WebControls.WebParts.PersonalizationStateQuery.PathToMatch%2A>属性。 例如，若要查找以"~/vdir"开头的所有路径<xref:System.Web.UI.WebControls.WebParts.PersonalizationStateQuery.PathToMatch%2A>属性将设置为"~/vdir%"。  
  
 同样，对部分用户名执行通配符搜索可以允许显示的文本字符串中的任意位置的通配符字符<xref:System.Web.UI.WebControls.WebParts.PersonalizationStateQuery.UsernameToMatch%2A>属性。 例如，若要查找与"John"开头的所有用户名称<xref:System.Web.UI.WebControls.WebParts.PersonalizationStateQuery.UsernameToMatch%2A>属性如下所示"John %"。  
  
 使用默认的个性化设置提供程序， <xref:System.Web.UI.WebControls.WebParts.PersonalizationStateInfo>-派生的对象返回按字母顺序，并按升序排序的路径和用户名称的组合。 集合中对象的顺序确定提供程序。  
  
 这两`pathToMatch`并`usernameToMatch`可以是`null`。 `usernameToMatch`参数可以具有逗号 （，），因为某些数据存储，例如运行 Microsoft SQL Server，允许使用逗号作为通配符。  
  
 返回的数据受到`pageIndex`并`pageSize`，其中`pageIndex`控制要返回哪些记录和`pageSize`控制要返回的记录数。 例如，如果`pageIndex`设置为 0 和`pageSize`已设置为 25，返回的数据将是前 25 个项。 如果`pageIndex`设置为 1 和`pageSize`已设置为 25，返回的数据将是 26 到 50 个项。 `totalRecords`参数返回可用的记录总数。  
  
   
  
## Examples  
 下面的代码示例演示如何使用 <xref:System.Web.UI.WebControls.WebParts.PersonalizationAdministration.FindUserState%2A> 方法。 完整的示例可在<xref:System.Web.UI.WebControls.WebParts.PersonalizationAdministration>类概述主题。  
  
> [!IMPORTANT]
>  此示例具有一个接受用户输入的文本框，这是一个潜在的安全威胁。 默认情况下，ASP.NET 网页验证用户输入是否不包含脚本或 HTML 元素。 有关详细信息，请参阅[脚本侵入概述](http://msdn.microsoft.com/library/772c7312-211a-4eb3-8d6e-eec0aa1dcc07)。  
  
 [!code-csharp[WebParts_PersAdmin#2](~/samples/snippets/csharp/VS_Snippets_WebNet/WebParts_PersAdmin/CS/PersAdmin.ascx#2)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentException">
          <paramref name="pathToMatch" /> or <paramref name="usernameToMatch" /> before or after trimming is an empty string ("").  \- or -  <paramref name="pageIndex" /> is less than zero.  \- or -  <paramref name="pageSize" /> is less than or equal to zero.  -or-  The combination of <paramref name="pageIndex" /> and <paramref name="pageSize" /> exceeds <see cref="F:System.Int32.MaxValue" />.  \- or -  The provider for a personalization provider defined in configuration is not of the correct type.  \- or -  The length of the string of any parameter is greater than 256 characters.</exception>
        <exception cref="T:System.Configuration.ConfigurationErrorsException">A configuration exception occurred while attempting to create and initialize an instance of one of the configured personalization providers.  \- or -  The default personalization provider defined in configuration could not be found.</exception>
        <altmember cref="T:System.Web.UI.WebControls.WebParts.WebPartPersonalization" />
      </Docs>
    </Member>
    <MemberGroup MemberName="GetAllInactiveUserState">
      <AssemblyInfo>
        <AssemblyName>System.Web</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Docs>
        <summary>Returns a collection of all per-user personalization state information associated with inactive users.</summary>
        <altmember cref="T:System.Web.UI.WebControls.WebParts.WebPartPersonalization" />
      </Docs>
    </MemberGroup>
    <Member MemberName="GetAllInactiveUserState">
      <MemberSignature Language="C#" Value="public static System.Web.UI.WebControls.WebParts.PersonalizationStateInfoCollection GetAllInactiveUserState (DateTime userInactiveSinceDate);" />
      <MemberSignature Language="ILAsm" Value=".method public static hidebysig class System.Web.UI.WebControls.WebParts.PersonalizationStateInfoCollection GetAllInactiveUserState(valuetype System.DateTime userInactiveSinceDate) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Web.UI.WebControls.WebParts.PersonalizationAdministration.GetAllInactiveUserState(System.DateTime)" />
      <MemberSignature Language="VB.NET" Value="Public Shared Function GetAllInactiveUserState (userInactiveSinceDate As DateTime) As PersonalizationStateInfoCollection" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; static System::Web::UI::WebControls::WebParts::PersonalizationStateInfoCollection ^ GetAllInactiveUserState(DateTime userInactiveSinceDate);" />
      <MemberSignature Language="F#" Value="static member GetAllInactiveUserState : DateTime -&gt; System.Web.UI.WebControls.WebParts.PersonalizationStateInfoCollection" Usage="System.Web.UI.WebControls.WebParts.PersonalizationAdministration.GetAllInactiveUserState userInactiveSinceDate" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Web</AssemblyName>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Web.UI.WebControls.WebParts.PersonalizationStateInfoCollection</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="userInactiveSinceDate" Type="System.DateTime" />
      </Parameters>
      <Docs>
        <param name="userInactiveSinceDate">The last date a user's personalization information was accessed.</param>
        <summary>Returns a collection of all per-user personalization state information associated with inactive users, based on the specified date.</summary>
        <returns>A collection of <see cref="T:System.Web.UI.WebControls.WebParts.UserPersonalizationStateInfo" /> instances.</returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 返回的集合仅包含<xref:System.Web.UI.WebControls.WebParts.UserPersonalizationStateInfo>实例。 使用默认的个性化设置提供程序， <xref:System.Web.UI.WebControls.WebParts.PersonalizationStateInfo>-派生的对象返回按字母顺序，并按升序排序的路径和用户名称的组合。 集合中对象的顺序确定提供程序。  
  
 此方法返回的项的用户的<xref:System.Web.UI.WebControls.WebParts.UserPersonalizationStateInfo.LastActivityDate%2A>属性值是否小于或等于<xref:System.Web.UI.WebControls.WebParts.PersonalizationStateQuery.UserInactiveSinceDate%2A>属性值。 如果<xref:System.Web.UI.WebControls.WebParts.PersonalizationStateQuery.UserInactiveSinceDate%2A>是<xref:System.DateTime.MaxValue>，此方法将有效地返回基础数据存储区中的每个用户的所有数据。  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentException">The provider for a personalization provider defined in configuration is not of the correct type.</exception>
        <exception cref="T:System.Configuration.ConfigurationErrorsException">A configuration exception occurred while attempting to create and initialize an instance of one of the configured personalization providers.  \- or -  The default personalization provider defined in configuration could not be found.</exception>
        <altmember cref="T:System.Web.UI.WebControls.WebParts.WebPartPersonalization" />
      </Docs>
    </Member>
    <Member MemberName="GetAllInactiveUserState">
      <MemberSignature Language="C#" Value="public static System.Web.UI.WebControls.WebParts.PersonalizationStateInfoCollection GetAllInactiveUserState (DateTime userInactiveSinceDate, int pageIndex, int pageSize, out int totalRecords);" />
      <MemberSignature Language="ILAsm" Value=".method public static hidebysig class System.Web.UI.WebControls.WebParts.PersonalizationStateInfoCollection GetAllInactiveUserState(valuetype System.DateTime userInactiveSinceDate, int32 pageIndex, int32 pageSize, [out] int32&amp; totalRecords) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Web.UI.WebControls.WebParts.PersonalizationAdministration.GetAllInactiveUserState(System.DateTime,System.Int32,System.Int32,System.Int32@)" />
      <MemberSignature Language="VB.NET" Value="Public Shared Function GetAllInactiveUserState (userInactiveSinceDate As DateTime, pageIndex As Integer, pageSize As Integer, ByRef totalRecords As Integer) As PersonalizationStateInfoCollection" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; static System::Web::UI::WebControls::WebParts::PersonalizationStateInfoCollection ^ GetAllInactiveUserState(DateTime userInactiveSinceDate, int pageIndex, int pageSize, [Runtime::InteropServices::Out] int % totalRecords);" />
      <MemberSignature Language="F#" Value="static member GetAllInactiveUserState : DateTime * int * int *  -&gt; System.Web.UI.WebControls.WebParts.PersonalizationStateInfoCollection" Usage="System.Web.UI.WebControls.WebParts.PersonalizationAdministration.GetAllInactiveUserState (userInactiveSinceDate, pageIndex, pageSize, totalRecords)" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Web</AssemblyName>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Web.UI.WebControls.WebParts.PersonalizationStateInfoCollection</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="userInactiveSinceDate" Type="System.DateTime" />
        <Parameter Name="pageIndex" Type="System.Int32" />
        <Parameter Name="pageSize" Type="System.Int32" />
        <Parameter Name="totalRecords" Type="System.Int32&amp;" RefType="out" />
      </Parameters>
      <Docs>
        <param name="userInactiveSinceDate">The last date a user's personalization information was accessed.</param>
        <param name="pageIndex">The zero-based index of the page of results to return.</param>
        <param name="pageSize">The number of records to return.</param>
        <param name="totalRecords">The total number of records available.</param>
        <summary>Returns a subset of all per-user personalization state information associated with inactive users, based on the specified parameters.</summary>
        <returns>A collection of <see cref="T:System.Web.UI.WebControls.WebParts.UserPersonalizationStateInfo" /> instances.</returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 返回的集合仅包含<xref:System.Web.UI.WebControls.WebParts.UserPersonalizationStateInfo>实例。 使用默认的个性化设置提供程序， <xref:System.Web.UI.WebControls.WebParts.PersonalizationStateInfo>-派生的对象返回按字母顺序，并按升序排序的路径和用户名称的组合。 集合中对象的顺序确定提供程序。  
  
 此方法返回的项的用户的<xref:System.Web.UI.WebControls.WebParts.UserPersonalizationStateInfo.LastActivityDate%2A>属性值是否小于或等于<xref:System.Web.UI.WebControls.WebParts.PersonalizationStateQuery.UserInactiveSinceDate%2A>属性值。 如果<xref:System.Web.UI.WebControls.WebParts.PersonalizationStateQuery.UserInactiveSinceDate%2A>是<xref:System.DateTime.MaxValue>，此方法将有效地返回基础数据存储区中的每个用户的所有数据。  
  
 受约束的返回值`pageIndex`并`pageSize`参数，其中`pageIndex`控制要返回哪些记录和`pageSize`控制要返回的记录数。 例如，如果`pageIndex`设置为 0 和`pageSize`已设置为 25，返回的数据将是前 25 个项。 如果`pageIndex`设置为 1 和`pageSize`已设置为 25，返回的数据将是 26 到 50 个项。 `totalRecords`参数返回可用的记录总数。  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentException">
          <paramref name="pageIndex" /> is less than zero.  \- or -  <paramref name="pageSize" /> is less than or equal to zero.  \- or -  The combination of <paramref name="pageIndex" /> and <paramref name="pageSize" /> exceeds <see cref="F:System.Int32.MaxValue" />.  \- or -  The provider for a personalization provider defined in configuration is not of the correct type.</exception>
        <exception cref="T:System.Configuration.ConfigurationErrorsException">A configuration exception occurred while attempting to create and initialize an instance of one of the configured personalization providers.  \- or -  The default personalization provider defined in configuration could not be found.</exception>
        <altmember cref="T:System.Web.UI.WebControls.WebParts.WebPartPersonalization" />
      </Docs>
    </Member>
    <MemberGroup MemberName="GetAllState">
      <AssemblyInfo>
        <AssemblyName>System.Web</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Docs>
        <summary>Returns a collection of all personalization state information from the underlying data store for the requested personalization scope and other specified parameters.</summary>
      </Docs>
    </MemberGroup>
    <Member MemberName="GetAllState">
      <MemberSignature Language="C#" Value="public static System.Web.UI.WebControls.WebParts.PersonalizationStateInfoCollection GetAllState (System.Web.UI.WebControls.WebParts.PersonalizationScope scope);" />
      <MemberSignature Language="ILAsm" Value=".method public static hidebysig class System.Web.UI.WebControls.WebParts.PersonalizationStateInfoCollection GetAllState(valuetype System.Web.UI.WebControls.WebParts.PersonalizationScope scope) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Web.UI.WebControls.WebParts.PersonalizationAdministration.GetAllState(System.Web.UI.WebControls.WebParts.PersonalizationScope)" />
      <MemberSignature Language="VB.NET" Value="Public Shared Function GetAllState (scope As PersonalizationScope) As PersonalizationStateInfoCollection" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; static System::Web::UI::WebControls::WebParts::PersonalizationStateInfoCollection ^ GetAllState(System::Web::UI::WebControls::WebParts::PersonalizationScope scope);" />
      <MemberSignature Language="F#" Value="static member GetAllState : System.Web.UI.WebControls.WebParts.PersonalizationScope -&gt; System.Web.UI.WebControls.WebParts.PersonalizationStateInfoCollection" Usage="System.Web.UI.WebControls.WebParts.PersonalizationAdministration.GetAllState scope" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Web</AssemblyName>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Web.UI.WebControls.WebParts.PersonalizationStateInfoCollection</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="scope" Type="System.Web.UI.WebControls.WebParts.PersonalizationScope" />
      </Parameters>
      <Docs>
        <param name="scope">The scope of the personalization information to be retrieved.</param>
        <summary>Returns a collection of all personalization state information from the underlying data store for the requested personalization scope.</summary>
        <returns>A <see cref="T:System.Web.UI.WebControls.WebParts.PersonalizationStateInfoCollection" /> containing state information for the specified scope.</returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 请注意，返回的集合仅包含<xref:System.Web.UI.WebControls.WebParts.PersonalizationStateInfo>的派生的对象的任何一种<xref:System.Web.UI.WebControls.WebParts.SharedPersonalizationStateInfo>或类型<xref:System.Web.UI.WebControls.WebParts.UserPersonalizationStateInfo>。 使用默认的个性化设置提供程序， <xref:System.Web.UI.WebControls.WebParts.PersonalizationStateInfo>-派生的对象返回按字母顺序，并按升序排序的路径和用户名称的组合。 集合中对象的顺序确定提供程序。  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentException">The provider for a personalization provider defined in configuration is not of the correct type.</exception>
        <exception cref="T:System.Configuration.ConfigurationErrorsException">A configuration exception occurred while attempting to create and initialize an instance of one of the configured personalization providers.  \- or -  The default personalization provider defined in configuration could not be found.</exception>
        <exception cref="T:System.ArgumentOutOfRangeException">
          <paramref name="scope" /> is not a valid member of the <see cref="T:System.Web.UI.WebControls.WebParts.PersonalizationScope" /> enumeration.</exception>
        <altmember cref="T:System.Web.UI.WebControls.WebParts.WebPartPersonalization" />
      </Docs>
    </Member>
    <Member MemberName="GetAllState">
      <MemberSignature Language="C#" Value="public static System.Web.UI.WebControls.WebParts.PersonalizationStateInfoCollection GetAllState (System.Web.UI.WebControls.WebParts.PersonalizationScope scope, int pageIndex, int pageSize, out int totalRecords);" />
      <MemberSignature Language="ILAsm" Value=".method public static hidebysig class System.Web.UI.WebControls.WebParts.PersonalizationStateInfoCollection GetAllState(valuetype System.Web.UI.WebControls.WebParts.PersonalizationScope scope, int32 pageIndex, int32 pageSize, [out] int32&amp; totalRecords) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Web.UI.WebControls.WebParts.PersonalizationAdministration.GetAllState(System.Web.UI.WebControls.WebParts.PersonalizationScope,System.Int32,System.Int32,System.Int32@)" />
      <MemberSignature Language="VB.NET" Value="Public Shared Function GetAllState (scope As PersonalizationScope, pageIndex As Integer, pageSize As Integer, ByRef totalRecords As Integer) As PersonalizationStateInfoCollection" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; static System::Web::UI::WebControls::WebParts::PersonalizationStateInfoCollection ^ GetAllState(System::Web::UI::WebControls::WebParts::PersonalizationScope scope, int pageIndex, int pageSize, [Runtime::InteropServices::Out] int % totalRecords);" />
      <MemberSignature Language="F#" Value="static member GetAllState : System.Web.UI.WebControls.WebParts.PersonalizationScope * int * int *  -&gt; System.Web.UI.WebControls.WebParts.PersonalizationStateInfoCollection" Usage="System.Web.UI.WebControls.WebParts.PersonalizationAdministration.GetAllState (scope, pageIndex, pageSize, totalRecords)" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Web</AssemblyName>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Web.UI.WebControls.WebParts.PersonalizationStateInfoCollection</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="scope" Type="System.Web.UI.WebControls.WebParts.PersonalizationScope" />
        <Parameter Name="pageIndex" Type="System.Int32" />
        <Parameter Name="pageSize" Type="System.Int32" />
        <Parameter Name="totalRecords" Type="System.Int32&amp;" RefType="out" />
      </Parameters>
      <Docs>
        <param name="scope">The scope of the personalization information to be retrieved.</param>
        <param name="pageIndex">The zero-based index of the page of results to return.</param>
        <param name="pageSize">The number of records to return.</param>
        <param name="totalRecords">The total number of records available.</param>
        <summary>Returns a subset of all personalization state information from the underlying data store, based on the specified parameters.</summary>
        <returns>A <see cref="T:System.Web.UI.WebControls.WebParts.PersonalizationStateInfoCollection" /> containing state information for the specified scope and parameters.</returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 返回的集合中的项主要基于作用域，，然后该作用域对应的记录进一步减小为基于子集`pageIndex`和`pageSize`参数。 返回的集合包含<xref:System.Web.UI.WebControls.WebParts.SharedPersonalizationStateInfo>仅限，实例或<xref:System.Web.UI.WebControls.WebParts.UserPersonalizationStateInfo>仅限实例。  
  
 返回的项受`pageIndex`并`pageSize`参数，其中`pageIndex`控制要返回哪些记录和`pageSize`控制返回的记录数。 例如，如果`pageIndex`设置为 0 和`pageSize`已设置为 25，返回的数据将是前 25 个项。 如果`pageIndex`设置为 1 和`pageSize`已设置为 25，返回的数据将是 26 到 50 个项。 `totalRecords`参数返回可用的记录总数。  
  
 使用默认的个性化设置提供程序， <xref:System.Web.UI.WebControls.WebParts.PersonalizationStateInfo>-派生的对象返回按字母顺序，并按升序排序的路径和用户名称的组合。 集合中对象的顺序确定提供程序。  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentException">
          <paramref name="pageIndex" /> is less than zero.  \- or -  <paramref name="pageSize" /> is less than or equal to zero.  \- or -  The provider for a personalization provider defined in configuration is not of the correct type.  \- or -  The combination of <paramref name="pageIndex" /> and <paramref name="pageSize" /> exceeds <see cref="F:System.Int32.MaxValue" />.</exception>
        <exception cref="T:System.ArgumentOutOfRangeException">
          <paramref name="scope" /> is not a valid member of the <see cref="T:System.Web.UI.WebControls.WebParts.PersonalizationScope" /> enumeration.</exception>
        <exception cref="T:System.Configuration.ConfigurationErrorsException">A configuration exception occurred while attempting to create and initialize an instance of one of the configured personalization providers.  \- or -  The default personalization provider defined in configuration could not be found.</exception>
        <altmember cref="T:System.Web.UI.WebControls.WebParts.WebPartPersonalization" />
      </Docs>
    </Member>
    <MemberGroup MemberName="GetCountOfInactiveUserState">
      <AssemblyInfo>
        <AssemblyName>System.Web</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Docs>
        <summary>Returns a count of the per-user personalization items in the underlying data store for inactive users.</summary>
        <altmember cref="T:System.Web.UI.WebControls.WebParts.WebPartPersonalization" />
      </Docs>
    </MemberGroup>
    <Member MemberName="GetCountOfInactiveUserState">
      <MemberSignature Language="C#" Value="public static int GetCountOfInactiveUserState (DateTime userInactiveSinceDate);" />
      <MemberSignature Language="ILAsm" Value=".method public static hidebysig int32 GetCountOfInactiveUserState(valuetype System.DateTime userInactiveSinceDate) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Web.UI.WebControls.WebParts.PersonalizationAdministration.GetCountOfInactiveUserState(System.DateTime)" />
      <MemberSignature Language="VB.NET" Value="Public Shared Function GetCountOfInactiveUserState (userInactiveSinceDate As DateTime) As Integer" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; static int GetCountOfInactiveUserState(DateTime userInactiveSinceDate);" />
      <MemberSignature Language="F#" Value="static member GetCountOfInactiveUserState : DateTime -&gt; int" Usage="System.Web.UI.WebControls.WebParts.PersonalizationAdministration.GetCountOfInactiveUserState userInactiveSinceDate" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Web</AssemblyName>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Int32</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="userInactiveSinceDate" Type="System.DateTime" />
      </Parameters>
      <Docs>
        <param name="userInactiveSinceDate">The last date a user's personalization information was accessed.</param>
        <summary>Returns a count of the per-user personalization items in the underlying data store for inactive users, based on the parameter specified.</summary>
        <returns>The number of personalization items for inactive users.</returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 此方法返回的记录的用户的<xref:System.Web.UI.WebControls.WebParts.UserPersonalizationStateInfo.LastActivityDate%2A>属性值是否小于或等于<xref:System.Web.UI.WebControls.WebParts.PersonalizationStateQuery.UserInactiveSinceDate%2A>属性值。 如果<xref:System.Web.UI.WebControls.WebParts.PersonalizationStateQuery.UserInactiveSinceDate%2A>设置为<xref:System.DateTime.MaxValue>，返回所有用户的个性化设置信息的计数。  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentException">The provider for a personalization provider defined in configuration is not of the correct type.  \- or -  The length of the string of any parameter is greater than 256 characters.</exception>
        <exception cref="T:System.Configuration.ConfigurationErrorsException">A configuration exception occurred while attempting to create and initialize an instance of one of the configured personalization providers.  \- or -  The default personalization provider defined in configuration could not be found.</exception>
        <exception cref="T:System.Web.HttpException">The default provider returned a negative number for the count.</exception>
        <altmember cref="T:System.Web.UI.WebControls.WebParts.WebPartPersonalization" />
      </Docs>
    </Member>
    <Member MemberName="GetCountOfInactiveUserState">
      <MemberSignature Language="C#" Value="public static int GetCountOfInactiveUserState (string pathToMatch, DateTime userInactiveSinceDate);" />
      <MemberSignature Language="ILAsm" Value=".method public static hidebysig int32 GetCountOfInactiveUserState(string pathToMatch, valuetype System.DateTime userInactiveSinceDate) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Web.UI.WebControls.WebParts.PersonalizationAdministration.GetCountOfInactiveUserState(System.String,System.DateTime)" />
      <MemberSignature Language="VB.NET" Value="Public Shared Function GetCountOfInactiveUserState (pathToMatch As String, userInactiveSinceDate As DateTime) As Integer" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; static int GetCountOfInactiveUserState(System::String ^ pathToMatch, DateTime userInactiveSinceDate);" />
      <MemberSignature Language="F#" Value="static member GetCountOfInactiveUserState : string * DateTime -&gt; int" Usage="System.Web.UI.WebControls.WebParts.PersonalizationAdministration.GetCountOfInactiveUserState (pathToMatch, userInactiveSinceDate)" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Web</AssemblyName>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Int32</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="pathToMatch" Type="System.String" />
        <Parameter Name="userInactiveSinceDate" Type="System.DateTime" />
      </Parameters>
      <Docs>
        <param name="pathToMatch">The path to the page with personalization state items to retrieve.</param>
        <param name="userInactiveSinceDate">The last date a user's personalization information was accessed.</param>
        <summary>Returns a count of the per-user personalization items in the underlying data store for inactive users, based on the specified parameters.</summary>
        <returns>The count of the per-user personalization items in the underlying data store for inactive users.</returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 此方法返回的记录页与匹配指定`pathtoMatch`参数和用户的<xref:System.Web.UI.WebControls.WebParts.UserPersonalizationStateInfo.LastActivityDate%2A>属性值是否小于或等于<xref:System.Web.UI.WebControls.WebParts.PersonalizationStateQuery.UserInactiveSinceDate%2A>属性值。 如果<xref:System.Web.UI.WebControls.WebParts.PersonalizationStateQuery.UserInactiveSinceDate%2A>设置为<xref:System.DateTime.MaxValue>，返回所有用户的个性化设置信息的计数。  
  
 请注意，`pathToMatch`参数可以包含通配符。 该方法将通配符字符传递给基础数据存储区。 当前依赖于每个提供程序如何处理字符，如星号 （*）、 百分号 （%） 或下划线 (_) 通配符的支持。  
  
 通常情况下，对于符合 SQL 数据存储，你可以执行通配符搜索分部路径上加上使其不显示在开头、 末尾或搜索字符串文本中的中间的通配符<xref:System.Web.UI.WebControls.WebParts.PersonalizationStateQuery.PathToMatch%2A>属性。 例如，若要查找以"~/vdir"开头的所有路径<xref:System.Web.UI.WebControls.WebParts.PersonalizationStateQuery.PathToMatch%2A>属性将设置为"~/vdir%"。  
  
 `pathToMatch`参数可以是`null`。 如果设置为`null`，在执行查询时，会忽略此参数。  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentException">
          <paramref name="pathToMatch" />, after trimming, is an empty string ("").  \- or -  The provider for a personalization provider defined in configuration is not of the correct type.  \- or -  The length of the string of any parameter is greater than 256 characters.</exception>
        <exception cref="T:System.Configuration.ConfigurationErrorsException">A configuration exception occurred while attempting to create and initialize an instance of one of the configured personalization providers.  \- or -  The default personalization provider defined in configuration could not be found.</exception>
        <exception cref="T:System.Web.HttpException">The default provider returned a negative number for the count.</exception>
        <altmember cref="T:System.Web.UI.WebControls.WebParts.WebPartPersonalization" />
      </Docs>
    </Member>
    <MemberGroup MemberName="GetCountOfState">
      <AssemblyInfo>
        <AssemblyName>System.Web</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Docs>
        <summary>Returns a count of the personalization state items in the underlying data store that exist for the specified scope and additional parameters.</summary>
        <altmember cref="T:System.Web.UI.WebControls.WebParts.WebPartPersonalization" />
      </Docs>
    </MemberGroup>
    <Member MemberName="GetCountOfState">
      <MemberSignature Language="C#" Value="public static int GetCountOfState (System.Web.UI.WebControls.WebParts.PersonalizationScope scope);" />
      <MemberSignature Language="ILAsm" Value=".method public static hidebysig int32 GetCountOfState(valuetype System.Web.UI.WebControls.WebParts.PersonalizationScope scope) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Web.UI.WebControls.WebParts.PersonalizationAdministration.GetCountOfState(System.Web.UI.WebControls.WebParts.PersonalizationScope)" />
      <MemberSignature Language="VB.NET" Value="Public Shared Function GetCountOfState (scope As PersonalizationScope) As Integer" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; static int GetCountOfState(System::Web::UI::WebControls::WebParts::PersonalizationScope scope);" />
      <MemberSignature Language="F#" Value="static member GetCountOfState : System.Web.UI.WebControls.WebParts.PersonalizationScope -&gt; int" Usage="System.Web.UI.WebControls.WebParts.PersonalizationAdministration.GetCountOfState scope" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Web</AssemblyName>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Int32</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="scope" Type="System.Web.UI.WebControls.WebParts.PersonalizationScope" />
      </Parameters>
      <Docs>
        <param name="scope">The scope of the personalization state items to retrieve.</param>
        <summary>Returns a count of the personalization state items in the underlying data store that exist for the specified scope.</summary>
        <returns>The number of personalization state items for the specified scope.</returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 使用此方法来确定指定的作用域的基础数据存储区中的个性化设置状态项的数目。 使用<xref:System.Web.UI.WebControls.WebParts.PersonalizationAdministration.GetCountOfState%2A>方法，以进一步缩小到特定页计数。  
  
   
  
## Examples  
 下面的代码示例演示如何使用 <xref:System.Web.UI.WebControls.WebParts.PersonalizationAdministration.GetCountOfState%2A> 方法。 完整的示例可在<xref:System.Web.UI.WebControls.WebParts.PersonalizationAdministration>类概述主题。  
  
 [!code-csharp[WebParts_PersAdmin#5](~/samples/snippets/csharp/VS_Snippets_WebNet/WebParts_PersAdmin/CS/PersAdmin.ascx#5)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentOutOfRangeException">
          <paramref name="scope" /> is not a valid member of the <see cref="T:System.Web.UI.WebControls.WebParts.PersonalizationScope" /> enumeration.</exception>
        <exception cref="T:System.ArgumentException">The provider for a personalization provider defined in configuration is not of the correct type.  \- or -  The length of the string of any parameter is greater than 256 characters.</exception>
        <exception cref="T:System.Configuration.ConfigurationErrorsException">A configuration exception occurred while attempting to create and initialize an instance of one of the configured personalization providers.  \- or -  The default personalization provider defined in configuration could not be found.</exception>
        <exception cref="T:System.Web.HttpException">The default provider returned a negative number for the count.</exception>
        <altmember cref="T:System.Web.UI.WebControls.WebParts.WebPartPersonalization" />
      </Docs>
    </Member>
    <Member MemberName="GetCountOfState">
      <MemberSignature Language="C#" Value="public static int GetCountOfState (System.Web.UI.WebControls.WebParts.PersonalizationScope scope, string pathToMatch);" />
      <MemberSignature Language="ILAsm" Value=".method public static hidebysig int32 GetCountOfState(valuetype System.Web.UI.WebControls.WebParts.PersonalizationScope scope, string pathToMatch) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Web.UI.WebControls.WebParts.PersonalizationAdministration.GetCountOfState(System.Web.UI.WebControls.WebParts.PersonalizationScope,System.String)" />
      <MemberSignature Language="VB.NET" Value="Public Shared Function GetCountOfState (scope As PersonalizationScope, pathToMatch As String) As Integer" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; static int GetCountOfState(System::Web::UI::WebControls::WebParts::PersonalizationScope scope, System::String ^ pathToMatch);" />
      <MemberSignature Language="F#" Value="static member GetCountOfState : System.Web.UI.WebControls.WebParts.PersonalizationScope * string -&gt; int" Usage="System.Web.UI.WebControls.WebParts.PersonalizationAdministration.GetCountOfState (scope, pathToMatch)" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Web</AssemblyName>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Int32</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="scope" Type="System.Web.UI.WebControls.WebParts.PersonalizationScope" />
        <Parameter Name="pathToMatch" Type="System.String" />
      </Parameters>
      <Docs>
        <param name="scope">The scope of the personalization state items to retrieve.</param>
        <param name="pathToMatch">The path to the page with personalization state items to retrieve.</param>
        <summary>Returns a count of the personalization state items in the underlying data store that exist for the specified parameters.</summary>
        <returns>The number of personalization state items for the specified scope.</returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 使用此方法来确定指定的作用域和路径的基础数据存储区中的个性化设置状态项的数目。  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentException">The provider for a personalization provider defined in configuration is not of the correct type.  \- or -  <paramref name="pathToMatch" />, after trimming, is an empty string ("").  \- or -  The length of the string of any parameter is greater than 256 characters.</exception>
        <exception cref="T:System.Configuration.ConfigurationErrorsException">A configuration exception occurred while attempting to create and initialize an instance of one of the configured personalization providers.  \- or -  The default personalization provider defined in configuration could not be found.</exception>
        <exception cref="T:System.ArgumentOutOfRangeException">
          <paramref name="scope" /> is not a valid member of the <see cref="T:System.Web.UI.WebControls.WebParts.PersonalizationScope" /> enumeration.</exception>
        <exception cref="T:System.Web.HttpException">The default provider returned a negative number for the count.</exception>
        <altmember cref="T:System.Web.UI.WebControls.WebParts.WebPartPersonalization" />
      </Docs>
    </Member>
    <Member MemberName="GetCountOfUserState">
      <MemberSignature Language="C#" Value="public static int GetCountOfUserState (string usernameToMatch);" />
      <MemberSignature Language="ILAsm" Value=".method public static hidebysig int32 GetCountOfUserState(string usernameToMatch) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Web.UI.WebControls.WebParts.PersonalizationAdministration.GetCountOfUserState(System.String)" />
      <MemberSignature Language="VB.NET" Value="Public Shared Function GetCountOfUserState (usernameToMatch As String) As Integer" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; static int GetCountOfUserState(System::String ^ usernameToMatch);" />
      <MemberSignature Language="F#" Value="static member GetCountOfUserState : string -&gt; int" Usage="System.Web.UI.WebControls.WebParts.PersonalizationAdministration.GetCountOfUserState usernameToMatch" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Web</AssemblyName>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Int32</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="usernameToMatch" Type="System.String" />
      </Parameters>
      <Docs>
        <param name="usernameToMatch">The user name associated with the personalization state information to retrieve.</param>
        <summary>Returns a count of the personalization state items in the underlying data store that exist for the specified user.</summary>
        <returns>The number of personalization state items for the specified user.</returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 此方法返回数的每用户个性化设置项存在的基础数据存储区中给定`usernameToMatch`。  
  
 请注意，`usernameToMatch`参数可以包含通配符。 此方法将通配符字符传递给基础数据存储区。 当前依赖于每个提供程序如何处理字符，如星号 （*）、 百分号 （%） 或下划线 (_) 通配符的支持。  
  
 通常情况下，对于符合 SQL 数据存储，对部分用户名通配符搜索可以显示的文本字符串中的任意位置的通配符字符<xref:System.Web.UI.WebControls.WebParts.PersonalizationStateQuery.UsernameToMatch%2A>属性。 例如，若要查找与"John"开头的所有用户名称<xref:System.Web.UI.WebControls.WebParts.PersonalizationStateQuery.UsernameToMatch%2A>参数将如下所示"John %"。  
  
 `usernameToMatch`参数可以是`null`。 如果设置为`null`，在执行查询时，会忽略此参数。 `usernameToMatch`允许参数包含逗号 （，），因为某些数据存储，例如运行 Microsoft SQL Server，允许使用逗号作为通配符。  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentException">
          <paramref name="usernameToMatch" /> is an empty string ("") after trimming.  \- or -  The provider for a personalization provider defined in configuration is not of the correct type.  \- or -  The length of the string of any parameter is greater than 256 characters.</exception>
        <exception cref="T:System.Configuration.ConfigurationErrorsException">A configuration exception occurred while attempting to create and initialize an instance of one of the configured personalization providers.  \- or -  The default personalization provider defined in configuration could not be found.</exception>
        <exception cref="T:System.Web.HttpException">The default provider returned a negative number for the count.</exception>
        <altmember cref="T:System.Web.UI.WebControls.WebParts.WebPartPersonalization" />
      </Docs>
    </Member>
    <Member MemberName="Provider">
      <MemberSignature Language="C#" Value="public static System.Web.UI.WebControls.WebParts.PersonalizationProvider Provider { get; }" />
      <MemberSignature Language="ILAsm" Value=".property class System.Web.UI.WebControls.WebParts.PersonalizationProvider Provider" />
      <MemberSignature Language="DocId" Value="P:System.Web.UI.WebControls.WebParts.PersonalizationAdministration.Provider" />
      <MemberSignature Language="VB.NET" Value="Public Shared ReadOnly Property Provider As PersonalizationProvider" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; static property System::Web::UI::WebControls::WebParts::PersonalizationProvider ^ Provider { System::Web::UI::WebControls::WebParts::PersonalizationProvider ^ get(); };" />
      <MemberSignature Language="F#" Value="member this.Provider : System.Web.UI.WebControls.WebParts.PersonalizationProvider" Usage="System.Web.UI.WebControls.WebParts.PersonalizationAdministration.Provider" />
      <MemberType>Property</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Web</AssemblyName>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Web.UI.WebControls.WebParts.PersonalizationProvider</ReturnType>
      </ReturnValue>
      <Docs>
        <summary>Returns an instance of the default personalization provider.</summary>
        <value>一个<see cref="T:System.Web.UI.WebControls.WebParts.PersonalizationProvider" />的默认提供程序。</value>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 此属性用于检索默认个性化设置提供程序的实例。 这是在 Web.config 或 Machine.config 文件的个性化设置提供程序部分中指定的提供程序。  
  
   
  
## Examples  
 下面的代码示例演示如何使用<xref:System.Web.UI.WebControls.WebParts.PersonalizationAdministration.Provider%2A>属性。  
  
 [!code-csharp[WebParts_PersAdmin#4](~/samples/snippets/csharp/VS_Snippets_WebNet/WebParts_PersAdmin/CS/PersAdmin.ascx#4)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentException">The provider for a personalization provider defined in configuration is not of the correct type.</exception>
        <exception cref="T:System.Configuration.ConfigurationErrorsException">A configuration exception occurred while attempting to create and initialize an instance of one of the configured personalization providers.  \- or -  The default personalization provider defined in configuration could not be found.</exception>
        <altmember cref="T:System.Web.UI.WebControls.WebParts.WebPartPersonalization" />
      </Docs>
    </Member>
    <Member MemberName="Providers">
      <MemberSignature Language="C#" Value="public static System.Web.UI.WebControls.WebParts.PersonalizationProviderCollection Providers { get; }" />
      <MemberSignature Language="ILAsm" Value=".property class System.Web.UI.WebControls.WebParts.PersonalizationProviderCollection Providers" />
      <MemberSignature Language="DocId" Value="P:System.Web.UI.WebControls.WebParts.PersonalizationAdministration.Providers" />
      <MemberSignature Language="VB.NET" Value="Public Shared ReadOnly Property Providers As PersonalizationProviderCollection" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; static property System::Web::UI::WebControls::WebParts::PersonalizationProviderCollection ^ Providers { System::Web::UI::WebControls::WebParts::PersonalizationProviderCollection ^ get(); };" />
      <MemberSignature Language="F#" Value="member this.Providers : System.Web.UI.WebControls.WebParts.PersonalizationProviderCollection" Usage="System.Web.UI.WebControls.WebParts.PersonalizationAdministration.Providers" />
      <MemberType>Property</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Web</AssemblyName>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Web.UI.WebControls.WebParts.PersonalizationProviderCollection</ReturnType>
      </ReturnValue>
      <Docs>
        <summary>Returns a collection of personalization providers indexed by name.</summary>
        <value>一个只读的<see cref="T:System.Web.UI.WebControls.WebParts.PersonalizationProviderCollection" />包含到应用程序可用的个性化设置提供程序。</value>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 此属性返回个性化设置提供程序的集合。 在应用程序的初始化填充集合，其包含对按名称进行索引的提供程序对象的引用。 默认提供程序的 Web.config 或 Machine.config 配置文件中指定的名称编制索引。  
  
 请注意，返回的集合是只读的;调用`Remove`， `Add`，或`Clear`将导致引发异常。  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentException">The provider for a personalization provider defined in configuration is not of the correct type.</exception>
        <exception cref="T:System.Configuration.ConfigurationErrorsException">A configuration exception occurred while attempting to create and initialize an instance of one of the configured personalization providers.  \- or -  The default personalization provider defined in configuration could not be found.</exception>
        <altmember cref="T:System.Web.UI.WebControls.WebParts.WebPartPersonalization" />
      </Docs>
    </Member>
    <Member MemberName="ResetAllState">
      <MemberSignature Language="C#" Value="public static int ResetAllState (System.Web.UI.WebControls.WebParts.PersonalizationScope scope);" />
      <MemberSignature Language="ILAsm" Value=".method public static hidebysig int32 ResetAllState(valuetype System.Web.UI.WebControls.WebParts.PersonalizationScope scope) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Web.UI.WebControls.WebParts.PersonalizationAdministration.ResetAllState(System.Web.UI.WebControls.WebParts.PersonalizationScope)" />
      <MemberSignature Language="VB.NET" Value="Public Shared Function ResetAllState (scope As PersonalizationScope) As Integer" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; static int ResetAllState(System::Web::UI::WebControls::WebParts::PersonalizationScope scope);" />
      <MemberSignature Language="F#" Value="static member ResetAllState : System.Web.UI.WebControls.WebParts.PersonalizationScope -&gt; int" Usage="System.Web.UI.WebControls.WebParts.PersonalizationAdministration.ResetAllState scope" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Web</AssemblyName>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Int32</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="scope" Type="System.Web.UI.WebControls.WebParts.PersonalizationScope" />
      </Parameters>
      <Docs>
        <param name="scope">The scope associated with the personalization data to be deleted.</param>
        <summary>Resets all personalization data in the underlying data store by deleting all rows associated with the specified scope.</summary>
        <returns>The number of items that were reset.</returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 此方法删除与指定的个性化设置范围关联的基础数据存储中的所有行。  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentOutOfRangeException">
          <paramref name="scope" /> is not a valid member of the <see cref="T:System.Web.UI.WebControls.WebParts.PersonalizationScope" /> enumeration.</exception>
        <exception cref="T:System.ArgumentException">The provider for a personalization provider defined in configuration is not of the correct type.</exception>
        <exception cref="T:System.Configuration.ConfigurationErrorsException">A configuration exception occurred while attempting to create and initialize an instance of one of the configured personalization providers.  \- or -  The default personalization provider defined in configuration could not be found.</exception>
        <exception cref="T:System.Web.HttpException">The default provider returned a negative number for the count of affected rows.</exception>
        <altmember cref="T:System.Web.UI.WebControls.WebParts.WebPartPersonalization" />
      </Docs>
    </Member>
    <MemberGroup MemberName="ResetInactiveUserState">
      <AssemblyInfo>
        <AssemblyName>System.Web</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Docs>
        <summary>Resets per-user personalization state information by deleting the associated rows in the underlying data store.</summary>
        <altmember cref="T:System.Web.UI.WebControls.WebParts.WebPartPersonalization" />
      </Docs>
    </MemberGroup>
    <Member MemberName="ResetInactiveUserState">
      <MemberSignature Language="C#" Value="public static int ResetInactiveUserState (DateTime userInactiveSinceDate);" />
      <MemberSignature Language="ILAsm" Value=".method public static hidebysig int32 ResetInactiveUserState(valuetype System.DateTime userInactiveSinceDate) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Web.UI.WebControls.WebParts.PersonalizationAdministration.ResetInactiveUserState(System.DateTime)" />
      <MemberSignature Language="VB.NET" Value="Public Shared Function ResetInactiveUserState (userInactiveSinceDate As DateTime) As Integer" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; static int ResetInactiveUserState(DateTime userInactiveSinceDate);" />
      <MemberSignature Language="F#" Value="static member ResetInactiveUserState : DateTime -&gt; int" Usage="System.Web.UI.WebControls.WebParts.PersonalizationAdministration.ResetInactiveUserState userInactiveSinceDate" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Web</AssemblyName>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Int32</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="userInactiveSinceDate" Type="System.DateTime" />
      </Parameters>
      <Docs>
        <param name="userInactiveSinceDate">The last date a user's personalization information was accessed.</param>
        <summary>Resets all per-user personalization state information in the underlying data store, based on the specified parameter.</summary>
        <returns>The number of rows in the underlying data store that were reset.</returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 此方法将重置基础数据存储区中的所有每用户状态信息的用户的<xref:System.Web.UI.WebControls.WebParts.UserPersonalizationStateInfo.LastActivityDate%2A>属性值是否小于或等于<xref:System.Web.UI.WebControls.WebParts.PersonalizationStateQuery.UserInactiveSinceDate%2A>值。  
  
 如果<xref:System.Web.UI.WebControls.WebParts.PersonalizationStateQuery.UserInactiveSinceDate%2A>设置为<xref:System.DateTime.MaxValue>，此方法将重置基础数据存储区中的所有每用户数据。  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentException">The provider for a personalization provider defined in configuration is not of the correct type.  \- or -  The length of the string of any parameter is greater than 256 characters.</exception>
        <exception cref="T:System.Configuration.ConfigurationErrorsException">A configuration exception occurred while attempting to create and initialize an instance of one of the configured personalization providers.  \- or -  The default personalization provider defined in configuration could not be found.</exception>
        <exception cref="T:System.Web.HttpException">The default provider returned a negative number for the count.</exception>
        <altmember cref="T:System.Web.UI.WebControls.WebParts.WebPartPersonalization" />
      </Docs>
    </Member>
    <Member MemberName="ResetInactiveUserState">
      <MemberSignature Language="C#" Value="public static int ResetInactiveUserState (string path, DateTime userInactiveSinceDate);" />
      <MemberSignature Language="ILAsm" Value=".method public static hidebysig int32 ResetInactiveUserState(string path, valuetype System.DateTime userInactiveSinceDate) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Web.UI.WebControls.WebParts.PersonalizationAdministration.ResetInactiveUserState(System.String,System.DateTime)" />
      <MemberSignature Language="VB.NET" Value="Public Shared Function ResetInactiveUserState (path As String, userInactiveSinceDate As DateTime) As Integer" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; static int ResetInactiveUserState(System::String ^ path, DateTime userInactiveSinceDate);" />
      <MemberSignature Language="F#" Value="static member ResetInactiveUserState : string * DateTime -&gt; int" Usage="System.Web.UI.WebControls.WebParts.PersonalizationAdministration.ResetInactiveUserState (path, userInactiveSinceDate)" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Web</AssemblyName>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Int32</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="path" Type="System.String" />
        <Parameter Name="userInactiveSinceDate" Type="System.DateTime" />
      </Parameters>
      <Docs>
        <param name="path">The path to the page associated with the personalization state information to be reset.</param>
        <param name="userInactiveSinceDate">The last active date to be used in resetting user state personalization items.</param>
        <summary>Resets all per-user state information in the underlying data store for inactive users, based on the specified parameters.</summary>
        <returns>The number of rows in the underlying data store that were reset.</returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 此方法将具有指定路径关联的基础数据存储中的所有每用户状态重置的用户的<xref:System.Web.UI.WebControls.WebParts.UserPersonalizationStateInfo.LastActivityDate%2A>属性值是否小于或等于<xref:System.Web.UI.WebControls.WebParts.PersonalizationStateQuery.UserInactiveSinceDate%2A>属性值。  
  
 对于数据存储需要多个要存储为页，或个性化设置状态的数据行的用户和页面组合，重置的行数可能不同于个性化设置状态的计数。 如果基础提供程序公开一个识别事务的数据存储区中的数据，此方法在单个事务中执行其操作。  
  
 它不是尝试重置不存在共享的状态错误。  
  
 如果<xref:System.Web.UI.WebControls.WebParts.PersonalizationStateQuery.UserInactiveSinceDate%2A>是<xref:System.DateTime.MaxValue>，此方法有效地重置基础数据存储区指定路径中的所有每用户数据。  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentNullException">
          <paramref name="path" /> is <see langword="null" />.</exception>
        <exception cref="T:System.ArgumentException">
          <paramref name="path" /> is an empty string ("") after trimming.  \- or -  The provider for a personalization provider defined in configuration is not of the correct type.  \- or -  The length of the string of any parameter is greater than 256 characters.</exception>
        <exception cref="T:System.Configuration.ConfigurationErrorsException">A configuration exception occurred while attempting to create and initialize an instance of one of the configured personalization providers.  \- or -  The default personalization provider defined in configuration could not be found.</exception>
        <exception cref="T:System.Web.HttpException">The default provider returned a negative number for the count.</exception>
        <altmember cref="T:System.Web.UI.WebControls.WebParts.WebPartPersonalization" />
      </Docs>
    </Member>
    <MemberGroup MemberName="ResetSharedState">
      <AssemblyInfo>
        <AssemblyName>System.Web</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Docs>
        <summary>Resets shared state in the underlying data store for the specified path or paths.</summary>
        <altmember cref="T:System.Web.UI.WebControls.WebParts.WebPartPersonalization" />
      </Docs>
    </MemberGroup>
    <Member MemberName="ResetSharedState">
      <MemberSignature Language="C#" Value="public static bool ResetSharedState (string path);" />
      <MemberSignature Language="ILAsm" Value=".method public static hidebysig bool ResetSharedState(string path) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Web.UI.WebControls.WebParts.PersonalizationAdministration.ResetSharedState(System.String)" />
      <MemberSignature Language="VB.NET" Value="Public Shared Function ResetSharedState (path As String) As Boolean" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; static bool ResetSharedState(System::String ^ path);" />
      <MemberSignature Language="F#" Value="static member ResetSharedState : string -&gt; bool" Usage="System.Web.UI.WebControls.WebParts.PersonalizationAdministration.ResetSharedState path" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Web</AssemblyName>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Boolean</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="path" Type="System.String" />
      </Parameters>
      <Docs>
        <param name="path">The path to the page associated with the personalization state information to be reset.</param>
        <summary>Resets shared state in the underlying data store for the specified path.</summary>
        <returns>
          <see langword="true" /> if personalization shared state was reset; otherwise, <see langword="false" />.</returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 它不是尝试重置不存在共享的状态错误。  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentNullException">
          <paramref name="path" /> is <see langword="null" />.</exception>
        <exception cref="T:System.ArgumentException">
          <paramref name="path" /> is an empty string ("") after trimming.  \- or -  The provider for a personalization provider defined in configuration is not of the correct type.  \- or -  The length of the string of any parameter is greater than 256 characters.</exception>
        <exception cref="T:System.Configuration.ConfigurationErrorsException">A configuration exception occurred while attempting to create and initialize an instance of one of the configured personalization providers.  \- or -  The default personalization provider defined in configuration could not be found.</exception>
        <exception cref="T:System.Web.HttpException">The default provider indicated that the number of deleted rows was either a negative number or was greater than one.</exception>
        <altmember cref="T:System.Web.UI.WebControls.WebParts.WebPartPersonalization" />
      </Docs>
    </Member>
    <Member MemberName="ResetSharedState">
      <MemberSignature Language="C#" Value="public static int ResetSharedState (string[] paths);" />
      <MemberSignature Language="ILAsm" Value=".method public static hidebysig int32 ResetSharedState(string[] paths) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Web.UI.WebControls.WebParts.PersonalizationAdministration.ResetSharedState(System.String[])" />
      <MemberSignature Language="VB.NET" Value="Public Shared Function ResetSharedState (paths As String()) As Integer" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; static int ResetSharedState(cli::array &lt;System::String ^&gt; ^ paths);" />
      <MemberSignature Language="F#" Value="static member ResetSharedState : string[] -&gt; int" Usage="System.Web.UI.WebControls.WebParts.PersonalizationAdministration.ResetSharedState paths" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Web</AssemblyName>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Int32</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="paths" Type="System.String[]" />
      </Parameters>
      <Docs>
        <param name="paths">The paths to the pages associated with the personalization state information to be reset.</param>
        <summary>Resets shared state in the underlying data store for the specified paths.</summary>
        <returns>The number of rows that were reset.</returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 此方法返回的已重置的行数的计数。 它不是尝试重置不存在共享的状态错误。  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentNullException">
          <paramref name="paths" /> is <see langword="null" />.</exception>
        <exception cref="T:System.ArgumentException">
          <paramref name="paths" /> is a zero-length array.  \- or -  A member of <paramref name="paths" /> is either <see langword="null" /> or an empty string ("") after trimming.  \- or -  The provider for a personalization provider defined in configuration is not of the correct type.  \- or -  The length of the string of any parameter is greater than 256 characters.</exception>
        <exception cref="T:System.Configuration.ConfigurationErrorsException">A configuration exception occurred while attempting to create and initialize an instance of one of the configured personalization providers.  \- or -  The default personalization provider defined in configuration could not be found.</exception>
        <exception cref="T:System.Web.HttpException">The default provider indicated that the number of deleted rows was a negative number.</exception>
        <altmember cref="T:System.Web.UI.WebControls.WebParts.WebPartPersonalization" />
      </Docs>
    </Member>
    <Member MemberName="ResetState">
      <MemberSignature Language="C#" Value="public static int ResetState (System.Web.UI.WebControls.WebParts.PersonalizationStateInfoCollection data);" />
      <MemberSignature Language="ILAsm" Value=".method public static hidebysig int32 ResetState(class System.Web.UI.WebControls.WebParts.PersonalizationStateInfoCollection data) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Web.UI.WebControls.WebParts.PersonalizationAdministration.ResetState(System.Web.UI.WebControls.WebParts.PersonalizationStateInfoCollection)" />
      <MemberSignature Language="VB.NET" Value="Public Shared Function ResetState (data As PersonalizationStateInfoCollection) As Integer" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; static int ResetState(System::Web::UI::WebControls::WebParts::PersonalizationStateInfoCollection ^ data);" />
      <MemberSignature Language="F#" Value="static member ResetState : System.Web.UI.WebControls.WebParts.PersonalizationStateInfoCollection -&gt; int" Usage="System.Web.UI.WebControls.WebParts.PersonalizationAdministration.ResetState data" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Web</AssemblyName>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Int32</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="data" Type="System.Web.UI.WebControls.WebParts.PersonalizationStateInfoCollection" />
      </Parameters>
      <Docs>
        <param name="data">A collection of <see cref="T:System.Web.UI.WebControls.WebParts.PersonalizationStateInfo" /> objects indicating what data should be reset.</param>
        <summary>Resets personalization data in the underlying data store, based on the items contained in the collection.</summary>
        <returns>The number of rows that were reset.</returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 此方法将重置的个性化设置数据在基础数据存储区，基于<xref:System.Web.UI.WebControls.WebParts.PersonalizationStateInfo>集合中包含的对象。 可以使用此方法有选择地删除了各种共享和每个用户的数据基于集合的内容。 <xref:System.Web.UI.WebControls.WebParts.SharedPersonalizationStateInfo> 对象指示将重置页的共享的数据的;<xref:System.Web.UI.WebControls.WebParts.UserPersonalizationStateInfo>对象指示每个用户数据的特定页面将重置。  
  
> [!NOTE]
>  此方法不保证所有重置发生在单个事务中，因为集合指向随机的个性化设置数据集。  
  
 它不是错误的将包含引用不存在的数据的对象的集合。  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentNullException">
          <paramref name="data" /> is <see langword="null" />.</exception>
        <exception cref="T:System.ArgumentException">
          <paramref name="data" /> is an empty collection.  -or-  An element of the collection is <see langword="null" />.  -or-  The path value of a <see cref="T:System.Web.UI.WebControls.WebParts.UserPersonalizationStateInfo" /> instance in the collection is <see langword="null" /> or an empty string ("").  -or-  The <paramref name="user" /> value of a <see cref="T:System.Web.UI.WebControls.WebParts.UserPersonalizationStateInfo" /> instance in the collection is <see langword="null" />, an empty string, or contains commas.  -or-  The provider for a personalization provider defined in configuration is not of the correct type.  -or-  The length of the string of any parameter is greater than 256 characters.</exception>
        <exception cref="T:System.Configuration.ConfigurationErrorsException">A configuration exception occurred while attempting to create and initialize an instance of one of the configured personalization providers.  -or-  The default personalization provider defined in configuration could not be found.</exception>
        <exception cref="T:System.Web.HttpException">The default provider indicated that the number of deleted rows was a negative number.</exception>
        <altmember cref="T:System.Web.UI.WebControls.WebParts.WebPartPersonalization" />
      </Docs>
    </Member>
    <MemberGroup MemberName="ResetUserState">
      <AssemblyInfo>
        <AssemblyName>System.Web</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Docs>
        <summary>Resets all per-user state in the underlying data store for the specified parameters.</summary>
        <altmember cref="T:System.Web.UI.WebControls.WebParts.WebPartPersonalization" />
      </Docs>
    </MemberGroup>
    <Member MemberName="ResetUserState">
      <MemberSignature Language="C#" Value="public static int ResetUserState (string path);" />
      <MemberSignature Language="ILAsm" Value=".method public static hidebysig int32 ResetUserState(string path) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Web.UI.WebControls.WebParts.PersonalizationAdministration.ResetUserState(System.String)" />
      <MemberSignature Language="VB.NET" Value="Public Shared Function ResetUserState (path As String) As Integer" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; static int ResetUserState(System::String ^ path);" />
      <MemberSignature Language="F#" Value="static member ResetUserState : string -&gt; int" Usage="System.Web.UI.WebControls.WebParts.PersonalizationAdministration.ResetUserState path" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Web</AssemblyName>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Int32</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="path" Type="System.String" />
      </Parameters>
      <Docs>
        <param name="path">The path to the page associated with the personalization state information to be reset.</param>
        <summary>Resets all per-user state in the underlying data store for the specified path.</summary>
        <returns>The number of rows that were reset.</returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 此方法返回的已重置的行数的计数。 它不是尝试重置不存在共享的状态错误。  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentNullException">
          <paramref name="path" /> is <see langword="null" />.</exception>
        <exception cref="T:System.ArgumentException">
          <paramref name="path" /> is an empty string ("").  \- or -  The provider for a personalization provider defined in configuration is not of the correct type.  \- or -  The length of the string of any parameter is greater than 256 characters.</exception>
        <exception cref="T:System.Configuration.ConfigurationErrorsException">A configuration exception occurred while attempting to create and initialize an instance of one of the configured personalization providers.  \- or -  The default personalization provider defined in configuration could not be found.</exception>
        <exception cref="T:System.Web.HttpException">The default provider indicated that the number of deleted rows was a negative number.</exception>
        <altmember cref="T:System.Web.UI.WebControls.WebParts.WebPartPersonalization" />
      </Docs>
    </Member>
    <Member MemberName="ResetUserState">
      <MemberSignature Language="C#" Value="public static int ResetUserState (string[] usernames);" />
      <MemberSignature Language="ILAsm" Value=".method public static hidebysig int32 ResetUserState(string[] usernames) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Web.UI.WebControls.WebParts.PersonalizationAdministration.ResetUserState(System.String[])" />
      <MemberSignature Language="VB.NET" Value="Public Shared Function ResetUserState (usernames As String()) As Integer" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; static int ResetUserState(cli::array &lt;System::String ^&gt; ^ usernames);" />
      <MemberSignature Language="F#" Value="static member ResetUserState : string[] -&gt; int" Usage="System.Web.UI.WebControls.WebParts.PersonalizationAdministration.ResetUserState usernames" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Web</AssemblyName>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Int32</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="usernames" Type="System.String[]" />
      </Parameters>
      <Docs>
        <param name="usernames">An array of user names whose per-user data should be reset.</param>
        <summary>Resets all per-user state in the underlying data store for the specified paths.</summary>
        <returns>The number of rows that were reset.</returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 此方法将重置基础数据存储区中包含的用户与关联中的所有每用户状态`usernames`参数，并返回已重置的行数的计数。  
  
 它不是尝试重置不存在共享的状态错误。  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentNullException">
          <paramref name="usernames" /> is <see langword="null" />.</exception>
        <exception cref="T:System.ArgumentException">
          <paramref name="usernames" /> is a zero-length array.  \- or -  A member of <paramref name="usernames" /> is either <see langword="null" />, contains commas, or is an empty string ("") after trimming.  \- or -  The provider for a personalization provider defined in configuration is not of the correct type.  \- or -  The length of the string of any parameter is greater than 256 characters.</exception>
        <exception cref="T:System.Configuration.ConfigurationErrorsException">A configuration exception occurred while attempting to create and initialize an instance of one of the configured personalization providers.  \- or -  The default personalization provider defined in configuration could not be found.</exception>
        <exception cref="T:System.Web.HttpException">The default provider indicated that the number of deleted rows was a negative number.</exception>
        <altmember cref="T:System.Web.UI.WebControls.WebParts.WebPartPersonalization" />
      </Docs>
    </Member>
    <Member MemberName="ResetUserState">
      <MemberSignature Language="C#" Value="public static bool ResetUserState (string path, string username);" />
      <MemberSignature Language="ILAsm" Value=".method public static hidebysig bool ResetUserState(string path, string username) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Web.UI.WebControls.WebParts.PersonalizationAdministration.ResetUserState(System.String,System.String)" />
      <MemberSignature Language="VB.NET" Value="Public Shared Function ResetUserState (path As String, username As String) As Boolean" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; static bool ResetUserState(System::String ^ path, System::String ^ username);" />
      <MemberSignature Language="F#" Value="static member ResetUserState : string * string -&gt; bool" Usage="System.Web.UI.WebControls.WebParts.PersonalizationAdministration.ResetUserState (path, username)" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Web</AssemblyName>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Boolean</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="path" Type="System.String" />
        <Parameter Name="username" Type="System.String" />
      </Parameters>
      <Docs>
        <param name="path">The path to the page associated with the personalization state information to be reset.</param>
        <param name="username">The user name associated with the personalization data to be reset.</param>
        <summary>Resets per-user state in the underlying data store for the specified combination of user name and path.</summary>
        <returns>The number of rows that were reset.</returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 它不是尝试重置不存在用户状态错误。  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentNullException">
          <paramref name="path" /> or <paramref name="username" /> is <see langword="null" />.</exception>
        <exception cref="T:System.ArgumentException">
          <paramref name="path" /> or <paramref name="username" /> is an empty string ("") after trimming.  \- or -  <paramref name="username" /> contains commas.  \- or -  The provider for a personalization provider defined in configuration is not of the correct type.  \- or -  The length of the string of any parameter is greater than 256 characters.</exception>
        <exception cref="T:System.Configuration.ConfigurationErrorsException">A configuration exception occurred while attempting to create and initialize an instance of one of the configured personalization providers.  \- or -  The default personalization provider defined in configuration could not be found.</exception>
        <exception cref="T:System.Web.HttpException">The default provider indicated that the number of deleted rows was a negative number.</exception>
        <altmember cref="T:System.Web.UI.WebControls.WebParts.WebPartPersonalization" />
      </Docs>
    </Member>
    <Member MemberName="ResetUserState">
      <MemberSignature Language="C#" Value="public static int ResetUserState (string path, string[] usernames);" />
      <MemberSignature Language="ILAsm" Value=".method public static hidebysig int32 ResetUserState(string path, string[] usernames) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Web.UI.WebControls.WebParts.PersonalizationAdministration.ResetUserState(System.String,System.String[])" />
      <MemberSignature Language="VB.NET" Value="Public Shared Function ResetUserState (path As String, usernames As String()) As Integer" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; static int ResetUserState(System::String ^ path, cli::array &lt;System::String ^&gt; ^ usernames);" />
      <MemberSignature Language="F#" Value="static member ResetUserState : string * string[] -&gt; int" Usage="System.Web.UI.WebControls.WebParts.PersonalizationAdministration.ResetUserState (path, usernames)" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Web</AssemblyName>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Int32</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="path" Type="System.String" />
        <Parameter Name="usernames" Type="System.String[]" />
      </Parameters>
      <Docs>
        <param name="path">The path to the page associated with the personalization state information to be reset.</param>
        <param name="usernames">The user names associated with the personalization data to be reset.</param>
        <summary>Resets per-user state in the underlying data store for the page and users specified.</summary>
        <returns>The number of rows that were reset.</returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 此方法将重置基础数据存储区中包含每个用户与关联中的每个用户状态`usernames`参数指定的页 `path.`  
  
 它不是尝试重置不存在用户状态错误。  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentNullException">
          <paramref name="path" /> or <paramref name="usernames" /> is <see langword="null" />.</exception>
        <exception cref="T:System.ArgumentException">
          <paramref name="path" /> is an empty string ("") after trimming.  \- or -  A member of <paramref name="usernames" /> is <see langword="null" />, an empty string after trimming, or contains commas.  \- or -  <paramref name="usernames" /> is a zero-length array.  \- or -  The provider for a personalization provider defined in configuration is not of the correct type.  \- or -  The length of the string of any parameter is greater than 256 characters.</exception>
        <exception cref="T:System.Configuration.ConfigurationErrorsException">A configuration exception occurred while attempting to create and initialize an instance of one of the configured personalization providers.  \- or -  The default personalization provider defined in configuration could not be found.</exception>
        <exception cref="T:System.Web.HttpException">The default provider indicated that the number of deleted rows was a negative number.</exception>
        <altmember cref="T:System.Web.UI.WebControls.WebParts.WebPartPersonalization" />
      </Docs>
    </Member>
  </Members>
</Type>