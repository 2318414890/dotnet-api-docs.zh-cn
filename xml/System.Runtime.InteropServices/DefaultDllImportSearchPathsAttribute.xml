<Type Name="DefaultDllImportSearchPathsAttribute" FullName="System.Runtime.InteropServices.DefaultDllImportSearchPathsAttribute">
  <Metadata>
    <Meta Name="ms.openlocfilehash" Value="da8900ee314d413b3f2ad6a343e8af84c58c1c39" />
    <Meta Name="ms.sourcegitcommit" Value="d31dc2ede16f6f7bc64e90d9f897ff54c4e3869b" />
    <Meta Name="ms.translationtype" Value="HT" />
    <Meta Name="ms.contentlocale" Value="zh-CN" />
    <Meta Name="ms.lasthandoff" Value="04/03/2018" />
    <Meta Name="ms.locfileid" Value="30478111" />
  </Metadata>
  <TypeSignature Language="C#" Value="public sealed class DefaultDllImportSearchPathsAttribute : Attribute" />
  <TypeSignature Language="ILAsm" Value=".class public auto ansi sealed beforefieldinit DefaultDllImportSearchPathsAttribute extends System.Attribute" />
  <TypeSignature Language="DocId" Value="T:System.Runtime.InteropServices.DefaultDllImportSearchPathsAttribute" />
  <TypeSignature Language="VB.NET" Value="Public NotInheritable Class DefaultDllImportSearchPathsAttribute&#xA;Inherits Attribute" />
  <TypeSignature Language="C++ CLI" Value="public ref class DefaultDllImportSearchPathsAttribute sealed : Attribute" />
  <AssemblyInfo>
    <AssemblyName>System.Runtime.InteropServices</AssemblyName>
    <AssemblyVersion>4.0.0.0</AssemblyVersion>
    <AssemblyVersion>4.0.10.0</AssemblyVersion>
    <AssemblyVersion>4.0.20.0</AssemblyVersion>
    <AssemblyVersion>4.1.0.0</AssemblyVersion>
    <AssemblyVersion>4.1.1.0</AssemblyVersion>
    <AssemblyVersion>4.2.0.0</AssemblyVersion>
    <AssemblyVersion>4.2.1.0</AssemblyVersion>
  </AssemblyInfo>
  <AssemblyInfo>
    <AssemblyName>mscorlib</AssemblyName>
    <AssemblyVersion>2.0.5.0</AssemblyVersion>
    <AssemblyVersion>4.0.0.0</AssemblyVersion>
  </AssemblyInfo>
  <AssemblyInfo>
    <AssemblyName>netstandard</AssemblyName>
    <AssemblyVersion>2.0.0.0</AssemblyVersion>
  </AssemblyInfo>
  <Base>
    <BaseTypeName>System.Attribute</BaseTypeName>
  </Base>
  <Interfaces />
  <Attributes>
    <Attribute>
      <AttributeName>System.AttributeUsage(System.AttributeTargets.Assembly | System.AttributeTargets.Method, AllowMultiple=false)</AttributeName>
    </Attribute>
    <Attribute>
      <AttributeName>System.Runtime.InteropServices.ComVisible(false)</AttributeName>
    </Attribute>
  </Attributes>
  <Docs>
    <summary>
      <span data-ttu-id="c80a0-101">指定用于搜索提供平台调用函数的 DLL 的路径。</span>
      <span class="sxs-lookup">
        <span data-stu-id="c80a0-101">Specifies the paths that are used to search for DLLs that provide functions for platform invokes.</span>
      </span>
    </summary>
    <remarks>
      <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="c80a0-102">应用于程序集时，此属性指定默认用于搜索提供平台的函数的任何 DLL 的路径调用，在程序集中的任何代码。</span><span class="sxs-lookup"><span data-stu-id="c80a0-102">When applied to an assembly, this attribute specifies the paths that are used by default to search for any DLL that provides a function for a platform invoke, in any code in the assembly.</span></span> <span data-ttu-id="c80a0-103">当应用于单个平台调用时，此特性将重写程序集指定的默认搜索路径。</span><span class="sxs-lookup"><span data-stu-id="c80a0-103">When applied to an individual platform invoke, this attribute overrides the default search paths that were specified for the assembly.</span></span>  
  
 <span data-ttu-id="c80a0-104">对任何平台调用，用于指定绝对路径，则忽略此属性。</span><span class="sxs-lookup"><span data-stu-id="c80a0-104">This attribute is ignored for any platform invoke that specifies an absolute path.</span></span>  
  
 <span data-ttu-id="c80a0-105">使用此属性可防止 Win32`LoadLibraryEx`从搜索当前工作目录的函数。</span><span class="sxs-lookup"><span data-stu-id="c80a0-105">Use this attribute to prevent the Win32 `LoadLibraryEx` function from searching the current working directory.</span></span> <span data-ttu-id="c80a0-106">这有助于保护你的应用程序免受攻击的恶意软件放置指向的 DLL 在当前工作目录中，以便当平台 invoke 调用 Win32`LoadLibraryEx`函数，该函数的默认搜索顺序查找恶意 DLL 改为系统 DLL，它本来就查找。</span><span class="sxs-lookup"><span data-stu-id="c80a0-106">This helps protect your application from attacks in which malicious software places a DLL in the current working directory, so that when a platform invoke calls the Win32 `LoadLibraryEx` function, the function's default search order finds the malicious DLL instead of the system DLL it was intended to find.</span></span>  
  
 <span data-ttu-id="c80a0-107">公共语言运行时处理调用[LoadLibraryEx](http://go.microsoft.com/fwlink/?LinkId=236091)函数根据以下算法：</span><span class="sxs-lookup"><span data-stu-id="c80a0-107">The common language runtime handles the call to the [LoadLibraryEx](http://go.microsoft.com/fwlink/?LinkId=236091)function according to the following algorithm:</span></span>  
  
1.  <span data-ttu-id="c80a0-108">如果此特性应用到单个平台调用，使用该实例的属性所指定的值。</span><span class="sxs-lookup"><span data-stu-id="c80a0-108">If the attribute is applied to an individual platform invoke, use the values specified by that instance of the attribute.</span></span>  
  
2.  <span data-ttu-id="c80a0-109">否则为如果该特性应用到包含该平台的程序集调用，使用该实例的属性所指定的值。</span><span class="sxs-lookup"><span data-stu-id="c80a0-109">Otherwise, if the attribute is applied to the assembly that contains the platform invoke, use the values specified by that instance of the attribute.</span></span>  
  
3.  <span data-ttu-id="c80a0-110">否则为在程序集目录中搜索，然后调用`LoadLibraryEx`起作用`LOAD_WITH_ALTERED_SEARCH_PATH`标志。</span><span class="sxs-lookup"><span data-stu-id="c80a0-110">Otherwise, search the assembly directory and then call the `LoadLibraryEx` function with the `LOAD_WITH_ALTERED_SEARCH_PATH` flag.</span></span>  
  
 ]]></format>
    </remarks>
    <altmember cref="T:System.Runtime.InteropServices.DllImportSearchPath" />
  </Docs>
  <Members>
    <Member MemberName=".ctor">
      <MemberSignature Language="C#" Value="public DefaultDllImportSearchPathsAttribute (System.Runtime.InteropServices.DllImportSearchPath paths);" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig specialname rtspecialname instance void .ctor(valuetype System.Runtime.InteropServices.DllImportSearchPath paths) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Runtime.InteropServices.DefaultDllImportSearchPathsAttribute.#ctor(System.Runtime.InteropServices.DllImportSearchPath)" />
      <MemberSignature Language="VB.NET" Value="Public Sub New (paths As DllImportSearchPath)" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; DefaultDllImportSearchPathsAttribute(System::Runtime::InteropServices::DllImportSearchPath paths);" />
      <MemberType>Constructor</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Runtime.InteropServices</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.10.0</AssemblyVersion>
        <AssemblyVersion>4.0.20.0</AssemblyVersion>
        <AssemblyVersion>4.1.0.0</AssemblyVersion>
        <AssemblyVersion>4.1.1.0</AssemblyVersion>
        <AssemblyVersion>4.2.0.0</AssemblyVersion>
        <AssemblyVersion>4.2.1.0</AssemblyVersion>
      </AssemblyInfo>
      <AssemblyInfo>
        <AssemblyName>mscorlib</AssemblyName>
        <AssemblyVersion>2.0.5.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <AssemblyInfo>
        <AssemblyName>netstandard</AssemblyName>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Parameters>
        <Parameter Name="paths" Type="System.Runtime.InteropServices.DllImportSearchPath" />
      </Parameters>
      <Docs>
        <param name="paths">
          <span data-ttu-id="c80a0-111">用于指定平台调用期间 LoadLibraryEx<c></c> 函数搜索路径的枚举值的按位组合。</span>
          <span class="sxs-lookup">
            <span data-stu-id="c80a0-111">A bitwise combination of enumeration values that specify the paths that the <c>LoadLibraryEx</c> function searches during platform invokes.</span>
          </span>
        </param>
        <summary>
          <span data-ttu-id="c80a0-112">初始化 <see cref="T:System.Runtime.InteropServices.DefaultDllImportSearchPathsAttribute" /> 类的新实例，该实例指定在搜索目标平台调用时使用的路径。</span>
          <span class="sxs-lookup">
            <span data-stu-id="c80a0-112">Initializes a new instance of the <see cref="T:System.Runtime.InteropServices.DefaultDllImportSearchPathsAttribute" /> class, specifying the paths to use when searching for the targets of platform invokes.</span>
          </span>
        </summary>
        <remarks>To be added.</remarks>
      </Docs>
    </Member>
    <Member MemberName="Paths">
      <MemberSignature Language="C#" Value="public System.Runtime.InteropServices.DllImportSearchPath Paths { get; }" />
      <MemberSignature Language="ILAsm" Value=".property instance valuetype System.Runtime.InteropServices.DllImportSearchPath Paths" />
      <MemberSignature Language="DocId" Value="P:System.Runtime.InteropServices.DefaultDllImportSearchPathsAttribute.Paths" />
      <MemberSignature Language="VB.NET" Value="Public ReadOnly Property Paths As DllImportSearchPath" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; property System::Runtime::InteropServices::DllImportSearchPath Paths { System::Runtime::InteropServices::DllImportSearchPath get(); };" />
      <MemberType>Property</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Runtime.InteropServices</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.10.0</AssemblyVersion>
        <AssemblyVersion>4.0.20.0</AssemblyVersion>
        <AssemblyVersion>4.1.0.0</AssemblyVersion>
        <AssemblyVersion>4.1.1.0</AssemblyVersion>
        <AssemblyVersion>4.2.0.0</AssemblyVersion>
        <AssemblyVersion>4.2.1.0</AssemblyVersion>
      </AssemblyInfo>
      <AssemblyInfo>
        <AssemblyName>mscorlib</AssemblyName>
        <AssemblyVersion>2.0.5.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <AssemblyInfo>
        <AssemblyName>netstandard</AssemblyName>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Runtime.InteropServices.DllImportSearchPath</ReturnType>
      </ReturnValue>
      <Docs>
        <summary>
          <span data-ttu-id="c80a0-113">获取用于指定平台调用期间 LoadLibraryEx<c></c> 函数搜索路径的枚举值的按位组合。</span>
          <span class="sxs-lookup">
            <span data-stu-id="c80a0-113">Gets a bitwise combination of enumeration values that specify the paths that the <c>LoadLibraryEx</c> function searches during platform invokes.</span>
          </span>
        </summary>
        <value>
          <span data-ttu-id="c80a0-114">指定平台调用搜索路径的枚举值的按位组合。</span>
          <span class="sxs-lookup">
            <span data-stu-id="c80a0-114">A bitwise combination of enumeration values that specify search paths for platform invokes.</span>
          </span>
        </value>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="c80a0-115">当<xref:System.Runtime.InteropServices.DefaultDllImportSearchPathsAttribute>属性应用于程序集，则路径使用默认情况下搜索在任何平台的目标时执行的程序集中的代码，将调用。</span><span class="sxs-lookup"><span data-stu-id="c80a0-115">When the <xref:System.Runtime.InteropServices.DefaultDllImportSearchPathsAttribute> attribute is applied to an assembly, the paths are used by default to search for the targets of any platform invokes that are performed by code in the assembly.</span></span> <span data-ttu-id="c80a0-116">当该属性应用于单个平台调用、 路径用于搜索的目标的单个平台调用，并覆盖为程序集指定的路径。</span><span class="sxs-lookup"><span data-stu-id="c80a0-116">When the attribute is applied to an individual platform invoke, the paths are used to search for the target of the individual platform invoke and override the paths that are specified for the assembly.</span></span>  
  
 ]]></format>
        </remarks>
      </Docs>
    </Member>
  </Members>
</Type>