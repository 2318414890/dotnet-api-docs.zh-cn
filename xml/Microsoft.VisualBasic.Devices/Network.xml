<Type Name="Network" FullName="Microsoft.VisualBasic.Devices.Network">
  <Metadata>
    <Meta Name="ms.openlocfilehash" Value="2b8f23cf205838602c00ee131a0d1fcec41f6995" />
    <Meta Name="ms.sourcegitcommit" Value="434f60616a9793fa8436744549fc856e94f7a648" />
    <Meta Name="ms.translationtype" Value="HT" />
    <Meta Name="ms.contentlocale" Value="zh-CN" />
    <Meta Name="ms.lasthandoff" Value="08/25/2018" />
    <Meta Name="ms.locfileid" Value="39981271" />
  </Metadata>
  <TypeSignature Language="C#" Value="public class Network" />
  <TypeSignature Language="ILAsm" Value=".class public auto ansi Network extends System.Object" />
  <TypeSignature Language="DocId" Value="T:Microsoft.VisualBasic.Devices.Network" />
  <TypeSignature Language="VB.NET" Value="Public Class Network" />
  <TypeSignature Language="C++ CLI" Value="public ref class Network" />
  <TypeSignature Language="F#" Value="type Network = class" />
  <AssemblyInfo>
    <AssemblyName>Microsoft.VisualBasic</AssemblyName>
    <AssemblyVersion>8.0.0.0</AssemblyVersion>
    <AssemblyVersion>10.0.0.0</AssemblyVersion>
  </AssemblyInfo>
  <Base>
    <BaseTypeName>System.Object</BaseTypeName>
  </Base>
  <Interfaces />
  <Docs>
    <summary>
      <span data-ttu-id="bea5c-101">提供用于与计算机所连接的网络进行交互的属性、事件和方法。</span>
      <span class="sxs-lookup">
        <span data-stu-id="bea5c-101">Provides a property, event, and methods for interacting with the network to which the computer is connected.</span>
      </span>
    </summary>
    <remarks>
      <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="bea5c-102">下表列出了所涉及的任务的示例`My.Computer.Network`对象。</span><span class="sxs-lookup"><span data-stu-id="bea5c-102">The following table lists examples of tasks involving the `My.Computer.Network` object.</span></span>  
  
|<span data-ttu-id="bea5c-103">到</span><span class="sxs-lookup"><span data-stu-id="bea5c-103">To</span></span>|<span data-ttu-id="bea5c-104">查看</span><span class="sxs-lookup"><span data-stu-id="bea5c-104">See</span></span>|  
|-|-|  
|<span data-ttu-id="bea5c-105">上传文件</span><span class="sxs-lookup"><span data-stu-id="bea5c-105">Upload a file</span></span>|[<span data-ttu-id="bea5c-106">如何：上载文件</span><span class="sxs-lookup"><span data-stu-id="bea5c-106">How to: Upload a File</span></span>](~/docs/visual-basic/developing-apps/programming/computer-resources/how-to-upload-a-file.md)|  
|<span data-ttu-id="bea5c-107">下载的文件</span><span class="sxs-lookup"><span data-stu-id="bea5c-107">Download a file</span></span>|[<span data-ttu-id="bea5c-108">如何：下载文件</span><span class="sxs-lookup"><span data-stu-id="bea5c-108">How to: Download a File</span></span>](~/docs/visual-basic/developing-apps/programming/computer-resources/how-to-download-a-file.md)|  
|<span data-ttu-id="bea5c-109">检查连接状态</span><span class="sxs-lookup"><span data-stu-id="bea5c-109">Check connection status</span></span>|[<span data-ttu-id="bea5c-110">如何：检查连接状态</span><span class="sxs-lookup"><span data-stu-id="bea5c-110">How to: Check Connection Status</span></span>](~/docs/visual-basic/developing-apps/programming/computer-resources/how-to-check-connection-status.md)|  
  
   
  
## Examples  
 <span data-ttu-id="bea5c-111">此示例将文件上传`Order.txt`到http://www.cohowinery.com/uploads。</span><span class="sxs-lookup"><span data-stu-id="bea5c-111">This example uploads the file `Order.txt` to http://www.cohowinery.com/uploads.</span></span>  
  
 [!code-vb[VbVbalrMyNetwork#6](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbalrMyNetwork/VB/Class1.vb#6)]  
  
 ]]></format>
    </remarks>
    <altmember cref="E:Microsoft.VisualBasic.Devices.Network.NetworkAvailabilityChanged" />
  </Docs>
  <Members>
    <Member MemberName=".ctor">
      <MemberSignature Language="C#" Value="public Network ();" />
      <MemberSignature Language="ILAsm" Value=".method public specialname rtspecialname instance void .ctor() cil managed" />
      <MemberSignature Language="DocId" Value="M:Microsoft.VisualBasic.Devices.Network.#ctor" />
      <MemberSignature Language="VB.NET" Value="Public Sub New ()" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; Network();" />
      <MemberType>Constructor</MemberType>
      <AssemblyInfo>
        <AssemblyName>Microsoft.VisualBasic</AssemblyName>
        <AssemblyVersion>8.0.0.0</AssemblyVersion>
        <AssemblyVersion>10.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Parameters />
      <Docs>
        <summary>
          <span data-ttu-id="bea5c-112">初始化 <see cref="T:Microsoft.VisualBasic.Devices.Network" /> 类的新实例。</span>
          <span class="sxs-lookup">
            <span data-stu-id="bea5c-112">Initializes a new instance of the <see cref="T:Microsoft.VisualBasic.Devices.Network" /> class.</span>
          </span>
        </summary>
        <remarks>To be added.</remarks>
      </Docs>
    </Member>
    <MemberGroup MemberName="DownloadFile">
      <AssemblyInfo>
        <AssemblyName>Microsoft.VisualBasic</AssemblyName>
        <AssemblyVersion>10.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Docs>
        <summary>
          <span data-ttu-id="bea5c-113">下载指定的远程文件，并将其保存到指定位置。</span>
          <span class="sxs-lookup">
            <span data-stu-id="bea5c-113">Downloads the specified remote file and saves it in the specified location.</span>
          </span>
        </summary>
      </Docs>
    </MemberGroup>
    <Member MemberName="DownloadFile">
      <MemberSignature Language="C#" Value="public void DownloadFile (string address, string destinationFileName);" />
      <MemberSignature Language="ILAsm" Value=".method public instance void DownloadFile(string address, string destinationFileName) cil managed" />
      <MemberSignature Language="DocId" Value="M:Microsoft.VisualBasic.Devices.Network.DownloadFile(System.String,System.String)" />
      <MemberSignature Language="VB.NET" Value="Public Sub DownloadFile (address As String, destinationFileName As String)" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; void DownloadFile(System::String ^ address, System::String ^ destinationFileName);" />
      <MemberSignature Language="F#" Value="member this.DownloadFile : string * string -&gt; unit" Usage="network.DownloadFile (address, destinationFileName)" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>Microsoft.VisualBasic</AssemblyName>
        <AssemblyVersion>8.0.0.0</AssemblyVersion>
        <AssemblyVersion>10.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Attributes>
        <Attribute FrameworkAlternate="netframework-4.0">
          <AttributeName>System.Runtime.TargetedPatchingOptOut("Performance critical to inline this type of method across NGen image boundaries")</AttributeName>
        </Attribute>
      </Attributes>
      <ReturnValue>
        <ReturnType>System.Void</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="address" Type="System.String" />
        <Parameter Name="destinationFileName" Type="System.String" />
      </Parameters>
      <Docs>
        <param name="address">
          <span data-ttu-id="bea5c-114">要下载的文件的路径，包括文件名和主机地址。</span>
          <span class="sxs-lookup">
            <span data-stu-id="bea5c-114">Path of the file to download, including file name and host address.</span>
          </span>
        </param>
        <param name="destinationFileName">
          <span data-ttu-id="bea5c-115">下载的文件的文件名和路径。</span>
          <span class="sxs-lookup">
            <span data-stu-id="bea5c-115">File name and path of the downloaded file.</span>
          </span>
        </param>
        <summary>
          <span data-ttu-id="bea5c-116">下载指定的远程文件，并将其保存到指定位置。</span>
          <span class="sxs-lookup">
            <span data-stu-id="bea5c-116">Downloads the specified remote file and saves it in the specified location.</span>
          </span>
        </summary>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="bea5c-117">如果目标文件已存在，`DownloadFile`方法不会覆盖现有文件。</span><span class="sxs-lookup"><span data-stu-id="bea5c-117">If the destination file already exists, the `DownloadFile` method will not overwrite the existing file.</span></span> <span data-ttu-id="bea5c-118">可以使用的其他重载之一<xref:Microsoft.VisualBasic.Devices.Network.DownloadFile%2A>方法以指示它覆盖现有文件，提供用户凭据，或指定特定的超时值。</span><span class="sxs-lookup"><span data-stu-id="bea5c-118">You can use one of the other overloads of the <xref:Microsoft.VisualBasic.Devices.Network.DownloadFile%2A> method to instruct it to overwrite existing files, provide user credentials, or specify a specific timeout value.</span></span>  
  
 <span data-ttu-id="bea5c-119">`DownloadFile` 在应用程序中启用网络跟踪后，跟踪信息输出。</span><span class="sxs-lookup"><span data-stu-id="bea5c-119">`DownloadFile` outputs trace information when you enable network tracing in your application.</span></span> <span data-ttu-id="bea5c-120">有关详细信息，请参阅[启用网络跟踪](~/docs/framework/network-programming/enabling-network-tracing.md)。</span><span class="sxs-lookup"><span data-stu-id="bea5c-120">For more information, see [Enabling Network Tracing](~/docs/framework/network-programming/enabling-network-tracing.md).</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="bea5c-121">`DownloadFile`方法不会发送可选 HTTP 标头。</span><span class="sxs-lookup"><span data-stu-id="bea5c-121">The `DownloadFile` method does not send optional HTTP headers.</span></span> <span data-ttu-id="bea5c-122">如果缺少可选的用户代理标头，某些服务器可能会返回 500 （内部服务器错误）。</span><span class="sxs-lookup"><span data-stu-id="bea5c-122">Some servers may return 500 (Internal Server Error) if the optional user agent header is missing.</span></span> <span data-ttu-id="bea5c-123">若要发送可选标头，必须构造请求使用<xref:System.Net.WebClient>类。</span><span class="sxs-lookup"><span data-stu-id="bea5c-123">To send optional headers, you must construct a request using the <xref:System.Net.WebClient> class.</span></span>  
  
 <span data-ttu-id="bea5c-124">下表列出的任务涉及示例`My.Computer.Network.DownloadFile`方法。</span><span class="sxs-lookup"><span data-stu-id="bea5c-124">The following table lists an example of a task involving the `My.Computer.Network.DownloadFile` method.</span></span>  
  
|<span data-ttu-id="bea5c-125">到</span><span class="sxs-lookup"><span data-stu-id="bea5c-125">To</span></span>|<span data-ttu-id="bea5c-126">查看</span><span class="sxs-lookup"><span data-stu-id="bea5c-126">See</span></span>|  
|-|-|  
|<span data-ttu-id="bea5c-127">下载的文件</span><span class="sxs-lookup"><span data-stu-id="bea5c-127">Download a file</span></span>|[<span data-ttu-id="bea5c-128">如何：下载文件</span><span class="sxs-lookup"><span data-stu-id="bea5c-128">How to: Download a File</span></span>](~/docs/visual-basic/developing-apps/programming/computer-resources/how-to-download-a-file.md)|  
  
   
  
## Examples  
 <span data-ttu-id="bea5c-129">此示例会将文件下载`WineList.txt`从`http://www.cohowinery.com/downloads`并将其保存到`C:\Documents and Settings\All Users\Documents`。</span><span class="sxs-lookup"><span data-stu-id="bea5c-129">This example downloads the file `WineList.txt` from `http://www.cohowinery.com/downloads` and saves it to `C:\Documents and Settings\All Users\Documents`.</span></span>  
  
 [!code-vb[VbVbalrMyNetwork#7](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbalrMyNetwork/VB/Class1.vb#7)]  
  
 <span data-ttu-id="bea5c-130">此示例会将文件下载`WineList.txt`从`http://www.cohowinery.com/downloads`并将其保存到`C:\Documents and Settings\All Users\Documents`，指定超时间隔设置为 500 毫秒。</span><span class="sxs-lookup"><span data-stu-id="bea5c-130">This example downloads the file `WineList.txt` from `http://www.cohowinery.com/downloads` and saves it to `C:\Documents and Settings\All Users\Documents`, specifying a timeout interval of 500 milliseconds.</span></span>  
  
 [!code-vb[VbVbalrMyNetwork#8](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbalrMyNetwork/VB/Class1.vb#8)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentException">
          <span data-ttu-id="bea5c-131">
            <paramref name="destinationFileName" /> 以尾随斜杠结尾。</span>
          <span class="sxs-lookup">
            <span data-stu-id="bea5c-131">
              <paramref name="destinationFileName" /> ends with a trailing slash.</span>
          </span>
        </exception>
        <exception cref="T:System.TimeoutException">
          <span data-ttu-id="bea5c-132">服务器没有在指定的默认超时（100 秒）内响应。</span>
          <span class="sxs-lookup">
            <span data-stu-id="bea5c-132">The server does not respond within the default timeout (100 seconds).</span>
          </span>
        </exception>
        <exception cref="T:System.Security.SecurityException">
          <span data-ttu-id="bea5c-133">用户缺少必要的权限，无法执行网络操作。</span>
          <span class="sxs-lookup">
            <span data-stu-id="bea5c-133">User lacks necessary permissions to perform a network operation.</span>
          </span>
        </exception>
        <exception cref="T:System.Net.WebException">
          <span data-ttu-id="bea5c-134">请求被目标 Web 服务器拒绝。</span>
          <span class="sxs-lookup">
            <span data-stu-id="bea5c-134">The request is denied by the target web server.</span>
          </span>
        </exception>
        <permission cref="T:System.Security.Permissions.FileIOPermission">
          <span data-ttu-id="bea5c-135">控制文件和文件夹的访问权限。</span>
          <span class="sxs-lookup">
            <span data-stu-id="bea5c-135">Controls the ability to access files and folders.</span>
          </span>
          <span data-ttu-id="bea5c-136">关联枚举：<see cref="F:System.Security.Permissions.PermissionState.Unrestricted" />。</span>
          <span class="sxs-lookup">
            <span data-stu-id="bea5c-136">Associated enumeration: <see cref="F:System.Security.Permissions.PermissionState.Unrestricted" />.</span>
          </span>
        </permission>
        <permission cref="T:System.Net.WebPermission">
          <span data-ttu-id="bea5c-137">控制访问 HTTP Internet 资源的权限。</span>
          <span class="sxs-lookup">
            <span data-stu-id="bea5c-137">Controls rights to access HTTP Internet resources.</span>
          </span>
          <span data-ttu-id="bea5c-138">关联枚举：<see cref="F:System.Security.Permissions.PermissionState.Unrestricted" />。</span>
          <span class="sxs-lookup">
            <span data-stu-id="bea5c-138">Associated enumeration: <see cref="F:System.Security.Permissions.PermissionState.Unrestricted" />.</span>
          </span>
        </permission>
        <altmember cref="T:System.Uri" />
        <altmember cref="T:System.Net.ICredentials" />
      </Docs>
    </Member>
    <Member MemberName="DownloadFile">
      <MemberSignature Language="C#" Value="public void DownloadFile (Uri address, string destinationFileName);" />
      <MemberSignature Language="ILAsm" Value=".method public instance void DownloadFile(class System.Uri address, string destinationFileName) cil managed" />
      <MemberSignature Language="DocId" Value="M:Microsoft.VisualBasic.Devices.Network.DownloadFile(System.Uri,System.String)" />
      <MemberSignature Language="VB.NET" Value="Public Sub DownloadFile (address As Uri, destinationFileName As String)" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; void DownloadFile(Uri ^ address, System::String ^ destinationFileName);" />
      <MemberSignature Language="F#" Value="member this.DownloadFile : Uri * string -&gt; unit" Usage="network.DownloadFile (address, destinationFileName)" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>Microsoft.VisualBasic</AssemblyName>
        <AssemblyVersion>8.0.0.0</AssemblyVersion>
        <AssemblyVersion>10.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Attributes>
        <Attribute FrameworkAlternate="netframework-4.0">
          <AttributeName>System.Runtime.TargetedPatchingOptOut("Performance critical to inline this type of method across NGen image boundaries")</AttributeName>
        </Attribute>
      </Attributes>
      <ReturnValue>
        <ReturnType>System.Void</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="address" Type="System.Uri" />
        <Parameter Name="destinationFileName" Type="System.String" />
      </Parameters>
      <Docs>
        <param name="address">
          <span data-ttu-id="bea5c-139">要下载的文件的路径，包括文件名和主机地址。</span>
          <span class="sxs-lookup">
            <span data-stu-id="bea5c-139">Path of the file to download, including file name and host address.</span>
          </span>
        </param>
        <param name="destinationFileName">
          <span data-ttu-id="bea5c-140">下载的文件的文件名和路径。</span>
          <span class="sxs-lookup">
            <span data-stu-id="bea5c-140">File name and path of the downloaded file.</span>
          </span>
        </param>
        <summary>
          <span data-ttu-id="bea5c-141">下载指定的远程文件，并将其保存到指定位置。</span>
          <span class="sxs-lookup">
            <span data-stu-id="bea5c-141">Downloads the specified remote file and saves it in the specified location.</span>
          </span>
        </summary>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="bea5c-142">如果目标文件已存在，`DownloadFile`方法不会覆盖现有文件。</span><span class="sxs-lookup"><span data-stu-id="bea5c-142">If the destination file already exists, the `DownloadFile` method will not overwrite the existing file.</span></span> <span data-ttu-id="bea5c-143">可以使用的其他重载之一<xref:Microsoft.VisualBasic.Devices.Network.DownloadFile%2A>方法以指示它覆盖现有文件，提供用户凭据，或指定特定的超时值。</span><span class="sxs-lookup"><span data-stu-id="bea5c-143">You can use one of the other overloads of the <xref:Microsoft.VisualBasic.Devices.Network.DownloadFile%2A> method to instruct it to overwrite existing files, provide user credentials, or specify a specific timeout value.</span></span> <span data-ttu-id="bea5c-144">`DownloadFile` 在应用程序中启用网络跟踪后，跟踪信息输出。</span><span class="sxs-lookup"><span data-stu-id="bea5c-144">`DownloadFile` outputs trace information when you enable network tracing in your application.</span></span> <span data-ttu-id="bea5c-145">有关详细信息，请参阅[启用网络跟踪](~/docs/framework/network-programming/enabling-network-tracing.md)。</span><span class="sxs-lookup"><span data-stu-id="bea5c-145">For more information, see [Enabling Network Tracing](~/docs/framework/network-programming/enabling-network-tracing.md).</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="bea5c-146">`DownloadFile`方法不会发送可选 HTTP 标头。</span><span class="sxs-lookup"><span data-stu-id="bea5c-146">The `DownloadFile` method does not send optional HTTP headers.</span></span> <span data-ttu-id="bea5c-147">如果缺少可选的用户代理标头，某些服务器可能会返回 500 （内部服务器错误）。</span><span class="sxs-lookup"><span data-stu-id="bea5c-147">Some servers may return 500 (Internal Server Error) if the optional user agent header is missing.</span></span> <span data-ttu-id="bea5c-148">若要发送可选标头，必须构造请求使用<xref:System.Net.WebClient>类。</span><span class="sxs-lookup"><span data-stu-id="bea5c-148">To send optional headers, you must construct a request using the <xref:System.Net.WebClient> class.</span></span>  
  
 <span data-ttu-id="bea5c-149">下表列出的任务涉及示例`My.Computer.Network.DownloadFile`方法。</span><span class="sxs-lookup"><span data-stu-id="bea5c-149">The following table lists an example of a task involving the `My.Computer.Network.DownloadFile` method.</span></span>  
  
|<span data-ttu-id="bea5c-150">到</span><span class="sxs-lookup"><span data-stu-id="bea5c-150">To</span></span>|<span data-ttu-id="bea5c-151">查看</span><span class="sxs-lookup"><span data-stu-id="bea5c-151">See</span></span>|  
|-|-|  
|<span data-ttu-id="bea5c-152">下载的文件</span><span class="sxs-lookup"><span data-stu-id="bea5c-152">Download a file</span></span>|[<span data-ttu-id="bea5c-153">如何：下载文件</span><span class="sxs-lookup"><span data-stu-id="bea5c-153">How to: Download a File</span></span>](~/docs/visual-basic/developing-apps/programming/computer-resources/how-to-download-a-file.md)|  
  
   
  
## Examples  
 <span data-ttu-id="bea5c-154">此示例会将文件下载`WineList.txt`从`http://www.cohowinery.com/downloads`并将其保存到`C:\Documents and Settings\All Users\Documents`。</span><span class="sxs-lookup"><span data-stu-id="bea5c-154">This example downloads the file `WineList.txt` from `http://www.cohowinery.com/downloads` and saves it to `C:\Documents and Settings\All Users\Documents`.</span></span>  
  
 [!code-vb[VbVbalrMyNetwork#7](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbalrMyNetwork/VB/Class1.vb#7)]  
  
 <span data-ttu-id="bea5c-155">此示例会将文件下载`WineList.txt`从`http://www.cohowinery.com/downloads`并将其保存到`C:\Documents and Settings\All Users\Documents`，指定超时间隔设置为 500 毫秒。</span><span class="sxs-lookup"><span data-stu-id="bea5c-155">This example downloads the file `WineList.txt` from `http://www.cohowinery.com/downloads` and saves it to `C:\Documents and Settings\All Users\Documents`, specifying a timeout interval of 500 milliseconds.</span></span>  
  
 [!code-vb[VbVbalrMyNetwork#8](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbalrMyNetwork/VB/Class1.vb#8)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentException">
          <span data-ttu-id="bea5c-156">
            <paramref name="destinationFileName" /> 以尾随斜杠结尾。</span>
          <span class="sxs-lookup">
            <span data-stu-id="bea5c-156">
              <paramref name="destinationFileName" /> ends with a trailing slash.</span>
          </span>
        </exception>
        <exception cref="T:System.TimeoutException">
          <span data-ttu-id="bea5c-157">服务器没有在指定的默认超时（100 秒）内响应。</span>
          <span class="sxs-lookup">
            <span data-stu-id="bea5c-157">The server does not respond within the default timeout (100 seconds).</span>
          </span>
        </exception>
        <exception cref="T:System.Security.SecurityException">
          <span data-ttu-id="bea5c-158">用户缺少必要的权限，无法执行网络操作。</span>
          <span class="sxs-lookup">
            <span data-stu-id="bea5c-158">User lacks necessary permissions to perform a network operation.</span>
          </span>
        </exception>
        <exception cref="T:System.Net.WebException">
          <span data-ttu-id="bea5c-159">请求被目标 Web 服务器拒绝。</span>
          <span class="sxs-lookup">
            <span data-stu-id="bea5c-159">The request is denied by the target web server.</span>
          </span>
        </exception>
        <permission cref="T:System.Security.Permissions.FileIOPermission">
          <span data-ttu-id="bea5c-160">控制文件和文件夹的访问权限。</span>
          <span class="sxs-lookup">
            <span data-stu-id="bea5c-160">Controls the ability to access files and folders.</span>
          </span>
          <span data-ttu-id="bea5c-161">关联枚举：<see cref="F:System.Security.Permissions.PermissionState.Unrestricted" />。</span>
          <span class="sxs-lookup">
            <span data-stu-id="bea5c-161">Associated enumeration: <see cref="F:System.Security.Permissions.PermissionState.Unrestricted" />.</span>
          </span>
        </permission>
        <permission cref="T:System.Net.WebPermission">
          <span data-ttu-id="bea5c-162">控制访问 HTTP Internet 资源的权限。</span>
          <span class="sxs-lookup">
            <span data-stu-id="bea5c-162">Controls rights to access HTTP Internet resources.</span>
          </span>
          <span data-ttu-id="bea5c-163">关联枚举：<see cref="F:System.Security.Permissions.PermissionState.Unrestricted" />。</span>
          <span class="sxs-lookup">
            <span data-stu-id="bea5c-163">Associated enumeration: <see cref="F:System.Security.Permissions.PermissionState.Unrestricted" />.</span>
          </span>
        </permission>
        <altmember cref="T:System.Uri" />
        <altmember cref="T:System.Net.ICredentials" />
      </Docs>
    </Member>
    <Member MemberName="DownloadFile">
      <MemberSignature Language="C#" Value="public void DownloadFile (string address, string destinationFileName, string userName, string password);" />
      <MemberSignature Language="ILAsm" Value=".method public instance void DownloadFile(string address, string destinationFileName, string userName, string password) cil managed" />
      <MemberSignature Language="DocId" Value="M:Microsoft.VisualBasic.Devices.Network.DownloadFile(System.String,System.String,System.String,System.String)" />
      <MemberSignature Language="VB.NET" Value="Public Sub DownloadFile (address As String, destinationFileName As String, userName As String, password As String)" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; void DownloadFile(System::String ^ address, System::String ^ destinationFileName, System::String ^ userName, System::String ^ password);" />
      <MemberSignature Language="F#" Value="member this.DownloadFile : string * string * string * string -&gt; unit" Usage="network.DownloadFile (address, destinationFileName, userName, password)" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>Microsoft.VisualBasic</AssemblyName>
        <AssemblyVersion>8.0.0.0</AssemblyVersion>
        <AssemblyVersion>10.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Attributes>
        <Attribute FrameworkAlternate="netframework-4.0">
          <AttributeName>System.Runtime.TargetedPatchingOptOut("Performance critical to inline this type of method across NGen image boundaries")</AttributeName>
        </Attribute>
      </Attributes>
      <ReturnValue>
        <ReturnType>System.Void</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="address" Type="System.String" />
        <Parameter Name="destinationFileName" Type="System.String" />
        <Parameter Name="userName" Type="System.String" />
        <Parameter Name="password" Type="System.String" />
      </Parameters>
      <Docs>
        <param name="address">
          <span data-ttu-id="bea5c-164">要下载的文件的路径，包括文件名和主机地址。</span>
          <span class="sxs-lookup">
            <span data-stu-id="bea5c-164">Path of the file to download, including file name and host address.</span>
          </span>
        </param>
        <param name="destinationFileName">
          <span data-ttu-id="bea5c-165">下载的文件的文件名和路径。</span>
          <span class="sxs-lookup">
            <span data-stu-id="bea5c-165">File name and path of the downloaded file.</span>
          </span>
        </param>
        <param name="userName">
          <span data-ttu-id="bea5c-166">要进行身份验证的用户名。</span>
          <span class="sxs-lookup">
            <span data-stu-id="bea5c-166">User name to authenticate.</span>
          </span>
          <span data-ttu-id="bea5c-167">默认值为空字符串 ""。</span>
          <span class="sxs-lookup">
            <span data-stu-id="bea5c-167">Default is an empty string, "".</span>
          </span>
        </param>
        <param name="password">
          <span data-ttu-id="bea5c-168">要验证的密码。</span>
          <span class="sxs-lookup">
            <span data-stu-id="bea5c-168">Password to authenticate.</span>
          </span>
          <span data-ttu-id="bea5c-169">默认值为空字符串 ""。</span>
          <span class="sxs-lookup">
            <span data-stu-id="bea5c-169">Default is an empty string, "".</span>
          </span>
        </param>
        <summary>
          <span data-ttu-id="bea5c-170">下载指定的远程文件，并将其保存到指定位置。</span>
          <span class="sxs-lookup">
            <span data-stu-id="bea5c-170">Downloads the specified remote file and saves it in the specified location.</span>
          </span>
        </summary>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="bea5c-171">如果目标文件已存在，`DownloadFile`方法不会覆盖现有文件。</span><span class="sxs-lookup"><span data-stu-id="bea5c-171">If the destination file already exists, the `DownloadFile` method will not overwrite the existing file.</span></span> <span data-ttu-id="bea5c-172">可以使用的其他重载之一<xref:Microsoft.VisualBasic.Devices.Network.DownloadFile%2A>方法以指示它可以覆盖现有文件或指定特定的超时值。</span><span class="sxs-lookup"><span data-stu-id="bea5c-172">You can use one of the other overloads of the <xref:Microsoft.VisualBasic.Devices.Network.DownloadFile%2A> method to instruct it to overwrite existing files or specify a specific timeout value.</span></span>  
  
 <span data-ttu-id="bea5c-173">`DownloadFile` 在应用程序中启用网络跟踪后，跟踪信息输出。</span><span class="sxs-lookup"><span data-stu-id="bea5c-173">`DownloadFile` outputs trace information when you enable network tracing in your application.</span></span> <span data-ttu-id="bea5c-174">有关详细信息，请参阅[启用网络跟踪](~/docs/framework/network-programming/enabling-network-tracing.md)。</span><span class="sxs-lookup"><span data-stu-id="bea5c-174">For more information, see [Enabling Network Tracing](~/docs/framework/network-programming/enabling-network-tracing.md).</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="bea5c-175">`DownloadFile`方法不会发送可选 HTTP 标头。</span><span class="sxs-lookup"><span data-stu-id="bea5c-175">The `DownloadFile` method does not send optional HTTP headers.</span></span> <span data-ttu-id="bea5c-176">如果缺少可选的用户代理标头，某些服务器可能会返回 500 （内部服务器错误）。</span><span class="sxs-lookup"><span data-stu-id="bea5c-176">Some servers may return 500 (Internal Server Error) if the optional user agent header is missing.</span></span> <span data-ttu-id="bea5c-177">若要发送可选标头，必须构造请求使用<xref:System.Net.WebClient>类。</span><span class="sxs-lookup"><span data-stu-id="bea5c-177">To send optional headers, you must construct a request using the <xref:System.Net.WebClient> class.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="bea5c-178">FTP 协议发送的信息，包括以纯文本密码，并不应使用用于传输敏感信息。</span><span class="sxs-lookup"><span data-stu-id="bea5c-178">The FTP protocol sends information, including passwords, in plain text and should not be used for transmitting sensitive information.</span></span>  
  
 <span data-ttu-id="bea5c-179">下表列出的任务涉及示例`My.Computer.Network.DownloadFile`方法。</span><span class="sxs-lookup"><span data-stu-id="bea5c-179">The following table lists an example of a task involving the `My.Computer.Network.DownloadFile` method.</span></span>  
  
|<span data-ttu-id="bea5c-180">到</span><span class="sxs-lookup"><span data-stu-id="bea5c-180">To</span></span>|<span data-ttu-id="bea5c-181">查看</span><span class="sxs-lookup"><span data-stu-id="bea5c-181">See</span></span>|  
|-|-|  
|<span data-ttu-id="bea5c-182">下载的文件</span><span class="sxs-lookup"><span data-stu-id="bea5c-182">Download a file</span></span>|[<span data-ttu-id="bea5c-183">如何：下载文件</span><span class="sxs-lookup"><span data-stu-id="bea5c-183">How to: Download a File</span></span>](~/docs/visual-basic/developing-apps/programming/computer-resources/how-to-download-a-file.md)|  
  
   
  
## Examples  
 <span data-ttu-id="bea5c-184">此示例会将文件下载`WineList.txt`从`http://www.cohowinery.com/downloads`并将其保存到`C:\Documents and Settings\All Users\Documents`。</span><span class="sxs-lookup"><span data-stu-id="bea5c-184">This example downloads the file `WineList.txt` from `http://www.cohowinery.com/downloads` and saves it to `C:\Documents and Settings\All Users\Documents`.</span></span>  
  
 [!code-vb[VbVbalrMyNetwork#7](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbalrMyNetwork/VB/Class1.vb#7)]  
  
 <span data-ttu-id="bea5c-185">此示例会将文件下载`WineList.txt`从`http://www.cohowinery.com/downloads`并将其保存到`C:\Documents and Settings\All Users\Documents`，指定超时间隔设置为 500 毫秒。</span><span class="sxs-lookup"><span data-stu-id="bea5c-185">This example downloads the file `WineList.txt` from `http://www.cohowinery.com/downloads` and saves it to `C:\Documents and Settings\All Users\Documents`, specifying a timeout interval of 500 milliseconds.</span></span>  
  
 [!code-vb[VbVbalrMyNetwork#8](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbalrMyNetwork/VB/Class1.vb#8)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentException">
          <span data-ttu-id="bea5c-186">
            <paramref name="destinationFileName" /> 以尾随斜杠结尾。</span>
          <span class="sxs-lookup">
            <span data-stu-id="bea5c-186">
              <paramref name="destinationFileName" /> ends with a trailing slash.</span>
          </span>
        </exception>
        <exception cref="T:System.TimeoutException">
          <span data-ttu-id="bea5c-187">服务器没有在指定的默认超时（100 秒）内响应。</span>
          <span class="sxs-lookup">
            <span data-stu-id="bea5c-187">The server does not respond within the default timeout (100 seconds).</span>
          </span>
        </exception>
        <exception cref="T:System.Security.SecurityException">
          <span data-ttu-id="bea5c-188">用户缺少必要的权限，无法执行网络操作。</span>
          <span class="sxs-lookup">
            <span data-stu-id="bea5c-188">User lacks necessary permissions to perform a network operation.</span>
          </span>
        </exception>
        <exception cref="T:System.Net.WebException">
          <span data-ttu-id="bea5c-189">请求被目标 Web 服务器拒绝。</span>
          <span class="sxs-lookup">
            <span data-stu-id="bea5c-189">The request is denied by the target web server.</span>
          </span>
        </exception>
        <permission cref="T:System.Security.Permissions.FileIOPermission">
          <span data-ttu-id="bea5c-190">控制文件和文件夹的访问权限。</span>
          <span class="sxs-lookup">
            <span data-stu-id="bea5c-190">Controls the ability to access files and folders.</span>
          </span>
          <span data-ttu-id="bea5c-191">关联枚举：<see cref="F:System.Security.Permissions.PermissionState.Unrestricted" />。</span>
          <span class="sxs-lookup">
            <span data-stu-id="bea5c-191">Associated enumeration: <see cref="F:System.Security.Permissions.PermissionState.Unrestricted" />.</span>
          </span>
        </permission>
        <permission cref="T:System.Net.WebPermission">
          <span data-ttu-id="bea5c-192">控制访问 HTTP Internet 资源的权限。</span>
          <span class="sxs-lookup">
            <span data-stu-id="bea5c-192">Controls rights to access HTTP Internet resources.</span>
          </span>
          <span data-ttu-id="bea5c-193">关联枚举：<see cref="F:System.Security.Permissions.PermissionState.Unrestricted" />。</span>
          <span class="sxs-lookup">
            <span data-stu-id="bea5c-193">Associated enumeration: <see cref="F:System.Security.Permissions.PermissionState.Unrestricted" />.</span>
          </span>
        </permission>
        <altmember cref="T:System.Uri" />
        <altmember cref="T:System.Net.ICredentials" />
      </Docs>
    </Member>
    <Member MemberName="DownloadFile">
      <MemberSignature Language="C#" Value="public void DownloadFile (Uri address, string destinationFileName, string userName, string password);" />
      <MemberSignature Language="ILAsm" Value=".method public instance void DownloadFile(class System.Uri address, string destinationFileName, string userName, string password) cil managed" />
      <MemberSignature Language="DocId" Value="M:Microsoft.VisualBasic.Devices.Network.DownloadFile(System.Uri,System.String,System.String,System.String)" />
      <MemberSignature Language="VB.NET" Value="Public Sub DownloadFile (address As Uri, destinationFileName As String, userName As String, password As String)" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; void DownloadFile(Uri ^ address, System::String ^ destinationFileName, System::String ^ userName, System::String ^ password);" />
      <MemberSignature Language="F#" Value="member this.DownloadFile : Uri * string * string * string -&gt; unit" Usage="network.DownloadFile (address, destinationFileName, userName, password)" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>Microsoft.VisualBasic</AssemblyName>
        <AssemblyVersion>8.0.0.0</AssemblyVersion>
        <AssemblyVersion>10.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Attributes>
        <Attribute FrameworkAlternate="netframework-4.0">
          <AttributeName>System.Runtime.TargetedPatchingOptOut("Performance critical to inline this type of method across NGen image boundaries")</AttributeName>
        </Attribute>
      </Attributes>
      <ReturnValue>
        <ReturnType>System.Void</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="address" Type="System.Uri" />
        <Parameter Name="destinationFileName" Type="System.String" />
        <Parameter Name="userName" Type="System.String" />
        <Parameter Name="password" Type="System.String" />
      </Parameters>
      <Docs>
        <param name="address">
          <span data-ttu-id="bea5c-194">要下载的文件的路径，包括文件名和主机地址。</span>
          <span class="sxs-lookup">
            <span data-stu-id="bea5c-194">Path of the file to download, including file name and host address.</span>
          </span>
        </param>
        <param name="destinationFileName">
          <span data-ttu-id="bea5c-195">下载的文件的文件名和路径。</span>
          <span class="sxs-lookup">
            <span data-stu-id="bea5c-195">File name and path of the downloaded file.</span>
          </span>
        </param>
        <param name="userName">
          <span data-ttu-id="bea5c-196">要进行身份验证的用户名。</span>
          <span class="sxs-lookup">
            <span data-stu-id="bea5c-196">User name to authenticate.</span>
          </span>
          <span data-ttu-id="bea5c-197">默认值为空字符串 ""。</span>
          <span class="sxs-lookup">
            <span data-stu-id="bea5c-197">Default is an empty string, "".</span>
          </span>
        </param>
        <param name="password">
          <span data-ttu-id="bea5c-198">要验证的密码。</span>
          <span class="sxs-lookup">
            <span data-stu-id="bea5c-198">Password to authenticate.</span>
          </span>
          <span data-ttu-id="bea5c-199">默认值为空字符串 ""。</span>
          <span class="sxs-lookup">
            <span data-stu-id="bea5c-199">Default is an empty string, "".</span>
          </span>
        </param>
        <summary>
          <span data-ttu-id="bea5c-200">下载指定的远程文件，并将其保存到指定位置。</span>
          <span class="sxs-lookup">
            <span data-stu-id="bea5c-200">Downloads the specified remote file and saves it in the specified location.</span>
          </span>
        </summary>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="bea5c-201">如果目标文件已存在，`DownloadFile`方法不会覆盖现有文件。</span><span class="sxs-lookup"><span data-stu-id="bea5c-201">If the destination file already exists, the `DownloadFile` method will not overwrite the existing file.</span></span> <span data-ttu-id="bea5c-202">可以使用的其他重载之一<xref:Microsoft.VisualBasic.Devices.Network.DownloadFile%2A>方法以指示它可以覆盖现有文件或指定特定的超时值。</span><span class="sxs-lookup"><span data-stu-id="bea5c-202">You can use one of the other overloads of the <xref:Microsoft.VisualBasic.Devices.Network.DownloadFile%2A> method to instruct it to overwrite existing files or specify a specific timeout value.</span></span>  
  
 <span data-ttu-id="bea5c-203">`DownloadFile` 在应用程序中启用网络跟踪后，跟踪信息输出。</span><span class="sxs-lookup"><span data-stu-id="bea5c-203">`DownloadFile` outputs trace information when you enable network tracing in your application.</span></span> <span data-ttu-id="bea5c-204">有关详细信息，请参阅[启用网络跟踪](~/docs/framework/network-programming/enabling-network-tracing.md)。</span><span class="sxs-lookup"><span data-stu-id="bea5c-204">For more information, see [Enabling Network Tracing](~/docs/framework/network-programming/enabling-network-tracing.md).</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="bea5c-205">`DownloadFile`方法不会发送可选 HTTP 标头。</span><span class="sxs-lookup"><span data-stu-id="bea5c-205">The `DownloadFile` method does not send optional HTTP headers.</span></span> <span data-ttu-id="bea5c-206">如果缺少可选的用户代理标头，某些服务器可能会返回 500 （内部服务器错误）。</span><span class="sxs-lookup"><span data-stu-id="bea5c-206">Some servers may return 500 (Internal Server Error) if the optional user agent header is missing.</span></span> <span data-ttu-id="bea5c-207">若要发送可选标头，必须构造请求使用<xref:System.Net.WebClient>类。</span><span class="sxs-lookup"><span data-stu-id="bea5c-207">To send optional headers, you must construct a request using the <xref:System.Net.WebClient> class.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="bea5c-208">FTP 协议发送的信息，包括以纯文本密码，并不应使用用于传输敏感信息。</span><span class="sxs-lookup"><span data-stu-id="bea5c-208">The FTP protocol sends information, including passwords, in plain text and should not be used for transmitting sensitive information.</span></span>  
  
 <span data-ttu-id="bea5c-209">下表列出的任务涉及示例`My.Computer.Network.DownloadFile`方法。</span><span class="sxs-lookup"><span data-stu-id="bea5c-209">The following table lists an example of a task involving the `My.Computer.Network.DownloadFile` method.</span></span>  
  
|<span data-ttu-id="bea5c-210">到</span><span class="sxs-lookup"><span data-stu-id="bea5c-210">To</span></span>|<span data-ttu-id="bea5c-211">查看</span><span class="sxs-lookup"><span data-stu-id="bea5c-211">See</span></span>|  
|-|-|  
|<span data-ttu-id="bea5c-212">下载的文件</span><span class="sxs-lookup"><span data-stu-id="bea5c-212">Download a file</span></span>|[<span data-ttu-id="bea5c-213">如何：下载文件</span><span class="sxs-lookup"><span data-stu-id="bea5c-213">How to: Download a File</span></span>](~/docs/visual-basic/developing-apps/programming/computer-resources/how-to-download-a-file.md)|  
  
   
  
## Examples  
 <span data-ttu-id="bea5c-214">此示例会将文件下载`WineList.txt`从`http://www.cohowinery.com/downloads`并将其保存到`C:\Documents and Settings\All Users\Documents`。</span><span class="sxs-lookup"><span data-stu-id="bea5c-214">This example downloads the file `WineList.txt` from `http://www.cohowinery.com/downloads` and saves it to `C:\Documents and Settings\All Users\Documents`.</span></span>  
  
 [!code-vb[VbVbalrMyNetwork#7](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbalrMyNetwork/VB/Class1.vb#7)]  
  
 <span data-ttu-id="bea5c-215">此示例会将文件下载`WineList.txt`从`http://www.cohowinery.com/downloads`并将其保存到`C:\Documents and Settings\All Users\Documents`，指定超时间隔设置为 500 毫秒。</span><span class="sxs-lookup"><span data-stu-id="bea5c-215">This example downloads the file `WineList.txt` from `http://www.cohowinery.com/downloads` and saves it to `C:\Documents and Settings\All Users\Documents`, specifying a timeout interval of 500 milliseconds.</span></span>  
  
 [!code-vb[VbVbalrMyNetwork#8](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbalrMyNetwork/VB/Class1.vb#8)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentException">
          <span data-ttu-id="bea5c-216">
            <paramref name="destinationFileName" /> 以尾随斜杠结尾。</span>
          <span class="sxs-lookup">
            <span data-stu-id="bea5c-216">
              <paramref name="destinationFileName" /> ends with a trailing slash.</span>
          </span>
        </exception>
        <exception cref="T:System.TimeoutException">
          <span data-ttu-id="bea5c-217">服务器没有在指定的默认超时（100 秒）内响应。</span>
          <span class="sxs-lookup">
            <span data-stu-id="bea5c-217">The server does not respond within the default timeout (100 seconds).</span>
          </span>
        </exception>
        <exception cref="T:System.Security.SecurityException">
          <span data-ttu-id="bea5c-218">用户缺少必要的权限，无法执行网络操作。</span>
          <span class="sxs-lookup">
            <span data-stu-id="bea5c-218">User lacks necessary permissions to perform a network operation.</span>
          </span>
        </exception>
        <exception cref="T:System.Net.WebException">
          <span data-ttu-id="bea5c-219">请求被目标 Web 服务器拒绝。</span>
          <span class="sxs-lookup">
            <span data-stu-id="bea5c-219">The request is denied by the target web server.</span>
          </span>
        </exception>
        <permission cref="T:System.Security.Permissions.FileIOPermission">
          <span data-ttu-id="bea5c-220">控制文件和文件夹的访问权限。</span>
          <span class="sxs-lookup">
            <span data-stu-id="bea5c-220">Controls the ability to access files and folders.</span>
          </span>
          <span data-ttu-id="bea5c-221">关联枚举：<see cref="F:System.Security.Permissions.PermissionState.Unrestricted" />。</span>
          <span class="sxs-lookup">
            <span data-stu-id="bea5c-221">Associated enumeration: <see cref="F:System.Security.Permissions.PermissionState.Unrestricted" />.</span>
          </span>
        </permission>
        <permission cref="T:System.Net.WebPermission">
          <span data-ttu-id="bea5c-222">控制访问 HTTP Internet 资源的权限。</span>
          <span class="sxs-lookup">
            <span data-stu-id="bea5c-222">Controls rights to access HTTP Internet resources.</span>
          </span>
          <span data-ttu-id="bea5c-223">关联枚举：<see cref="F:System.Security.Permissions.PermissionState.Unrestricted" />。</span>
          <span class="sxs-lookup">
            <span data-stu-id="bea5c-223">Associated enumeration: <see cref="F:System.Security.Permissions.PermissionState.Unrestricted" />.</span>
          </span>
        </permission>
        <altmember cref="T:System.Uri" />
        <altmember cref="T:System.Net.ICredentials" />
      </Docs>
    </Member>
    <Member MemberName="DownloadFile">
      <MemberSignature Language="C#" Value="public void DownloadFile (Uri address, string destinationFileName, System.Net.ICredentials networkCredentials, bool showUI, int connectionTimeout, bool overwrite);" />
      <MemberSignature Language="ILAsm" Value=".method public instance void DownloadFile(class System.Uri address, string destinationFileName, class System.Net.ICredentials networkCredentials, bool showUI, int32 connectionTimeout, bool overwrite) cil managed" />
      <MemberSignature Language="DocId" Value="M:Microsoft.VisualBasic.Devices.Network.DownloadFile(System.Uri,System.String,System.Net.ICredentials,System.Boolean,System.Int32,System.Boolean)" />
      <MemberSignature Language="VB.NET" Value="Public Sub DownloadFile (address As Uri, destinationFileName As String, networkCredentials As ICredentials, showUI As Boolean, connectionTimeout As Integer, overwrite As Boolean)" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; void DownloadFile(Uri ^ address, System::String ^ destinationFileName, System::Net::ICredentials ^ networkCredentials, bool showUI, int connectionTimeout, bool overwrite);" />
      <MemberSignature Language="F#" Value="member this.DownloadFile : Uri * string * System.Net.ICredentials * bool * int * bool -&gt; unit" Usage="network.DownloadFile (address, destinationFileName, networkCredentials, showUI, connectionTimeout, overwrite)" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>Microsoft.VisualBasic</AssemblyName>
        <AssemblyVersion>8.0.0.0</AssemblyVersion>
        <AssemblyVersion>10.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Attributes>
        <Attribute FrameworkAlternate="netframework-4.0">
          <AttributeName>System.Runtime.TargetedPatchingOptOut("Performance critical to inline this type of method across NGen image boundaries")</AttributeName>
        </Attribute>
      </Attributes>
      <ReturnValue>
        <ReturnType>System.Void</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="address" Type="System.Uri" />
        <Parameter Name="destinationFileName" Type="System.String" />
        <Parameter Name="networkCredentials" Type="System.Net.ICredentials" />
        <Parameter Name="showUI" Type="System.Boolean" />
        <Parameter Name="connectionTimeout" Type="System.Int32" />
        <Parameter Name="overwrite" Type="System.Boolean" />
      </Parameters>
      <Docs>
        <param name="address">
          <span data-ttu-id="bea5c-224">
            <see langword="String" /> 或 <see cref="T:System.Uri" />。</span>
          <span class="sxs-lookup">
            <span data-stu-id="bea5c-224">
              <see langword="String" /> or <see cref="T:System.Uri" />.</span>
          </span>
          <span data-ttu-id="bea5c-225">要下载的文件的路径，包括文件名和主机地址。</span>
          <span class="sxs-lookup">
            <span data-stu-id="bea5c-225">Path of the file to download, including file name and host address.</span>
          </span>
        </param>
        <param name="destinationFileName">
          <span data-ttu-id="bea5c-226">
            <see langword="String" />。</span>
          <span class="sxs-lookup">
            <span data-stu-id="bea5c-226">
              <see langword="String" />.</span>
          </span>
          <span data-ttu-id="bea5c-227">下载的文件的文件名和路径。</span>
          <span class="sxs-lookup">
            <span data-stu-id="bea5c-227">File name and path of the downloaded file.</span>
          </span>
        </param>
        <param name="networkCredentials">
          <span data-ttu-id="bea5c-228">
            <see cref="T:System.Net.ICredentials" />。</span>
          <span class="sxs-lookup">
            <span data-stu-id="bea5c-228">
              <see cref="T:System.Net.ICredentials" />.</span>
          </span>
          <span data-ttu-id="bea5c-229">要提供的凭据。</span>
          <span class="sxs-lookup">
            <span data-stu-id="bea5c-229">Credentials to be supplied.</span>
          </span>
        </param>
        <param name="showUI">
          <span data-ttu-id="bea5c-230">要显示操作进度，则为 <see langword="True" />；否则为 <see langword="False" />。</span>
          <span class="sxs-lookup">
            <span data-stu-id="bea5c-230">
              <see langword="True" /> to display the progress of the operation; otherwise <see langword="False" />.</span>
          </span>
          <span data-ttu-id="bea5c-231">默认值为 <see langword="False" />。</span>
          <span class="sxs-lookup">
            <span data-stu-id="bea5c-231">Default is <see langword="False" />.</span>
          </span>
        </param>
        <param name="connectionTimeout">
          <span data-ttu-id="bea5c-232">以毫秒为单位的超时间隔。</span>
          <span class="sxs-lookup">
            <span data-stu-id="bea5c-232">Timeout interval, in milliseconds.</span>
          </span>
          <span data-ttu-id="bea5c-233">默认值为 100 秒。</span>
          <span class="sxs-lookup">
            <span data-stu-id="bea5c-233">Default is 100 seconds.</span>
          </span>
        </param>
        <param name="overwrite">
          <span data-ttu-id="bea5c-234">要覆盖现有文件，则为 <see langword="True" />；否则为 <see langword="False" />。</span>
          <span class="sxs-lookup">
            <span data-stu-id="bea5c-234">
              <see langword="True" /> to overwrite existing files; otherwise <see langword="False" />.</span>
          </span>
          <span data-ttu-id="bea5c-235">默认值为 <see langword="False" />。</span>
          <span class="sxs-lookup">
            <span data-stu-id="bea5c-235">Default is <see langword="False" />.</span>
          </span>
        </param>
        <summary>
          <span data-ttu-id="bea5c-236">下载指定的远程文件，并将其保存到指定位置。</span>
          <span class="sxs-lookup">
            <span data-stu-id="bea5c-236">Downloads the specified remote file and saves it in the specified location.</span>
          </span>
        </summary>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="bea5c-237">如果`showUI`设置为`True`，其中显示操作的进度会出现一个对话框; 对话框的包含**取消**可用于取消操作的按钮。</span><span class="sxs-lookup"><span data-stu-id="bea5c-237">If `showUI` is set to `True`, a dialog box appears that shows the progress of the operation; the dialog box contains a **Cancel** button that can be used to cancel the operation.</span></span> <span data-ttu-id="bea5c-238">对话框的不是模式对话框，并因此不会阻止其他 windows 程序中的用户输入。</span><span class="sxs-lookup"><span data-stu-id="bea5c-238">The dialog box is not modal, and therefore does not block user input to other windows in the program.</span></span>  
  
 <span data-ttu-id="bea5c-239">如果服务器没有响应中指定`connectionTimeout`，将取消该操作，并引发异常。</span><span class="sxs-lookup"><span data-stu-id="bea5c-239">If the server does not respond within the specified `connectionTimeout`, the operation is cancelled, and an exception is thrown.</span></span>  
  
 <span data-ttu-id="bea5c-240">`DownloadFile` 在应用程序中启用网络跟踪后，跟踪信息输出。</span><span class="sxs-lookup"><span data-stu-id="bea5c-240">`DownloadFile` outputs trace information when you enable network tracing in your application.</span></span> <span data-ttu-id="bea5c-241">有关详细信息，请参阅[启用网络跟踪](~/docs/framework/network-programming/enabling-network-tracing.md)。</span><span class="sxs-lookup"><span data-stu-id="bea5c-241">For more information, see [Enabling Network Tracing](~/docs/framework/network-programming/enabling-network-tracing.md).</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="bea5c-242">`DownloadFile`方法不会发送可选 HTTP 标头。</span><span class="sxs-lookup"><span data-stu-id="bea5c-242">The `DownloadFile` method does not send optional HTTP headers.</span></span> <span data-ttu-id="bea5c-243">如果缺少可选的用户代理标头，某些服务器可能会返回 500 （内部服务器错误）。</span><span class="sxs-lookup"><span data-stu-id="bea5c-243">Some servers may return 500 (Internal Server Error) if the optional user agent header is missing.</span></span> <span data-ttu-id="bea5c-244">若要发送可选标头，必须构造请求使用<xref:System.Net.WebClient>类。</span><span class="sxs-lookup"><span data-stu-id="bea5c-244">To send optional headers, you must construct a request using the <xref:System.Net.WebClient> class.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="bea5c-245">FTP 协议发送的信息，包括以纯文本密码，并不应使用用于传输敏感信息。</span><span class="sxs-lookup"><span data-stu-id="bea5c-245">The FTP protocol sends information, including passwords, in plain text and should not be used for transmitting sensitive information.</span></span>  
  
 <span data-ttu-id="bea5c-246">下表列出的任务涉及示例`My.Computer.Network.DownloadFile`方法。</span><span class="sxs-lookup"><span data-stu-id="bea5c-246">The following table lists an example of a task involving the `My.Computer.Network.DownloadFile` method.</span></span>  
  
|<span data-ttu-id="bea5c-247">到</span><span class="sxs-lookup"><span data-stu-id="bea5c-247">To</span></span>|<span data-ttu-id="bea5c-248">查看</span><span class="sxs-lookup"><span data-stu-id="bea5c-248">See</span></span>|  
|-|-|  
|<span data-ttu-id="bea5c-249">下载的文件</span><span class="sxs-lookup"><span data-stu-id="bea5c-249">Download a file</span></span>|[<span data-ttu-id="bea5c-250">如何：下载文件</span><span class="sxs-lookup"><span data-stu-id="bea5c-250">How to: Download a File</span></span>](~/docs/visual-basic/developing-apps/programming/computer-resources/how-to-download-a-file.md)|  
  
   
  
## Examples  
 <span data-ttu-id="bea5c-251">此示例会将文件下载`WineList.txt`从`http://www.cohowinery.com/downloads`并将其保存到`C:\Documents and Settings\All Users\Documents`。</span><span class="sxs-lookup"><span data-stu-id="bea5c-251">This example downloads the file `WineList.txt` from `http://www.cohowinery.com/downloads` and saves it to `C:\Documents and Settings\All Users\Documents`.</span></span>  
  
 [!code-vb[VbVbalrMyNetwork#7](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbalrMyNetwork/VB/Class1.vb#7)]  
  
 <span data-ttu-id="bea5c-252">此示例会将文件下载`WineList.txt`从`http://www.cohowinery.com/downloads`并将其保存到`C:\Documents and Settings\All Users\Documents`，指定超时间隔设置为 500 毫秒。</span><span class="sxs-lookup"><span data-stu-id="bea5c-252">This example downloads the file `WineList.txt` from `http://www.cohowinery.com/downloads` and saves it to `C:\Documents and Settings\All Users\Documents`, specifying a timeout interval of 500 milliseconds.</span></span>  
  
 [!code-vb[VbVbalrMyNetwork#8](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbalrMyNetwork/VB/Class1.vb#8)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentException">
          <span data-ttu-id="bea5c-253">
            <paramref name="destinationFileName" /> 以尾随斜杠结尾。</span>
          <span class="sxs-lookup">
            <span data-stu-id="bea5c-253">
              <paramref name="destinationFileName" /> ends with a trailing slash.</span>
          </span>
        </exception>
        <exception cref="T:System.IO.IOException">
          <span data-ttu-id="bea5c-254">将 <paramref name="overwrite" /> 设置为 <see langword="False" />，而目标文件已存在。</span>
          <span class="sxs-lookup">
            <span data-stu-id="bea5c-254">
              <paramref name="overwrite" /> is set to <see langword="False" /> and the destination file already exists.</span>
          </span>
        </exception>
        <exception cref="T:System.TimeoutException">
          <span data-ttu-id="bea5c-255">服务器没有在指定的 <paramref name="connectionTimeout" /> 内响应。</span>
          <span class="sxs-lookup">
            <span data-stu-id="bea5c-255">The server does not respond within the specified <paramref name="connectionTimeout" />.</span>
          </span>
        </exception>
        <exception cref="T:System.Security.SecurityException">
          <span data-ttu-id="bea5c-256">用户缺少必要的权限，无法执行网络操作。</span>
          <span class="sxs-lookup">
            <span data-stu-id="bea5c-256">User lacks necessary permissions to perform a network operation.</span>
          </span>
        </exception>
        <exception cref="T:System.Net.WebException">
          <span data-ttu-id="bea5c-257">请求被目标 Web 服务器拒绝。</span>
          <span class="sxs-lookup">
            <span data-stu-id="bea5c-257">The request is denied by the target web server.</span>
          </span>
        </exception>
        <permission cref="T:System.Security.Permissions.FileIOPermission">
          <span data-ttu-id="bea5c-258">控制文件和文件夹的访问权限。</span>
          <span class="sxs-lookup">
            <span data-stu-id="bea5c-258">Controls the ability to access files and folders.</span>
          </span>
          <span data-ttu-id="bea5c-259">关联枚举：<see cref="F:System.Security.Permissions.PermissionState.Unrestricted" />。</span>
          <span class="sxs-lookup">
            <span data-stu-id="bea5c-259">Associated enumeration: <see cref="F:System.Security.Permissions.PermissionState.Unrestricted" />.</span>
          </span>
        </permission>
        <permission cref="T:System.Security.Permissions.UIPermission">
          <span data-ttu-id="bea5c-260">控制与用户界面和剪贴板相关的权限。</span>
          <span class="sxs-lookup">
            <span data-stu-id="bea5c-260">Controls the permissions related to user interfaces and the clipboard.</span>
          </span>
          <span data-ttu-id="bea5c-261">关联枚举：<see cref="F:System.Security.Permissions.UIPermissionWindow.AllWindows" />。</span>
          <span class="sxs-lookup">
            <span data-stu-id="bea5c-261">Associated enumeration: <see cref="F:System.Security.Permissions.UIPermissionWindow.AllWindows" />.</span>
          </span>
        </permission>
        <permission cref="T:System.Net.WebPermission">
          <span data-ttu-id="bea5c-262">控制访问 HTTP Internet 资源的权限。</span>
          <span class="sxs-lookup">
            <span data-stu-id="bea5c-262">Controls rights to access HTTP Internet resources.</span>
          </span>
          <span data-ttu-id="bea5c-263">关联枚举：<see cref="F:System.Security.Permissions.PermissionState.Unrestricted" />。</span>
          <span class="sxs-lookup">
            <span data-stu-id="bea5c-263">Associated enumeration: <see cref="F:System.Security.Permissions.PermissionState.Unrestricted" />.</span>
          </span>
        </permission>
        <altmember cref="T:System.Uri" />
        <altmember cref="T:System.Net.ICredentials" />
      </Docs>
    </Member>
    <Member MemberName="DownloadFile">
      <MemberSignature Language="C#" Value="public void DownloadFile (string address, string destinationFileName, string userName, string password, bool showUI, int connectionTimeout, bool overwrite);" />
      <MemberSignature Language="ILAsm" Value=".method public instance void DownloadFile(string address, string destinationFileName, string userName, string password, bool showUI, int32 connectionTimeout, bool overwrite) cil managed" />
      <MemberSignature Language="DocId" Value="M:Microsoft.VisualBasic.Devices.Network.DownloadFile(System.String,System.String,System.String,System.String,System.Boolean,System.Int32,System.Boolean)" />
      <MemberSignature Language="VB.NET" Value="Public Sub DownloadFile (address As String, destinationFileName As String, userName As String, password As String, showUI As Boolean, connectionTimeout As Integer, overwrite As Boolean)" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; void DownloadFile(System::String ^ address, System::String ^ destinationFileName, System::String ^ userName, System::String ^ password, bool showUI, int connectionTimeout, bool overwrite);" />
      <MemberSignature Language="F#" Value="member this.DownloadFile : string * string * string * string * bool * int * bool -&gt; unit" Usage="network.DownloadFile (address, destinationFileName, userName, password, showUI, connectionTimeout, overwrite)" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>Microsoft.VisualBasic</AssemblyName>
        <AssemblyVersion>8.0.0.0</AssemblyVersion>
        <AssemblyVersion>10.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Attributes>
        <Attribute FrameworkAlternate="netframework-4.0">
          <AttributeName>System.Runtime.TargetedPatchingOptOut("Performance critical to inline this type of method across NGen image boundaries")</AttributeName>
        </Attribute>
      </Attributes>
      <ReturnValue>
        <ReturnType>System.Void</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="address" Type="System.String" />
        <Parameter Name="destinationFileName" Type="System.String" />
        <Parameter Name="userName" Type="System.String" />
        <Parameter Name="password" Type="System.String" />
        <Parameter Name="showUI" Type="System.Boolean" />
        <Parameter Name="connectionTimeout" Type="System.Int32" />
        <Parameter Name="overwrite" Type="System.Boolean" />
      </Parameters>
      <Docs>
        <param name="address">
          <span data-ttu-id="bea5c-264">要下载的文件的路径，包括文件名和主机地址。</span>
          <span class="sxs-lookup">
            <span data-stu-id="bea5c-264">Path of the file to download, including file name and host address.</span>
          </span>
        </param>
        <param name="destinationFileName">
          <span data-ttu-id="bea5c-265">下载的文件的文件名和路径。</span>
          <span class="sxs-lookup">
            <span data-stu-id="bea5c-265">File name and path of the downloaded file.</span>
          </span>
        </param>
        <param name="userName">
          <span data-ttu-id="bea5c-266">要进行身份验证的用户名。</span>
          <span class="sxs-lookup">
            <span data-stu-id="bea5c-266">User name to authenticate.</span>
          </span>
          <span data-ttu-id="bea5c-267">默认值为空字符串 ""。</span>
          <span class="sxs-lookup">
            <span data-stu-id="bea5c-267">Default is an empty string, "".</span>
          </span>
        </param>
        <param name="password">
          <span data-ttu-id="bea5c-268">要验证的密码。</span>
          <span class="sxs-lookup">
            <span data-stu-id="bea5c-268">Password to authenticate.</span>
          </span>
          <span data-ttu-id="bea5c-269">默认值为空字符串 ""。</span>
          <span class="sxs-lookup">
            <span data-stu-id="bea5c-269">Default is an empty string, "".</span>
          </span>
        </param>
        <param name="showUI">
          <span data-ttu-id="bea5c-270">要显示操作进度，则为 <see langword="True" />；否则为 <see langword="False" />。</span>
          <span class="sxs-lookup">
            <span data-stu-id="bea5c-270">
              <see langword="True" /> to display the progress of the operation; otherwise <see langword="False" />.</span>
          </span>
          <span data-ttu-id="bea5c-271">默认值为 <see langword="False" />。</span>
          <span class="sxs-lookup">
            <span data-stu-id="bea5c-271">Default is <see langword="False" />.</span>
          </span>
        </param>
        <param name="connectionTimeout">
          <span data-ttu-id="bea5c-272">
            <see cref="T:System.Int32" />。</span>
          <span class="sxs-lookup">
            <span data-stu-id="bea5c-272">
              <see cref="T:System.Int32" />.</span>
          </span>
          <span data-ttu-id="bea5c-273">以毫秒为单位的超时间隔。</span>
          <span class="sxs-lookup">
            <span data-stu-id="bea5c-273">Timeout interval, in milliseconds.</span>
          </span>
          <span data-ttu-id="bea5c-274">默认值为 100 秒。</span>
          <span class="sxs-lookup">
            <span data-stu-id="bea5c-274">Default is 100 seconds.</span>
          </span>
        </param>
        <param name="overwrite">
          <span data-ttu-id="bea5c-275">要覆盖现有文件，则为 <see langword="True" />；否则为 <see langword="False" />。</span>
          <span class="sxs-lookup">
            <span data-stu-id="bea5c-275">
              <see langword="True" /> to overwrite existing files; otherwise <see langword="False" />.</span>
          </span>
          <span data-ttu-id="bea5c-276">默认值为 <see langword="False" />。</span>
          <span class="sxs-lookup">
            <span data-stu-id="bea5c-276">Default is <see langword="False" />.</span>
          </span>
        </param>
        <summary>
          <span data-ttu-id="bea5c-277">下载指定的远程文件，并将其保存到指定位置。</span>
          <span class="sxs-lookup">
            <span data-stu-id="bea5c-277">Downloads the specified remote file and saves it in the specified location.</span>
          </span>
        </summary>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="bea5c-278">如果`showUI`设置为`True`，其中显示操作的进度会出现一个对话框; 对话框的包含**取消**可用于取消操作的按钮。</span><span class="sxs-lookup"><span data-stu-id="bea5c-278">If `showUI` is set to `True`, a dialog box appears that shows the progress of the operation; the dialog box contains a **Cancel** button that can be used to cancel the operation.</span></span> <span data-ttu-id="bea5c-279">对话框的不是模式对话框，并因此不会阻止其他 windows 程序中的用户输入。</span><span class="sxs-lookup"><span data-stu-id="bea5c-279">The dialog box is not modal, and therefore does not block user input to other windows in the program.</span></span>  
  
 <span data-ttu-id="bea5c-280">如果服务器没有响应中指定`connectionTimeout`，将取消该操作，并引发异常。</span><span class="sxs-lookup"><span data-stu-id="bea5c-280">If the server does not respond within the specified `connectionTimeout`, the operation is cancelled, and an exception is thrown.</span></span>  
  
 <span data-ttu-id="bea5c-281">`DownloadFile` 在应用程序中启用网络跟踪后，跟踪信息输出。</span><span class="sxs-lookup"><span data-stu-id="bea5c-281">`DownloadFile` outputs trace information when you enable network tracing in your application.</span></span> <span data-ttu-id="bea5c-282">有关详细信息，请参阅[启用网络跟踪](~/docs/framework/network-programming/enabling-network-tracing.md)。</span><span class="sxs-lookup"><span data-stu-id="bea5c-282">For more information, see [Enabling Network Tracing](~/docs/framework/network-programming/enabling-network-tracing.md).</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="bea5c-283">`DownloadFile`方法不会发送可选 HTTP 标头。</span><span class="sxs-lookup"><span data-stu-id="bea5c-283">The `DownloadFile` method does not send optional HTTP headers.</span></span> <span data-ttu-id="bea5c-284">如果缺少可选的用户代理标头，某些服务器可能会返回 500 （内部服务器错误）。</span><span class="sxs-lookup"><span data-stu-id="bea5c-284">Some servers may return 500 (Internal Server Error) if the optional user agent header is missing.</span></span> <span data-ttu-id="bea5c-285">若要发送可选标头，必须构造请求使用<xref:System.Net.WebClient>类。</span><span class="sxs-lookup"><span data-stu-id="bea5c-285">To send optional headers, you must construct a request using the <xref:System.Net.WebClient> class.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="bea5c-286">FTP 协议发送的信息，包括以纯文本密码，并不应使用用于传输敏感信息。</span><span class="sxs-lookup"><span data-stu-id="bea5c-286">The FTP protocol sends information, including passwords, in plain text and should not be used for transmitting sensitive information.</span></span>  
  
 <span data-ttu-id="bea5c-287">下表列出的任务涉及示例`My.Computer.Network.DownloadFile`方法。</span><span class="sxs-lookup"><span data-stu-id="bea5c-287">The following table lists an example of a task involving the `My.Computer.Network.DownloadFile` method.</span></span>  
  
|<span data-ttu-id="bea5c-288">到</span><span class="sxs-lookup"><span data-stu-id="bea5c-288">To</span></span>|<span data-ttu-id="bea5c-289">查看</span><span class="sxs-lookup"><span data-stu-id="bea5c-289">See</span></span>|  
|-|-|  
|<span data-ttu-id="bea5c-290">下载的文件</span><span class="sxs-lookup"><span data-stu-id="bea5c-290">Download a file</span></span>|[<span data-ttu-id="bea5c-291">如何：下载文件</span><span class="sxs-lookup"><span data-stu-id="bea5c-291">How to: Download a File</span></span>](~/docs/visual-basic/developing-apps/programming/computer-resources/how-to-download-a-file.md)|  
  
   
  
## Examples  
 <span data-ttu-id="bea5c-292">此示例会将文件下载`WineList.txt`从`http://www.cohowinery.com/downloads`并将其保存到`C:\Documents and Settings\All Users\Documents`。</span><span class="sxs-lookup"><span data-stu-id="bea5c-292">This example downloads the file `WineList.txt` from `http://www.cohowinery.com/downloads` and saves it to `C:\Documents and Settings\All Users\Documents`.</span></span>  
  
 [!code-vb[VbVbalrMyNetwork#7](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbalrMyNetwork/VB/Class1.vb#7)]  
  
 <span data-ttu-id="bea5c-293">此示例会将文件下载`WineList.txt`从`http://www.cohowinery.com/downloads`并将其保存到`C:\Documents and Settings\All Users\Documents`，指定超时间隔设置为 500 毫秒。</span><span class="sxs-lookup"><span data-stu-id="bea5c-293">This example downloads the file `WineList.txt` from `http://www.cohowinery.com/downloads` and saves it to `C:\Documents and Settings\All Users\Documents`, specifying a timeout interval of 500 milliseconds.</span></span>  
  
 [!code-vb[VbVbalrMyNetwork#8](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbalrMyNetwork/VB/Class1.vb#8)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentException">
          <span data-ttu-id="bea5c-294">
            <paramref name="destinationFileName" /> 以尾随斜杠结尾。</span>
          <span class="sxs-lookup">
            <span data-stu-id="bea5c-294">
              <paramref name="destinationFileName" /> ends with a trailing slash.</span>
          </span>
        </exception>
        <exception cref="T:System.IO.IOException">
          <span data-ttu-id="bea5c-295">将 <paramref name="overwrite" /> 设置为 <see langword="False" />，而目标文件已存在。</span>
          <span class="sxs-lookup">
            <span data-stu-id="bea5c-295">
              <paramref name="overwrite" /> is set to <see langword="False" /> and the destination file already exists.</span>
          </span>
        </exception>
        <exception cref="T:System.TimeoutException">
          <span data-ttu-id="bea5c-296">服务器没有在指定的 <paramref name="connectionTimeout" /> 内响应。</span>
          <span class="sxs-lookup">
            <span data-stu-id="bea5c-296">The server does not respond within the specified <paramref name="connectionTimeout" />.</span>
          </span>
        </exception>
        <exception cref="T:System.Security.SecurityException">
          <span data-ttu-id="bea5c-297">用户缺少必要的权限，无法执行网络操作。</span>
          <span class="sxs-lookup">
            <span data-stu-id="bea5c-297">User lacks necessary permissions to perform a network operation.</span>
          </span>
        </exception>
        <exception cref="T:System.Net.WebException">
          <span data-ttu-id="bea5c-298">请求被目标 Web 服务器拒绝。</span>
          <span class="sxs-lookup">
            <span data-stu-id="bea5c-298">The request is denied by the target web server.</span>
          </span>
        </exception>
        <permission cref="T:System.Security.Permissions.FileIOPermission">
          <span data-ttu-id="bea5c-299">控制文件和文件夹的访问权限。</span>
          <span class="sxs-lookup">
            <span data-stu-id="bea5c-299">Controls the ability to access files and folders.</span>
          </span>
          <span data-ttu-id="bea5c-300">关联枚举：<see cref="F:System.Security.Permissions.PermissionState.Unrestricted" />。</span>
          <span class="sxs-lookup">
            <span data-stu-id="bea5c-300">Associated enumeration: <see cref="F:System.Security.Permissions.PermissionState.Unrestricted" />.</span>
          </span>
        </permission>
        <permission cref="T:System.Security.Permissions.UIPermission">
          <span data-ttu-id="bea5c-301">控制与用户界面和剪贴板相关的权限。</span>
          <span class="sxs-lookup">
            <span data-stu-id="bea5c-301">Controls the permissions related to user interfaces and the clipboard.</span>
          </span>
          <span data-ttu-id="bea5c-302">关联枚举：<see cref="F:System.Security.Permissions.UIPermissionWindow.AllWindows" />。</span>
          <span class="sxs-lookup">
            <span data-stu-id="bea5c-302">Associated enumeration: <see cref="F:System.Security.Permissions.UIPermissionWindow.AllWindows" />.</span>
          </span>
        </permission>
        <permission cref="T:System.Net.WebPermission">
          <span data-ttu-id="bea5c-303">控制访问 HTTP Internet 资源的权限。</span>
          <span class="sxs-lookup">
            <span data-stu-id="bea5c-303">Controls rights to access HTTP Internet resources.</span>
          </span>
          <span data-ttu-id="bea5c-304">关联枚举：<see cref="F:System.Security.Permissions.PermissionState.Unrestricted" />。</span>
          <span class="sxs-lookup">
            <span data-stu-id="bea5c-304">Associated enumeration: <see cref="F:System.Security.Permissions.PermissionState.Unrestricted" />.</span>
          </span>
        </permission>
        <altmember cref="T:System.Uri" />
        <altmember cref="T:System.Net.ICredentials" />
      </Docs>
    </Member>
    <Member MemberName="DownloadFile">
      <MemberSignature Language="C#" Value="public void DownloadFile (Uri address, string destinationFileName, System.Net.ICredentials networkCredentials, bool showUI, int connectionTimeout, bool overwrite, Microsoft.VisualBasic.FileIO.UICancelOption onUserCancel);" />
      <MemberSignature Language="ILAsm" Value=".method public instance void DownloadFile(class System.Uri address, string destinationFileName, class System.Net.ICredentials networkCredentials, bool showUI, int32 connectionTimeout, bool overwrite, valuetype Microsoft.VisualBasic.FileIO.UICancelOption onUserCancel) cil managed" />
      <MemberSignature Language="DocId" Value="M:Microsoft.VisualBasic.Devices.Network.DownloadFile(System.Uri,System.String,System.Net.ICredentials,System.Boolean,System.Int32,System.Boolean,Microsoft.VisualBasic.FileIO.UICancelOption)" />
      <MemberSignature Language="VB.NET" Value="Public Sub DownloadFile (address As Uri, destinationFileName As String, networkCredentials As ICredentials, showUI As Boolean, connectionTimeout As Integer, overwrite As Boolean, onUserCancel As UICancelOption)" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; void DownloadFile(Uri ^ address, System::String ^ destinationFileName, System::Net::ICredentials ^ networkCredentials, bool showUI, int connectionTimeout, bool overwrite, Microsoft::VisualBasic::FileIO::UICancelOption onUserCancel);" />
      <MemberSignature Language="F#" Value="member this.DownloadFile : Uri * string * System.Net.ICredentials * bool * int * bool * Microsoft.VisualBasic.FileIO.UICancelOption -&gt; unit" Usage="network.DownloadFile (address, destinationFileName, networkCredentials, showUI, connectionTimeout, overwrite, onUserCancel)" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>Microsoft.VisualBasic</AssemblyName>
        <AssemblyVersion>8.0.0.0</AssemblyVersion>
        <AssemblyVersion>10.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Attributes>
        <Attribute FrameworkAlternate="netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2">
          <AttributeName>System.Security.SecuritySafeCritical</AttributeName>
        </Attribute>
      </Attributes>
      <ReturnValue>
        <ReturnType>System.Void</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="address" Type="System.Uri" />
        <Parameter Name="destinationFileName" Type="System.String" />
        <Parameter Name="networkCredentials" Type="System.Net.ICredentials" />
        <Parameter Name="showUI" Type="System.Boolean" />
        <Parameter Name="connectionTimeout" Type="System.Int32" />
        <Parameter Name="overwrite" Type="System.Boolean" />
        <Parameter Name="onUserCancel" Type="Microsoft.VisualBasic.FileIO.UICancelOption" />
      </Parameters>
      <Docs>
        <param name="address">
          <span data-ttu-id="bea5c-305">要下载的文件的路径，包括文件名和主机地址。</span>
          <span class="sxs-lookup">
            <span data-stu-id="bea5c-305">Path of the file to download, including file name and host address.</span>
          </span>
        </param>
        <param name="destinationFileName">
          <span data-ttu-id="bea5c-306">下载的文件的文件名和路径。</span>
          <span class="sxs-lookup">
            <span data-stu-id="bea5c-306">File name and path of the downloaded file.</span>
          </span>
        </param>
        <param name="networkCredentials">
          <span data-ttu-id="bea5c-307">要提供的凭据。</span>
          <span class="sxs-lookup">
            <span data-stu-id="bea5c-307">Credentials to be supplied.</span>
          </span>
        </param>
        <param name="showUI">
          <span data-ttu-id="bea5c-308">要显示操作进度，则为 <see langword="True" />；否则为 <see langword="False" />。</span>
          <span class="sxs-lookup">
            <span data-stu-id="bea5c-308">
              <see langword="True" /> to display the progress of the operation; otherwise <see langword="False" />.</span>
          </span>
          <span data-ttu-id="bea5c-309">默认值为 <see langword="False" />。</span>
          <span class="sxs-lookup">
            <span data-stu-id="bea5c-309">Default is <see langword="False" />.</span>
          </span>
        </param>
        <param name="connectionTimeout">
          <span data-ttu-id="bea5c-310">以毫秒为单位的超时间隔。</span>
          <span class="sxs-lookup">
            <span data-stu-id="bea5c-310">Timeout interval, in milliseconds.</span>
          </span>
          <span data-ttu-id="bea5c-311">默认值为 100 秒。</span>
          <span class="sxs-lookup">
            <span data-stu-id="bea5c-311">Default is 100 seconds.</span>
          </span>
        </param>
        <param name="overwrite">
          <span data-ttu-id="bea5c-312">要覆盖现有文件，则为 <see langword="True" />；否则为 <see langword="False" />。</span>
          <span class="sxs-lookup">
            <span data-stu-id="bea5c-312">
              <see langword="True" /> to overwrite existing files; otherwise <see langword="False" />.</span>
          </span>
          <span data-ttu-id="bea5c-313">默认值为 <see langword="False" />。</span>
          <span class="sxs-lookup">
            <span data-stu-id="bea5c-313">Default is <see langword="False" />.</span>
          </span>
        </param>
        <param name="onUserCancel">
          <span data-ttu-id="bea5c-314">指定当用户在对话框（在 <c>showUI</c> 设置为 <see langword="True" /> 时将显示此对话框）上单击“取消”或“否”时的行为。</span>
          <span class="sxs-lookup">
            <span data-stu-id="bea5c-314">Specifies behavior when the user clicks **Cancel** or **No** on the dialog box shown as a result of <c>showUI</c> set to <see langword="True" />.</span>
          </span>
          <span data-ttu-id="bea5c-315">默认值为 <see cref="F:Microsoft.VisualBasic.FileIO.UICancelOption.ThrowException" />。</span>
          <span class="sxs-lookup">
            <span data-stu-id="bea5c-315">Default is <see cref="F:Microsoft.VisualBasic.FileIO.UICancelOption.ThrowException" />.</span>
          </span>
        </param>
        <summary>
          <span data-ttu-id="bea5c-316">下载指定的远程文件，并将其保存到指定位置。</span>
          <span class="sxs-lookup">
            <span data-stu-id="bea5c-316">Downloads the specified remote file and saves it in the specified location.</span>
          </span>
        </summary>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="bea5c-317">如果`showUI`设置为`True`，其中显示操作的进度会出现一个对话框; 对话框的包含**取消**可用于取消操作的按钮。</span><span class="sxs-lookup"><span data-stu-id="bea5c-317">If `showUI` is set to `True`, a dialog box appears that shows the progress of the operation; the dialog box contains a **Cancel** button that can be used to cancel the operation.</span></span> <span data-ttu-id="bea5c-318">对话框的不是模式对话框，并因此不会阻止其他 windows 程序中的用户输入。</span><span class="sxs-lookup"><span data-stu-id="bea5c-318">The dialog box is not modal, and therefore does not block user input to other windows in the program.</span></span>  
  
 <span data-ttu-id="bea5c-319">如果服务器没有响应中指定`connectionTimeout`，将取消该操作，并引发异常。</span><span class="sxs-lookup"><span data-stu-id="bea5c-319">If the server does not respond within the specified `connectionTimeout`, the operation is cancelled, and an exception is thrown.</span></span>  
  
 <span data-ttu-id="bea5c-320">`DownloadFile` 在应用程序中启用网络跟踪后，跟踪信息输出。</span><span class="sxs-lookup"><span data-stu-id="bea5c-320">`DownloadFile` outputs trace information when you enable network tracing in your application.</span></span> <span data-ttu-id="bea5c-321">有关详细信息，请参阅[启用网络跟踪](~/docs/framework/network-programming/enabling-network-tracing.md)。</span><span class="sxs-lookup"><span data-stu-id="bea5c-321">For more information, see [Enabling Network Tracing](~/docs/framework/network-programming/enabling-network-tracing.md).</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="bea5c-322">`DownloadFile`方法不会发送可选 HTTP 标头。</span><span class="sxs-lookup"><span data-stu-id="bea5c-322">The `DownloadFile` method does not send optional HTTP headers.</span></span> <span data-ttu-id="bea5c-323">如果缺少可选的用户代理标头，某些服务器可能会返回 500 （内部服务器错误）。</span><span class="sxs-lookup"><span data-stu-id="bea5c-323">Some servers may return 500 (Internal Server Error) if the optional user agent header is missing.</span></span> <span data-ttu-id="bea5c-324">若要发送可选标头，必须构造请求使用<xref:System.Net.WebClient>类。</span><span class="sxs-lookup"><span data-stu-id="bea5c-324">To send optional headers, you must construct a request using the <xref:System.Net.WebClient> class.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="bea5c-325">FTP 协议发送的信息，包括以纯文本密码，并不应使用用于传输敏感信息。</span><span class="sxs-lookup"><span data-stu-id="bea5c-325">The FTP protocol sends information, including passwords, in plain text and should not be used for transmitting sensitive information.</span></span>  
  
 <span data-ttu-id="bea5c-326">下表列出的任务涉及示例`My.Computer.Network.DownloadFile`方法。</span><span class="sxs-lookup"><span data-stu-id="bea5c-326">The following table lists an example of a task involving the `My.Computer.Network.DownloadFile` method.</span></span>  
  
|<span data-ttu-id="bea5c-327">到</span><span class="sxs-lookup"><span data-stu-id="bea5c-327">To</span></span>|<span data-ttu-id="bea5c-328">查看</span><span class="sxs-lookup"><span data-stu-id="bea5c-328">See</span></span>|  
|-|-|  
|<span data-ttu-id="bea5c-329">下载的文件</span><span class="sxs-lookup"><span data-stu-id="bea5c-329">Download a file</span></span>|[<span data-ttu-id="bea5c-330">如何：下载文件</span><span class="sxs-lookup"><span data-stu-id="bea5c-330">How to: Download a File</span></span>](~/docs/visual-basic/developing-apps/programming/computer-resources/how-to-download-a-file.md)|  
  
   
  
## Examples  
 <span data-ttu-id="bea5c-331">此示例会将文件下载`WineList.txt`从`http://www.cohowinery.com/downloads`并将其保存到`C:\Documents and Settings\All Users\Documents`。</span><span class="sxs-lookup"><span data-stu-id="bea5c-331">This example downloads the file `WineList.txt` from `http://www.cohowinery.com/downloads` and saves it to `C:\Documents and Settings\All Users\Documents`.</span></span>  
  
 [!code-vb[VbVbalrMyNetwork#7](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbalrMyNetwork/VB/Class1.vb#7)]  
  
 <span data-ttu-id="bea5c-332">此示例会将文件下载`WineList.txt`从`http://www.cohowinery.com/downloads`并将其保存到`C:\Documents and Settings\All Users\Documents`，指定超时间隔设置为 500 毫秒。</span><span class="sxs-lookup"><span data-stu-id="bea5c-332">This example downloads the file `WineList.txt` from `http://www.cohowinery.com/downloads` and saves it to `C:\Documents and Settings\All Users\Documents`, specifying a timeout interval of 500 milliseconds.</span></span>  
  
 [!code-vb[VbVbalrMyNetwork#8](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbalrMyNetwork/VB/Class1.vb#8)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentException">
          <span data-ttu-id="bea5c-333">
            <paramref name="destinationFileName" /> 以尾随斜杠结尾。</span>
          <span class="sxs-lookup">
            <span data-stu-id="bea5c-333">
              <paramref name="destinationFileName" /> ends with a trailing slash.</span>
          </span>
        </exception>
        <exception cref="T:System.IO.IOException">
          <span data-ttu-id="bea5c-334">将 <paramref name="overwrite" /> 设置为 <see langword="False" />，而目标文件已存在。</span>
          <span class="sxs-lookup">
            <span data-stu-id="bea5c-334">
              <paramref name="overwrite" /> is set to <see langword="False" /> and the destination file already exists.</span>
          </span>
        </exception>
        <exception cref="T:System.TimeoutException">
          <span data-ttu-id="bea5c-335">服务器没有在指定的 <paramref name="connectionTimeout" /> 内响应。</span>
          <span class="sxs-lookup">
            <span data-stu-id="bea5c-335">The server does not respond within the specified <paramref name="connectionTimeout" />.</span>
          </span>
        </exception>
        <exception cref="T:System.Security.SecurityException">
          <span data-ttu-id="bea5c-336">用户缺少必要的权限，无法执行网络操作。</span>
          <span class="sxs-lookup">
            <span data-stu-id="bea5c-336">User lacks necessary permissions to perform a network operation.</span>
          </span>
        </exception>
        <exception cref="T:System.Net.WebException">
          <span data-ttu-id="bea5c-337">请求被目标 Web 服务器拒绝。</span>
          <span class="sxs-lookup">
            <span data-stu-id="bea5c-337">The request is denied by the target web server.</span>
          </span>
        </exception>
        <permission cref="T:System.Security.Permissions.FileIOPermission">
          <span data-ttu-id="bea5c-338">控制文件和文件夹的访问权限。</span>
          <span class="sxs-lookup">
            <span data-stu-id="bea5c-338">Controls the ability to access files and folders.</span>
          </span>
          <span data-ttu-id="bea5c-339">关联枚举：<see cref="F:System.Security.Permissions.PermissionState.Unrestricted" />。</span>
          <span class="sxs-lookup">
            <span data-stu-id="bea5c-339">Associated enumeration: <see cref="F:System.Security.Permissions.PermissionState.Unrestricted" />.</span>
          </span>
        </permission>
        <permission cref="T:System.Security.Permissions.UIPermission">
          <span data-ttu-id="bea5c-340">控制与用户界面和剪贴板相关的权限。</span>
          <span class="sxs-lookup">
            <span data-stu-id="bea5c-340">Controls the permissions related to user interfaces and the clipboard.</span>
          </span>
          <span data-ttu-id="bea5c-341">关联枚举：<see cref="F:System.Security.Permissions.UIPermissionWindow.AllWindows" />。</span>
          <span class="sxs-lookup">
            <span data-stu-id="bea5c-341">Associated enumeration: <see cref="F:System.Security.Permissions.UIPermissionWindow.AllWindows" />.</span>
          </span>
        </permission>
        <permission cref="T:System.Net.WebPermission">
          <span data-ttu-id="bea5c-342">控制访问 HTTP Internet 资源的权限。</span>
          <span class="sxs-lookup">
            <span data-stu-id="bea5c-342">Controls rights to access HTTP Internet resources.</span>
          </span>
          <span data-ttu-id="bea5c-343">关联枚举：<see cref="F:System.Security.Permissions.PermissionState.Unrestricted" />。</span>
          <span class="sxs-lookup">
            <span data-stu-id="bea5c-343">Associated enumeration: <see cref="F:System.Security.Permissions.PermissionState.Unrestricted" />.</span>
          </span>
        </permission>
        <altmember cref="T:System.Uri" />
        <altmember cref="T:System.Net.ICredentials" />
      </Docs>
    </Member>
    <Member MemberName="DownloadFile">
      <MemberSignature Language="C#" Value="public void DownloadFile (Uri address, string destinationFileName, string userName, string password, bool showUI, int connectionTimeout, bool overwrite);" />
      <MemberSignature Language="ILAsm" Value=".method public instance void DownloadFile(class System.Uri address, string destinationFileName, string userName, string password, bool showUI, int32 connectionTimeout, bool overwrite) cil managed" />
      <MemberSignature Language="DocId" Value="M:Microsoft.VisualBasic.Devices.Network.DownloadFile(System.Uri,System.String,System.String,System.String,System.Boolean,System.Int32,System.Boolean)" />
      <MemberSignature Language="VB.NET" Value="Public Sub DownloadFile (address As Uri, destinationFileName As String, userName As String, password As String, showUI As Boolean, connectionTimeout As Integer, overwrite As Boolean)" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; void DownloadFile(Uri ^ address, System::String ^ destinationFileName, System::String ^ userName, System::String ^ password, bool showUI, int connectionTimeout, bool overwrite);" />
      <MemberSignature Language="F#" Value="member this.DownloadFile : Uri * string * string * string * bool * int * bool -&gt; unit" Usage="network.DownloadFile (address, destinationFileName, userName, password, showUI, connectionTimeout, overwrite)" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>Microsoft.VisualBasic</AssemblyName>
        <AssemblyVersion>8.0.0.0</AssemblyVersion>
        <AssemblyVersion>10.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Attributes>
        <Attribute FrameworkAlternate="netframework-4.0">
          <AttributeName>System.Runtime.TargetedPatchingOptOut("Performance critical to inline this type of method across NGen image boundaries")</AttributeName>
        </Attribute>
      </Attributes>
      <ReturnValue>
        <ReturnType>System.Void</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="address" Type="System.Uri" />
        <Parameter Name="destinationFileName" Type="System.String" />
        <Parameter Name="userName" Type="System.String" />
        <Parameter Name="password" Type="System.String" />
        <Parameter Name="showUI" Type="System.Boolean" />
        <Parameter Name="connectionTimeout" Type="System.Int32" />
        <Parameter Name="overwrite" Type="System.Boolean" />
      </Parameters>
      <Docs>
        <param name="address">
          <span data-ttu-id="bea5c-344">要下载的文件的路径，包括文件名和主机地址。</span>
          <span class="sxs-lookup">
            <span data-stu-id="bea5c-344">Path of the file to download, including file name and host address.</span>
          </span>
        </param>
        <param name="destinationFileName">
          <span data-ttu-id="bea5c-345">下载的文件的文件名和路径。</span>
          <span class="sxs-lookup">
            <span data-stu-id="bea5c-345">File name and path of the downloaded file.</span>
          </span>
        </param>
        <param name="userName">
          <span data-ttu-id="bea5c-346">要进行身份验证的用户名。</span>
          <span class="sxs-lookup">
            <span data-stu-id="bea5c-346">User name to authenticate.</span>
          </span>
          <span data-ttu-id="bea5c-347">默认值为空字符串 ""。</span>
          <span class="sxs-lookup">
            <span data-stu-id="bea5c-347">Default is an empty string, "".</span>
          </span>
        </param>
        <param name="password">
          <span data-ttu-id="bea5c-348">要验证的密码。</span>
          <span class="sxs-lookup">
            <span data-stu-id="bea5c-348">Password to authenticate.</span>
          </span>
          <span data-ttu-id="bea5c-349">默认值为空字符串 ""。</span>
          <span class="sxs-lookup">
            <span data-stu-id="bea5c-349">Default is an empty string, "".</span>
          </span>
        </param>
        <param name="showUI">
          <span data-ttu-id="bea5c-350">要显示操作进度，则为 <see langword="True" />；否则为 <see langword="False" />。</span>
          <span class="sxs-lookup">
            <span data-stu-id="bea5c-350">
              <see langword="True" /> to display the progress of the operation; otherwise <see langword="False" />.</span>
          </span>
          <span data-ttu-id="bea5c-351">默认值为 <see langword="False" />。</span>
          <span class="sxs-lookup">
            <span data-stu-id="bea5c-351">Default is <see langword="False" />.</span>
          </span>
        </param>
        <param name="connectionTimeout">
          <span data-ttu-id="bea5c-352">以毫秒为单位的超时间隔。</span>
          <span class="sxs-lookup">
            <span data-stu-id="bea5c-352">Timeout interval, in milliseconds.</span>
          </span>
          <span data-ttu-id="bea5c-353">默认值为 100 秒。</span>
          <span class="sxs-lookup">
            <span data-stu-id="bea5c-353">Default is 100 seconds.</span>
          </span>
        </param>
        <param name="overwrite">
          <span data-ttu-id="bea5c-354">要覆盖现有文件，则为 <see langword="True" />；否则为 <see langword="False" />。</span>
          <span class="sxs-lookup">
            <span data-stu-id="bea5c-354">
              <see langword="True" /> to overwrite existing files; otherwise <see langword="False" />.</span>
          </span>
          <span data-ttu-id="bea5c-355">默认值为 <see langword="False" />。</span>
          <span class="sxs-lookup">
            <span data-stu-id="bea5c-355">Default is <see langword="False" />.</span>
          </span>
        </param>
        <summary>
          <span data-ttu-id="bea5c-356">下载指定的远程文件，并将其保存到指定位置。</span>
          <span class="sxs-lookup">
            <span data-stu-id="bea5c-356">Downloads the specified remote file and saves it in the specified location.</span>
          </span>
        </summary>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="bea5c-357">如果`showUI`设置为`True`，其中显示操作的进度会出现一个对话框; 对话框的包含**取消**可用于取消操作的按钮。</span><span class="sxs-lookup"><span data-stu-id="bea5c-357">If `showUI` is set to `True`, a dialog box appears that shows the progress of the operation; the dialog box contains a **Cancel** button that can be used to cancel the operation.</span></span> <span data-ttu-id="bea5c-358">对话框的不是模式对话框，并因此不会阻止其他 windows 程序中的用户输入。</span><span class="sxs-lookup"><span data-stu-id="bea5c-358">The dialog box is not modal, and therefore does not block user input to other windows in the program.</span></span>  
  
 <span data-ttu-id="bea5c-359">如果服务器没有响应中指定`connectionTimeout`，将取消该操作，并引发异常。</span><span class="sxs-lookup"><span data-stu-id="bea5c-359">If the server does not respond within the specified `connectionTimeout`, the operation is cancelled, and an exception is thrown.</span></span>  
  
 <span data-ttu-id="bea5c-360">`DownloadFile` 在应用程序中启用网络跟踪后，跟踪信息输出。</span><span class="sxs-lookup"><span data-stu-id="bea5c-360">`DownloadFile` outputs trace information when you enable network tracing in your application.</span></span> <span data-ttu-id="bea5c-361">有关详细信息，请参阅[启用网络跟踪](~/docs/framework/network-programming/enabling-network-tracing.md)。</span><span class="sxs-lookup"><span data-stu-id="bea5c-361">For more information, see [Enabling Network Tracing](~/docs/framework/network-programming/enabling-network-tracing.md).</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="bea5c-362">`DownloadFile`方法不会发送可选 HTTP 标头。</span><span class="sxs-lookup"><span data-stu-id="bea5c-362">The `DownloadFile` method does not send optional HTTP headers.</span></span> <span data-ttu-id="bea5c-363">如果缺少可选的用户代理标头，某些服务器可能会返回 500 （内部服务器错误）。</span><span class="sxs-lookup"><span data-stu-id="bea5c-363">Some servers may return 500 (Internal Server Error) if the optional user agent header is missing.</span></span> <span data-ttu-id="bea5c-364">若要发送可选标头，必须构造请求使用<xref:System.Net.WebClient>类。</span><span class="sxs-lookup"><span data-stu-id="bea5c-364">To send optional headers, you must construct a request using the <xref:System.Net.WebClient> class.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="bea5c-365">FTP 协议发送的信息，包括以纯文本密码，并不应使用用于传输敏感信息。</span><span class="sxs-lookup"><span data-stu-id="bea5c-365">The FTP protocol sends information, including passwords, in plain text and should not be used for transmitting sensitive information.</span></span>  
  
 <span data-ttu-id="bea5c-366">下表列出的任务涉及示例`My.Computer.Network.DownloadFile`方法。</span><span class="sxs-lookup"><span data-stu-id="bea5c-366">The following table lists an example of a task involving the `My.Computer.Network.DownloadFile` method.</span></span>  
  
|<span data-ttu-id="bea5c-367">到</span><span class="sxs-lookup"><span data-stu-id="bea5c-367">To</span></span>|<span data-ttu-id="bea5c-368">查看</span><span class="sxs-lookup"><span data-stu-id="bea5c-368">See</span></span>|  
|-|-|  
|<span data-ttu-id="bea5c-369">下载的文件</span><span class="sxs-lookup"><span data-stu-id="bea5c-369">Download a file</span></span>|[<span data-ttu-id="bea5c-370">如何：下载文件</span><span class="sxs-lookup"><span data-stu-id="bea5c-370">How to: Download a File</span></span>](~/docs/visual-basic/developing-apps/programming/computer-resources/how-to-download-a-file.md)|  
  
   
  
## Examples  
 <span data-ttu-id="bea5c-371">此示例会将文件下载`WineList.txt`从`http://www.cohowinery.com/downloads`并将其保存到`C:\Documents and Settings\All Users\Documents`。</span><span class="sxs-lookup"><span data-stu-id="bea5c-371">This example downloads the file `WineList.txt` from `http://www.cohowinery.com/downloads` and saves it to `C:\Documents and Settings\All Users\Documents`.</span></span>  
  
 [!code-vb[VbVbalrMyNetwork#7](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbalrMyNetwork/VB/Class1.vb#7)]  
  
 <span data-ttu-id="bea5c-372">此示例会将文件下载`WineList.txt`从`http://www.cohowinery.com/downloads`并将其保存到`C:\Documents and Settings\All Users\Documents`，指定超时间隔设置为 500 毫秒。</span><span class="sxs-lookup"><span data-stu-id="bea5c-372">This example downloads the file `WineList.txt` from `http://www.cohowinery.com/downloads` and saves it to `C:\Documents and Settings\All Users\Documents`, specifying a timeout interval of 500 milliseconds.</span></span>  
  
 [!code-vb[VbVbalrMyNetwork#8](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbalrMyNetwork/VB/Class1.vb#8)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentException">
          <span data-ttu-id="bea5c-373">
            <paramref name="destinationFileName" /> 以尾随斜杠结尾。</span>
          <span class="sxs-lookup">
            <span data-stu-id="bea5c-373">
              <paramref name="destinationFileName" /> ends with a trailing slash.</span>
          </span>
        </exception>
        <exception cref="T:System.IO.IOException">
          <span data-ttu-id="bea5c-374">将 <paramref name="overwrite" /> 设置为 <see langword="False" />，而目标文件已存在。</span>
          <span class="sxs-lookup">
            <span data-stu-id="bea5c-374">
              <paramref name="overwrite" /> is set to <see langword="False" /> and the destination file already exists.</span>
          </span>
        </exception>
        <exception cref="T:System.TimeoutException">
          <span data-ttu-id="bea5c-375">服务器没有在指定的 <paramref name="connectionTimeout" /> 内响应。</span>
          <span class="sxs-lookup">
            <span data-stu-id="bea5c-375">The server does not respond within the specified <paramref name="connectionTimeout" />.</span>
          </span>
        </exception>
        <exception cref="T:System.Security.SecurityException">
          <span data-ttu-id="bea5c-376">用户缺少必要的权限，无法执行网络操作。</span>
          <span class="sxs-lookup">
            <span data-stu-id="bea5c-376">User lacks necessary permissions to perform a network operation.</span>
          </span>
        </exception>
        <exception cref="T:System.Net.WebException">
          <span data-ttu-id="bea5c-377">请求被目标 Web 服务器拒绝。</span>
          <span class="sxs-lookup">
            <span data-stu-id="bea5c-377">The request is denied by the target web server.</span>
          </span>
        </exception>
        <permission cref="T:System.Security.Permissions.FileIOPermission">
          <span data-ttu-id="bea5c-378">控制文件和文件夹的访问权限。</span>
          <span class="sxs-lookup">
            <span data-stu-id="bea5c-378">Controls the ability to access files and folders.</span>
          </span>
          <span data-ttu-id="bea5c-379">关联枚举：<see cref="F:System.Security.Permissions.PermissionState.Unrestricted" />。</span>
          <span class="sxs-lookup">
            <span data-stu-id="bea5c-379">Associated enumeration: <see cref="F:System.Security.Permissions.PermissionState.Unrestricted" />.</span>
          </span>
        </permission>
        <permission cref="T:System.Security.Permissions.UIPermission">
          <span data-ttu-id="bea5c-380">控制与用户界面和剪贴板相关的权限。</span>
          <span class="sxs-lookup">
            <span data-stu-id="bea5c-380">Controls the permissions related to user interfaces and the clipboard.</span>
          </span>
          <span data-ttu-id="bea5c-381">关联枚举：<see cref="F:System.Security.Permissions.UIPermissionWindow.AllWindows" />。</span>
          <span class="sxs-lookup">
            <span data-stu-id="bea5c-381">Associated enumeration: <see cref="F:System.Security.Permissions.UIPermissionWindow.AllWindows" />.</span>
          </span>
        </permission>
        <permission cref="T:System.Net.WebPermission">
          <span data-ttu-id="bea5c-382">控制访问 HTTP Internet 资源的权限。</span>
          <span class="sxs-lookup">
            <span data-stu-id="bea5c-382">Controls rights to access HTTP Internet resources.</span>
          </span>
          <span data-ttu-id="bea5c-383">关联枚举：<see cref="F:System.Security.Permissions.PermissionState.Unrestricted" />。</span>
          <span class="sxs-lookup">
            <span data-stu-id="bea5c-383">Associated enumeration: <see cref="F:System.Security.Permissions.PermissionState.Unrestricted" />.</span>
          </span>
        </permission>
        <altmember cref="T:System.Uri" />
        <altmember cref="T:System.Net.ICredentials" />
      </Docs>
    </Member>
    <Member MemberName="DownloadFile">
      <MemberSignature Language="C#" Value="public void DownloadFile (string address, string destinationFileName, string userName, string password, bool showUI, int connectionTimeout, bool overwrite, Microsoft.VisualBasic.FileIO.UICancelOption onUserCancel);" />
      <MemberSignature Language="ILAsm" Value=".method public instance void DownloadFile(string address, string destinationFileName, string userName, string password, bool showUI, int32 connectionTimeout, bool overwrite, valuetype Microsoft.VisualBasic.FileIO.UICancelOption onUserCancel) cil managed" />
      <MemberSignature Language="DocId" Value="M:Microsoft.VisualBasic.Devices.Network.DownloadFile(System.String,System.String,System.String,System.String,System.Boolean,System.Int32,System.Boolean,Microsoft.VisualBasic.FileIO.UICancelOption)" />
      <MemberSignature Language="VB.NET" Value="Public Sub DownloadFile (address As String, destinationFileName As String, userName As String, password As String, showUI As Boolean, connectionTimeout As Integer, overwrite As Boolean, onUserCancel As UICancelOption)" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; void DownloadFile(System::String ^ address, System::String ^ destinationFileName, System::String ^ userName, System::String ^ password, bool showUI, int connectionTimeout, bool overwrite, Microsoft::VisualBasic::FileIO::UICancelOption onUserCancel);" />
      <MemberSignature Language="F#" Value="member this.DownloadFile : string * string * string * string * bool * int * bool * Microsoft.VisualBasic.FileIO.UICancelOption -&gt; unit" Usage="network.DownloadFile (address, destinationFileName, userName, password, showUI, connectionTimeout, overwrite, onUserCancel)" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>Microsoft.VisualBasic</AssemblyName>
        <AssemblyVersion>8.0.0.0</AssemblyVersion>
        <AssemblyVersion>10.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Void</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="address" Type="System.String" />
        <Parameter Name="destinationFileName" Type="System.String" />
        <Parameter Name="userName" Type="System.String" />
        <Parameter Name="password" Type="System.String" />
        <Parameter Name="showUI" Type="System.Boolean" />
        <Parameter Name="connectionTimeout" Type="System.Int32" />
        <Parameter Name="overwrite" Type="System.Boolean" />
        <Parameter Name="onUserCancel" Type="Microsoft.VisualBasic.FileIO.UICancelOption" />
      </Parameters>
      <Docs>
        <param name="address">
          <span data-ttu-id="bea5c-384">要下载的文件的路径，包括文件名和主机地址。</span>
          <span class="sxs-lookup">
            <span data-stu-id="bea5c-384">Path of the file to download, including file name and host address.</span>
          </span>
        </param>
        <param name="destinationFileName">
          <span data-ttu-id="bea5c-385">下载的文件的文件名和路径。</span>
          <span class="sxs-lookup">
            <span data-stu-id="bea5c-385">File name and path of the downloaded file.</span>
          </span>
        </param>
        <param name="userName">
          <span data-ttu-id="bea5c-386">要进行身份验证的用户名。</span>
          <span class="sxs-lookup">
            <span data-stu-id="bea5c-386">User name to authenticate.</span>
          </span>
          <span data-ttu-id="bea5c-387">默认值为空字符串 ""。</span>
          <span class="sxs-lookup">
            <span data-stu-id="bea5c-387">Default is an empty string, "".</span>
          </span>
        </param>
        <param name="password">
          <span data-ttu-id="bea5c-388">要验证的密码。</span>
          <span class="sxs-lookup">
            <span data-stu-id="bea5c-388">Password to authenticate.</span>
          </span>
          <span data-ttu-id="bea5c-389">默认值为空字符串 ""。</span>
          <span class="sxs-lookup">
            <span data-stu-id="bea5c-389">Default is an empty string, "".</span>
          </span>
        </param>
        <param name="showUI">
          <span data-ttu-id="bea5c-390">要显示操作进度，则为 <see langword="True" />；否则为 <see langword="False" />。</span>
          <span class="sxs-lookup">
            <span data-stu-id="bea5c-390">
              <see langword="True" /> to display the progress of the operation; otherwise <see langword="False" />.</span>
          </span>
          <span data-ttu-id="bea5c-391">默认值为 <see langword="False" />。</span>
          <span class="sxs-lookup">
            <span data-stu-id="bea5c-391">Default is <see langword="False" />.</span>
          </span>
        </param>
        <param name="connectionTimeout">
          <span data-ttu-id="bea5c-392">以毫秒为单位的超时间隔。</span>
          <span class="sxs-lookup">
            <span data-stu-id="bea5c-392">Timeout interval, in milliseconds.</span>
          </span>
          <span data-ttu-id="bea5c-393">默认值为 100 秒。</span>
          <span class="sxs-lookup">
            <span data-stu-id="bea5c-393">Default is 100 seconds.</span>
          </span>
        </param>
        <param name="overwrite">
          <span data-ttu-id="bea5c-394">要覆盖现有文件，则为 <see langword="True" />；否则为 <see langword="False" />。</span>
          <span class="sxs-lookup">
            <span data-stu-id="bea5c-394">
              <see langword="True" /> to overwrite existing files; otherwise <see langword="False" />.</span>
          </span>
          <span data-ttu-id="bea5c-395">默认值为 <see langword="False" />。</span>
          <span class="sxs-lookup">
            <span data-stu-id="bea5c-395">Default is <see langword="False" />.</span>
          </span>
        </param>
        <param name="onUserCancel">
          <span data-ttu-id="bea5c-396">指定当用户在对话框（在 <c>ShowUI</c> 设置为 <see langword="True" /> 时将显示此对话框）上单击“取消”或“否”时的行为。</span>
          <span class="sxs-lookup">
            <span data-stu-id="bea5c-396">Specifies behavior when the user clicks **Cancel** or **No** on the dialog box shown as a result of <c>ShowUI</c> set to <see langword="True" />.</span>
          </span>
          <span data-ttu-id="bea5c-397">默认值为 <see cref="F:Microsoft.VisualBasic.FileIO.UICancelOption.ThrowException" />。</span>
          <span class="sxs-lookup">
            <span data-stu-id="bea5c-397">Default is <see cref="F:Microsoft.VisualBasic.FileIO.UICancelOption.ThrowException" />.</span>
          </span>
        </param>
        <summary>
          <span data-ttu-id="bea5c-398">下载指定的远程文件，并将其保存到指定位置。</span>
          <span class="sxs-lookup">
            <span data-stu-id="bea5c-398">Downloads the specified remote file and saves it in the specified location.</span>
          </span>
        </summary>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="bea5c-399">如果`showUI`设置为`True`，其中显示操作的进度会出现一个对话框; 对话框的包含**取消**可用于取消操作的按钮。</span><span class="sxs-lookup"><span data-stu-id="bea5c-399">If `showUI` is set to `True`, a dialog box appears that shows the progress of the operation; the dialog box contains a **Cancel** button that can be used to cancel the operation.</span></span> <span data-ttu-id="bea5c-400">对话框的不是模式对话框，并因此不会阻止其他 windows 程序中的用户输入。</span><span class="sxs-lookup"><span data-stu-id="bea5c-400">The dialog box is not modal, and therefore does not block user input to other windows in the program.</span></span>  
  
 <span data-ttu-id="bea5c-401">如果服务器没有响应中指定`connectionTimeout`，将取消该操作，并引发异常。</span><span class="sxs-lookup"><span data-stu-id="bea5c-401">If the server does not respond within the specified `connectionTimeout`, the operation is cancelled, and an exception is thrown.</span></span>  
  
 <span data-ttu-id="bea5c-402">`DownloadFile` 在应用程序中启用网络跟踪后，跟踪信息输出。</span><span class="sxs-lookup"><span data-stu-id="bea5c-402">`DownloadFile` outputs trace information when you enable network tracing in your application.</span></span> <span data-ttu-id="bea5c-403">有关详细信息，请参阅[启用网络跟踪](~/docs/framework/network-programming/enabling-network-tracing.md)。</span><span class="sxs-lookup"><span data-stu-id="bea5c-403">For more information, see [Enabling Network Tracing](~/docs/framework/network-programming/enabling-network-tracing.md).</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="bea5c-404">`DownloadFile`方法不会发送可选 HTTP 标头。</span><span class="sxs-lookup"><span data-stu-id="bea5c-404">The `DownloadFile` method does not send optional HTTP headers.</span></span> <span data-ttu-id="bea5c-405">如果缺少可选的用户代理标头，某些服务器可能会返回 500 （内部服务器错误）。</span><span class="sxs-lookup"><span data-stu-id="bea5c-405">Some servers may return 500 (Internal Server Error) if the optional user agent header is missing.</span></span> <span data-ttu-id="bea5c-406">若要发送可选标头，必须构造请求使用<xref:System.Net.WebClient>类。</span><span class="sxs-lookup"><span data-stu-id="bea5c-406">To send optional headers, you must construct a request using the <xref:System.Net.WebClient> class.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="bea5c-407">FTP 协议发送的信息，包括以纯文本密码，并不应使用用于传输敏感信息。</span><span class="sxs-lookup"><span data-stu-id="bea5c-407">The FTP protocol sends information, including passwords, in plain text and should not be used for transmitting sensitive information.</span></span>  
  
 <span data-ttu-id="bea5c-408">下表列出的任务涉及示例`My.Computer.Network.DownloadFile`方法。</span><span class="sxs-lookup"><span data-stu-id="bea5c-408">The following table lists an example of a task involving the `My.Computer.Network.DownloadFile` method.</span></span>  
  
|<span data-ttu-id="bea5c-409">到</span><span class="sxs-lookup"><span data-stu-id="bea5c-409">To</span></span>|<span data-ttu-id="bea5c-410">查看</span><span class="sxs-lookup"><span data-stu-id="bea5c-410">See</span></span>|  
|-|-|  
|<span data-ttu-id="bea5c-411">下载的文件</span><span class="sxs-lookup"><span data-stu-id="bea5c-411">Download a file</span></span>|[<span data-ttu-id="bea5c-412">如何：下载文件</span><span class="sxs-lookup"><span data-stu-id="bea5c-412">How to: Download a File</span></span>](~/docs/visual-basic/developing-apps/programming/computer-resources/how-to-download-a-file.md)|  
  
   
  
## Examples  
 <span data-ttu-id="bea5c-413">此示例会将文件下载`WineList.txt`从`http://www.cohowinery.com/downloads`并将其保存到`C:\Documents and Settings\All Users\Documents`。</span><span class="sxs-lookup"><span data-stu-id="bea5c-413">This example downloads the file `WineList.txt` from `http://www.cohowinery.com/downloads` and saves it to `C:\Documents and Settings\All Users\Documents`.</span></span>  
  
 [!code-vb[VbVbalrMyNetwork#7](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbalrMyNetwork/VB/Class1.vb#7)]  
  
 <span data-ttu-id="bea5c-414">此示例会将文件下载`WineList.txt`从`http://www.cohowinery.com/downloads`并将其保存到`C:\Documents and Settings\All Users\Documents`，指定超时间隔设置为 500 毫秒。</span><span class="sxs-lookup"><span data-stu-id="bea5c-414">This example downloads the file `WineList.txt` from `http://www.cohowinery.com/downloads` and saves it to `C:\Documents and Settings\All Users\Documents`, specifying a timeout interval of 500 milliseconds.</span></span>  
  
 [!code-vb[VbVbalrMyNetwork#8](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbalrMyNetwork/VB/Class1.vb#8)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentException">
          <span data-ttu-id="bea5c-415">
            <paramref name="destinationFileName" /> 以尾随斜杠结尾。</span>
          <span class="sxs-lookup">
            <span data-stu-id="bea5c-415">
              <paramref name="destinationFileName" /> ends with a trailing slash.</span>
          </span>
        </exception>
        <exception cref="T:System.IO.IOException">
          <span data-ttu-id="bea5c-416">将 <paramref name="overwrite" /> 设置为 <see langword="False" />，而目标文件已存在。</span>
          <span class="sxs-lookup">
            <span data-stu-id="bea5c-416">
              <paramref name="overwrite" /> is set to <see langword="False" /> and the destination file already exists.</span>
          </span>
        </exception>
        <exception cref="T:System.TimeoutException">
          <span data-ttu-id="bea5c-417">服务器没有在指定的 <paramref name="connectionTimeout" /> 内响应。</span>
          <span class="sxs-lookup">
            <span data-stu-id="bea5c-417">The server does not respond within the specified <paramref name="connectionTimeout" />.</span>
          </span>
        </exception>
        <exception cref="T:System.Security.SecurityException">
          <span data-ttu-id="bea5c-418">用户缺少必要的权限，无法执行网络操作。</span>
          <span class="sxs-lookup">
            <span data-stu-id="bea5c-418">User lacks necessary permissions to perform a network operation.</span>
          </span>
        </exception>
        <exception cref="T:System.Net.WebException">
          <span data-ttu-id="bea5c-419">请求被目标 Web 服务器拒绝。</span>
          <span class="sxs-lookup">
            <span data-stu-id="bea5c-419">The request is denied by the target web server.</span>
          </span>
        </exception>
        <permission cref="T:System.Security.Permissions.FileIOPermission">
          <span data-ttu-id="bea5c-420">控制文件和文件夹的访问权限。</span>
          <span class="sxs-lookup">
            <span data-stu-id="bea5c-420">Controls the ability to access files and folders.</span>
          </span>
          <span data-ttu-id="bea5c-421">关联枚举：<see cref="F:System.Security.Permissions.PermissionState.Unrestricted" />。</span>
          <span class="sxs-lookup">
            <span data-stu-id="bea5c-421">Associated enumeration: <see cref="F:System.Security.Permissions.PermissionState.Unrestricted" />.</span>
          </span>
        </permission>
        <permission cref="T:System.Security.Permissions.UIPermission">
          <span data-ttu-id="bea5c-422">控制与用户界面和剪贴板相关的权限。</span>
          <span class="sxs-lookup">
            <span data-stu-id="bea5c-422">Controls the permissions related to user interfaces and the clipboard.</span>
          </span>
          <span data-ttu-id="bea5c-423">关联枚举：<see cref="F:System.Security.Permissions.UIPermissionWindow.AllWindows" />。</span>
          <span class="sxs-lookup">
            <span data-stu-id="bea5c-423">Associated enumeration: <see cref="F:System.Security.Permissions.UIPermissionWindow.AllWindows" />.</span>
          </span>
        </permission>
        <permission cref="T:System.Net.WebPermission">
          <span data-ttu-id="bea5c-424">控制访问 HTTP Internet 资源的权限。</span>
          <span class="sxs-lookup">
            <span data-stu-id="bea5c-424">Controls rights to access HTTP Internet resources.</span>
          </span>
          <span data-ttu-id="bea5c-425">关联枚举：<see cref="F:System.Security.Permissions.PermissionState.Unrestricted" />。</span>
          <span class="sxs-lookup">
            <span data-stu-id="bea5c-425">Associated enumeration: <see cref="F:System.Security.Permissions.PermissionState.Unrestricted" />.</span>
          </span>
        </permission>
        <altmember cref="T:System.Uri" />
        <altmember cref="T:System.Net.ICredentials" />
      </Docs>
    </Member>
    <Member MemberName="DownloadFile">
      <MemberSignature Language="C#" Value="public void DownloadFile (Uri address, string destinationFileName, string userName, string password, bool showUI, int connectionTimeout, bool overwrite, Microsoft.VisualBasic.FileIO.UICancelOption onUserCancel);" />
      <MemberSignature Language="ILAsm" Value=".method public instance void DownloadFile(class System.Uri address, string destinationFileName, string userName, string password, bool showUI, int32 connectionTimeout, bool overwrite, valuetype Microsoft.VisualBasic.FileIO.UICancelOption onUserCancel) cil managed" />
      <MemberSignature Language="DocId" Value="M:Microsoft.VisualBasic.Devices.Network.DownloadFile(System.Uri,System.String,System.String,System.String,System.Boolean,System.Int32,System.Boolean,Microsoft.VisualBasic.FileIO.UICancelOption)" />
      <MemberSignature Language="VB.NET" Value="Public Sub DownloadFile (address As Uri, destinationFileName As String, userName As String, password As String, showUI As Boolean, connectionTimeout As Integer, overwrite As Boolean, onUserCancel As UICancelOption)" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; void DownloadFile(Uri ^ address, System::String ^ destinationFileName, System::String ^ userName, System::String ^ password, bool showUI, int connectionTimeout, bool overwrite, Microsoft::VisualBasic::FileIO::UICancelOption onUserCancel);" />
      <MemberSignature Language="F#" Value="member this.DownloadFile : Uri * string * string * string * bool * int * bool * Microsoft.VisualBasic.FileIO.UICancelOption -&gt; unit" Usage="network.DownloadFile (address, destinationFileName, userName, password, showUI, connectionTimeout, overwrite, onUserCancel)" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>Microsoft.VisualBasic</AssemblyName>
        <AssemblyVersion>8.0.0.0</AssemblyVersion>
        <AssemblyVersion>10.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Void</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="address" Type="System.Uri" />
        <Parameter Name="destinationFileName" Type="System.String" />
        <Parameter Name="userName" Type="System.String" />
        <Parameter Name="password" Type="System.String" />
        <Parameter Name="showUI" Type="System.Boolean" />
        <Parameter Name="connectionTimeout" Type="System.Int32" />
        <Parameter Name="overwrite" Type="System.Boolean" />
        <Parameter Name="onUserCancel" Type="Microsoft.VisualBasic.FileIO.UICancelOption" />
      </Parameters>
      <Docs>
        <param name="address">
          <span data-ttu-id="bea5c-426">要下载的文件的路径，包括文件名和主机地址。</span>
          <span class="sxs-lookup">
            <span data-stu-id="bea5c-426">Path of the file to download, including file name and host address.</span>
          </span>
        </param>
        <param name="destinationFileName">
          <span data-ttu-id="bea5c-427">下载的文件的文件名和路径。</span>
          <span class="sxs-lookup">
            <span data-stu-id="bea5c-427">File name and path of the downloaded file.</span>
          </span>
        </param>
        <param name="userName">
          <span data-ttu-id="bea5c-428">要进行身份验证的用户名。</span>
          <span class="sxs-lookup">
            <span data-stu-id="bea5c-428">User name to authenticate.</span>
          </span>
          <span data-ttu-id="bea5c-429">默认值为空字符串 ""。</span>
          <span class="sxs-lookup">
            <span data-stu-id="bea5c-429">Default is an empty string, "".</span>
          </span>
        </param>
        <param name="password">
          <span data-ttu-id="bea5c-430">要验证的密码。</span>
          <span class="sxs-lookup">
            <span data-stu-id="bea5c-430">Password to authenticate.</span>
          </span>
          <span data-ttu-id="bea5c-431">默认值为空字符串 ""。</span>
          <span class="sxs-lookup">
            <span data-stu-id="bea5c-431">Default is an empty string, "".</span>
          </span>
        </param>
        <param name="showUI">
          <span data-ttu-id="bea5c-432">要显示操作进度，则为 <see langword="True" />；否则为 <see langword="False" />。</span>
          <span class="sxs-lookup">
            <span data-stu-id="bea5c-432">
              <see langword="True" /> to display the progress of the operation; otherwise <see langword="False" />.</span>
          </span>
          <span data-ttu-id="bea5c-433">默认值为 <see langword="False" />。</span>
          <span class="sxs-lookup">
            <span data-stu-id="bea5c-433">Default is <see langword="False" />.</span>
          </span>
        </param>
        <param name="connectionTimeout">
          <span data-ttu-id="bea5c-434">以毫秒为单位的超时间隔。</span>
          <span class="sxs-lookup">
            <span data-stu-id="bea5c-434">Timeout interval, in milliseconds.</span>
          </span>
          <span data-ttu-id="bea5c-435">默认值为 100 秒。</span>
          <span class="sxs-lookup">
            <span data-stu-id="bea5c-435">Default is 100 seconds.</span>
          </span>
        </param>
        <param name="overwrite">
          <span data-ttu-id="bea5c-436">要覆盖现有文件，则为 <see langword="True" />；否则为 <see langword="False" />。</span>
          <span class="sxs-lookup">
            <span data-stu-id="bea5c-436">
              <see langword="True" /> to overwrite existing files; otherwise <see langword="False" />.</span>
          </span>
          <span data-ttu-id="bea5c-437">默认值为 <see langword="False" />。</span>
          <span class="sxs-lookup">
            <span data-stu-id="bea5c-437">Default is <see langword="False" />.</span>
          </span>
        </param>
        <param name="onUserCancel">
          <span data-ttu-id="bea5c-438">指定当用户在对话框（在 <c>ShowUI</c> 设置为 <see langword="True" /> 时将显示此对话框）上单击“取消”或“否”时的行为。</span>
          <span class="sxs-lookup">
            <span data-stu-id="bea5c-438">Specifies behavior when the user clicks **Cancel** or **No** on the dialog box shown as a result of <c>ShowUI</c> set to <see langword="True" />.</span>
          </span>
          <span data-ttu-id="bea5c-439">默认值为 <see cref="F:Microsoft.VisualBasic.FileIO.UICancelOption.ThrowException" />。</span>
          <span class="sxs-lookup">
            <span data-stu-id="bea5c-439">Default is <see cref="F:Microsoft.VisualBasic.FileIO.UICancelOption.ThrowException" />.</span>
          </span>
        </param>
        <summary>
          <span data-ttu-id="bea5c-440">下载指定的远程文件，并将其保存到指定位置。</span>
          <span class="sxs-lookup">
            <span data-stu-id="bea5c-440">Downloads the specified remote file and saves it in the specified location.</span>
          </span>
        </summary>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="bea5c-441">如果`showUI`设置为`True`，其中显示操作的进度会出现一个对话框; 对话框的包含**取消**可用于取消操作的按钮。</span><span class="sxs-lookup"><span data-stu-id="bea5c-441">If `showUI` is set to `True`, a dialog box appears that shows the progress of the operation; the dialog box contains a **Cancel** button that can be used to cancel the operation.</span></span> <span data-ttu-id="bea5c-442">对话框的不是模式对话框，并因此不会阻止其他 windows 程序中的用户输入。</span><span class="sxs-lookup"><span data-stu-id="bea5c-442">The dialog box is not modal, and therefore does not block user input to other windows in the program.</span></span>  
  
 <span data-ttu-id="bea5c-443">如果服务器没有响应中指定`connectionTimeout`，将取消该操作，并引发异常。</span><span class="sxs-lookup"><span data-stu-id="bea5c-443">If the server does not respond within the specified `connectionTimeout`, the operation is cancelled, and an exception is thrown.</span></span>  
  
 <span data-ttu-id="bea5c-444">`DownloadFile` 在应用程序中启用网络跟踪后，跟踪信息输出。</span><span class="sxs-lookup"><span data-stu-id="bea5c-444">`DownloadFile` outputs trace information when you enable network tracing in your application.</span></span> <span data-ttu-id="bea5c-445">有关详细信息，请参阅[启用网络跟踪](~/docs/framework/network-programming/enabling-network-tracing.md)。</span><span class="sxs-lookup"><span data-stu-id="bea5c-445">For more information, see [Enabling Network Tracing](~/docs/framework/network-programming/enabling-network-tracing.md).</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="bea5c-446">`DownloadFile`方法不会发送可选 HTTP 标头。</span><span class="sxs-lookup"><span data-stu-id="bea5c-446">The `DownloadFile` method does not send optional HTTP headers.</span></span> <span data-ttu-id="bea5c-447">如果缺少可选的用户代理标头，某些服务器可能会返回 500 （内部服务器错误）。</span><span class="sxs-lookup"><span data-stu-id="bea5c-447">Some servers may return 500 (Internal Server Error) if the optional user agent header is missing.</span></span> <span data-ttu-id="bea5c-448">若要发送可选标头，必须构造请求使用<xref:System.Net.WebClient>类。</span><span class="sxs-lookup"><span data-stu-id="bea5c-448">To send optional headers, you must construct a request using the <xref:System.Net.WebClient> class.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="bea5c-449">FTP 协议发送的信息，包括以纯文本密码，并不应使用用于传输敏感信息。</span><span class="sxs-lookup"><span data-stu-id="bea5c-449">The FTP protocol sends information, including passwords, in plain text and should not be used for transmitting sensitive information.</span></span>  
  
 <span data-ttu-id="bea5c-450">下表列出的任务涉及示例`My.Computer.Network.DownloadFile`方法。</span><span class="sxs-lookup"><span data-stu-id="bea5c-450">The following table lists an example of a task involving the `My.Computer.Network.DownloadFile` method.</span></span>  
  
|<span data-ttu-id="bea5c-451">到</span><span class="sxs-lookup"><span data-stu-id="bea5c-451">To</span></span>|<span data-ttu-id="bea5c-452">查看</span><span class="sxs-lookup"><span data-stu-id="bea5c-452">See</span></span>|  
|-|-|  
|<span data-ttu-id="bea5c-453">下载的文件</span><span class="sxs-lookup"><span data-stu-id="bea5c-453">Download a file</span></span>|[<span data-ttu-id="bea5c-454">如何：下载文件</span><span class="sxs-lookup"><span data-stu-id="bea5c-454">How to: Download a File</span></span>](~/docs/visual-basic/developing-apps/programming/computer-resources/how-to-download-a-file.md)|  
  
   
  
## Examples  
 <span data-ttu-id="bea5c-455">此示例会将文件下载`WineList.txt`从`http://www.cohowinery.com/downloads`并将其保存到`C:\Documents and Settings\All Users\Documents`。</span><span class="sxs-lookup"><span data-stu-id="bea5c-455">This example downloads the file `WineList.txt` from `http://www.cohowinery.com/downloads` and saves it to `C:\Documents and Settings\All Users\Documents`.</span></span>  
  
 [!code-vb[VbVbalrMyNetwork#7](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbalrMyNetwork/VB/Class1.vb#7)]  
  
 <span data-ttu-id="bea5c-456">此示例会将文件下载`WineList.txt`从`http://www.cohowinery.com/downloads`并将其保存到`C:\Documents and Settings\All Users\Documents`，指定超时间隔设置为 500 毫秒。</span><span class="sxs-lookup"><span data-stu-id="bea5c-456">This example downloads the file `WineList.txt` from `http://www.cohowinery.com/downloads` and saves it to `C:\Documents and Settings\All Users\Documents`, specifying a timeout interval of 500 milliseconds.</span></span>  
  
 [!code-vb[VbVbalrMyNetwork#8](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbalrMyNetwork/VB/Class1.vb#8)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentException">
          <span data-ttu-id="bea5c-457">
            <paramref name="destinationFileName" /> 以尾随斜杠结尾。</span>
          <span class="sxs-lookup">
            <span data-stu-id="bea5c-457">
              <paramref name="destinationFileName" /> ends with a trailing slash.</span>
          </span>
        </exception>
        <exception cref="T:System.IO.IOException">
          <span data-ttu-id="bea5c-458">将 <paramref name="overwrite" /> 设置为 <see langword="False" />，而目标文件已存在。</span>
          <span class="sxs-lookup">
            <span data-stu-id="bea5c-458">
              <paramref name="overwrite" /> is set to <see langword="False" /> and the destination file already exists.</span>
          </span>
        </exception>
        <exception cref="T:System.TimeoutException">
          <span data-ttu-id="bea5c-459">服务器没有在指定的 <paramref name="connectionTimeout" /> 内响应。</span>
          <span class="sxs-lookup">
            <span data-stu-id="bea5c-459">The server does not respond within the specified <paramref name="connectionTimeout" />.</span>
          </span>
        </exception>
        <exception cref="T:System.Security.SecurityException">
          <span data-ttu-id="bea5c-460">用户缺少必要的权限，无法执行网络操作。</span>
          <span class="sxs-lookup">
            <span data-stu-id="bea5c-460">User lacks necessary permissions to perform a network operation.</span>
          </span>
        </exception>
        <exception cref="T:System.Net.WebException">
          <span data-ttu-id="bea5c-461">请求被目标 Web 服务器拒绝。</span>
          <span class="sxs-lookup">
            <span data-stu-id="bea5c-461">The request is denied by the target web server.</span>
          </span>
        </exception>
        <permission cref="T:System.Security.Permissions.FileIOPermission">
          <span data-ttu-id="bea5c-462">控制文件和文件夹的访问权限。</span>
          <span class="sxs-lookup">
            <span data-stu-id="bea5c-462">Controls the ability to access files and folders.</span>
          </span>
          <span data-ttu-id="bea5c-463">关联枚举：<see cref="F:System.Security.Permissions.PermissionState.Unrestricted" />。</span>
          <span class="sxs-lookup">
            <span data-stu-id="bea5c-463">Associated enumeration: <see cref="F:System.Security.Permissions.PermissionState.Unrestricted" />.</span>
          </span>
        </permission>
        <permission cref="T:System.Security.Permissions.UIPermission">
          <span data-ttu-id="bea5c-464">控制与用户界面和剪贴板相关的权限。</span>
          <span class="sxs-lookup">
            <span data-stu-id="bea5c-464">Controls the permissions related to user interfaces and the clipboard.</span>
          </span>
          <span data-ttu-id="bea5c-465">关联枚举：<see cref="F:System.Security.Permissions.UIPermissionWindow.AllWindows" />。</span>
          <span class="sxs-lookup">
            <span data-stu-id="bea5c-465">Associated enumeration: <see cref="F:System.Security.Permissions.UIPermissionWindow.AllWindows" />.</span>
          </span>
        </permission>
        <permission cref="T:System.Net.WebPermission">
          <span data-ttu-id="bea5c-466">控制访问 HTTP Internet 资源的权限。</span>
          <span class="sxs-lookup">
            <span data-stu-id="bea5c-466">Controls rights to access HTTP Internet resources.</span>
          </span>
          <span data-ttu-id="bea5c-467">关联枚举：<see cref="F:System.Security.Permissions.PermissionState.Unrestricted" />。</span>
          <span class="sxs-lookup">
            <span data-stu-id="bea5c-467">Associated enumeration: <see cref="F:System.Security.Permissions.PermissionState.Unrestricted" />.</span>
          </span>
        </permission>
        <altmember cref="T:System.Uri" />
        <altmember cref="T:System.Net.ICredentials" />
      </Docs>
    </Member>
    <Member MemberName="IsAvailable">
      <MemberSignature Language="C#" Value="public bool IsAvailable { get; }" />
      <MemberSignature Language="ILAsm" Value=".property instance bool IsAvailable" />
      <MemberSignature Language="DocId" Value="P:Microsoft.VisualBasic.Devices.Network.IsAvailable" />
      <MemberSignature Language="VB.NET" Value="Public ReadOnly Property IsAvailable As Boolean" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; property bool IsAvailable { bool get(); };" />
      <MemberSignature Language="F#" Value="member this.IsAvailable : bool" Usage="Microsoft.VisualBasic.Devices.Network.IsAvailable" />
      <MemberType>Property</MemberType>
      <AssemblyInfo>
        <AssemblyName>Microsoft.VisualBasic</AssemblyName>
        <AssemblyVersion>8.0.0.0</AssemblyVersion>
        <AssemblyVersion>10.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Boolean</ReturnType>
      </ReturnValue>
      <Docs>
        <summary>
          <span data-ttu-id="bea5c-468">指示计算机是否已连接至网络。</span>
          <span class="sxs-lookup">
            <span data-stu-id="bea5c-468">Indicates whether a computer is connected to a network.</span>
          </span>
        </summary>
        <value>
          <span data-ttu-id="bea5c-469">如果将计算机连接到网络，则为 <see langword="True" />；否则为 <see langword="False" />。</span>
          <span class="sxs-lookup">
            <span data-stu-id="bea5c-469">
              <see langword="True" /> if the computer is connected to a network; otherwise <see langword="False" />.</span>
          </span>
        </value>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="bea5c-470">`IsAvailable` 始终返回`False`从调用时`Click Once`应用程序或用户没有<xref:System.Net.NetworkInformation.NetworkInformationPermission>。</span><span class="sxs-lookup"><span data-stu-id="bea5c-470">`IsAvailable` always returns `False` when called from a `Click Once` application or if the user does not have <xref:System.Net.NetworkInformation.NetworkInformationPermission>.</span></span>  
  
 <span data-ttu-id="bea5c-471">下表列出了所涉及的任务的示例`My.Computer.Network.IsAvailable`属性。</span><span class="sxs-lookup"><span data-stu-id="bea5c-471">The following table lists examples of tasks involving the `My.Computer.Network.IsAvailable` property.</span></span>  
  
|<span data-ttu-id="bea5c-472">到</span><span class="sxs-lookup"><span data-stu-id="bea5c-472">To</span></span>|<span data-ttu-id="bea5c-473">查看</span><span class="sxs-lookup"><span data-stu-id="bea5c-473">See</span></span>|  
|-|-|  
|<span data-ttu-id="bea5c-474">检查计算机是否已连接到网络</span><span class="sxs-lookup"><span data-stu-id="bea5c-474">Check whether a computer is connected to a network</span></span>|[<span data-ttu-id="bea5c-475">如何：检查连接状态</span><span class="sxs-lookup"><span data-stu-id="bea5c-475">How to: Check Connection Status</span></span>](~/docs/visual-basic/developing-apps/programming/computer-resources/how-to-check-connection-status.md)|  
  
   
  
## Examples  
 <span data-ttu-id="bea5c-476">此示例检查属性的状态并进行报告。</span><span class="sxs-lookup"><span data-stu-id="bea5c-476">This example checks the property's status and reports it.</span></span>  
  
 [!code-vb[VbVbalrMyNetwork#1](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbalrMyNetwork/VB/Class1.vb#1)]  
  
 ]]></format>
        </remarks>
        <permission cref="T:System.Security.Permissions.FileIOPermission">
          <span data-ttu-id="bea5c-477">控制文件和文件夹的访问权限。</span>
          <span class="sxs-lookup">
            <span data-stu-id="bea5c-477">Controls the ability to access files and folders.</span>
          </span>
          <span data-ttu-id="bea5c-478">关联枚举：<see cref="F:System.Security.Permissions.PermissionState.Unrestricted" />。</span>
          <span class="sxs-lookup">
            <span data-stu-id="bea5c-478">Associated enumeration: <see cref="F:System.Security.Permissions.PermissionState.Unrestricted" />.</span>
          </span>
        </permission>
        <permission cref="T:System.Net.WebPermission">
          <span data-ttu-id="bea5c-479">控制访问 HTTP Internet 资源的权限。</span>
          <span class="sxs-lookup">
            <span data-stu-id="bea5c-479">Controls rights to access HTTP Internet resources.</span>
          </span>
          <span data-ttu-id="bea5c-480">关联枚举：<see cref="F:System.Security.Permissions.PermissionState.Unrestricted" />。</span>
          <span class="sxs-lookup">
            <span data-stu-id="bea5c-480">Associated enumeration: <see cref="F:System.Security.Permissions.PermissionState.Unrestricted" />.</span>
          </span>
        </permission>
      </Docs>
    </Member>
    <Member MemberName="NetworkAvailabilityChanged">
      <MemberSignature Language="C#" Value="public event Microsoft.VisualBasic.Devices.NetworkAvailableEventHandler NetworkAvailabilityChanged;" />
      <MemberSignature Language="ILAsm" Value=".event class Microsoft.VisualBasic.Devices.NetworkAvailableEventHandler NetworkAvailabilityChanged" />
      <MemberSignature Language="DocId" Value="E:Microsoft.VisualBasic.Devices.Network.NetworkAvailabilityChanged" />
      <MemberSignature Language="VB.NET" Value="Public Custom Event NetworkAvailabilityChanged As NetworkAvailableEventHandler " />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; event Microsoft::VisualBasic::Devices::NetworkAvailableEventHandler ^ NetworkAvailabilityChanged;" />
      <MemberSignature Language="F#" Value="member this.NetworkAvailabilityChanged : Microsoft.VisualBasic.Devices.NetworkAvailableEventHandler " Usage="member this.NetworkAvailabilityChanged : Microsoft.VisualBasic.Devices.NetworkAvailableEventHandler " />
      <MemberType>Event</MemberType>
      <AssemblyInfo>
        <AssemblyName>Microsoft.VisualBasic</AssemblyName>
        <AssemblyVersion>8.0.0.0</AssemblyVersion>
        <AssemblyVersion>10.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>Microsoft.VisualBasic.Devices.NetworkAvailableEventHandler</ReturnType>
      </ReturnValue>
      <Docs>
        <summary>
          <span data-ttu-id="bea5c-481">在网络可用性更改时发生。</span>
          <span class="sxs-lookup">
            <span data-stu-id="bea5c-481">Occurs when the network availability changes.</span>
          </span>
        </summary>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="bea5c-482">应用程序引发的`NetworkAvailabilityChanged`每次在网络可用性更改事件。</span><span class="sxs-lookup"><span data-stu-id="bea5c-482">An application raises the `NetworkAvailabilityChanged` event every time the availability of the network changes.</span></span> <span data-ttu-id="bea5c-483">可以使用<xref:Microsoft.VisualBasic.Devices.NetworkAvailableEventArgs.IsNetworkAvailable%2A>属性的`e`参数，以获取新的网络连接的状态。</span><span class="sxs-lookup"><span data-stu-id="bea5c-483">You can use the <xref:Microsoft.VisualBasic.Devices.NetworkAvailableEventArgs.IsNetworkAvailable%2A> property of the `e` parameter to get the new state of the network connection.</span></span> <span data-ttu-id="bea5c-484">若要获取的网络连接的当前状态，请使用<xref:Microsoft.VisualBasic.Devices.Network.IsAvailable%2A>属性。</span><span class="sxs-lookup"><span data-stu-id="bea5c-484">To get the current state of the network connection, use the <xref:Microsoft.VisualBasic.Devices.Network.IsAvailable%2A> property.</span></span>  
  
 <span data-ttu-id="bea5c-485">在 Windows 窗体应用程序中，与其他用户界面事件的应用程序的主线程上引发此事件。</span><span class="sxs-lookup"><span data-stu-id="bea5c-485">In a Windows Forms application, this event is raised on the application's main thread with the other user-interface events.</span></span> <span data-ttu-id="bea5c-486">这允许直接访问应用程序的用户界面的事件处理程序。</span><span class="sxs-lookup"><span data-stu-id="bea5c-486">This allows the event handler to access directly the application's user interface.</span></span> <span data-ttu-id="bea5c-487">但是，如果应用程序正忙于处理另一个用户界面事件时将引发此事件，此事件之前，无法处理其他事件处理程序完成，或调用<xref:Microsoft.VisualBasic.ApplicationServices.WindowsFormsApplicationBase.DoEvents%2A>方法。</span><span class="sxs-lookup"><span data-stu-id="bea5c-487">However, if the application is busy handling another user-interface event when this event is raised, this event cannot be processed until the other event handler finishes or calls the <xref:Microsoft.VisualBasic.ApplicationServices.WindowsFormsApplicationBase.DoEvents%2A> method.</span></span>  
  
 <span data-ttu-id="bea5c-488">不能使用`Handles`语句来处理`NetworkAvailabilityChanged`事件; 必须使用`AddHandler`语句。</span><span class="sxs-lookup"><span data-stu-id="bea5c-488">You cannot use the `Handles` statement to handle the `NetworkAvailabilityChanged` event; you must use the `AddHandler` statement.</span></span>  
  
 <span data-ttu-id="bea5c-489">在 Windows 窗体应用程序中`MyApplication`对象将公开`NetworkAvailabilityChanged`事件提供相同的功能，为此事件，但你可以处理其与`Handles`语句。</span><span class="sxs-lookup"><span data-stu-id="bea5c-489">In Windows Forms applications, the `MyApplication` object exposes a `NetworkAvailabilityChanged` event that provides the same functionality as this event, but you can handle it with the `Handles` statement.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="bea5c-490">许多网络中心可提供网络连接，即使较大的网络断开连接的中心。</span><span class="sxs-lookup"><span data-stu-id="bea5c-490">Many network hubs provide a network connection, even if the hub is disconnected from a larger network.</span></span> <span data-ttu-id="bea5c-491">因此，对于有线连接，此事件指示计算机和中心之间的连接中的更改。</span><span class="sxs-lookup"><span data-stu-id="bea5c-491">Consequently, for wired connections, this event indicates a change in the connection between the computer and a hub.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="bea5c-492">`NetworkAvailabilityChanged`由 Windows 95 和 Windows 98 运行的应用程序或由非管理员身份运行 Windows 2000 的应用程序不会引发事件。</span><span class="sxs-lookup"><span data-stu-id="bea5c-492">The `NetworkAvailabilityChanged` event is not raised by applications that run on Windows 95 and Windows 98 or by applications that are run on Windows 2000 by a non-administrator.</span></span> <span data-ttu-id="bea5c-493">如果你的应用程序可能会在这些平台上运行，使用<xref:Microsoft.VisualBasic.Devices.Network.IsAvailable%2A>属性。</span><span class="sxs-lookup"><span data-stu-id="bea5c-493">If your application might run on those platforms, use the <xref:Microsoft.VisualBasic.Devices.Network.IsAvailable%2A> property.</span></span>  
  
   
  
## Examples  
 <span data-ttu-id="bea5c-494">此示例使用`My.Computer.Network.NetworkAvailabilityChanged`要更新的用户界面的窗体或控件的事件。</span><span class="sxs-lookup"><span data-stu-id="bea5c-494">This example uses the `My.Computer.Network.NetworkAvailabilityChanged` event to update the user interface of a form or control.</span></span>  
  
 <span data-ttu-id="bea5c-495">此代码应在窗体或控件具有<xref:System.Windows.Forms.Label>名为`Label1`。</span><span class="sxs-lookup"><span data-stu-id="bea5c-495">This code should to be in a form or control that has a <xref:System.Windows.Forms.Label> named `Label1`.</span></span>  
  
 [!code-vb[VbVbalrMyApplication#50](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbalrMyApplication/VB/Form1.vb#50)]  
  
 ]]></format>
        </remarks>
        <altmember cref="T:Microsoft.VisualBasic.Devices.Network" />
        <altmember cref="N:Microsoft.VisualBasic.Devices" />
        <altmember cref="T:Microsoft.VisualBasic.Devices.NetworkAvailableEventHandler" />
        <altmember cref="T:Microsoft.VisualBasic.Devices.NetworkAvailableEventArgs" />
      </Docs>
    </Member>
    <MemberGroup MemberName="Ping">
      <AssemblyInfo>
        <AssemblyName>Microsoft.VisualBasic</AssemblyName>
        <AssemblyVersion>10.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Docs>
        <summary>
          <span data-ttu-id="bea5c-496">Ping 指定的服务器。</span>
          <span class="sxs-lookup">
            <span data-stu-id="bea5c-496">Pings the specified server.</span>
          </span>
        </summary>
      </Docs>
    </MemberGroup>
    <Member MemberName="Ping">
      <MemberSignature Language="C#" Value="public bool Ping (string hostNameOrAddress);" />
      <MemberSignature Language="ILAsm" Value=".method public instance bool Ping(string hostNameOrAddress) cil managed" />
      <MemberSignature Language="DocId" Value="M:Microsoft.VisualBasic.Devices.Network.Ping(System.String)" />
      <MemberSignature Language="VB.NET" Value="Public Function Ping (hostNameOrAddress As String) As Boolean" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; bool Ping(System::String ^ hostNameOrAddress);" />
      <MemberSignature Language="F#" Value="member this.Ping : string -&gt; bool" Usage="network.Ping hostNameOrAddress" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>Microsoft.VisualBasic</AssemblyName>
        <AssemblyVersion>8.0.0.0</AssemblyVersion>
        <AssemblyVersion>10.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Attributes>
        <Attribute FrameworkAlternate="netframework-4.0">
          <AttributeName>System.Runtime.TargetedPatchingOptOut("Performance critical to inline this type of method across NGen image boundaries")</AttributeName>
        </Attribute>
      </Attributes>
      <ReturnValue>
        <ReturnType>System.Boolean</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="hostNameOrAddress" Type="System.String" />
      </Parameters>
      <Docs>
        <param name="hostNameOrAddress">
          <span data-ttu-id="bea5c-497">要对其执行 ping 操作的服务器的 URL、计算机名称或 IP 号。</span>
          <span class="sxs-lookup">
            <span data-stu-id="bea5c-497">The URL, computer name, or IP number of the server to ping.</span>
          </span>
        </param>
        <summary>
          <span data-ttu-id="bea5c-498">Ping 指定的服务器。</span>
          <span class="sxs-lookup">
            <span data-stu-id="bea5c-498">Pings the specified server.</span>
          </span>
        </summary>
        <returns>
          <span data-ttu-id="bea5c-499">如果操作已成功，则为 <see langword="True" />；否则为 <see langword="False" />。</span>
          <span class="sxs-lookup">
            <span data-stu-id="bea5c-499">
              <see langword="True" /> if the operation was successful; otherwise <see langword="False" />.</span>
          </span>
        </returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="bea5c-500">`Ping`方法不是防故障来确定远程计算机的可用性： 目标计算机上的 ping 端口可能已关闭或者 ping 请求可能会阻止通过防火墙或路由器。</span><span class="sxs-lookup"><span data-stu-id="bea5c-500">The `Ping` method is not a fail-safe method for determining the availability of a remote computer: the ping port on the target computer may be turned off or the ping request may be blocked by a firewall or router.</span></span>  
  
 <span data-ttu-id="bea5c-501">地址传递给`Ping`方法必须是可解析的 DNS，而且不能在加"http://"。</span><span class="sxs-lookup"><span data-stu-id="bea5c-501">The address passed to the `Ping` method must be DNS resolvable and cannot be preceded by "http://".</span></span>  
  
   
  
## Examples  
 <span data-ttu-id="bea5c-502">此示例报告是否可通过确定服务器执行 ping 操作是否`Ping`方法将返回`True`。</span><span class="sxs-lookup"><span data-stu-id="bea5c-502">This example reports whether or not the server can be pinged by determining whether the `Ping` method returns `True`.</span></span>  
  
 [!code-vb[VbVbalrMyNetwork#4](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbalrMyNetwork/VB/Class1.vb#4)]  
  
 <span data-ttu-id="bea5c-503">替换为`"198.01.01.01"`要成功进行 ping 操作的服务器的 IP 地址、 URL 或计算机名称。</span><span class="sxs-lookup"><span data-stu-id="bea5c-503">Replace `"198.01.01.01"` with the IP address, URL, or computer name of the server to ping.</span></span>  
  
 <span data-ttu-id="bea5c-504">此示例报告是否可通过确定服务器执行 ping 操作是否`Ping`方法返回`True`，并指定超时间隔设置为 1000年毫秒。</span><span class="sxs-lookup"><span data-stu-id="bea5c-504">This example reports whether or not the server can be pinged by determining whether the `Ping` method returned `True` and specifies a timeout interval of 1000 milliseconds.</span></span>  
  
 [!code-vb[VbVbalrMyNetwork#5](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbalrMyNetwork/VB/Class1.vb#5)]  
  
 <span data-ttu-id="bea5c-505">替换为`"www.cohowinery.com"`要成功进行 ping 操作的服务器的 IP 地址、 URL 或计算机名称。</span><span class="sxs-lookup"><span data-stu-id="bea5c-505">Replace `"www.cohowinery.com"` with the IP address, URL, or computer name of the server to ping.</span></span>  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.InvalidOperationException">
          <span data-ttu-id="bea5c-506">没有可用的网络连接。</span>
          <span class="sxs-lookup">
            <span data-stu-id="bea5c-506">No network connection is available.</span>
          </span>
        </exception>
        <exception cref="T:System.Net.NetworkInformation.PingException">
          <span data-ttu-id="bea5c-507">URL 无效。</span>
          <span class="sxs-lookup">
            <span data-stu-id="bea5c-507">URL was not valid.</span>
          </span>
        </exception>
        <permission cref="T:System.Security.Permissions.FileIOPermission">
          <span data-ttu-id="bea5c-508">控制文件和文件夹的访问权限。</span>
          <span class="sxs-lookup">
            <span data-stu-id="bea5c-508">Controls the ability to access files and folders.</span>
          </span>
          <span data-ttu-id="bea5c-509">关联枚举：<see cref="F:System.Security.Permissions.PermissionState.Unrestricted" />。</span>
          <span class="sxs-lookup">
            <span data-stu-id="bea5c-509">Associated enumeration: <see cref="F:System.Security.Permissions.PermissionState.Unrestricted" />.</span>
          </span>
        </permission>
        <permission cref="T:System.Security.Permissions.SecurityPermission">
          <span data-ttu-id="bea5c-510">描述一组应用于代码的安全权限。</span>
          <span class="sxs-lookup">
            <span data-stu-id="bea5c-510">Describes a set of security permissions applied to code.</span>
          </span>
          <span data-ttu-id="bea5c-511">关联枚举：<see cref="F:System.Security.Permissions.SecurityPermissionFlag.ControlPrincipal" />。</span>
          <span class="sxs-lookup">
            <span data-stu-id="bea5c-511">Associated enumeration: <see cref="F:System.Security.Permissions.SecurityPermissionFlag.ControlPrincipal" />.</span>
          </span>
        </permission>
        <permission cref="T:System.Net.WebPermission">
          <span data-ttu-id="bea5c-512">控制访问 HTTP Internet 资源的权限。</span>
          <span class="sxs-lookup">
            <span data-stu-id="bea5c-512">Controls rights to access HTTP Internet resources.</span>
          </span>
          <span data-ttu-id="bea5c-513">关联枚举：<see cref="F:System.Security.Permissions.PermissionState.Unrestricted" />。</span>
          <span class="sxs-lookup">
            <span data-stu-id="bea5c-513">Associated enumeration: <see cref="F:System.Security.Permissions.PermissionState.Unrestricted" />.</span>
          </span>
        </permission>
        <permission cref="T:System.Net.SocketPermission">
          <span data-ttu-id="bea5c-514">控制在传输地址上建立或接受连接的权利。</span>
          <span class="sxs-lookup">
            <span data-stu-id="bea5c-514">Controls rights to make or accept connections on a transport address.</span>
          </span>
          <span data-ttu-id="bea5c-515">关联枚举：<see cref="F:System.Security.Permissions.PermissionState.Unrestricted" />。</span>
          <span class="sxs-lookup">
            <span data-stu-id="bea5c-515">Associated enumeration: <see cref="F:System.Security.Permissions.PermissionState.Unrestricted" />.</span>
          </span>
        </permission>
        <permission cref="T:System.Diagnostics.PerformanceCounterPermission">
          <span data-ttu-id="bea5c-516">控制对 Windows NT 性能计数器组件访问。</span>
          <span class="sxs-lookup">
            <span data-stu-id="bea5c-516">Controls access to a Windows NT performance counter component.</span>
          </span>
          <span data-ttu-id="bea5c-517">关联枚举：<see cref="F:System.Security.Permissions.PermissionState.Unrestricted" />。</span>
          <span class="sxs-lookup">
            <span data-stu-id="bea5c-517">Associated enumeration: <see cref="F:System.Security.Permissions.PermissionState.Unrestricted" />.</span>
          </span>
        </permission>
        <permission cref="T:System.Net.NetworkInformation.NetworkInformationPermission">
          <span data-ttu-id="bea5c-518">控制对本地计算机的网络信息和通信统计信息的访问。</span>
          <span class="sxs-lookup">
            <span data-stu-id="bea5c-518">Controls access to network information and traffic statistics for the local computer.</span>
          </span>
          <span data-ttu-id="bea5c-519">关联枚举：<see cref="F:System.Net.NetworkInformation.NetworkInformationAccess.Ping" />。</span>
          <span class="sxs-lookup">
            <span data-stu-id="bea5c-519">Associated enumeration: <see cref="F:System.Net.NetworkInformation.NetworkInformationAccess.Ping" />.</span>
          </span>
        </permission>
        <altmember cref="T:System.Uri" />
      </Docs>
    </Member>
    <Member MemberName="Ping">
      <MemberSignature Language="C#" Value="public bool Ping (Uri address);" />
      <MemberSignature Language="ILAsm" Value=".method public instance bool Ping(class System.Uri address) cil managed" />
      <MemberSignature Language="DocId" Value="M:Microsoft.VisualBasic.Devices.Network.Ping(System.Uri)" />
      <MemberSignature Language="VB.NET" Value="Public Function Ping (address As Uri) As Boolean" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; bool Ping(Uri ^ address);" />
      <MemberSignature Language="F#" Value="member this.Ping : Uri -&gt; bool" Usage="network.Ping address" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>Microsoft.VisualBasic</AssemblyName>
        <AssemblyVersion>8.0.0.0</AssemblyVersion>
        <AssemblyVersion>10.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Boolean</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="address" Type="System.Uri" />
      </Parameters>
      <Docs>
        <param name="address">
          <span data-ttu-id="bea5c-520">要对其执行 ping 操作的服务器的 URI。</span>
          <span class="sxs-lookup">
            <span data-stu-id="bea5c-520">The URI of the server to ping.</span>
          </span>
        </param>
        <summary>
          <span data-ttu-id="bea5c-521">Ping 指定的服务器。</span>
          <span class="sxs-lookup">
            <span data-stu-id="bea5c-521">Pings the specified server.</span>
          </span>
        </summary>
        <returns>
          <span data-ttu-id="bea5c-522">如果操作已成功，则为 <see langword="True" />；否则为 <see langword="False" />。</span>
          <span class="sxs-lookup">
            <span data-stu-id="bea5c-522">
              <see langword="True" /> if the operation was successful; otherwise <see langword="False" />.</span>
          </span>
        </returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="bea5c-523">`Ping`方法不是防故障来确定远程计算机的可用性： 目标计算机上的 ping 端口可能已关闭或者 ping 请求可能会阻止通过防火墙或路由器。</span><span class="sxs-lookup"><span data-stu-id="bea5c-523">The `Ping` method is not a fail-safe method for determining the availability of a remote computer: the ping port on the target computer may be turned off or the ping request may be blocked by a firewall or router.</span></span>  
  
 <span data-ttu-id="bea5c-524">地址传递给`Ping`方法必须是可解析的 DNS，而且不能在加"http://"。</span><span class="sxs-lookup"><span data-stu-id="bea5c-524">The address passed to the `Ping` method must be DNS resolvable and cannot be preceded by "http://".</span></span>  
  
   
  
## Examples  
 <span data-ttu-id="bea5c-525">此示例报告是否可通过确定服务器执行 ping 操作是否`Ping`方法将返回`True`。</span><span class="sxs-lookup"><span data-stu-id="bea5c-525">This example reports whether or not the server can be pinged by determining whether the `Ping` method returns `True`.</span></span>  
  
 [!code-vb[VbVbalrMyNetwork#4](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbalrMyNetwork/VB/Class1.vb#4)]  
  
 <span data-ttu-id="bea5c-526">替换为`"198.01.01.01"`要成功进行 ping 操作的服务器的 IP 地址、 URL 或计算机名称。</span><span class="sxs-lookup"><span data-stu-id="bea5c-526">Replace `"198.01.01.01"` with the IP address, URL, or computer name of the server to ping.</span></span>  
  
 <span data-ttu-id="bea5c-527">此示例报告是否可通过确定服务器执行 ping 操作是否`Ping`方法返回`True`，并指定超时间隔设置为 1000年毫秒。</span><span class="sxs-lookup"><span data-stu-id="bea5c-527">This example reports whether or not the server can be pinged by determining whether the `Ping` method returned `True` and specifies a timeout interval of 1000 milliseconds.</span></span>  
  
 [!code-vb[VbVbalrMyNetwork#5](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbalrMyNetwork/VB/Class1.vb#5)]  
  
 <span data-ttu-id="bea5c-528">替换为`"www.cohowinery.com"`要成功进行 ping 操作的服务器的 IP 地址、 URL 或计算机名称。</span><span class="sxs-lookup"><span data-stu-id="bea5c-528">Replace `"www.cohowinery.com"` with the IP address, URL, or computer name of the server to ping.</span></span>  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.InvalidOperationException">
          <span data-ttu-id="bea5c-529">没有可用的网络连接。</span>
          <span class="sxs-lookup">
            <span data-stu-id="bea5c-529">No network connection is available.</span>
          </span>
        </exception>
        <exception cref="T:System.Net.NetworkInformation.PingException">
          <span data-ttu-id="bea5c-530">URL 无效。</span>
          <span class="sxs-lookup">
            <span data-stu-id="bea5c-530">URL was not valid.</span>
          </span>
        </exception>
        <permission cref="T:System.Security.Permissions.FileIOPermission">
          <span data-ttu-id="bea5c-531">控制文件和文件夹的访问权限。</span>
          <span class="sxs-lookup">
            <span data-stu-id="bea5c-531">Controls the ability to access files and folders.</span>
          </span>
          <span data-ttu-id="bea5c-532">关联枚举：<see cref="F:System.Security.Permissions.PermissionState.Unrestricted" />。</span>
          <span class="sxs-lookup">
            <span data-stu-id="bea5c-532">Associated enumeration: <see cref="F:System.Security.Permissions.PermissionState.Unrestricted" />.</span>
          </span>
        </permission>
        <permission cref="T:System.Security.Permissions.SecurityPermission">
          <span data-ttu-id="bea5c-533">描述一组应用于代码的安全权限。</span>
          <span class="sxs-lookup">
            <span data-stu-id="bea5c-533">Describes a set of security permissions applied to code.</span>
          </span>
          <span data-ttu-id="bea5c-534">关联枚举：<see cref="F:System.Security.Permissions.SecurityPermissionFlag.ControlPrincipal" />。</span>
          <span class="sxs-lookup">
            <span data-stu-id="bea5c-534">Associated enumeration: <see cref="F:System.Security.Permissions.SecurityPermissionFlag.ControlPrincipal" />.</span>
          </span>
        </permission>
        <permission cref="T:System.Net.WebPermission">
          <span data-ttu-id="bea5c-535">控制访问 HTTP Internet 资源的权限。</span>
          <span class="sxs-lookup">
            <span data-stu-id="bea5c-535">Controls rights to access HTTP Internet resources.</span>
          </span>
          <span data-ttu-id="bea5c-536">关联枚举：<see cref="F:System.Security.Permissions.PermissionState.Unrestricted" />。</span>
          <span class="sxs-lookup">
            <span data-stu-id="bea5c-536">Associated enumeration: <see cref="F:System.Security.Permissions.PermissionState.Unrestricted" />.</span>
          </span>
        </permission>
        <permission cref="T:System.Net.SocketPermission">
          <span data-ttu-id="bea5c-537">控制在传输地址上建立或接受连接的权利。</span>
          <span class="sxs-lookup">
            <span data-stu-id="bea5c-537">Controls rights to make or accept connections on a transport address.</span>
          </span>
          <span data-ttu-id="bea5c-538">关联枚举：<see cref="F:System.Security.Permissions.PermissionState.Unrestricted" />。</span>
          <span class="sxs-lookup">
            <span data-stu-id="bea5c-538">Associated enumeration: <see cref="F:System.Security.Permissions.PermissionState.Unrestricted" />.</span>
          </span>
        </permission>
        <permission cref="T:System.Diagnostics.PerformanceCounterPermission">
          <span data-ttu-id="bea5c-539">控制对 Windows NT 性能计数器组件访问。</span>
          <span class="sxs-lookup">
            <span data-stu-id="bea5c-539">Controls access to a Windows NT performance counter component.</span>
          </span>
          <span data-ttu-id="bea5c-540">关联枚举：<see cref="F:System.Security.Permissions.PermissionState.Unrestricted" />。</span>
          <span class="sxs-lookup">
            <span data-stu-id="bea5c-540">Associated enumeration: <see cref="F:System.Security.Permissions.PermissionState.Unrestricted" />.</span>
          </span>
        </permission>
        <permission cref="T:System.Net.NetworkInformation.NetworkInformationPermission">
          <span data-ttu-id="bea5c-541">控制对本地计算机的网络信息和通信统计信息的访问。</span>
          <span class="sxs-lookup">
            <span data-stu-id="bea5c-541">Controls access to network information and traffic statistics for the local computer.</span>
          </span>
          <span data-ttu-id="bea5c-542">关联枚举：<see cref="F:System.Net.NetworkInformation.NetworkInformationAccess.Ping" />。</span>
          <span class="sxs-lookup">
            <span data-stu-id="bea5c-542">Associated enumeration: <see cref="F:System.Net.NetworkInformation.NetworkInformationAccess.Ping" />.</span>
          </span>
        </permission>
        <altmember cref="T:System.Uri" />
      </Docs>
    </Member>
    <Member MemberName="Ping">
      <MemberSignature Language="C#" Value="public bool Ping (string hostNameOrAddress, int timeout);" />
      <MemberSignature Language="ILAsm" Value=".method public instance bool Ping(string hostNameOrAddress, int32 timeout) cil managed" />
      <MemberSignature Language="DocId" Value="M:Microsoft.VisualBasic.Devices.Network.Ping(System.String,System.Int32)" />
      <MemberSignature Language="VB.NET" Value="Public Function Ping (hostNameOrAddress As String, timeout As Integer) As Boolean" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; bool Ping(System::String ^ hostNameOrAddress, int timeout);" />
      <MemberSignature Language="F#" Value="member this.Ping : string * int -&gt; bool" Usage="network.Ping (hostNameOrAddress, timeout)" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>Microsoft.VisualBasic</AssemblyName>
        <AssemblyVersion>8.0.0.0</AssemblyVersion>
        <AssemblyVersion>10.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Boolean</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="hostNameOrAddress" Type="System.String" />
        <Parameter Name="timeout" Type="System.Int32" />
      </Parameters>
      <Docs>
        <param name="hostNameOrAddress">
          <span data-ttu-id="bea5c-543">要对其执行 ping 操作的服务器的 URL、计算机名称或 IP 号。</span>
          <span class="sxs-lookup">
            <span data-stu-id="bea5c-543">The URL, computer name, or IP number of the server to ping.</span>
          </span>
        </param>
        <param name="timeout">
          <span data-ttu-id="bea5c-544">用于联系目标的时间阈值（以毫秒为单位）。</span>
          <span class="sxs-lookup">
            <span data-stu-id="bea5c-544">Time threshold in milliseconds for contacting the destination.</span>
          </span>
          <span data-ttu-id="bea5c-545">默认值为 500。</span>
          <span class="sxs-lookup">
            <span data-stu-id="bea5c-545">Default is 500.</span>
          </span>
        </param>
        <summary>
          <span data-ttu-id="bea5c-546">Ping 指定的服务器。</span>
          <span class="sxs-lookup">
            <span data-stu-id="bea5c-546">Pings the specified server.</span>
          </span>
        </summary>
        <returns>
          <span data-ttu-id="bea5c-547">如果操作已成功，则为 <see langword="True" />；否则为 <see langword="False" />。</span>
          <span class="sxs-lookup">
            <span data-stu-id="bea5c-547">
              <see langword="True" /> if the operation was successful; otherwise <see langword="False" />.</span>
          </span>
        </returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="bea5c-548">`Ping`方法不是防故障来确定远程计算机的可用性： 目标计算机上的 ping 端口可能已关闭或者 ping 请求可能会阻止通过防火墙或路由器。</span><span class="sxs-lookup"><span data-stu-id="bea5c-548">The `Ping` method is not a fail-safe method for determining the availability of a remote computer: the ping port on the target computer may be turned off or the ping request may be blocked by a firewall or router.</span></span>  
  
 <span data-ttu-id="bea5c-549">地址传递给`Ping`方法必须是可解析的 DNS，而且不能在加"http://"。</span><span class="sxs-lookup"><span data-stu-id="bea5c-549">The address passed to the `Ping` method must be DNS resolvable and cannot be preceded by "http://".</span></span>  
  
   
  
## Examples  
 <span data-ttu-id="bea5c-550">此示例报告是否可通过确定服务器执行 ping 操作是否`Ping`方法将返回`True`。</span><span class="sxs-lookup"><span data-stu-id="bea5c-550">This example reports whether or not the server can be pinged by determining whether the `Ping` method returns `True`.</span></span>  
  
 [!code-vb[VbVbalrMyNetwork#4](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbalrMyNetwork/VB/Class1.vb#4)]  
  
 <span data-ttu-id="bea5c-551">替换为`"198.01.01.01"`要成功进行 ping 操作的服务器的 IP 地址、 URL 或计算机名称。</span><span class="sxs-lookup"><span data-stu-id="bea5c-551">Replace `"198.01.01.01"` with the IP address, URL, or computer name of the server to ping.</span></span>  
  
 <span data-ttu-id="bea5c-552">此示例报告是否可通过确定服务器执行 ping 操作是否`Ping`方法返回`True`，并指定超时间隔设置为 1000年毫秒。</span><span class="sxs-lookup"><span data-stu-id="bea5c-552">This example reports whether or not the server can be pinged by determining whether the `Ping` method returned `True` and specifies a timeout interval of 1000 milliseconds.</span></span>  
  
 [!code-vb[VbVbalrMyNetwork#5](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbalrMyNetwork/VB/Class1.vb#5)]  
  
 <span data-ttu-id="bea5c-553">替换为`"www.cohowinery.com"`要成功进行 ping 操作的服务器的 IP 地址、 URL 或计算机名称。</span><span class="sxs-lookup"><span data-stu-id="bea5c-553">Replace `"www.cohowinery.com"` with the IP address, URL, or computer name of the server to ping.</span></span>  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.InvalidOperationException">
          <span data-ttu-id="bea5c-554">没有可用的网络连接。</span>
          <span class="sxs-lookup">
            <span data-stu-id="bea5c-554">No network connection is available.</span>
          </span>
        </exception>
        <exception cref="T:System.Net.NetworkInformation.PingException">
          <span data-ttu-id="bea5c-555">URL 无效。</span>
          <span class="sxs-lookup">
            <span data-stu-id="bea5c-555">URL was not valid.</span>
          </span>
        </exception>
        <permission cref="T:System.Security.Permissions.FileIOPermission">
          <span data-ttu-id="bea5c-556">控制文件和文件夹的访问权限。</span>
          <span class="sxs-lookup">
            <span data-stu-id="bea5c-556">Controls the ability to access files and folders.</span>
          </span>
          <span data-ttu-id="bea5c-557">关联枚举：<see cref="F:System.Security.Permissions.PermissionState.Unrestricted" />。</span>
          <span class="sxs-lookup">
            <span data-stu-id="bea5c-557">Associated enumeration: <see cref="F:System.Security.Permissions.PermissionState.Unrestricted" />.</span>
          </span>
        </permission>
        <permission cref="T:System.Security.Permissions.SecurityPermission">
          <span data-ttu-id="bea5c-558">描述一组应用于代码的安全权限。</span>
          <span class="sxs-lookup">
            <span data-stu-id="bea5c-558">Describes a set of security permissions applied to code.</span>
          </span>
          <span data-ttu-id="bea5c-559">关联枚举：<see cref="F:System.Security.Permissions.SecurityPermissionFlag.ControlPrincipal" />。</span>
          <span class="sxs-lookup">
            <span data-stu-id="bea5c-559">Associated enumeration: <see cref="F:System.Security.Permissions.SecurityPermissionFlag.ControlPrincipal" />.</span>
          </span>
        </permission>
        <permission cref="T:System.Net.WebPermission">
          <span data-ttu-id="bea5c-560">控制访问 HTTP Internet 资源的权限。</span>
          <span class="sxs-lookup">
            <span data-stu-id="bea5c-560">Controls rights to access HTTP Internet resources.</span>
          </span>
          <span data-ttu-id="bea5c-561">关联枚举：<see cref="F:System.Security.Permissions.PermissionState.Unrestricted" />。</span>
          <span class="sxs-lookup">
            <span data-stu-id="bea5c-561">Associated enumeration: <see cref="F:System.Security.Permissions.PermissionState.Unrestricted" />.</span>
          </span>
        </permission>
        <permission cref="T:System.Net.SocketPermission">
          <span data-ttu-id="bea5c-562">控制在传输地址上建立或接受连接的权利。</span>
          <span class="sxs-lookup">
            <span data-stu-id="bea5c-562">Controls rights to make or accept connections on a transport address.</span>
          </span>
          <span data-ttu-id="bea5c-563">关联枚举：<see cref="F:System.Security.Permissions.PermissionState.Unrestricted" />。</span>
          <span class="sxs-lookup">
            <span data-stu-id="bea5c-563">Associated enumeration: <see cref="F:System.Security.Permissions.PermissionState.Unrestricted" />.</span>
          </span>
        </permission>
        <permission cref="T:System.Diagnostics.PerformanceCounterPermission">
          <span data-ttu-id="bea5c-564">控制对 Windows NT 性能计数器组件访问。</span>
          <span class="sxs-lookup">
            <span data-stu-id="bea5c-564">Controls access to a Windows NT performance counter component.</span>
          </span>
          <span data-ttu-id="bea5c-565">关联枚举：<see cref="F:System.Security.Permissions.PermissionState.Unrestricted" />。</span>
          <span class="sxs-lookup">
            <span data-stu-id="bea5c-565">Associated enumeration: <see cref="F:System.Security.Permissions.PermissionState.Unrestricted" />.</span>
          </span>
        </permission>
        <permission cref="T:System.Net.NetworkInformation.NetworkInformationPermission">
          <span data-ttu-id="bea5c-566">控制对本地计算机的网络信息和通信统计信息的访问。</span>
          <span class="sxs-lookup">
            <span data-stu-id="bea5c-566">Controls access to network information and traffic statistics for the local computer.</span>
          </span>
          <span data-ttu-id="bea5c-567">关联枚举：<see cref="F:System.Net.NetworkInformation.NetworkInformationAccess.Ping" />。</span>
          <span class="sxs-lookup">
            <span data-stu-id="bea5c-567">Associated enumeration: <see cref="F:System.Net.NetworkInformation.NetworkInformationAccess.Ping" />.</span>
          </span>
        </permission>
        <altmember cref="T:System.Uri" />
      </Docs>
    </Member>
    <Member MemberName="Ping">
      <MemberSignature Language="C#" Value="public bool Ping (Uri address, int timeout);" />
      <MemberSignature Language="ILAsm" Value=".method public instance bool Ping(class System.Uri address, int32 timeout) cil managed" />
      <MemberSignature Language="DocId" Value="M:Microsoft.VisualBasic.Devices.Network.Ping(System.Uri,System.Int32)" />
      <MemberSignature Language="VB.NET" Value="Public Function Ping (address As Uri, timeout As Integer) As Boolean" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; bool Ping(Uri ^ address, int timeout);" />
      <MemberSignature Language="F#" Value="member this.Ping : Uri * int -&gt; bool" Usage="network.Ping (address, timeout)" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>Microsoft.VisualBasic</AssemblyName>
        <AssemblyVersion>8.0.0.0</AssemblyVersion>
        <AssemblyVersion>10.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Boolean</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="address" Type="System.Uri" />
        <Parameter Name="timeout" Type="System.Int32" />
      </Parameters>
      <Docs>
        <param name="address">
          <span data-ttu-id="bea5c-568">要对其执行 ping 操作的服务器的 URI。</span>
          <span class="sxs-lookup">
            <span data-stu-id="bea5c-568">The URI of the server to ping.</span>
          </span>
        </param>
        <param name="timeout">
          <span data-ttu-id="bea5c-569">用于联系目标的时间阈值（以毫秒为单位）。</span>
          <span class="sxs-lookup">
            <span data-stu-id="bea5c-569">Time threshold in milliseconds for contacting the destination.</span>
          </span>
          <span data-ttu-id="bea5c-570">默认值为 500。</span>
          <span class="sxs-lookup">
            <span data-stu-id="bea5c-570">Default is 500.</span>
          </span>
        </param>
        <summary>
          <span data-ttu-id="bea5c-571">Ping 指定的服务器。</span>
          <span class="sxs-lookup">
            <span data-stu-id="bea5c-571">Pings the specified server.</span>
          </span>
        </summary>
        <returns>
          <span data-ttu-id="bea5c-572">如果操作已成功，则为 <see langword="True" />；否则为 <see langword="False" />。</span>
          <span class="sxs-lookup">
            <span data-stu-id="bea5c-572">
              <see langword="True" /> if the operation was successful; otherwise <see langword="False" />.</span>
          </span>
        </returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="bea5c-573">`Ping`方法不是防故障来确定远程计算机的可用性： 目标计算机上的 ping 端口可能已关闭或者 ping 请求可能会阻止通过防火墙或路由器。</span><span class="sxs-lookup"><span data-stu-id="bea5c-573">The `Ping` method is not a fail-safe method for determining the availability of a remote computer: the ping port on the target computer may be turned off or the ping request may be blocked by a firewall or router.</span></span>  
  
 <span data-ttu-id="bea5c-574">地址传递给`Ping`方法必须是可解析的 DNS，而且不能在加"http://"。</span><span class="sxs-lookup"><span data-stu-id="bea5c-574">The address passed to the `Ping` method must be DNS resolvable and cannot be preceded by "http://".</span></span>  
  
   
  
## Examples  
 <span data-ttu-id="bea5c-575">此示例报告是否可通过确定服务器执行 ping 操作是否`Ping`方法将返回`True`。</span><span class="sxs-lookup"><span data-stu-id="bea5c-575">This example reports whether or not the server can be pinged by determining whether the `Ping` method returns `True`.</span></span>  
  
 [!code-vb[VbVbalrMyNetwork#4](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbalrMyNetwork/VB/Class1.vb#4)]  
  
 <span data-ttu-id="bea5c-576">替换为`"198.01.01.01"`要成功进行 ping 操作的服务器的 IP 地址、 URL 或计算机名称。</span><span class="sxs-lookup"><span data-stu-id="bea5c-576">Replace `"198.01.01.01"` with the IP address, URL, or computer name of the server to ping.</span></span>  
  
 <span data-ttu-id="bea5c-577">此示例报告是否可通过确定服务器执行 ping 操作是否`Ping`方法返回`True`，并指定超时间隔设置为 1000年毫秒。</span><span class="sxs-lookup"><span data-stu-id="bea5c-577">This example reports whether or not the server can be pinged by determining whether the `Ping` method returned `True` and specifies a timeout interval of 1000 milliseconds.</span></span>  
  
 [!code-vb[VbVbalrMyNetwork#5](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbalrMyNetwork/VB/Class1.vb#5)]  
  
 <span data-ttu-id="bea5c-578">替换为`"www.cohowinery.com"`要成功进行 ping 操作的服务器的 IP 地址、 URL 或计算机名称。</span><span class="sxs-lookup"><span data-stu-id="bea5c-578">Replace `"www.cohowinery.com"` with the IP address, URL, or computer name of the server to ping.</span></span>  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.InvalidOperationException">
          <span data-ttu-id="bea5c-579">没有可用的网络连接。</span>
          <span class="sxs-lookup">
            <span data-stu-id="bea5c-579">No network connection is available.</span>
          </span>
        </exception>
        <exception cref="T:System.Net.NetworkInformation.PingException">
          <span data-ttu-id="bea5c-580">URL 无效。</span>
          <span class="sxs-lookup">
            <span data-stu-id="bea5c-580">URL was not valid.</span>
          </span>
        </exception>
        <permission cref="T:System.Security.Permissions.FileIOPermission">
          <span data-ttu-id="bea5c-581">控制文件和文件夹的访问权限。</span>
          <span class="sxs-lookup">
            <span data-stu-id="bea5c-581">Controls the ability to access files and folders.</span>
          </span>
          <span data-ttu-id="bea5c-582">关联枚举：<see cref="F:System.Security.Permissions.PermissionState.Unrestricted" />。</span>
          <span class="sxs-lookup">
            <span data-stu-id="bea5c-582">Associated enumeration: <see cref="F:System.Security.Permissions.PermissionState.Unrestricted" />.</span>
          </span>
        </permission>
        <permission cref="T:System.Security.Permissions.SecurityPermission">
          <span data-ttu-id="bea5c-583">描述一组应用于代码的安全权限。</span>
          <span class="sxs-lookup">
            <span data-stu-id="bea5c-583">Describes a set of security permissions applied to code.</span>
          </span>
          <span data-ttu-id="bea5c-584">关联枚举：<see cref="F:System.Security.Permissions.SecurityPermissionFlag.ControlPrincipal" />。</span>
          <span class="sxs-lookup">
            <span data-stu-id="bea5c-584">Associated enumeration: <see cref="F:System.Security.Permissions.SecurityPermissionFlag.ControlPrincipal" />.</span>
          </span>
        </permission>
        <permission cref="T:System.Net.WebPermission">
          <span data-ttu-id="bea5c-585">控制访问 HTTP Internet 资源的权限。</span>
          <span class="sxs-lookup">
            <span data-stu-id="bea5c-585">Controls rights to access HTTP Internet resources.</span>
          </span>
          <span data-ttu-id="bea5c-586">关联枚举：<see cref="F:System.Security.Permissions.PermissionState.Unrestricted" />。</span>
          <span class="sxs-lookup">
            <span data-stu-id="bea5c-586">Associated enumeration: <see cref="F:System.Security.Permissions.PermissionState.Unrestricted" />.</span>
          </span>
        </permission>
        <permission cref="T:System.Net.SocketPermission">
          <span data-ttu-id="bea5c-587">控制在传输地址上建立或接受连接的权利。</span>
          <span class="sxs-lookup">
            <span data-stu-id="bea5c-587">Controls rights to make or accept connections on a transport address.</span>
          </span>
          <span data-ttu-id="bea5c-588">关联枚举：<see cref="F:System.Security.Permissions.PermissionState.Unrestricted" />。</span>
          <span class="sxs-lookup">
            <span data-stu-id="bea5c-588">Associated enumeration: <see cref="F:System.Security.Permissions.PermissionState.Unrestricted" />.</span>
          </span>
        </permission>
        <permission cref="T:System.Diagnostics.PerformanceCounterPermission">
          <span data-ttu-id="bea5c-589">控制对 Windows NT 性能计数器组件访问。</span>
          <span class="sxs-lookup">
            <span data-stu-id="bea5c-589">Controls access to a Windows NT performance counter component.</span>
          </span>
          <span data-ttu-id="bea5c-590">关联枚举：<see cref="F:System.Security.Permissions.PermissionState.Unrestricted" />。</span>
          <span class="sxs-lookup">
            <span data-stu-id="bea5c-590">Associated enumeration: <see cref="F:System.Security.Permissions.PermissionState.Unrestricted" />.</span>
          </span>
        </permission>
        <permission cref="T:System.Net.NetworkInformation.NetworkInformationPermission">
          <span data-ttu-id="bea5c-591">控制对本地计算机的网络信息和通信统计信息的访问。</span>
          <span class="sxs-lookup">
            <span data-stu-id="bea5c-591">Controls access to network information and traffic statistics for the local computer.</span>
          </span>
          <span data-ttu-id="bea5c-592">关联枚举：<see cref="F:System.Net.NetworkInformation.NetworkInformationAccess.Ping" />。</span>
          <span class="sxs-lookup">
            <span data-stu-id="bea5c-592">Associated enumeration: <see cref="F:System.Net.NetworkInformation.NetworkInformationAccess.Ping" />.</span>
          </span>
        </permission>
        <altmember cref="T:System.Uri" />
      </Docs>
    </Member>
    <MemberGroup MemberName="UploadFile">
      <AssemblyInfo>
        <AssemblyName>Microsoft.VisualBasic</AssemblyName>
        <AssemblyVersion>10.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Docs>
        <summary>
          <span data-ttu-id="bea5c-593">将指定的文件发送到指定的主机地址。</span>
          <span class="sxs-lookup">
            <span data-stu-id="bea5c-593">Sends the specified file to the specified host address.</span>
          </span>
        </summary>
      </Docs>
    </MemberGroup>
    <Member MemberName="UploadFile">
      <MemberSignature Language="C#" Value="public void UploadFile (string sourceFileName, string address);" />
      <MemberSignature Language="ILAsm" Value=".method public instance void UploadFile(string sourceFileName, string address) cil managed" />
      <MemberSignature Language="DocId" Value="M:Microsoft.VisualBasic.Devices.Network.UploadFile(System.String,System.String)" />
      <MemberSignature Language="VB.NET" Value="Public Sub UploadFile (sourceFileName As String, address As String)" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; void UploadFile(System::String ^ sourceFileName, System::String ^ address);" />
      <MemberSignature Language="F#" Value="member this.UploadFile : string * string -&gt; unit" Usage="network.UploadFile (sourceFileName, address)" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>Microsoft.VisualBasic</AssemblyName>
        <AssemblyVersion>8.0.0.0</AssemblyVersion>
        <AssemblyVersion>10.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Attributes>
        <Attribute FrameworkAlternate="netframework-4.0">
          <AttributeName>System.Runtime.TargetedPatchingOptOut("Performance critical to inline this type of method across NGen image boundaries")</AttributeName>
        </Attribute>
      </Attributes>
      <ReturnValue>
        <ReturnType>System.Void</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="sourceFileName" Type="System.String" />
        <Parameter Name="address" Type="System.String" />
      </Parameters>
      <Docs>
        <param name="sourceFileName">
          <span data-ttu-id="bea5c-594">要上载的文件的路径和名称。</span>
          <span class="sxs-lookup">
            <span data-stu-id="bea5c-594">Path and name of file to upload.</span>
          </span>
        </param>
        <param name="address">
          <span data-ttu-id="bea5c-595">目标服务器的 URL、IP 地址或 URI。</span>
          <span class="sxs-lookup">
            <span data-stu-id="bea5c-595">URL, IP address, or URI of destination server.</span>
          </span>
        </param>
        <summary>
          <span data-ttu-id="bea5c-596">将指定的文件发送到指定的主机地址。</span>
          <span class="sxs-lookup">
            <span data-stu-id="bea5c-596">Sends the specified file to the specified host address.</span>
          </span>
        </summary>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="bea5c-597">可以使用的其他重载之一<xref:Microsoft.VisualBasic.Devices.Network.UploadFile%2A>方法以提供用户凭据或指定特定的超时值。</span><span class="sxs-lookup"><span data-stu-id="bea5c-597">You can use one of the other overloads of the <xref:Microsoft.VisualBasic.Devices.Network.UploadFile%2A> method to provide user credentials or specify a specific timeout value.</span></span>  
  
 <span data-ttu-id="bea5c-598">`My.Computer.Network.UploadFile` 在应用程序中启用网络跟踪后，跟踪信息输出。</span><span class="sxs-lookup"><span data-stu-id="bea5c-598">`My.Computer.Network.UploadFile` outputs trace information when you enable network tracing in your application.</span></span> <span data-ttu-id="bea5c-599">有关详细信息，请参阅[启用网络跟踪](~/docs/framework/network-programming/enabling-network-tracing.md)。</span><span class="sxs-lookup"><span data-stu-id="bea5c-599">For more information, see [Enabling Network Tracing](~/docs/framework/network-programming/enabling-network-tracing.md).</span></span>  
  
 <span data-ttu-id="bea5c-600">下表列出的任务涉及示例`My.Computer.Network.UploadFile`方法。</span><span class="sxs-lookup"><span data-stu-id="bea5c-600">The following table lists an example of a task involving the `My.Computer.Network.UploadFile` method.</span></span>  
  
|<span data-ttu-id="bea5c-601">到</span><span class="sxs-lookup"><span data-stu-id="bea5c-601">To</span></span>|<span data-ttu-id="bea5c-602">查看</span><span class="sxs-lookup"><span data-stu-id="bea5c-602">See</span></span>|  
|-|-|  
|<span data-ttu-id="bea5c-603">上传文件</span><span class="sxs-lookup"><span data-stu-id="bea5c-603">Upload a file</span></span>|[<span data-ttu-id="bea5c-604">如何：上载文件</span><span class="sxs-lookup"><span data-stu-id="bea5c-604">How to: Upload a File</span></span>](~/docs/visual-basic/developing-apps/programming/computer-resources/how-to-upload-a-file.md)|  
  
   
  
## Examples  
 <span data-ttu-id="bea5c-605">此示例将文件上传`Order.txt`到`http://www.cohowinery.com/uploads`。</span><span class="sxs-lookup"><span data-stu-id="bea5c-605">This example uploads the file `Order.txt` to `http://www.cohowinery.com/uploads`.</span></span>  
  
 [!code-vb[VbVbalrMyNetwork#2](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbalrMyNetwork/VB/Class1.vb#2)]  
  
 <span data-ttu-id="bea5c-606">此示例在不提供用户名或密码的情况下将文件 `Order.txt` 上传到 `http://www.cohowinery.com/uploads`显示了上传操作的进度，并将将超时间隔为 500 毫秒。</span><span class="sxs-lookup"><span data-stu-id="bea5c-606">This example uploads the file `Order.txt` to `http://www.cohowinery.com/uploads` without supplying a user name or password, shows the progress of the upload, and has a time-out interval of 500 milliseconds.</span></span>  
  
 [!code-vb[VbVbalrMyNetwork#3](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbalrMyNetwork/VB/Class1.vb#3)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentException">
          <span data-ttu-id="bea5c-607">源文件路径无效。</span>
          <span class="sxs-lookup">
            <span data-stu-id="bea5c-607">The source file path is not valid.</span>
          </span>
        </exception>
        <exception cref="T:System.InvalidOperationException">
          <span data-ttu-id="bea5c-608">
            <paramref name="address" />不包括文件名。</span>
          <span class="sxs-lookup">
            <span data-stu-id="bea5c-608">
              <paramref name="address" /> does not include a file name.</span>
          </span>
        </exception>
        <exception cref="T:System.Security.SecurityException">
          <span data-ttu-id="bea5c-609">用户缺少必要的权限，无法执行网络操作。</span>
          <span class="sxs-lookup">
            <span data-stu-id="bea5c-609">User lacks necessary permissions to perform a network operation.</span>
          </span>
        </exception>
        <exception cref="T:System.TimeoutException">
          <span data-ttu-id="bea5c-610">服务器没有在指定的默认超时（100 秒）内响应。</span>
          <span class="sxs-lookup">
            <span data-stu-id="bea5c-610">The server does not respond within the default timeout (100 seconds).</span>
          </span>
        </exception>
        <exception cref="T:System.Net.WebException">
          <span data-ttu-id="bea5c-611">请求被目标 Web 服务器拒绝。</span>
          <span class="sxs-lookup">
            <span data-stu-id="bea5c-611">The request is denied by the target web server.</span>
          </span>
        </exception>
        <permission cref="T:System.Security.Permissions.FileIOPermission">
          <span data-ttu-id="bea5c-612">控制文件和文件夹的访问权限。</span>
          <span class="sxs-lookup">
            <span data-stu-id="bea5c-612">Controls the ability to access files and folders.</span>
          </span>
          <span data-ttu-id="bea5c-613">关联枚举：<see cref="F:System.Security.Permissions.PermissionState.Unrestricted" />。</span>
          <span class="sxs-lookup">
            <span data-stu-id="bea5c-613">Associated enumeration: <see cref="F:System.Security.Permissions.PermissionState.Unrestricted" />.</span>
          </span>
        </permission>
        <permission cref="T:System.Net.WebPermission">
          <span data-ttu-id="bea5c-614">控制访问 HTTP Internet 资源的权限。</span>
          <span class="sxs-lookup">
            <span data-stu-id="bea5c-614">Controls rights to access HTTP Internet resources.</span>
          </span>
          <span data-ttu-id="bea5c-615">关联枚举：<see cref="F:System.Security.Permissions.PermissionState.Unrestricted" />。</span>
          <span class="sxs-lookup">
            <span data-stu-id="bea5c-615">Associated enumeration: <see cref="F:System.Security.Permissions.PermissionState.Unrestricted" />.</span>
          </span>
        </permission>
        <altmember cref="T:System.Uri" />
        <altmember cref="T:System.Net.ICredentials" />
        <altmember cref="T:Microsoft.VisualBasic.FileIO.UICancelOption" />
      </Docs>
    </Member>
    <Member MemberName="UploadFile">
      <MemberSignature Language="C#" Value="public void UploadFile (string sourceFileName, Uri address);" />
      <MemberSignature Language="ILAsm" Value=".method public instance void UploadFile(string sourceFileName, class System.Uri address) cil managed" />
      <MemberSignature Language="DocId" Value="M:Microsoft.VisualBasic.Devices.Network.UploadFile(System.String,System.Uri)" />
      <MemberSignature Language="VB.NET" Value="Public Sub UploadFile (sourceFileName As String, address As Uri)" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; void UploadFile(System::String ^ sourceFileName, Uri ^ address);" />
      <MemberSignature Language="F#" Value="member this.UploadFile : string * Uri -&gt; unit" Usage="network.UploadFile (sourceFileName, address)" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>Microsoft.VisualBasic</AssemblyName>
        <AssemblyVersion>8.0.0.0</AssemblyVersion>
        <AssemblyVersion>10.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Attributes>
        <Attribute FrameworkAlternate="netframework-4.0">
          <AttributeName>System.Runtime.TargetedPatchingOptOut("Performance critical to inline this type of method across NGen image boundaries")</AttributeName>
        </Attribute>
      </Attributes>
      <ReturnValue>
        <ReturnType>System.Void</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="sourceFileName" Type="System.String" />
        <Parameter Name="address" Type="System.Uri" />
      </Parameters>
      <Docs>
        <param name="sourceFileName">
          <span data-ttu-id="bea5c-616">要上载的文件的路径和名称。</span>
          <span class="sxs-lookup">
            <span data-stu-id="bea5c-616">Path and name of file to upload.</span>
          </span>
        </param>
        <param name="address">
          <span data-ttu-id="bea5c-617">目标服务器的 URL、IP 地址或 URI。</span>
          <span class="sxs-lookup">
            <span data-stu-id="bea5c-617">URL, IP address, or URI of destination server.</span>
          </span>
        </param>
        <summary>
          <span data-ttu-id="bea5c-618">将指定的文件发送到指定的主机地址。</span>
          <span class="sxs-lookup">
            <span data-stu-id="bea5c-618">Sends the specified file to the specified host address.</span>
          </span>
        </summary>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="bea5c-619">可以使用的其他重载之一<xref:Microsoft.VisualBasic.Devices.Network.UploadFile%2A>方法以提供用户凭据或指定特定的超时值。</span><span class="sxs-lookup"><span data-stu-id="bea5c-619">You can use one of the other overloads of the <xref:Microsoft.VisualBasic.Devices.Network.UploadFile%2A> method to provide user credentials or specify a specific timeout value.</span></span>  
  
 <span data-ttu-id="bea5c-620">`My.Computer.Network.UploadFile` 在应用程序中启用网络跟踪后，跟踪信息输出。</span><span class="sxs-lookup"><span data-stu-id="bea5c-620">`My.Computer.Network.UploadFile` outputs trace information when you enable network tracing in your application.</span></span> <span data-ttu-id="bea5c-621">有关详细信息，请参阅[启用网络跟踪](~/docs/framework/network-programming/enabling-network-tracing.md)。</span><span class="sxs-lookup"><span data-stu-id="bea5c-621">For more information, see [Enabling Network Tracing](~/docs/framework/network-programming/enabling-network-tracing.md).</span></span>  
  
 <span data-ttu-id="bea5c-622">下表列出的任务涉及示例`My.Computer.Network.UploadFile`方法。</span><span class="sxs-lookup"><span data-stu-id="bea5c-622">The following table lists an example of a task involving the `My.Computer.Network.UploadFile` method.</span></span>  
  
|<span data-ttu-id="bea5c-623">到</span><span class="sxs-lookup"><span data-stu-id="bea5c-623">To</span></span>|<span data-ttu-id="bea5c-624">查看</span><span class="sxs-lookup"><span data-stu-id="bea5c-624">See</span></span>|  
|-|-|  
|<span data-ttu-id="bea5c-625">上传文件</span><span class="sxs-lookup"><span data-stu-id="bea5c-625">Upload a file</span></span>|[<span data-ttu-id="bea5c-626">如何：上载文件</span><span class="sxs-lookup"><span data-stu-id="bea5c-626">How to: Upload a File</span></span>](~/docs/visual-basic/developing-apps/programming/computer-resources/how-to-upload-a-file.md)|  
  
   
  
## Examples  
 <span data-ttu-id="bea5c-627">此示例将文件上传`Order.txt`到`http://www.cohowinery.com/uploads`。</span><span class="sxs-lookup"><span data-stu-id="bea5c-627">This example uploads the file `Order.txt` to `http://www.cohowinery.com/uploads`.</span></span>  
  
 [!code-vb[VbVbalrMyNetwork#2](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbalrMyNetwork/VB/Class1.vb#2)]  
  
 <span data-ttu-id="bea5c-628">此示例在不提供用户名或密码的情况下将文件 `Order.txt` 上传到 `http://www.cohowinery.com/uploads`显示了上传操作的进度，并将将超时间隔为 500 毫秒。</span><span class="sxs-lookup"><span data-stu-id="bea5c-628">This example uploads the file `Order.txt` to `http://www.cohowinery.com/uploads` without supplying a user name or password, shows the progress of the upload, and has a time-out interval of 500 milliseconds.</span></span>  
  
 [!code-vb[VbVbalrMyNetwork#3](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbalrMyNetwork/VB/Class1.vb#3)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentException">
          <span data-ttu-id="bea5c-629">源文件路径无效。</span>
          <span class="sxs-lookup">
            <span data-stu-id="bea5c-629">The source file path is not valid.</span>
          </span>
        </exception>
        <exception cref="T:System.InvalidOperationException">
          <span data-ttu-id="bea5c-630">
            <paramref name="address" />不包括文件名。</span>
          <span class="sxs-lookup">
            <span data-stu-id="bea5c-630">
              <paramref name="address" /> does not include a file name.</span>
          </span>
        </exception>
        <exception cref="T:System.Security.SecurityException">
          <span data-ttu-id="bea5c-631">用户缺少必要的权限，无法执行网络操作。</span>
          <span class="sxs-lookup">
            <span data-stu-id="bea5c-631">User lacks necessary permissions to perform a network operation.</span>
          </span>
        </exception>
        <exception cref="T:System.TimeoutException">
          <span data-ttu-id="bea5c-632">服务器没有在指定的默认超时（100 秒）内响应。</span>
          <span class="sxs-lookup">
            <span data-stu-id="bea5c-632">The server does not respond within the default timeout (100 seconds).</span>
          </span>
        </exception>
        <exception cref="T:System.Net.WebException">
          <span data-ttu-id="bea5c-633">请求被目标 Web 服务器拒绝。</span>
          <span class="sxs-lookup">
            <span data-stu-id="bea5c-633">The request is denied by the target web server.</span>
          </span>
        </exception>
        <permission cref="T:System.Security.Permissions.FileIOPermission">
          <span data-ttu-id="bea5c-634">控制文件和文件夹的访问权限。</span>
          <span class="sxs-lookup">
            <span data-stu-id="bea5c-634">Controls the ability to access files and folders.</span>
          </span>
          <span data-ttu-id="bea5c-635">关联枚举：<see cref="F:System.Security.Permissions.PermissionState.Unrestricted" />。</span>
          <span class="sxs-lookup">
            <span data-stu-id="bea5c-635">Associated enumeration: <see cref="F:System.Security.Permissions.PermissionState.Unrestricted" />.</span>
          </span>
        </permission>
        <permission cref="T:System.Net.WebPermission">
          <span data-ttu-id="bea5c-636">控制访问 HTTP Internet 资源的权限。</span>
          <span class="sxs-lookup">
            <span data-stu-id="bea5c-636">Controls rights to access HTTP Internet resources.</span>
          </span>
          <span data-ttu-id="bea5c-637">关联枚举：<see cref="F:System.Security.Permissions.PermissionState.Unrestricted" />。</span>
          <span class="sxs-lookup">
            <span data-stu-id="bea5c-637">Associated enumeration: <see cref="F:System.Security.Permissions.PermissionState.Unrestricted" />.</span>
          </span>
        </permission>
        <altmember cref="T:System.Uri" />
        <altmember cref="T:System.Net.ICredentials" />
        <altmember cref="T:Microsoft.VisualBasic.FileIO.UICancelOption" />
      </Docs>
    </Member>
    <Member MemberName="UploadFile">
      <MemberSignature Language="C#" Value="public void UploadFile (string sourceFileName, string address, string userName, string password);" />
      <MemberSignature Language="ILAsm" Value=".method public instance void UploadFile(string sourceFileName, string address, string userName, string password) cil managed" />
      <MemberSignature Language="DocId" Value="M:Microsoft.VisualBasic.Devices.Network.UploadFile(System.String,System.String,System.String,System.String)" />
      <MemberSignature Language="VB.NET" Value="Public Sub UploadFile (sourceFileName As String, address As String, userName As String, password As String)" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; void UploadFile(System::String ^ sourceFileName, System::String ^ address, System::String ^ userName, System::String ^ password);" />
      <MemberSignature Language="F#" Value="member this.UploadFile : string * string * string * string -&gt; unit" Usage="network.UploadFile (sourceFileName, address, userName, password)" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>Microsoft.VisualBasic</AssemblyName>
        <AssemblyVersion>8.0.0.0</AssemblyVersion>
        <AssemblyVersion>10.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Attributes>
        <Attribute FrameworkAlternate="netframework-4.0">
          <AttributeName>System.Runtime.TargetedPatchingOptOut("Performance critical to inline this type of method across NGen image boundaries")</AttributeName>
        </Attribute>
      </Attributes>
      <ReturnValue>
        <ReturnType>System.Void</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="sourceFileName" Type="System.String" />
        <Parameter Name="address" Type="System.String" />
        <Parameter Name="userName" Type="System.String" />
        <Parameter Name="password" Type="System.String" />
      </Parameters>
      <Docs>
        <param name="sourceFileName">
          <span data-ttu-id="bea5c-638">要上载的文件的路径和名称。</span>
          <span class="sxs-lookup">
            <span data-stu-id="bea5c-638">Path and name of file to upload.</span>
          </span>
        </param>
        <param name="address">
          <span data-ttu-id="bea5c-639">目标服务器的 URL、IP 地址或 URI。</span>
          <span class="sxs-lookup">
            <span data-stu-id="bea5c-639">URL, IP address, or URI of destination server.</span>
          </span>
        </param>
        <param name="userName">
          <span data-ttu-id="bea5c-640">要进行身份验证的用户名。</span>
          <span class="sxs-lookup">
            <span data-stu-id="bea5c-640">User name to authenticate.</span>
          </span>
          <span data-ttu-id="bea5c-641">默认值为空字符串：<c>""</c>。</span>
          <span class="sxs-lookup">
            <span data-stu-id="bea5c-641">Default is an empty string: <c>""</c>.</span>
          </span>
        </param>
        <param name="password">
          <span data-ttu-id="bea5c-642">要验证的密码。</span>
          <span class="sxs-lookup">
            <span data-stu-id="bea5c-642">Password to authenticate.</span>
          </span>
          <span data-ttu-id="bea5c-643">默认值为空字符串：<c>""</c>。</span>
          <span class="sxs-lookup">
            <span data-stu-id="bea5c-643">Default is an empty string: <c>""</c>.</span>
          </span>
        </param>
        <summary>
          <span data-ttu-id="bea5c-644">将指定的文件发送到指定的主机地址。</span>
          <span class="sxs-lookup">
            <span data-stu-id="bea5c-644">Sends the specified file to the specified host address.</span>
          </span>
        </summary>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="bea5c-645">可以使用的其他重载之一<xref:Microsoft.VisualBasic.Devices.Network.UploadFile%2A>方法，以指定特定的超时值。</span><span class="sxs-lookup"><span data-stu-id="bea5c-645">You can use one of the other overloads of the <xref:Microsoft.VisualBasic.Devices.Network.UploadFile%2A> method to specify a specific timeout value.</span></span>  
  
 <span data-ttu-id="bea5c-646">`My.Computer.Network.UploadFile` 在应用程序中启用网络跟踪后，跟踪信息输出。</span><span class="sxs-lookup"><span data-stu-id="bea5c-646">`My.Computer.Network.UploadFile` outputs trace information when you enable network tracing in your application.</span></span> <span data-ttu-id="bea5c-647">有关详细信息，请参阅[启用网络跟踪](~/docs/framework/network-programming/enabling-network-tracing.md)。</span><span class="sxs-lookup"><span data-stu-id="bea5c-647">For more information, see [Enabling Network Tracing](~/docs/framework/network-programming/enabling-network-tracing.md).</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="bea5c-648">FTP 协议发送的信息，包括以纯文本密码，并不应使用用于传输敏感信息。</span><span class="sxs-lookup"><span data-stu-id="bea5c-648">The FTP protocol sends information, including passwords, in plain text and should not be used for transmitting sensitive information.</span></span>  
  
 <span data-ttu-id="bea5c-649">下表列出的任务涉及示例`My.Computer.Network.UploadFile`方法。</span><span class="sxs-lookup"><span data-stu-id="bea5c-649">The following table lists an example of a task involving the `My.Computer.Network.UploadFile` method.</span></span>  
  
|<span data-ttu-id="bea5c-650">到</span><span class="sxs-lookup"><span data-stu-id="bea5c-650">To</span></span>|<span data-ttu-id="bea5c-651">查看</span><span class="sxs-lookup"><span data-stu-id="bea5c-651">See</span></span>|  
|-|-|  
|<span data-ttu-id="bea5c-652">上传文件</span><span class="sxs-lookup"><span data-stu-id="bea5c-652">Upload a file</span></span>|[<span data-ttu-id="bea5c-653">如何：上载文件</span><span class="sxs-lookup"><span data-stu-id="bea5c-653">How to: Upload a File</span></span>](~/docs/visual-basic/developing-apps/programming/computer-resources/how-to-upload-a-file.md)|  
  
   
  
## Examples  
 <span data-ttu-id="bea5c-654">此示例将文件上传`Order.txt`到`http://www.cohowinery.com/uploads`。</span><span class="sxs-lookup"><span data-stu-id="bea5c-654">This example uploads the file `Order.txt` to `http://www.cohowinery.com/uploads`.</span></span>  
  
 [!code-vb[VbVbalrMyNetwork#2](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbalrMyNetwork/VB/Class1.vb#2)]  
  
 <span data-ttu-id="bea5c-655">此示例在不提供用户名或密码的情况下将文件 `Order.txt` 上传到 `http://www.cohowinery.com/uploads`显示了上传操作的进度，并将将超时间隔为 500 毫秒。</span><span class="sxs-lookup"><span data-stu-id="bea5c-655">This example uploads the file `Order.txt` to `http://www.cohowinery.com/uploads` without supplying a user name or password, shows the progress of the upload, and has a time-out interval of 500 milliseconds.</span></span>  
  
 [!code-vb[VbVbalrMyNetwork#3](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbalrMyNetwork/VB/Class1.vb#3)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentException">
          <span data-ttu-id="bea5c-656">
            <paramref name="connectionTimeout" /> 小于或等于零。</span>
          <span class="sxs-lookup">
            <span data-stu-id="bea5c-656">
              <paramref name="connectionTimeout" /> is less than or equal to zero.</span>
          </span>
        </exception>
        <exception cref="T:System.InvalidOperationException">
          <span data-ttu-id="bea5c-657">
            <paramref name="address" />不包括文件名。</span>
          <span class="sxs-lookup">
            <span data-stu-id="bea5c-657">
              <paramref name="address" /> does not include a file name.</span>
          </span>
        </exception>
        <exception cref="T:System.Security.SecurityException">
          <span data-ttu-id="bea5c-658">用户缺少必要的权限，无法执行网络操作。</span>
          <span class="sxs-lookup">
            <span data-stu-id="bea5c-658">User lacks necessary permissions to perform a network operation.</span>
          </span>
        </exception>
        <exception cref="T:System.TimeoutException">
          <span data-ttu-id="bea5c-659">服务器没有在指定的默认超时（100 秒）内响应。</span>
          <span class="sxs-lookup">
            <span data-stu-id="bea5c-659">The server does not respond within the default timeout (100 seconds).</span>
          </span>
        </exception>
        <exception cref="T:System.Net.WebException">
          <span data-ttu-id="bea5c-660">请求被目标 Web 服务器拒绝。</span>
          <span class="sxs-lookup">
            <span data-stu-id="bea5c-660">The request is denied by the target web server.</span>
          </span>
        </exception>
        <permission cref="T:System.Security.Permissions.FileIOPermission">
          <span data-ttu-id="bea5c-661">控制文件和文件夹的访问权限。</span>
          <span class="sxs-lookup">
            <span data-stu-id="bea5c-661">Controls the ability to access files and folders.</span>
          </span>
          <span data-ttu-id="bea5c-662">关联枚举：<see cref="F:System.Security.Permissions.PermissionState.Unrestricted" />。</span>
          <span class="sxs-lookup">
            <span data-stu-id="bea5c-662">Associated enumeration: <see cref="F:System.Security.Permissions.PermissionState.Unrestricted" />.</span>
          </span>
        </permission>
        <permission cref="T:System.Net.WebPermission">
          <span data-ttu-id="bea5c-663">控制访问 HTTP Internet 资源的权限。</span>
          <span class="sxs-lookup">
            <span data-stu-id="bea5c-663">Controls rights to access HTTP Internet resources.</span>
          </span>
          <span data-ttu-id="bea5c-664">关联枚举：<see cref="F:System.Security.Permissions.PermissionState.Unrestricted" />。</span>
          <span class="sxs-lookup">
            <span data-stu-id="bea5c-664">Associated enumeration: <see cref="F:System.Security.Permissions.PermissionState.Unrestricted" />.</span>
          </span>
        </permission>
        <altmember cref="T:System.Uri" />
        <altmember cref="T:System.Net.ICredentials" />
        <altmember cref="T:Microsoft.VisualBasic.FileIO.UICancelOption" />
      </Docs>
    </Member>
    <Member MemberName="UploadFile">
      <MemberSignature Language="C#" Value="public void UploadFile (string sourceFileName, Uri address, string userName, string password);" />
      <MemberSignature Language="ILAsm" Value=".method public instance void UploadFile(string sourceFileName, class System.Uri address, string userName, string password) cil managed" />
      <MemberSignature Language="DocId" Value="M:Microsoft.VisualBasic.Devices.Network.UploadFile(System.String,System.Uri,System.String,System.String)" />
      <MemberSignature Language="VB.NET" Value="Public Sub UploadFile (sourceFileName As String, address As Uri, userName As String, password As String)" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; void UploadFile(System::String ^ sourceFileName, Uri ^ address, System::String ^ userName, System::String ^ password);" />
      <MemberSignature Language="F#" Value="member this.UploadFile : string * Uri * string * string -&gt; unit" Usage="network.UploadFile (sourceFileName, address, userName, password)" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>Microsoft.VisualBasic</AssemblyName>
        <AssemblyVersion>8.0.0.0</AssemblyVersion>
        <AssemblyVersion>10.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Attributes>
        <Attribute FrameworkAlternate="netframework-4.0">
          <AttributeName>System.Runtime.TargetedPatchingOptOut("Performance critical to inline this type of method across NGen image boundaries")</AttributeName>
        </Attribute>
      </Attributes>
      <ReturnValue>
        <ReturnType>System.Void</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="sourceFileName" Type="System.String" />
        <Parameter Name="address" Type="System.Uri" />
        <Parameter Name="userName" Type="System.String" />
        <Parameter Name="password" Type="System.String" />
      </Parameters>
      <Docs>
        <param name="sourceFileName">
          <span data-ttu-id="bea5c-665">要上载的文件的路径和名称。</span>
          <span class="sxs-lookup">
            <span data-stu-id="bea5c-665">Path and name of file to upload.</span>
          </span>
        </param>
        <param name="address">
          <span data-ttu-id="bea5c-666">目标服务器的 URL、IP 地址或 URI。</span>
          <span class="sxs-lookup">
            <span data-stu-id="bea5c-666">URL, IP address, or URI of destination server.</span>
          </span>
        </param>
        <param name="userName">
          <span data-ttu-id="bea5c-667">要进行身份验证的用户名。</span>
          <span class="sxs-lookup">
            <span data-stu-id="bea5c-667">User name to authenticate.</span>
          </span>
          <span data-ttu-id="bea5c-668">默认值为空字符串：<c>""</c>。</span>
          <span class="sxs-lookup">
            <span data-stu-id="bea5c-668">Default is an empty string: <c>""</c>.</span>
          </span>
        </param>
        <param name="password">
          <span data-ttu-id="bea5c-669">要验证的密码。</span>
          <span class="sxs-lookup">
            <span data-stu-id="bea5c-669">Password to authenticate.</span>
          </span>
          <span data-ttu-id="bea5c-670">默认值为空字符串：<c>""</c>。</span>
          <span class="sxs-lookup">
            <span data-stu-id="bea5c-670">Default is an empty string: <c>""</c>.</span>
          </span>
        </param>
        <summary>
          <span data-ttu-id="bea5c-671">将指定的文件发送到指定的主机地址。</span>
          <span class="sxs-lookup">
            <span data-stu-id="bea5c-671">Sends the specified file to the specified host address.</span>
          </span>
        </summary>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="bea5c-672">可以使用的其他重载之一<xref:Microsoft.VisualBasic.Devices.Network.UploadFile%2A>方法，以指定特定的超时值。</span><span class="sxs-lookup"><span data-stu-id="bea5c-672">You can use one of the other overloads of the <xref:Microsoft.VisualBasic.Devices.Network.UploadFile%2A> method to specify a specific timeout value.</span></span>  
  
 <span data-ttu-id="bea5c-673">`My.Computer.Network.UploadFile` 在应用程序中启用网络跟踪后，跟踪信息输出。</span><span class="sxs-lookup"><span data-stu-id="bea5c-673">`My.Computer.Network.UploadFile` outputs trace information when you enable network tracing in your application.</span></span> <span data-ttu-id="bea5c-674">有关详细信息，请参阅[启用网络跟踪](~/docs/framework/network-programming/enabling-network-tracing.md)。</span><span class="sxs-lookup"><span data-stu-id="bea5c-674">For more information, see [Enabling Network Tracing](~/docs/framework/network-programming/enabling-network-tracing.md).</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="bea5c-675">FTP 协议发送的信息，包括以纯文本密码，并不应使用用于传输敏感信息。</span><span class="sxs-lookup"><span data-stu-id="bea5c-675">The FTP protocol sends information, including passwords, in plain text and should not be used for transmitting sensitive information.</span></span>  
  
 <span data-ttu-id="bea5c-676">下表列出的任务涉及示例`My.Computer.Network.UploadFile`方法。</span><span class="sxs-lookup"><span data-stu-id="bea5c-676">The following table lists an example of a task involving the `My.Computer.Network.UploadFile` method.</span></span>  
  
|<span data-ttu-id="bea5c-677">到</span><span class="sxs-lookup"><span data-stu-id="bea5c-677">To</span></span>|<span data-ttu-id="bea5c-678">查看</span><span class="sxs-lookup"><span data-stu-id="bea5c-678">See</span></span>|  
|-|-|  
|<span data-ttu-id="bea5c-679">上传文件</span><span class="sxs-lookup"><span data-stu-id="bea5c-679">Upload a file</span></span>|[<span data-ttu-id="bea5c-680">如何：上载文件</span><span class="sxs-lookup"><span data-stu-id="bea5c-680">How to: Upload a File</span></span>](~/docs/visual-basic/developing-apps/programming/computer-resources/how-to-upload-a-file.md)|  
  
   
  
## Examples  
 <span data-ttu-id="bea5c-681">此示例将文件上传`Order.txt`到`http://www.cohowinery.com/uploads`。</span><span class="sxs-lookup"><span data-stu-id="bea5c-681">This example uploads the file `Order.txt` to `http://www.cohowinery.com/uploads`.</span></span>  
  
 [!code-vb[VbVbalrMyNetwork#2](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbalrMyNetwork/VB/Class1.vb#2)]  
  
 <span data-ttu-id="bea5c-682">此示例在不提供用户名或密码的情况下将文件 `Order.txt` 上传到 `http://www.cohowinery.com/uploads`显示了上传操作的进度，并将将超时间隔为 500 毫秒。</span><span class="sxs-lookup"><span data-stu-id="bea5c-682">This example uploads the file `Order.txt` to `http://www.cohowinery.com/uploads` without supplying a user name or password, shows the progress of the upload, and has a time-out interval of 500 milliseconds.</span></span>  
  
 [!code-vb[VbVbalrMyNetwork#3](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbalrMyNetwork/VB/Class1.vb#3)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentException">
          <span data-ttu-id="bea5c-683">
            <paramref name="connectionTimeout" /> 小于或等于零。</span>
          <span class="sxs-lookup">
            <span data-stu-id="bea5c-683">
              <paramref name="connectionTimeout" /> is less than or equal to zero.</span>
          </span>
        </exception>
        <exception cref="T:System.InvalidOperationException">
          <span data-ttu-id="bea5c-684">
            <paramref name="address" />不包括文件名。</span>
          <span class="sxs-lookup">
            <span data-stu-id="bea5c-684">
              <paramref name="address" /> does not include a file name.</span>
          </span>
        </exception>
        <exception cref="T:System.Security.SecurityException">
          <span data-ttu-id="bea5c-685">用户缺少必要的权限，无法执行网络操作。</span>
          <span class="sxs-lookup">
            <span data-stu-id="bea5c-685">User lacks necessary permissions to perform a network operation.</span>
          </span>
        </exception>
        <exception cref="T:System.TimeoutException">
          <span data-ttu-id="bea5c-686">服务器没有在指定的默认超时（100 秒）内响应。</span>
          <span class="sxs-lookup">
            <span data-stu-id="bea5c-686">The server does not respond within the default timeout (100 seconds).</span>
          </span>
        </exception>
        <exception cref="T:System.Net.WebException">
          <span data-ttu-id="bea5c-687">请求被目标 Web 服务器拒绝。</span>
          <span class="sxs-lookup">
            <span data-stu-id="bea5c-687">The request is denied by the target web server.</span>
          </span>
        </exception>
        <permission cref="T:System.Security.Permissions.FileIOPermission">
          <span data-ttu-id="bea5c-688">控制文件和文件夹的访问权限。</span>
          <span class="sxs-lookup">
            <span data-stu-id="bea5c-688">Controls the ability to access files and folders.</span>
          </span>
          <span data-ttu-id="bea5c-689">关联枚举：<see cref="F:System.Security.Permissions.PermissionState.Unrestricted" />。</span>
          <span class="sxs-lookup">
            <span data-stu-id="bea5c-689">Associated enumeration: <see cref="F:System.Security.Permissions.PermissionState.Unrestricted" />.</span>
          </span>
        </permission>
        <permission cref="T:System.Net.WebPermission">
          <span data-ttu-id="bea5c-690">控制访问 HTTP Internet 资源的权限。</span>
          <span class="sxs-lookup">
            <span data-stu-id="bea5c-690">Controls rights to access HTTP Internet resources.</span>
          </span>
          <span data-ttu-id="bea5c-691">关联枚举：<see cref="F:System.Security.Permissions.PermissionState.Unrestricted" />。</span>
          <span class="sxs-lookup">
            <span data-stu-id="bea5c-691">Associated enumeration: <see cref="F:System.Security.Permissions.PermissionState.Unrestricted" />.</span>
          </span>
        </permission>
        <altmember cref="T:System.Uri" />
        <altmember cref="T:System.Net.ICredentials" />
        <altmember cref="T:Microsoft.VisualBasic.FileIO.UICancelOption" />
      </Docs>
    </Member>
    <Member MemberName="UploadFile">
      <MemberSignature Language="C#" Value="public void UploadFile (string sourceFileName, Uri address, System.Net.ICredentials networkCredentials, bool showUI, int connectionTimeout);" />
      <MemberSignature Language="ILAsm" Value=".method public instance void UploadFile(string sourceFileName, class System.Uri address, class System.Net.ICredentials networkCredentials, bool showUI, int32 connectionTimeout) cil managed" />
      <MemberSignature Language="DocId" Value="M:Microsoft.VisualBasic.Devices.Network.UploadFile(System.String,System.Uri,System.Net.ICredentials,System.Boolean,System.Int32)" />
      <MemberSignature Language="VB.NET" Value="Public Sub UploadFile (sourceFileName As String, address As Uri, networkCredentials As ICredentials, showUI As Boolean, connectionTimeout As Integer)" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; void UploadFile(System::String ^ sourceFileName, Uri ^ address, System::Net::ICredentials ^ networkCredentials, bool showUI, int connectionTimeout);" />
      <MemberSignature Language="F#" Value="member this.UploadFile : string * Uri * System.Net.ICredentials * bool * int -&gt; unit" Usage="network.UploadFile (sourceFileName, address, networkCredentials, showUI, connectionTimeout)" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>Microsoft.VisualBasic</AssemblyName>
        <AssemblyVersion>8.0.0.0</AssemblyVersion>
        <AssemblyVersion>10.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Attributes>
        <Attribute FrameworkAlternate="netframework-4.0">
          <AttributeName>System.Runtime.TargetedPatchingOptOut("Performance critical to inline this type of method across NGen image boundaries")</AttributeName>
        </Attribute>
      </Attributes>
      <ReturnValue>
        <ReturnType>System.Void</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="sourceFileName" Type="System.String" />
        <Parameter Name="address" Type="System.Uri" />
        <Parameter Name="networkCredentials" Type="System.Net.ICredentials" />
        <Parameter Name="showUI" Type="System.Boolean" />
        <Parameter Name="connectionTimeout" Type="System.Int32" />
      </Parameters>
      <Docs>
        <param name="sourceFileName">
          <span data-ttu-id="bea5c-692">要上载的文件的路径和名称。</span>
          <span class="sxs-lookup">
            <span data-stu-id="bea5c-692">Path and name of file to upload.</span>
          </span>
        </param>
        <param name="address">
          <span data-ttu-id="bea5c-693">目标服务器的 URL、IP 地址或 URI。</span>
          <span class="sxs-lookup">
            <span data-stu-id="bea5c-693">URL, IP address, or URI of destination server.</span>
          </span>
        </param>
        <param name="networkCredentials">
          <span data-ttu-id="bea5c-694">身份验证的凭据。</span>
          <span class="sxs-lookup">
            <span data-stu-id="bea5c-694">Credentials for authentication.</span>
          </span>
        </param>
        <param name="showUI">
          <span data-ttu-id="bea5c-695">要显示操作进度，则为 <see langword="True" />；否则为 <see langword="False" />。</span>
          <span class="sxs-lookup">
            <span data-stu-id="bea5c-695">
              <see langword="True" /> to display progress of the operation; otherwise <see langword="False" />.</span>
          </span>
          <span data-ttu-id="bea5c-696">默认值为 <see langword="False" />。</span>
          <span class="sxs-lookup">
            <span data-stu-id="bea5c-696">Default is <see langword="False" />.</span>
          </span>
        </param>
        <param name="connectionTimeout">
          <span data-ttu-id="bea5c-697">以毫秒为单位的超时间隔。</span>
          <span class="sxs-lookup">
            <span data-stu-id="bea5c-697">Timeout interval in milliseconds.</span>
          </span>
          <span data-ttu-id="bea5c-698">默认值为 100 秒。</span>
          <span class="sxs-lookup">
            <span data-stu-id="bea5c-698">Default is 100 seconds.</span>
          </span>
        </param>
        <summary>
          <span data-ttu-id="bea5c-699">将指定的文件发送到指定的主机地址。</span>
          <span class="sxs-lookup">
            <span data-stu-id="bea5c-699">Sends the specified file to the specified host address.</span>
          </span>
        </summary>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="bea5c-700">如果`showUI`设置为`True`，对话框中显示操作的进度，其中包括**取消**用户可以单击以取消操作的按钮。</span><span class="sxs-lookup"><span data-stu-id="bea5c-700">If `showUI` is set to `True`, a dialog box shows the progress of the operation and includes a **Cancel** button that the user can click to cancel the operation.</span></span> <span data-ttu-id="bea5c-701">由于对话框的不是模式，它不会阻止其他 windows 程序中的用户输入。</span><span class="sxs-lookup"><span data-stu-id="bea5c-701">Because the dialog box is not modal, it does not block user input to other windows in the program.</span></span>  
  
 <span data-ttu-id="bea5c-702">如果服务器没有响应中指定的间隔内`connectionTimeout`，将取消该操作并引发异常。</span><span class="sxs-lookup"><span data-stu-id="bea5c-702">If the server does not respond within the interval specified in `connectionTimeout`, the operation is cancelled and an exception is thrown.</span></span>  
  
 <span data-ttu-id="bea5c-703">`My.Computer.Network.UploadFile` 在应用程序中启用网络跟踪后，跟踪信息输出。</span><span class="sxs-lookup"><span data-stu-id="bea5c-703">`My.Computer.Network.UploadFile` outputs trace information when you enable network tracing in your application.</span></span> <span data-ttu-id="bea5c-704">有关详细信息，请参阅[启用网络跟踪](~/docs/framework/network-programming/enabling-network-tracing.md)。</span><span class="sxs-lookup"><span data-stu-id="bea5c-704">For more information, see [Enabling Network Tracing](~/docs/framework/network-programming/enabling-network-tracing.md).</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="bea5c-705">FTP 协议发送的信息，包括以纯文本密码，并不应使用用于传输敏感信息。</span><span class="sxs-lookup"><span data-stu-id="bea5c-705">The FTP protocol sends information, including passwords, in plain text and should not be used for transmitting sensitive information.</span></span>  
  
 <span data-ttu-id="bea5c-706">下表列出的任务涉及示例`My.Computer.Network.UploadFile`方法。</span><span class="sxs-lookup"><span data-stu-id="bea5c-706">The following table lists an example of a task involving the `My.Computer.Network.UploadFile` method.</span></span>  
  
|<span data-ttu-id="bea5c-707">到</span><span class="sxs-lookup"><span data-stu-id="bea5c-707">To</span></span>|<span data-ttu-id="bea5c-708">查看</span><span class="sxs-lookup"><span data-stu-id="bea5c-708">See</span></span>|  
|-|-|  
|<span data-ttu-id="bea5c-709">上传文件</span><span class="sxs-lookup"><span data-stu-id="bea5c-709">Upload a file</span></span>|[<span data-ttu-id="bea5c-710">如何：上载文件</span><span class="sxs-lookup"><span data-stu-id="bea5c-710">How to: Upload a File</span></span>](~/docs/visual-basic/developing-apps/programming/computer-resources/how-to-upload-a-file.md)|  
  
   
  
## Examples  
 <span data-ttu-id="bea5c-711">此示例将文件上传`Order.txt`到`http://www.cohowinery.com/uploads`。</span><span class="sxs-lookup"><span data-stu-id="bea5c-711">This example uploads the file `Order.txt` to `http://www.cohowinery.com/uploads`.</span></span>  
  
 [!code-vb[VbVbalrMyNetwork#2](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbalrMyNetwork/VB/Class1.vb#2)]  
  
 <span data-ttu-id="bea5c-712">此示例在不提供用户名或密码的情况下将文件 `Order.txt` 上传到 `http://www.cohowinery.com/uploads`显示了上传操作的进度，并将将超时间隔为 500 毫秒。</span><span class="sxs-lookup"><span data-stu-id="bea5c-712">This example uploads the file `Order.txt` to `http://www.cohowinery.com/uploads` without supplying a user name or password, shows the progress of the upload, and has a time-out interval of 500 milliseconds.</span></span>  
  
 [!code-vb[VbVbalrMyNetwork#3](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbalrMyNetwork/VB/Class1.vb#3)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentException">
          <span data-ttu-id="bea5c-713">
            <paramref name="connectionTimeout" /> 小于或等于零。</span>
          <span class="sxs-lookup">
            <span data-stu-id="bea5c-713">
              <paramref name="connectionTimeout" /> is less than or equal to zero.</span>
          </span>
        </exception>
        <exception cref="T:System.InvalidOperationException">
          <span data-ttu-id="bea5c-714">
            <paramref name="address" />不包括文件名。</span>
          <span class="sxs-lookup">
            <span data-stu-id="bea5c-714">
              <paramref name="address" /> does not include a file name.</span>
          </span>
        </exception>
        <exception cref="T:System.Security.SecurityException">
          <span data-ttu-id="bea5c-715">用户缺少必要的权限，无法执行网络操作。</span>
          <span class="sxs-lookup">
            <span data-stu-id="bea5c-715">User lacks necessary permissions to perform a network operation.</span>
          </span>
        </exception>
        <exception cref="T:System.TimeoutException">
          <span data-ttu-id="bea5c-716">服务器没有在指定的 <paramref name="connectionTimeout" /> 内响应。</span>
          <span class="sxs-lookup">
            <span data-stu-id="bea5c-716">The server does not respond within the specified <paramref name="connectionTimeout" />.</span>
          </span>
        </exception>
        <exception cref="T:System.Net.WebException">
          <span data-ttu-id="bea5c-717">请求被目标 Web 服务器拒绝。</span>
          <span class="sxs-lookup">
            <span data-stu-id="bea5c-717">The request is denied by the target web server.</span>
          </span>
        </exception>
        <permission cref="T:System.Security.Permissions.FileIOPermission">
          <span data-ttu-id="bea5c-718">控制文件和文件夹的访问权限。</span>
          <span class="sxs-lookup">
            <span data-stu-id="bea5c-718">Controls the ability to access files and folders.</span>
          </span>
          <span data-ttu-id="bea5c-719">关联枚举：<see cref="F:System.Security.Permissions.PermissionState.Unrestricted" />。</span>
          <span class="sxs-lookup">
            <span data-stu-id="bea5c-719">Associated enumeration: <see cref="F:System.Security.Permissions.PermissionState.Unrestricted" />.</span>
          </span>
        </permission>
        <permission cref="T:System.Security.Permissions.UIPermission">
          <span data-ttu-id="bea5c-720">控制与用户界面和剪贴板相关的权限。</span>
          <span class="sxs-lookup">
            <span data-stu-id="bea5c-720">Controls the permissions related to user interfaces and the clipboard.</span>
          </span>
          <span data-ttu-id="bea5c-721">关联枚举：<see cref="F:System.Security.Permissions.UIPermissionWindow.AllWindows" />。</span>
          <span class="sxs-lookup">
            <span data-stu-id="bea5c-721">Associated enumeration: <see cref="F:System.Security.Permissions.UIPermissionWindow.AllWindows" />.</span>
          </span>
        </permission>
        <permission cref="T:System.Net.WebPermission">
          <span data-ttu-id="bea5c-722">控制访问 HTTP Internet 资源的权限。</span>
          <span class="sxs-lookup">
            <span data-stu-id="bea5c-722">Controls rights to access HTTP Internet resources.</span>
          </span>
          <span data-ttu-id="bea5c-723">关联枚举：<see cref="F:System.Security.Permissions.PermissionState.Unrestricted" />。</span>
          <span class="sxs-lookup">
            <span data-stu-id="bea5c-723">Associated enumeration: <see cref="F:System.Security.Permissions.PermissionState.Unrestricted" />.</span>
          </span>
        </permission>
        <altmember cref="T:System.Uri" />
        <altmember cref="T:System.Net.ICredentials" />
        <altmember cref="T:Microsoft.VisualBasic.FileIO.UICancelOption" />
      </Docs>
    </Member>
    <Member MemberName="UploadFile">
      <MemberSignature Language="C#" Value="public void UploadFile (string sourceFileName, string address, string userName, string password, bool showUI, int connectionTimeout);" />
      <MemberSignature Language="ILAsm" Value=".method public instance void UploadFile(string sourceFileName, string address, string userName, string password, bool showUI, int32 connectionTimeout) cil managed" />
      <MemberSignature Language="DocId" Value="M:Microsoft.VisualBasic.Devices.Network.UploadFile(System.String,System.String,System.String,System.String,System.Boolean,System.Int32)" />
      <MemberSignature Language="VB.NET" Value="Public Sub UploadFile (sourceFileName As String, address As String, userName As String, password As String, showUI As Boolean, connectionTimeout As Integer)" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; void UploadFile(System::String ^ sourceFileName, System::String ^ address, System::String ^ userName, System::String ^ password, bool showUI, int connectionTimeout);" />
      <MemberSignature Language="F#" Value="member this.UploadFile : string * string * string * string * bool * int -&gt; unit" Usage="network.UploadFile (sourceFileName, address, userName, password, showUI, connectionTimeout)" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>Microsoft.VisualBasic</AssemblyName>
        <AssemblyVersion>8.0.0.0</AssemblyVersion>
        <AssemblyVersion>10.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Attributes>
        <Attribute FrameworkAlternate="netframework-4.0">
          <AttributeName>System.Runtime.TargetedPatchingOptOut("Performance critical to inline this type of method across NGen image boundaries")</AttributeName>
        </Attribute>
      </Attributes>
      <ReturnValue>
        <ReturnType>System.Void</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="sourceFileName" Type="System.String" />
        <Parameter Name="address" Type="System.String" />
        <Parameter Name="userName" Type="System.String" />
        <Parameter Name="password" Type="System.String" />
        <Parameter Name="showUI" Type="System.Boolean" />
        <Parameter Name="connectionTimeout" Type="System.Int32" />
      </Parameters>
      <Docs>
        <param name="sourceFileName">
          <span data-ttu-id="bea5c-724">要上载的文件的路径和名称。</span>
          <span class="sxs-lookup">
            <span data-stu-id="bea5c-724">Path and name of file to upload.</span>
          </span>
        </param>
        <param name="address">
          <span data-ttu-id="bea5c-725">目标服务器的 URL、IP 地址或 URI。</span>
          <span class="sxs-lookup">
            <span data-stu-id="bea5c-725">URL, IP address, or URI of destination server.</span>
          </span>
        </param>
        <param name="userName">
          <span data-ttu-id="bea5c-726">要进行身份验证的用户名。</span>
          <span class="sxs-lookup">
            <span data-stu-id="bea5c-726">User name to authenticate.</span>
          </span>
          <span data-ttu-id="bea5c-727">默认值为空字符串：<c>""</c>。</span>
          <span class="sxs-lookup">
            <span data-stu-id="bea5c-727">Default is an empty string: <c>""</c>.</span>
          </span>
        </param>
        <param name="password">
          <span data-ttu-id="bea5c-728">要验证的密码。</span>
          <span class="sxs-lookup">
            <span data-stu-id="bea5c-728">Password to authenticate.</span>
          </span>
          <span data-ttu-id="bea5c-729">默认值为空字符串：<c>""</c>。</span>
          <span class="sxs-lookup">
            <span data-stu-id="bea5c-729">Default is an empty string: <c>""</c>.</span>
          </span>
        </param>
        <param name="showUI">
          <span data-ttu-id="bea5c-730">要显示操作进度，则为 <see langword="True" />；否则为 <see langword="False" />。</span>
          <span class="sxs-lookup">
            <span data-stu-id="bea5c-730">
              <see langword="True" /> to display progress of the operation; otherwise <see langword="False" />.</span>
          </span>
          <span data-ttu-id="bea5c-731">默认值为 <see langword="False" />。</span>
          <span class="sxs-lookup">
            <span data-stu-id="bea5c-731">Default is <see langword="False" />.</span>
          </span>
        </param>
        <param name="connectionTimeout">
          <span data-ttu-id="bea5c-732">以毫秒为单位的超时间隔。</span>
          <span class="sxs-lookup">
            <span data-stu-id="bea5c-732">Timeout interval in milliseconds.</span>
          </span>
          <span data-ttu-id="bea5c-733">默认值为 100 秒。</span>
          <span class="sxs-lookup">
            <span data-stu-id="bea5c-733">Default is 100 seconds.</span>
          </span>
        </param>
        <summary>
          <span data-ttu-id="bea5c-734">将指定的文件发送到指定的主机地址。</span>
          <span class="sxs-lookup">
            <span data-stu-id="bea5c-734">Sends the specified file to the specified host address.</span>
          </span>
        </summary>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="bea5c-735">如果`showUI`设置为`True`，对话框中显示操作的进度，其中包括**取消**用户可以单击以取消操作的按钮。</span><span class="sxs-lookup"><span data-stu-id="bea5c-735">If `showUI` is set to `True`, a dialog box shows the progress of the operation and includes a **Cancel** button that the user can click to cancel the operation.</span></span> <span data-ttu-id="bea5c-736">由于对话框的不是模式，它不会阻止其他 windows 程序中的用户输入。</span><span class="sxs-lookup"><span data-stu-id="bea5c-736">Because the dialog box is not modal, it does not block user input to other windows in the program.</span></span>  
  
 <span data-ttu-id="bea5c-737">如果服务器没有响应中指定的间隔内`connectionTimeout`，将取消该操作并引发异常。</span><span class="sxs-lookup"><span data-stu-id="bea5c-737">If the server does not respond within the interval specified in `connectionTimeout`, the operation is cancelled and an exception is thrown.</span></span>  
  
 <span data-ttu-id="bea5c-738">`My.Computer.Network.UploadFile` 在应用程序中启用网络跟踪后，跟踪信息输出。</span><span class="sxs-lookup"><span data-stu-id="bea5c-738">`My.Computer.Network.UploadFile` outputs trace information when you enable network tracing in your application.</span></span> <span data-ttu-id="bea5c-739">有关详细信息，请参阅[启用网络跟踪](~/docs/framework/network-programming/enabling-network-tracing.md)。</span><span class="sxs-lookup"><span data-stu-id="bea5c-739">For more information, see [Enabling Network Tracing](~/docs/framework/network-programming/enabling-network-tracing.md).</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="bea5c-740">FTP 协议发送的信息，包括以纯文本密码，并不应使用用于传输敏感信息。</span><span class="sxs-lookup"><span data-stu-id="bea5c-740">The FTP protocol sends information, including passwords, in plain text and should not be used for transmitting sensitive information.</span></span>  
  
 <span data-ttu-id="bea5c-741">下表列出的任务涉及示例`My.Computer.Network.UploadFile`方法。</span><span class="sxs-lookup"><span data-stu-id="bea5c-741">The following table lists an example of a task involving the `My.Computer.Network.UploadFile` method.</span></span>  
  
|<span data-ttu-id="bea5c-742">到</span><span class="sxs-lookup"><span data-stu-id="bea5c-742">To</span></span>|<span data-ttu-id="bea5c-743">查看</span><span class="sxs-lookup"><span data-stu-id="bea5c-743">See</span></span>|  
|-|-|  
|<span data-ttu-id="bea5c-744">上传文件</span><span class="sxs-lookup"><span data-stu-id="bea5c-744">Upload a file</span></span>|[<span data-ttu-id="bea5c-745">如何：上载文件</span><span class="sxs-lookup"><span data-stu-id="bea5c-745">How to: Upload a File</span></span>](~/docs/visual-basic/developing-apps/programming/computer-resources/how-to-upload-a-file.md)|  
  
   
  
## Examples  
 <span data-ttu-id="bea5c-746">此示例将文件上传`Order.txt`到`http://www.cohowinery.com/uploads`。</span><span class="sxs-lookup"><span data-stu-id="bea5c-746">This example uploads the file `Order.txt` to `http://www.cohowinery.com/uploads`.</span></span>  
  
 [!code-vb[VbVbalrMyNetwork#2](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbalrMyNetwork/VB/Class1.vb#2)]  
  
 <span data-ttu-id="bea5c-747">此示例在不提供用户名或密码的情况下将文件 `Order.txt` 上传到 `http://www.cohowinery.com/uploads`显示了上传操作的进度，并将将超时间隔为 500 毫秒。</span><span class="sxs-lookup"><span data-stu-id="bea5c-747">This example uploads the file `Order.txt` to `http://www.cohowinery.com/uploads` without supplying a user name or password, shows the progress of the upload, and has a time-out interval of 500 milliseconds.</span></span>  
  
 [!code-vb[VbVbalrMyNetwork#3](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbalrMyNetwork/VB/Class1.vb#3)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentException">
          <span data-ttu-id="bea5c-748">
            <paramref name="connectionTimeout" /> 小于或等于零。</span>
          <span class="sxs-lookup">
            <span data-stu-id="bea5c-748">
              <paramref name="connectionTimeout" /> is less than or equal to zero.</span>
          </span>
        </exception>
        <exception cref="T:System.InvalidOperationException">
          <span data-ttu-id="bea5c-749">
            <paramref name="address" />不包括文件名。</span>
          <span class="sxs-lookup">
            <span data-stu-id="bea5c-749">
              <paramref name="address" /> does not include a file name.</span>
          </span>
        </exception>
        <exception cref="T:System.Security.SecurityException">
          <span data-ttu-id="bea5c-750">用户缺少必要的权限，无法执行网络操作。</span>
          <span class="sxs-lookup">
            <span data-stu-id="bea5c-750">User lacks necessary permissions to perform a network operation.</span>
          </span>
        </exception>
        <exception cref="T:System.TimeoutException">
          <span data-ttu-id="bea5c-751">服务器没有在指定的 <paramref name="connectionTimeout" /> 内响应。</span>
          <span class="sxs-lookup">
            <span data-stu-id="bea5c-751">The server does not respond within the specified <paramref name="connectionTimeout" />.</span>
          </span>
        </exception>
        <exception cref="T:System.Net.WebException">
          <span data-ttu-id="bea5c-752">请求被目标 Web 服务器拒绝。</span>
          <span class="sxs-lookup">
            <span data-stu-id="bea5c-752">The request is denied by the target web server.</span>
          </span>
        </exception>
        <permission cref="T:System.Security.Permissions.FileIOPermission">
          <span data-ttu-id="bea5c-753">控制文件和文件夹的访问权限。</span>
          <span class="sxs-lookup">
            <span data-stu-id="bea5c-753">Controls the ability to access files and folders.</span>
          </span>
          <span data-ttu-id="bea5c-754">关联枚举：<see cref="F:System.Security.Permissions.PermissionState.Unrestricted" />。</span>
          <span class="sxs-lookup">
            <span data-stu-id="bea5c-754">Associated enumeration: <see cref="F:System.Security.Permissions.PermissionState.Unrestricted" />.</span>
          </span>
        </permission>
        <permission cref="T:System.Security.Permissions.UIPermission">
          <span data-ttu-id="bea5c-755">控制与用户界面和剪贴板相关的权限。</span>
          <span class="sxs-lookup">
            <span data-stu-id="bea5c-755">Controls the permissions related to user interfaces and the clipboard.</span>
          </span>
          <span data-ttu-id="bea5c-756">关联枚举：<see cref="F:System.Security.Permissions.UIPermissionWindow.AllWindows" />。</span>
          <span class="sxs-lookup">
            <span data-stu-id="bea5c-756">Associated enumeration: <see cref="F:System.Security.Permissions.UIPermissionWindow.AllWindows" />.</span>
          </span>
        </permission>
        <permission cref="T:System.Net.WebPermission">
          <span data-ttu-id="bea5c-757">控制访问 HTTP Internet 资源的权限。</span>
          <span class="sxs-lookup">
            <span data-stu-id="bea5c-757">Controls rights to access HTTP Internet resources.</span>
          </span>
          <span data-ttu-id="bea5c-758">关联枚举：<see cref="F:System.Security.Permissions.PermissionState.Unrestricted" />。</span>
          <span class="sxs-lookup">
            <span data-stu-id="bea5c-758">Associated enumeration: <see cref="F:System.Security.Permissions.PermissionState.Unrestricted" />.</span>
          </span>
        </permission>
        <altmember cref="T:System.Uri" />
        <altmember cref="T:System.Net.ICredentials" />
        <altmember cref="T:Microsoft.VisualBasic.FileIO.UICancelOption" />
      </Docs>
    </Member>
    <Member MemberName="UploadFile">
      <MemberSignature Language="C#" Value="public void UploadFile (string sourceFileName, Uri address, System.Net.ICredentials networkCredentials, bool showUI, int connectionTimeout, Microsoft.VisualBasic.FileIO.UICancelOption onUserCancel);" />
      <MemberSignature Language="ILAsm" Value=".method public instance void UploadFile(string sourceFileName, class System.Uri address, class System.Net.ICredentials networkCredentials, bool showUI, int32 connectionTimeout, valuetype Microsoft.VisualBasic.FileIO.UICancelOption onUserCancel) cil managed" />
      <MemberSignature Language="DocId" Value="M:Microsoft.VisualBasic.Devices.Network.UploadFile(System.String,System.Uri,System.Net.ICredentials,System.Boolean,System.Int32,Microsoft.VisualBasic.FileIO.UICancelOption)" />
      <MemberSignature Language="VB.NET" Value="Public Sub UploadFile (sourceFileName As String, address As Uri, networkCredentials As ICredentials, showUI As Boolean, connectionTimeout As Integer, onUserCancel As UICancelOption)" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; void UploadFile(System::String ^ sourceFileName, Uri ^ address, System::Net::ICredentials ^ networkCredentials, bool showUI, int connectionTimeout, Microsoft::VisualBasic::FileIO::UICancelOption onUserCancel);" />
      <MemberSignature Language="F#" Value="member this.UploadFile : string * Uri * System.Net.ICredentials * bool * int * Microsoft.VisualBasic.FileIO.UICancelOption -&gt; unit" Usage="network.UploadFile (sourceFileName, address, networkCredentials, showUI, connectionTimeout, onUserCancel)" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>Microsoft.VisualBasic</AssemblyName>
        <AssemblyVersion>8.0.0.0</AssemblyVersion>
        <AssemblyVersion>10.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Void</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="sourceFileName" Type="System.String" />
        <Parameter Name="address" Type="System.Uri" />
        <Parameter Name="networkCredentials" Type="System.Net.ICredentials" />
        <Parameter Name="showUI" Type="System.Boolean" />
        <Parameter Name="connectionTimeout" Type="System.Int32" />
        <Parameter Name="onUserCancel" Type="Microsoft.VisualBasic.FileIO.UICancelOption" />
      </Parameters>
      <Docs>
        <param name="sourceFileName">
          <span data-ttu-id="bea5c-759">要上载的文件的路径和名称。</span>
          <span class="sxs-lookup">
            <span data-stu-id="bea5c-759">Path and name of file to upload.</span>
          </span>
        </param>
        <param name="address">
          <span data-ttu-id="bea5c-760">目标服务器的 URL、IP 地址或 URI。</span>
          <span class="sxs-lookup">
            <span data-stu-id="bea5c-760">URL, IP address, or URI of destination server.</span>
          </span>
        </param>
        <param name="networkCredentials">
          <span data-ttu-id="bea5c-761">身份验证的凭据。</span>
          <span class="sxs-lookup">
            <span data-stu-id="bea5c-761">Credentials for authentication.</span>
          </span>
        </param>
        <param name="showUI">
          <span data-ttu-id="bea5c-762">要显示操作进度，则为 <see langword="True" />；否则为 <see langword="False" />。</span>
          <span class="sxs-lookup">
            <span data-stu-id="bea5c-762">
              <see langword="True" /> to display progress of the operation; otherwise <see langword="False" />.</span>
          </span>
          <span data-ttu-id="bea5c-763">默认值为 <see langword="False" />。</span>
          <span class="sxs-lookup">
            <span data-stu-id="bea5c-763">Default is <see langword="False" />.</span>
          </span>
        </param>
        <param name="connectionTimeout">
          <span data-ttu-id="bea5c-764">以毫秒为单位的超时间隔。</span>
          <span class="sxs-lookup">
            <span data-stu-id="bea5c-764">Timeout interval in milliseconds.</span>
          </span>
          <span data-ttu-id="bea5c-765">默认值为 100 秒。</span>
          <span class="sxs-lookup">
            <span data-stu-id="bea5c-765">Default is 100 seconds.</span>
          </span>
        </param>
        <param name="onUserCancel">
          <span data-ttu-id="bea5c-766">当用户单击“取消”时要采取的操作。</span>
          <span class="sxs-lookup">
            <span data-stu-id="bea5c-766">Action to be taken when the user clicks **Cancel**.</span>
          </span>
          <span data-ttu-id="bea5c-767">默认值为 <see cref="F:Microsoft.VisualBasic.FileIO.UICancelOption.ThrowException" />。</span>
          <span class="sxs-lookup">
            <span data-stu-id="bea5c-767">Default is <see cref="F:Microsoft.VisualBasic.FileIO.UICancelOption.ThrowException" />.</span>
          </span>
        </param>
        <summary>
          <span data-ttu-id="bea5c-768">将指定的文件发送到指定的主机地址。</span>
          <span class="sxs-lookup">
            <span data-stu-id="bea5c-768">Sends the specified file to the specified host address.</span>
          </span>
        </summary>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="bea5c-769">如果`showUI`设置为`True`，对话框中显示操作的进度，其中包括**取消**用户可以单击以取消操作的按钮。</span><span class="sxs-lookup"><span data-stu-id="bea5c-769">If `showUI` is set to `True`, a dialog box shows the progress of the operation and includes a **Cancel** button that the user can click to cancel the operation.</span></span> <span data-ttu-id="bea5c-770">由于对话框的不是模式，它不会阻止其他 windows 程序中的用户输入。</span><span class="sxs-lookup"><span data-stu-id="bea5c-770">Because the dialog box is not modal, it does not block user input to other windows in the program.</span></span>  
  
 <span data-ttu-id="bea5c-771">如果服务器没有响应中指定的间隔内`connectionTimeout`，将取消该操作并引发异常。</span><span class="sxs-lookup"><span data-stu-id="bea5c-771">If the server does not respond within the interval specified in `connectionTimeout`, the operation is cancelled and an exception is thrown.</span></span>  
  
 <span data-ttu-id="bea5c-772">`My.Computer.Network.UploadFile` 在应用程序中启用网络跟踪后，跟踪信息输出。</span><span class="sxs-lookup"><span data-stu-id="bea5c-772">`My.Computer.Network.UploadFile` outputs trace information when you enable network tracing in your application.</span></span> <span data-ttu-id="bea5c-773">有关详细信息，请参阅[启用网络跟踪](~/docs/framework/network-programming/enabling-network-tracing.md)。</span><span class="sxs-lookup"><span data-stu-id="bea5c-773">For more information, see [Enabling Network Tracing](~/docs/framework/network-programming/enabling-network-tracing.md).</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="bea5c-774">FTP 协议发送的信息，包括以纯文本密码，并不应使用用于传输敏感信息。</span><span class="sxs-lookup"><span data-stu-id="bea5c-774">The FTP protocol sends information, including passwords, in plain text and should not be used for transmitting sensitive information.</span></span>  
  
 <span data-ttu-id="bea5c-775">下表列出的任务涉及示例`My.Computer.Network.UploadFile`方法。</span><span class="sxs-lookup"><span data-stu-id="bea5c-775">The following table lists an example of a task involving the `My.Computer.Network.UploadFile` method.</span></span>  
  
|<span data-ttu-id="bea5c-776">到</span><span class="sxs-lookup"><span data-stu-id="bea5c-776">To</span></span>|<span data-ttu-id="bea5c-777">查看</span><span class="sxs-lookup"><span data-stu-id="bea5c-777">See</span></span>|  
|-|-|  
|<span data-ttu-id="bea5c-778">上传文件</span><span class="sxs-lookup"><span data-stu-id="bea5c-778">Upload a file</span></span>|[<span data-ttu-id="bea5c-779">如何：上载文件</span><span class="sxs-lookup"><span data-stu-id="bea5c-779">How to: Upload a File</span></span>](~/docs/visual-basic/developing-apps/programming/computer-resources/how-to-upload-a-file.md)|  
  
   
  
## Examples  
 <span data-ttu-id="bea5c-780">此示例将文件上传`Order.txt`到`http://www.cohowinery.com/uploads`。</span><span class="sxs-lookup"><span data-stu-id="bea5c-780">This example uploads the file `Order.txt` to `http://www.cohowinery.com/uploads`.</span></span>  
  
 [!code-vb[VbVbalrMyNetwork#2](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbalrMyNetwork/VB/Class1.vb#2)]  
  
 <span data-ttu-id="bea5c-781">此示例在不提供用户名或密码的情况下将文件 `Order.txt` 上传到 `http://www.cohowinery.com/uploads`显示了上传操作的进度，并将将超时间隔为 500 毫秒。</span><span class="sxs-lookup"><span data-stu-id="bea5c-781">This example uploads the file `Order.txt` to `http://www.cohowinery.com/uploads` without supplying a user name or password, shows the progress of the upload, and has a time-out interval of 500 milliseconds.</span></span>  
  
 [!code-vb[VbVbalrMyNetwork#3](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbalrMyNetwork/VB/Class1.vb#3)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentException">
          <span data-ttu-id="bea5c-782">
            <paramref name="connectionTimeout" /> 小于或等于零。</span>
          <span class="sxs-lookup">
            <span data-stu-id="bea5c-782">
              <paramref name="connectionTimeout" /> is less than or equal to zero.</span>
          </span>
        </exception>
        <exception cref="T:System.InvalidOperationException">
          <span data-ttu-id="bea5c-783">
            <paramref name="address" />不包括文件名。</span>
          <span class="sxs-lookup">
            <span data-stu-id="bea5c-783">
              <paramref name="address" /> does not include a file name.</span>
          </span>
        </exception>
        <exception cref="T:System.Security.SecurityException">
          <span data-ttu-id="bea5c-784">用户缺少必要的权限，无法执行网络操作。</span>
          <span class="sxs-lookup">
            <span data-stu-id="bea5c-784">User lacks necessary permissions to perform a network operation.</span>
          </span>
        </exception>
        <exception cref="T:System.TimeoutException">
          <span data-ttu-id="bea5c-785">服务器没有在指定的 <paramref name="connectionTimeout" /> 内响应。</span>
          <span class="sxs-lookup">
            <span data-stu-id="bea5c-785">The server does not respond within the specified <paramref name="connectionTimeout" />.</span>
          </span>
        </exception>
        <exception cref="T:System.Net.WebException">
          <span data-ttu-id="bea5c-786">请求被目标 Web 服务器拒绝。</span>
          <span class="sxs-lookup">
            <span data-stu-id="bea5c-786">The request is denied by the target web server.</span>
          </span>
        </exception>
        <permission cref="T:System.Security.Permissions.FileIOPermission">
          <span data-ttu-id="bea5c-787">控制文件和文件夹的访问权限。</span>
          <span class="sxs-lookup">
            <span data-stu-id="bea5c-787">Controls the ability to access files and folders.</span>
          </span>
          <span data-ttu-id="bea5c-788">关联枚举：<see cref="F:System.Security.Permissions.PermissionState.Unrestricted" />。</span>
          <span class="sxs-lookup">
            <span data-stu-id="bea5c-788">Associated enumeration: <see cref="F:System.Security.Permissions.PermissionState.Unrestricted" />.</span>
          </span>
        </permission>
        <permission cref="T:System.Security.Permissions.UIPermission">
          <span data-ttu-id="bea5c-789">控制与用户界面和剪贴板相关的权限。</span>
          <span class="sxs-lookup">
            <span data-stu-id="bea5c-789">Controls the permissions related to user interfaces and the clipboard.</span>
          </span>
          <span data-ttu-id="bea5c-790">关联枚举：<see cref="F:System.Security.Permissions.UIPermissionWindow.AllWindows" />。</span>
          <span class="sxs-lookup">
            <span data-stu-id="bea5c-790">Associated enumeration: <see cref="F:System.Security.Permissions.UIPermissionWindow.AllWindows" />.</span>
          </span>
        </permission>
        <permission cref="T:System.Net.WebPermission">
          <span data-ttu-id="bea5c-791">控制访问 HTTP Internet 资源的权限。</span>
          <span class="sxs-lookup">
            <span data-stu-id="bea5c-791">Controls rights to access HTTP Internet resources.</span>
          </span>
          <span data-ttu-id="bea5c-792">关联枚举：<see cref="F:System.Security.Permissions.PermissionState.Unrestricted" />。</span>
          <span class="sxs-lookup">
            <span data-stu-id="bea5c-792">Associated enumeration: <see cref="F:System.Security.Permissions.PermissionState.Unrestricted" />.</span>
          </span>
        </permission>
        <altmember cref="T:System.Uri" />
        <altmember cref="T:System.Net.ICredentials" />
        <altmember cref="T:Microsoft.VisualBasic.FileIO.UICancelOption" />
      </Docs>
    </Member>
    <Member MemberName="UploadFile">
      <MemberSignature Language="C#" Value="public void UploadFile (string sourceFileName, Uri address, string userName, string password, bool showUI, int connectionTimeout);" />
      <MemberSignature Language="ILAsm" Value=".method public instance void UploadFile(string sourceFileName, class System.Uri address, string userName, string password, bool showUI, int32 connectionTimeout) cil managed" />
      <MemberSignature Language="DocId" Value="M:Microsoft.VisualBasic.Devices.Network.UploadFile(System.String,System.Uri,System.String,System.String,System.Boolean,System.Int32)" />
      <MemberSignature Language="VB.NET" Value="Public Sub UploadFile (sourceFileName As String, address As Uri, userName As String, password As String, showUI As Boolean, connectionTimeout As Integer)" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; void UploadFile(System::String ^ sourceFileName, Uri ^ address, System::String ^ userName, System::String ^ password, bool showUI, int connectionTimeout);" />
      <MemberSignature Language="F#" Value="member this.UploadFile : string * Uri * string * string * bool * int -&gt; unit" Usage="network.UploadFile (sourceFileName, address, userName, password, showUI, connectionTimeout)" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>Microsoft.VisualBasic</AssemblyName>
        <AssemblyVersion>8.0.0.0</AssemblyVersion>
        <AssemblyVersion>10.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Attributes>
        <Attribute FrameworkAlternate="netframework-4.0">
          <AttributeName>System.Runtime.TargetedPatchingOptOut("Performance critical to inline this type of method across NGen image boundaries")</AttributeName>
        </Attribute>
      </Attributes>
      <ReturnValue>
        <ReturnType>System.Void</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="sourceFileName" Type="System.String" />
        <Parameter Name="address" Type="System.Uri" />
        <Parameter Name="userName" Type="System.String" />
        <Parameter Name="password" Type="System.String" />
        <Parameter Name="showUI" Type="System.Boolean" />
        <Parameter Name="connectionTimeout" Type="System.Int32" />
      </Parameters>
      <Docs>
        <param name="sourceFileName">
          <span data-ttu-id="bea5c-793">要上载的文件的路径和名称。</span>
          <span class="sxs-lookup">
            <span data-stu-id="bea5c-793">Path and name of file to upload.</span>
          </span>
        </param>
        <param name="address">
          <span data-ttu-id="bea5c-794">目标服务器的 URL、IP 地址或 URI。</span>
          <span class="sxs-lookup">
            <span data-stu-id="bea5c-794">URL, IP address, or URI of destination server.</span>
          </span>
        </param>
        <param name="userName">
          <span data-ttu-id="bea5c-795">要进行身份验证的用户名。</span>
          <span class="sxs-lookup">
            <span data-stu-id="bea5c-795">User name to authenticate.</span>
          </span>
          <span data-ttu-id="bea5c-796">默认值为空字符串：<c>""</c>。</span>
          <span class="sxs-lookup">
            <span data-stu-id="bea5c-796">Default is an empty string: <c>""</c>.</span>
          </span>
        </param>
        <param name="password">
          <span data-ttu-id="bea5c-797">要验证的密码。</span>
          <span class="sxs-lookup">
            <span data-stu-id="bea5c-797">Password to authenticate.</span>
          </span>
          <span data-ttu-id="bea5c-798">默认值为空字符串：<c>""</c>。</span>
          <span class="sxs-lookup">
            <span data-stu-id="bea5c-798">Default is an empty string: <c>""</c>.</span>
          </span>
        </param>
        <param name="showUI">
          <span data-ttu-id="bea5c-799">要显示操作进度，则为 <see langword="True" />；否则为 <see langword="False" />。</span>
          <span class="sxs-lookup">
            <span data-stu-id="bea5c-799">
              <see langword="True" /> to display progress of the operation; otherwise <see langword="False" />.</span>
          </span>
          <span data-ttu-id="bea5c-800">默认值为 <see langword="False" />。</span>
          <span class="sxs-lookup">
            <span data-stu-id="bea5c-800">Default is <see langword="False" />.</span>
          </span>
        </param>
        <param name="connectionTimeout">
          <span data-ttu-id="bea5c-801">以毫秒为单位的超时间隔。</span>
          <span class="sxs-lookup">
            <span data-stu-id="bea5c-801">Timeout interval in milliseconds.</span>
          </span>
          <span data-ttu-id="bea5c-802">默认值为 100 秒。</span>
          <span class="sxs-lookup">
            <span data-stu-id="bea5c-802">Default is 100 seconds.</span>
          </span>
        </param>
        <summary>
          <span data-ttu-id="bea5c-803">将指定的文件发送到指定的主机地址。</span>
          <span class="sxs-lookup">
            <span data-stu-id="bea5c-803">Sends the specified file to the specified host address.</span>
          </span>
        </summary>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="bea5c-804">如果`showUI`设置为`True`，对话框中显示操作的进度，其中包括**取消**用户可以单击以取消操作的按钮。</span><span class="sxs-lookup"><span data-stu-id="bea5c-804">If `showUI` is set to `True`, a dialog box shows the progress of the operation and includes a **Cancel** button that the user can click to cancel the operation.</span></span> <span data-ttu-id="bea5c-805">由于对话框的不是模式，它不会阻止其他 windows 程序中的用户输入。</span><span class="sxs-lookup"><span data-stu-id="bea5c-805">Because the dialog box is not modal, it does not block user input to other windows in the program.</span></span>  
  
 <span data-ttu-id="bea5c-806">如果服务器没有响应中指定的间隔内`connectionTimeout`，将取消该操作并引发异常。</span><span class="sxs-lookup"><span data-stu-id="bea5c-806">If the server does not respond within the interval specified in `connectionTimeout`, the operation is cancelled and an exception is thrown.</span></span>  
  
 <span data-ttu-id="bea5c-807">`My.Computer.Network.UploadFile` 在应用程序中启用网络跟踪后，跟踪信息输出。</span><span class="sxs-lookup"><span data-stu-id="bea5c-807">`My.Computer.Network.UploadFile` outputs trace information when you enable network tracing in your application.</span></span> <span data-ttu-id="bea5c-808">有关详细信息，请参阅[启用网络跟踪](~/docs/framework/network-programming/enabling-network-tracing.md)。</span><span class="sxs-lookup"><span data-stu-id="bea5c-808">For more information, see [Enabling Network Tracing](~/docs/framework/network-programming/enabling-network-tracing.md).</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="bea5c-809">FTP 协议发送的信息，包括以纯文本密码，并不应使用用于传输敏感信息。</span><span class="sxs-lookup"><span data-stu-id="bea5c-809">The FTP protocol sends information, including passwords, in plain text and should not be used for transmitting sensitive information.</span></span>  
  
 <span data-ttu-id="bea5c-810">下表列出的任务涉及示例`My.Computer.Network.UploadFile`方法。</span><span class="sxs-lookup"><span data-stu-id="bea5c-810">The following table lists an example of a task involving the `My.Computer.Network.UploadFile` method.</span></span>  
  
|<span data-ttu-id="bea5c-811">到</span><span class="sxs-lookup"><span data-stu-id="bea5c-811">To</span></span>|<span data-ttu-id="bea5c-812">查看</span><span class="sxs-lookup"><span data-stu-id="bea5c-812">See</span></span>|  
|-|-|  
|<span data-ttu-id="bea5c-813">上传文件</span><span class="sxs-lookup"><span data-stu-id="bea5c-813">Upload a file</span></span>|[<span data-ttu-id="bea5c-814">如何：上载文件</span><span class="sxs-lookup"><span data-stu-id="bea5c-814">How to: Upload a File</span></span>](~/docs/visual-basic/developing-apps/programming/computer-resources/how-to-upload-a-file.md)|  
  
   
  
## Examples  
 <span data-ttu-id="bea5c-815">此示例将文件上传`Order.txt`到`http://www.cohowinery.com/uploads`。</span><span class="sxs-lookup"><span data-stu-id="bea5c-815">This example uploads the file `Order.txt` to `http://www.cohowinery.com/uploads`.</span></span>  
  
 [!code-vb[VbVbalrMyNetwork#2](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbalrMyNetwork/VB/Class1.vb#2)]  
  
 <span data-ttu-id="bea5c-816">此示例在不提供用户名或密码的情况下将文件 `Order.txt` 上传到 `http://www.cohowinery.com/uploads`显示了上传操作的进度，并将将超时间隔为 500 毫秒。</span><span class="sxs-lookup"><span data-stu-id="bea5c-816">This example uploads the file `Order.txt` to `http://www.cohowinery.com/uploads` without supplying a user name or password, shows the progress of the upload, and has a time-out interval of 500 milliseconds.</span></span>  
  
 [!code-vb[VbVbalrMyNetwork#3](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbalrMyNetwork/VB/Class1.vb#3)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentException">
          <span data-ttu-id="bea5c-817">
            <paramref name="connectionTimeout" /> 小于或等于零。</span>
          <span class="sxs-lookup">
            <span data-stu-id="bea5c-817">
              <paramref name="connectionTimeout" /> is less than or equal to zero.</span>
          </span>
        </exception>
        <exception cref="T:System.InvalidOperationException">
          <span data-ttu-id="bea5c-818">
            <paramref name="address" />不包括文件名。</span>
          <span class="sxs-lookup">
            <span data-stu-id="bea5c-818">
              <paramref name="address" /> does not include a file name.</span>
          </span>
        </exception>
        <exception cref="T:System.Security.SecurityException">
          <span data-ttu-id="bea5c-819">用户缺少必要的权限，无法执行网络操作。</span>
          <span class="sxs-lookup">
            <span data-stu-id="bea5c-819">User lacks necessary permissions to perform a network operation.</span>
          </span>
        </exception>
        <exception cref="T:System.TimeoutException">
          <span data-ttu-id="bea5c-820">服务器没有在指定的 <paramref name="connectionTimeout" /> 内响应。</span>
          <span class="sxs-lookup">
            <span data-stu-id="bea5c-820">The server does not respond within the specified <paramref name="connectionTimeout" />.</span>
          </span>
        </exception>
        <exception cref="T:System.Net.WebException">
          <span data-ttu-id="bea5c-821">请求被目标 Web 服务器拒绝。</span>
          <span class="sxs-lookup">
            <span data-stu-id="bea5c-821">The request is denied by the target web server.</span>
          </span>
        </exception>
        <permission cref="T:System.Security.Permissions.FileIOPermission">
          <span data-ttu-id="bea5c-822">控制文件和文件夹的访问权限。</span>
          <span class="sxs-lookup">
            <span data-stu-id="bea5c-822">Controls the ability to access files and folders.</span>
          </span>
          <span data-ttu-id="bea5c-823">关联枚举：<see cref="F:System.Security.Permissions.PermissionState.Unrestricted" />。</span>
          <span class="sxs-lookup">
            <span data-stu-id="bea5c-823">Associated enumeration: <see cref="F:System.Security.Permissions.PermissionState.Unrestricted" />.</span>
          </span>
        </permission>
        <permission cref="T:System.Security.Permissions.UIPermission">
          <span data-ttu-id="bea5c-824">控制与用户界面和剪贴板相关的权限。</span>
          <span class="sxs-lookup">
            <span data-stu-id="bea5c-824">Controls the permissions related to user interfaces and the clipboard.</span>
          </span>
          <span data-ttu-id="bea5c-825">关联枚举：<see cref="F:System.Security.Permissions.UIPermissionWindow.AllWindows" />。</span>
          <span class="sxs-lookup">
            <span data-stu-id="bea5c-825">Associated enumeration: <see cref="F:System.Security.Permissions.UIPermissionWindow.AllWindows" />.</span>
          </span>
        </permission>
        <permission cref="T:System.Net.WebPermission">
          <span data-ttu-id="bea5c-826">控制访问 HTTP Internet 资源的权限。</span>
          <span class="sxs-lookup">
            <span data-stu-id="bea5c-826">Controls rights to access HTTP Internet resources.</span>
          </span>
          <span data-ttu-id="bea5c-827">关联枚举：<see cref="F:System.Security.Permissions.PermissionState.Unrestricted" />。</span>
          <span class="sxs-lookup">
            <span data-stu-id="bea5c-827">Associated enumeration: <see cref="F:System.Security.Permissions.PermissionState.Unrestricted" />.</span>
          </span>
        </permission>
        <altmember cref="T:System.Uri" />
        <altmember cref="T:System.Net.ICredentials" />
        <altmember cref="T:Microsoft.VisualBasic.FileIO.UICancelOption" />
      </Docs>
    </Member>
    <Member MemberName="UploadFile">
      <MemberSignature Language="C#" Value="public void UploadFile (string sourceFileName, string address, string userName, string password, bool showUI, int connectionTimeout, Microsoft.VisualBasic.FileIO.UICancelOption onUserCancel);" />
      <MemberSignature Language="ILAsm" Value=".method public instance void UploadFile(string sourceFileName, string address, string userName, string password, bool showUI, int32 connectionTimeout, valuetype Microsoft.VisualBasic.FileIO.UICancelOption onUserCancel) cil managed" />
      <MemberSignature Language="DocId" Value="M:Microsoft.VisualBasic.Devices.Network.UploadFile(System.String,System.String,System.String,System.String,System.Boolean,System.Int32,Microsoft.VisualBasic.FileIO.UICancelOption)" />
      <MemberSignature Language="VB.NET" Value="Public Sub UploadFile (sourceFileName As String, address As String, userName As String, password As String, showUI As Boolean, connectionTimeout As Integer, onUserCancel As UICancelOption)" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; void UploadFile(System::String ^ sourceFileName, System::String ^ address, System::String ^ userName, System::String ^ password, bool showUI, int connectionTimeout, Microsoft::VisualBasic::FileIO::UICancelOption onUserCancel);" />
      <MemberSignature Language="F#" Value="member this.UploadFile : string * string * string * string * bool * int * Microsoft.VisualBasic.FileIO.UICancelOption -&gt; unit" Usage="network.UploadFile (sourceFileName, address, userName, password, showUI, connectionTimeout, onUserCancel)" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>Microsoft.VisualBasic</AssemblyName>
        <AssemblyVersion>8.0.0.0</AssemblyVersion>
        <AssemblyVersion>10.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Void</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="sourceFileName" Type="System.String" />
        <Parameter Name="address" Type="System.String" />
        <Parameter Name="userName" Type="System.String" />
        <Parameter Name="password" Type="System.String" />
        <Parameter Name="showUI" Type="System.Boolean" />
        <Parameter Name="connectionTimeout" Type="System.Int32" />
        <Parameter Name="onUserCancel" Type="Microsoft.VisualBasic.FileIO.UICancelOption" />
      </Parameters>
      <Docs>
        <param name="sourceFileName">
          <span data-ttu-id="bea5c-828">要上载的文件的路径和名称。</span>
          <span class="sxs-lookup">
            <span data-stu-id="bea5c-828">Path and name of file to upload.</span>
          </span>
        </param>
        <param name="address">
          <span data-ttu-id="bea5c-829">目标服务器的 URL、IP 地址或 URI。</span>
          <span class="sxs-lookup">
            <span data-stu-id="bea5c-829">URL, IP address, or URI of destination server.</span>
          </span>
        </param>
        <param name="userName">
          <span data-ttu-id="bea5c-830">要进行身份验证的用户名。</span>
          <span class="sxs-lookup">
            <span data-stu-id="bea5c-830">User name to authenticate.</span>
          </span>
          <span data-ttu-id="bea5c-831">默认值为空字符串：<c>""</c>。</span>
          <span class="sxs-lookup">
            <span data-stu-id="bea5c-831">Default is an empty string: <c>""</c>.</span>
          </span>
        </param>
        <param name="password">
          <span data-ttu-id="bea5c-832">要验证的密码。</span>
          <span class="sxs-lookup">
            <span data-stu-id="bea5c-832">Password to authenticate.</span>
          </span>
          <span data-ttu-id="bea5c-833">默认值为空字符串：<c>""</c>。</span>
          <span class="sxs-lookup">
            <span data-stu-id="bea5c-833">Default is an empty string: <c>""</c>.</span>
          </span>
        </param>
        <param name="showUI">
          <span data-ttu-id="bea5c-834">是否显示操作进度。</span>
          <span class="sxs-lookup">
            <span data-stu-id="bea5c-834">Whether to display progress of the operation.</span>
          </span>
          <span data-ttu-id="bea5c-835">默认值为 <see langword="False" />。</span>
          <span class="sxs-lookup">
            <span data-stu-id="bea5c-835">Default is <see langword="False" />.</span>
          </span>
        </param>
        <param name="connectionTimeout">
          <span data-ttu-id="bea5c-836">以毫秒为单位的超时间隔。</span>
          <span class="sxs-lookup">
            <span data-stu-id="bea5c-836">Timeout interval in milliseconds.</span>
          </span>
          <span data-ttu-id="bea5c-837">默认值为 100 秒。</span>
          <span class="sxs-lookup">
            <span data-stu-id="bea5c-837">Default is 100 seconds.</span>
          </span>
        </param>
        <param name="onUserCancel">
          <span data-ttu-id="bea5c-838">当用户单击“取消”时要采取的操作。</span>
          <span class="sxs-lookup">
            <span data-stu-id="bea5c-838">Action to be taken when the user clicks **Cancel**.</span>
          </span>
          <span data-ttu-id="bea5c-839">默认值为 <see cref="F:Microsoft.VisualBasic.FileIO.UICancelOption.ThrowException" />。</span>
          <span class="sxs-lookup">
            <span data-stu-id="bea5c-839">Default is <see cref="F:Microsoft.VisualBasic.FileIO.UICancelOption.ThrowException" />.</span>
          </span>
        </param>
        <summary>
          <span data-ttu-id="bea5c-840">将指定的文件发送到指定的主机地址。</span>
          <span class="sxs-lookup">
            <span data-stu-id="bea5c-840">Sends the specified file to the specified host address.</span>
          </span>
        </summary>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="bea5c-841">如果`showUI`设置为`True`，对话框中显示操作的进度，其中包括**取消**用户可以单击以取消操作的按钮。</span><span class="sxs-lookup"><span data-stu-id="bea5c-841">If `showUI` is set to `True`, a dialog box shows the progress of the operation and includes a **Cancel** button that the user can click to cancel the operation.</span></span> <span data-ttu-id="bea5c-842">由于对话框的不是模式，它不会阻止其他 windows 程序中的用户输入。</span><span class="sxs-lookup"><span data-stu-id="bea5c-842">Because the dialog box is not modal, it does not block user input to other windows in the program.</span></span>  
  
 <span data-ttu-id="bea5c-843">如果服务器没有响应中指定的间隔内`connectionTimeout`，将取消该操作并引发异常。</span><span class="sxs-lookup"><span data-stu-id="bea5c-843">If the server does not respond within the interval specified in `connectionTimeout`, the operation is cancelled and an exception is thrown.</span></span>  
  
 <span data-ttu-id="bea5c-844">`My.Computer.Network.UploadFile` 在应用程序中启用网络跟踪后，跟踪信息输出。</span><span class="sxs-lookup"><span data-stu-id="bea5c-844">`My.Computer.Network.UploadFile` outputs trace information when you enable network tracing in your application.</span></span> <span data-ttu-id="bea5c-845">有关详细信息，请参阅[启用网络跟踪](~/docs/framework/network-programming/enabling-network-tracing.md)。</span><span class="sxs-lookup"><span data-stu-id="bea5c-845">For more information, see [Enabling Network Tracing](~/docs/framework/network-programming/enabling-network-tracing.md).</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="bea5c-846">FTP 协议发送的信息，包括以纯文本密码，并不应使用用于传输敏感信息。</span><span class="sxs-lookup"><span data-stu-id="bea5c-846">The FTP protocol sends information, including passwords, in plain text and should not be used for transmitting sensitive information.</span></span>  
  
 <span data-ttu-id="bea5c-847">下表列出的任务涉及示例`My.Computer.Network.UploadFile`方法。</span><span class="sxs-lookup"><span data-stu-id="bea5c-847">The following table lists an example of a task involving the `My.Computer.Network.UploadFile` method.</span></span>  
  
|<span data-ttu-id="bea5c-848">到</span><span class="sxs-lookup"><span data-stu-id="bea5c-848">To</span></span>|<span data-ttu-id="bea5c-849">查看</span><span class="sxs-lookup"><span data-stu-id="bea5c-849">See</span></span>|  
|-|-|  
|<span data-ttu-id="bea5c-850">上传文件</span><span class="sxs-lookup"><span data-stu-id="bea5c-850">Upload a file</span></span>|[<span data-ttu-id="bea5c-851">如何：上载文件</span><span class="sxs-lookup"><span data-stu-id="bea5c-851">How to: Upload a File</span></span>](~/docs/visual-basic/developing-apps/programming/computer-resources/how-to-upload-a-file.md)|  
  
   
  
## Examples  
 <span data-ttu-id="bea5c-852">此示例将文件上传`Order.txt`到`http://www.cohowinery.com/uploads`。</span><span class="sxs-lookup"><span data-stu-id="bea5c-852">This example uploads the file `Order.txt` to `http://www.cohowinery.com/uploads`.</span></span>  
  
 [!code-vb[VbVbalrMyNetwork#2](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbalrMyNetwork/VB/Class1.vb#2)]  
  
 <span data-ttu-id="bea5c-853">此示例在不提供用户名或密码的情况下将文件 `Order.txt` 上传到 `http://www.cohowinery.com/uploads`显示了上传操作的进度，并将将超时间隔为 500 毫秒。</span><span class="sxs-lookup"><span data-stu-id="bea5c-853">This example uploads the file `Order.txt` to `http://www.cohowinery.com/uploads` without supplying a user name or password, shows the progress of the upload, and has a time-out interval of 500 milliseconds.</span></span>  
  
 [!code-vb[VbVbalrMyNetwork#3](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbalrMyNetwork/VB/Class1.vb#3)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentException">
          <span data-ttu-id="bea5c-854">
            <paramref name="connectionTimeout" /> 小于或等于零。</span>
          <span class="sxs-lookup">
            <span data-stu-id="bea5c-854">
              <paramref name="connectionTimeout" /> is less than or equal to zero.</span>
          </span>
        </exception>
        <exception cref="T:System.InvalidOperationException">
          <span data-ttu-id="bea5c-855">
            <paramref name="address" />不包括文件名。</span>
          <span class="sxs-lookup">
            <span data-stu-id="bea5c-855">
              <paramref name="address" /> does not include a file name.</span>
          </span>
        </exception>
        <exception cref="T:System.Security.SecurityException">
          <span data-ttu-id="bea5c-856">用户缺少必要的权限，无法执行网络操作。</span>
          <span class="sxs-lookup">
            <span data-stu-id="bea5c-856">User lacks necessary permissions to perform a network operation.</span>
          </span>
        </exception>
        <exception cref="T:System.TimeoutException">
          <span data-ttu-id="bea5c-857">服务器没有在指定的 <paramref name="connectionTimeout" /> 内响应。</span>
          <span class="sxs-lookup">
            <span data-stu-id="bea5c-857">The server does not respond within the specified <paramref name="connectionTimeout" />.</span>
          </span>
        </exception>
        <exception cref="T:System.Net.WebException">
          <span data-ttu-id="bea5c-858">请求被目标 Web 服务器拒绝。</span>
          <span class="sxs-lookup">
            <span data-stu-id="bea5c-858">The request is denied by the target web server.</span>
          </span>
        </exception>
        <permission cref="T:System.Security.Permissions.FileIOPermission">
          <span data-ttu-id="bea5c-859">控制文件和文件夹的访问权限。</span>
          <span class="sxs-lookup">
            <span data-stu-id="bea5c-859">Controls the ability to access files and folders.</span>
          </span>
          <span data-ttu-id="bea5c-860">关联枚举：<see cref="F:System.Security.Permissions.PermissionState.Unrestricted" />。</span>
          <span class="sxs-lookup">
            <span data-stu-id="bea5c-860">Associated enumeration: <see cref="F:System.Security.Permissions.PermissionState.Unrestricted" />.</span>
          </span>
        </permission>
        <permission cref="T:System.Security.Permissions.UIPermission">
          <span data-ttu-id="bea5c-861">控制与用户界面和剪贴板相关的权限。</span>
          <span class="sxs-lookup">
            <span data-stu-id="bea5c-861">Controls the permissions related to user interfaces and the clipboard.</span>
          </span>
          <span data-ttu-id="bea5c-862">关联枚举：<see cref="F:System.Security.Permissions.UIPermissionWindow.AllWindows" />。</span>
          <span class="sxs-lookup">
            <span data-stu-id="bea5c-862">Associated enumeration: <see cref="F:System.Security.Permissions.UIPermissionWindow.AllWindows" />.</span>
          </span>
        </permission>
        <permission cref="T:System.Net.WebPermission">
          <span data-ttu-id="bea5c-863">控制访问 HTTP Internet 资源的权限。</span>
          <span class="sxs-lookup">
            <span data-stu-id="bea5c-863">Controls rights to access HTTP Internet resources.</span>
          </span>
          <span data-ttu-id="bea5c-864">关联枚举：<see cref="F:System.Security.Permissions.PermissionState.Unrestricted" />。</span>
          <span class="sxs-lookup">
            <span data-stu-id="bea5c-864">Associated enumeration: <see cref="F:System.Security.Permissions.PermissionState.Unrestricted" />.</span>
          </span>
        </permission>
        <altmember cref="T:System.Uri" />
        <altmember cref="T:System.Net.ICredentials" />
        <altmember cref="T:Microsoft.VisualBasic.FileIO.UICancelOption" />
      </Docs>
    </Member>
    <Member MemberName="UploadFile">
      <MemberSignature Language="C#" Value="public void UploadFile (string sourceFileName, Uri address, string userName, string password, bool showUI, int connectionTimeout, Microsoft.VisualBasic.FileIO.UICancelOption onUserCancel);" />
      <MemberSignature Language="ILAsm" Value=".method public instance void UploadFile(string sourceFileName, class System.Uri address, string userName, string password, bool showUI, int32 connectionTimeout, valuetype Microsoft.VisualBasic.FileIO.UICancelOption onUserCancel) cil managed" />
      <MemberSignature Language="DocId" Value="M:Microsoft.VisualBasic.Devices.Network.UploadFile(System.String,System.Uri,System.String,System.String,System.Boolean,System.Int32,Microsoft.VisualBasic.FileIO.UICancelOption)" />
      <MemberSignature Language="VB.NET" Value="Public Sub UploadFile (sourceFileName As String, address As Uri, userName As String, password As String, showUI As Boolean, connectionTimeout As Integer, onUserCancel As UICancelOption)" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; void UploadFile(System::String ^ sourceFileName, Uri ^ address, System::String ^ userName, System::String ^ password, bool showUI, int connectionTimeout, Microsoft::VisualBasic::FileIO::UICancelOption onUserCancel);" />
      <MemberSignature Language="F#" Value="member this.UploadFile : string * Uri * string * string * bool * int * Microsoft.VisualBasic.FileIO.UICancelOption -&gt; unit" Usage="network.UploadFile (sourceFileName, address, userName, password, showUI, connectionTimeout, onUserCancel)" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>Microsoft.VisualBasic</AssemblyName>
        <AssemblyVersion>8.0.0.0</AssemblyVersion>
        <AssemblyVersion>10.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Void</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="sourceFileName" Type="System.String" />
        <Parameter Name="address" Type="System.Uri" />
        <Parameter Name="userName" Type="System.String" />
        <Parameter Name="password" Type="System.String" />
        <Parameter Name="showUI" Type="System.Boolean" />
        <Parameter Name="connectionTimeout" Type="System.Int32" />
        <Parameter Name="onUserCancel" Type="Microsoft.VisualBasic.FileIO.UICancelOption" />
      </Parameters>
      <Docs>
        <param name="sourceFileName">
          <span data-ttu-id="bea5c-865">要上载的文件的路径和名称。</span>
          <span class="sxs-lookup">
            <span data-stu-id="bea5c-865">Path and name of file to upload.</span>
          </span>
        </param>
        <param name="address">
          <span data-ttu-id="bea5c-866">目标服务器的 URL、IP 地址或 URI。</span>
          <span class="sxs-lookup">
            <span data-stu-id="bea5c-866">URL, IP address, or URI of destination server.</span>
          </span>
        </param>
        <param name="userName">
          <span data-ttu-id="bea5c-867">要进行身份验证的用户名。</span>
          <span class="sxs-lookup">
            <span data-stu-id="bea5c-867">User name to authenticate.</span>
          </span>
          <span data-ttu-id="bea5c-868">默认值为空字符串：<c>""</c>。</span>
          <span class="sxs-lookup">
            <span data-stu-id="bea5c-868">Default is an empty string: <c>""</c>.</span>
          </span>
        </param>
        <param name="password">
          <span data-ttu-id="bea5c-869">要验证的密码。</span>
          <span class="sxs-lookup">
            <span data-stu-id="bea5c-869">Password to authenticate.</span>
          </span>
          <span data-ttu-id="bea5c-870">默认值为空字符串：<c>""</c>。</span>
          <span class="sxs-lookup">
            <span data-stu-id="bea5c-870">Default is an empty string: <c>""</c>.</span>
          </span>
        </param>
        <param name="showUI">
          <span data-ttu-id="bea5c-871">是否显示操作进度。</span>
          <span class="sxs-lookup">
            <span data-stu-id="bea5c-871">Whether to display progress of the operation.</span>
          </span>
          <span data-ttu-id="bea5c-872">默认值为 <see langword="False" />。</span>
          <span class="sxs-lookup">
            <span data-stu-id="bea5c-872">Default is <see langword="False" />.</span>
          </span>
        </param>
        <param name="connectionTimeout">
          <span data-ttu-id="bea5c-873">以毫秒为单位的超时间隔。</span>
          <span class="sxs-lookup">
            <span data-stu-id="bea5c-873">Timeout interval in milliseconds.</span>
          </span>
          <span data-ttu-id="bea5c-874">默认值为 100 秒。</span>
          <span class="sxs-lookup">
            <span data-stu-id="bea5c-874">Default is 100 seconds.</span>
          </span>
        </param>
        <param name="onUserCancel">
          <span data-ttu-id="bea5c-875">当用户单击“取消”时要采取的操作。</span>
          <span class="sxs-lookup">
            <span data-stu-id="bea5c-875">Action to be taken when the user clicks **Cancel**.</span>
          </span>
          <span data-ttu-id="bea5c-876">默认值为 <see cref="F:Microsoft.VisualBasic.FileIO.UICancelOption.ThrowException" />。</span>
          <span class="sxs-lookup">
            <span data-stu-id="bea5c-876">Default is <see cref="F:Microsoft.VisualBasic.FileIO.UICancelOption.ThrowException" />.</span>
          </span>
        </param>
        <summary>
          <span data-ttu-id="bea5c-877">将指定的文件发送到指定的主机地址。</span>
          <span class="sxs-lookup">
            <span data-stu-id="bea5c-877">Sends the specified file to the specified host address.</span>
          </span>
        </summary>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="bea5c-878">如果`showUI`设置为`True`，对话框中显示操作的进度，其中包括**取消**用户可以单击以取消操作的按钮。</span><span class="sxs-lookup"><span data-stu-id="bea5c-878">If `showUI` is set to `True`, a dialog box shows the progress of the operation and includes a **Cancel** button that the user can click to cancel the operation.</span></span> <span data-ttu-id="bea5c-879">由于对话框的不是模式，它不会阻止其他 windows 程序中的用户输入。</span><span class="sxs-lookup"><span data-stu-id="bea5c-879">Because the dialog box is not modal, it does not block user input to other windows in the program.</span></span>  
  
 <span data-ttu-id="bea5c-880">如果服务器没有响应中指定的间隔内`connectionTimeout`，将取消该操作并引发异常。</span><span class="sxs-lookup"><span data-stu-id="bea5c-880">If the server does not respond within the interval specified in `connectionTimeout`, the operation is cancelled and an exception is thrown.</span></span>  
  
 <span data-ttu-id="bea5c-881">`My.Computer.Network.UploadFile` 在应用程序中启用网络跟踪后，跟踪信息输出。</span><span class="sxs-lookup"><span data-stu-id="bea5c-881">`My.Computer.Network.UploadFile` outputs trace information when you enable network tracing in your application.</span></span> <span data-ttu-id="bea5c-882">有关详细信息，请参阅[启用网络跟踪](~/docs/framework/network-programming/enabling-network-tracing.md)。</span><span class="sxs-lookup"><span data-stu-id="bea5c-882">For more information, see [Enabling Network Tracing](~/docs/framework/network-programming/enabling-network-tracing.md).</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="bea5c-883">FTP 协议发送的信息，包括以纯文本密码，并不应使用用于传输敏感信息。</span><span class="sxs-lookup"><span data-stu-id="bea5c-883">The FTP protocol sends information, including passwords, in plain text and should not be used for transmitting sensitive information.</span></span>  
  
 <span data-ttu-id="bea5c-884">下表列出的任务涉及示例`My.Computer.Network.UploadFile`方法。</span><span class="sxs-lookup"><span data-stu-id="bea5c-884">The following table lists an example of a task involving the `My.Computer.Network.UploadFile` method.</span></span>  
  
|<span data-ttu-id="bea5c-885">到</span><span class="sxs-lookup"><span data-stu-id="bea5c-885">To</span></span>|<span data-ttu-id="bea5c-886">查看</span><span class="sxs-lookup"><span data-stu-id="bea5c-886">See</span></span>|  
|-|-|  
|<span data-ttu-id="bea5c-887">上传文件</span><span class="sxs-lookup"><span data-stu-id="bea5c-887">Upload a file</span></span>|[<span data-ttu-id="bea5c-888">如何：上载文件</span><span class="sxs-lookup"><span data-stu-id="bea5c-888">How to: Upload a File</span></span>](~/docs/visual-basic/developing-apps/programming/computer-resources/how-to-upload-a-file.md)|  
  
   
  
## Examples  
 <span data-ttu-id="bea5c-889">此示例将文件上传`Order.txt`到`http://www.cohowinery.com/uploads`。</span><span class="sxs-lookup"><span data-stu-id="bea5c-889">This example uploads the file `Order.txt` to `http://www.cohowinery.com/uploads`.</span></span>  
  
 [!code-vb[VbVbalrMyNetwork#2](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbalrMyNetwork/VB/Class1.vb#2)]  
  
 <span data-ttu-id="bea5c-890">此示例在不提供用户名或密码的情况下将文件 `Order.txt` 上传到 `http://www.cohowinery.com/uploads`显示了上传操作的进度，并将将超时间隔为 500 毫秒。</span><span class="sxs-lookup"><span data-stu-id="bea5c-890">This example uploads the file `Order.txt` to `http://www.cohowinery.com/uploads` without supplying a user name or password, shows the progress of the upload, and has a time-out interval of 500 milliseconds.</span></span>  
  
 [!code-vb[VbVbalrMyNetwork#3](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbalrMyNetwork/VB/Class1.vb#3)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentException">
          <span data-ttu-id="bea5c-891">
            <paramref name="connectionTimeout" /> 小于或等于零。</span>
          <span class="sxs-lookup">
            <span data-stu-id="bea5c-891">
              <paramref name="connectionTimeout" /> is less than or equal to zero.</span>
          </span>
        </exception>
        <exception cref="T:System.InvalidOperationException">
          <span data-ttu-id="bea5c-892">
            <paramref name="address" />不包括文件名。</span>
          <span class="sxs-lookup">
            <span data-stu-id="bea5c-892">
              <paramref name="address" /> does not include a file name.</span>
          </span>
        </exception>
        <exception cref="T:System.Security.SecurityException">
          <span data-ttu-id="bea5c-893">用户缺少必要的权限，无法执行网络操作。</span>
          <span class="sxs-lookup">
            <span data-stu-id="bea5c-893">User lacks necessary permissions to perform a network operation.</span>
          </span>
        </exception>
        <exception cref="T:System.TimeoutException">
          <span data-ttu-id="bea5c-894">服务器没有在指定的 <paramref name="connectionTimeout" /> 内响应。</span>
          <span class="sxs-lookup">
            <span data-stu-id="bea5c-894">The server does not respond within the specified <paramref name="connectionTimeout" />.</span>
          </span>
        </exception>
        <exception cref="T:System.Net.WebException">
          <span data-ttu-id="bea5c-895">请求被目标 Web 服务器拒绝。</span>
          <span class="sxs-lookup">
            <span data-stu-id="bea5c-895">The request is denied by the target web server.</span>
          </span>
        </exception>
        <permission cref="T:System.Security.Permissions.FileIOPermission">
          <span data-ttu-id="bea5c-896">控制文件和文件夹的访问权限。</span>
          <span class="sxs-lookup">
            <span data-stu-id="bea5c-896">Controls the ability to access files and folders.</span>
          </span>
          <span data-ttu-id="bea5c-897">关联枚举：<see cref="F:System.Security.Permissions.PermissionState.Unrestricted" />。</span>
          <span class="sxs-lookup">
            <span data-stu-id="bea5c-897">Associated enumeration: <see cref="F:System.Security.Permissions.PermissionState.Unrestricted" />.</span>
          </span>
        </permission>
        <permission cref="T:System.Security.Permissions.UIPermission">
          <span data-ttu-id="bea5c-898">控制与用户界面和剪贴板相关的权限。</span>
          <span class="sxs-lookup">
            <span data-stu-id="bea5c-898">Controls the permissions related to user interfaces and the clipboard.</span>
          </span>
          <span data-ttu-id="bea5c-899">关联枚举：<see cref="F:System.Security.Permissions.UIPermissionWindow.AllWindows" />。</span>
          <span class="sxs-lookup">
            <span data-stu-id="bea5c-899">Associated enumeration: <see cref="F:System.Security.Permissions.UIPermissionWindow.AllWindows" />.</span>
          </span>
        </permission>
        <permission cref="T:System.Net.WebPermission">
          <span data-ttu-id="bea5c-900">控制访问 HTTP Internet 资源的权限。</span>
          <span class="sxs-lookup">
            <span data-stu-id="bea5c-900">Controls rights to access HTTP Internet resources.</span>
          </span>
          <span data-ttu-id="bea5c-901">关联枚举：<see cref="F:System.Security.Permissions.PermissionState.Unrestricted" />。</span>
          <span class="sxs-lookup">
            <span data-stu-id="bea5c-901">Associated enumeration: <see cref="F:System.Security.Permissions.PermissionState.Unrestricted" />.</span>
          </span>
        </permission>
        <altmember cref="T:System.Uri" />
        <altmember cref="T:System.Net.ICredentials" />
        <altmember cref="T:Microsoft.VisualBasic.FileIO.UICancelOption" />
      </Docs>
    </Member>
  </Members>
</Type>