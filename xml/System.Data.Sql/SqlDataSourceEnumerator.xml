<Type Name="SqlDataSourceEnumerator" FullName="System.Data.Sql.SqlDataSourceEnumerator">
  <Metadata><Meta Name="ms.openlocfilehash" Value="1fe0772d71f3888616eb8a26bc37a028b3d8c56f" /><Meta Name="ms.sourcegitcommit" Value="2dd0eede6edd6dd3d2aa8f79010848658b967609" /><Meta Name="ms.translationtype" Value="MT" /><Meta Name="ms.contentlocale" Value="zh-CN" /><Meta Name="ms.lasthandoff" Value="04/18/2019" /><Meta Name="ms.locfileid" Value="58873973" /></Metadata><TypeSignature Language="C#" Value="public sealed class SqlDataSourceEnumerator : System.Data.Common.DbDataSourceEnumerator" />
  <TypeSignature Language="ILAsm" Value=".class public auto ansi sealed beforefieldinit SqlDataSourceEnumerator extends System.Data.Common.DbDataSourceEnumerator" />
  <TypeSignature Language="DocId" Value="T:System.Data.Sql.SqlDataSourceEnumerator" />
  <TypeSignature Language="VB.NET" Value="Public NotInheritable Class SqlDataSourceEnumerator&#xA;Inherits DbDataSourceEnumerator" />
  <TypeSignature Language="C++ CLI" Value="public ref class SqlDataSourceEnumerator sealed : System::Data::Common::DbDataSourceEnumerator" />
  <TypeSignature Language="F#" Value="type SqlDataSourceEnumerator = class&#xA;    inherit DbDataSourceEnumerator" />
  <AssemblyInfo>
    <AssemblyName>System.Data</AssemblyName>
    <AssemblyVersion>2.0.0.0</AssemblyVersion>
    <AssemblyVersion>2.0.5.0</AssemblyVersion>
    <AssemblyVersion>4.0.0.0</AssemblyVersion>
  </AssemblyInfo>
  <Base>
    <BaseTypeName>System.Data.Common.DbDataSourceEnumerator</BaseTypeName>
  </Base>
  <Interfaces />
  <Docs>
    <summary><span data-ttu-id="500f8-101">提供了一种枚举本地网络内的所有可用 SQL Server 实例的机制。</span><span class="sxs-lookup"><span data-stu-id="500f8-101">Provides a mechanism for enumerating all available instances of SQL Server within the local network.</span></span></summary>
    <remarks>
      <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="500f8-102">SQL Server 使应用程序以确定其当前网络中的实例存在。</span><span class="sxs-lookup"><span data-stu-id="500f8-102">SQL Server makes it possible for applications to determine the existence of its instances within the current network.</span></span> <span data-ttu-id="500f8-103"><xref:System.Data.Sql.SqlDataSourceEnumerator>类公开给应用程序开发人员，提供此信息<xref:System.Data.DataTable>包含所有可用的服务器的信息。</span><span class="sxs-lookup"><span data-stu-id="500f8-103">The <xref:System.Data.Sql.SqlDataSourceEnumerator> class exposes this information to the application developer, providing a <xref:System.Data.DataTable> containing information about all the available servers.</span></span> <span data-ttu-id="500f8-104">返回此表列出了与列表匹配提供当用户尝试创建新的连接的服务器实例以及`Connection Properties`对话框中，展开下拉列表，其中包含所有可用的服务器。</span><span class="sxs-lookup"><span data-stu-id="500f8-104">This returned table contains a list of server instances that matches the list provided when a user attempts to create a new connection, and on the `Connection Properties` dialog box, expands the drop-down list containing all the available servers.</span></span>  
  
 ]]></format>
    </remarks>
    <related type="Article" href="/dotnet/framework/data/adonet/sql/enumerating-instances-of-sql-server"><span data-ttu-id="500f8-105">枚举 SQL Server 的实例</span><span class="sxs-lookup"><span data-stu-id="500f8-105">Enumerating Instances of SQL Server</span></span></related>
  </Docs>
  <Members>
    <Member MemberName="GetDataSources">
      <MemberSignature Language="C#" Value="public override System.Data.DataTable GetDataSources ();" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig virtual instance class System.Data.DataTable GetDataSources() cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Data.Sql.SqlDataSourceEnumerator.GetDataSources" />
      <MemberSignature Language="VB.NET" Value="Public Overrides Function GetDataSources () As DataTable" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; override System::Data::DataTable ^ GetDataSources();" />
      <MemberSignature Language="F#" Value="override this.GetDataSources : unit -&gt; System.Data.DataTable" Usage="sqlDataSourceEnumerator.GetDataSources " />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Data</AssemblyName>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>2.0.5.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Data.DataTable</ReturnType>
      </ReturnValue>
      <Parameters />
      <Docs>
        <summary><span data-ttu-id="500f8-106">检索包含有关所有可见 SQL Server 实例的信息的 <see cref="T:System.Data.DataTable" />。</span><span class="sxs-lookup"><span data-stu-id="500f8-106">Retrieves a <see cref="T:System.Data.DataTable" /> containing information about all visible SQL Server instances.</span></span></summary>
        <returns><span data-ttu-id="500f8-107">一个 <see cref="T:System.Data.DataTable" />，包含有关可见 SQL Server 实例的信息。</span><span class="sxs-lookup"><span data-stu-id="500f8-107">A <see cref="T:System.Data.DataTable" /> containing information about the visible SQL Server instances.</span></span></returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="500f8-108">此方法返回的表包含以下列，所有这些包含字符串：</span><span class="sxs-lookup"><span data-stu-id="500f8-108">The table returned by this method contains the following columns, all of which contain strings:</span></span>  
  
|<span data-ttu-id="500f8-109">列</span><span class="sxs-lookup"><span data-stu-id="500f8-109">Column</span></span>|<span data-ttu-id="500f8-110">描述</span><span class="sxs-lookup"><span data-stu-id="500f8-110">Description</span></span>|  
|------------|-----------------|  
|<span data-ttu-id="500f8-111">**ServerName**</span><span class="sxs-lookup"><span data-stu-id="500f8-111">**ServerName**</span></span>|<span data-ttu-id="500f8-112">服务器的名称。</span><span class="sxs-lookup"><span data-stu-id="500f8-112">Name of the server.</span></span>|  
|<span data-ttu-id="500f8-113">**InstanceName**</span><span class="sxs-lookup"><span data-stu-id="500f8-113">**InstanceName**</span></span>|<span data-ttu-id="500f8-114">服务器实例的名称。</span><span class="sxs-lookup"><span data-stu-id="500f8-114">Name of the server instance.</span></span> <span data-ttu-id="500f8-115">如果服务器作为默认实例运行，则为空白。</span><span class="sxs-lookup"><span data-stu-id="500f8-115">Blank if the server is running as the default instance.</span></span>|  
|<span data-ttu-id="500f8-116">**IsClustered**</span><span class="sxs-lookup"><span data-stu-id="500f8-116">**IsClustered**</span></span>|<span data-ttu-id="500f8-117">指示服务器是否属于群集。</span><span class="sxs-lookup"><span data-stu-id="500f8-117">Indicates whether the server is part of a cluster.</span></span>|  
|<span data-ttu-id="500f8-118">**Version**</span><span class="sxs-lookup"><span data-stu-id="500f8-118">**Version**</span></span>|<span data-ttu-id="500f8-119">服务器的版本：</span><span class="sxs-lookup"><span data-stu-id="500f8-119">Version of the server:</span></span><br /><br /><span data-ttu-id="500f8-120">适用于 SQL Server 2008 10.0.xx</span><span class="sxs-lookup"><span data-stu-id="500f8-120">10.0.xx for SQL Server 2008</span></span><br /><span data-ttu-id="500f8-121">适用于 SQL Server 2008 R2 10.50.x</span><span class="sxs-lookup"><span data-stu-id="500f8-121">10.50.x for SQL Server 2008 R2</span></span><br /><span data-ttu-id="500f8-122">SQL Server 2012 的 11.0.xx</span><span class="sxs-lookup"><span data-stu-id="500f8-122">11.0.xx for SQL Server 2012</span></span><br /><span data-ttu-id="500f8-123">SQL server 2014 12.0.xx</span><span class="sxs-lookup"><span data-stu-id="500f8-123">12.0.xx for SQL Server 2014</span></span><br /><span data-ttu-id="500f8-124">适用于 SQL Server 2016 13.0.xx</span><span class="sxs-lookup"><span data-stu-id="500f8-124">13.0.xx for SQL Server 2016</span></span><br /><span data-ttu-id="500f8-125">SQL server 2017 14.0.xx</span><span class="sxs-lookup"><span data-stu-id="500f8-125">14.0.xx for SQL Server 2017</span></span>|  
  
> [!NOTE]
>  <span data-ttu-id="500f8-126">由于使用的机制的特性<xref:System.Data.Sql.SqlDataSourceEnumerator>若要查找网络上的数据源，方法不会始终返回的可用服务器的完整列表和列表可能不是在每次调用相同。</span><span class="sxs-lookup"><span data-stu-id="500f8-126">Due to the nature of the mechanism used by <xref:System.Data.Sql.SqlDataSourceEnumerator> to locate data sources on a network, the method will not always return a complete list of the available servers, and the list might not be the same on every call.</span></span> <span data-ttu-id="500f8-127">如果你打算使用此函数以使用户可以从列表中选择一台服务器，请确保您始终同时提供一个选项以防服务器枚举不会返回所有可用的服务器的名称，不在列表中，键入。</span><span class="sxs-lookup"><span data-stu-id="500f8-127">If you plan to use this function to let users select a server from a list, make sure that you always also supply an option to type in a name that is not in the list, in case the server enumeration does not return all the available servers.</span></span> <span data-ttu-id="500f8-128">此外，此方法可能需要很长的时间来执行，因此请注意有关性能至关重要时调用它。</span><span class="sxs-lookup"><span data-stu-id="500f8-128">In addition, this method may take a significant amount of time to execute, so be careful about calling it when performance is critical.</span></span>  
  
   
  
## Examples  
 <span data-ttu-id="500f8-129">以下控制台应用程序检索有关所有可见 SQL Server 实例的信息，并在控制台窗口中显示的信息。</span><span class="sxs-lookup"><span data-stu-id="500f8-129">The following console application retrieves information about all the visible SQL Server instances and displays the information in the console window.</span></span>  
  
```vb  
Imports System.Data.Sql  
  
Module Module1  
  Sub Main()  
    ' Retrieve the enumerator instance and then the data.  
    Dim instance As SqlDataSourceEnumerator = _  
     SqlDataSourceEnumerator.Instance  
    Dim table As System.Data.DataTable = instance.GetDataSources()  
  
    ' Display the contents of the table.  
    DisplayData(table)  
  
    Console.WriteLine("Press any key to continue.")  
    Console.ReadKey()  
  End Sub  
  
  Private Sub DisplayData(ByVal table As DataTable)  
    For Each row As DataRow In table.Rows  
      For Each col As DataColumn In table.Columns  
        Console.WriteLine("{0} = {1}", col.ColumnName, row(col))  
      Next  
      Console.WriteLine("============================")  
    Next  
  End Sub  
End Module  
```  
  
```csharp  
using System.Data.Sql;  
  
class Program  
{  
  static void Main()  
  {  
    // Retrieve the enumerator instance and then the data.  
    SqlDataSourceEnumerator instance =  
      SqlDataSourceEnumerator.Instance;  
    System.Data.DataTable table = instance.GetDataSources();  
  
    // Display the contents of the table.  
    DisplayData(table);  
  
    Console.WriteLine("Press any key to continue.");  
    Console.ReadKey();  
  }  
  
  private static void DisplayData(System.Data.DataTable table)  
  {  
    foreach (System.Data.DataRow row in table.Rows)  
    {  
      foreach (System.Data.DataColumn col in table.Columns)  
      {  
        Console.WriteLine("{0} = {1}", col.ColumnName, row[col]);  
      }  
      Console.WriteLine("============================");  
    }  
  }  
}  
```  
  
 ]]></format>
        </remarks>
        <related type="Article" href="/dotnet/framework/data/adonet/sql/enumerating-instances-of-sql-server"><span data-ttu-id="500f8-130">枚举 SQL Server 的实例</span><span class="sxs-lookup"><span data-stu-id="500f8-130">Enumerating Instances of SQL Server</span></span></related>
      </Docs>
    </Member>
    <Member MemberName="Instance">
      <MemberSignature Language="C#" Value="public static System.Data.Sql.SqlDataSourceEnumerator Instance { get; }" />
      <MemberSignature Language="ILAsm" Value=".property class System.Data.Sql.SqlDataSourceEnumerator Instance" />
      <MemberSignature Language="DocId" Value="P:System.Data.Sql.SqlDataSourceEnumerator.Instance" />
      <MemberSignature Language="VB.NET" Value="Public Shared ReadOnly Property Instance As SqlDataSourceEnumerator" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; static property System::Data::Sql::SqlDataSourceEnumerator ^ Instance { System::Data::Sql::SqlDataSourceEnumerator ^ get(); };" />
      <MemberSignature Language="F#" Value="member this.Instance : System.Data.Sql.SqlDataSourceEnumerator" Usage="System.Data.Sql.SqlDataSourceEnumerator.Instance" />
      <MemberType>Property</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.Data</AssemblyName>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>2.0.5.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Data.Sql.SqlDataSourceEnumerator</ReturnType>
      </ReturnValue>
      <Docs>
        <summary><span data-ttu-id="500f8-131">获取 <see cref="T:System.Data.Sql.SqlDataSourceEnumerator" /> 的实例，该实例可用于检索有关可用 SQL Server 实例的信息。</span><span class="sxs-lookup"><span data-stu-id="500f8-131">Gets an instance of the <see cref="T:System.Data.Sql.SqlDataSourceEnumerator" />, which can be used to retrieve information about available SQL Server instances.</span></span></summary>
        <value><span data-ttu-id="500f8-132">一个 <see cref="T:System.Data.Sql.SqlDataSourceEnumerator" /> 实例，该实例可用于检索有关可用 SQL Server 实例的信息。</span><span class="sxs-lookup"><span data-stu-id="500f8-132">An instance of the <see cref="T:System.Data.Sql.SqlDataSourceEnumerator" /> used to retrieve information about available SQL Server instances.</span></span></value>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="500f8-133"><xref:System.Data.Sql.SqlDataSourceEnumerator>类不提供一个构造函数。</span><span class="sxs-lookup"><span data-stu-id="500f8-133">The <xref:System.Data.Sql.SqlDataSourceEnumerator> class does not provide a constructor.</span></span> <span data-ttu-id="500f8-134">使用<xref:System.Data.Sql.SqlDataSourceEnumerator.Instance%2A>属性改为检索类的实例。</span><span class="sxs-lookup"><span data-stu-id="500f8-134">Use the <xref:System.Data.Sql.SqlDataSourceEnumerator.Instance%2A> property to retrieve an instance of the class instead.</span></span>  
  
   
  
## Examples  
 <span data-ttu-id="500f8-135">以下控制台应用程序显示在本地网络中的所有可用 SQL Server 2005 实例的列表。</span><span class="sxs-lookup"><span data-stu-id="500f8-135">The following console application displays a list of all the available SQL Server 2005 instances within the local network.</span></span> <span data-ttu-id="500f8-136">此代码使用<xref:System.Data.DataTable.Select%2A>方法来筛选返回的表中的行<xref:System.Data.Sql.SqlDataSourceEnumerator.GetDataSources%2A>方法。</span><span class="sxs-lookup"><span data-stu-id="500f8-136">This code uses the <xref:System.Data.DataTable.Select%2A> method to filter the rows in the table returned by the <xref:System.Data.Sql.SqlDataSourceEnumerator.GetDataSources%2A> method.</span></span>  
  
```vb  
Imports System.Data.Sql  
  
Module Module1  
  Sub Main()  
    ' Retrieve the enumerator instance, and  
    ' then retrieve the data sources.  
    Dim instance As SqlDataSourceEnumerator = _  
     SqlDataSourceEnumerator.Instance  
    Dim table As System.Data.DataTable = instance.GetDataSources()  
  
    ' Filter the sources to just show SQL Server 2005 instances.  
    Dim rows() As DataRow = table.Select("Version LIKE '9%'")  
    For Each row As DataRow In rows  
      Console.WriteLine(row("ServerName"))  
    Next  
    Console.WriteLine("Press any key to continue.")  
    Console.ReadKey()  
  End Sub  
End Module  
```  
  
```csharp  
using System.Data.Sql;  
  
class Program  
{  
  static void Main()  
  {  
    // Retrieve the enumerator instance, and  
    // then retrieve the data sources.  
    SqlDataSourceEnumerator instance =  
      SqlDataSourceEnumerator.Instance;  
    System.Data.DataTable table = instance.GetDataSources();  
  
    // Filter the sources to just show SQL Server 2005 instances.  
    System.Data.DataRow[] rows = table.Select("Version LIKE '9%'");  
    foreach (System.Data.DataRow row in rows)  
    {  
      Console.WriteLine(row["ServerName"]);  
    }  
    Console.WriteLine("Press any key to continue.");  
    Console.ReadKey();  
  }  
}  
```  
  
 ]]></format>
        </remarks>
        <related type="Article" href="/dotnet/framework/data/adonet/sql/enumerating-instances-of-sql-server"><span data-ttu-id="500f8-137">枚举 SQL Server 的实例</span><span class="sxs-lookup"><span data-stu-id="500f8-137">Enumerating Instances of SQL Server</span></span></related>
      </Docs>
    </Member>
  </Members>
</Type>
