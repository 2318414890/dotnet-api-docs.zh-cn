<Type Name="ZipFile" FullName="System.IO.Compression.ZipFile">
  <Metadata>
    <Meta Name="ms.openlocfilehash" Value="1b590dab0a7476a0f82e5161a0c1d901088724ac" />
    <Meta Name="ms.sourcegitcommit" Value="6a0b904069161bbaec4ffd02aa7d9cf38c61e72e" />
    <Meta Name="ms.translationtype" Value="HT" />
    <Meta Name="ms.contentlocale" Value="zh-CN" />
    <Meta Name="ms.lasthandoff" Value="06/24/2018" />
    <Meta Name="ms.locfileid" Value="36562153" />
  </Metadata>
  <TypeSignature Language="C#" Value="public static class ZipFile" />
  <TypeSignature Language="ILAsm" Value=".class public auto ansi abstract sealed beforefieldinit ZipFile extends System.Object" />
  <TypeSignature Language="DocId" Value="T:System.IO.Compression.ZipFile" />
  <TypeSignature Language="VB.NET" Value="Public Class ZipFile" />
  <TypeSignature Language="C++ CLI" Value="public ref class ZipFile abstract sealed" />
  <TypeSignature Language="F#" Value="type ZipFile = class" />
  <AssemblyInfo>
    <AssemblyName>System.IO.Compression.ZipFile</AssemblyName>
    <AssemblyVersion>4.0.1.0</AssemblyVersion>
    <AssemblyVersion>4.0.3.0</AssemblyVersion>
    <AssemblyVersion>4.0.4.0</AssemblyVersion>
  </AssemblyInfo>
  <AssemblyInfo>
    <AssemblyName>System.IO.Compression.FileSystem</AssemblyName>
    <AssemblyVersion>2.0.5.0</AssemblyVersion>
    <AssemblyVersion>4.0.0.0</AssemblyVersion>
  </AssemblyInfo>
  <AssemblyInfo>
    <AssemblyName>netstandard</AssemblyName>
    <AssemblyVersion>2.0.0.0</AssemblyVersion>
  </AssemblyInfo>
  <Base>
    <BaseTypeName>System.Object</BaseTypeName>
  </Base>
  <Interfaces />
  <Docs>
    <summary>
      <span data-ttu-id="70b50-101">提供创建、解压缩和打开 zip 存档的静态方法。</span>
      <span class="sxs-lookup">
        <span data-stu-id="70b50-101">Provides static methods for creating, extracting, and opening zip archives.</span>
      </span>
    </summary>
    <remarks>
      <format type="text/markdown"><![CDATA[  
  
## Remarks  
  
> [!IMPORTANT]
>  <span data-ttu-id="70b50-102">若要使用<xref:System.IO.Compression.ZipFile>类，必须添加对引用`System.IO.Compression.FileSystem`项目; 中的程序集否则，你将得到以下错误消息，当尝试编译： **的当前上下文中不存在ZipFile的名称**.</span><span class="sxs-lookup"><span data-stu-id="70b50-102">To use the <xref:System.IO.Compression.ZipFile> class, you must add a reference to the `System.IO.Compression.FileSystem` assembly in your project; otherwise, you'll get the following error message when trying to compile : **The name 'ZipFile' does not exist in the current context**.</span></span> <span data-ttu-id="70b50-103">有关如何在 Visual Studio 中添加到你的项目的引用的详细信息，请参阅[如何： 添加或删除引用使用引用管理器](http://msdn.microsoft.com/library/1aabb520-99b0-46c6-9368-21b4d84793eb)。</span><span class="sxs-lookup"><span data-stu-id="70b50-103">For more information on how to add a reference to your project in Visual Studio, see [How to: Add or Remove References By Using the Reference Manager](http://msdn.microsoft.com/library/1aabb520-99b0-46c6-9368-21b4d84793eb).</span></span>  
  
 <span data-ttu-id="70b50-104">用于操作的 zip 存档和其文件的方法将分布在三个类： <xref:System.IO.Compression.ZipFile>，<xref:System.IO.Compression.ZipArchive>和<xref:System.IO.Compression.ZipArchiveEntry>。</span><span class="sxs-lookup"><span data-stu-id="70b50-104">The methods for manipulating zip archives and their files are spread across three classes: <xref:System.IO.Compression.ZipFile>, <xref:System.IO.Compression.ZipArchive> and <xref:System.IO.Compression.ZipArchiveEntry>.</span></span>  
  
|<span data-ttu-id="70b50-105">自...</span><span class="sxs-lookup"><span data-stu-id="70b50-105">To…</span></span>|<span data-ttu-id="70b50-106">使用...</span><span class="sxs-lookup"><span data-stu-id="70b50-106">Use…</span></span>|  
|---------|----------|  
|<span data-ttu-id="70b50-107">从目录中创建的 zip 存档</span><span class="sxs-lookup"><span data-stu-id="70b50-107">Create a zip archive from a directory</span></span>|<xref:System.IO.Compression.ZipFile.CreateFromDirectory%2A?displayProperty=nameWithType>|  
|<span data-ttu-id="70b50-108">提取到目录的 zip 存档的内容</span><span class="sxs-lookup"><span data-stu-id="70b50-108">Extract the contents of a zip archive to a directory</span></span>|<xref:System.IO.Compression.ZipFile.ExtractToDirectory%2A?displayProperty=nameWithType>|  
|<span data-ttu-id="70b50-109">将新文件添加到现有的 zip 存档</span><span class="sxs-lookup"><span data-stu-id="70b50-109">Add new files to an existing zip archive</span></span>|<xref:System.IO.Compression.ZipArchive.CreateEntry%2A?displayProperty=nameWithType>|  
|<span data-ttu-id="70b50-110">检索 zip 存档中的文件</span><span class="sxs-lookup"><span data-stu-id="70b50-110">Retrieve an file in a zip archive</span></span>|<xref:System.IO.Compression.ZipArchive.GetEntry%2A?displayProperty=nameWithType>|  
|<span data-ttu-id="70b50-111">检索所有的 zip 存档中的文件</span><span class="sxs-lookup"><span data-stu-id="70b50-111">Retrieve all of the files in a zip archive</span></span>|<xref:System.IO.Compression.ZipArchive.Entries%2A?displayProperty=nameWithType>|  
|<span data-ttu-id="70b50-112">若要打开单个文件的流中包含的 zip 存档</span><span class="sxs-lookup"><span data-stu-id="70b50-112">To open a stream to an individual file contained in a zip archive</span></span>|<xref:System.IO.Compression.ZipArchiveEntry.Open%2A?displayProperty=nameWithType>|  
|<span data-ttu-id="70b50-113">从 zip 存档中删除文件</span><span class="sxs-lookup"><span data-stu-id="70b50-113">Delete a file from a zip archive</span></span>|<xref:System.IO.Compression.ZipArchiveEntry.Delete%2A?displayProperty=nameWithType>|  
  
 <span data-ttu-id="70b50-114">不能使用<xref:System.IO.Compression.ZipFile>或<xref:System.IO.Compression.ZipFileExtensions>中的类[!INCLUDE[win8_appname_long](~/includes/win8-appname-long-md.md)]应用。</span><span class="sxs-lookup"><span data-stu-id="70b50-114">You cannot use the <xref:System.IO.Compression.ZipFile> or  <xref:System.IO.Compression.ZipFileExtensions> classes  in [!INCLUDE[win8_appname_long](~/includes/win8-appname-long-md.md)] apps.</span></span> <span data-ttu-id="70b50-115">在[!INCLUDE[win8_appname_long](~/includes/win8-appname-long-md.md)]应用，你应使用以下类处理的压缩文件。</span><span class="sxs-lookup"><span data-stu-id="70b50-115">In [!INCLUDE[win8_appname_long](~/includes/win8-appname-long-md.md)] apps, you should use the following classes to work with compressed files.</span></span>  
  
-   <xref:System.IO.Compression.ZipArchive>  
  
-   <xref:System.IO.Compression.ZipArchiveEntry>  
  
-   <xref:System.IO.Compression.DeflateStream>  
  
-   <xref:System.IO.Compression.GZipStream>  
  
   
  
## Examples  
 <span data-ttu-id="70b50-116">此示例演示如何创建和使用提取某个 zip 存档<xref:System.IO.Compression.ZipFile>类。</span><span class="sxs-lookup"><span data-stu-id="70b50-116">This example shows how to create and extract a zip archive by using the <xref:System.IO.Compression.ZipFile> class.</span></span> <span data-ttu-id="70b50-117">它将文件夹的内容压缩成 zip 存档，，然后该将内容提取到一个新文件夹。</span><span class="sxs-lookup"><span data-stu-id="70b50-117">It compresses the contents of a folder into a zip archive, and then extracts that content to a new folder.</span></span>  
  
> [!TIP]
>  <span data-ttu-id="70b50-118">若要使用 <xref:System.IO.Compression.ZipFile> 类，必须在项目中引用 `System.IO.Compression.FileSystem` 程序集。</span><span class="sxs-lookup"><span data-stu-id="70b50-118">To use the <xref:System.IO.Compression.ZipFile> class, you must reference the `System.IO.Compression.FileSystem` assembly in your project.</span></span>  
  
 [!code-csharp[System.IO.Compression.ZipFile#1](~/samples/snippets/csharp/VS_Snippets_CLR_System/system.io.compression.zipfile/cs/program1.cs#1)]
 [!code-vb[System.IO.Compression.ZipFile#1](~/samples/snippets/visualbasic/VS_Snippets_CLR_System/system.io.compression.zipfile/vb/program1.vb#1)]  
  
 ]]></format>
    </remarks>
  </Docs>
  <Members>
    <MemberGroup MemberName="CreateFromDirectory">
      <AssemblyInfo>
        <AssemblyName>System.IO.Compression.ZipFile</AssemblyName>
        <AssemblyVersion>4.0.1.0</AssemblyVersion>
        <AssemblyVersion>4.0.3.0</AssemblyVersion>
      </AssemblyInfo>
      <Docs>
        <summary>
          <span data-ttu-id="70b50-119">创建 zip 存档，该存档包含指定目录的文件和目录。</span>
          <span class="sxs-lookup">
            <span data-stu-id="70b50-119">Creates a zip archive that contains the files and directories from the specified directory.</span>
          </span>
        </summary>
      </Docs>
    </MemberGroup>
    <Member MemberName="CreateFromDirectory">
      <MemberSignature Language="C#" Value="public static void CreateFromDirectory (string sourceDirectoryName, string destinationArchiveFileName);" />
      <MemberSignature Language="ILAsm" Value=".method public static hidebysig void CreateFromDirectory(string sourceDirectoryName, string destinationArchiveFileName) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.IO.Compression.ZipFile.CreateFromDirectory(System.String,System.String)" />
      <MemberSignature Language="VB.NET" Value="Public Shared Sub CreateFromDirectory (sourceDirectoryName As String, destinationArchiveFileName As String)" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; static void CreateFromDirectory(System::String ^ sourceDirectoryName, System::String ^ destinationArchiveFileName);" />
      <MemberSignature Language="F#" Value="static member CreateFromDirectory : string * string -&gt; unit" Usage="System.IO.Compression.ZipFile.CreateFromDirectory (sourceDirectoryName, destinationArchiveFileName)" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.IO.Compression.ZipFile</AssemblyName>
        <AssemblyVersion>4.0.1.0</AssemblyVersion>
        <AssemblyVersion>4.0.3.0</AssemblyVersion>
        <AssemblyVersion>4.0.4.0</AssemblyVersion>
      </AssemblyInfo>
      <AssemblyInfo>
        <AssemblyName>System.IO.Compression.FileSystem</AssemblyName>
        <AssemblyVersion>2.0.5.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <AssemblyInfo>
        <AssemblyName>netstandard</AssemblyName>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Void</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="sourceDirectoryName" Type="System.String" />
        <Parameter Name="destinationArchiveFileName" Type="System.String" />
      </Parameters>
      <Docs>
        <param name="sourceDirectoryName">
          <span data-ttu-id="70b50-120">要存档的目录的路径，指定为相对路径或绝对路径。</span>
          <span class="sxs-lookup">
            <span data-stu-id="70b50-120">The path to the directory to be archived, specified as a relative or absolute path.</span>
          </span>
          <span data-ttu-id="70b50-121">相对路径是指相对于当前工作目录的路径。</span>
          <span class="sxs-lookup">
            <span data-stu-id="70b50-121">A relative path is interpreted as relative to the current working directory.</span>
          </span>
        </param>
        <param name="destinationArchiveFileName">
          <span data-ttu-id="70b50-122">要生成的存档路径，指定为相对路径或绝对路径。</span>
          <span class="sxs-lookup">
            <span data-stu-id="70b50-122">The path of the archive to be created, specified as a relative or absolute path.</span>
          </span>
          <span data-ttu-id="70b50-123">相对路径是指相对于当前工作目录的路径。</span>
          <span class="sxs-lookup">
            <span data-stu-id="70b50-123">A relative path is interpreted as relative to the current working directory.</span>
          </span>
        </param>
        <summary>
          <span data-ttu-id="70b50-124">创建 zip 存档，该存档包含指定目录的文件和目录。</span>
          <span class="sxs-lookup">
            <span data-stu-id="70b50-124">Creates a zip archive that contains the files and directories from the specified directory.</span>
          </span>
        </summary>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="70b50-125">从文件系统的目录结构将保留在存档中。</span><span class="sxs-lookup"><span data-stu-id="70b50-125">The directory structure from the file system is preserved in the archive.</span></span> <span data-ttu-id="70b50-126">如果此目录为空，则创建空存档。</span><span class="sxs-lookup"><span data-stu-id="70b50-126">If the directory is empty, an empty archive is created.</span></span> <span data-ttu-id="70b50-127">此方法重载不存档中包括的基目录，并且不允许你指定的压缩级别。</span><span class="sxs-lookup"><span data-stu-id="70b50-127">This method overload does not include the base directory in the archive and does not allow you to specify a compression level.</span></span> <span data-ttu-id="70b50-128">如果你想要包括的基目录，或指定压缩级别，请调用<xref:System.IO.Compression.ZipFile.CreateFromDirectory%28System.String%2CSystem.String%2CSystem.IO.Compression.CompressionLevel%2CSystem.Boolean%29>方法重载。</span><span class="sxs-lookup"><span data-stu-id="70b50-128">If you want to include the base directory or specify a compression level, call the <xref:System.IO.Compression.ZipFile.CreateFromDirectory%28System.String%2CSystem.String%2CSystem.IO.Compression.CompressionLevel%2CSystem.Boolean%29> method overload.</span></span>  
  
 <span data-ttu-id="70b50-129">如果存档已存在，<xref:System.IO.IOException>引发异常。</span><span class="sxs-lookup"><span data-stu-id="70b50-129">If the archive already exists, an <xref:System.IO.IOException> exception is thrown.</span></span> <span data-ttu-id="70b50-130">如果在存档中已存在一个具有指定名称的项，第二个条目被创建具有相同的名称。</span><span class="sxs-lookup"><span data-stu-id="70b50-130">If an entry with the specified name already exists in the archive, a second entry is created with an identical name.</span></span>  
  
 <span data-ttu-id="70b50-131">如果无法将目录中的文件添加到存档，存档左不完整和无效，并且该方法将引发<xref:System.IO.IOException>异常。</span><span class="sxs-lookup"><span data-stu-id="70b50-131">If a file in the directory cannot be added to the archive, the archive is left incomplete and invalid, and the method throws an <xref:System.IO.IOException> exception.</span></span>  
  
   
  
## Examples  
 <span data-ttu-id="70b50-132">此示例演示如何创建和使用提取某个 zip 存档<xref:System.IO.Compression.ZipFile>类。</span><span class="sxs-lookup"><span data-stu-id="70b50-132">This example shows how to create and extract a zip archive by using the <xref:System.IO.Compression.ZipFile> class.</span></span> <span data-ttu-id="70b50-133">它将文件夹的内容压缩成 zip 存档，，然后该将内容提取到一个新文件夹。</span><span class="sxs-lookup"><span data-stu-id="70b50-133">It compresses the contents of a folder into a zip archive, and then extracts that content to a new folder.</span></span> <span data-ttu-id="70b50-134">若要使用 <xref:System.IO.Compression.ZipFile> 类，必须在项目中引用 `System.IO.Compression.FileSystem` 程序集。</span><span class="sxs-lookup"><span data-stu-id="70b50-134">To use the <xref:System.IO.Compression.ZipFile> class, you must reference the `System.IO.Compression.FileSystem` assembly in your project.</span></span>  
  
 [!code-csharp[System.IO.Compression.ZipFile#1](~/samples/snippets/csharp/VS_Snippets_CLR_System/system.io.compression.zipfile/cs/program1.cs#1)]
 [!code-vb[System.IO.Compression.ZipFile#1](~/samples/snippets/visualbasic/VS_Snippets_CLR_System/system.io.compression.zipfile/vb/program1.vb#1)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentException">
          <span data-ttu-id="70b50-135">
            <paramref name="sourceDirectoryName" /> 或 <paramref name="destinationArchiveFileName" /> 是 <see cref="F:System.String.Empty" />，仅包含空格，或包含至少一个无效字符。</span>
          <span class="sxs-lookup">
            <span data-stu-id="70b50-135">
              <paramref name="sourceDirectoryName" /> or <paramref name="destinationArchiveFileName" /> is <see cref="F:System.String.Empty" />, contains only white space, or contains at least one invalid character.</span>
          </span>
        </exception>
        <exception cref="T:System.ArgumentNullException">
          <span data-ttu-id="70b50-136">
            <paramref name="sourceDirectoryName" /> 或 <paramref name="destinationArchiveFileName" /> 为 <see langword="null" />。</span>
          <span class="sxs-lookup">
            <span data-stu-id="70b50-136">
              <paramref name="sourceDirectoryName" /> or <paramref name="destinationArchiveFileName" /> is <see langword="null" />.</span>
          </span>
        </exception>
        <exception cref="T:System.IO.PathTooLongException">
          <span data-ttu-id="70b50-137">在 <paramref name="sourceDirectoryName" /> 或 <paramref name="destinationArchiveFileName" /> 内，指定的路径、文件名或者两者都超出了系统定义的最大长度。</span>
          <span class="sxs-lookup">
            <span data-stu-id="70b50-137">In <paramref name="sourceDirectoryName" /> or <paramref name="destinationArchiveFileName" />, the specified path, file name, or both exceed the system-defined maximum length.</span>
          </span>
        </exception>
        <exception cref="T:System.IO.DirectoryNotFoundException">
          <span data-ttu-id="70b50-138">
            <paramref name="sourceDirectoryName" /> 无效或不存在（例如，在未映射的驱动器上）。</span>
          <span class="sxs-lookup">
            <span data-stu-id="70b50-138">
              <paramref name="sourceDirectoryName" /> is invalid or does not exist (for example, it is on an unmapped drive).</span>
          </span>
        </exception>
        <exception cref="T:System.IO.IOException">
          <span data-ttu-id="70b50-139">
            <paramref name="destinationArchiveFileName" /> 已存在。</span>
          <span class="sxs-lookup">
            <span data-stu-id="70b50-139">
              <paramref name="destinationArchiveFileName" /> already exists.</span>
          </span>
          <span data-ttu-id="70b50-140">- 或 -  无法打开指定目录中的文件。</span>
          <span class="sxs-lookup">
            <span data-stu-id="70b50-140">-or-  A file in the specified directory could not be opened.</span>
          </span>
        </exception>
        <exception cref="T:System.UnauthorizedAccessException">
          <span data-ttu-id="70b50-141">
            <paramref name="destinationArchiveFileName" /> 指定目录。</span>
          <span class="sxs-lookup">
            <span data-stu-id="70b50-141">
              <paramref name="destinationArchiveFileName" /> specifies a directory.</span>
          </span>
          <span data-ttu-id="70b50-142">- 或 -  调用方不具有访问在 <paramref name="sourceDirectoryName" /> 中指定的目录或在 <paramref name="destinationArchiveFileName" /> 中指定的文件的所需权限。</span>
          <span class="sxs-lookup">
            <span data-stu-id="70b50-142">-or-  The caller does not have the required permission to access the directory specified in <paramref name="sourceDirectoryName" /> or the file specified in <paramref name="destinationArchiveFileName" />.</span>
          </span>
        </exception>
        <exception cref="T:System.NotSupportedException">
          <span data-ttu-id="70b50-143">
            <paramref name="sourceDirectoryName" /> 或 <paramref name="destinationArchiveFileName" /> 包含的格式无效。</span>
          <span class="sxs-lookup">
            <span data-stu-id="70b50-143">
              <paramref name="sourceDirectoryName" /> or <paramref name="destinationArchiveFileName" /> contains an invalid format.</span>
          </span>
          <span data-ttu-id="70b50-144">- 或 -  zip 存档不支持写入。</span>
          <span class="sxs-lookup">
            <span data-stu-id="70b50-144">-or-  The zip archive does not support writing.</span>
          </span>
        </exception>
      </Docs>
    </Member>
    <Member MemberName="CreateFromDirectory">
      <MemberSignature Language="C#" Value="public static void CreateFromDirectory (string sourceDirectoryName, string destinationArchiveFileName, System.IO.Compression.CompressionLevel compressionLevel, bool includeBaseDirectory);" />
      <MemberSignature Language="ILAsm" Value=".method public static hidebysig void CreateFromDirectory(string sourceDirectoryName, string destinationArchiveFileName, valuetype System.IO.Compression.CompressionLevel compressionLevel, bool includeBaseDirectory) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.IO.Compression.ZipFile.CreateFromDirectory(System.String,System.String,System.IO.Compression.CompressionLevel,System.Boolean)" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; static void CreateFromDirectory(System::String ^ sourceDirectoryName, System::String ^ destinationArchiveFileName, System::IO::Compression::CompressionLevel compressionLevel, bool includeBaseDirectory);" />
      <MemberSignature Language="F#" Value="static member CreateFromDirectory : string * string * System.IO.Compression.CompressionLevel * bool -&gt; unit" Usage="System.IO.Compression.ZipFile.CreateFromDirectory (sourceDirectoryName, destinationArchiveFileName, compressionLevel, includeBaseDirectory)" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.IO.Compression.ZipFile</AssemblyName>
        <AssemblyVersion>4.0.1.0</AssemblyVersion>
        <AssemblyVersion>4.0.3.0</AssemblyVersion>
        <AssemblyVersion>4.0.4.0</AssemblyVersion>
      </AssemblyInfo>
      <AssemblyInfo>
        <AssemblyName>System.IO.Compression.FileSystem</AssemblyName>
        <AssemblyVersion>2.0.5.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <AssemblyInfo>
        <AssemblyName>netstandard</AssemblyName>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Void</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="sourceDirectoryName" Type="System.String" />
        <Parameter Name="destinationArchiveFileName" Type="System.String" />
        <Parameter Name="compressionLevel" Type="System.IO.Compression.CompressionLevel" />
        <Parameter Name="includeBaseDirectory" Type="System.Boolean" />
      </Parameters>
      <Docs>
        <param name="sourceDirectoryName">
          <span data-ttu-id="70b50-145">要存档的目录的路径，指定为相对路径或绝对路径。</span>
          <span class="sxs-lookup">
            <span data-stu-id="70b50-145">The path to the directory to be archived, specified as a relative or absolute path.</span>
          </span>
          <span data-ttu-id="70b50-146">相对路径是指相对于当前工作目录的路径。</span>
          <span class="sxs-lookup">
            <span data-stu-id="70b50-146">A relative path is interpreted as relative to the current working directory.</span>
          </span>
        </param>
        <param name="destinationArchiveFileName">
          <span data-ttu-id="70b50-147">要生成的存档路径，指定为相对路径或绝对路径。</span>
          <span class="sxs-lookup">
            <span data-stu-id="70b50-147">The path of the archive to be created, specified as a relative or absolute path.</span>
          </span>
          <span data-ttu-id="70b50-148">相对路径是指相对于当前工作目录的路径。</span>
          <span class="sxs-lookup">
            <span data-stu-id="70b50-148">A relative path is interpreted as relative to the current working directory.</span>
          </span>
        </param>
        <param name="compressionLevel">
          <span data-ttu-id="70b50-149">指示创建项时是否强调速度或压缩有效性的枚举值之一。</span>
          <span class="sxs-lookup">
            <span data-stu-id="70b50-149">One of the enumeration values that indicates whether to emphasize speed or compression effectiveness when creating the entry.</span>
          </span>
        </param>
        <param name="includeBaseDirectory">
          <span data-ttu-id="70b50-150">包括来自于存档的根的 <c>sourceDirectoryName</c> 的目录名称，则为 <see langword="true" />；仅包含目录中的内容，则为 <see langword="false" />。</span>
          <span class="sxs-lookup">
            <span data-stu-id="70b50-150">
              <see langword="true" /> to include the directory name from <c>sourceDirectoryName</c> at the root of the archive; <see langword="false" /> to include only the contents of the directory.</span>
          </span>
        </param>
        <summary>
          <span data-ttu-id="70b50-151">创建 zip 存档，该存档包括指定目录的文件和目录，使用指定压缩级别，以及可以选择包含基目录。</span>
          <span class="sxs-lookup">
            <span data-stu-id="70b50-151">Creates a zip archive that contains the files and directories from the specified directory, uses the specified compression level, and optionally includes the base directory.</span>
          </span>
        </summary>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="70b50-152">从文件系统的目录结构将保留在存档中。</span><span class="sxs-lookup"><span data-stu-id="70b50-152">The directory structure from the file system is preserved in the archive.</span></span> <span data-ttu-id="70b50-153">如果此目录为空，则创建空存档。</span><span class="sxs-lookup"><span data-stu-id="70b50-153">If the directory is empty, an empty archive is created.</span></span> <span data-ttu-id="70b50-154">使用此方法重载来指定压缩级别以及是否要包含在存档中的基目录。</span><span class="sxs-lookup"><span data-stu-id="70b50-154">Use this method overload to specify the compression level and whether to include the base directory in the archive.</span></span>  
  
 <span data-ttu-id="70b50-155">如果存档已存在，<xref:System.IO.IOException>引发异常。</span><span class="sxs-lookup"><span data-stu-id="70b50-155">If the archive already exists, an <xref:System.IO.IOException> exception is thrown.</span></span> <span data-ttu-id="70b50-156">如果在存档中已存在一个具有指定名称的项，第二个条目被创建具有相同的名称。</span><span class="sxs-lookup"><span data-stu-id="70b50-156">If an entry with the specified name already exists in the archive, a second entry is created with an identical name.</span></span>  
  
 <span data-ttu-id="70b50-157">如果无法将目录中的文件添加到存档，存档左不完整和无效，并且该方法将引发<xref:System.IO.IOException>异常。</span><span class="sxs-lookup"><span data-stu-id="70b50-157">If a file in the directory cannot be added to the archive, the archive is left incomplete and invalid, and the method throws an <xref:System.IO.IOException> exception.</span></span>  
  
   
  
## Examples  
 <span data-ttu-id="70b50-158">此示例演示如何创建和使用提取某个 zip 存档<xref:System.IO.Compression.ZipFile>类。</span><span class="sxs-lookup"><span data-stu-id="70b50-158">This example shows how to create and extract a zip archive by using the <xref:System.IO.Compression.ZipFile> class.</span></span> <span data-ttu-id="70b50-159">它将文件夹的内容压缩成 zip 存档，，然后该将内容提取到一个新文件夹。</span><span class="sxs-lookup"><span data-stu-id="70b50-159">It compresses the contents of a folder into a zip archive, and then extracts that content to a new folder.</span></span> <span data-ttu-id="70b50-160">当压缩存档，基目录将包含和压缩级别设置为对该操作的速度追求超过了效率。</span><span class="sxs-lookup"><span data-stu-id="70b50-160">When compressing the archive, the base directory is included and the compression level is set to emphasize the speed of the operation over efficiency.</span></span> <span data-ttu-id="70b50-161">若要使用 <xref:System.IO.Compression.ZipFile> 类，必须在项目中引用 `System.IO.Compression.FileSystem` 程序集。</span><span class="sxs-lookup"><span data-stu-id="70b50-161">To use the <xref:System.IO.Compression.ZipFile> class, you must reference the `System.IO.Compression.FileSystem` assembly in your project.</span></span>  
  
 [!code-csharp[System.IO.Compression.ZipFile#2](~/samples/snippets/csharp/VS_Snippets_CLR_System/system.io.compression.zipfile/cs/program2.cs#2)]
 [!code-vb[System.IO.Compression.ZipFile#2](~/samples/snippets/visualbasic/VS_Snippets_CLR_System/system.io.compression.zipfile/vb/program2.vb#2)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentException">
          <span data-ttu-id="70b50-162">
            <paramref name="sourceDirectoryName" /> 或 <paramref name="destinationArchiveFileName" /> 是 <see cref="F:System.String.Empty" />，仅包含空格，或包含至少一个无效字符。</span>
          <span class="sxs-lookup">
            <span data-stu-id="70b50-162">
              <paramref name="sourceDirectoryName" /> or <paramref name="destinationArchiveFileName" /> is <see cref="F:System.String.Empty" />, contains only white space, or contains at least one invalid character.</span>
          </span>
        </exception>
        <exception cref="T:System.ArgumentNullException">
          <span data-ttu-id="70b50-163">
            <paramref name="sourceDirectoryName" /> 或 <paramref name="destinationArchiveFileName" /> 为 <see langword="null" />。</span>
          <span class="sxs-lookup">
            <span data-stu-id="70b50-163">
              <paramref name="sourceDirectoryName" /> or <paramref name="destinationArchiveFileName" /> is <see langword="null" />.</span>
          </span>
        </exception>
        <exception cref="T:System.IO.PathTooLongException">
          <span data-ttu-id="70b50-164">在 <paramref name="sourceDirectoryName" /> 或 <paramref name="destinationArchiveFileName" /> 内，指定的路径、文件名或者两者都超出了系统定义的最大长度。</span>
          <span class="sxs-lookup">
            <span data-stu-id="70b50-164">In <paramref name="sourceDirectoryName" /> or <paramref name="destinationArchiveFileName" />, the specified path, file name, or both exceed the system-defined maximum length.</span>
          </span>
        </exception>
        <exception cref="T:System.IO.DirectoryNotFoundException">
          <span data-ttu-id="70b50-165">
            <paramref name="sourceDirectoryName" /> 无效或不存在（例如，在未映射的驱动器上）。</span>
          <span class="sxs-lookup">
            <span data-stu-id="70b50-165">
              <paramref name="sourceDirectoryName" /> is invalid or does not exist (for example, it is on an unmapped drive).</span>
          </span>
        </exception>
        <exception cref="T:System.IO.IOException">
          <span data-ttu-id="70b50-166">
            <paramref name="destinationArchiveFileName" /> 已存在。</span>
          <span class="sxs-lookup">
            <span data-stu-id="70b50-166">
              <paramref name="destinationArchiveFileName" /> already exists.</span>
          </span>
          <span data-ttu-id="70b50-167">- 或 -  无法打开指定目录中的文件。</span>
          <span class="sxs-lookup">
            <span data-stu-id="70b50-167">-or-  A file in the specified directory could not be opened.</span>
          </span>
        </exception>
        <exception cref="T:System.UnauthorizedAccessException">
          <span data-ttu-id="70b50-168">
            <paramref name="destinationArchiveFileName" /> 指定目录。</span>
          <span class="sxs-lookup">
            <span data-stu-id="70b50-168">
              <paramref name="destinationArchiveFileName" /> specifies a directory.</span>
          </span>
          <span data-ttu-id="70b50-169">- 或 -  调用方不具有访问在 <paramref name="sourceDirectoryName" /> 中指定的目录或在 <paramref name="destinationArchiveFileName" /> 中指定的文件的所需权限。</span>
          <span class="sxs-lookup">
            <span data-stu-id="70b50-169">-or-  The caller does not have the required permission to access the directory specified in <paramref name="sourceDirectoryName" /> or the file specified in <paramref name="destinationArchiveFileName" />.</span>
          </span>
        </exception>
        <exception cref="T:System.NotSupportedException">
          <span data-ttu-id="70b50-170">
            <paramref name="sourceDirectoryName" /> 或 <paramref name="destinationArchiveFileName" /> 包含的格式无效。</span>
          <span class="sxs-lookup">
            <span data-stu-id="70b50-170">
              <paramref name="sourceDirectoryName" /> or <paramref name="destinationArchiveFileName" /> contains an invalid format.</span>
          </span>
          <span data-ttu-id="70b50-171">- 或 -  zip 存档不支持写入。</span>
          <span class="sxs-lookup">
            <span data-stu-id="70b50-171">-or-  The zip archive does not support writing.</span>
          </span>
        </exception>
      </Docs>
    </Member>
    <Member MemberName="CreateFromDirectory">
      <MemberSignature Language="C#" Value="public static void CreateFromDirectory (string sourceDirectoryName, string destinationArchiveFileName, System.IO.Compression.CompressionLevel compressionLevel, bool includeBaseDirectory, System.Text.Encoding entryNameEncoding);" />
      <MemberSignature Language="ILAsm" Value=".method public static hidebysig void CreateFromDirectory(string sourceDirectoryName, string destinationArchiveFileName, valuetype System.IO.Compression.CompressionLevel compressionLevel, bool includeBaseDirectory, class System.Text.Encoding entryNameEncoding) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.IO.Compression.ZipFile.CreateFromDirectory(System.String,System.String,System.IO.Compression.CompressionLevel,System.Boolean,System.Text.Encoding)" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; static void CreateFromDirectory(System::String ^ sourceDirectoryName, System::String ^ destinationArchiveFileName, System::IO::Compression::CompressionLevel compressionLevel, bool includeBaseDirectory, System::Text::Encoding ^ entryNameEncoding);" />
      <MemberSignature Language="F#" Value="static member CreateFromDirectory : string * string * System.IO.Compression.CompressionLevel * bool * System.Text.Encoding -&gt; unit" Usage="System.IO.Compression.ZipFile.CreateFromDirectory (sourceDirectoryName, destinationArchiveFileName, compressionLevel, includeBaseDirectory, entryNameEncoding)" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.IO.Compression.ZipFile</AssemblyName>
        <AssemblyVersion>4.0.1.0</AssemblyVersion>
        <AssemblyVersion>4.0.3.0</AssemblyVersion>
        <AssemblyVersion>4.0.4.0</AssemblyVersion>
      </AssemblyInfo>
      <AssemblyInfo>
        <AssemblyName>System.IO.Compression.FileSystem</AssemblyName>
        <AssemblyVersion>2.0.5.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <AssemblyInfo>
        <AssemblyName>netstandard</AssemblyName>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Void</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="sourceDirectoryName" Type="System.String" />
        <Parameter Name="destinationArchiveFileName" Type="System.String" />
        <Parameter Name="compressionLevel" Type="System.IO.Compression.CompressionLevel" />
        <Parameter Name="includeBaseDirectory" Type="System.Boolean" />
        <Parameter Name="entryNameEncoding" Type="System.Text.Encoding" />
      </Parameters>
      <Docs>
        <param name="sourceDirectoryName">
          <span data-ttu-id="70b50-172">要存档的目录的路径，指定为相对路径或绝对路径。</span>
          <span class="sxs-lookup">
            <span data-stu-id="70b50-172">The path to the directory to be archived, specified as a relative or absolute path.</span>
          </span>
          <span data-ttu-id="70b50-173">相对路径是指相对于当前工作目录的路径。</span>
          <span class="sxs-lookup">
            <span data-stu-id="70b50-173">A relative path is interpreted as relative to the current working directory.</span>
          </span>
        </param>
        <param name="destinationArchiveFileName">
          <span data-ttu-id="70b50-174">要生成的存档路径，指定为相对路径或绝对路径。</span>
          <span class="sxs-lookup">
            <span data-stu-id="70b50-174">The path of the archive to be created, specified as a relative or absolute path.</span>
          </span>
          <span data-ttu-id="70b50-175">相对路径是指相对于当前工作目录的路径。</span>
          <span class="sxs-lookup">
            <span data-stu-id="70b50-175">A relative path is interpreted as relative to the current working directory.</span>
          </span>
        </param>
        <param name="compressionLevel">
          <span data-ttu-id="70b50-176">指示创建项时是否强调速度或压缩有效性的枚举值之一。</span>
          <span class="sxs-lookup">
            <span data-stu-id="70b50-176">One of the enumeration values that indicates whether to emphasize speed or compression effectiveness when creating the entry.</span>
          </span>
        </param>
        <param name="includeBaseDirectory">
          <span data-ttu-id="70b50-177">包括来自于存档的根的 <c>sourceDirectoryName</c> 的目录名称，则为 <see langword="true" />；仅包含目录中的内容，则为 <see langword="false" />。</span>
          <span class="sxs-lookup">
            <span data-stu-id="70b50-177">
              <see langword="true" /> to include the directory name from <c>sourceDirectoryName</c> at the root of the archive; <see langword="false" /> to include only the contents of the directory.</span>
          </span>
        </param>
        <param name="entryNameEncoding">
          <span data-ttu-id="70b50-178">在存档中读取或写入项名时使用的编码。</span>
          <span class="sxs-lookup">
            <span data-stu-id="70b50-178">The encoding to use when reading or writing entry names in this archive.</span>
          </span>
          <span data-ttu-id="70b50-179">仅当需要针对具有不支持项名的 UTF-8 编码的 zip 归档工具和库的互操作性进行编码时，为此参数指定一个值。</span>
          <span class="sxs-lookup">
            <span data-stu-id="70b50-179">Specify a value for this parameter only when an encoding is required for interoperability with zip archive tools and libraries that do not support UTF-8 encoding for entry names.</span>
          </span>
        </param>
        <summary>
          <span data-ttu-id="70b50-180">创建 zip 存档，该存档包括文件和指定目录的目录，使用指定压缩级别和条目名称的字符编码，以及可以选择包含基目录。</span>
          <span class="sxs-lookup">
            <span data-stu-id="70b50-180">Creates a zip archive that contains the files and directories from the specified directory, uses the specified compression level and character encoding for entry names, and optionally includes the base directory.</span>
          </span>
        </summary>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="70b50-181">从文件系统的目录结构将保留在存档中。</span><span class="sxs-lookup"><span data-stu-id="70b50-181">The directory structure from the file system is preserved in the archive.</span></span> <span data-ttu-id="70b50-182">如果此目录为空，则创建空存档。</span><span class="sxs-lookup"><span data-stu-id="70b50-182">If the directory is empty, an empty archive is created.</span></span> <span data-ttu-id="70b50-183">使用此方法重载来指定压缩级别和字符编码，以及是否要包含在存档中的基目录。</span><span class="sxs-lookup"><span data-stu-id="70b50-183">Use this method overload to specify the compression level and character encoding, and whether to include the base directory in the archive.</span></span>  
  
 <span data-ttu-id="70b50-184">如果存档已存在，<xref:System.IO.IOException>引发异常。</span><span class="sxs-lookup"><span data-stu-id="70b50-184">If the archive already exists, an <xref:System.IO.IOException> exception is thrown.</span></span> <span data-ttu-id="70b50-185">如果在存档中已存在一个具有指定名称的项，第二个条目被创建具有相同的名称。</span><span class="sxs-lookup"><span data-stu-id="70b50-185">If an entry with the specified name already exists in the archive, a second entry is created with an identical name.</span></span>  
  
 <span data-ttu-id="70b50-186">如果无法将目录中的文件添加到存档，存档左不完整和无效，并且该方法将引发<xref:System.IO.IOException>异常。</span><span class="sxs-lookup"><span data-stu-id="70b50-186">If a file in the directory cannot be added to the archive, the archive is left incomplete and invalid, and the method throws an <xref:System.IO.IOException> exception.</span></span>  
  
 <span data-ttu-id="70b50-187">如果`entryNameEncoding`设置一个值为非`null`，通过使用指定的编码进行编码条目名称。</span><span class="sxs-lookup"><span data-stu-id="70b50-187">If `entryNameEncoding` is set to a value other than `null`, the entry names are encoded by using the specified encoding.</span></span> <span data-ttu-id="70b50-188">如果指定的编码为 utf-8，为每个条目，设置编码标志 （在本地文件头的通用的位标志） 的语言</span><span class="sxs-lookup"><span data-stu-id="70b50-188">If the specified encoding is a UTF-8, the language encoding flag (in the general-purpose bit flag of the local file header) is set for each entry,</span></span>  
  
 <span data-ttu-id="70b50-189">如果`entryNameEncoding`设置为`null`，条目名称是根据以下规则进行编码：</span><span class="sxs-lookup"><span data-stu-id="70b50-189">If `entryNameEncoding` is set to `null`, the entry names are encoded according to the following rules:</span></span>  
  
-   <span data-ttu-id="70b50-190">包含 ASCII 范围外的字符的项名称，设置语言编码标志，并使用 utf-8 编码条目名称。</span><span class="sxs-lookup"><span data-stu-id="70b50-190">For entry names that contain characters outside the ASCII range, the language encoding flag is set, and UTF-8 is used to encode the entry name.</span></span>  
  
-   <span data-ttu-id="70b50-191">仅包含 ASCII 字符的项名称，设置语言编码标志，和当前的系统默认代码页用于编码条目名称。</span><span class="sxs-lookup"><span data-stu-id="70b50-191">For entry names that contain only ASCII characters, the language encoding flag is set, and the current system default code page is used to encode the entry names.</span></span>  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentException">
          <span data-ttu-id="70b50-192">
            <paramref name="sourceDirectoryName" /> 或 <paramref name="destinationArchiveFileName" /> 是 <see cref="F:System.String.Empty" />，仅包含空格，或包含至少一个无效字符。</span>
          <span class="sxs-lookup">
            <span data-stu-id="70b50-192">
              <paramref name="sourceDirectoryName" /> or <paramref name="destinationArchiveFileName" /> is <see cref="F:System.String.Empty" />, contains only white space, or contains at least one invalid character.</span>
          </span>
          <span data-ttu-id="70b50-193">- 或 -  <paramref name="entryNameEncoding" /> 设置为不同于 UTF-8 的 Unicode 编码。</span>
          <span class="sxs-lookup">
            <span data-stu-id="70b50-193">-or-  <paramref name="entryNameEncoding" /> is set to a Unicode encoding other than UTF-8.</span>
          </span>
        </exception>
        <exception cref="T:System.ArgumentNullException">
          <span data-ttu-id="70b50-194">
            <paramref name="sourceDirectoryName" /> 或 <paramref name="destinationArchiveFileName" /> 为 <see langword="null" />。</span>
          <span class="sxs-lookup">
            <span data-stu-id="70b50-194">
              <paramref name="sourceDirectoryName" /> or <paramref name="destinationArchiveFileName" /> is <see langword="null" />.</span>
          </span>
        </exception>
        <exception cref="T:System.IO.PathTooLongException">
          <span data-ttu-id="70b50-195">在 <paramref name="sourceDirectoryName" /> 或 <paramref name="destinationArchiveFileName" /> 内，指定的路径、文件名或者两者都超出了系统定义的最大长度。</span>
          <span class="sxs-lookup">
            <span data-stu-id="70b50-195">In <paramref name="sourceDirectoryName" /> or <paramref name="destinationArchiveFileName" />, the specified path, file name, or both exceed the system-defined maximum length.</span>
          </span>
        </exception>
        <exception cref="T:System.IO.DirectoryNotFoundException">
          <span data-ttu-id="70b50-196">
            <paramref name="sourceDirectoryName" /> 无效或不存在（例如，在未映射的驱动器上）。</span>
          <span class="sxs-lookup">
            <span data-stu-id="70b50-196">
              <paramref name="sourceDirectoryName" /> is invalid or does not exist (for example, it is on an unmapped drive).</span>
          </span>
        </exception>
        <exception cref="T:System.IO.IOException">
          <span data-ttu-id="70b50-197">
            <paramref name="destinationArchiveFileName" /> 已存在。</span>
          <span class="sxs-lookup">
            <span data-stu-id="70b50-197">
              <paramref name="destinationArchiveFileName" /> already exists.</span>
          </span>
          <span data-ttu-id="70b50-198">- 或 -  无法打开指定目录中的文件。</span>
          <span class="sxs-lookup">
            <span data-stu-id="70b50-198">-or-  A file in the specified directory could not be opened.</span>
          </span>
        </exception>
        <exception cref="T:System.UnauthorizedAccessException">
          <span data-ttu-id="70b50-199">
            <paramref name="destinationArchiveFileName" /> 指定目录。</span>
          <span class="sxs-lookup">
            <span data-stu-id="70b50-199">
              <paramref name="destinationArchiveFileName" /> specifies a directory.</span>
          </span>
          <span data-ttu-id="70b50-200">- 或 -  调用方不具有访问在 <paramref name="sourceDirectoryName" /> 中指定的目录或在 <paramref name="destinationArchiveFileName" /> 中指定的文件的所需权限。</span>
          <span class="sxs-lookup">
            <span data-stu-id="70b50-200">-or-  The caller does not have the required permission to access the directory specified in <paramref name="sourceDirectoryName" /> or the file specified in <paramref name="destinationArchiveFileName" />.</span>
          </span>
        </exception>
        <exception cref="T:System.NotSupportedException">
          <span data-ttu-id="70b50-201">
            <paramref name="sourceDirectoryName" /> 或 <paramref name="destinationArchiveFileName" /> 包含的格式无效。</span>
          <span class="sxs-lookup">
            <span data-stu-id="70b50-201">
              <paramref name="sourceDirectoryName" /> or <paramref name="destinationArchiveFileName" /> contains an invalid format.</span>
          </span>
          <span data-ttu-id="70b50-202">- 或 -  zip 存档不支持写入。</span>
          <span class="sxs-lookup">
            <span data-stu-id="70b50-202">-or-  The zip archive does not support writing.</span>
          </span>
        </exception>
      </Docs>
    </Member>
    <MemberGroup MemberName="ExtractToDirectory">
      <AssemblyInfo>
        <AssemblyName>System.IO.Compression.ZipFile</AssemblyName>
        <AssemblyVersion>4.0.1.0</AssemblyVersion>
        <AssemblyVersion>4.0.3.0</AssemblyVersion>
      </AssemblyInfo>
      <Docs>
        <summary>
          <span data-ttu-id="70b50-203">将指定 zip 存档中的所有文件都解压缩到文件系统的一个目录下。</span>
          <span class="sxs-lookup">
            <span data-stu-id="70b50-203">Extracts all the files in the specified zip archive to a directory on the file system.</span>
          </span>
        </summary>
      </Docs>
    </MemberGroup>
    <Member MemberName="ExtractToDirectory">
      <MemberSignature Language="C#" Value="public static void ExtractToDirectory (string sourceArchiveFileName, string destinationDirectoryName);" />
      <MemberSignature Language="ILAsm" Value=".method public static hidebysig void ExtractToDirectory(string sourceArchiveFileName, string destinationDirectoryName) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.IO.Compression.ZipFile.ExtractToDirectory(System.String,System.String)" />
      <MemberSignature Language="VB.NET" Value="Public Shared Sub ExtractToDirectory (sourceArchiveFileName As String, destinationDirectoryName As String)" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; static void ExtractToDirectory(System::String ^ sourceArchiveFileName, System::String ^ destinationDirectoryName);" />
      <MemberSignature Language="F#" Value="static member ExtractToDirectory : string * string -&gt; unit" Usage="System.IO.Compression.ZipFile.ExtractToDirectory (sourceArchiveFileName, destinationDirectoryName)" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.IO.Compression.ZipFile</AssemblyName>
        <AssemblyVersion>4.0.1.0</AssemblyVersion>
        <AssemblyVersion>4.0.3.0</AssemblyVersion>
        <AssemblyVersion>4.0.4.0</AssemblyVersion>
      </AssemblyInfo>
      <AssemblyInfo>
        <AssemblyName>System.IO.Compression.FileSystem</AssemblyName>
        <AssemblyVersion>2.0.5.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <AssemblyInfo>
        <AssemblyName>netstandard</AssemblyName>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Void</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="sourceArchiveFileName" Type="System.String" />
        <Parameter Name="destinationDirectoryName" Type="System.String" />
      </Parameters>
      <Docs>
        <param name="sourceArchiveFileName">
          <span data-ttu-id="70b50-204">要解压缩存档的路径。</span>
          <span class="sxs-lookup">
            <span data-stu-id="70b50-204">The path to the archive that is to be extracted.</span>
          </span>
        </param>
        <param name="destinationDirectoryName">
          <span data-ttu-id="70b50-205">放置解压缩文件的目录的路径，指定为相对或绝对路径。</span>
          <span class="sxs-lookup">
            <span data-stu-id="70b50-205">The path to the directory in which to place the extracted files, specified as a relative or absolute path.</span>
          </span>
          <span data-ttu-id="70b50-206">相对路径是指相对于当前工作目录的路径。</span>
          <span class="sxs-lookup">
            <span data-stu-id="70b50-206">A relative path is interpreted as relative to the current working directory.</span>
          </span>
        </param>
        <summary>
          <span data-ttu-id="70b50-207">将指定 zip 存档中的所有文件都解压缩到文件系统的一个目录下。</span>
          <span class="sxs-lookup">
            <span data-stu-id="70b50-207">Extracts all the files in the specified zip archive to a directory on the file system.</span>
          </span>
        </summary>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="70b50-208">此方法创建指定的目录及其所有子目录。</span><span class="sxs-lookup"><span data-stu-id="70b50-208">This method creates the specified directory and all subdirectories.</span></span> <span data-ttu-id="70b50-209">目标目录不能已存在。</span><span class="sxs-lookup"><span data-stu-id="70b50-209">The destination directory cannot already exist.</span></span> <span data-ttu-id="70b50-210">验证中的路径与异常`destinationDirectoryName`或`sourceArchiveFileName`参数引发之前提取。</span><span class="sxs-lookup"><span data-stu-id="70b50-210">Exceptions related to validating the paths in the `destinationDirectoryName` or `sourceArchiveFileName` parameters are thrown before extraction.</span></span> <span data-ttu-id="70b50-211">否则，如果提取过程中发生错误，保持部分提取存档。</span><span class="sxs-lookup"><span data-stu-id="70b50-211">Otherwise, if an error occurs during extraction, the archive remains partially extracted.</span></span> <span data-ttu-id="70b50-212">每个提取的文件具有指定的目录的同一相对路径`destinationDirectoryName`作为其源项均具有到存档的根。</span><span class="sxs-lookup"><span data-stu-id="70b50-212">Each extracted file has the same relative path to the directory specified by `destinationDirectoryName` as its source entry has to the root of the archive.</span></span>  
  
   
  
## Examples  
 <span data-ttu-id="70b50-213">此示例演示如何创建和使用提取某个 zip 存档<xref:System.IO.Compression.ZipFile>类。</span><span class="sxs-lookup"><span data-stu-id="70b50-213">This example shows how to create and extract a zip archive by using the <xref:System.IO.Compression.ZipFile> class.</span></span> <span data-ttu-id="70b50-214">它将文件夹的内容压缩成 zip 存档，该将内容提取到一个新文件夹。</span><span class="sxs-lookup"><span data-stu-id="70b50-214">It compresses the contents of a folder into a zip archive and extracts that content to a new folder.</span></span> <span data-ttu-id="70b50-215">若要使用 <xref:System.IO.Compression.ZipFile> 类，必须在项目中引用 `System.IO.Compression.FileSystem` 程序集。</span><span class="sxs-lookup"><span data-stu-id="70b50-215">To use the <xref:System.IO.Compression.ZipFile> class, you must reference the `System.IO.Compression.FileSystem` assembly in your project.</span></span>  
  
 [!code-csharp[System.IO.Compression.ZipFile#1](~/samples/snippets/csharp/VS_Snippets_CLR_System/system.io.compression.zipfile/cs/program1.cs#1)]
 [!code-vb[System.IO.Compression.ZipFile#1](~/samples/snippets/visualbasic/VS_Snippets_CLR_System/system.io.compression.zipfile/vb/program1.vb#1)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentException">
          <span data-ttu-id="70b50-216">
            <paramref name="destinationDirectoryName" /> 或 <paramref name="sourceArchiveFileName" /> 是 <see cref="F:System.String.Empty" />，仅包含空格，或包含至少一个无效字符。</span>
          <span class="sxs-lookup">
            <span data-stu-id="70b50-216">
              <paramref name="destinationDirectoryName" /> or <paramref name="sourceArchiveFileName" /> is <see cref="F:System.String.Empty" />, contains only white space, or contains at least one invalid character.</span>
          </span>
        </exception>
        <exception cref="T:System.ArgumentNullException">
          <span data-ttu-id="70b50-217">
            <paramref name="destinationDirectoryName" /> 或 <paramref name="sourceArchiveFileName" /> 为 <see langword="null" />。</span>
          <span class="sxs-lookup">
            <span data-stu-id="70b50-217">
              <paramref name="destinationDirectoryName" /> or <paramref name="sourceArchiveFileName" /> is <see langword="null" />.</span>
          </span>
        </exception>
        <exception cref="T:System.IO.PathTooLongException">
          <span data-ttu-id="70b50-218">
            <paramref name="destinationDirectoryName" /> 或 <paramref name="sourceArchiveFileName" /> 中的指定路径超过了系统定义的最大长度。</span>
          <span class="sxs-lookup">
            <span data-stu-id="70b50-218">The specified path in <paramref name="destinationDirectoryName" /> or <paramref name="sourceArchiveFileName" /> exceeds the system-defined maximum length.</span>
          </span>
        </exception>
        <exception cref="T:System.IO.DirectoryNotFoundException">
          <span data-ttu-id="70b50-219">指定的路径无效（例如，它位于未映射的驱动器上）。</span>
          <span class="sxs-lookup">
            <span data-stu-id="70b50-219">The specified path is invalid (for example, it is on an unmapped drive).</span>
          </span>
        </exception>
        <exception cref="T:System.IO.IOException">
          <span data-ttu-id="70b50-220">
            <paramref name="destinationDirectoryName" /> 指定的目录已存在。</span>
          <span class="sxs-lookup">
            <span data-stu-id="70b50-220">The directory specified by <paramref name="destinationDirectoryName" /> already exists.</span>
          </span>
          <span data-ttu-id="70b50-221">- 或 -  存档中的一个条目名是 <see cref="F:System.String.Empty" />，仅包含空格，或者包含至少一个无效字符。</span>
          <span class="sxs-lookup">
            <span data-stu-id="70b50-221">-or-  The name of an entry in the archive is <see cref="F:System.String.Empty" />, contains only white space, or contains at least one invalid character.</span>
          </span>
          <span data-ttu-id="70b50-222">- 或 -  提取存档条目会在 <paramref name="destinationDirectoryName" /> 指定的目录之外创建一个文件。</span>
          <span class="sxs-lookup">
            <span data-stu-id="70b50-222">-or-  Extracting an archive entry would create a file that is outside the directory specified by <paramref name="destinationDirectoryName" />.</span>
          </span>
          <span data-ttu-id="70b50-223">（例如，条目名称包含父级目录访问器时就可能出现这种情况。）  - 或 -  要提取的存档条目的名称与已从相同存档提取的条目相同。</span>
          <span class="sxs-lookup">
            <span data-stu-id="70b50-223">(For example, this might happen if the entry name contains parent directory accessors.)  -or-  An archive entry to extract has the same name as an entry that has already been extracted from the same archive.</span>
          </span>
        </exception>
        <exception cref="T:System.UnauthorizedAccessException">
          <span data-ttu-id="70b50-224">调用方不具有访问存档或目标目录的所需权限。</span>
          <span class="sxs-lookup">
            <span data-stu-id="70b50-224">The caller does not have the required permission to access the archive or the destination directory.</span>
          </span>
        </exception>
        <exception cref="T:System.NotSupportedException">
          <span data-ttu-id="70b50-225">
            <paramref name="destinationDirectoryName" /> 或 <paramref name="sourceArchiveFileName" /> 包含的格式无效。</span>
          <span class="sxs-lookup">
            <span data-stu-id="70b50-225">
              <paramref name="destinationDirectoryName" /> or <paramref name="sourceArchiveFileName" /> contains an invalid format.</span>
          </span>
        </exception>
        <exception cref="T:System.IO.FileNotFoundException">
          <span data-ttu-id="70b50-226">未找到 <paramref name="sourceArchiveFileName" />。</span>
          <span class="sxs-lookup">
            <span data-stu-id="70b50-226">
              <paramref name="sourceArchiveFileName" /> was not found.</span>
          </span>
        </exception>
        <exception cref="T:System.IO.InvalidDataException">
          <span data-ttu-id="70b50-227">由 <paramref name="sourceArchiveFileName" /> 指定的存档不是有效 zip 存档。</span>
          <span class="sxs-lookup">
            <span data-stu-id="70b50-227">The archive specified by <paramref name="sourceArchiveFileName" /> is not a valid zip archive.</span>
          </span>
          <span data-ttu-id="70b50-228">- 或 -  存档条目未找到或已损坏。</span>
          <span class="sxs-lookup">
            <span data-stu-id="70b50-228">-or-  An archive entry was not found or was corrupt.</span>
          </span>
          <span data-ttu-id="70b50-229">- 或 -  使用了一种不支持的压缩方法压缩存档条目。</span>
          <span class="sxs-lookup">
            <span data-stu-id="70b50-229">-or-  An archive entry was compressed by using a compression method that is not supported.</span>
          </span>
        </exception>
      </Docs>
    </Member>
    <Member MemberName="ExtractToDirectory">
      <MemberSignature Language="C#" Value="public static void ExtractToDirectory (string sourceArchiveFileName, string destinationDirectoryName, bool overwriteFiles);" />
      <MemberSignature Language="ILAsm" Value=".method public static hidebysig void ExtractToDirectory(string sourceArchiveFileName, string destinationDirectoryName, bool overwriteFiles) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.IO.Compression.ZipFile.ExtractToDirectory(System.String,System.String,System.Boolean)" />
      <MemberSignature Language="VB.NET" Value="Public Shared Sub ExtractToDirectory (sourceArchiveFileName As String, destinationDirectoryName As String, overwriteFiles As Boolean)" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; static void ExtractToDirectory(System::String ^ sourceArchiveFileName, System::String ^ destinationDirectoryName, bool overwriteFiles);" />
      <MemberSignature Language="F#" Value="static member ExtractToDirectory : string * string * bool -&gt; unit" Usage="System.IO.Compression.ZipFile.ExtractToDirectory (sourceArchiveFileName, destinationDirectoryName, overwriteFiles)" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.IO.Compression.ZipFile</AssemblyName>
        <AssemblyVersion>4.0.3.0</AssemblyVersion>
        <AssemblyVersion>4.0.4.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Void</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="sourceArchiveFileName" Type="System.String" />
        <Parameter Name="destinationDirectoryName" Type="System.String" />
        <Parameter Name="overwriteFiles" Type="System.Boolean" />
      </Parameters>
      <Docs>
        <param name="sourceArchiveFileName">To be added.</param>
        <param name="destinationDirectoryName">To be added.</param>
        <param name="overwriteFiles">To be added.</param>
        <summary>To be added.</summary>
        <remarks>To be added.</remarks>
      </Docs>
    </Member>
    <Member MemberName="ExtractToDirectory">
      <MemberSignature Language="C#" Value="public static void ExtractToDirectory (string sourceArchiveFileName, string destinationDirectoryName, System.Text.Encoding entryNameEncoding);" />
      <MemberSignature Language="ILAsm" Value=".method public static hidebysig void ExtractToDirectory(string sourceArchiveFileName, string destinationDirectoryName, class System.Text.Encoding entryNameEncoding) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.IO.Compression.ZipFile.ExtractToDirectory(System.String,System.String,System.Text.Encoding)" />
      <MemberSignature Language="VB.NET" Value="Public Shared Sub ExtractToDirectory (sourceArchiveFileName As String, destinationDirectoryName As String, entryNameEncoding As Encoding)" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; static void ExtractToDirectory(System::String ^ sourceArchiveFileName, System::String ^ destinationDirectoryName, System::Text::Encoding ^ entryNameEncoding);" />
      <MemberSignature Language="F#" Value="static member ExtractToDirectory : string * string * System.Text.Encoding -&gt; unit" Usage="System.IO.Compression.ZipFile.ExtractToDirectory (sourceArchiveFileName, destinationDirectoryName, entryNameEncoding)" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.IO.Compression.ZipFile</AssemblyName>
        <AssemblyVersion>4.0.1.0</AssemblyVersion>
        <AssemblyVersion>4.0.3.0</AssemblyVersion>
        <AssemblyVersion>4.0.4.0</AssemblyVersion>
      </AssemblyInfo>
      <AssemblyInfo>
        <AssemblyName>System.IO.Compression.FileSystem</AssemblyName>
        <AssemblyVersion>2.0.5.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <AssemblyInfo>
        <AssemblyName>netstandard</AssemblyName>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Void</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="sourceArchiveFileName" Type="System.String" />
        <Parameter Name="destinationDirectoryName" Type="System.String" />
        <Parameter Name="entryNameEncoding" Type="System.Text.Encoding" />
      </Parameters>
      <Docs>
        <param name="sourceArchiveFileName">
          <span data-ttu-id="70b50-230">要解压缩存档的路径。</span>
          <span class="sxs-lookup">
            <span data-stu-id="70b50-230">The path to the archive that is to be extracted.</span>
          </span>
        </param>
        <param name="destinationDirectoryName">
          <span data-ttu-id="70b50-231">放置解压缩文件的目录的路径，指定为相对或绝对路径。</span>
          <span class="sxs-lookup">
            <span data-stu-id="70b50-231">The path to the directory in which to place the extracted files, specified as a relative or absolute path.</span>
          </span>
          <span data-ttu-id="70b50-232">相对路径是指相对于当前工作目录的路径。</span>
          <span class="sxs-lookup">
            <span data-stu-id="70b50-232">A relative path is interpreted as relative to the current working directory.</span>
          </span>
        </param>
        <param name="entryNameEncoding">
          <span data-ttu-id="70b50-233">在存档中读取或写入项名时使用的编码。</span>
          <span class="sxs-lookup">
            <span data-stu-id="70b50-233">The encoding to use when reading or writing entry names in this archive.</span>
          </span>
          <span data-ttu-id="70b50-234">仅当需要针对具有不支持项名的 UTF-8 编码的 zip 归档工具和库的互操作性进行编码时，为此参数指定一个值。</span>
          <span class="sxs-lookup">
            <span data-stu-id="70b50-234">Specify a value for this parameter only when an encoding is required for interoperability with zip archive tools and libraries that do not support UTF-8 encoding for entry names.</span>
          </span>
        </param>
        <summary>
          <span data-ttu-id="70b50-235">将指定 zip 存档中的所有文件解压缩到文件系统的一目录下，并使用项名称的指定字符编码。</span>
          <span class="sxs-lookup">
            <span data-stu-id="70b50-235">Extracts all the files in the specified zip archive to a directory on the file system and uses the specified character encoding for entry names.</span>
          </span>
        </summary>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="70b50-236">此方法创建指定的目录及其所有子目录。</span><span class="sxs-lookup"><span data-stu-id="70b50-236">This method creates the specified directory and all subdirectories.</span></span> <span data-ttu-id="70b50-237">目标目录不能已存在。</span><span class="sxs-lookup"><span data-stu-id="70b50-237">The destination directory cannot already exist.</span></span> <span data-ttu-id="70b50-238">验证中的路径与异常`destinationDirectoryName`或`sourceArchiveFileName`参数引发之前提取。</span><span class="sxs-lookup"><span data-stu-id="70b50-238">Exceptions related to validating the paths in the `destinationDirectoryName` or `sourceArchiveFileName` parameters are thrown before extraction.</span></span> <span data-ttu-id="70b50-239">否则，如果提取过程中发生错误，保持部分提取存档。</span><span class="sxs-lookup"><span data-stu-id="70b50-239">Otherwise, if an error occurs during extraction, the archive remains partially extracted.</span></span> <span data-ttu-id="70b50-240">每个提取的文件具有指定的目录的同一相对路径`destinationDirectoryName`作为其源项均具有到存档的根。</span><span class="sxs-lookup"><span data-stu-id="70b50-240">Each extracted file has the same relative path to the directory specified by `destinationDirectoryName` as its source entry has to the root of the archive.</span></span>  
  
 <span data-ttu-id="70b50-241">如果`entryNameEncoding`设置一个值为非`null`，条目名称解码根据下列规则：</span><span class="sxs-lookup"><span data-stu-id="70b50-241">If `entryNameEncoding` is set to a value other than `null`, entry names are decoded according to the following rules:</span></span>  
  
-   <span data-ttu-id="70b50-242">不设置编码标志 （在本地文件头的通用的位标志） 的语言的位置的项名称，通过使用指定的编码解码条目名称。</span><span class="sxs-lookup"><span data-stu-id="70b50-242">For entry names where the language encoding flag (in the general-purpose bit flag of the local file header) is not set, the entry names are decoded by using the specified encoding.</span></span>  
  
-   <span data-ttu-id="70b50-243">对于其中设置语言编码标志的条目，通过使用 utf-8 解码条目名称。</span><span class="sxs-lookup"><span data-stu-id="70b50-243">For entries where the language encoding flag is set, the entry names are decoded by using UTF-8.</span></span>  
  
 <span data-ttu-id="70b50-244">如果`entryNameEncoding`设置为`null`，条目名称解码根据下列规则：</span><span class="sxs-lookup"><span data-stu-id="70b50-244">If `entryNameEncoding` is set to `null`, entry names are decoded according to the following rules:</span></span>  
  
-   <span data-ttu-id="70b50-245">对于其中不设置编码标志 （在本地文件头的通用的位标志） 的语言的条目，通过使用当前的系统默认代码页解码条目名称。</span><span class="sxs-lookup"><span data-stu-id="70b50-245">For entries where the language encoding flag (in the general-purpose bit flag of the local file header) is not set, entry names are decoded by using the current system default code page.</span></span>  
  
-   <span data-ttu-id="70b50-246">对于其中设置语言编码标志的条目，通过使用 utf-8 解码条目名称。</span><span class="sxs-lookup"><span data-stu-id="70b50-246">For entries where the language encoding flag is set, the entry names are decoded by using UTF-8.</span></span>  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentException">
          <span data-ttu-id="70b50-247">
            <paramref name="destinationDirectoryName" /> 或 <paramref name="sourceArchiveFileName" /> 是 <see cref="F:System.String.Empty" />，仅包含空格，或包含至少一个无效字符。</span>
          <span class="sxs-lookup">
            <span data-stu-id="70b50-247">
              <paramref name="destinationDirectoryName" /> or <paramref name="sourceArchiveFileName" /> is <see cref="F:System.String.Empty" />, contains only white space, or contains at least one invalid character.</span>
          </span>
          <span data-ttu-id="70b50-248">- 或 -  <paramref name="entryNameEncoding" /> 设置为不同于 UTF-8 的 Unicode 编码。</span>
          <span class="sxs-lookup">
            <span data-stu-id="70b50-248">-or-  <paramref name="entryNameEncoding" /> is set to a Unicode encoding other than UTF-8.</span>
          </span>
        </exception>
        <exception cref="T:System.ArgumentNullException">
          <span data-ttu-id="70b50-249">
            <paramref name="destinationDirectoryName" /> 或 <paramref name="sourceArchiveFileName" /> 为 <see langword="null" />。</span>
          <span class="sxs-lookup">
            <span data-stu-id="70b50-249">
              <paramref name="destinationDirectoryName" /> or <paramref name="sourceArchiveFileName" /> is <see langword="null" />.</span>
          </span>
        </exception>
        <exception cref="T:System.IO.PathTooLongException">
          <span data-ttu-id="70b50-250">
            <paramref name="destinationDirectoryName" /> 或 <paramref name="sourceArchiveFileName" /> 中的指定路径超过了系统定义的最大长度。</span>
          <span class="sxs-lookup">
            <span data-stu-id="70b50-250">The specified path in <paramref name="destinationDirectoryName" /> or <paramref name="sourceArchiveFileName" /> exceeds the system-defined maximum length.</span>
          </span>
        </exception>
        <exception cref="T:System.IO.DirectoryNotFoundException">
          <span data-ttu-id="70b50-251">指定的路径无效（例如，它位于未映射的驱动器上）。</span>
          <span class="sxs-lookup">
            <span data-stu-id="70b50-251">The specified path is invalid (for example, it is on an unmapped drive).</span>
          </span>
        </exception>
        <exception cref="T:System.IO.IOException">
          <span data-ttu-id="70b50-252">
            <paramref name="destinationDirectoryName" /> 指定的目录已存在。</span>
          <span class="sxs-lookup">
            <span data-stu-id="70b50-252">The directory specified by <paramref name="destinationDirectoryName" /> already exists.</span>
          </span>
          <span data-ttu-id="70b50-253">- 或 -  存档中的一个条目名是 <see cref="F:System.String.Empty" />，仅包含空格，或者包含至少一个无效字符。</span>
          <span class="sxs-lookup">
            <span data-stu-id="70b50-253">-or-  The name of an entry in the archive is <see cref="F:System.String.Empty" />, contains only white space, or contains at least one invalid character.</span>
          </span>
          <span data-ttu-id="70b50-254">- 或 -  提取存档条目会在 <paramref name="destinationDirectoryName" /> 指定的目录之外创建一个文件。</span>
          <span class="sxs-lookup">
            <span data-stu-id="70b50-254">-or-  Extracting an archive entry would create a file that is outside the directory specified by <paramref name="destinationDirectoryName" />.</span>
          </span>
          <span data-ttu-id="70b50-255">（例如，条目名称包含父级目录访问器时就可能出现这种情况。）  - 或 -  要提取的存档条目的名称与已从相同存档提取的条目相同。</span>
          <span class="sxs-lookup">
            <span data-stu-id="70b50-255">(For example, this might happen if the entry name contains parent directory accessors.)  -or-  An archive entry to extract has the same name as an entry that has already been extracted from the same archive.</span>
          </span>
        </exception>
        <exception cref="T:System.UnauthorizedAccessException">
          <span data-ttu-id="70b50-256">调用方不具有访问存档或目标目录的所需权限。</span>
          <span class="sxs-lookup">
            <span data-stu-id="70b50-256">The caller does not have the required permission to access the archive or the destination directory.</span>
          </span>
        </exception>
        <exception cref="T:System.NotSupportedException">
          <span data-ttu-id="70b50-257">
            <paramref name="destinationDirectoryName" /> 或 <paramref name="sourceArchiveFileName" /> 包含的格式无效。</span>
          <span class="sxs-lookup">
            <span data-stu-id="70b50-257">
              <paramref name="destinationDirectoryName" /> or <paramref name="sourceArchiveFileName" /> contains an invalid format.</span>
          </span>
        </exception>
        <exception cref="T:System.IO.FileNotFoundException">
          <span data-ttu-id="70b50-258">未找到 <paramref name="sourceArchiveFileName" />。</span>
          <span class="sxs-lookup">
            <span data-stu-id="70b50-258">
              <paramref name="sourceArchiveFileName" /> was not found.</span>
          </span>
        </exception>
        <exception cref="T:System.IO.InvalidDataException">
          <span data-ttu-id="70b50-259">由 <paramref name="sourceArchiveFileName" /> 指定的存档不是有效 zip 存档。</span>
          <span class="sxs-lookup">
            <span data-stu-id="70b50-259">The archive specified by <paramref name="sourceArchiveFileName" /> is not a valid zip archive.</span>
          </span>
          <span data-ttu-id="70b50-260">- 或 -  存档条目未找到或已损坏。</span>
          <span class="sxs-lookup">
            <span data-stu-id="70b50-260">-or-  An archive entry was not found or was corrupt.</span>
          </span>
          <span data-ttu-id="70b50-261">- 或 -  使用了一种不支持的压缩方法压缩存档条目。</span>
          <span class="sxs-lookup">
            <span data-stu-id="70b50-261">-or-  An archive entry was compressed by using a compression method that is not supported.</span>
          </span>
        </exception>
      </Docs>
    </Member>
    <Member MemberName="ExtractToDirectory">
      <MemberSignature Language="C#" Value="public static void ExtractToDirectory (string sourceArchiveFileName, string destinationDirectoryName, System.Text.Encoding entryNameEncoding, bool overwriteFiles);" />
      <MemberSignature Language="ILAsm" Value=".method public static hidebysig void ExtractToDirectory(string sourceArchiveFileName, string destinationDirectoryName, class System.Text.Encoding entryNameEncoding, bool overwriteFiles) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.IO.Compression.ZipFile.ExtractToDirectory(System.String,System.String,System.Text.Encoding,System.Boolean)" />
      <MemberSignature Language="VB.NET" Value="Public Shared Sub ExtractToDirectory (sourceArchiveFileName As String, destinationDirectoryName As String, entryNameEncoding As Encoding, overwriteFiles As Boolean)" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; static void ExtractToDirectory(System::String ^ sourceArchiveFileName, System::String ^ destinationDirectoryName, System::Text::Encoding ^ entryNameEncoding, bool overwriteFiles);" />
      <MemberSignature Language="F#" Value="static member ExtractToDirectory : string * string * System.Text.Encoding * bool -&gt; unit" Usage="System.IO.Compression.ZipFile.ExtractToDirectory (sourceArchiveFileName, destinationDirectoryName, entryNameEncoding, overwriteFiles)" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.IO.Compression.ZipFile</AssemblyName>
        <AssemblyVersion>4.0.3.0</AssemblyVersion>
        <AssemblyVersion>4.0.4.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Void</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="sourceArchiveFileName" Type="System.String" />
        <Parameter Name="destinationDirectoryName" Type="System.String" />
        <Parameter Name="entryNameEncoding" Type="System.Text.Encoding" />
        <Parameter Name="overwriteFiles" Type="System.Boolean" />
      </Parameters>
      <Docs>
        <param name="sourceArchiveFileName">To be added.</param>
        <param name="destinationDirectoryName">To be added.</param>
        <param name="entryNameEncoding">To be added.</param>
        <param name="overwriteFiles">To be added.</param>
        <summary>To be added.</summary>
        <remarks>To be added.</remarks>
      </Docs>
    </Member>
    <MemberGroup MemberName="Open">
      <AssemblyInfo>
        <AssemblyName>System.IO.Compression.ZipFile</AssemblyName>
        <AssemblyVersion>4.0.1.0</AssemblyVersion>
        <AssemblyVersion>4.0.3.0</AssemblyVersion>
      </AssemblyInfo>
      <Docs>
        <summary>
          <span data-ttu-id="70b50-262">以指定的模式打开指定路径上的 zip 存档。</span>
          <span class="sxs-lookup">
            <span data-stu-id="70b50-262">Opens a zip archive at the specified path and in the specified mode.</span>
          </span>
        </summary>
      </Docs>
    </MemberGroup>
    <Member MemberName="Open">
      <MemberSignature Language="C#" Value="public static System.IO.Compression.ZipArchive Open (string archiveFileName, System.IO.Compression.ZipArchiveMode mode);" />
      <MemberSignature Language="ILAsm" Value=".method public static hidebysig class System.IO.Compression.ZipArchive Open(string archiveFileName, valuetype System.IO.Compression.ZipArchiveMode mode) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.IO.Compression.ZipFile.Open(System.String,System.IO.Compression.ZipArchiveMode)" />
      <MemberSignature Language="VB.NET" Value="Public Shared Function Open (archiveFileName As String, mode As ZipArchiveMode) As ZipArchive" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; static System::IO::Compression::ZipArchive ^ Open(System::String ^ archiveFileName, System::IO::Compression::ZipArchiveMode mode);" />
      <MemberSignature Language="F#" Value="static member Open : string * System.IO.Compression.ZipArchiveMode -&gt; System.IO.Compression.ZipArchive" Usage="System.IO.Compression.ZipFile.Open (archiveFileName, mode)" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.IO.Compression.ZipFile</AssemblyName>
        <AssemblyVersion>4.0.1.0</AssemblyVersion>
        <AssemblyVersion>4.0.3.0</AssemblyVersion>
        <AssemblyVersion>4.0.4.0</AssemblyVersion>
      </AssemblyInfo>
      <AssemblyInfo>
        <AssemblyName>System.IO.Compression.FileSystem</AssemblyName>
        <AssemblyVersion>2.0.5.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <AssemblyInfo>
        <AssemblyName>netstandard</AssemblyName>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.IO.Compression.ZipArchive</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="archiveFileName" Type="System.String" />
        <Parameter Name="mode" Type="System.IO.Compression.ZipArchiveMode" />
      </Parameters>
      <Docs>
        <param name="archiveFileName">
          <span data-ttu-id="70b50-263">要打开的存档的路径，指定为相对路径或绝对路径。</span>
          <span class="sxs-lookup">
            <span data-stu-id="70b50-263">The path to the archive to open, specified as a relative or absolute path.</span>
          </span>
          <span data-ttu-id="70b50-264">相对路径是指相对于当前工作目录的路径。</span>
          <span class="sxs-lookup">
            <span data-stu-id="70b50-264">A relative path is interpreted as relative to the current working directory.</span>
          </span>
        </param>
        <param name="mode">
          <span data-ttu-id="70b50-265">指定允许对打开的存档中的项进行的操作的枚举值之一。</span>
          <span class="sxs-lookup">
            <span data-stu-id="70b50-265">One of the enumeration values that specifies the actions which are allowed on the entries in the opened archive.</span>
          </span>
        </param>
        <summary>
          <span data-ttu-id="70b50-266">以指定的模式打开指定路径上的 zip 存档。</span>
          <span class="sxs-lookup">
            <span data-stu-id="70b50-266">Opens a zip archive at the specified path and in the specified mode.</span>
          </span>
        </summary>
        <returns>
          <span data-ttu-id="70b50-267">打开的 zip 存档。</span>
          <span class="sxs-lookup">
            <span data-stu-id="70b50-267">The opened zip archive.</span>
          </span>
        </returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="70b50-268">当你将设置`mode`参数<xref:System.IO.Compression.ZipArchiveMode.Read>，使用打开存档<xref:System.IO.FileMode.Open>从<xref:System.IO.FileMode>枚举为的文件模式值。</span><span class="sxs-lookup"><span data-stu-id="70b50-268">When you set the `mode` parameter to <xref:System.IO.Compression.ZipArchiveMode.Read>, the archive is opened with <xref:System.IO.FileMode.Open> from the <xref:System.IO.FileMode> enumeration as the file mode value.</span></span> <span data-ttu-id="70b50-269">如果存档不存在，<xref:System.IO.FileNotFoundException>引发异常。</span><span class="sxs-lookup"><span data-stu-id="70b50-269">If the archive does not exist, a <xref:System.IO.FileNotFoundException> exception is thrown.</span></span> <span data-ttu-id="70b50-270">设置`mode`参数<xref:System.IO.Compression.ZipArchiveMode.Read>等效于调用<xref:System.IO.Compression.ZipFile.OpenRead%2A>方法。</span><span class="sxs-lookup"><span data-stu-id="70b50-270">Setting the `mode` parameter to <xref:System.IO.Compression.ZipArchiveMode.Read> is equivalent to calling the <xref:System.IO.Compression.ZipFile.OpenRead%2A> method.</span></span>  
  
 <span data-ttu-id="70b50-271">当你将设置`mode`参数<xref:System.IO.Compression.ZipArchiveMode.Create>，使用打开存档<xref:System.IO.FileMode.CreateNew?displayProperty=nameWithType>作为文件模式值。</span><span class="sxs-lookup"><span data-stu-id="70b50-271">When you set the `mode` parameter to <xref:System.IO.Compression.ZipArchiveMode.Create>, the archive is opened with <xref:System.IO.FileMode.CreateNew?displayProperty=nameWithType> as the file mode value.</span></span> <span data-ttu-id="70b50-272">如果存档已存在，<xref:System.IO.IOException>引发。</span><span class="sxs-lookup"><span data-stu-id="70b50-272">If the archive already exists, an <xref:System.IO.IOException> is thrown.</span></span>  
  
 <span data-ttu-id="70b50-273">当你将设置`mode`参数<xref:System.IO.Compression.ZipArchiveMode.Update>，使用打开存档<xref:System.IO.FileMode.OpenOrCreate?displayProperty=nameWithType>作为文件模式值。</span><span class="sxs-lookup"><span data-stu-id="70b50-273">When you set the `mode` parameter to <xref:System.IO.Compression.ZipArchiveMode.Update>,  the archive is opened with <xref:System.IO.FileMode.OpenOrCreate?displayProperty=nameWithType> as the file mode value.</span></span> <span data-ttu-id="70b50-274">如果存在存档，它打开。</span><span class="sxs-lookup"><span data-stu-id="70b50-274">If the archive exists, it is opened.</span></span> <span data-ttu-id="70b50-275">可以修改现有条目，并可以创建新项。</span><span class="sxs-lookup"><span data-stu-id="70b50-275">The existing entries can be modified and new entries can be created.</span></span> <span data-ttu-id="70b50-276">如果存档不存在，则创建新存档;但是，创建在 zip 存档<xref:System.IO.Compression.ZipArchiveMode.Update>模式不是创建在尽可能高效<xref:System.IO.Compression.ZipArchiveMode.Create>模式。</span><span class="sxs-lookup"><span data-stu-id="70b50-276">If the archive does not exist, a new archive is created; however, creating a zip archive in <xref:System.IO.Compression.ZipArchiveMode.Update> mode is not as efficient as creating it in <xref:System.IO.Compression.ZipArchiveMode.Create> mode.</span></span>  
  
   
  
## Examples  
 <span data-ttu-id="70b50-277">下面的示例演示如何在更新模式中打开 zip 存档并到存档中添加一个条目。</span><span class="sxs-lookup"><span data-stu-id="70b50-277">The following example shows how to open a zip archive in the update mode and add an entry to the archive.</span></span>  
  
 [!code-csharp[System.IO.Compression.ZipArchive#3](~/samples/snippets/csharp/VS_Snippets_CLR_System/system.io.compression.ziparchive/cs/program3.cs#3)]
 [!code-vb[System.IO.Compression.ZipArchive#3](~/samples/snippets/visualbasic/VS_Snippets_CLR_System/system.io.compression.ziparchive/vb/program3.vb#3)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentException">
          <span data-ttu-id="70b50-278">
            <paramref name="archiveFileName" /> 为 <see cref="F:System.String.Empty" />，仅包含空格，或者包含至少一个无效字符。</span>
          <span class="sxs-lookup">
            <span data-stu-id="70b50-278">
              <paramref name="archiveFileName" /> is <see cref="F:System.String.Empty" />, contains only white space, or contains at least one invalid character.</span>
          </span>
        </exception>
        <exception cref="T:System.ArgumentNullException">
          <span data-ttu-id="70b50-279">
            <paramref name="archiveFileName" /> 为 <see langword="null" />。</span>
          <span class="sxs-lookup">
            <span data-stu-id="70b50-279">
              <paramref name="archiveFileName" /> is <see langword="null" />.</span>
          </span>
        </exception>
        <exception cref="T:System.IO.PathTooLongException">
          <span data-ttu-id="70b50-280">在 <paramref name="archiveFileName" /> 内，指定的路径、文件名或者两者都超出了系统定义的最大长度。</span>
          <span class="sxs-lookup">
            <span data-stu-id="70b50-280">In <paramref name="archiveFileName" />, the specified path, file name, or both exceed the system-defined maximum length.</span>
          </span>
        </exception>
        <exception cref="T:System.IO.DirectoryNotFoundException">
          <span data-ttu-id="70b50-281">
            <paramref name="archiveFileName" /> 无效或不存在（例如，在未映射的驱动器上）。</span>
          <span class="sxs-lookup">
            <span data-stu-id="70b50-281">
              <paramref name="archiveFileName" /> is invalid or does not exist (for example, it is on an unmapped drive).</span>
          </span>
        </exception>
        <exception cref="T:System.IO.IOException">
          <span data-ttu-id="70b50-282">未能打开 <paramref name="archiveFileName" />。</span>
          <span class="sxs-lookup">
            <span data-stu-id="70b50-282">
              <paramref name="archiveFileName" /> could not be opened.</span>
          </span>
          <span data-ttu-id="70b50-283">- 或 -  <paramref name="mode" /> 设置为 <see cref="F:System.IO.Compression.ZipArchiveMode.Create" />，但在 <paramref name="archiveFileName" /> 中指定的文件已存在。</span>
          <span class="sxs-lookup">
            <span data-stu-id="70b50-283">-or-  <paramref name="mode" /> is set to <see cref="F:System.IO.Compression.ZipArchiveMode.Create" />, but the file specified in <paramref name="archiveFileName" /> already exists.</span>
          </span>
        </exception>
        <exception cref="T:System.UnauthorizedAccessException">
          <span data-ttu-id="70b50-284">
            <paramref name="archiveFileName" /> 指定目录。</span>
          <span class="sxs-lookup">
            <span data-stu-id="70b50-284">
              <paramref name="archiveFileName" /> specifies a directory.</span>
          </span>
          <span data-ttu-id="70b50-285">- 或 -  调用方没有访问在 <paramref name="archiveFileName" /> 中指定的文件的所需权限。</span>
          <span class="sxs-lookup">
            <span data-stu-id="70b50-285">-or-  The caller does not have the required permission to access the file specified in <paramref name="archiveFileName" />.</span>
          </span>
        </exception>
        <exception cref="T:System.ArgumentOutOfRangeException">
          <span data-ttu-id="70b50-286">
            <paramref name="mode" /> 指定了一个无效值。</span>
          <span class="sxs-lookup">
            <span data-stu-id="70b50-286">
              <paramref name="mode" /> specifies an invalid value.</span>
          </span>
        </exception>
        <exception cref="T:System.IO.FileNotFoundException">
          <span data-ttu-id="70b50-287">
            <paramref name="mode" /> 设置为 <see cref="F:System.IO.Compression.ZipArchiveMode.Read" />，但在 <paramref name="archiveFileName" /> 中指定的文件未找到。</span>
          <span class="sxs-lookup">
            <span data-stu-id="70b50-287">
              <paramref name="mode" /> is set to <see cref="F:System.IO.Compression.ZipArchiveMode.Read" />, but the file specified in <paramref name="archiveFileName" /> is not found.</span>
          </span>
        </exception>
        <exception cref="T:System.NotSupportedException">
          <span data-ttu-id="70b50-288">
            <paramref name="archiveFileName" /> 包含无效的格式。</span>
          <span class="sxs-lookup">
            <span data-stu-id="70b50-288">
              <paramref name="archiveFileName" /> contains an invalid format.</span>
          </span>
        </exception>
        <exception cref="T:System.IO.InvalidDataException">
          <span data-ttu-id="70b50-289">
            <paramref name="archiveFileName" /> 无法解释为 zip 存档文件。</span>
          <span class="sxs-lookup">
            <span data-stu-id="70b50-289">
              <paramref name="archiveFileName" /> could not be interpreted as a zip archive.</span>
          </span>
          <span data-ttu-id="70b50-290">- 或 -  <paramref name="mode" /> 是 <see cref="F:System.IO.Compression.ZipArchiveMode.Update" />，但条目已丢失或已损坏，因此无法读取。</span>
          <span class="sxs-lookup">
            <span data-stu-id="70b50-290">-or-  <paramref name="mode" /> is <see cref="F:System.IO.Compression.ZipArchiveMode.Update" />, but an entry is missing or corrupt and cannot be read.</span>
          </span>
          <span data-ttu-id="70b50-291">- 或 -  <paramref name="mode" /> 是 <see cref="F:System.IO.Compression.ZipArchiveMode.Update" />，但条目太大，无法装入内存。</span>
          <span class="sxs-lookup">
            <span data-stu-id="70b50-291">-or-  <paramref name="mode" /> is <see cref="F:System.IO.Compression.ZipArchiveMode.Update" />, but an entry is too large to fit into memory.</span>
          </span>
        </exception>
      </Docs>
    </Member>
    <Member MemberName="Open">
      <MemberSignature Language="C#" Value="public static System.IO.Compression.ZipArchive Open (string archiveFileName, System.IO.Compression.ZipArchiveMode mode, System.Text.Encoding entryNameEncoding);" />
      <MemberSignature Language="ILAsm" Value=".method public static hidebysig class System.IO.Compression.ZipArchive Open(string archiveFileName, valuetype System.IO.Compression.ZipArchiveMode mode, class System.Text.Encoding entryNameEncoding) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.IO.Compression.ZipFile.Open(System.String,System.IO.Compression.ZipArchiveMode,System.Text.Encoding)" />
      <MemberSignature Language="VB.NET" Value="Public Shared Function Open (archiveFileName As String, mode As ZipArchiveMode, entryNameEncoding As Encoding) As ZipArchive" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; static System::IO::Compression::ZipArchive ^ Open(System::String ^ archiveFileName, System::IO::Compression::ZipArchiveMode mode, System::Text::Encoding ^ entryNameEncoding);" />
      <MemberSignature Language="F#" Value="static member Open : string * System.IO.Compression.ZipArchiveMode * System.Text.Encoding -&gt; System.IO.Compression.ZipArchive" Usage="System.IO.Compression.ZipFile.Open (archiveFileName, mode, entryNameEncoding)" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.IO.Compression.ZipFile</AssemblyName>
        <AssemblyVersion>4.0.1.0</AssemblyVersion>
        <AssemblyVersion>4.0.3.0</AssemblyVersion>
        <AssemblyVersion>4.0.4.0</AssemblyVersion>
      </AssemblyInfo>
      <AssemblyInfo>
        <AssemblyName>System.IO.Compression.FileSystem</AssemblyName>
        <AssemblyVersion>2.0.5.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <AssemblyInfo>
        <AssemblyName>netstandard</AssemblyName>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.IO.Compression.ZipArchive</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="archiveFileName" Type="System.String" />
        <Parameter Name="mode" Type="System.IO.Compression.ZipArchiveMode" />
        <Parameter Name="entryNameEncoding" Type="System.Text.Encoding" />
      </Parameters>
      <Docs>
        <param name="archiveFileName">
          <span data-ttu-id="70b50-292">要打开的存档的路径，指定为相对路径或绝对路径。</span>
          <span class="sxs-lookup">
            <span data-stu-id="70b50-292">The path to the archive to open, specified as a relative or absolute path.</span>
          </span>
          <span data-ttu-id="70b50-293">相对路径是指相对于当前工作目录的路径。</span>
          <span class="sxs-lookup">
            <span data-stu-id="70b50-293">A relative path is interpreted as relative to the current working directory.</span>
          </span>
        </param>
        <param name="mode">
          <span data-ttu-id="70b50-294">指定允许对打开的存档中的项进行的操作的枚举值之一。</span>
          <span class="sxs-lookup">
            <span data-stu-id="70b50-294">One of the enumeration values that specifies the actions that are allowed on the entries in the opened archive.</span>
          </span>
        </param>
        <param name="entryNameEncoding">
          <span data-ttu-id="70b50-295">在存档中读取或写入项名时使用的编码。</span>
          <span class="sxs-lookup">
            <span data-stu-id="70b50-295">The encoding to use when reading or writing entry names in this archive.</span>
          </span>
          <span data-ttu-id="70b50-296">仅当需要针对具有不支持项名的 UTF-8 编码的 zip 归档工具和库的互操作性进行编码时，为此参数指定一个值。</span>
          <span class="sxs-lookup">
            <span data-stu-id="70b50-296">Specify a value for this parameter only when an encoding is required for interoperability with zip archive tools and libraries that do not support UTF-8 encoding for entry names.</span>
          </span>
        </param>
        <summary>
          <span data-ttu-id="70b50-297">在指定模式下，在指定路径中，使用项名称的指定字符编码打开 zip 存档。</span>
          <span class="sxs-lookup">
            <span data-stu-id="70b50-297">Opens a zip archive at the specified path, in the specified mode, and by using the specified character encoding for entry names.</span>
          </span>
        </summary>
        <returns>
          <span data-ttu-id="70b50-298">打开的 zip 存档。</span>
          <span class="sxs-lookup">
            <span data-stu-id="70b50-298">The opened zip archive.</span>
          </span>
        </returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="70b50-299">当你将设置`mode`参数<xref:System.IO.Compression.ZipArchiveMode.Read>，使用打开存档<xref:System.IO.FileMode.Open?displayProperty=nameWithType>作为文件模式值。</span><span class="sxs-lookup"><span data-stu-id="70b50-299">When you set the `mode` parameter to <xref:System.IO.Compression.ZipArchiveMode.Read>, the archive is opened with <xref:System.IO.FileMode.Open?displayProperty=nameWithType> as the file mode value.</span></span> <span data-ttu-id="70b50-300">如果存档不存在，<xref:System.IO.FileNotFoundException>引发异常。</span><span class="sxs-lookup"><span data-stu-id="70b50-300">If the archive does not exist, a <xref:System.IO.FileNotFoundException> exception is thrown.</span></span> <span data-ttu-id="70b50-301">设置`mode`参数<xref:System.IO.Compression.ZipArchiveMode.Read>等效于调用<xref:System.IO.Compression.ZipFile.OpenRead%2A>方法。</span><span class="sxs-lookup"><span data-stu-id="70b50-301">Setting the `mode` parameter to <xref:System.IO.Compression.ZipArchiveMode.Read> is equivalent to calling the <xref:System.IO.Compression.ZipFile.OpenRead%2A> method.</span></span>  
  
 <span data-ttu-id="70b50-302">当你将设置`mode`参数<xref:System.IO.Compression.ZipArchiveMode.Create>，使用打开存档<xref:System.IO.FileMode.CreateNew?displayProperty=nameWithType>作为文件模式值。</span><span class="sxs-lookup"><span data-stu-id="70b50-302">When you set the `mode` parameter to <xref:System.IO.Compression.ZipArchiveMode.Create>, the archive is opened with <xref:System.IO.FileMode.CreateNew?displayProperty=nameWithType> as the file mode value.</span></span> <span data-ttu-id="70b50-303">如果存档已存在，<xref:System.IO.IOException>引发。</span><span class="sxs-lookup"><span data-stu-id="70b50-303">If the archive already exists, an <xref:System.IO.IOException> is thrown.</span></span>  
  
 <span data-ttu-id="70b50-304">当你将设置`mode`参数<xref:System.IO.Compression.ZipArchiveMode.Update>，使用打开存档<xref:System.IO.FileMode.OpenOrCreate?displayProperty=nameWithType>作为文件模式值。</span><span class="sxs-lookup"><span data-stu-id="70b50-304">When you set the `mode` parameter to <xref:System.IO.Compression.ZipArchiveMode.Update>,  the archive is opened with <xref:System.IO.FileMode.OpenOrCreate?displayProperty=nameWithType> as the file mode value.</span></span> <span data-ttu-id="70b50-305">如果存在存档，它打开。</span><span class="sxs-lookup"><span data-stu-id="70b50-305">If the archive exists, it is opened.</span></span> <span data-ttu-id="70b50-306">可以修改现有条目，并可以创建新项。</span><span class="sxs-lookup"><span data-stu-id="70b50-306">The existing entries can be modified and new entries can be created.</span></span> <span data-ttu-id="70b50-307">如果存档不存在，则创建新存档;但是，创建在 zip 存档<xref:System.IO.Compression.ZipArchiveMode.Update>模式不是创建在尽可能高效<xref:System.IO.Compression.ZipArchiveMode.Create>模式。</span><span class="sxs-lookup"><span data-stu-id="70b50-307">If the archive does not exist, a new archive is created; however, creating a zip archive in <xref:System.IO.Compression.ZipArchiveMode.Update> mode is not as efficient as creating it in <xref:System.IO.Compression.ZipArchiveMode.Create> mode.</span></span>  
  
 <span data-ttu-id="70b50-308">当打开读取的 zip 存档文件和`entryNameEncoding`设置为`null`，条目名称解码根据下列规则：</span><span class="sxs-lookup"><span data-stu-id="70b50-308">When you open a zip archive file for reading and `entryNameEncoding` is set to `null`, entry names are decoded according to the following rules:</span></span>  
  
-   <span data-ttu-id="70b50-309">如果未设置编码标志 （在本地文件头的通用的位标志） 的语言，当前的系统默认代码页用于解码条目名称。</span><span class="sxs-lookup"><span data-stu-id="70b50-309">When the language encoding flag (in the general-purpose bit flag of the local file header) is not set, the current system default code page is used to decode the entry name.</span></span>  
  
-   <span data-ttu-id="70b50-310">设置语言编码标志后，utf-8 用于对条目名称解码。</span><span class="sxs-lookup"><span data-stu-id="70b50-310">When the language encoding flag is set, UTF-8 is used to decode the entry name.</span></span>  
  
 <span data-ttu-id="70b50-311">当打开读取的 zip 存档文件和`entryNameEncoding`设置一个值为非`null`，条目名称解码根据下列规则：</span><span class="sxs-lookup"><span data-stu-id="70b50-311">When you open a zip archive file for reading and `entryNameEncoding` is set to a value other than `null`, entry names are decoded according to the following rules:</span></span>  
  
-   <span data-ttu-id="70b50-312">编码标志的语言未设置时，指定`entryNameEncoding`用于解码条目名称。</span><span class="sxs-lookup"><span data-stu-id="70b50-312">When the language encoding flag is not set, the specified `entryNameEncoding` is used to decode the entry name.</span></span>  
  
-   <span data-ttu-id="70b50-313">设置语言编码标志后，utf-8 用于对条目名称解码。</span><span class="sxs-lookup"><span data-stu-id="70b50-313">When the language encoding flag is set, UTF-8 is used to decode the entry name.</span></span>  
  
 <span data-ttu-id="70b50-314">当你编写以将文件存档和`entryNameEncoding`设置为`null`，条目名称是根据以下规则进行编码：</span><span class="sxs-lookup"><span data-stu-id="70b50-314">When you write to archive files and `entryNameEncoding` is set to `null`, entry names are encoded according to the following rules:</span></span>  
  
-   <span data-ttu-id="70b50-315">包含 ASCII 范围外的字符的项名称，设置语言编码标志，并通过使用 utf-8 条目名称进行编码。</span><span class="sxs-lookup"><span data-stu-id="70b50-315">For entry names that contain characters outside the ASCII range, the language encoding flag is set, and entry names are encoded by using UTF-8.</span></span>  
  
-   <span data-ttu-id="70b50-316">仅包含 ASCII 字符的项名称，未设置语言编码标志，并通过使用当前的系统默认代码页的条目名称进行编码。</span><span class="sxs-lookup"><span data-stu-id="70b50-316">For entry names that contain only ASCII characters, the language encoding flag is not set, and entry names are encoded by using the current system default code page.</span></span>  
  
 <span data-ttu-id="70b50-317">当你编写以将文件存档和`entryNameEncoding`设置一个值为非`null`，指定`entryNameEncoding`用于转换为字节编码条目名称。</span><span class="sxs-lookup"><span data-stu-id="70b50-317">When you write to archive files and `entryNameEncoding` is set to a value other than `null`, the specified `entryNameEncoding` is used to encode the entry names into bytes.</span></span> <span data-ttu-id="70b50-318">仅当指定的编码为 utf-8 编码时设置编码标志 （在本地文件头的通用的位标志） 的语言。</span><span class="sxs-lookup"><span data-stu-id="70b50-318">The language encoding flag (in the general-purpose bit flag of the local file header) is set only when the specified encoding is a UTF-8 encoding.</span></span>  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentException">
          <span data-ttu-id="70b50-319">
            <paramref name="archiveFileName" /> 为 <see cref="F:System.String.Empty" />，仅包含空格，或者包含至少一个无效字符。</span>
          <span class="sxs-lookup">
            <span data-stu-id="70b50-319">
              <paramref name="archiveFileName" /> is <see cref="F:System.String.Empty" />, contains only white space, or contains at least one invalid character.</span>
          </span>
          <span data-ttu-id="70b50-320">- 或 -  <paramref name="entryNameEncoding" /> 设置为不同于 UTF-8 的 Unicode 编码。</span>
          <span class="sxs-lookup">
            <span data-stu-id="70b50-320">-or-  <paramref name="entryNameEncoding" /> is set to a Unicode encoding other than UTF-8.</span>
          </span>
        </exception>
        <exception cref="T:System.ArgumentNullException">
          <span data-ttu-id="70b50-321">
            <paramref name="archiveFileName" /> 为 <see langword="null" />。</span>
          <span class="sxs-lookup">
            <span data-stu-id="70b50-321">
              <paramref name="archiveFileName" /> is <see langword="null" />.</span>
          </span>
        </exception>
        <exception cref="T:System.IO.PathTooLongException">
          <span data-ttu-id="70b50-322">在 <paramref name="archiveFileName" /> 内，指定的路径、文件名或者两者都超出了系统定义的最大长度。</span>
          <span class="sxs-lookup">
            <span data-stu-id="70b50-322">In <paramref name="archiveFileName" />, the specified path, file name, or both exceed the system-defined maximum length.</span>
          </span>
        </exception>
        <exception cref="T:System.IO.DirectoryNotFoundException">
          <span data-ttu-id="70b50-323">
            <paramref name="archiveFileName" /> 无效或不存在（例如，在未映射的驱动器上）。</span>
          <span class="sxs-lookup">
            <span data-stu-id="70b50-323">
              <paramref name="archiveFileName" /> is invalid or does not exist (for example, it is on an unmapped drive).</span>
          </span>
        </exception>
        <exception cref="T:System.IO.IOException">
          <span data-ttu-id="70b50-324">未能打开 <paramref name="archiveFileName" />。</span>
          <span class="sxs-lookup">
            <span data-stu-id="70b50-324">
              <paramref name="archiveFileName" /> could not be opened.</span>
          </span>
          <span data-ttu-id="70b50-325">- 或 -  <paramref name="mode" /> 设置为 <see cref="F:System.IO.Compression.ZipArchiveMode.Create" />，但在 <paramref name="archiveFileName" /> 中指定的文件已存在。</span>
          <span class="sxs-lookup">
            <span data-stu-id="70b50-325">-or-  <paramref name="mode" /> is set to <see cref="F:System.IO.Compression.ZipArchiveMode.Create" />, but the file specified in <paramref name="archiveFileName" /> already exists.</span>
          </span>
        </exception>
        <exception cref="T:System.UnauthorizedAccessException">
          <span data-ttu-id="70b50-326">
            <paramref name="archiveFileName" /> 指定目录。</span>
          <span class="sxs-lookup">
            <span data-stu-id="70b50-326">
              <paramref name="archiveFileName" /> specifies a directory.</span>
          </span>
          <span data-ttu-id="70b50-327">- 或 -  调用方没有访问在 <paramref name="archiveFileName" /> 中指定的文件的所需权限。</span>
          <span class="sxs-lookup">
            <span data-stu-id="70b50-327">-or-  The caller does not have the required permission to access the file specified in <paramref name="archiveFileName" />.</span>
          </span>
        </exception>
        <exception cref="T:System.ArgumentOutOfRangeException">
          <span data-ttu-id="70b50-328">
            <paramref name="mode" /> 指定了一个无效值。</span>
          <span class="sxs-lookup">
            <span data-stu-id="70b50-328">
              <paramref name="mode" /> specifies an invalid value.</span>
          </span>
        </exception>
        <exception cref="T:System.IO.FileNotFoundException">
          <span data-ttu-id="70b50-329">
            <paramref name="mode" /> 设置为 <see cref="F:System.IO.Compression.ZipArchiveMode.Read" />，但在 <paramref name="archiveFileName" /> 中指定的文件未找到。</span>
          <span class="sxs-lookup">
            <span data-stu-id="70b50-329">
              <paramref name="mode" /> is set to <see cref="F:System.IO.Compression.ZipArchiveMode.Read" />, but the file specified in <paramref name="archiveFileName" /> is not found.</span>
          </span>
        </exception>
        <exception cref="T:System.NotSupportedException">
          <span data-ttu-id="70b50-330">
            <paramref name="archiveFileName" /> 包含无效的格式。</span>
          <span class="sxs-lookup">
            <span data-stu-id="70b50-330">
              <paramref name="archiveFileName" /> contains an invalid format.</span>
          </span>
        </exception>
        <exception cref="T:System.IO.InvalidDataException">
          <span data-ttu-id="70b50-331">
            <paramref name="archiveFileName" /> 无法解释为 zip 存档文件。</span>
          <span class="sxs-lookup">
            <span data-stu-id="70b50-331">
              <paramref name="archiveFileName" /> could not be interpreted as a zip archive.</span>
          </span>
          <span data-ttu-id="70b50-332">- 或 -  <paramref name="mode" /> 是 <see cref="F:System.IO.Compression.ZipArchiveMode.Update" />，但条目已丢失或已损坏，因此无法读取。</span>
          <span class="sxs-lookup">
            <span data-stu-id="70b50-332">-or-  <paramref name="mode" /> is <see cref="F:System.IO.Compression.ZipArchiveMode.Update" />, but an entry is missing or corrupt and cannot be read.</span>
          </span>
          <span data-ttu-id="70b50-333">- 或 -  <paramref name="mode" /> 是 <see cref="F:System.IO.Compression.ZipArchiveMode.Update" />，但条目太大，无法装入内存。</span>
          <span class="sxs-lookup">
            <span data-stu-id="70b50-333">-or-  <paramref name="mode" /> is <see cref="F:System.IO.Compression.ZipArchiveMode.Update" />, but an entry is too large to fit into memory.</span>
          </span>
        </exception>
      </Docs>
    </Member>
    <Member MemberName="OpenRead">
      <MemberSignature Language="C#" Value="public static System.IO.Compression.ZipArchive OpenRead (string archiveFileName);" />
      <MemberSignature Language="ILAsm" Value=".method public static hidebysig class System.IO.Compression.ZipArchive OpenRead(string archiveFileName) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.IO.Compression.ZipFile.OpenRead(System.String)" />
      <MemberSignature Language="VB.NET" Value="Public Shared Function OpenRead (archiveFileName As String) As ZipArchive" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; static System::IO::Compression::ZipArchive ^ OpenRead(System::String ^ archiveFileName);" />
      <MemberSignature Language="F#" Value="static member OpenRead : string -&gt; System.IO.Compression.ZipArchive" Usage="System.IO.Compression.ZipFile.OpenRead archiveFileName" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.IO.Compression.ZipFile</AssemblyName>
        <AssemblyVersion>4.0.1.0</AssemblyVersion>
        <AssemblyVersion>4.0.3.0</AssemblyVersion>
        <AssemblyVersion>4.0.4.0</AssemblyVersion>
      </AssemblyInfo>
      <AssemblyInfo>
        <AssemblyName>System.IO.Compression.FileSystem</AssemblyName>
        <AssemblyVersion>2.0.5.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <AssemblyInfo>
        <AssemblyName>netstandard</AssemblyName>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.IO.Compression.ZipArchive</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="archiveFileName" Type="System.String" />
      </Parameters>
      <Docs>
        <param name="archiveFileName">
          <span data-ttu-id="70b50-334">要打开的存档的路径，指定为相对路径或绝对路径。</span>
          <span class="sxs-lookup">
            <span data-stu-id="70b50-334">The path to the archive to open, specified as a relative or absolute path.</span>
          </span>
          <span data-ttu-id="70b50-335">相对路径是指相对于当前工作目录的路径。</span>
          <span class="sxs-lookup">
            <span data-stu-id="70b50-335">A relative path is interpreted as relative to the current working directory.</span>
          </span>
        </param>
        <summary>
          <span data-ttu-id="70b50-336">打开在指定路径用于读取的 zip 存档。</span>
          <span class="sxs-lookup">
            <span data-stu-id="70b50-336">Opens a zip archive for reading at the specified path.</span>
          </span>
        </summary>
        <returns>
          <span data-ttu-id="70b50-337">打开的 zip 存档。</span>
          <span class="sxs-lookup">
            <span data-stu-id="70b50-337">The opened zip archive.</span>
          </span>
        </returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="70b50-338">此方法等效于调用<xref:System.IO.Compression.ZipFile.Open%2A>方法和设置`mode`参数<xref:System.IO.Compression.ZipArchiveMode.Read>。</span><span class="sxs-lookup"><span data-stu-id="70b50-338">This method is equivalent to calling the <xref:System.IO.Compression.ZipFile.Open%2A> method and setting the `mode` parameter to <xref:System.IO.Compression.ZipArchiveMode.Read>.</span></span> <span data-ttu-id="70b50-339">使用打开存档<xref:System.IO.FileMode.Open?displayProperty=nameWithType>作为文件模式值。</span><span class="sxs-lookup"><span data-stu-id="70b50-339">The archive is opened with <xref:System.IO.FileMode.Open?displayProperty=nameWithType> as the file mode value.</span></span> <span data-ttu-id="70b50-340">如果存档不存在，<xref:System.IO.FileNotFoundException>引发异常。</span><span class="sxs-lookup"><span data-stu-id="70b50-340">If the archive does not exist, a <xref:System.IO.FileNotFoundException> exception is thrown.</span></span>  
  
   
  
## Examples  
 <span data-ttu-id="70b50-341">下面的示例演示如何打开用于读取的 zip 存档。</span><span class="sxs-lookup"><span data-stu-id="70b50-341">The following example shows how to open a zip archive for reading.</span></span>  
  
 [!code-csharp[System.IO.Compression.ZipArchive#1](~/samples/snippets/csharp/VS_Snippets_CLR_System/system.io.compression.ziparchive/cs/program1.cs#1)]
 [!code-vb[System.IO.Compression.ZipArchive#1](~/samples/snippets/visualbasic/VS_Snippets_CLR_System/system.io.compression.ziparchive/vb/program1.vb#1)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentException">
          <span data-ttu-id="70b50-342">
            <paramref name="archiveFileName" /> 为 <see cref="F:System.String.Empty" />，仅包含空格，或者包含至少一个无效字符。</span>
          <span class="sxs-lookup">
            <span data-stu-id="70b50-342">
              <paramref name="archiveFileName" /> is <see cref="F:System.String.Empty" />, contains only white space, or contains at least one invalid character.</span>
          </span>
        </exception>
        <exception cref="T:System.ArgumentNullException">
          <span data-ttu-id="70b50-343">
            <paramref name="archiveFileName" /> 为 <see langword="null" />。</span>
          <span class="sxs-lookup">
            <span data-stu-id="70b50-343">
              <paramref name="archiveFileName" /> is <see langword="null" />.</span>
          </span>
        </exception>
        <exception cref="T:System.IO.PathTooLongException">
          <span data-ttu-id="70b50-344">在 <paramref name="archiveFileName" /> 内，指定的路径、文件名或者两者都超出了系统定义的最大长度。</span>
          <span class="sxs-lookup">
            <span data-stu-id="70b50-344">In <paramref name="archiveFileName" />, the specified path, file name, or both exceed the system-defined maximum length.</span>
          </span>
        </exception>
        <exception cref="T:System.IO.DirectoryNotFoundException">
          <span data-ttu-id="70b50-345">
            <paramref name="archiveFileName" /> 无效或不存在（例如，在未映射的驱动器上）。</span>
          <span class="sxs-lookup">
            <span data-stu-id="70b50-345">
              <paramref name="archiveFileName" /> is invalid or does not exist (for example, it is on an unmapped drive).</span>
          </span>
        </exception>
        <exception cref="T:System.IO.IOException">
          <span data-ttu-id="70b50-346">未能打开 <paramref name="archiveFileName" />。</span>
          <span class="sxs-lookup">
            <span data-stu-id="70b50-346">
              <paramref name="archiveFileName" /> could not be opened.</span>
          </span>
        </exception>
        <exception cref="T:System.UnauthorizedAccessException">
          <span data-ttu-id="70b50-347">
            <paramref name="archiveFileName" /> 指定目录。</span>
          <span class="sxs-lookup">
            <span data-stu-id="70b50-347">
              <paramref name="archiveFileName" /> specifies a directory.</span>
          </span>
          <span data-ttu-id="70b50-348">- 或 -  调用方没有访问在 <paramref name="archiveFileName" /> 中指定的文件的所需权限。</span>
          <span class="sxs-lookup">
            <span data-stu-id="70b50-348">-or-  The caller does not have the required permission to access the file specified in <paramref name="archiveFileName" />.</span>
          </span>
        </exception>
        <exception cref="T:System.IO.FileNotFoundException">
          <span data-ttu-id="70b50-349">未找到 <paramref name="archiveFileName" /> 中指定的文件。</span>
          <span class="sxs-lookup">
            <span data-stu-id="70b50-349">The file specified in <paramref name="archiveFileName" /> is not found.</span>
          </span>
        </exception>
        <exception cref="T:System.NotSupportedException">
          <span data-ttu-id="70b50-350">
            <paramref name="archiveFileName" /> 包含无效的格式。</span>
          <span class="sxs-lookup">
            <span data-stu-id="70b50-350">
              <paramref name="archiveFileName" /> contains an invalid format.</span>
          </span>
        </exception>
        <exception cref="T:System.IO.InvalidDataException">
          <span data-ttu-id="70b50-351">
            <paramref name="archiveFileName" /> 无法解释为 zip 存档文件。</span>
          <span class="sxs-lookup">
            <span data-stu-id="70b50-351">
              <paramref name="archiveFileName" /> could not be interpreted as a zip archive.</span>
          </span>
        </exception>
      </Docs>
    </Member>
  </Members>
</Type>