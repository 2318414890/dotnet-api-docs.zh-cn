<Type Name="EventLog" FullName="System.Diagnostics.EventLog">
  <Metadata>
    <Meta Name="ms.openlocfilehash" Value="c7b0720d24124f7818c7801c79354a1bfa733467" />
    <Meta Name="ms.sourcegitcommit" Value="434f60616a9793fa8436744549fc856e94f7a648" />
    <Meta Name="ms.translationtype" Value="HT" />
    <Meta Name="ms.contentlocale" Value="zh-CN" />
    <Meta Name="ms.lasthandoff" Value="08/25/2018" />
    <Meta Name="ms.locfileid" Value="39888441" />
  </Metadata>
  <TypeSignature Language="C#" Value="public class EventLog : System.ComponentModel.Component, System.ComponentModel.ISupportInitialize" />
  <TypeSignature Language="ILAsm" Value=".class public auto ansi beforefieldinit EventLog extends System.ComponentModel.Component implements class System.ComponentModel.ISupportInitialize" />
  <TypeSignature Language="DocId" Value="T:System.Diagnostics.EventLog" />
  <TypeSignature Language="VB.NET" Value="Public Class EventLog&#xA;Inherits Component&#xA;Implements ISupportInitialize" />
  <TypeSignature Language="C++ CLI" Value="public ref class EventLog : System::ComponentModel::Component, System::ComponentModel::ISupportInitialize" />
  <TypeSignature Language="F#" Value="type EventLog = class&#xA;    inherit Component&#xA;    interface ISupportInitialize" />
  <AssemblyInfo>
    <AssemblyName>System</AssemblyName>
    <AssemblyVersion>1.0.5000.0</AssemblyVersion>
    <AssemblyVersion>2.0.0.0</AssemblyVersion>
    <AssemblyVersion>4.0.0.0</AssemblyVersion>
  </AssemblyInfo>
  <Base>
    <BaseTypeName>System.ComponentModel.Component</BaseTypeName>
  </Base>
  <Interfaces>
    <Interface>
      <InterfaceName>System.ComponentModel.ISupportInitialize</InterfaceName>
    </Interface>
  </Interfaces>
  <Attributes>
    <Attribute FrameworkAlternate="netframework-1.1;netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;xamarinmac-3.0">
      <AttributeName>System.ComponentModel.DefaultEvent("EntryWritten")</AttributeName>
    </Attribute>
    <Attribute FrameworkAlternate="xamarinmac-3.0">
      <AttributeName>System.ComponentModel.InstallerType(typeof(System.Diagnostics.EventLogInstaller))</AttributeName>
    </Attribute>
    <Attribute FrameworkAlternate="xamarinmac-3.0">
      <AttributeName>System.Diagnostics.MonitoringDescription("Represents an event log")</AttributeName>
    </Attribute>
    <Attribute FrameworkAlternate="netframework-1.1">
      <AttributeName>System.ComponentModel.Designer("Microsoft.VisualStudio.Install.EventLogInstallableComponentDesigner, Microsoft.VisualStudio, Version=1.0.5000.0, Culture=neutral, PublicKeyToken=b03f5f7f11d50a3a")</AttributeName>
    </Attribute>
    <Attribute FrameworkAlternate="netframework-1.1">
      <AttributeName>System.ComponentModel.InstallerType("System.Diagnostics.EventLogInstaller, System.Configuration.Install, Version=1.0.5000.0, Culture=neutral, PublicKeyToken=b03f5f7f11d50a3a")</AttributeName>
    </Attribute>
    <Attribute FrameworkAlternate="netframework-2.0;netframework-3.0;netframework-3.5">
      <AttributeName>System.ComponentModel.InstallerType("System.Diagnostics.EventLogInstaller, System.Configuration.Install, Version=2.0.0.0, Culture=neutral, PublicKeyToken=b03f5f7f11d50a3a")</AttributeName>
    </Attribute>
    <Attribute FrameworkAlternate="netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2">
      <AttributeName>System.Diagnostics.MonitoringDescription("EventLogDesc")</AttributeName>
    </Attribute>
    <Attribute FrameworkAlternate="netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2">
      <AttributeName>System.ComponentModel.InstallerType("System.Diagnostics.EventLogInstaller, System.Configuration.Install, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b03f5f7f11d50a3a")</AttributeName>
    </Attribute>
  </Attributes>
  <Docs>
    <summary>
      <span data-ttu-id="db667-101">提供与 Windows 事件日志的交互。</span>
      <span class="sxs-lookup">
        <span data-stu-id="db667-101">Provides interaction with Windows event logs.</span>
      </span>
    </summary>
    <remarks>
      <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="db667-102"><xref:System.Diagnostics.EventLog> 可访问或自定义 Windows 事件日志，记录有关软件或硬件的重要事件的信息。</span><span class="sxs-lookup"><span data-stu-id="db667-102"><xref:System.Diagnostics.EventLog> lets you access or customize Windows event logs, which record information about important software or hardware events.</span></span> <span data-ttu-id="db667-103">使用<xref:System.Diagnostics.EventLog>，可以从现有的日志读取、 写入日志条目、 创建或删除事件源，删除日志，和响应的日志条目。</span><span class="sxs-lookup"><span data-stu-id="db667-103">Using <xref:System.Diagnostics.EventLog>, you can read from existing logs, write entries to logs, create or delete event sources, delete logs, and respond to log entries.</span></span> <span data-ttu-id="db667-104">创建事件源时，还可以创建新的日志。</span><span class="sxs-lookup"><span data-stu-id="db667-104">You can also create new logs when creating an event source.</span></span>  
  
> [!IMPORTANT]
>  <span data-ttu-id="db667-105">此类型实现<xref:System.IDisposable>接口。</span><span class="sxs-lookup"><span data-stu-id="db667-105">This type implements the <xref:System.IDisposable> interface.</span></span> <span data-ttu-id="db667-106">在使用完类型后，您应直接或间接释放类型。</span><span class="sxs-lookup"><span data-stu-id="db667-106">When you have finished using the type, you should dispose of it either directly or indirectly.</span></span> <span data-ttu-id="db667-107">若要直接释放类型，调用其<xref:System.IDisposable.Dispose%2A>中的方法`try` / `catch`块。</span><span class="sxs-lookup"><span data-stu-id="db667-107">To dispose of the type directly, call its <xref:System.IDisposable.Dispose%2A> method in a `try`/`catch` block.</span></span> <span data-ttu-id="db667-108">若要间接释放类型，请使用 `using`（在 C# 中）或 `Using`（在 Visual Basic 中）等语言构造。</span><span class="sxs-lookup"><span data-stu-id="db667-108">To dispose of it indirectly, use a language construct such as `using` (in C#) or `Using` (in Visual Basic).</span></span> <span data-ttu-id="db667-109">有关详细信息，请参阅中的"使用对象实现 IDisposable"一节<xref:System.IDisposable>接口主题。</span><span class="sxs-lookup"><span data-stu-id="db667-109">For more information, see the "Using an Object that Implements IDisposable" section in the <xref:System.IDisposable> interface topic.</span></span>  
  
 <span data-ttu-id="db667-110">除了提供对单个事件日志和它们的项，访问<xref:System.Diagnostics.EventLog>类允许您访问所有事件日志的集合。</span><span class="sxs-lookup"><span data-stu-id="db667-110">In addition to providing access to individual event logs and their entries, the <xref:System.Diagnostics.EventLog> class lets you access the collection of all event logs.</span></span> <span data-ttu-id="db667-111">可以使用`static`的成员<xref:System.Diagnostics.EventLog>若要删除日志，获取日志列表、 创建或删除源，或确定计算机是否已包含一个特定的源。</span><span class="sxs-lookup"><span data-stu-id="db667-111">You can use the `static` members of <xref:System.Diagnostics.EventLog> to delete logs, get log lists, create or delete a source, or determine if a computer already contains a particular source.</span></span>  
  
 <span data-ttu-id="db667-112">有三个默认事件日志： 应用程序、 系统和安全。</span><span class="sxs-lookup"><span data-stu-id="db667-112">There are three default event logs: Application, System, and Security.</span></span> <span data-ttu-id="db667-113">安全日志是只读的。</span><span class="sxs-lookup"><span data-stu-id="db667-113">A Security log is read-only.</span></span> <span data-ttu-id="db667-114">其他应用程序和服务安装，如 Active Directory，可能有其他事件日志。</span><span class="sxs-lookup"><span data-stu-id="db667-114">Other applications and services you install, such as Active Directory, might have additional event logs.</span></span>  
  
 <span data-ttu-id="db667-115">使用的安全注意事项<xref:System.Diagnostics.EventLog>类。</span><span class="sxs-lookup"><span data-stu-id="db667-115">There are security considerations when using the <xref:System.Diagnostics.EventLog> class.</span></span> <span data-ttu-id="db667-116"><xref:System.Diagnostics.EventLog> 需要<xref:System.Diagnostics.EventLogPermission>的.NET Framework 2.0 和更高版本中的特定操作或.NET Framework 1.0 和 1.1 中的完全信任权限。</span><span class="sxs-lookup"><span data-stu-id="db667-116"><xref:System.Diagnostics.EventLog> requires <xref:System.Diagnostics.EventLogPermission> permissions for specific actions in the .NET Framework 2.0 and later versions, or full trust in the .NET Framework 1.0 and 1.1.</span></span> <span data-ttu-id="db667-117">我们建议，<xref:System.Diagnostics.EventLogPermission>不授予给部分受信任的代码。</span><span class="sxs-lookup"><span data-stu-id="db667-117">We recommend that <xref:System.Diagnostics.EventLogPermission> not be granted to partially trusted code.</span></span>  <span data-ttu-id="db667-118">应永远不会传递事件日志的任何对象，包括<xref:System.Diagnostics.EventLogEntryCollection>和<xref:System.Diagnostics.EventLogEntry>对象，不太受信任的代码。</span><span class="sxs-lookup"><span data-stu-id="db667-118">You should never pass any event log object, including <xref:System.Diagnostics.EventLogEntryCollection> and <xref:System.Diagnostics.EventLogEntry> objects, to less trusted code.</span></span> <span data-ttu-id="db667-119">例如，创建<xref:System.Diagnostics.EventLog>对象，写入条目，并将传递<xref:System.Diagnostics.EventLog>对象与部分受信任代码可以创建安全问题，因为能够读取和写入事件日志允许代码执行操作，例如颁发另一个应用程序的名称的事件日志消息。</span><span class="sxs-lookup"><span data-stu-id="db667-119">For example, creating an <xref:System.Diagnostics.EventLog> object, writing an entry, and then passing the <xref:System.Diagnostics.EventLog> object to partially trusted code can create a security issue, because the ability to read and write to the event log allows code to perform actions such as issuing event log messages in the name of another application.</span></span>  
  
 <span data-ttu-id="db667-120">从 Windows Vista 开始，用户帐户控制 (UAC) 确定的用户的凭据。</span><span class="sxs-lookup"><span data-stu-id="db667-120">Starting with Windows Vista, User Account Control (UAC) determines the credentials of a user.</span></span> <span data-ttu-id="db667-121">如果您是内置的 Administrators 组的成员，将为您分配两个运行时访问令牌：一个标准用户访问令牌和一个管理员访问令牌。</span><span class="sxs-lookup"><span data-stu-id="db667-121">If you are a member of the Built-in Administrators group, you are assigned two run-time access tokens: a standard user access token and an administrator access token.</span></span> <span data-ttu-id="db667-122">默认情况下，您拥有标准用户角色。</span><span class="sxs-lookup"><span data-stu-id="db667-122">By default, you are in the standard user role.</span></span> <span data-ttu-id="db667-123">若要运行的代码访问安全日志，首先必须将你的凭据从标准用户提升至管理员。</span><span class="sxs-lookup"><span data-stu-id="db667-123">To run the code that accesses the Security log, you must first elevate your credentials from standard user to administrator.</span></span> <span data-ttu-id="db667-124">通过打开该应用程序的快捷菜单中启动应用程序时可以执行此操作 （如果您使用鼠标，右键单击应用程序图标） 并指示你想要以管理员身份运行。</span><span class="sxs-lookup"><span data-stu-id="db667-124">You can do this when you start an application by opening the shortcut menu for the application (if you're using a mouse, right-click the application icon) and indicating that you want to run as an administrator.</span></span>  
  
 <span data-ttu-id="db667-125">可以使用<xref:System.Diagnostics.EventLog>若要创建自定义事件日志，您可以通过服务器的事件查看器。</span><span class="sxs-lookup"><span data-stu-id="db667-125">You can use <xref:System.Diagnostics.EventLog> to create custom event logs that you can view through the server's Event Viewer.</span></span> <span data-ttu-id="db667-126">使用<xref:System.Diagnostics.EventLog.RegisterDisplayName%2A>方法，以便在事件查看器中显示的事件日志的本地化的名称。</span><span class="sxs-lookup"><span data-stu-id="db667-126">Use the <xref:System.Diagnostics.EventLog.RegisterDisplayName%2A> method to display a localized name for your event log in the Event Viewer.</span></span> <span data-ttu-id="db667-127">使用<xref:System.Diagnostics.EventLog.ModifyOverflowPolicy%2A>方法时它达到其最大日志大小配置行为的事件日志。</span><span class="sxs-lookup"><span data-stu-id="db667-127">Use the <xref:System.Diagnostics.EventLog.ModifyOverflowPolicy%2A> method to configure the behavior of your event log when it reaches its maximum log size.</span></span>  
  
 <span data-ttu-id="db667-128">若要从事件日志中读取，指定日志名称 (<xref:System.Diagnostics.EventLog.Log%2A>属性) 和服务器计算机名称 (<xref:System.Diagnostics.EventLog.MachineName%2A>事件日志的属性。</span><span class="sxs-lookup"><span data-stu-id="db667-128">To read from an event log, specify the log name (<xref:System.Diagnostics.EventLog.Log%2A> property) and server computer name (<xref:System.Diagnostics.EventLog.MachineName%2A> property for the event log.</span></span> <span data-ttu-id="db667-129">如果未指定服务器的计算机名，本地计算机"。"，则假定。</span><span class="sxs-lookup"><span data-stu-id="db667-129">If you don't specify the server computer name, the local computer, ".", is assumed.</span></span> <span data-ttu-id="db667-130">不需要指定事件源 (<xref:System.Diagnostics.EventLog.Source%2A>属性)，因为源是仅需要写入日志。</span><span class="sxs-lookup"><span data-stu-id="db667-130">It's not necessary to specify the event source (<xref:System.Diagnostics.EventLog.Source%2A> property), because a source is required only for writing to logs.</span></span> <span data-ttu-id="db667-131"><xref:System.Diagnostics.EventLog.Entries%2A>属性会自动填充的条目的事件日志的列表。</span><span class="sxs-lookup"><span data-stu-id="db667-131">The  <xref:System.Diagnostics.EventLog.Entries%2A> property is automatically populated with the event log's list of entries.</span></span>  
  
 <span data-ttu-id="db667-132">若要写入事件日志，请指定或创建事件源 (<xref:System.Diagnostics.EventLog.Source%2A>属性)。</span><span class="sxs-lookup"><span data-stu-id="db667-132">To write to an event log, specify or create an event source (<xref:System.Diagnostics.EventLog.Source%2A> property).</span></span> <span data-ttu-id="db667-133">若要创建新的事件源的计算机上，必须具有管理凭据。</span><span class="sxs-lookup"><span data-stu-id="db667-133">You must have administrative credentials on the computer to create a new event source.</span></span> <span data-ttu-id="db667-134">事件源将注册你的应用程序与事件日志的有效源的条目。</span><span class="sxs-lookup"><span data-stu-id="db667-134">The event source registers your application with the event log as a valid source of entries.</span></span> <span data-ttu-id="db667-135">可以使用事件源写入一次只有一个日志。</span><span class="sxs-lookup"><span data-stu-id="db667-135">You can use the event source  to write to only one log at a time.</span></span> <span data-ttu-id="db667-136"><xref:System.Diagnostics.EventLog.Source%2A>属性可以是任何随机字符串，但该名称必须不同于计算机上的其他源。</span><span class="sxs-lookup"><span data-stu-id="db667-136">The <xref:System.Diagnostics.EventLog.Source%2A> property can be any random string, but the name must be distinct from other sources on the computer.</span></span> <span data-ttu-id="db667-137">事件源通常是应用程序或另一个标识字符串的名称。</span><span class="sxs-lookup"><span data-stu-id="db667-137">The event source is typically the name of the application or another identifying string.</span></span> <span data-ttu-id="db667-138">尝试创建重复<xref:System.Diagnostics.EventLog.Source%2A>值将引发异常。</span><span class="sxs-lookup"><span data-stu-id="db667-138">Trying to create a duplicate <xref:System.Diagnostics.EventLog.Source%2A> value throws an exception.</span></span> <span data-ttu-id="db667-139">但是，单个事件日志可以与多个源相关联。</span><span class="sxs-lookup"><span data-stu-id="db667-139">However, a single event log can be associated with multiple sources.</span></span>  
  
 <span data-ttu-id="db667-140">如果与关联事件日志的事件源<xref:System.Diagnostics.EventLog>实例不存在，则创建新的事件源。</span><span class="sxs-lookup"><span data-stu-id="db667-140">If the event source for the event log associated with the <xref:System.Diagnostics.EventLog> instance doesn't exist, a new event source is created.</span></span> <span data-ttu-id="db667-141">若要创建的事件源在 Windows Vista 及更高版本或 Windows Server 2003，必须具有管理凭据。</span><span class="sxs-lookup"><span data-stu-id="db667-141">To create an event source in Windows Vista and later or Windows Server 2003, you must have administrative credentials.</span></span>  
  
 <span data-ttu-id="db667-142">此要求是因为必须搜索所有事件日志，包括安全日志，以确定事件源是否唯一。</span><span class="sxs-lookup"><span data-stu-id="db667-142">This requirement is because all event logs, including Security logs, must be searched to determine whether the event source is unique.</span></span> <span data-ttu-id="db667-143">从 Windows Vista 开始，用户没有权限访问该安全日志。因此，<xref:System.Security.SecurityException>引发。</span><span class="sxs-lookup"><span data-stu-id="db667-143">Starting with Windows Vista, users do not have permission to access the Security log; therefore, a <xref:System.Security.SecurityException> is thrown.</span></span>  
  
> [!IMPORTANT]
>  <span data-ttu-id="db667-144">创建或删除事件源需要使用已命名的互斥体的基础代码的同步。</span><span class="sxs-lookup"><span data-stu-id="db667-144">Creating or deleting an event source requires synchronization of the underlying code by using a named mutex.</span></span> <span data-ttu-id="db667-145">如果高特权的应用程序锁定已命名的 mutex，尝试创建或删除事件源会导致应用程序停止响应，直到锁被释放。</span><span class="sxs-lookup"><span data-stu-id="db667-145">If a highly privileged application locks the named mutex, trying to create or delete an event source causes the application to stop responding until the lock is released.</span></span> <span data-ttu-id="db667-146">若要帮助防止出现此问题，永远不会授予<xref:System.Security.Permissions.SecurityPermissionFlag.UnmanagedCode>到不受信任代码的权限。</span><span class="sxs-lookup"><span data-stu-id="db667-146">To help prevent this problem, never grant <xref:System.Security.Permissions.SecurityPermissionFlag.UnmanagedCode> permission to untrusted code.</span></span> <span data-ttu-id="db667-147">此外，<xref:System.Security.Permissions.SecurityPermissionFlag.UnmanagedCode>权限可能允许绕过其他权限，并仅应授予高度受信任的代码。</span><span class="sxs-lookup"><span data-stu-id="db667-147">In addition, <xref:System.Security.Permissions.SecurityPermissionFlag.UnmanagedCode> permission potentially allows other permissions to be bypassed and should only be granted to highly trusted code.</span></span>  
  
 <span data-ttu-id="db667-148">应用程序和服务应编写应用程序日志或自定义日志。</span><span class="sxs-lookup"><span data-stu-id="db667-148">Applications and services should write to the Application log or to a custom log.</span></span> <span data-ttu-id="db667-149">设备驱动程序应该写入系统日志。</span><span class="sxs-lookup"><span data-stu-id="db667-149">Device drivers should write to the System log.</span></span> <span data-ttu-id="db667-150">如果未显式设置<xref:System.Diagnostics.EventLog.Log%2A>属性，默认为应用程序日志的事件日志。</span><span class="sxs-lookup"><span data-stu-id="db667-150">If you do not explicitly set the <xref:System.Diagnostics.EventLog.Log%2A> property, the event log defaults to the Application log.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="db667-151">没有要保护应用程序免受编写为任何已注册的源内容。</span><span class="sxs-lookup"><span data-stu-id="db667-151">There is nothing to protect an application from writing as any registered source.</span></span>  <span data-ttu-id="db667-152">如果应用程序授予<xref:System.Diagnostics.EventLogPermissionAccess.Write>权限，它可以写入事件的任何有效的源计算机上注册。</span><span class="sxs-lookup"><span data-stu-id="db667-152">If an application is granted <xref:System.Diagnostics.EventLogPermissionAccess.Write> permission, it can write events for any valid source registered on the computer.</span></span>  
  
 <span data-ttu-id="db667-153">使用<xref:System.Diagnostics.EventLog.WriteEvent%2A>和<xref:System.Diagnostics.EventLog.WriteEntry%2A>方法将事件写入到事件日志。</span><span class="sxs-lookup"><span data-stu-id="db667-153">Use the <xref:System.Diagnostics.EventLog.WriteEvent%2A> and <xref:System.Diagnostics.EventLog.WriteEntry%2A> methods to write events to an event log.</span></span> <span data-ttu-id="db667-154">必须指定事件源写入事件;必须创建并写入与源的第一项之前配置的事件源。</span><span class="sxs-lookup"><span data-stu-id="db667-154">You must specify an event source to write events; you must create and configure the event source before writing the first entry with the source.</span></span>  
  
 <span data-ttu-id="db667-155">在应用程序的安装过程中创建新的事件源。</span><span class="sxs-lookup"><span data-stu-id="db667-155">Create the new event source during the installation of your application.</span></span> <span data-ttu-id="db667-156">这允许操作系统以刷新其注册的事件源的列表和其配置的时间。</span><span class="sxs-lookup"><span data-stu-id="db667-156">This allows time for the operating system to refresh its list of registered event sources and their configuration.</span></span> <span data-ttu-id="db667-157">如果操作系统未常常刷新其事件源的列表，并且您尝试编写新的源的事件写入操作将失败。</span><span class="sxs-lookup"><span data-stu-id="db667-157">If the operating system hasn't refreshed its list of event sources, and you try to write an event with the new source, the write operation will fail.</span></span> <span data-ttu-id="db667-158">可以使用配置新的源<xref:System.Diagnostics.EventLogInstaller>对象或<xref:System.Diagnostics.EventLog.CreateEventSource%2A>方法。</span><span class="sxs-lookup"><span data-stu-id="db667-158">You can configure a new source by using an <xref:System.Diagnostics.EventLogInstaller> object or the <xref:System.Diagnostics.EventLog.CreateEventSource%2A> method.</span></span> <span data-ttu-id="db667-159">若要创建新的事件源的计算机上，必须具有管理凭据。</span><span class="sxs-lookup"><span data-stu-id="db667-159">You must have administrative credentials on the computer to create a new event source.</span></span>  
  
 <span data-ttu-id="db667-160">每个源可以一次; 写入一个事件日志但是，你的应用程序可以使用多个源写入多个事件日志。</span><span class="sxs-lookup"><span data-stu-id="db667-160">Each source can write to only one event log at a time; however, your application can use multiple sources to write to multiple event logs.</span></span> <span data-ttu-id="db667-161">例如，你的应用程序可能需要多个源配置为使用不同的事件日志或不同的资源文件。</span><span class="sxs-lookup"><span data-stu-id="db667-161">For example, your application might require multiple sources configured for different event logs or different resource files.</span></span> <span data-ttu-id="db667-162">若要更改现有源的配置详细信息，必须删除源，然后使用新的配置创建它。</span><span class="sxs-lookup"><span data-stu-id="db667-162">To change the configuration details of an existing source, you must delete the source and then create it with the new configuration.</span></span> <span data-ttu-id="db667-163">如果其他应用程序或组件使用现有的源，请使用更新的配置，而不是删除现有源创建新的源。</span><span class="sxs-lookup"><span data-stu-id="db667-163">If other applications or components use the existing source, create a new source with the updated configuration instead of deleting the existing source.</span></span>  
  
 <span data-ttu-id="db667-164">为事件类别和消息字符串，可以使用本地化的资源注册事件源。</span><span class="sxs-lookup"><span data-stu-id="db667-164">You can register the event source with localized resources for your event category and message strings.</span></span> <span data-ttu-id="db667-165">你的应用程序可以通过使用资源标识符而不指定实际的字符串值写入事件日志项。</span><span class="sxs-lookup"><span data-stu-id="db667-165">Your application can write event log entries by using resource identifiers instead of specifying the actual string values.</span></span> <span data-ttu-id="db667-166">请参阅<xref:System.Diagnostics.EventLogInstaller>和<xref:System.Diagnostics.EventSourceCreationData>有关的资源文件中配置你的源的详细信息的类。</span><span class="sxs-lookup"><span data-stu-id="db667-166">Refer to the <xref:System.Diagnostics.EventLogInstaller> and <xref:System.Diagnostics.EventSourceCreationData> classes for more information about configuring your source with resource files.</span></span>  
  
 <span data-ttu-id="db667-167">如果你的应用程序直接将字符串值写入事件日志，您不需要设置源的文件属性的资源。</span><span class="sxs-lookup"><span data-stu-id="db667-167">If your application writes string values directly to the event log, you do not have to set the resource file properties for the source.</span></span> <span data-ttu-id="db667-168">要写入本地化的项还是要直接写入字符串，必须配置源。</span><span class="sxs-lookup"><span data-stu-id="db667-168">The source must be configured either for writing localized entries or for writing direct strings.</span></span> <span data-ttu-id="db667-169">如果你的应用程序将使用资源标识符和字符串值的条目写入，则必须注册两个单独的源。</span><span class="sxs-lookup"><span data-stu-id="db667-169">If your application writes entries using both resource identifiers and string values, you must register two separate sources.</span></span> <span data-ttu-id="db667-170">例如，配置一个源的资源文件，以及如何将该源中的<xref:System.Diagnostics.EventLog.WriteEvent%2A>方法来编写使用资源标识符添加到事件日志条目。</span><span class="sxs-lookup"><span data-stu-id="db667-170">For example, configure one source with resource files, and then use that source in the <xref:System.Diagnostics.EventLog.WriteEvent%2A> method to write entries using resource identifiers to the event log.</span></span> <span data-ttu-id="db667-171">然后创建不同的源，而无需资源文件，并使用在该源<xref:System.Diagnostics.EventLog.WriteEntry%2A>方法将字符串直接写入事件日志使用的源。</span><span class="sxs-lookup"><span data-stu-id="db667-171">Then create a different source without resource files, and use that source in the <xref:System.Diagnostics.EventLog.WriteEntry%2A> method to write strings directly to the event log using that source.</span></span>  
  
 <span data-ttu-id="db667-172">写入事件时，必须至少指定一个消息字符串或将消息字符串的资源标识符。</span><span class="sxs-lookup"><span data-stu-id="db667-172">When writing events, you must at least specify either a message string or the resource identifier for a message string.</span></span> <span data-ttu-id="db667-173">其他事件属性是可选的。</span><span class="sxs-lookup"><span data-stu-id="db667-173">Other event properties are optional.</span></span> <span data-ttu-id="db667-174">可选事件设置的示例包括：</span><span class="sxs-lookup"><span data-stu-id="db667-174">Examples of optional event settings include the following:</span></span>  
  
-   <span data-ttu-id="db667-175">可以设置<xref:System.Diagnostics.EventLogEntryType>以指定事件查看器显示的项的图标。</span><span class="sxs-lookup"><span data-stu-id="db667-175">You can set the <xref:System.Diagnostics.EventLogEntryType> to specify the icon that the Event Viewer displays for the entry.</span></span>  
  
-   <span data-ttu-id="db667-176">如果你的应用程序使用类别进行筛选事件，可以指定事件的类别标识符。</span><span class="sxs-lookup"><span data-stu-id="db667-176">You can specify a category identifier for the event, if your application uses categories for filtering the events.</span></span>  
  
-   <span data-ttu-id="db667-177">如果你想要将其他信息与给定的事件相关联，您可以将二进制数据附加到事件项。</span><span class="sxs-lookup"><span data-stu-id="db667-177">You can attach binary data to your event entry if you want to associate additional information with a given event.</span></span>  
  
> [!IMPORTANT]
>  <span data-ttu-id="db667-178">事件日志记录占用磁盘空间、 处理器时间和其他系统资源。</span><span class="sxs-lookup"><span data-stu-id="db667-178">Event logging consumes disk space, processor time, and other system resources.</span></span> <span data-ttu-id="db667-179">请务必只记录重要信息。</span><span class="sxs-lookup"><span data-stu-id="db667-179">It is important to log only essential information.</span></span> <span data-ttu-id="db667-180">我们建议将事件日志的调用放在错误路径，而不是在主代码路径中，因此它们不性能产生负面影响。</span><span class="sxs-lookup"><span data-stu-id="db667-180">We recommend that you place event log calls in an error path, rather than in the main code path, so they don't adversely affect performance.</span></span>  
  
 <span data-ttu-id="db667-181">有关实例的初始属性值的列表<xref:System.Diagnostics.EventLog>，请参阅<xref:System.Diagnostics.EventLog.%23ctor%2A>构造函数。</span><span class="sxs-lookup"><span data-stu-id="db667-181">For a list of initial property values for an instance of <xref:System.Diagnostics.EventLog>, see the <xref:System.Diagnostics.EventLog.%23ctor%2A> constructor.</span></span>  
  
   
  
## Examples  
 <span data-ttu-id="db667-182">下面的示例创建事件源`MySource`如果它尚不存在，并将条目写入到事件日志`MyNewLog`。</span><span class="sxs-lookup"><span data-stu-id="db667-182">The following example creates the event source `MySource` if it doesn't already exist, and writes an entry to the event log `MyNewLog`.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="db667-183">从 Windows Vista 开始，你必须以管理员身份运行此应用程序。</span><span class="sxs-lookup"><span data-stu-id="db667-183">Starting with Windows Vista, you must run this application as an administrator.</span></span>  
  
 [!code-cpp[Classic EventLog.CreateEventSource Example#1](~/samples/snippets/cpp/VS_Snippets_CLR_Classic/classic EventLog.CreateEventSource Example/CPP/source.cpp#1)]
 [!code-csharp[Classic EventLog.CreateEventSource Example#1](~/samples/snippets/csharp/VS_Snippets_CLR_Classic/classic EventLog.CreateEventSource Example/CS/source.cs#1)]
 [!code-vb[Classic EventLog.CreateEventSource Example#1](~/samples/snippets/visualbasic/VS_Snippets_CLR_Classic/classic EventLog.CreateEventSource Example/VB/source.vb#1)]  
  
 ]]></format>
    </remarks>
    <altmember cref="T:System.Diagnostics.EventLogInstaller" />
    <altmember cref="T:System.Diagnostics.EventLogEntry" />
    <altmember cref="T:System.Diagnostics.EntryWrittenEventArgs" />
    <altmember cref="T:System.ServiceProcess.ServiceBase" />
  </Docs>
  <Members>
    <MemberGroup MemberName=".ctor">
      <AssemblyInfo>
        <AssemblyName>System</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Docs>
        <summary>
          <span data-ttu-id="db667-184">初始化 <see cref="T:System.Diagnostics.EventLog" /> 类的新实例。</span>
          <span class="sxs-lookup">
            <span data-stu-id="db667-184">Initializes a new instance of the <see cref="T:System.Diagnostics.EventLog" /> class.</span>
          </span>
        </summary>
      </Docs>
    </MemberGroup>
    <Member MemberName=".ctor">
      <MemberSignature Language="C#" Value="public EventLog ();" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig specialname rtspecialname instance void .ctor() cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Diagnostics.EventLog.#ctor" />
      <MemberSignature Language="VB.NET" Value="Public Sub New ()" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; EventLog();" />
      <MemberType>Constructor</MemberType>
      <AssemblyInfo>
        <AssemblyName>System</AssemblyName>
        <AssemblyVersion>1.0.5000.0</AssemblyVersion>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Attributes>
        <Attribute FrameworkAlternate="netframework-4.0">
          <AttributeName>System.Runtime.TargetedPatchingOptOut("Performance critical to inline this type of method across NGen image boundaries")</AttributeName>
        </Attribute>
      </Attributes>
      <Parameters />
      <Docs>
        <summary>
          <span data-ttu-id="db667-185">初始化 <see cref="T:System.Diagnostics.EventLog" /> 类的新实例。</span>
          <span class="sxs-lookup">
            <span data-stu-id="db667-185">Initializes a new instance of the <see cref="T:System.Diagnostics.EventLog" /> class.</span>
          </span>
          <span data-ttu-id="db667-186">不将该实例与任何日志关联。</span>
          <span class="sxs-lookup">
            <span data-stu-id="db667-186">Does not associate the instance with any log.</span>
          </span>
        </summary>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="db667-187">然后再调用<xref:System.Diagnostics.EventLog.WriteEntry%2A>，指定<xref:System.Diagnostics.EventLog.Source%2A>属性的<xref:System.Diagnostics.EventLog>实例。</span><span class="sxs-lookup"><span data-stu-id="db667-187">Before calling <xref:System.Diagnostics.EventLog.WriteEntry%2A>, specify the <xref:System.Diagnostics.EventLog.Source%2A> property of the <xref:System.Diagnostics.EventLog> instance.</span></span> <span data-ttu-id="db667-188">如果仅读取<xref:System.Diagnostics.EventLog.Entries%2A>从日志中，可选择指定仅<xref:System.Diagnostics.EventLog.Log%2A>和<xref:System.Diagnostics.EventLog.MachineName%2A>属性。</span><span class="sxs-lookup"><span data-stu-id="db667-188">If you are only reading <xref:System.Diagnostics.EventLog.Entries%2A> from the log, you can alternatively specify only the <xref:System.Diagnostics.EventLog.Log%2A> and <xref:System.Diagnostics.EventLog.MachineName%2A> properties.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="db667-189">如果未指定<xref:System.Diagnostics.EventLog.MachineName%2A>，本地计算机 ("。") 假定。</span><span class="sxs-lookup"><span data-stu-id="db667-189">If you do not specify a <xref:System.Diagnostics.EventLog.MachineName%2A>, the local computer (".") is assumed.</span></span>  
  
 <span data-ttu-id="db667-190">下表显示的实例的初始属性值<xref:System.Diagnostics.EventLog>。</span><span class="sxs-lookup"><span data-stu-id="db667-190">The following table shows initial property values for an instance of <xref:System.Diagnostics.EventLog>.</span></span>  
  
|<span data-ttu-id="db667-191">Property</span><span class="sxs-lookup"><span data-stu-id="db667-191">Property</span></span>|<span data-ttu-id="db667-192">初始值</span><span class="sxs-lookup"><span data-stu-id="db667-192">Initial Value</span></span>|  
|--------------|-------------------|  
|<xref:System.Diagnostics.EventLog.Source%2A>|<span data-ttu-id="db667-193">空字符串 ("")。</span><span class="sxs-lookup"><span data-stu-id="db667-193">An empty string ("").</span></span>|  
|<xref:System.Diagnostics.EventLog.Log%2A>|<span data-ttu-id="db667-194">空字符串 ("")。</span><span class="sxs-lookup"><span data-stu-id="db667-194">An empty string ("").</span></span>|  
|<xref:System.Diagnostics.EventLog.MachineName%2A>|<span data-ttu-id="db667-195">在本地计算机 ("。")。</span><span class="sxs-lookup"><span data-stu-id="db667-195">The local computer (".").</span></span>|  
  
   
  
## Examples  
 <span data-ttu-id="db667-196">下面的示例创建源`MySource`如果它尚不存在，并将条目写入到事件日志`MyNewLog`。</span><span class="sxs-lookup"><span data-stu-id="db667-196">The following example creates the source `MySource` if it does not already exist, and writes an entry to the event log `MyNewLog`.</span></span>  
  
 [!code-cpp[Classic EventLog.CreateEventSource Example#1](~/samples/snippets/cpp/VS_Snippets_CLR_Classic/classic EventLog.CreateEventSource Example/CPP/source.cpp#1)]
 [!code-csharp[Classic EventLog.CreateEventSource Example#1](~/samples/snippets/csharp/VS_Snippets_CLR_Classic/classic EventLog.CreateEventSource Example/CS/source.cs#1)]
 [!code-vb[Classic EventLog.CreateEventSource Example#1](~/samples/snippets/visualbasic/VS_Snippets_CLR_Classic/classic EventLog.CreateEventSource Example/VB/source.vb#1)]  
  
 ]]></format>
        </remarks>
        <permission cref="T:System.Diagnostics.EventLogPermission">
          <span data-ttu-id="db667-197">用于写入的计算机上的事件日志信息。</span>
          <span class="sxs-lookup">
            <span data-stu-id="db667-197">for writing the event log information on the computer.</span>
          </span>
          <span data-ttu-id="db667-198">关联的枚举： <see cref="F:System.Diagnostics.EventLogPermissionAccess.Write" /></span>
          <span class="sxs-lookup">
            <span data-stu-id="db667-198">Associated enumeration: <see cref="F:System.Diagnostics.EventLogPermissionAccess.Write" /></span>
          </span>
        </permission>
        <altmember cref="P:System.Diagnostics.EventLog.Source" />
        <altmember cref="P:System.Diagnostics.EventLog.Log" />
        <altmember cref="P:System.Diagnostics.EventLog.MachineName" />
        <altmember cref="P:System.Diagnostics.EventLog.Entries" />
        <altmember cref="Overload:System.Diagnostics.EventLog.WriteEntry" />
        <altmember cref="Overload:System.Diagnostics.EventLog.WriteEvent" />
        <altmember cref="T:System.Diagnostics.EventLogEntry" />
      </Docs>
    </Member>
    <Member MemberName=".ctor">
      <MemberSignature Language="C#" Value="public EventLog (string logName);" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig specialname rtspecialname instance void .ctor(string logName) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Diagnostics.EventLog.#ctor(System.String)" />
      <MemberSignature Language="VB.NET" Value="Public Sub New (logName As String)" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; EventLog(System::String ^ logName);" />
      <MemberSignature Language="F#" Value="new System.Diagnostics.EventLog : string -&gt; System.Diagnostics.EventLog" Usage="new System.Diagnostics.EventLog logName" />
      <MemberType>Constructor</MemberType>
      <AssemblyInfo>
        <AssemblyName>System</AssemblyName>
        <AssemblyVersion>1.0.5000.0</AssemblyVersion>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Attributes>
        <Attribute FrameworkAlternate="netframework-4.0">
          <AttributeName>System.Runtime.TargetedPatchingOptOut("Performance critical to inline this type of method across NGen image boundaries")</AttributeName>
        </Attribute>
      </Attributes>
      <Parameters>
        <Parameter Name="logName" Type="System.String" />
      </Parameters>
      <Docs>
        <param name="logName">
          <span data-ttu-id="db667-199">本地计算机上日志的名称。</span>
          <span class="sxs-lookup">
            <span data-stu-id="db667-199">The name of the log on the local computer.</span>
          </span>
        </param>
        <summary>
          <span data-ttu-id="db667-200">初始化 <see cref="T:System.Diagnostics.EventLog" /> 类的新实例。</span>
          <span class="sxs-lookup">
            <span data-stu-id="db667-200">Initializes a new instance of the <see cref="T:System.Diagnostics.EventLog" /> class.</span>
          </span>
          <span data-ttu-id="db667-201">将该实例与本地计算机上的日志关联。</span>
          <span class="sxs-lookup">
            <span data-stu-id="db667-201">Associates the instance with a log on the local computer.</span>
          </span>
        </summary>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="db667-202">此重载设置<xref:System.Diagnostics.EventLog.Log%2A>属性设置为`logName`参数。</span><span class="sxs-lookup"><span data-stu-id="db667-202">This overload sets the <xref:System.Diagnostics.EventLog.Log%2A> property to the `logName` parameter.</span></span> <span data-ttu-id="db667-203">然后再调用<xref:System.Diagnostics.EventLog.WriteEntry%2A>，指定<xref:System.Diagnostics.EventLog.Source%2A>属性的<xref:System.Diagnostics.EventLog>实例。</span><span class="sxs-lookup"><span data-stu-id="db667-203">Before calling <xref:System.Diagnostics.EventLog.WriteEntry%2A>, specify the <xref:System.Diagnostics.EventLog.Source%2A> property of the <xref:System.Diagnostics.EventLog> instance.</span></span> <span data-ttu-id="db667-204">如果仅读取<xref:System.Diagnostics.EventLog.Entries%2A>从日志中，可选择指定仅<xref:System.Diagnostics.EventLog.Log%2A>和<xref:System.Diagnostics.EventLog.MachineName%2A>属性。</span><span class="sxs-lookup"><span data-stu-id="db667-204">If you are only reading <xref:System.Diagnostics.EventLog.Entries%2A> from the log, you can alternatively specify only the <xref:System.Diagnostics.EventLog.Log%2A> and <xref:System.Diagnostics.EventLog.MachineName%2A> properties.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="db667-205">如果未指定<xref:System.Diagnostics.EventLog.MachineName%2A>，本地计算机 ("。") 假定。</span><span class="sxs-lookup"><span data-stu-id="db667-205">If you do not specify a <xref:System.Diagnostics.EventLog.MachineName%2A>, the local computer (".") is assumed.</span></span> <span data-ttu-id="db667-206">此重载构造函数指定<xref:System.Diagnostics.EventLog.Log%2A>属性，但您可以更改此读取操作之前<xref:System.Diagnostics.EventLog.Entries%2A>属性。</span><span class="sxs-lookup"><span data-stu-id="db667-206">This overload of the constructor specifies the <xref:System.Diagnostics.EventLog.Log%2A> property, but you can change this before reading the <xref:System.Diagnostics.EventLog.Entries%2A> property.</span></span>  
  
 <span data-ttu-id="db667-207">如果你在中指定的源<xref:System.Diagnostics.EventLog.Source%2A>属性从其他源的计算机上，后续调用都是唯一<xref:System.Diagnostics.EventLog.WriteEntry%2A>如果尚不存在具有指定名称创建一个日志。</span><span class="sxs-lookup"><span data-stu-id="db667-207">If the source you specify in the <xref:System.Diagnostics.EventLog.Source%2A> property is unique from other sources on the computer, a subsequent call to <xref:System.Diagnostics.EventLog.WriteEntry%2A> creates a log with the specified name, if it does not already exist.</span></span>  
  
 <span data-ttu-id="db667-208">下表显示的实例的初始属性值<xref:System.Diagnostics.EventLog>。</span><span class="sxs-lookup"><span data-stu-id="db667-208">The following table shows initial property values for an instance of <xref:System.Diagnostics.EventLog>.</span></span>  
  
|<span data-ttu-id="db667-209">Property</span><span class="sxs-lookup"><span data-stu-id="db667-209">Property</span></span>|<span data-ttu-id="db667-210">初始值</span><span class="sxs-lookup"><span data-stu-id="db667-210">Initial Value</span></span>|  
|--------------|-------------------|  
|<xref:System.Diagnostics.EventLog.Source%2A>|<span data-ttu-id="db667-211">空字符串 ("")。</span><span class="sxs-lookup"><span data-stu-id="db667-211">An empty string ("").</span></span>|  
|<xref:System.Diagnostics.EventLog.Log%2A>|<span data-ttu-id="db667-212">`logName` 参数。</span><span class="sxs-lookup"><span data-stu-id="db667-212">The `logName` parameter.</span></span>|  
|<xref:System.Diagnostics.EventLog.MachineName%2A>|<span data-ttu-id="db667-213">在本地计算机 ("。")。</span><span class="sxs-lookup"><span data-stu-id="db667-213">The local computer (".").</span></span>|  
  
   
  
## Examples  
 <span data-ttu-id="db667-214">下面的示例读取事件日志，在本地计算机上"myNewLog"中的条目。</span><span class="sxs-lookup"><span data-stu-id="db667-214">The following example reads entries in the event log, "myNewLog", on the local computer.</span></span>  
  
 [!code-cpp[Classic EventLog.EventLog1 Example#1](~/samples/snippets/cpp/VS_Snippets_CLR_Classic/classic EventLog.EventLog1 Example/CPP/source.cpp#1)]
 [!code-csharp[Classic EventLog.EventLog1 Example#1](~/samples/snippets/csharp/VS_Snippets_CLR_Classic/classic EventLog.EventLog1 Example/CS/source.cs#1)]
 [!code-vb[Classic EventLog.EventLog1 Example#1](~/samples/snippets/visualbasic/VS_Snippets_CLR_Classic/classic EventLog.EventLog1 Example/VB/source.vb#1)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentNullException">
          <span data-ttu-id="db667-215">日志名称为 <see langword="null" />。</span>
          <span class="sxs-lookup">
            <span data-stu-id="db667-215">The log name is <see langword="null" />.</span>
          </span>
        </exception>
        <exception cref="T:System.ArgumentException">
          <span data-ttu-id="db667-216">日志名称无效。</span>
          <span class="sxs-lookup">
            <span data-stu-id="db667-216">The log name is invalid.</span>
          </span>
        </exception>
        <permission cref="T:System.Diagnostics.EventLogPermission">
          <span data-ttu-id="db667-217">用于写入的计算机上的事件日志信息。</span>
          <span class="sxs-lookup">
            <span data-stu-id="db667-217">for writing the event log information on the computer.</span>
          </span>
          <span data-ttu-id="db667-218">关联的枚举： <see cref="F:System.Diagnostics.EventLogPermissionAccess.Write" /></span>
          <span class="sxs-lookup">
            <span data-stu-id="db667-218">Associated enumeration: <see cref="F:System.Diagnostics.EventLogPermissionAccess.Write" /></span>
          </span>
        </permission>
        <altmember cref="P:System.Diagnostics.EventLog.Source" />
        <altmember cref="P:System.Diagnostics.EventLog.Log" />
        <altmember cref="P:System.Diagnostics.EventLog.MachineName" />
        <altmember cref="P:System.Diagnostics.EventLog.Entries" />
        <altmember cref="Overload:System.Diagnostics.EventLog.WriteEntry" />
        <altmember cref="Overload:System.Diagnostics.EventLog.WriteEvent" />
        <altmember cref="T:System.Diagnostics.EventLogEntry" />
      </Docs>
    </Member>
    <Member MemberName=".ctor">
      <MemberSignature Language="C#" Value="public EventLog (string logName, string machineName);" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig specialname rtspecialname instance void .ctor(string logName, string machineName) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Diagnostics.EventLog.#ctor(System.String,System.String)" />
      <MemberSignature Language="VB.NET" Value="Public Sub New (logName As String, machineName As String)" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; EventLog(System::String ^ logName, System::String ^ machineName);" />
      <MemberSignature Language="F#" Value="new System.Diagnostics.EventLog : string * string -&gt; System.Diagnostics.EventLog" Usage="new System.Diagnostics.EventLog (logName, machineName)" />
      <MemberType>Constructor</MemberType>
      <AssemblyInfo>
        <AssemblyName>System</AssemblyName>
        <AssemblyVersion>1.0.5000.0</AssemblyVersion>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Attributes>
        <Attribute FrameworkAlternate="netframework-4.0">
          <AttributeName>System.Runtime.TargetedPatchingOptOut("Performance critical to inline this type of method across NGen image boundaries")</AttributeName>
        </Attribute>
      </Attributes>
      <Parameters>
        <Parameter Name="logName" Type="System.String" />
        <Parameter Name="machineName" Type="System.String" />
      </Parameters>
      <Docs>
        <param name="logName">
          <span data-ttu-id="db667-219">指定算机上日志的名称。</span>
          <span class="sxs-lookup">
            <span data-stu-id="db667-219">The name of the log on the specified computer.</span>
          </span>
        </param>
        <param name="machineName">
          <span data-ttu-id="db667-220">日志所在的计算机。</span>
          <span class="sxs-lookup">
            <span data-stu-id="db667-220">The computer on which the log exists.</span>
          </span>
        </param>
        <summary>
          <span data-ttu-id="db667-221">初始化 <see cref="T:System.Diagnostics.EventLog" /> 类的新实例。</span>
          <span class="sxs-lookup">
            <span data-stu-id="db667-221">Initializes a new instance of the <see cref="T:System.Diagnostics.EventLog" /> class.</span>
          </span>
          <span data-ttu-id="db667-222">将该实例与指定计算机上的日志关联。</span>
          <span class="sxs-lookup">
            <span data-stu-id="db667-222">Associates the instance with a log on the specified computer.</span>
          </span>
        </summary>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="db667-223">此重载设置<xref:System.Diagnostics.EventLog.Log%2A>属性设置为`logName`参数和<xref:System.Diagnostics.EventLog.MachineName%2A>属性设置为`machineName`参数。</span><span class="sxs-lookup"><span data-stu-id="db667-223">This overload sets the <xref:System.Diagnostics.EventLog.Log%2A> property to the `logName` parameter and the <xref:System.Diagnostics.EventLog.MachineName%2A> property to the `machineName` parameter.</span></span> <span data-ttu-id="db667-224">然后再调用<xref:System.Diagnostics.EventLog.WriteEntry%2A>，指定<xref:System.Diagnostics.EventLog.Source%2A>属性的<xref:System.Diagnostics.EventLog>。</span><span class="sxs-lookup"><span data-stu-id="db667-224">Before calling <xref:System.Diagnostics.EventLog.WriteEntry%2A>, specify the <xref:System.Diagnostics.EventLog.Source%2A> property of the <xref:System.Diagnostics.EventLog>.</span></span> <span data-ttu-id="db667-225">如果仅读取<xref:System.Diagnostics.EventLog.Entries%2A>从日志中，可选择指定仅<xref:System.Diagnostics.EventLog.Log%2A>和<xref:System.Diagnostics.EventLog.MachineName%2A>属性。</span><span class="sxs-lookup"><span data-stu-id="db667-225">If you are only reading <xref:System.Diagnostics.EventLog.Entries%2A> from the log, you can alternatively specify only the <xref:System.Diagnostics.EventLog.Log%2A> and <xref:System.Diagnostics.EventLog.MachineName%2A> properties.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="db667-226">此重载构造函数指定<xref:System.Diagnostics.EventLog.Log%2A>并<xref:System.Diagnostics.EventLog.MachineName%2A>属性，但您可以更改之前读取<xref:System.Diagnostics.EventLog.Entries%2A>属性。</span><span class="sxs-lookup"><span data-stu-id="db667-226">This overload of the constructor specifies the <xref:System.Diagnostics.EventLog.Log%2A> and <xref:System.Diagnostics.EventLog.MachineName%2A> properties, but you can change either before reading the <xref:System.Diagnostics.EventLog.Entries%2A> property.</span></span>  
  
 <span data-ttu-id="db667-227">下表显示的实例的初始属性值<xref:System.Diagnostics.EventLog>。</span><span class="sxs-lookup"><span data-stu-id="db667-227">The following table shows initial property values for an instance of <xref:System.Diagnostics.EventLog>.</span></span>  
  
|<span data-ttu-id="db667-228">Property</span><span class="sxs-lookup"><span data-stu-id="db667-228">Property</span></span>|<span data-ttu-id="db667-229">初始值</span><span class="sxs-lookup"><span data-stu-id="db667-229">Initial Value</span></span>|  
|--------------|-------------------|  
|<xref:System.Diagnostics.EventLog.Source%2A>|<span data-ttu-id="db667-230">空字符串 ("")。</span><span class="sxs-lookup"><span data-stu-id="db667-230">An empty string ("").</span></span>|  
|<xref:System.Diagnostics.EventLog.Log%2A>|<span data-ttu-id="db667-231">`logName` 参数。</span><span class="sxs-lookup"><span data-stu-id="db667-231">The `logName` parameter.</span></span>|  
|<xref:System.Diagnostics.EventLog.MachineName%2A>|<span data-ttu-id="db667-232">`machineName` 参数。</span><span class="sxs-lookup"><span data-stu-id="db667-232">The `machineName` parameter.</span></span>|  
  
   
  
## Examples  
 <span data-ttu-id="db667-233">下面的示例读取在事件日志中，"myNewLog"计算机"myServer"上的条目。</span><span class="sxs-lookup"><span data-stu-id="db667-233">The following example reads entries in the event log, "myNewLog", on the computer "myServer".</span></span>  
  
 [!code-cpp[Classic EventLog.EventLog2 Example#1](~/samples/snippets/cpp/VS_Snippets_CLR_Classic/classic EventLog.EventLog2 Example/CPP/source.cpp#1)]
 [!code-csharp[Classic EventLog.EventLog2 Example#1](~/samples/snippets/csharp/VS_Snippets_CLR_Classic/classic EventLog.EventLog2 Example/CS/source.cs#1)]
 [!code-vb[Classic EventLog.EventLog2 Example#1](~/samples/snippets/visualbasic/VS_Snippets_CLR_Classic/classic EventLog.EventLog2 Example/VB/source.vb#1)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentNullException">
          <span data-ttu-id="db667-234">日志名称为 <see langword="null" />。</span>
          <span class="sxs-lookup">
            <span data-stu-id="db667-234">The log name is <see langword="null" />.</span>
          </span>
        </exception>
        <exception cref="T:System.ArgumentException">
          <span data-ttu-id="db667-235">日志名称无效。</span>
          <span class="sxs-lookup">
            <span data-stu-id="db667-235">The log name is invalid.</span>
          </span>
          <span data-ttu-id="db667-236">或</span>
          <span class="sxs-lookup">
            <span data-stu-id="db667-236">-or-</span>
          </span>
          <span data-ttu-id="db667-237">计算机名称无效。</span>
          <span class="sxs-lookup">
            <span data-stu-id="db667-237">The computer name is invalid.</span>
          </span>
        </exception>
        <permission cref="T:System.Diagnostics.EventLogPermission">
          <span data-ttu-id="db667-238">用于写入的计算机上的事件日志信息。</span>
          <span class="sxs-lookup">
            <span data-stu-id="db667-238">for writing the event log information on the computer.</span>
          </span>
          <span data-ttu-id="db667-239">关联的枚举： <see cref="F:System.Diagnostics.EventLogPermissionAccess.Write" /></span>
          <span class="sxs-lookup">
            <span data-stu-id="db667-239">Associated enumeration: <see cref="F:System.Diagnostics.EventLogPermissionAccess.Write" /></span>
          </span>
        </permission>
        <altmember cref="P:System.Diagnostics.EventLog.Source" />
        <altmember cref="P:System.Diagnostics.EventLog.Log" />
        <altmember cref="P:System.Diagnostics.EventLog.MachineName" />
        <altmember cref="P:System.Diagnostics.EventLog.Entries" />
        <altmember cref="Overload:System.Diagnostics.EventLog.WriteEntry" />
        <altmember cref="Overload:System.Diagnostics.EventLog.WriteEvent" />
        <altmember cref="T:System.Diagnostics.EventLogEntry" />
      </Docs>
    </Member>
    <Member MemberName=".ctor">
      <MemberSignature Language="C#" Value="public EventLog (string logName, string machineName, string source);" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig specialname rtspecialname instance void .ctor(string logName, string machineName, string source) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Diagnostics.EventLog.#ctor(System.String,System.String,System.String)" />
      <MemberSignature Language="VB.NET" Value="Public Sub New (logName As String, machineName As String, source As String)" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; EventLog(System::String ^ logName, System::String ^ machineName, System::String ^ source);" />
      <MemberSignature Language="F#" Value="new System.Diagnostics.EventLog : string * string * string -&gt; System.Diagnostics.EventLog" Usage="new System.Diagnostics.EventLog (logName, machineName, source)" />
      <MemberType>Constructor</MemberType>
      <AssemblyInfo>
        <AssemblyName>System</AssemblyName>
        <AssemblyVersion>1.0.5000.0</AssemblyVersion>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Parameters>
        <Parameter Name="logName" Type="System.String" />
        <Parameter Name="machineName" Type="System.String" />
        <Parameter Name="source" Type="System.String" />
      </Parameters>
      <Docs>
        <param name="logName">
          <span data-ttu-id="db667-240">指定的计算机上日志的名称</span>
          <span class="sxs-lookup">
            <span data-stu-id="db667-240">The name of the log on the specified computer</span>
          </span>
        </param>
        <param name="machineName">
          <span data-ttu-id="db667-241">日志所在的计算机。</span>
          <span class="sxs-lookup">
            <span data-stu-id="db667-241">The computer on which the log exists.</span>
          </span>
        </param>
        <param name="source">
          <span data-ttu-id="db667-242">事件日志项的源。</span>
          <span class="sxs-lookup">
            <span data-stu-id="db667-242">The source of event log entries.</span>
          </span>
        </param>
        <summary>
          <span data-ttu-id="db667-243">初始化 <see cref="T:System.Diagnostics.EventLog" /> 类的新实例。</span>
          <span class="sxs-lookup">
            <span data-stu-id="db667-243">Initializes a new instance of the <see cref="T:System.Diagnostics.EventLog" /> class.</span>
          </span>
          <span data-ttu-id="db667-244">将实例与指定的计算机上的日志关联，并为 <see cref="T:System.Diagnostics.EventLog" /> 实例创建或分配指定的源。</span>
          <span class="sxs-lookup">
            <span data-stu-id="db667-244">Associates the instance with a log on the specified computer and creates or assigns the specified source to the <see cref="T:System.Diagnostics.EventLog" />.</span>
          </span>
        </summary>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="db667-245">此构造函数设置<xref:System.Diagnostics.EventLog.Log%2A>属性设置为`logName`参数，<xref:System.Diagnostics.EventLog.MachineName%2A>属性设置为`machineName`参数，并且<xref:System.Diagnostics.EventLog.Source%2A>属性设置为`source`参数。</span><span class="sxs-lookup"><span data-stu-id="db667-245">This constructor sets the <xref:System.Diagnostics.EventLog.Log%2A> property to the `logName` parameter, the <xref:System.Diagnostics.EventLog.MachineName%2A> property to the `machineName` parameter, and the <xref:System.Diagnostics.EventLog.Source%2A> property to the `source` parameter.</span></span> <span data-ttu-id="db667-246"><xref:System.Diagnostics.EventLog.Source%2A>属性是必需的写入事件日志时。</span><span class="sxs-lookup"><span data-stu-id="db667-246">The <xref:System.Diagnostics.EventLog.Source%2A> property is required when writing to an event log.</span></span> <span data-ttu-id="db667-247">但是，如果您是仅从事件日志，仅读取<xref:System.Diagnostics.EventLog.Log%2A>和<xref:System.Diagnostics.EventLog.MachineName%2A>属性是必需的 （只要该服务器上的事件日志具有已与之关联的源）。</span><span class="sxs-lookup"><span data-stu-id="db667-247">However, if you are only reading from an event log, only the <xref:System.Diagnostics.EventLog.Log%2A> and <xref:System.Diagnostics.EventLog.MachineName%2A> properties are required (as long as the event log on the server has a source already associated with it).</span></span> <span data-ttu-id="db667-248">如果你是仅从事件日志进行读取，另一个重载的构造函数可能就足够了。</span><span class="sxs-lookup"><span data-stu-id="db667-248">If you are only reading from the event log, another overload of the constructor might suffice.</span></span>  
  
 <span data-ttu-id="db667-249">下表显示的实例的初始属性值<xref:System.Diagnostics.EventLog>。</span><span class="sxs-lookup"><span data-stu-id="db667-249">The following table shows initial property values for an instance of <xref:System.Diagnostics.EventLog>.</span></span>  
  
|<span data-ttu-id="db667-250">Property</span><span class="sxs-lookup"><span data-stu-id="db667-250">Property</span></span>|<span data-ttu-id="db667-251">初始值</span><span class="sxs-lookup"><span data-stu-id="db667-251">Initial Value</span></span>|  
|--------------|-------------------|  
|<xref:System.Diagnostics.EventLog.Source%2A>|<span data-ttu-id="db667-252">`source` 参数。</span><span class="sxs-lookup"><span data-stu-id="db667-252">The `source` parameter.</span></span>|  
|<xref:System.Diagnostics.EventLog.Log%2A>|<span data-ttu-id="db667-253">`logName` 参数。</span><span class="sxs-lookup"><span data-stu-id="db667-253">The `logName` parameter.</span></span>|  
|<xref:System.Diagnostics.EventLog.MachineName%2A>|<span data-ttu-id="db667-254">`machineName` 参数。</span><span class="sxs-lookup"><span data-stu-id="db667-254">The `machineName` parameter.</span></span>|  
  
   
  
## Examples  
 <span data-ttu-id="db667-255">下面的示例使用源""的本地计算机上将条目写入到事件日志中，"MyNewLog"。</span><span class="sxs-lookup"><span data-stu-id="db667-255">The following example writes an entry to an event log, "MyNewLog", on the local computer, using the source "MySource".</span></span>  
  
 [!code-cpp[Classic EventLog.EventLog3 Example#1](~/samples/snippets/cpp/VS_Snippets_CLR_Classic/classic EventLog.EventLog3 Example/CPP/source.cpp#1)]
 [!code-csharp[Classic EventLog.EventLog3 Example#1](~/samples/snippets/csharp/VS_Snippets_CLR_Classic/classic EventLog.EventLog3 Example/CS/source.cs#1)]
 [!code-vb[Classic EventLog.EventLog3 Example#1](~/samples/snippets/visualbasic/VS_Snippets_CLR_Classic/classic EventLog.EventLog3 Example/VB/source.vb#1)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentNullException">
          <span data-ttu-id="db667-256">日志名称为 <see langword="null" />。</span>
          <span class="sxs-lookup">
            <span data-stu-id="db667-256">The log name is <see langword="null" />.</span>
          </span>
        </exception>
        <exception cref="T:System.ArgumentException">
          <span data-ttu-id="db667-257">日志名称无效。</span>
          <span class="sxs-lookup">
            <span data-stu-id="db667-257">The log name is invalid.</span>
          </span>
          <span data-ttu-id="db667-258">或</span>
          <span class="sxs-lookup">
            <span data-stu-id="db667-258">-or-</span>
          </span>
          <span data-ttu-id="db667-259">计算机名称无效。</span>
          <span class="sxs-lookup">
            <span data-stu-id="db667-259">The computer name is invalid.</span>
          </span>
        </exception>
        <permission cref="T:System.Diagnostics.EventLogPermission">
          <span data-ttu-id="db667-260">用于写入的计算机上的事件日志信息。</span>
          <span class="sxs-lookup">
            <span data-stu-id="db667-260">for writing the event log information on the computer.</span>
          </span>
          <span data-ttu-id="db667-261">关联的枚举： <see cref="F:System.Diagnostics.EventLogPermissionAccess.Write" /></span>
          <span class="sxs-lookup">
            <span data-stu-id="db667-261">Associated enumeration: <see cref="F:System.Diagnostics.EventLogPermissionAccess.Write" /></span>
          </span>
        </permission>
        <altmember cref="P:System.Diagnostics.EventLog.Source" />
        <altmember cref="P:System.Diagnostics.EventLog.Log" />
        <altmember cref="P:System.Diagnostics.EventLog.MachineName" />
        <altmember cref="P:System.Diagnostics.EventLog.Entries" />
        <altmember cref="Overload:System.Diagnostics.EventLog.WriteEntry" />
        <altmember cref="Overload:System.Diagnostics.EventLog.WriteEvent" />
        <altmember cref="T:System.Diagnostics.EventLogEntry" />
      </Docs>
    </Member>
    <Member MemberName="BeginInit">
      <MemberSignature Language="C#" Value="public void BeginInit ();" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig newslot virtual instance void BeginInit() cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Diagnostics.EventLog.BeginInit" />
      <MemberSignature Language="VB.NET" Value="Public Sub BeginInit ()" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; virtual void BeginInit();" />
      <MemberSignature Language="F#" Value="abstract member BeginInit : unit -&gt; unit&#xA;override this.BeginInit : unit -&gt; unit" Usage="eventLog.BeginInit " />
      <MemberType>Method</MemberType>
      <Implements>
        <InterfaceMember>M:System.ComponentModel.ISupportInitialize.BeginInit</InterfaceMember>
      </Implements>
      <AssemblyInfo>
        <AssemblyName>System</AssemblyName>
        <AssemblyVersion>1.0.5000.0</AssemblyVersion>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Void</ReturnType>
      </ReturnValue>
      <Parameters />
      <Docs>
        <summary>
          <span data-ttu-id="db667-262">开始初始化用于窗体或由其他组件使用的 <see cref="T:System.Diagnostics.EventLog" />。</span>
          <span class="sxs-lookup">
            <span data-stu-id="db667-262">Begins the initialization of an <see cref="T:System.Diagnostics.EventLog" /> used on a form or used by another component.</span>
          </span>
          <span data-ttu-id="db667-263">此初始化在运行时发生。</span>
          <span class="sxs-lookup">
            <span data-stu-id="db667-263">The initialization occurs at runtime.</span>
          </span>
        </summary>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="db667-264">[!INCLUDE[vsprvslong](~/includes/vsprvslong-md.md)]设计环境使用此方法来启动窗体或由另一个组件使用的组件的初始化。</span><span class="sxs-lookup"><span data-stu-id="db667-264">The [!INCLUDE[vsprvslong](~/includes/vsprvslong-md.md)] design environment uses this method to start the initialization of a component used on a form or by another component.</span></span> <span data-ttu-id="db667-265"><xref:System.Diagnostics.EventLog.EndInit%2A>方法结束初始化。</span><span class="sxs-lookup"><span data-stu-id="db667-265">The <xref:System.Diagnostics.EventLog.EndInit%2A> method ends the initialization.</span></span> <span data-ttu-id="db667-266">使用<xref:System.Diagnostics.EventLog.BeginInit%2A>和<xref:System.Diagnostics.EventLog.EndInit%2A>方法可防止该控件完全初始化之前使用。</span><span class="sxs-lookup"><span data-stu-id="db667-266">Using the <xref:System.Diagnostics.EventLog.BeginInit%2A> and <xref:System.Diagnostics.EventLog.EndInit%2A> methods prevent the control from being used before it is fully initialized.</span></span>  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.InvalidOperationException">
          <span data-ttu-id="db667-267">
            <see cref="T:System.Diagnostics.EventLog" /> 已初始化完毕。</span>
          <span class="sxs-lookup">
            <span data-stu-id="db667-267">
              <see cref="T:System.Diagnostics.EventLog" /> is already initialized.</span>
          </span>
        </exception>
        <permission cref="T:System.Diagnostics.EventLogPermission">
          <span data-ttu-id="db667-268">用于写入的计算机上的事件日志信息。</span>
          <span class="sxs-lookup">
            <span data-stu-id="db667-268">for writing the event log information on the computer.</span>
          </span>
          <span data-ttu-id="db667-269">关联的枚举： <see cref="F:System.Diagnostics.EventLogPermissionAccess.Write" /></span>
          <span class="sxs-lookup">
            <span data-stu-id="db667-269">Associated enumeration: <see cref="F:System.Diagnostics.EventLogPermissionAccess.Write" /></span>
          </span>
        </permission>
        <altmember cref="M:System.Diagnostics.EventLog.EndInit" />
      </Docs>
    </Member>
    <Member MemberName="Clear">
      <MemberSignature Language="C#" Value="public void Clear ();" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig instance void Clear() cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Diagnostics.EventLog.Clear" />
      <MemberSignature Language="VB.NET" Value="Public Sub Clear ()" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; void Clear();" />
      <MemberSignature Language="F#" Value="member this.Clear : unit -&gt; unit" Usage="eventLog.Clear " />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System</AssemblyName>
        <AssemblyVersion>1.0.5000.0</AssemblyVersion>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Void</ReturnType>
      </ReturnValue>
      <Parameters />
      <Docs>
        <summary>
          <span data-ttu-id="db667-270">从事件日志中移除所有项。</span>
          <span class="sxs-lookup">
            <span data-stu-id="db667-270">Removes all entries from the event log.</span>
          </span>
        </summary>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="db667-271">事件日志的设置确定它们可以包含多个条目的最大大小。</span><span class="sxs-lookup"><span data-stu-id="db667-271">Event logs are set with a maximum size that determines how many entries they can contain.</span></span> <span data-ttu-id="db667-272">事件日志已满时，它将停止记录新事件信息，或开始覆盖以前的项。</span><span class="sxs-lookup"><span data-stu-id="db667-272">When an event log is full, it stops recording new event information or begins to overwrite earlier entries.</span></span> <span data-ttu-id="db667-273">如果事件录制停止后，可以使用此方法以清除日志中的现有条目并允许它重新开始记录事件。</span><span class="sxs-lookup"><span data-stu-id="db667-273">If event recording stops, you can use this method to clear the log of existing entries and allow it to start recording events again.</span></span> <span data-ttu-id="db667-274">必须具有对日志所在清除事件日志条目的计算机的管理员权限。</span><span class="sxs-lookup"><span data-stu-id="db667-274">You must have administrator permissions to the computer on which the log resides to clear event log entries.</span></span>  
  
 <span data-ttu-id="db667-275"><xref:System.Diagnostics.EventLog.Clear%2A> 关闭事件日志、 检索新读取和写入句柄，释放事件句柄，并重新打开事件日志。</span><span class="sxs-lookup"><span data-stu-id="db667-275"><xref:System.Diagnostics.EventLog.Clear%2A> closes the event log, releases the event handles, retrieves new read and write handles, and reopens the event log.</span></span> <span data-ttu-id="db667-276">对方法的调用后收到的事件不会清除与现有事件。</span><span class="sxs-lookup"><span data-stu-id="db667-276">Events received after the call to the method are not cleared along with the existing events.</span></span>  
  
   
  
## Examples  
 <span data-ttu-id="db667-277">以下示例清除事件日志。</span><span class="sxs-lookup"><span data-stu-id="db667-277">The following example clears an event log.</span></span>  
  
> [!CAUTION]
>  <span data-ttu-id="db667-278">由于应用程序、 系统、 安全性和其他非自定义日志可能包含重要信息;请务必执行此示例代码之前指定自定义日志。</span><span class="sxs-lookup"><span data-stu-id="db667-278">Because Application, System, Security, and other non-custom logs can contain crucial information; be sure to specify a custom log before executing this example code.</span></span> <span data-ttu-id="db667-279">此示例将删除自定义日志`myNewLog`。</span><span class="sxs-lookup"><span data-stu-id="db667-279">This example deletes the custom log `myNewLog`.</span></span>  
  
 [!code-cpp[Classic EventLog.Clear Example#1](~/samples/snippets/cpp/VS_Snippets_CLR_Classic/classic EventLog.Clear Example/CPP/source.cpp#1)]
 [!code-csharp[Classic EventLog.Clear Example#1](~/samples/snippets/csharp/VS_Snippets_CLR_Classic/classic EventLog.Clear Example/CS/source.cs#1)]
 [!code-vb[Classic EventLog.Clear Example#1](~/samples/snippets/visualbasic/VS_Snippets_CLR_Classic/classic EventLog.Clear Example/VB/source.vb#1)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ComponentModel.Win32Exception">
          <span data-ttu-id="db667-280">未成功清除事件日志。</span>
          <span class="sxs-lookup">
            <span data-stu-id="db667-280">The event log was not cleared successfully.</span>
          </span>
          <span data-ttu-id="db667-281">或</span>
          <span class="sxs-lookup">
            <span data-stu-id="db667-281">-or-</span>
          </span>
          <span data-ttu-id="db667-282">无法打开日志。</span>
          <span class="sxs-lookup">
            <span data-stu-id="db667-282">The log cannot be opened.</span>
          </span>
          <span data-ttu-id="db667-283">一个 Windows 错误代码不可用。</span>
          <span class="sxs-lookup">
            <span data-stu-id="db667-283">A Windows error code is not available.</span>
          </span>
        </exception>
        <exception cref="T:System.ArgumentException">
          <span data-ttu-id="db667-284">没有为 <see cref="P:System.Diagnostics.EventLog.Log" /> 属性指定值。</span>
          <span class="sxs-lookup">
            <span data-stu-id="db667-284">A value is not specified for the <see cref="P:System.Diagnostics.EventLog.Log" /> property.</span>
          </span>
          <span data-ttu-id="db667-285">确保日志名称不是一个空字符串。</span>
          <span class="sxs-lookup">
            <span data-stu-id="db667-285">Make sure the log name is not an empty string.</span>
          </span>
        </exception>
        <exception cref="T:System.InvalidOperationException">
          <span data-ttu-id="db667-286">该日志不存在。</span>
          <span class="sxs-lookup">
            <span data-stu-id="db667-286">The log does not exist.</span>
          </span>
        </exception>
        <permission cref="T:System.Diagnostics.EventLogPermission">
          <span data-ttu-id="db667-287">用于管理计算机上的事件日志信息。</span>
          <span class="sxs-lookup">
            <span data-stu-id="db667-287">for administering event log information on the computer.</span>
          </span>
          <span data-ttu-id="db667-288">关联的枚举： <see cref="F:System.Diagnostics.EventLogPermissionAccess.Administer" /></span>
          <span class="sxs-lookup">
            <span data-stu-id="db667-288">Associated enumeration: <see cref="F:System.Diagnostics.EventLogPermissionAccess.Administer" /></span>
          </span>
        </permission>
        <altmember cref="M:System.Diagnostics.EventLog.Close" />
        <altmember cref="M:System.Diagnostics.EventLog.Delete(System.String)" />
      </Docs>
    </Member>
    <Member MemberName="Close">
      <MemberSignature Language="C#" Value="public void Close ();" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig instance void Close() cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Diagnostics.EventLog.Close" />
      <MemberSignature Language="VB.NET" Value="Public Sub Close ()" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; void Close();" />
      <MemberSignature Language="F#" Value="member this.Close : unit -&gt; unit" Usage="eventLog.Close " />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System</AssemblyName>
        <AssemblyVersion>1.0.5000.0</AssemblyVersion>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Void</ReturnType>
      </ReturnValue>
      <Parameters />
      <Docs>
        <summary>
          <span data-ttu-id="db667-289">关闭事件日志并释放读写句柄。</span>
          <span class="sxs-lookup">
            <span data-stu-id="db667-289">Closes the event log and releases read and write handles.</span>
          </span>
        </summary>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="db667-290"><xref:System.Diagnostics.EventLog.Close%2A>方法调用的受保护<xref:System.ComponentModel.Component.Dispose%2A>方法。</span><span class="sxs-lookup"><span data-stu-id="db667-290">The <xref:System.Diagnostics.EventLog.Close%2A> method is called by the protected <xref:System.ComponentModel.Component.Dispose%2A> method.</span></span> <span data-ttu-id="db667-291">您不需要调用<xref:System.Diagnostics.EventLog.Close%2A>之前调用<xref:System.ComponentModel.Component.Dispose%2A>。</span><span class="sxs-lookup"><span data-stu-id="db667-291">You do not need to invoke <xref:System.Diagnostics.EventLog.Close%2A> before calling <xref:System.ComponentModel.Component.Dispose%2A>.</span></span>  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ComponentModel.Win32Exception">
          <span data-ttu-id="db667-292">事件日志的读句柄或写句柄未成功释放。</span>
          <span class="sxs-lookup">
            <span data-stu-id="db667-292">The event log's read handle or write handle was not released successfully.</span>
          </span>
        </exception>
        <permission cref="T:System.Diagnostics.EventLogPermission">
          <span data-ttu-id="db667-293">用于写入的计算机上的事件日志信息。</span>
          <span class="sxs-lookup">
            <span data-stu-id="db667-293">for writing the event log information on the computer.</span>
          </span>
          <span data-ttu-id="db667-294">关联的枚举： <see cref="F:System.Diagnostics.EventLogPermissionAccess.Write" /></span>
          <span class="sxs-lookup">
            <span data-stu-id="db667-294">Associated enumeration: <see cref="F:System.Diagnostics.EventLogPermissionAccess.Write" /></span>
          </span>
        </permission>
        <altmember cref="M:System.Diagnostics.EventLog.Delete(System.String)" />
        <altmember cref="M:System.Diagnostics.EventLog.Clear" />
      </Docs>
    </Member>
    <MemberGroup MemberName="CreateEventSource">
      <AssemblyInfo>
        <AssemblyName>System</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Docs>
        <summary>
          <span data-ttu-id="db667-295">建立一个能够将事件信息写入到系统的特定日志中的应用程序。</span>
          <span class="sxs-lookup">
            <span data-stu-id="db667-295">Establishes an application as able to write event information to a particular log on the system.</span>
          </span>
        </summary>
      </Docs>
    </MemberGroup>
    <Member MemberName="CreateEventSource">
      <MemberSignature Language="C#" Value="public static void CreateEventSource (System.Diagnostics.EventSourceCreationData sourceData);" />
      <MemberSignature Language="ILAsm" Value=".method public static hidebysig void CreateEventSource(class System.Diagnostics.EventSourceCreationData sourceData) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Diagnostics.EventLog.CreateEventSource(System.Diagnostics.EventSourceCreationData)" />
      <MemberSignature Language="VB.NET" Value="Public Shared Sub CreateEventSource (sourceData As EventSourceCreationData)" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; static void CreateEventSource(System::Diagnostics::EventSourceCreationData ^ sourceData);" />
      <MemberSignature Language="F#" Value="static member CreateEventSource : System.Diagnostics.EventSourceCreationData -&gt; unit" Usage="System.Diagnostics.EventLog.CreateEventSource sourceData" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System</AssemblyName>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Attributes>
        <Attribute FrameworkAlternate="xamarinmac-3.0">
          <AttributeName>System.MonoNotSupported("remote machine is not supported")</AttributeName>
        </Attribute>
      </Attributes>
      <ReturnValue>
        <ReturnType>System.Void</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="sourceData" Type="System.Diagnostics.EventSourceCreationData" />
      </Parameters>
      <Docs>
        <param name="sourceData">
          <span data-ttu-id="db667-296">事件源及其目标事件日志的配置属性。</span>
          <span class="sxs-lookup">
            <span data-stu-id="db667-296">The configuration properties for the event source and its target event log.</span>
          </span>
        </param>
        <summary>
          <span data-ttu-id="db667-297">通过使用为该事件源和对应的事件日志指定的配置属性，建立一个写入本地化事件消息的有效事件源。</span>
          <span class="sxs-lookup">
            <span data-stu-id="db667-297">Establishes a valid event source for writing localized event messages, using the specified configuration properties for the event source and the corresponding event log.</span>
          </span>
        </summary>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="db667-298">此重载用于配置新的本地计算机或远程计算机上写入事件日志条目源。</span><span class="sxs-lookup"><span data-stu-id="db667-298">Use this overload to configure a new source for writing entries to an event log on the local computer or a remote computer.</span></span> <span data-ttu-id="db667-299">不需要使用此方法来读取事件日志。</span><span class="sxs-lookup"><span data-stu-id="db667-299">It is not necessary to use this method to read from an event log.</span></span>  
  
 <span data-ttu-id="db667-300"><xref:System.Diagnostics.EventLog.CreateEventSource%2A>方法使用输入`sourceData` <xref:System.Diagnostics.EventSourceCreationData.Source%2A>，<xref:System.Diagnostics.EventSourceCreationData.LogName%2A>和<xref:System.Diagnostics.EventSourceCreationData.MachineName%2A>属性，以在新的源和其关联的事件日志的目标计算机上创建注册表值。</span><span class="sxs-lookup"><span data-stu-id="db667-300">The <xref:System.Diagnostics.EventLog.CreateEventSource%2A> method uses the input `sourceData`<xref:System.Diagnostics.EventSourceCreationData.Source%2A>, <xref:System.Diagnostics.EventSourceCreationData.LogName%2A> and <xref:System.Diagnostics.EventSourceCreationData.MachineName%2A> properties to create registry values on the target computer for the new source and its associated event log.</span></span> <span data-ttu-id="db667-301">新的源名称不能与现有的源名称或目标计算机上的现有事件日志名称匹配。</span><span class="sxs-lookup"><span data-stu-id="db667-301">A new source name cannot match an existing source name or an existing event log name on the target computer.</span></span> <span data-ttu-id="db667-302">如果<xref:System.Diagnostics.EventSourceCreationData.LogName%2A>属性未设置，为应用程序事件日志注册源。</span><span class="sxs-lookup"><span data-stu-id="db667-302">If the <xref:System.Diagnostics.EventSourceCreationData.LogName%2A> property is not set, the source is registered for the Application event log.</span></span> <span data-ttu-id="db667-303">如果<xref:System.Diagnostics.EventSourceCreationData.MachineName%2A>未设置，在本地计算机上注册了源。</span><span class="sxs-lookup"><span data-stu-id="db667-303">If the <xref:System.Diagnostics.EventSourceCreationData.MachineName%2A> is not set, the source is registered on the local computer.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="db667-304">若要创建的事件源在 Windows Vista 及更高版本或 Windows Server 2003，必须具有管理权限。</span><span class="sxs-lookup"><span data-stu-id="db667-304">To create an event source in Windows Vista and later or Windows Server 2003, you must have administrative privileges.</span></span>  
>   
>  <span data-ttu-id="db667-305">这一要求的原因是必须搜索所有事件日志，包括安全性，以确定事件源是否唯一。</span><span class="sxs-lookup"><span data-stu-id="db667-305">The reason for this requirement is that all event logs, including security, must be searched to determine whether the event source is unique.</span></span> <span data-ttu-id="db667-306">从 Windows Vista 开始，用户没有权限访问该安全日志。因此，<xref:System.Security.SecurityException>引发。</span><span class="sxs-lookup"><span data-stu-id="db667-306">Starting with Windows Vista, users do not have permission to access the security log; therefore, a <xref:System.Security.SecurityException> is thrown.</span></span>  
>   
>  <span data-ttu-id="db667-307">从 Windows Vista 开始，用户帐户控制 (UAC) 决定用户的特权。</span><span class="sxs-lookup"><span data-stu-id="db667-307">Starting with Windows Vista, User Account Control (UAC) determines the privileges of a user.</span></span> <span data-ttu-id="db667-308">如果您是内置的 Administrators 组的成员，将为您分配两个运行时访问令牌：一个标准用户访问令牌和一个管理员访问令牌。</span><span class="sxs-lookup"><span data-stu-id="db667-308">If you are a member of the Built-in Administrators group, you are assigned two run-time access tokens: a standard user access token and an administrator access token.</span></span> <span data-ttu-id="db667-309">默认情况下，您拥有标准用户角色。</span><span class="sxs-lookup"><span data-stu-id="db667-309">By default, you are in the standard user role.</span></span> <span data-ttu-id="db667-310">若要执行的代码访问安全日志，首先必须将你的特权从标准用户提升至管理员。</span><span class="sxs-lookup"><span data-stu-id="db667-310">To execute the code that accesses the security log, you must first elevate your privileges from standard user to administrator.</span></span> <span data-ttu-id="db667-311">你可以通过以下方式执行此操作：右键单击应用程序图标并指示需以管理员身份运行。</span><span class="sxs-lookup"><span data-stu-id="db667-311">You can do this when you start an application by right-clicking the application icon and indicating that you want to run as an administrator.</span></span>  
  
 <span data-ttu-id="db667-312">使用<xref:System.Diagnostics.EventLog.WriteEvent%2A>和<xref:System.Diagnostics.EventLog.WriteEntry%2A>将事件写入到事件日志。</span><span class="sxs-lookup"><span data-stu-id="db667-312">Use <xref:System.Diagnostics.EventLog.WriteEvent%2A> and <xref:System.Diagnostics.EventLog.WriteEntry%2A> to write events to an event log.</span></span> <span data-ttu-id="db667-313">必须指定事件源写入事件;必须创建并写入与源的第一项之前配置的事件源。</span><span class="sxs-lookup"><span data-stu-id="db667-313">You must specify an event source to write events; you must create and configure the event source before writing the first entry with the source.</span></span>  
  
 <span data-ttu-id="db667-314">在应用程序的安装过程中创建新的事件源。</span><span class="sxs-lookup"><span data-stu-id="db667-314">Create the new event source during the installation of your application.</span></span> <span data-ttu-id="db667-315">这允许操作系统以刷新其注册的事件源的列表和其配置的时间。</span><span class="sxs-lookup"><span data-stu-id="db667-315">This allows time for the operating system to refresh its list of registered event sources and their configuration.</span></span> <span data-ttu-id="db667-316">如果操作系统没有刷新其事件源的列表，并且尝试写入新的源的事件写入操作将失败。</span><span class="sxs-lookup"><span data-stu-id="db667-316">If the operating system has not refreshed its list of event sources, and you attempt to write an event with the new source, the write operation will fail.</span></span> <span data-ttu-id="db667-317">可以配置新的源使用<xref:System.Diagnostics.EventLogInstaller>，或使用<xref:System.Diagnostics.EventLog.CreateEventSource%2A>方法。</span><span class="sxs-lookup"><span data-stu-id="db667-317">You can configure a new source using an <xref:System.Diagnostics.EventLogInstaller>, or using the <xref:System.Diagnostics.EventLog.CreateEventSource%2A> method.</span></span> <span data-ttu-id="db667-318">若要创建新的事件源的计算机上，必须具有管理权限。</span><span class="sxs-lookup"><span data-stu-id="db667-318">You must have administrative rights on the computer to create a new event source.</span></span>  
  
 <span data-ttu-id="db667-319">可以创建现有事件日志或新的事件日志的事件源。</span><span class="sxs-lookup"><span data-stu-id="db667-319">You can create an event source for an existing event log or a new event log.</span></span> <span data-ttu-id="db667-320">创建新的源为新的事件日志时，系统注册该日志的源，但直到第一个条目写入不创建该日志。</span><span class="sxs-lookup"><span data-stu-id="db667-320">When you create a new source for a new event log, the system registers the source for that log, but the log is not created until the first entry is written to it.</span></span>  
  
 <span data-ttu-id="db667-321">操作系统将事件日志存储为文件。</span><span class="sxs-lookup"><span data-stu-id="db667-321">The operating system stores event logs as files.</span></span> <span data-ttu-id="db667-322">当你使用<xref:System.Diagnostics.EventLogInstaller>或<xref:System.Diagnostics.EventLog.CreateEventSource%2A>若要创建新的事件日志，关联的文件存储在指定计算机上的 %SystemRoot%\System32\Config 目录。</span><span class="sxs-lookup"><span data-stu-id="db667-322">When you use <xref:System.Diagnostics.EventLogInstaller> or <xref:System.Diagnostics.EventLog.CreateEventSource%2A> to create a new event log, the associated file is stored in the %SystemRoot%\System32\Config directory on the specified computer.</span></span> <span data-ttu-id="db667-323">通过追加的前 8 个字符设置的文件名称<xref:System.Diagnostics.EventLog.Log%2A>".evt"文件扩展名的属性。</span><span class="sxs-lookup"><span data-stu-id="db667-323">The file name is set by appending the first 8 characters of the <xref:System.Diagnostics.EventLog.Log%2A> property with the ".evt" file name extension.</span></span>  
  
 <span data-ttu-id="db667-324">每个源只能写入到事件日志中只有一个一次;但是，你的应用程序可以使用多个源写入多个事件日志。</span><span class="sxs-lookup"><span data-stu-id="db667-324">Each source can only write to only one event log at a time; however, your application can use multiple sources to write to multiple event logs.</span></span> <span data-ttu-id="db667-325">例如，你的应用程序可能需要多个源配置为使用不同的事件日志或不同的资源文件。</span><span class="sxs-lookup"><span data-stu-id="db667-325">For example, your application might require multiple sources configured for different event logs or different resource files.</span></span>  
  
 <span data-ttu-id="db667-326">为事件类别和消息字符串，可以使用本地化的资源文件注册事件源。</span><span class="sxs-lookup"><span data-stu-id="db667-326">You can register the event source with localized resource file(s) for your event category and message strings.</span></span> <span data-ttu-id="db667-327">你的应用程序可以写入事件日志项使用资源标识符，而不指定实际的字符串。</span><span class="sxs-lookup"><span data-stu-id="db667-327">Your application can write event log entries using resource identifiers, rather than specifying the actual string.</span></span> <span data-ttu-id="db667-328">事件查看器使用的资源标识符来查找并显示基于当前语言设置的本地化的资源文件中的相应字符串。</span><span class="sxs-lookup"><span data-stu-id="db667-328">The Event Viewer uses the resource identifier to find and display the corresponding string from the localized resource file based on current language settings.</span></span> <span data-ttu-id="db667-329">可以注册一个单独的文件，有关事件类别、 消息和参数插入字符串，也可以注册相同的资源文件，所有三种类型的字符串。</span><span class="sxs-lookup"><span data-stu-id="db667-329">You can register a separate file for event categories, messages and parameter insertion strings, or you can register the same resource file for all three types of strings.</span></span> <span data-ttu-id="db667-330">使用<xref:System.Diagnostics.EventSourceCreationData.CategoryCount%2A>， <xref:System.Diagnostics.EventSourceCreationData.CategoryResourceFile%2A>， <xref:System.Diagnostics.EventSourceCreationData.MessageResourceFile%2A>，和<xref:System.Diagnostics.EventSourceCreationData.ParameterResourceFile%2A>属性来配置要本地化的项写入事件日志的源。</span><span class="sxs-lookup"><span data-stu-id="db667-330">Use the <xref:System.Diagnostics.EventSourceCreationData.CategoryCount%2A>, <xref:System.Diagnostics.EventSourceCreationData.CategoryResourceFile%2A>, <xref:System.Diagnostics.EventSourceCreationData.MessageResourceFile%2A>, and <xref:System.Diagnostics.EventSourceCreationData.ParameterResourceFile%2A> properties to configure the source to write localized entries to the event log.</span></span> <span data-ttu-id="db667-331">如果你的应用程序直接将字符串值写入事件日志，您不需要设置这些属性。</span><span class="sxs-lookup"><span data-stu-id="db667-331">If your application writes strings values directly to the event log, you do not need to set these properties.</span></span>  
  
 <span data-ttu-id="db667-332">要写入本地化的项还是要直接写入字符串，必须配置源。</span><span class="sxs-lookup"><span data-stu-id="db667-332">The source must be configured either for writing localized entries or for writing direct strings.</span></span> <span data-ttu-id="db667-333">如果你的应用程序将使用资源标识符和字符串值的条目写入，则必须注册两个单独的源。</span><span class="sxs-lookup"><span data-stu-id="db667-333">If your application writes entries using both resource identifiers and string values, you must register two separate sources.</span></span> <span data-ttu-id="db667-334">例如，配置一个源的资源文件，以及如何将该源中的<xref:System.Diagnostics.EventLog.WriteEvent%2A>方法来编写使用资源标识符添加到事件日志条目。</span><span class="sxs-lookup"><span data-stu-id="db667-334">For example, configure one source with resource files, and then use that source in the <xref:System.Diagnostics.EventLog.WriteEvent%2A> method to write entries using resource identifiers to the event log.</span></span> <span data-ttu-id="db667-335">然后创建不同的源，而无需资源文件，并使用在该源<xref:System.Diagnostics.EventLog.WriteEntry%2A>方法将字符串直接写入事件日志使用的源。</span><span class="sxs-lookup"><span data-stu-id="db667-335">Then create a different source without resource files, and use that source in the <xref:System.Diagnostics.EventLog.WriteEntry%2A> method to write strings directly to the event log using that source.</span></span>  
  
 <span data-ttu-id="db667-336">若要更改现有源的配置详细信息，必须删除源，然后使用新的配置创建它。</span><span class="sxs-lookup"><span data-stu-id="db667-336">To change the configuration details of an existing source, you must delete the source and then create it with the new configuration.</span></span> <span data-ttu-id="db667-337">如果其他应用程序或组件使用现有的源，请使用更新的配置，而无需删除现有源创建新的源。</span><span class="sxs-lookup"><span data-stu-id="db667-337">If other applications or components use the existing source, create a new source with the updated configuration rather than deleting the existing source.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="db667-338">如果源配置为事件日志，并重新配置为另一个事件日志，必须重新启动计算机更改才能生效。</span><span class="sxs-lookup"><span data-stu-id="db667-338">If a source is configured for an event log, and you reconfigure it for another event log, you must restart the computer for the changes to take effect.</span></span>  
  
   
  
## Examples  
 <span data-ttu-id="db667-339">下面的示例确定是否在事件源名为`SampleApplicationSource`在本地计算机上注册。</span><span class="sxs-lookup"><span data-stu-id="db667-339">The following example determines whether the event source named `SampleApplicationSource` is registered on the local computer.</span></span> <span data-ttu-id="db667-340">如果事件源不存在，该示例设置源的消息资源文件，并创建新的事件源。</span><span class="sxs-lookup"><span data-stu-id="db667-340">If the event source does not exist, the example sets the message resource file for the source and creates the new event source.</span></span> <span data-ttu-id="db667-341">最后，该示例设置使用中的资源标识符值的事件日志的本地化的显示名称`DisplayNameMsgId`中的资源文件路径和`messageFile`。</span><span class="sxs-lookup"><span data-stu-id="db667-341">Finally, the example sets the localized display name for the event log, using the resource identifier value in `DisplayNameMsgId` and the resource file path in `messageFile`.</span></span>  
  
 [!code-cpp[EventLog_WriteEvent#6](~/samples/snippets/cpp/VS_Snippets_CLR/eventlog_WriteEvent/CPP/source.cpp#6)]
 [!code-csharp[EventLog_WriteEvent#6](~/samples/snippets/csharp/VS_Snippets_CLR/eventlog_WriteEvent/CS/source.cs#6)]
 [!code-vb[EventLog_WriteEvent#6](~/samples/snippets/visualbasic/VS_Snippets_CLR/eventlog_WriteEvent/VB/source.vb#6)]  
  
 <span data-ttu-id="db667-342">该示例使用下面的消息文本文件，内置的资源库 EventLogMsgs.dll。</span><span class="sxs-lookup"><span data-stu-id="db667-342">The example uses the following message text file, built into the resource library EventLogMsgs.dll.</span></span> <span data-ttu-id="db667-343">消息文本文件是从其创建的消息资源文件的源。</span><span class="sxs-lookup"><span data-stu-id="db667-343">A message text file is the source from which the message resource file is created.</span></span> <span data-ttu-id="db667-344">消息文本文件定义的资源标识符和类别、 事件消息和参数插入字符串的文本。</span><span class="sxs-lookup"><span data-stu-id="db667-344">The message text file defines the resource identifiers and text for the category, event message, and parameter insertion strings.</span></span> <span data-ttu-id="db667-345">具体而言，为事件日志的本地化名称定义了资源标识符为 5001。</span><span class="sxs-lookup"><span data-stu-id="db667-345">Specifically, resource identifier 5001 is defined for the localized name of the event log.</span></span>  
  
```  
; // EventLogMsgs.mc  
; // ********************************************************  
  
; // Use the following commands to build this file:  
  
; //   mc -s EventLogMsgs.mc  
; //   rc EventLogMsgs.rc  
; //   link /DLL /SUBSYSTEM:WINDOWS /NOENTRY /MACHINE:x86 EventLogMsgs.Res   
; // ********************************************************  
  
; // - Event categories -  
; // Categories must be numbered consecutively starting at 1.  
; // ********************************************************  
  
MessageId=0x1  
Severity=Success  
SymbolicName=INSTALL_CATEGORY  
Language=English  
Installation  
.  
  
MessageId=0x2  
Severity=Success  
SymbolicName=QUERY_CATEGORY  
Language=English  
Database Query  
.  
  
MessageId=0x3  
Severity=Success  
SymbolicName=REFRESH_CATEGORY  
Language=English  
Data Refresh  
.  
  
; // - Event messages -  
; // *********************************  
  
MessageId = 1000  
Severity = Success  
Facility = Application  
SymbolicName = AUDIT_SUCCESS_MESSAGE_ID_1000  
Language=English  
My application message text, in English, for message id 1000, called from %1.  
.  
  
MessageId = 1001  
Severity = Warning  
Facility = Application  
SymbolicName = AUDIT_FAILED_MESSAGE_ID_1001  
Language=English  
My application message text, in English, for message id 1001, called from %1.  
.  
  
MessageId = 1002  
Severity = Success  
Facility = Application  
SymbolicName = GENERIC_INFO_MESSAGE_ID_1002  
Language=English  
My generic information message in English, for message id 1002.  
.  
  
MessageId = 1003  
Severity = Warning  
Facility = Application  
SymbolicName = GENERIC_WARNING_MESSAGE_ID_1003  
Language=English  
My generic warning message in English, for message id 1003, called from %1.  
.  
  
MessageId = 1004  
Severity = Success  
Facility = Application  
SymbolicName = UPDATE_CYCLE_COMPLETE_MESSAGE_ID_1004  
Language=English  
The update cycle is complete for %%5002.  
.  
  
MessageId = 1005  
Severity = Warning  
Facility = Application  
SymbolicName = SERVER_CONNECTION_DOWN_MESSAGE_ID_1005  
Language=English  
The refresh operation did not complete because the connection to server %1 could not be established.  
.  
  
; // - Event log display name -  
; // ********************************************************  
  
MessageId = 5001  
Severity = Success  
Facility = Application  
SymbolicName = EVENT_LOG_DISPLAY_NAME_MSGID  
Language=English  
Sample Event Log  
.  
  
; // - Event message parameters -  
; //   Language independent insertion strings  
; // ********************************************************  
  
MessageId = 5002  
Severity = Success  
Facility = Application  
SymbolicName = EVENT_LOG_SERVICE_NAME_MSGID  
Language=English  
SVC_UPDATE.EXE  
.  
```  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentException">
          <span data-ttu-id="db667-346">在 <paramref name="sourceData" /> 中指定的计算机名称无效。</span>
          <span class="sxs-lookup">
            <span data-stu-id="db667-346">The computer name specified in <paramref name="sourceData" /> is not valid.</span>
          </span>
          <span data-ttu-id="db667-347">\- 或 -</span>
          <span class="sxs-lookup">
            <span data-stu-id="db667-347">\- or -</span>
          </span>
          <span data-ttu-id="db667-348">在 <paramref name="sourceData" /> 中指定的源名称为 <see langword="null" />。</span>
          <span class="sxs-lookup">
            <span data-stu-id="db667-348">The source name specified in <paramref name="sourceData" /> is <see langword="null" />.</span>
          </span>
          <span data-ttu-id="db667-349">\- 或 -</span>
          <span class="sxs-lookup">
            <span data-stu-id="db667-349">\- or -</span>
          </span>
          <span data-ttu-id="db667-350">在 <paramref name="sourceData" /> 中指定的日志名称无效。</span>
          <span class="sxs-lookup">
            <span data-stu-id="db667-350">The log name specified in <paramref name="sourceData" /> is not valid.</span>
          </span>
          <span data-ttu-id="db667-351">事件日志名称必须由可打印字符组成，且不得包含字符“\*”、“?”或“\\”。</span>
          <span class="sxs-lookup">
            <span data-stu-id="db667-351">Event log names must consist of printable characters and cannot include the characters '\*', '?', or '\\'.</span>
          </span>
          <span data-ttu-id="db667-352">\- 或 -</span>
          <span class="sxs-lookup">
            <span data-stu-id="db667-352">\- or -</span>
          </span>
          <span data-ttu-id="db667-353">在 <paramref name="sourceData" /> 中指定的日志名称对用户日志创建无效。</span>
          <span class="sxs-lookup">
            <span data-stu-id="db667-353">The log name specified in <paramref name="sourceData" /> is not valid for user log creation.</span>
          </span>
          <span data-ttu-id="db667-354">事件日志名称 AppEvent、SysEvent 和 SecEvent 是保留为系统使用的。</span>
          <span class="sxs-lookup">
            <span data-stu-id="db667-354">The Event log names AppEvent, SysEvent, and SecEvent are reserved for system use.</span>
          </span>
          <span data-ttu-id="db667-355">\- 或 -</span>
          <span class="sxs-lookup">
            <span data-stu-id="db667-355">\- or -</span>
          </span>
          <span data-ttu-id="db667-356">该日志名称与一个现有事件源名称相匹配。</span>
          <span class="sxs-lookup">
            <span data-stu-id="db667-356">The log name matches an existing event source name.</span>
          </span>
          <span data-ttu-id="db667-357">\- 或 -</span>
          <span class="sxs-lookup">
            <span data-stu-id="db667-357">\- or -</span>
          </span>
          <span data-ttu-id="db667-358">在 <paramref name="sourceData" /> 中指定的源名称导致注册表项路径的长度超过 254 个字符。</span>
          <span class="sxs-lookup">
            <span data-stu-id="db667-358">The source name specified in <paramref name="sourceData" /> results in a registry key path longer than 254 characters.</span>
          </span>
          <span data-ttu-id="db667-359">\- 或 -</span>
          <span class="sxs-lookup">
            <span data-stu-id="db667-359">\- or -</span>
          </span>
          <span data-ttu-id="db667-360">在 <paramref name="sourceData" /> 中指定的日志名称的前 8 个字符不唯一。</span>
          <span class="sxs-lookup">
            <span data-stu-id="db667-360">The first 8 characters of the log name specified in <paramref name="sourceData" /> are not unique.</span>
          </span>
          <span data-ttu-id="db667-361">\- 或 -</span>
          <span class="sxs-lookup">
            <span data-stu-id="db667-361">\- or -</span>
          </span>
          <span data-ttu-id="db667-362">在 <paramref name="sourceData" /> 中指定的源名称已经注册过。</span>
          <span class="sxs-lookup">
            <span data-stu-id="db667-362">The source name specified in <paramref name="sourceData" /> is already registered.</span>
          </span>
          <span data-ttu-id="db667-363">\- 或 -</span>
          <span class="sxs-lookup">
            <span data-stu-id="db667-363">\- or -</span>
          </span>
          <span data-ttu-id="db667-364">在 <paramref name="sourceData" /> 中指定的源名称与一个现有事件日志名称相匹配。</span>
          <span class="sxs-lookup">
            <span data-stu-id="db667-364">The source name specified in <paramref name="sourceData" /> matches an existing event log name.</span>
          </span>
        </exception>
        <exception cref="T:System.InvalidOperationException">
          <span data-ttu-id="db667-365">事件日志的注册表项未能打开。</span>
          <span class="sxs-lookup">
            <span data-stu-id="db667-365">The registry key for the event log could not be opened.</span>
          </span>
        </exception>
        <exception cref="T:System.ArgumentNullException">
          <span data-ttu-id="db667-366">
            <paramref name="sourceData" /> 为 <see langword="null" />。</span>
          <span class="sxs-lookup">
            <span data-stu-id="db667-366">
              <paramref name="sourceData" /> is <see langword="null" />.</span>
          </span>
        </exception>
        <permission cref="T:System.Diagnostics.EventLogPermission">
          <span data-ttu-id="db667-367">用于管理计算机上的事件日志信息。</span>
          <span class="sxs-lookup">
            <span data-stu-id="db667-367">for administering event log information on the computer.</span>
          </span>
          <span data-ttu-id="db667-368">关联的枚举： <see cref="F:System.Diagnostics.EventLogPermissionAccess.Administer" /></span>
          <span class="sxs-lookup">
            <span data-stu-id="db667-368">Associated enumeration: <see cref="F:System.Diagnostics.EventLogPermissionAccess.Administer" /></span>
          </span>
        </permission>
        <altmember cref="T:System.Diagnostics.EventSourceCreationData" />
        <altmember cref="M:System.Diagnostics.EventLog.SourceExists(System.String)" />
        <altmember cref="M:System.Diagnostics.EventLog.DeleteEventSource(System.String)" />
        <altmember cref="P:System.Diagnostics.EventLog.Source" />
        <altmember cref="T:System.Diagnostics.EventLogInstaller" />
      </Docs>
    </Member>
    <Member MemberName="CreateEventSource">
      <MemberSignature Language="C#" Value="public static void CreateEventSource (string source, string logName);" />
      <MemberSignature Language="ILAsm" Value=".method public static hidebysig void CreateEventSource(string source, string logName) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Diagnostics.EventLog.CreateEventSource(System.String,System.String)" />
      <MemberSignature Language="VB.NET" Value="Public Shared Sub CreateEventSource (source As String, logName As String)" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; static void CreateEventSource(System::String ^ source, System::String ^ logName);" />
      <MemberSignature Language="F#" Value="static member CreateEventSource : string * string -&gt; unit" Usage="System.Diagnostics.EventLog.CreateEventSource (source, logName)" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System</AssemblyName>
        <AssemblyVersion>1.0.5000.0</AssemblyVersion>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Void</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="source" Type="System.String" />
        <Parameter Name="logName" Type="System.String" />
      </Parameters>
      <Docs>
        <param name="source">
          <span data-ttu-id="db667-369">应用程序在本地计算机上注册时所采用的源名称。</span>
          <span class="sxs-lookup">
            <span data-stu-id="db667-369">The source name by which the application is registered on the local computer.</span>
          </span>
        </param>
        <param name="logName">
          <span data-ttu-id="db667-370">源的项写入的日志名。</span>
          <span class="sxs-lookup">
            <span data-stu-id="db667-370">The name of the log the source's entries are written to.</span>
          </span>
          <span data-ttu-id="db667-371">可能的值包括“应用程序”、“系统”或自定义事件日志。</span>
          <span class="sxs-lookup">
            <span data-stu-id="db667-371">Possible values include Application, System, or a custom event log.</span>
          </span>
        </param>
        <summary>
          <span data-ttu-id="db667-372">建立指定的源名称作为向本地计算机上的日志中写入日志项的有效事件源。</span>
          <span class="sxs-lookup">
            <span data-stu-id="db667-372">Establishes the specified source name as a valid event source for writing entries to a log on the local computer.</span>
          </span>
          <span data-ttu-id="db667-373">此方法还可在本地计算机上创建一个新的自定义日志。</span>
          <span class="sxs-lookup">
            <span data-stu-id="db667-373">This method can also create a new custom log on the local computer.</span>
          </span>
        </summary>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="db667-374">使用此重载创建自定义日志或创建并注册<xref:System.Diagnostics.EventLog.Source%2A>向本地计算机上现有的日志。</span><span class="sxs-lookup"><span data-stu-id="db667-374">Use this overload to create a custom log or to create and register a <xref:System.Diagnostics.EventLog.Source%2A> to an existing log on the local computer.</span></span>  
  
 <span data-ttu-id="db667-375">如果`logName`是`null`或空字符串 ("") 时调用<xref:System.Diagnostics.EventLog.CreateEventSource%2A>，日志将默认为应用程序日志。</span><span class="sxs-lookup"><span data-stu-id="db667-375">If `logName` is `null` or an empty string ("") when you call <xref:System.Diagnostics.EventLog.CreateEventSource%2A>, the log defaults to the Application log.</span></span> <span data-ttu-id="db667-376">如果在本地计算机上不存在该日志，系统创建自定义日志，并注册应用程序作为<xref:System.Diagnostics.EventLog.Source%2A>为该日志。</span><span class="sxs-lookup"><span data-stu-id="db667-376">If the log does not exist on the local computer, the system creates a custom log and registers your application as a <xref:System.Diagnostics.EventLog.Source%2A> for that log.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="db667-377">若要创建的事件源在 Windows Vista 及更高版本或 Windows Server 2003，必须具有管理权限。</span><span class="sxs-lookup"><span data-stu-id="db667-377">To create an event source in Windows Vista and later or Windows Server 2003, you must have administrative privileges.</span></span>  
>   
>  <span data-ttu-id="db667-378">这一要求的原因是必须搜索所有事件日志，包括安全性，以确定事件源是否唯一。</span><span class="sxs-lookup"><span data-stu-id="db667-378">The reason for this requirement is that all event logs, including security, must be searched to determine whether the event source is unique.</span></span> <span data-ttu-id="db667-379">从 Windows Vista 开始，用户没有权限访问该安全日志。因此，<xref:System.Security.SecurityException>引发。</span><span class="sxs-lookup"><span data-stu-id="db667-379">Starting with Windows Vista, users do not have permission to access the security log; therefore, a <xref:System.Security.SecurityException> is thrown.</span></span>  
>   
>  <span data-ttu-id="db667-380">在 Windows Vista 或更高版本中，用户帐户控制 (UAC) 决定用户的特权。</span><span class="sxs-lookup"><span data-stu-id="db667-380">In Windows Vista and later, User Account Control (UAC) determines the privileges of a user.</span></span> <span data-ttu-id="db667-381">如果您是内置的 Administrators 组的成员，将为您分配两个运行时访问令牌：一个标准用户访问令牌和一个管理员访问令牌。</span><span class="sxs-lookup"><span data-stu-id="db667-381">If you are a member of the Built-in Administrators group, you are assigned two run-time access tokens: a standard user access token and an administrator access token.</span></span> <span data-ttu-id="db667-382">默认情况下，您拥有标准用户角色。</span><span class="sxs-lookup"><span data-stu-id="db667-382">By default, you are in the standard user role.</span></span> <span data-ttu-id="db667-383">若要执行的代码访问安全日志，首先必须将你的特权从标准用户提升至管理员。</span><span class="sxs-lookup"><span data-stu-id="db667-383">To execute the code that accesses the security log, you must first elevate your privileges from standard user to administrator.</span></span> <span data-ttu-id="db667-384">你可以通过以下方式执行此操作：右键单击应用程序图标并指示需以管理员身份运行。</span><span class="sxs-lookup"><span data-stu-id="db667-384">You can do this when you start an application by right-clicking the application icon and indicating that you want to run as an administrator.</span></span>  
  
 <span data-ttu-id="db667-385">只需创建事件源，如果将写入事件日志。</span><span class="sxs-lookup"><span data-stu-id="db667-385">You only need to create an event source if you are writing to the event log.</span></span> <span data-ttu-id="db667-386">之前向事件日志写入条目，您必须注册事件源的事件日志作为有效的事件源。</span><span class="sxs-lookup"><span data-stu-id="db667-386">Before writing an entry to an event log, you must register the event source with the event log as a valid source of events.</span></span> <span data-ttu-id="db667-387">写入日志条目时，系统会将<xref:System.Diagnostics.EventLog.Source%2A>以查找要在其中放置您的输入相应的日志。</span><span class="sxs-lookup"><span data-stu-id="db667-387">When you write a log entry, the system uses the <xref:System.Diagnostics.EventLog.Source%2A> to find the appropriate log in which to place your entry.</span></span> <span data-ttu-id="db667-388">如果您正在读取事件日志，您可以指定<xref:System.Diagnostics.EventLog.Source%2A>，或<xref:System.Diagnostics.EventLog.Log%2A>和<xref:System.Diagnostics.EventLog.MachineName%2A>。</span><span class="sxs-lookup"><span data-stu-id="db667-388">If you are reading the event log, you can either specify the <xref:System.Diagnostics.EventLog.Source%2A>, or a <xref:System.Diagnostics.EventLog.Log%2A> and <xref:System.Diagnostics.EventLog.MachineName%2A>.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="db667-389">您不需要指定<xref:System.Diagnostics.EventLog.MachineName%2A>如果要连接到本地计算机上的日志。</span><span class="sxs-lookup"><span data-stu-id="db667-389">You are not required to specify the <xref:System.Diagnostics.EventLog.MachineName%2A> if you are connecting to a log on the local computer.</span></span> <span data-ttu-id="db667-390">如果未指定<xref:System.Diagnostics.EventLog.MachineName%2A>时从日志中读取，本地计算机 ("。") 假定。</span><span class="sxs-lookup"><span data-stu-id="db667-390">If you do not specify the <xref:System.Diagnostics.EventLog.MachineName%2A> when reading from a log, the local computer (".") is assumed.</span></span>  
  
 <span data-ttu-id="db667-391">使用<xref:System.Diagnostics.EventLog.WriteEvent%2A>和<xref:System.Diagnostics.EventLog.WriteEntry%2A>将事件写入到事件日志。</span><span class="sxs-lookup"><span data-stu-id="db667-391">Use <xref:System.Diagnostics.EventLog.WriteEvent%2A> and <xref:System.Diagnostics.EventLog.WriteEntry%2A> to write events to an event log.</span></span> <span data-ttu-id="db667-392">必须指定事件源写入事件;必须创建并写入与源的第一项之前配置的事件源。</span><span class="sxs-lookup"><span data-stu-id="db667-392">You must specify an event source to write events; you must create and configure the event source before writing the first entry with the source.</span></span>  
  
 <span data-ttu-id="db667-393">在应用程序的安装过程中创建新的事件源。</span><span class="sxs-lookup"><span data-stu-id="db667-393">Create the new event source during the installation of your application.</span></span> <span data-ttu-id="db667-394">这允许操作系统以刷新其注册的事件源的列表和其配置的时间。</span><span class="sxs-lookup"><span data-stu-id="db667-394">This allows time for the operating system to refresh its list of registered event sources and their configuration.</span></span> <span data-ttu-id="db667-395">如果操作系统没有刷新其事件源的列表，并且尝试写入新的源的事件写入操作将失败。</span><span class="sxs-lookup"><span data-stu-id="db667-395">If the operating system has not refreshed its list of event sources, and you attempt to write an event with the new source, the write operation will fail.</span></span> <span data-ttu-id="db667-396">可以配置新的源使用<xref:System.Diagnostics.EventLogInstaller>，或使用<xref:System.Diagnostics.EventLog.CreateEventSource%2A>方法。</span><span class="sxs-lookup"><span data-stu-id="db667-396">You can configure a new source using an <xref:System.Diagnostics.EventLogInstaller>, or using the <xref:System.Diagnostics.EventLog.CreateEventSource%2A> method.</span></span> <span data-ttu-id="db667-397">若要创建新的事件源的计算机上，必须具有管理权限。</span><span class="sxs-lookup"><span data-stu-id="db667-397">You must have administrative rights on the computer to create a new event source.</span></span>  
  
 <span data-ttu-id="db667-398">可以创建现有事件日志或新的事件日志的事件源。</span><span class="sxs-lookup"><span data-stu-id="db667-398">You can create an event source for an existing event log or a new event log.</span></span> <span data-ttu-id="db667-399">创建新的源为新的事件日志时，系统注册该日志的源，但直到第一个条目写入不创建该日志。</span><span class="sxs-lookup"><span data-stu-id="db667-399">When you create a new source for a new event log, the system registers the source for that log, but the log is not created until the first entry is written to it.</span></span>  
  
 <span data-ttu-id="db667-400">操作系统将事件日志存储为文件。</span><span class="sxs-lookup"><span data-stu-id="db667-400">The operating system stores event logs as files.</span></span> <span data-ttu-id="db667-401">当你使用<xref:System.Diagnostics.EventLogInstaller>或<xref:System.Diagnostics.EventLog.CreateEventSource%2A>若要创建新的事件日志，关联的文件存储在指定计算机上的 %SystemRoot%\System32\Config 目录。</span><span class="sxs-lookup"><span data-stu-id="db667-401">When you use <xref:System.Diagnostics.EventLogInstaller> or <xref:System.Diagnostics.EventLog.CreateEventSource%2A> to create a new event log, the associated file is stored in the %SystemRoot%\System32\Config directory on the specified computer.</span></span> <span data-ttu-id="db667-402">通过追加的前 8 个字符设置的文件名称<xref:System.Diagnostics.EventLog.Log%2A>".evt"文件扩展名的属性。</span><span class="sxs-lookup"><span data-stu-id="db667-402">The file name is set by appending the first 8 characters of the <xref:System.Diagnostics.EventLog.Log%2A> property with the ".evt" file name extension.</span></span>  
  
 <span data-ttu-id="db667-403">源必须是本地计算机; 上唯一新的源名称不能与现有的源名称或现有的事件日志名称匹配。</span><span class="sxs-lookup"><span data-stu-id="db667-403">The source must be unique on the local computer; a new source name cannot match an existing source name or an existing event log name.</span></span> <span data-ttu-id="db667-404">每个源可以一次; 写入一个事件日志但是，你的应用程序可以使用多个源写入多个事件日志。</span><span class="sxs-lookup"><span data-stu-id="db667-404">Each source can write to only one event log at a time; however, your application can use multiple sources to write to multiple event logs.</span></span> <span data-ttu-id="db667-405">例如，你的应用程序可能需要多个源配置为使用不同的事件日志或不同的资源文件。</span><span class="sxs-lookup"><span data-stu-id="db667-405">For example, your application might require multiple sources configured for different event logs or different resource files.</span></span>  
  
 <span data-ttu-id="db667-406">要写入本地化的项还是要直接写入字符串，必须配置源。</span><span class="sxs-lookup"><span data-stu-id="db667-406">The source must be configured either for writing localized entries or for writing direct strings.</span></span> <span data-ttu-id="db667-407">如果你的应用程序将使用资源标识符和字符串值的条目写入，则必须注册两个单独的源。</span><span class="sxs-lookup"><span data-stu-id="db667-407">If your application writes entries using both resource identifiers and string values, you must register two separate sources.</span></span> <span data-ttu-id="db667-408">例如，配置一个源的资源文件，以及如何将该源中的<xref:System.Diagnostics.EventLog.WriteEvent%2A>方法来编写使用资源标识符添加到事件日志条目。</span><span class="sxs-lookup"><span data-stu-id="db667-408">For example, configure one source with resource files, and then use that source in the <xref:System.Diagnostics.EventLog.WriteEvent%2A> method to write entries using resource identifiers to the event log.</span></span> <span data-ttu-id="db667-409">然后创建不同的源，而无需资源文件，并使用在该源<xref:System.Diagnostics.EventLog.WriteEntry%2A>方法将字符串直接写入事件日志使用的源。</span><span class="sxs-lookup"><span data-stu-id="db667-409">Then create a different source without resource files, and use that source in the <xref:System.Diagnostics.EventLog.WriteEntry%2A> method to write strings directly to the event log using that source.</span></span>  
  
 <span data-ttu-id="db667-410">若要更改现有源的配置详细信息，必须删除源，然后使用新的配置创建它。</span><span class="sxs-lookup"><span data-stu-id="db667-410">To change the configuration details of an existing source, you must delete the source and then create it with the new configuration.</span></span> <span data-ttu-id="db667-411">如果其他应用程序或组件使用现有的源，请使用更新的配置，而无需删除现有源创建新的源。</span><span class="sxs-lookup"><span data-stu-id="db667-411">If other applications or components use the existing source, create a new source with the updated configuration rather than deleting the existing source.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="db667-412">如果源已映射到某个日志并重新映射到新的日志，必须重新启动计算机更改才能生效。</span><span class="sxs-lookup"><span data-stu-id="db667-412">If a source has already been mapped to a log and you remap it to a new log, you must restart the computer for the changes to take effect.</span></span>  
  
   
  
## Examples  
 <span data-ttu-id="db667-413">下面的示例创建源`MySource`如果它尚不存在，并将条目写入到事件日志`MyNewLog`。</span><span class="sxs-lookup"><span data-stu-id="db667-413">The following example creates the source `MySource` if it does not already exist, and writes an entry to the event log `MyNewLog`.</span></span>  
  
 [!code-cpp[Classic EventLog.CreateEventSource Example#1](~/samples/snippets/cpp/VS_Snippets_CLR_Classic/classic EventLog.CreateEventSource Example/CPP/source.cpp#1)]
 [!code-csharp[Classic EventLog.CreateEventSource Example#1](~/samples/snippets/csharp/VS_Snippets_CLR_Classic/classic EventLog.CreateEventSource Example/CS/source.cs#1)]
 [!code-vb[Classic EventLog.CreateEventSource Example#1](~/samples/snippets/visualbasic/VS_Snippets_CLR_Classic/classic EventLog.CreateEventSource Example/VB/source.vb#1)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentException">
          <span data-ttu-id="db667-414">
            <paramref name="source" /> 为空字符串 ("") 或 <see langword="null" />。</span>
          <span class="sxs-lookup">
            <span data-stu-id="db667-414">
              <paramref name="source" /> is an empty string ("") or <see langword="null" />.</span>
          </span>
          <span data-ttu-id="db667-415">\- 或 -</span>
          <span class="sxs-lookup">
            <span data-stu-id="db667-415">\- or -</span>
          </span>
          <span data-ttu-id="db667-416">
            <paramref name="logName" /> 不是有效的事件日志名称。</span>
          <span class="sxs-lookup">
            <span data-stu-id="db667-416">
              <paramref name="logName" /> is not a valid event log name.</span>
          </span>
          <span data-ttu-id="db667-417">事件日志名称必须由可打印字符组成，且不得包含字符“\*”、“?”或“\\”。</span>
          <span class="sxs-lookup">
            <span data-stu-id="db667-417">Event log names must consist of printable characters, and cannot include the characters '\*', '?', or '\\'.</span>
          </span>
          <span data-ttu-id="db667-418">\- 或 -</span>
          <span class="sxs-lookup">
            <span data-stu-id="db667-418">\- or -</span>
          </span>
          <span data-ttu-id="db667-419">
            <paramref name="logName" />对用户日志创建无效。</span>
          <span class="sxs-lookup">
            <span data-stu-id="db667-419">
              <paramref name="logName" /> is not valid for user log creation.</span>
          </span>
          <span data-ttu-id="db667-420">事件日志名称 AppEvent、SysEvent 和 SecEvent 是保留为系统使用的。</span>
          <span class="sxs-lookup">
            <span data-stu-id="db667-420">The event log names AppEvent, SysEvent, and SecEvent are reserved for system use.</span>
          </span>
          <span data-ttu-id="db667-421">\- 或 -</span>
          <span class="sxs-lookup">
            <span data-stu-id="db667-421">\- or -</span>
          </span>
          <span data-ttu-id="db667-422">该日志名称与一个现有事件源名称相匹配。</span>
          <span class="sxs-lookup">
            <span data-stu-id="db667-422">The log name matches an existing event source name.</span>
          </span>
          <span data-ttu-id="db667-423">\- 或 -</span>
          <span class="sxs-lookup">
            <span data-stu-id="db667-423">\- or -</span>
          </span>
          <span data-ttu-id="db667-424">此源名称导致注册表项路径的长度超过 254 个字符。</span>
          <span class="sxs-lookup">
            <span data-stu-id="db667-424">The source name results in a registry key path longer than 254 characters.</span>
          </span>
          <span data-ttu-id="db667-425">\- 或 -</span>
          <span class="sxs-lookup">
            <span data-stu-id="db667-425">\- or -</span>
          </span>
          <span data-ttu-id="db667-426">
            <paramref name="logName" /> 的前 8 个字符与现有事件日志名称的前 8 个字符相匹配。</span>
          <span class="sxs-lookup">
            <span data-stu-id="db667-426">The first 8 characters of <paramref name="logName" /> match the first 8 characters of an existing event log name.</span>
          </span>
          <span data-ttu-id="db667-427">\- 或 -</span>
          <span class="sxs-lookup">
            <span data-stu-id="db667-427">\- or -</span>
          </span>
          <span data-ttu-id="db667-428">无法注册该源，因为它已存在于本地计算机上。</span>
          <span class="sxs-lookup">
            <span data-stu-id="db667-428">The source cannot be registered because it already exists on the local computer.</span>
          </span>
          <span data-ttu-id="db667-429">\- 或 -</span>
          <span class="sxs-lookup">
            <span data-stu-id="db667-429">\- or -</span>
          </span>
          <span data-ttu-id="db667-430">该源名称与一个现有事件日志名称相匹配。</span>
          <span class="sxs-lookup">
            <span data-stu-id="db667-430">The source name matches an existing event log name.</span>
          </span>
        </exception>
        <exception cref="T:System.InvalidOperationException">
          <span data-ttu-id="db667-431">事件日志的注册表项未能在本地计算机上打开。</span>
          <span class="sxs-lookup">
            <span data-stu-id="db667-431">The registry key for the event log could not be opened on the local computer.</span>
          </span>
        </exception>
        <permission cref="T:System.Diagnostics.EventLogPermission">
          <span data-ttu-id="db667-432">用于管理计算机上的事件日志信息。</span>
          <span class="sxs-lookup">
            <span data-stu-id="db667-432">for administering event log information on the computer.</span>
          </span>
          <span data-ttu-id="db667-433">关联的枚举： <see cref="F:System.Diagnostics.EventLogPermissionAccess.Administer" /></span>
          <span class="sxs-lookup">
            <span data-stu-id="db667-433">Associated enumeration: <see cref="F:System.Diagnostics.EventLogPermissionAccess.Administer" /></span>
          </span>
        </permission>
        <altmember cref="M:System.Diagnostics.EventLog.DeleteEventSource(System.String)" />
        <altmember cref="M:System.Diagnostics.EventLog.SourceExists(System.String)" />
        <altmember cref="P:System.Diagnostics.EventLog.Source" />
        <altmember cref="P:System.Diagnostics.EventLog.Log" />
        <altmember cref="M:System.Diagnostics.EventLog.Delete(System.String)" />
      </Docs>
    </Member>
    <Member MemberName="CreateEventSource">
      <MemberSignature Language="C#" Value="public static void CreateEventSource (string source, string logName, string machineName);" />
      <MemberSignature Language="ILAsm" Value=".method public static hidebysig void CreateEventSource(string source, string logName, string machineName) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Diagnostics.EventLog.CreateEventSource(System.String,System.String,System.String)" />
      <MemberSignature Language="VB.NET" Value="Public Shared Sub CreateEventSource (source As String, logName As String, machineName As String)" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; static void CreateEventSource(System::String ^ source, System::String ^ logName, System::String ^ machineName);" />
      <MemberSignature Language="F#" Value="static member CreateEventSource : string * string * string -&gt; unit" Usage="System.Diagnostics.EventLog.CreateEventSource (source, logName, machineName)" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System</AssemblyName>
        <AssemblyVersion>1.0.5000.0</AssemblyVersion>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Attributes>
        <Attribute FrameworkAlternate="xamarinmac-3.0">
          <AttributeName>System.Obsolete("use CreateEventSource(EventSourceCreationData) instead")</AttributeName>
        </Attribute>
        <Attribute FrameworkAlternate="netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2">
          <AttributeName>System.Obsolete("This method has been deprecated.  Please use System.Diagnostics.EventLog.CreateEventSource(EventSourceCreationData sourceData) instead.  http://go.microsoft.com/fwlink/?linkid=14202")</AttributeName>
        </Attribute>
      </Attributes>
      <ReturnValue>
        <ReturnType>System.Void</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="source" Type="System.String" />
        <Parameter Name="logName" Type="System.String" />
        <Parameter Name="machineName" Type="System.String" />
      </Parameters>
      <Docs>
        <param name="source">
          <span data-ttu-id="db667-434">应用程序在指定计算机上注册时所采用的源。</span>
          <span class="sxs-lookup">
            <span data-stu-id="db667-434">The source by which the application is registered on the specified computer.</span>
          </span>
        </param>
        <param name="logName">
          <span data-ttu-id="db667-435">源的项写入的日志名。</span>
          <span class="sxs-lookup">
            <span data-stu-id="db667-435">The name of the log the source's entries are written to.</span>
          </span>
          <span data-ttu-id="db667-436">可能的值包括“应用程序”、“系统”或自定义事件日志。</span>
          <span class="sxs-lookup">
            <span data-stu-id="db667-436">Possible values include Application, System, or a custom event log.</span>
          </span>
          <span data-ttu-id="db667-437">如果不指定值，则 <c>logName</c> 默认为应用程序。</span>
          <span class="sxs-lookup">
            <span data-stu-id="db667-437">If you do not specify a value, <c>logName</c> defaults to Application.</span>
          </span>
        </param>
        <param name="machineName">
          <span data-ttu-id="db667-438">用来注册此事件源的计算机名称，对于本地计算机则为“.”。</span>
          <span class="sxs-lookup">
            <span data-stu-id="db667-438">The name of the computer to register this event source with, or "." for the local computer.</span>
          </span>
        </param>
        <summary>
          <span data-ttu-id="db667-439">建立指定的源名称作为向指定计算机上的日志中写入项的有效事件源。</span>
          <span class="sxs-lookup">
            <span data-stu-id="db667-439">Establishes the specified source name as a valid event source for writing entries to a log on the specified computer.</span>
          </span>
          <span data-ttu-id="db667-440">此方法还可用于在指定计算机上创建一个新的自定义日志。</span>
          <span class="sxs-lookup">
            <span data-stu-id="db667-440">This method can also be used to create a new custom log on the specified computer.</span>
          </span>
        </summary>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="db667-441">使用此重载创建自定义日志或创建并注册<xref:System.Diagnostics.EventLog.Source%2A>向指定的计算机上现有的日志。</span><span class="sxs-lookup"><span data-stu-id="db667-441">Use this overload to create a custom log or to create and register a <xref:System.Diagnostics.EventLog.Source%2A> to an existing log on the specified computer.</span></span>  
  
 <span data-ttu-id="db667-442">如果`logName`是`null`或空字符串 ("") 时调用<xref:System.Diagnostics.EventLog.CreateEventSource%2A>，日志将默认为应用程序日志。</span><span class="sxs-lookup"><span data-stu-id="db667-442">If `logName` is `null` or an empty string ("") when you call <xref:System.Diagnostics.EventLog.CreateEventSource%2A>, the log defaults to the Application log.</span></span> <span data-ttu-id="db667-443">如果指定的计算机上不存在该日志，系统创建自定义日志，并注册应用程序作为<xref:System.Diagnostics.EventLog.Source%2A>为该日志。</span><span class="sxs-lookup"><span data-stu-id="db667-443">If the log does not exist on the specified computer, the system creates a custom log and registers your application as a <xref:System.Diagnostics.EventLog.Source%2A> for that log.</span></span>  
  
 <span data-ttu-id="db667-444">只需创建事件源，如果将写入事件日志。</span><span class="sxs-lookup"><span data-stu-id="db667-444">You only need to create an event source if you are writing to the event log.</span></span> <span data-ttu-id="db667-445">之前向事件日志写入条目，您必须注册事件源的事件日志作为有效的事件源。</span><span class="sxs-lookup"><span data-stu-id="db667-445">Before writing an entry to an event log, you must register the event source with the event log as a valid source of events.</span></span> <span data-ttu-id="db667-446">写入日志条目时，系统会将<xref:System.Diagnostics.EventLog.Source%2A>以查找要在其中放置您的输入相应的日志。</span><span class="sxs-lookup"><span data-stu-id="db667-446">When you write a log entry, the system uses the <xref:System.Diagnostics.EventLog.Source%2A> to find the appropriate log in which to place your entry.</span></span> <span data-ttu-id="db667-447">如果您正在读取事件日志，您可以指定<xref:System.Diagnostics.EventLog.Source%2A>，或<xref:System.Diagnostics.EventLog.Log%2A>和<xref:System.Diagnostics.EventLog.MachineName%2A>。</span><span class="sxs-lookup"><span data-stu-id="db667-447">If you are reading the event log, you can either specify the <xref:System.Diagnostics.EventLog.Source%2A>, or a <xref:System.Diagnostics.EventLog.Log%2A> and <xref:System.Diagnostics.EventLog.MachineName%2A>.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="db667-448">若要创建的事件源在 Windows Vista 及更高版本或 Windows Server 2003，必须具有管理权限。</span><span class="sxs-lookup"><span data-stu-id="db667-448">To create an event source in Windows Vista and later or Windows Server 2003, you must have administrative privileges.</span></span>  
>   
>  <span data-ttu-id="db667-449">这一要求的原因是必须搜索所有事件日志，包括安全性，以确定事件源是否唯一。</span><span class="sxs-lookup"><span data-stu-id="db667-449">The reason for this requirement is that all event logs, including security, must be searched to determine whether the event source is unique.</span></span> <span data-ttu-id="db667-450">在 Windows Vista 及更高版本，用户没有权限访问该安全日志。因此，<xref:System.Security.SecurityException>引发。</span><span class="sxs-lookup"><span data-stu-id="db667-450">In Windows Vista and later, users do not have permission to access the security log; therefore, a <xref:System.Security.SecurityException> is thrown.</span></span>  
>   
>  <span data-ttu-id="db667-451">在 Windows Vista 或更高版本中，用户帐户控制 (UAC) 决定用户的特权。</span><span class="sxs-lookup"><span data-stu-id="db667-451">In Windows Vista and later, User Account Control (UAC) determines the privileges of a user.</span></span> <span data-ttu-id="db667-452">如果您是内置的 Administrators 组的成员，将为您分配两个运行时访问令牌：一个标准用户访问令牌和一个管理员访问令牌。</span><span class="sxs-lookup"><span data-stu-id="db667-452">If you are a member of the Built-in Administrators group, you are assigned two run-time access tokens: a standard user access token and an administrator access token.</span></span> <span data-ttu-id="db667-453">默认情况下，您拥有标准用户角色。</span><span class="sxs-lookup"><span data-stu-id="db667-453">By default, you are in the standard user role.</span></span> <span data-ttu-id="db667-454">若要执行的代码访问安全日志，首先必须将你的特权从标准用户提升至管理员。</span><span class="sxs-lookup"><span data-stu-id="db667-454">To execute the code that accesses the security log, you must first elevate your privileges from standard user to administrator.</span></span> <span data-ttu-id="db667-455">你可以通过以下方式执行此操作：右键单击应用程序图标并指示需以管理员身份运行。</span><span class="sxs-lookup"><span data-stu-id="db667-455">You can do this when you start an application by right-clicking the application icon and indicating that you want to run as an administrator.</span></span>  
  
 <span data-ttu-id="db667-456">使用<xref:System.Diagnostics.EventLog.WriteEvent%2A>和<xref:System.Diagnostics.EventLog.WriteEntry%2A>将事件写入到事件日志。</span><span class="sxs-lookup"><span data-stu-id="db667-456">Use <xref:System.Diagnostics.EventLog.WriteEvent%2A> and <xref:System.Diagnostics.EventLog.WriteEntry%2A> to write events to an event log.</span></span> <span data-ttu-id="db667-457">必须指定事件源写入事件;必须创建并写入与源的第一项之前配置的事件源。</span><span class="sxs-lookup"><span data-stu-id="db667-457">You must specify an event source to write events; you must create and configure the event source before writing the first entry with the source.</span></span>  
  
 <span data-ttu-id="db667-458">在应用程序的安装过程中创建新的事件源。</span><span class="sxs-lookup"><span data-stu-id="db667-458">Create the new event source during the installation of your application.</span></span> <span data-ttu-id="db667-459">这允许操作系统以刷新其注册的事件源的列表和其配置的时间。</span><span class="sxs-lookup"><span data-stu-id="db667-459">This allows time for the operating system to refresh its list of registered event sources and their configuration.</span></span> <span data-ttu-id="db667-460">如果操作系统没有刷新其事件源的列表，并且尝试写入新的源的事件写入操作将失败。</span><span class="sxs-lookup"><span data-stu-id="db667-460">If the operating system has not refreshed its list of event sources, and you attempt to write an event with the new source, the write operation will fail.</span></span> <span data-ttu-id="db667-461">可以配置新的源使用<xref:System.Diagnostics.EventLogInstaller>，或使用<xref:System.Diagnostics.EventLog.CreateEventSource%2A>方法。</span><span class="sxs-lookup"><span data-stu-id="db667-461">You can configure a new source using an <xref:System.Diagnostics.EventLogInstaller>, or using the <xref:System.Diagnostics.EventLog.CreateEventSource%2A> method.</span></span> <span data-ttu-id="db667-462">若要创建新的事件源的计算机上，必须具有管理权限。</span><span class="sxs-lookup"><span data-stu-id="db667-462">You must have administrative rights on the computer to create a new event source.</span></span>  
  
 <span data-ttu-id="db667-463">可以创建现有事件日志或新的事件日志的事件源。</span><span class="sxs-lookup"><span data-stu-id="db667-463">You can create an event source for an existing event log or a new event log.</span></span> <span data-ttu-id="db667-464">创建新的源为新的事件日志时，系统注册该日志的源，但直到第一个条目写入不创建该日志。</span><span class="sxs-lookup"><span data-stu-id="db667-464">When you create a new source for a new event log, the system registers the source for that log, but the log is not created until the first entry is written to it.</span></span>  
  
 <span data-ttu-id="db667-465">操作系统将事件日志存储为文件。</span><span class="sxs-lookup"><span data-stu-id="db667-465">The operating system stores event logs as files.</span></span> <span data-ttu-id="db667-466">当你使用<xref:System.Diagnostics.EventLogInstaller>或<xref:System.Diagnostics.EventLog.CreateEventSource%2A>若要创建新的事件日志，关联的文件存储在指定计算机上的 %SystemRoot%\System32\Config 目录。</span><span class="sxs-lookup"><span data-stu-id="db667-466">When you use <xref:System.Diagnostics.EventLogInstaller> or <xref:System.Diagnostics.EventLog.CreateEventSource%2A> to create a new event log, the associated file is stored in the %SystemRoot%\System32\Config directory on the specified computer.</span></span> <span data-ttu-id="db667-467">通过追加的前 8 个字符设置的文件名称<xref:System.Diagnostics.EventLog.Log%2A>".evt"文件扩展名的属性。</span><span class="sxs-lookup"><span data-stu-id="db667-467">The file name is set by appending the first 8 characters of the <xref:System.Diagnostics.EventLog.Log%2A> property with the ".evt" file name extension.</span></span>  
  
 <span data-ttu-id="db667-468">源必须是本地计算机; 上唯一新的源名称不能与现有的源名称或现有的事件日志名称匹配。</span><span class="sxs-lookup"><span data-stu-id="db667-468">The source must be unique on the local computer; a new source name cannot match an existing source name or an existing event log name.</span></span> <span data-ttu-id="db667-469">每个源可以一次; 写入一个事件日志但是，你的应用程序可以使用多个源写入多个事件日志。</span><span class="sxs-lookup"><span data-stu-id="db667-469">Each source can write to only one event log at a time; however, your application can use multiple sources to write to multiple event logs.</span></span> <span data-ttu-id="db667-470">例如，你的应用程序可能需要多个源配置为使用不同的事件日志或不同的资源文件。</span><span class="sxs-lookup"><span data-stu-id="db667-470">For example, your application might require multiple sources configured for different event logs or different resource files.</span></span>  
  
 <span data-ttu-id="db667-471">要写入本地化的项还是要直接写入字符串，必须配置源。</span><span class="sxs-lookup"><span data-stu-id="db667-471">The source must be configured either for writing localized entries or for writing direct strings.</span></span> <span data-ttu-id="db667-472">如果你的应用程序将使用资源标识符和字符串值的条目写入，则必须注册两个单独的源。</span><span class="sxs-lookup"><span data-stu-id="db667-472">If your application writes entries using both resource identifiers and string values, you must register two separate sources.</span></span> <span data-ttu-id="db667-473">例如，配置一个源的资源文件，以及如何将该源中的<xref:System.Diagnostics.EventLog.WriteEvent%2A>方法来编写使用资源标识符添加到事件日志条目。</span><span class="sxs-lookup"><span data-stu-id="db667-473">For example, configure one source with resource files, and then use that source in the <xref:System.Diagnostics.EventLog.WriteEvent%2A> method to write entries using resource identifiers to the event log.</span></span> <span data-ttu-id="db667-474">然后创建不同的源，而无需资源文件，并使用在该源<xref:System.Diagnostics.EventLog.WriteEntry%2A>方法将字符串直接写入事件日志使用的源。</span><span class="sxs-lookup"><span data-stu-id="db667-474">Then create a different source without resource files, and use that source in the <xref:System.Diagnostics.EventLog.WriteEntry%2A> method to write strings directly to the event log using that source.</span></span>  
  
 <span data-ttu-id="db667-475">若要更改现有源的配置详细信息，必须删除源，然后使用新的配置创建它。</span><span class="sxs-lookup"><span data-stu-id="db667-475">To change the configuration details of an existing source, you must delete the source and then create it with the new configuration.</span></span> <span data-ttu-id="db667-476">如果其他应用程序或组件使用现有的源，请使用更新的配置，而无需删除现有源创建新的源。</span><span class="sxs-lookup"><span data-stu-id="db667-476">If other applications or components use the existing source, create a new source with the updated configuration rather than deleting the existing source.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="db667-477">如果源已映射到某个日志并重新映射到新的日志，必须重新启动计算机更改才能生效。</span><span class="sxs-lookup"><span data-stu-id="db667-477">If a source has already been mapped to a log and you remap it to a new log, you must restart the computer for the changes to take effect.</span></span>  
  
   
  
## Examples  
 <span data-ttu-id="db667-478">下面的示例创建源`MySource`的计算机上`MyServer`，并将条目写入到事件日志`MyNewLog`。</span><span class="sxs-lookup"><span data-stu-id="db667-478">The following example creates the source `MySource` on the computer `MyServer`, and writes an entry to the event log `MyNewLog`.</span></span>  
  
 [!code-cpp[Classic EventLog.SourceExists1 Example#1](~/samples/snippets/cpp/VS_Snippets_CLR_Classic/classic EventLog.SourceExists1 Example/CPP/source.cpp#1)]
 [!code-csharp[Classic EventLog.SourceExists1 Example#1](~/samples/snippets/csharp/VS_Snippets_CLR_Classic/classic EventLog.SourceExists1 Example/CS/source.cs#1)]
 [!code-vb[Classic EventLog.SourceExists1 Example#1](~/samples/snippets/visualbasic/VS_Snippets_CLR_Classic/classic EventLog.SourceExists1 Example/VB/source.vb#1)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentException">
          <span data-ttu-id="db667-479">
            <paramref name="machineName" /> 不是有效的计算机名称。</span>
          <span class="sxs-lookup">
            <span data-stu-id="db667-479">The <paramref name="machineName" /> is not a valid computer name.</span>
          </span>
          <span data-ttu-id="db667-480">\- 或 -</span>
          <span class="sxs-lookup">
            <span data-stu-id="db667-480">\- or -</span>
          </span>
          <span data-ttu-id="db667-481">
            <paramref name="source" /> 为空字符串 ("") 或 <see langword="null" />。</span>
          <span class="sxs-lookup">
            <span data-stu-id="db667-481">
              <paramref name="source" /> is an empty string ("") or <see langword="null" />.</span>
          </span>
          <span data-ttu-id="db667-482">\- 或 -</span>
          <span class="sxs-lookup">
            <span data-stu-id="db667-482">\- or -</span>
          </span>
          <span data-ttu-id="db667-483">
            <paramref name="logName" /> 不是有效的事件日志名称。</span>
          <span class="sxs-lookup">
            <span data-stu-id="db667-483">
              <paramref name="logName" /> is not a valid event log name.</span>
          </span>
          <span data-ttu-id="db667-484">事件日志名称必须由可打印字符组成，且不得包含字符“\*”、“?”或“\\”。</span>
          <span class="sxs-lookup">
            <span data-stu-id="db667-484">Event log names must consist of printable characters, and cannot include the characters '\*', '?', or '\\'.</span>
          </span>
          <span data-ttu-id="db667-485">\- 或 -</span>
          <span class="sxs-lookup">
            <span data-stu-id="db667-485">\- or -</span>
          </span>
          <span data-ttu-id="db667-486">
            <paramref name="logName" />对用户日志创建无效。</span>
          <span class="sxs-lookup">
            <span data-stu-id="db667-486">
              <paramref name="logName" /> is not valid for user log creation.</span>
          </span>
          <span data-ttu-id="db667-487">事件日志名称 AppEvent、SysEvent 和 SecEvent 是保留为系统使用的。</span>
          <span class="sxs-lookup">
            <span data-stu-id="db667-487">The event log names AppEvent, SysEvent, and SecEvent are reserved for system use.</span>
          </span>
          <span data-ttu-id="db667-488">\- 或 -</span>
          <span class="sxs-lookup">
            <span data-stu-id="db667-488">\- or -</span>
          </span>
          <span data-ttu-id="db667-489">该日志名称与一个现有事件源名称相匹配。</span>
          <span class="sxs-lookup">
            <span data-stu-id="db667-489">The log name matches an existing event source name.</span>
          </span>
          <span data-ttu-id="db667-490">\- 或 -</span>
          <span class="sxs-lookup">
            <span data-stu-id="db667-490">\- or -</span>
          </span>
          <span data-ttu-id="db667-491">此源名称导致注册表项路径的长度超过 254 个字符。</span>
          <span class="sxs-lookup">
            <span data-stu-id="db667-491">The source name results in a registry key path longer than 254 characters.</span>
          </span>
          <span data-ttu-id="db667-492">\- 或 -</span>
          <span class="sxs-lookup">
            <span data-stu-id="db667-492">\- or -</span>
          </span>
          <span data-ttu-id="db667-493">
            <paramref name="logName" /> 的前 8 个字符与指定计算机上现有事件日志名称的前 8 个字符相匹配。</span>
          <span class="sxs-lookup">
            <span data-stu-id="db667-493">The first 8 characters of <paramref name="logName" /> match the first 8 characters of an existing event log name on the specified computer.</span>
          </span>
          <span data-ttu-id="db667-494">\- 或 -</span>
          <span class="sxs-lookup">
            <span data-stu-id="db667-494">\- or -</span>
          </span>
          <span data-ttu-id="db667-495">源无法注册，因为它已存在于指定的计算机上。</span>
          <span class="sxs-lookup">
            <span data-stu-id="db667-495">The source cannot be registered because it already exists on the specified computer.</span>
          </span>
          <span data-ttu-id="db667-496">\- 或 -</span>
          <span class="sxs-lookup">
            <span data-stu-id="db667-496">\- or -</span>
          </span>
          <span data-ttu-id="db667-497">该源名称与一个现有事件源名称相匹配。</span>
          <span class="sxs-lookup">
            <span data-stu-id="db667-497">The source name matches an existing event source name.</span>
          </span>
        </exception>
        <exception cref="T:System.InvalidOperationException">
          <span data-ttu-id="db667-498">事件日志的注册表项未能在指定的计算机上打开。</span>
          <span class="sxs-lookup">
            <span data-stu-id="db667-498">The registry key for the event log could not be opened on the specified computer.</span>
          </span>
        </exception>
        <permission cref="T:System.Diagnostics.EventLogPermission">
          <span data-ttu-id="db667-499">用于管理计算机上的事件日志信息。</span>
          <span class="sxs-lookup">
            <span data-stu-id="db667-499">for administering event log information on the computer.</span>
          </span>
          <span data-ttu-id="db667-500">关联的枚举： <see cref="F:System.Diagnostics.EventLogPermissionAccess.Administer" /></span>
          <span class="sxs-lookup">
            <span data-stu-id="db667-500">Associated enumeration: <see cref="F:System.Diagnostics.EventLogPermissionAccess.Administer" /></span>
          </span>
        </permission>
        <altmember cref="M:System.Diagnostics.EventLog.DeleteEventSource(System.String)" />
        <altmember cref="M:System.Diagnostics.EventLog.SourceExists(System.String)" />
        <altmember cref="P:System.Diagnostics.EventLog.MachineName" />
        <altmember cref="P:System.Diagnostics.EventLog.Source" />
        <altmember cref="P:System.Diagnostics.EventLog.Log" />
        <altmember cref="M:System.Diagnostics.EventLog.Delete(System.String)" />
      </Docs>
    </Member>
    <MemberGroup MemberName="Delete">
      <AssemblyInfo>
        <AssemblyName>System</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Docs>
        <summary>
          <span data-ttu-id="db667-501">移除日志资源。</span>
          <span class="sxs-lookup">
            <span data-stu-id="db667-501">Removes a log resource.</span>
          </span>
        </summary>
      </Docs>
    </MemberGroup>
    <Member MemberName="Delete">
      <MemberSignature Language="C#" Value="public static void Delete (string logName);" />
      <MemberSignature Language="ILAsm" Value=".method public static hidebysig void Delete(string logName) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Diagnostics.EventLog.Delete(System.String)" />
      <MemberSignature Language="VB.NET" Value="Public Shared Sub Delete (logName As String)" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; static void Delete(System::String ^ logName);" />
      <MemberSignature Language="F#" Value="static member Delete : string -&gt; unit" Usage="System.Diagnostics.EventLog.Delete logName" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System</AssemblyName>
        <AssemblyVersion>1.0.5000.0</AssemblyVersion>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Attributes>
        <Attribute FrameworkAlternate="netframework-4.0">
          <AttributeName>System.Runtime.TargetedPatchingOptOut("Performance critical to inline this type of method across NGen image boundaries")</AttributeName>
        </Attribute>
      </Attributes>
      <ReturnValue>
        <ReturnType>System.Void</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="logName" Type="System.String" />
      </Parameters>
      <Docs>
        <param name="logName">
          <span data-ttu-id="db667-502">要删除的日志的名称。</span>
          <span class="sxs-lookup">
            <span data-stu-id="db667-502">The name of the log to delete.</span>
          </span>
          <span data-ttu-id="db667-503">可能的值包括：“应用程序”、“安全性”、“系统”和计算机上的任何自定义事件日志。</span>
          <span class="sxs-lookup">
            <span data-stu-id="db667-503">Possible values include: Application, Security, System, and any custom event logs on the computer.</span>
          </span>
        </param>
        <summary>
          <span data-ttu-id="db667-504">从本地计算机上移除事件日志。</span>
          <span class="sxs-lookup">
            <span data-stu-id="db667-504">Removes an event log from the local computer.</span>
          </span>
        </summary>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="db667-505">如果你想要删除的日志位于本地计算机上，请使用此方法。</span><span class="sxs-lookup"><span data-stu-id="db667-505">Use this method when the log you want to delete is on the local computer.</span></span> <span data-ttu-id="db667-506">只要您具有相应的注册表权限，可以删除该计算机上的任何日志。</span><span class="sxs-lookup"><span data-stu-id="db667-506">You can delete any log on the computer, provided you have the appropriate registry permissions.</span></span>  
  
 <span data-ttu-id="db667-507"><xref:System.Diagnostics.EventLog.Delete%2A> 删除指定的日志`logName`从本地计算机。</span><span class="sxs-lookup"><span data-stu-id="db667-507"><xref:System.Diagnostics.EventLog.Delete%2A> removes the log specified by `logName` from the local computer.</span></span> <span data-ttu-id="db667-508">如果你想要删除的源只能注册到一个日志，请调用<xref:System.Diagnostics.EventLog.DeleteEventSource%2A>。</span><span class="sxs-lookup"><span data-stu-id="db667-508">If you want to delete only the source registered to a log, call <xref:System.Diagnostics.EventLog.DeleteEventSource%2A>.</span></span> <span data-ttu-id="db667-509">如果只想要删除的日志条目，则调用<xref:System.Diagnostics.EventLog.Clear%2A>。</span><span class="sxs-lookup"><span data-stu-id="db667-509">If you only want to delete the log entries, call <xref:System.Diagnostics.EventLog.Clear%2A>.</span></span> <span data-ttu-id="db667-510"><xref:System.Diagnostics.EventLog.Delete%2A> 并<xref:System.Diagnostics.EventLog.DeleteEventSource%2A>是`static`方法，以便它们可以在类本身上调用。</span><span class="sxs-lookup"><span data-stu-id="db667-510"><xref:System.Diagnostics.EventLog.Delete%2A> and <xref:System.Diagnostics.EventLog.DeleteEventSource%2A> are `static` methods, so they can be called on the class itself.</span></span> <span data-ttu-id="db667-511">不需要创建的新实例<xref:System.Diagnostics.EventLog>调用这两种方法。</span><span class="sxs-lookup"><span data-stu-id="db667-511">It is not necessary to create a new instance of <xref:System.Diagnostics.EventLog> to call either method.</span></span>  
  
 <span data-ttu-id="db667-512"><xref:System.Diagnostics.EventLog.Delete%2A>方法首先删除保存日志的内容的文件。</span><span class="sxs-lookup"><span data-stu-id="db667-512">The <xref:System.Diagnostics.EventLog.Delete%2A> method first deletes the file that holds the contents of the log.</span></span> <span data-ttu-id="db667-513">然后，它访问注册表，并将删除为该日志注册的所有事件源。</span><span class="sxs-lookup"><span data-stu-id="db667-513">It then accesses the registry and removes all the event sources registered for that log.</span></span> <span data-ttu-id="db667-514">如果重新创建在以后的日志，应注册事件源同样，若要重复使用。</span><span class="sxs-lookup"><span data-stu-id="db667-514">If you recreate the log at a later point, you should register the event sources again, if they are to be reused.</span></span> <span data-ttu-id="db667-515">如果不注册事件源和其他用户写入的事件源而无需指定日志名称，将在应用程序事件日志中创建事件源。</span><span class="sxs-lookup"><span data-stu-id="db667-515">If you do not register the event sources and other users write to an event source without specifying a log name, the event source will be created in the Application event log.</span></span> <span data-ttu-id="db667-516">因此，以前无法将条目写入到日志删除并重新创建的应用程序将向应用程序日志改为编写，因为它现在包含事件源。</span><span class="sxs-lookup"><span data-stu-id="db667-516">Therefore, applications that previously were able to write entries to the log you deleted and recreated will write to the Application log instead, because it now contains the event source.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="db667-517">重新创建事件日志可以是一个困难的过程。</span><span class="sxs-lookup"><span data-stu-id="db667-517">Recreating an event log can be a difficult process.</span></span> <span data-ttu-id="db667-518">避免删除任何系统创建的事件日志，如应用程序日志。</span><span class="sxs-lookup"><span data-stu-id="db667-518">Avoid deleting any of the system-created event logs, such as the Application log.</span></span>  
  
 <span data-ttu-id="db667-519">删除通过调用日志<xref:System.Diagnostics.EventLog.Delete%2A>会自动删除已注册到该日志的源。</span><span class="sxs-lookup"><span data-stu-id="db667-519">Deleting a log through a call to <xref:System.Diagnostics.EventLog.Delete%2A> automatically deletes the sources registered to that log.</span></span> <span data-ttu-id="db667-520">这会使其他应用程序使用该日志不起作用。</span><span class="sxs-lookup"><span data-stu-id="db667-520">This can make other applications using that log inoperative.</span></span>  
  
   
  
## Examples  
 <span data-ttu-id="db667-521">下面的示例从本地计算机中删除日志。</span><span class="sxs-lookup"><span data-stu-id="db667-521">The following example deletes a log from the local computer.</span></span> <span data-ttu-id="db667-522">该示例确定从其源的日志。</span><span class="sxs-lookup"><span data-stu-id="db667-522">The example determines the log from its source.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="db667-523">多个源可能会写入事件日志。</span><span class="sxs-lookup"><span data-stu-id="db667-523">More than one source might write to an event log.</span></span> <span data-ttu-id="db667-524">在删除之前自定义日志，请确保不没有写入该日志的任何其他源。</span><span class="sxs-lookup"><span data-stu-id="db667-524">Before deleting a custom log, make sure there are no other sources writing to that log.</span></span>  
  
 [!code-cpp[Classic EventLog.DeleteEventSource Example#1](~/samples/snippets/cpp/VS_Snippets_CLR_Classic/classic EventLog.DeleteEventSource Example/CPP/source.cpp#1)]
 [!code-csharp[Classic EventLog.DeleteEventSource Example#1](~/samples/snippets/csharp/VS_Snippets_CLR_Classic/classic EventLog.DeleteEventSource Example/CS/source.cs#1)]
 [!code-vb[Classic EventLog.DeleteEventSource Example#1](~/samples/snippets/visualbasic/VS_Snippets_CLR_Classic/classic EventLog.DeleteEventSource Example/VB/source.vb#1)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentException">
          <span data-ttu-id="db667-525">
            <paramref name="logName" /> 为空字符串 ("") 或 <see langword="null" />。</span>
          <span class="sxs-lookup">
            <span data-stu-id="db667-525">
              <paramref name="logName" /> is an empty string ("") or <see langword="null" />.</span>
          </span>
        </exception>
        <exception cref="T:System.InvalidOperationException">
          <span data-ttu-id="db667-526">事件日志的注册表项未能在本地计算机上打开。</span>
          <span class="sxs-lookup">
            <span data-stu-id="db667-526">The registry key for the event log could not be opened on the local computer.</span>
          </span>
          <span data-ttu-id="db667-527">\- 或 -</span>
          <span class="sxs-lookup">
            <span data-stu-id="db667-527">\- or -</span>
          </span>
          <span data-ttu-id="db667-528">本地计算机上不存在该日志。</span>
          <span class="sxs-lookup">
            <span data-stu-id="db667-528">The log does not exist on the local computer.</span>
          </span>
        </exception>
        <exception cref="T:System.ComponentModel.Win32Exception">
          <span data-ttu-id="db667-529">未成功清除事件日志。</span>
          <span class="sxs-lookup">
            <span data-stu-id="db667-529">The event log was not cleared successfully.</span>
          </span>
          <span data-ttu-id="db667-530">或</span>
          <span class="sxs-lookup">
            <span data-stu-id="db667-530">-or-</span>
          </span>
          <span data-ttu-id="db667-531">无法打开日志。</span>
          <span class="sxs-lookup">
            <span data-stu-id="db667-531">The log cannot be opened.</span>
          </span>
          <span data-ttu-id="db667-532">一个 Windows 错误代码不可用。</span>
          <span class="sxs-lookup">
            <span data-stu-id="db667-532">A Windows error code is not available.</span>
          </span>
        </exception>
        <permission cref="T:System.Diagnostics.EventLogPermission">
          <span data-ttu-id="db667-533">用于管理计算机上的事件日志信息。</span>
          <span class="sxs-lookup">
            <span data-stu-id="db667-533">for administering event log information on the computer.</span>
          </span>
          <span data-ttu-id="db667-534">关联的枚举： <see cref="F:System.Diagnostics.EventLogPermissionAccess.Administer" /></span>
          <span class="sxs-lookup">
            <span data-stu-id="db667-534">Associated enumeration: <see cref="F:System.Diagnostics.EventLogPermissionAccess.Administer" /></span>
          </span>
        </permission>
        <altmember cref="M:System.Diagnostics.EventLog.Clear" />
        <altmember cref="M:System.Diagnostics.EventLog.Close" />
        <altmember cref="M:System.Diagnostics.EventLog.DeleteEventSource(System.String)" />
        <altmember cref="P:System.Diagnostics.EventLog.Log" />
      </Docs>
    </Member>
    <Member MemberName="Delete">
      <MemberSignature Language="C#" Value="public static void Delete (string logName, string machineName);" />
      <MemberSignature Language="ILAsm" Value=".method public static hidebysig void Delete(string logName, string machineName) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Diagnostics.EventLog.Delete(System.String,System.String)" />
      <MemberSignature Language="VB.NET" Value="Public Shared Sub Delete (logName As String, machineName As String)" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; static void Delete(System::String ^ logName, System::String ^ machineName);" />
      <MemberSignature Language="F#" Value="static member Delete : string * string -&gt; unit" Usage="System.Diagnostics.EventLog.Delete (logName, machineName)" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System</AssemblyName>
        <AssemblyVersion>1.0.5000.0</AssemblyVersion>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Attributes>
        <Attribute FrameworkAlternate="xamarinmac-3.0">
          <AttributeName>System.MonoNotSupported("remote machine is not supported")</AttributeName>
        </Attribute>
      </Attributes>
      <ReturnValue>
        <ReturnType>System.Void</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="logName" Type="System.String" />
        <Parameter Name="machineName" Type="System.String" />
      </Parameters>
      <Docs>
        <param name="logName">
          <span data-ttu-id="db667-535">要删除的日志的名称。</span>
          <span class="sxs-lookup">
            <span data-stu-id="db667-535">The name of the log to delete.</span>
          </span>
          <span data-ttu-id="db667-536">可能的值包括：“应用程序”、“安全”、“系统”和指定计算机上的任何自定义事件日志。</span>
          <span class="sxs-lookup">
            <span data-stu-id="db667-536">Possible values include: Application, Security, System, and any custom event logs on the specified computer.</span>
          </span>
        </param>
        <param name="machineName">
          <span data-ttu-id="db667-537">要从中删除日志的计算机名称，对于本地计算机则为“.”。</span>
          <span class="sxs-lookup">
            <span data-stu-id="db667-537">The name of the computer to delete the log from, or "." for the local computer.</span>
          </span>
        </param>
        <summary>
          <span data-ttu-id="db667-538">从指定计算机上移除事件日志。</span>
          <span class="sxs-lookup">
            <span data-stu-id="db667-538">Removes an event log from the specified computer.</span>
          </span>
        </summary>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="db667-539">如果你想要删除的日志位于远程计算机上，请使用此方法。</span><span class="sxs-lookup"><span data-stu-id="db667-539">Use this method when the log you want to delete is on a remote computer.</span></span> <span data-ttu-id="db667-540">只要您具有相应的注册表权限，可以删除该计算机上的任何日志。</span><span class="sxs-lookup"><span data-stu-id="db667-540">You can delete any log on the computer, provided you have the appropriate registry permissions.</span></span>  
  
 <span data-ttu-id="db667-541"><xref:System.Diagnostics.EventLog.Delete%2A> 删除指定的日志`logName`从指定的计算机`machineName`。</span><span class="sxs-lookup"><span data-stu-id="db667-541"><xref:System.Diagnostics.EventLog.Delete%2A> removes the log specified by `logName` from the computer specified by `machineName`.</span></span> <span data-ttu-id="db667-542">如果你想要删除的源只能注册到一个日志，请调用<xref:System.Diagnostics.EventLog.DeleteEventSource%2A>。</span><span class="sxs-lookup"><span data-stu-id="db667-542">If you want to delete only the source registered to a log, call <xref:System.Diagnostics.EventLog.DeleteEventSource%2A>.</span></span> <span data-ttu-id="db667-543">如果只想要删除的日志条目，则调用<xref:System.Diagnostics.EventLog.Clear%2A>。</span><span class="sxs-lookup"><span data-stu-id="db667-543">If you only want to delete the log entries, call <xref:System.Diagnostics.EventLog.Clear%2A>.</span></span> <span data-ttu-id="db667-544"><xref:System.Diagnostics.EventLog.Delete%2A> 并<xref:System.Diagnostics.EventLog.DeleteEventSource%2A>是`static`方法，以便它们可以在类本身上调用。</span><span class="sxs-lookup"><span data-stu-id="db667-544"><xref:System.Diagnostics.EventLog.Delete%2A> and <xref:System.Diagnostics.EventLog.DeleteEventSource%2A> are `static` methods, so they can be called on the class itself.</span></span> <span data-ttu-id="db667-545">不需要创建的实例<xref:System.Diagnostics.EventLog>调用这两种方法。</span><span class="sxs-lookup"><span data-stu-id="db667-545">It is not necessary to create an instance of <xref:System.Diagnostics.EventLog> to call either method.</span></span>  
  
 <span data-ttu-id="db667-546">此方法首先删除保存日志的内容的文件。</span><span class="sxs-lookup"><span data-stu-id="db667-546">This method first deletes the file that holds the contents of the log.</span></span> <span data-ttu-id="db667-547">然后，它访问注册表，并将删除为该日志注册的所有事件源。</span><span class="sxs-lookup"><span data-stu-id="db667-547">It then accesses the registry and removes all the event sources registered for that log.</span></span> <span data-ttu-id="db667-548">如果重新创建在以后的日志，应注册事件源同样，若要重复使用。</span><span class="sxs-lookup"><span data-stu-id="db667-548">If you recreate the log at a later point, you should register the event sources again, if they are to be reused.</span></span> <span data-ttu-id="db667-549">如果不注册事件源和其他用户写入的事件源而无需指定日志名称，将在应用程序事件日志中创建事件源。</span><span class="sxs-lookup"><span data-stu-id="db667-549">If you do not register the event sources and other users write to an event source without specifying a log name, the event source will be created in the Application event log.</span></span> <span data-ttu-id="db667-550">因此，以前无法将条目写入到日志删除并重新创建的应用程序将向应用程序日志改为编写，因为它现在包含事件源。</span><span class="sxs-lookup"><span data-stu-id="db667-550">Therefore, applications that previously were able to write entries to the log you deleted and recreated will write to the Application log instead, because it now contains the event source.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="db667-551">重新创建事件日志可以是一个困难的过程。</span><span class="sxs-lookup"><span data-stu-id="db667-551">Recreating an event log can be a difficult process.</span></span> <span data-ttu-id="db667-552">避免删除任何系统创建的事件日志，如应用程序日志。</span><span class="sxs-lookup"><span data-stu-id="db667-552">Avoid deleting any of the system-created event logs, such as the Application log.</span></span>  
  
 <span data-ttu-id="db667-553">删除通过调用日志<xref:System.Diagnostics.EventLog.Delete%2A>会自动删除已注册到该日志的源。</span><span class="sxs-lookup"><span data-stu-id="db667-553">Deleting a log through a call to <xref:System.Diagnostics.EventLog.Delete%2A> automatically deletes the sources registered to that log.</span></span> <span data-ttu-id="db667-554">这会使其他应用程序使用该日志不起作用。</span><span class="sxs-lookup"><span data-stu-id="db667-554">This can make other applications using that log inoperative.</span></span>  
  
   
  
## Examples  
 <span data-ttu-id="db667-555">下面的示例从指定的计算机中删除日志。</span><span class="sxs-lookup"><span data-stu-id="db667-555">The following example deletes a log from the specified computer.</span></span> <span data-ttu-id="db667-556">该示例确定从其源的日志。</span><span class="sxs-lookup"><span data-stu-id="db667-556">The example determines the log from its source.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="db667-557">多个源可能会写入事件日志。</span><span class="sxs-lookup"><span data-stu-id="db667-557">More than one source might write to an event log.</span></span> <span data-ttu-id="db667-558">在删除之前自定义日志，请确保不没有写入该日志的任何其他源。</span><span class="sxs-lookup"><span data-stu-id="db667-558">Before deleting a custom log, make sure there are no other sources writing to that log.</span></span>  
  
 [!code-cpp[Classic EventLog.Delete1 Example#1](~/samples/snippets/cpp/VS_Snippets_CLR_Classic/classic EventLog.Delete1 Example/CPP/source.cpp#1)]
 [!code-csharp[Classic EventLog.Delete1 Example#1](~/samples/snippets/csharp/VS_Snippets_CLR_Classic/classic EventLog.Delete1 Example/CS/source.cs#1)]
 [!code-vb[Classic EventLog.Delete1 Example#1](~/samples/snippets/visualbasic/VS_Snippets_CLR_Classic/classic EventLog.Delete1 Example/VB/source.vb#1)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentException">
          <span data-ttu-id="db667-559">
            <paramref name="logName" /> 为空字符串 ("") 或 <see langword="null" />。</span>
          <span class="sxs-lookup">
            <span data-stu-id="db667-559">
              <paramref name="logName" /> is an empty string ("") or <see langword="null" />.</span>
          </span>
          <span data-ttu-id="db667-560">\- 或 -</span>
          <span class="sxs-lookup">
            <span data-stu-id="db667-560">\- or -</span>
          </span>
          <span data-ttu-id="db667-561">
            <paramref name="machineName" /> 不是有效的计算机名称。</span>
          <span class="sxs-lookup">
            <span data-stu-id="db667-561">
              <paramref name="machineName" /> is not a valid computer name.</span>
          </span>
        </exception>
        <exception cref="T:System.InvalidOperationException">
          <span data-ttu-id="db667-562">事件日志的注册表项未能在指定的计算机上打开。</span>
          <span class="sxs-lookup">
            <span data-stu-id="db667-562">The registry key for the event log could not be opened on the specified computer.</span>
          </span>
          <span data-ttu-id="db667-563">\- 或 -</span>
          <span class="sxs-lookup">
            <span data-stu-id="db667-563">\- or -</span>
          </span>
          <span data-ttu-id="db667-564">指定的计算机上不存在该日志。</span>
          <span class="sxs-lookup">
            <span data-stu-id="db667-564">The log does not exist on the specified computer.</span>
          </span>
        </exception>
        <exception cref="T:System.ComponentModel.Win32Exception">
          <span data-ttu-id="db667-565">未成功清除事件日志。</span>
          <span class="sxs-lookup">
            <span data-stu-id="db667-565">The event log was not cleared successfully.</span>
          </span>
          <span data-ttu-id="db667-566">或</span>
          <span class="sxs-lookup">
            <span data-stu-id="db667-566">-or-</span>
          </span>
          <span data-ttu-id="db667-567">无法打开日志。</span>
          <span class="sxs-lookup">
            <span data-stu-id="db667-567">The log cannot be opened.</span>
          </span>
          <span data-ttu-id="db667-568">一个 Windows 错误代码不可用。</span>
          <span class="sxs-lookup">
            <span data-stu-id="db667-568">A Windows error code is not available.</span>
          </span>
        </exception>
        <permission cref="T:System.Diagnostics.EventLogPermission">
          <span data-ttu-id="db667-569">用于管理计算机上的事件日志信息。</span>
          <span class="sxs-lookup">
            <span data-stu-id="db667-569">for administering event log information on the computer.</span>
          </span>
          <span data-ttu-id="db667-570">关联的枚举： <see cref="F:System.Diagnostics.EventLogPermissionAccess.Administer" /></span>
          <span class="sxs-lookup">
            <span data-stu-id="db667-570">Associated enumeration: <see cref="F:System.Diagnostics.EventLogPermissionAccess.Administer" /></span>
          </span>
        </permission>
        <altmember cref="M:System.Diagnostics.EventLog.Clear" />
        <altmember cref="M:System.Diagnostics.EventLog.Close" />
        <altmember cref="M:System.Diagnostics.EventLog.DeleteEventSource(System.String)" />
        <altmember cref="P:System.Diagnostics.EventLog.Log" />
        <altmember cref="P:System.Diagnostics.EventLog.MachineName" />
      </Docs>
    </Member>
    <MemberGroup MemberName="DeleteEventSource">
      <AssemblyInfo>
        <AssemblyName>System</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Docs>
        <summary>
          <span data-ttu-id="db667-571">从事件日志中移除应用程序的事件源注册。</span>
          <span class="sxs-lookup">
            <span data-stu-id="db667-571">Removes an application's event source registration from the event log.</span>
          </span>
        </summary>
      </Docs>
    </MemberGroup>
    <Member MemberName="DeleteEventSource">
      <MemberSignature Language="C#" Value="public static void DeleteEventSource (string source);" />
      <MemberSignature Language="ILAsm" Value=".method public static hidebysig void DeleteEventSource(string source) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Diagnostics.EventLog.DeleteEventSource(System.String)" />
      <MemberSignature Language="VB.NET" Value="Public Shared Sub DeleteEventSource (source As String)" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; static void DeleteEventSource(System::String ^ source);" />
      <MemberSignature Language="F#" Value="static member DeleteEventSource : string -&gt; unit" Usage="System.Diagnostics.EventLog.DeleteEventSource source" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System</AssemblyName>
        <AssemblyVersion>1.0.5000.0</AssemblyVersion>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Attributes>
        <Attribute FrameworkAlternate="netframework-4.0">
          <AttributeName>System.Runtime.TargetedPatchingOptOut("Performance critical to inline this type of method across NGen image boundaries")</AttributeName>
        </Attribute>
      </Attributes>
      <ReturnValue>
        <ReturnType>System.Void</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="source" Type="System.String" />
      </Parameters>
      <Docs>
        <param name="source">
          <span data-ttu-id="db667-572">应用程序在事件日志系统中用来注册的名称。</span>
          <span class="sxs-lookup">
            <span data-stu-id="db667-572">The name by which the application is registered in the event log system.</span>
          </span>
        </param>
        <summary>
          <span data-ttu-id="db667-573">从本地计算机的事件日志中移除事件源注册。</span>
          <span class="sxs-lookup">
            <span data-stu-id="db667-573">Removes the event source registration from the event log of the local computer.</span>
          </span>
        </summary>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="db667-574">此方法用于删除的注册<xref:System.Diagnostics.EventLog.Source%2A>从本地计算机。</span><span class="sxs-lookup"><span data-stu-id="db667-574">Use this method to remove the registration of a <xref:System.Diagnostics.EventLog.Source%2A> from the local computer.</span></span> <span data-ttu-id="db667-575"><xref:System.Diagnostics.EventLog.DeleteEventSource%2A> 访问本地计算机上的注册表，并删除应用程序作为有效的事件源的注册。</span><span class="sxs-lookup"><span data-stu-id="db667-575"><xref:System.Diagnostics.EventLog.DeleteEventSource%2A> accesses the registry on the local computer and removes the registration of your application as a valid source of events.</span></span>  
  
 <span data-ttu-id="db667-576">如果您不再需要将条目写入该日志，可以为有效的事件源删除你的组件。</span><span class="sxs-lookup"><span data-stu-id="db667-576">You can remove your component as a valid source of events if you no longer need it to write entries to that log.</span></span> <span data-ttu-id="db667-577">例如，如果您需要将组件从一个日志更改为另一个可能会执行此操作。</span><span class="sxs-lookup"><span data-stu-id="db667-577">For example, you might do this if you need to change your component from one log to another.</span></span> <span data-ttu-id="db667-578">一个源一次只能注册到一个日志，因为更改日志需要删除当前注册。</span><span class="sxs-lookup"><span data-stu-id="db667-578">Because a source can only be registered to one log at a time, changing the log requires you to remove the current registration.</span></span>  
  
 <span data-ttu-id="db667-579"><xref:System.Diagnostics.EventLog.DeleteEventSource%2A> 删除注册到一个日志源。</span><span class="sxs-lookup"><span data-stu-id="db667-579"><xref:System.Diagnostics.EventLog.DeleteEventSource%2A> removes only the source registered to a log.</span></span> <span data-ttu-id="db667-580">如果你想要删除日志本身，则调用<xref:System.Diagnostics.EventLog.Delete%2A>。</span><span class="sxs-lookup"><span data-stu-id="db667-580">If you want to remove the log itself, call <xref:System.Diagnostics.EventLog.Delete%2A>.</span></span> <span data-ttu-id="db667-581">如果只想要删除的日志条目，则调用<xref:System.Diagnostics.EventLog.Clear%2A>。</span><span class="sxs-lookup"><span data-stu-id="db667-581">If you only want to delete the log entries, call <xref:System.Diagnostics.EventLog.Clear%2A>.</span></span> <span data-ttu-id="db667-582"><xref:System.Diagnostics.EventLog.Delete%2A> 并<xref:System.Diagnostics.EventLog.DeleteEventSource%2A>是`static`方法，以便它们可以在类本身上调用。</span><span class="sxs-lookup"><span data-stu-id="db667-582"><xref:System.Diagnostics.EventLog.Delete%2A> and <xref:System.Diagnostics.EventLog.DeleteEventSource%2A> are `static` methods, so they can be called on the class itself.</span></span> <span data-ttu-id="db667-583">不需要创建的实例<xref:System.Diagnostics.EventLog>调用这两种方法。</span><span class="sxs-lookup"><span data-stu-id="db667-583">It is not necessary to create an instance of <xref:System.Diagnostics.EventLog> to call either method.</span></span>  
  
 <span data-ttu-id="db667-584">删除通过调用日志<xref:System.Diagnostics.EventLog.Delete%2A>会自动删除已注册到该日志的源。</span><span class="sxs-lookup"><span data-stu-id="db667-584">Deleting a log through a call to <xref:System.Diagnostics.EventLog.Delete%2A> automatically deletes the sources registered to that log.</span></span> <span data-ttu-id="db667-585">这会使其他应用程序使用该日志不起作用。</span><span class="sxs-lookup"><span data-stu-id="db667-585">This can make other applications using that log inoperative.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="db667-586">如果源已映射到某个日志并重新映射到新的日志，必须重新启动计算机更改才能生效。</span><span class="sxs-lookup"><span data-stu-id="db667-586">If a source has already been mapped to a log and you remap it to a new log, you must restart the computer for the changes to take effect.</span></span>  
  
   
  
## Examples  
 <span data-ttu-id="db667-587">下面的示例从本地计算机中删除源。</span><span class="sxs-lookup"><span data-stu-id="db667-587">The following example deletes a source from the local computer.</span></span> <span data-ttu-id="db667-588">该示例确定从其源的日志，然后删除该日志。</span><span class="sxs-lookup"><span data-stu-id="db667-588">The example determines the log from its source, and then deletes the log.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="db667-589">多个源可能会写入事件日志。</span><span class="sxs-lookup"><span data-stu-id="db667-589">More than one source might write to an event log.</span></span> <span data-ttu-id="db667-590">在删除之前自定义日志，请确保不没有写入该日志的任何其他源。</span><span class="sxs-lookup"><span data-stu-id="db667-590">Before deleting a custom log, make sure there are no other sources writing to that log.</span></span>  
  
 [!code-cpp[Classic EventLog.DeleteEventSource Example#1](~/samples/snippets/cpp/VS_Snippets_CLR_Classic/classic EventLog.DeleteEventSource Example/CPP/source.cpp#1)]
 [!code-csharp[Classic EventLog.DeleteEventSource Example#1](~/samples/snippets/csharp/VS_Snippets_CLR_Classic/classic EventLog.DeleteEventSource Example/CS/source.cs#1)]
 [!code-vb[Classic EventLog.DeleteEventSource Example#1](~/samples/snippets/visualbasic/VS_Snippets_CLR_Classic/classic EventLog.DeleteEventSource Example/VB/source.vb#1)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentException">
          <span data-ttu-id="db667-591">本地计算机的注册表中不存在 <paramref name="source" /> 参数。</span>
          <span class="sxs-lookup">
            <span data-stu-id="db667-591">The <paramref name="source" /> parameter does not exist in the registry of the local computer.</span>
          </span>
          <span data-ttu-id="db667-592">\- 或 -</span>
          <span class="sxs-lookup">
            <span data-stu-id="db667-592">\- or -</span>
          </span>
          <span data-ttu-id="db667-593">您对事件日志的注册表项没有写访问权。</span>
          <span class="sxs-lookup">
            <span data-stu-id="db667-593">You do not have write access on the registry key for the event log.</span>
          </span>
        </exception>
        <permission cref="T:System.Diagnostics.EventLogPermission">
          <span data-ttu-id="db667-594">用于管理计算机上的事件日志信息。</span>
          <span class="sxs-lookup">
            <span data-stu-id="db667-594">for administering event log information on the computer.</span>
          </span>
          <span data-ttu-id="db667-595">关联的枚举： <see cref="F:System.Diagnostics.EventLogPermissionAccess.Administer" /></span>
          <span class="sxs-lookup">
            <span data-stu-id="db667-595">Associated enumeration: <see cref="F:System.Diagnostics.EventLogPermissionAccess.Administer" /></span>
          </span>
        </permission>
        <altmember cref="Overload:System.Diagnostics.EventLog.CreateEventSource" />
        <altmember cref="P:System.Diagnostics.EventLog.Source" />
        <altmember cref="M:System.Diagnostics.EventLog.SourceExists(System.String)" />
        <altmember cref="M:System.Diagnostics.EventLog.Delete(System.String)" />
        <altmember cref="M:System.Diagnostics.EventLog.Clear" />
      </Docs>
    </Member>
    <Member MemberName="DeleteEventSource">
      <MemberSignature Language="C#" Value="public static void DeleteEventSource (string source, string machineName);" />
      <MemberSignature Language="ILAsm" Value=".method public static hidebysig void DeleteEventSource(string source, string machineName) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Diagnostics.EventLog.DeleteEventSource(System.String,System.String)" />
      <MemberSignature Language="VB.NET" Value="Public Shared Sub DeleteEventSource (source As String, machineName As String)" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; static void DeleteEventSource(System::String ^ source, System::String ^ machineName);" />
      <MemberSignature Language="F#" Value="static member DeleteEventSource : string * string -&gt; unit" Usage="System.Diagnostics.EventLog.DeleteEventSource (source, machineName)" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System</AssemblyName>
        <AssemblyVersion>1.0.5000.0</AssemblyVersion>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Attributes>
        <Attribute FrameworkAlternate="xamarinmac-3.0">
          <AttributeName>System.MonoNotSupported("remote machine is not supported")</AttributeName>
        </Attribute>
      </Attributes>
      <ReturnValue>
        <ReturnType>System.Void</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="source" Type="System.String" />
        <Parameter Name="machineName" Type="System.String" />
      </Parameters>
      <Docs>
        <param name="source">
          <span data-ttu-id="db667-596">应用程序在事件日志系统中用来注册的名称。</span>
          <span class="sxs-lookup">
            <span data-stu-id="db667-596">The name by which the application is registered in the event log system.</span>
          </span>
        </param>
        <param name="machineName">
          <span data-ttu-id="db667-597">要从中移除注册的计算机名，对于本地计算机则为“.”。</span>
          <span class="sxs-lookup">
            <span data-stu-id="db667-597">The name of the computer to remove the registration from, or "." for the local computer.</span>
          </span>
        </param>
        <summary>
          <span data-ttu-id="db667-598">从指定的计算机上移除应用程序的事件源注册。</span>
          <span class="sxs-lookup">
            <span data-stu-id="db667-598">Removes the application's event source registration from the specified computer.</span>
          </span>
        </summary>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="db667-599">使用此重载以删除的注册<xref:System.Diagnostics.EventLog.Source%2A>从远程计算机。</span><span class="sxs-lookup"><span data-stu-id="db667-599">Use this overload to remove the registration of a <xref:System.Diagnostics.EventLog.Source%2A> from a remote computer.</span></span> <span data-ttu-id="db667-600"><xref:System.Diagnostics.EventLog.DeleteEventSource%2A> 访问指定的计算机上的注册表`machineName`并删除应用程序作为有效的事件源的注册。</span><span class="sxs-lookup"><span data-stu-id="db667-600"><xref:System.Diagnostics.EventLog.DeleteEventSource%2A> accesses the registry on the computer specified by `machineName` and removes the registration of your application as a valid source of events.</span></span>  
  
 <span data-ttu-id="db667-601">如果您不再需要将条目写入该日志，可以为有效的事件源删除你的组件。</span><span class="sxs-lookup"><span data-stu-id="db667-601">You can remove your component as a valid source of events if you no longer need it to write entries to that log.</span></span> <span data-ttu-id="db667-602">例如，如果您需要将组件从一个日志更改为另一个可能会执行此操作。</span><span class="sxs-lookup"><span data-stu-id="db667-602">For example, you might do this if you need to change your component from one log to another.</span></span> <span data-ttu-id="db667-603">一个源一次只能注册到一个日志，因为更改日志需要删除当前注册。</span><span class="sxs-lookup"><span data-stu-id="db667-603">Because a source can only be registered to one log at a time, changing the log requires you to remove the current registration.</span></span>  
  
 <span data-ttu-id="db667-604"><xref:System.Diagnostics.EventLog.DeleteEventSource%2A> 删除注册到一个日志源。</span><span class="sxs-lookup"><span data-stu-id="db667-604"><xref:System.Diagnostics.EventLog.DeleteEventSource%2A> removes only the source registered to a log.</span></span> <span data-ttu-id="db667-605">如果你想要删除日志本身，则调用<xref:System.Diagnostics.EventLog.Delete%2A>。</span><span class="sxs-lookup"><span data-stu-id="db667-605">If you want to remove the log itself, call <xref:System.Diagnostics.EventLog.Delete%2A>.</span></span> <span data-ttu-id="db667-606">如果只想要删除的日志条目，则调用<xref:System.Diagnostics.EventLog.Clear%2A>。</span><span class="sxs-lookup"><span data-stu-id="db667-606">If you only want to delete the log entries, call <xref:System.Diagnostics.EventLog.Clear%2A>.</span></span> <span data-ttu-id="db667-607"><xref:System.Diagnostics.EventLog.Delete%2A> 并<xref:System.Diagnostics.EventLog.DeleteEventSource%2A>是`static`方法，以便它们可以在类本身上调用。</span><span class="sxs-lookup"><span data-stu-id="db667-607"><xref:System.Diagnostics.EventLog.Delete%2A> and <xref:System.Diagnostics.EventLog.DeleteEventSource%2A> are `static` methods, so they can be called on the class itself.</span></span> <span data-ttu-id="db667-608">不需要创建的实例<xref:System.Diagnostics.EventLog>调用这两种方法。</span><span class="sxs-lookup"><span data-stu-id="db667-608">It is not necessary to create an instance of <xref:System.Diagnostics.EventLog> to call either method.</span></span>  
  
 <span data-ttu-id="db667-609">删除通过调用日志<xref:System.Diagnostics.EventLog.Delete%2A>会自动删除已注册到该日志的源。</span><span class="sxs-lookup"><span data-stu-id="db667-609">Deleting a log through a call to <xref:System.Diagnostics.EventLog.Delete%2A> automatically deletes the sources registered to that log.</span></span> <span data-ttu-id="db667-610">这会使其他应用程序使用该日志不起作用。</span><span class="sxs-lookup"><span data-stu-id="db667-610">This can make other applications using that log inoperative.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="db667-611">如果源已映射到某个日志并重新映射到新的日志，必须重新启动计算机更改才能生效。</span><span class="sxs-lookup"><span data-stu-id="db667-611">If a source has already been mapped to a log and you remap it to a new log, you must restart the computer for the changes to take effect.</span></span>  
  
   
  
## Examples  
 <span data-ttu-id="db667-612">下面的示例从指定的计算机中删除源。</span><span class="sxs-lookup"><span data-stu-id="db667-612">The following example deletes a source from the specified computer.</span></span> <span data-ttu-id="db667-613">该示例确定从其源的日志，然后删除该日志。</span><span class="sxs-lookup"><span data-stu-id="db667-613">The example determines the log from its source, and then deletes the log.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="db667-614">多个源可能会写入事件日志。</span><span class="sxs-lookup"><span data-stu-id="db667-614">More than one source might write to an event log.</span></span> <span data-ttu-id="db667-615">在删除之前自定义日志，请确保不没有写入该日志的任何其他源。</span><span class="sxs-lookup"><span data-stu-id="db667-615">Before deleting a custom log, make sure there are no other sources writing to that log.</span></span>  
  
 [!code-cpp[Classic EventLog.Delete1 Example#1](~/samples/snippets/cpp/VS_Snippets_CLR_Classic/classic EventLog.Delete1 Example/CPP/source.cpp#1)]
 [!code-csharp[Classic EventLog.Delete1 Example#1](~/samples/snippets/csharp/VS_Snippets_CLR_Classic/classic EventLog.Delete1 Example/CS/source.cs#1)]
 [!code-vb[Classic EventLog.Delete1 Example#1](~/samples/snippets/visualbasic/VS_Snippets_CLR_Classic/classic EventLog.Delete1 Example/VB/source.vb#1)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentException">
          <span data-ttu-id="db667-616">
            <paramref name="machineName" /> 参数无效。</span>
          <span class="sxs-lookup">
            <span data-stu-id="db667-616">The <paramref name="machineName" /> parameter is invalid.</span>
          </span>
          <span data-ttu-id="db667-617">\- 或 -</span>
          <span class="sxs-lookup">
            <span data-stu-id="db667-617">\- or -</span>
          </span>
          <span data-ttu-id="db667-618">指定计算机的注册表中不存在 <paramref name="source" /> 参数。</span>
          <span class="sxs-lookup">
            <span data-stu-id="db667-618">The <paramref name="source" /> parameter does not exist in the registry of the specified computer.</span>
          </span>
          <span data-ttu-id="db667-619">\- 或 -</span>
          <span class="sxs-lookup">
            <span data-stu-id="db667-619">\- or -</span>
          </span>
          <span data-ttu-id="db667-620">您对事件日志的注册表项没有写访问权。</span>
          <span class="sxs-lookup">
            <span data-stu-id="db667-620">You do not have write access on the registry key for the event log.</span>
          </span>
        </exception>
        <exception cref="T:System.InvalidOperationException">
          <span data-ttu-id="db667-621">无法删除 <paramref name="source" />，原因是在注册表中，<paramref name="source" /> 的父注册表项不包含与其同名的子项。</span>
          <span class="sxs-lookup">
            <span data-stu-id="db667-621">
              <paramref name="source" /> cannot be deleted because in the registry, the parent registry key for <paramref name="source" /> does not contain a subkey with the same name.</span>
          </span>
        </exception>
        <permission cref="T:System.Diagnostics.EventLogPermission">
          <span data-ttu-id="db667-622">用于管理计算机上的事件日志信息。</span>
          <span class="sxs-lookup">
            <span data-stu-id="db667-622">for administering event log information on the computer.</span>
          </span>
          <span data-ttu-id="db667-623">关联的枚举： <see cref="F:System.Diagnostics.EventLogPermissionAccess.Administer" /></span>
          <span class="sxs-lookup">
            <span data-stu-id="db667-623">Associated enumeration: <see cref="F:System.Diagnostics.EventLogPermissionAccess.Administer" /></span>
          </span>
        </permission>
        <altmember cref="Overload:System.Diagnostics.EventLog.CreateEventSource" />
        <altmember cref="P:System.Diagnostics.EventLog.Source" />
        <altmember cref="P:System.Diagnostics.EventLog.MachineName" />
        <altmember cref="M:System.Diagnostics.EventLog.SourceExists(System.String)" />
        <altmember cref="M:System.Diagnostics.EventLog.Delete(System.String)" />
        <altmember cref="M:System.Diagnostics.EventLog.Clear" />
      </Docs>
    </Member>
    <Member MemberName="Dispose">
      <MemberSignature Language="C#" Value="protected override void Dispose (bool disposing);" />
      <MemberSignature Language="ILAsm" Value=".method familyhidebysig virtual instance void Dispose(bool disposing) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Diagnostics.EventLog.Dispose(System.Boolean)" />
      <MemberSignature Language="VB.NET" Value="Protected Overrides Sub Dispose (disposing As Boolean)" />
      <MemberSignature Language="C++ CLI" Value="protected:&#xA; override void Dispose(bool disposing);" />
      <MemberSignature Language="F#" Value="override this.Dispose : bool -&gt; unit" Usage="eventLog.Dispose disposing" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System</AssemblyName>
        <AssemblyVersion>1.0.5000.0</AssemblyVersion>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Void</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="disposing" Type="System.Boolean" />
      </Parameters>
      <Docs>
        <param name="disposing">
          <span data-ttu-id="db667-624">若要释放托管资源和非托管资源，则为 <see langword="true" />；若仅释放非托管资源，则为 <see langword="false" />。</span>
          <span class="sxs-lookup">
            <span data-stu-id="db667-624">
              <see langword="true" /> to release both managed and unmanaged resources; <see langword="false" /> to release only unmanaged resources.</span>
          </span>
        </param>
        <summary>
          <span data-ttu-id="db667-625">释放由 <see cref="T:System.Diagnostics.EventLog" /> 占用的非托管资源，还可以另外再释放托管资源。</span>
          <span class="sxs-lookup">
            <span data-stu-id="db667-625">Releases the unmanaged resources used by the <see cref="T:System.Diagnostics.EventLog" />, and optionally releases the managed resources.</span>
          </span>
        </summary>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="db667-626">调用此方法由公共`Dispose()`方法和<xref:System.Object.Finalize%2A>方法。</span><span class="sxs-lookup"><span data-stu-id="db667-626">This method is called by the public `Dispose()` method and the <xref:System.Object.Finalize%2A> method.</span></span> <span data-ttu-id="db667-627">`Dispose()` 调用受保护`Dispose(Boolean)`方法替换`disposing`参数设置为`true`。</span><span class="sxs-lookup"><span data-stu-id="db667-627">`Dispose()` invokes the protected `Dispose(Boolean)` method with the `disposing` parameter set to `true`.</span></span> <span data-ttu-id="db667-628"><xref:System.Object.Finalize%2A> 调用`Dispose`与`disposing`设置为`false`。</span><span class="sxs-lookup"><span data-stu-id="db667-628"><xref:System.Object.Finalize%2A> invokes `Dispose` with `disposing` set to `false`.</span></span>  
  
 <span data-ttu-id="db667-629">当`disposing`参数为 true 时，此方法释放任何托管对象所持有的所有资源，此<xref:System.Diagnostics.EventLog>的引用。</span><span class="sxs-lookup"><span data-stu-id="db667-629">When the `disposing` parameter is true, this method releases all resources held by any managed objects that this <xref:System.Diagnostics.EventLog> references.</span></span> <span data-ttu-id="db667-630">此方法调用每个引用对象的 `Dispose()` 方法。</span><span class="sxs-lookup"><span data-stu-id="db667-630">This method invokes the `Dispose()` method of each referenced object.</span></span>  
  
 ]]></format>
        </remarks>
        <block subset="none" type="overrides">
          <span data-ttu-id="db667-631">
            <para>
              <see langword="Dispose" /> 可以多次调用由其他对象。重写时<see langword="Dispose(Boolean)" />小心不要引用已经释放的早期调用中的对象<see langword="Dispose" />。有关如何实现详细信息<see langword="Dispose(Boolean)" />，请参阅[实现 Dispose 方法](~/docs/standard/garbage-collection/implementing-dispose.md)。有关详细信息<see langword="Dispose" />并<see cref="M:System.Object.Finalize" />，请参阅[清理了非托管资源](~/docs/standard/garbage-collection/unmanaged.md)。</para>
          </span>
          <span class="sxs-lookup">
            <span data-stu-id="db667-631">
              <para>
                <see langword="Dispose" /> can be called multiple times by other objects. When overriding <see langword="Dispose(Boolean)" /> be careful not to reference objects that have been previously disposed of in an earlier call to <see langword="Dispose" />. For more information about how to implement <see langword="Dispose(Boolean)" />, see [Implementing a Dispose Method](~/docs/standard/garbage-collection/implementing-dispose.md).  For more information about <see langword="Dispose" /> and <see cref="M:System.Object.Finalize" />, see [Cleaning Up Unmanaged Resources](~/docs/standard/garbage-collection/unmanaged.md).</para>
            </span>
          </span>
        </block>
      </Docs>
    </Member>
    <Member MemberName="EnableRaisingEvents">
      <MemberSignature Language="C#" Value="public bool EnableRaisingEvents { get; set; }" />
      <MemberSignature Language="ILAsm" Value=".property instance bool EnableRaisingEvents" />
      <MemberSignature Language="DocId" Value="P:System.Diagnostics.EventLog.EnableRaisingEvents" />
      <MemberSignature Language="VB.NET" Value="Public Property EnableRaisingEvents As Boolean" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; property bool EnableRaisingEvents { bool get(); void set(bool value); };" />
      <MemberSignature Language="F#" Value="member this.EnableRaisingEvents : bool with get, set" Usage="System.Diagnostics.EventLog.EnableRaisingEvents" />
      <MemberType>Property</MemberType>
      <AssemblyInfo>
        <AssemblyName>System</AssemblyName>
        <AssemblyVersion>1.0.5000.0</AssemblyVersion>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Attributes>
        <Attribute FrameworkAlternate="netframework-1.1;netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;xamarinmac-3.0">
          <AttributeName>System.ComponentModel.Browsable(false)</AttributeName>
        </Attribute>
        <Attribute FrameworkAlternate="netframework-1.1;netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;xamarinmac-3.0">
          <AttributeName>System.ComponentModel.DefaultValue(false)</AttributeName>
        </Attribute>
        <Attribute FrameworkAlternate="xamarinmac-3.0">
          <AttributeName>System.Diagnostics.MonitoringDescription("If enabled raises event when a log is written.")</AttributeName>
        </Attribute>
        <Attribute FrameworkAlternate="netframework-1.1;netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2">
          <AttributeName>System.Diagnostics.MonitoringDescription("LogMonitoring")</AttributeName>
        </Attribute>
      </Attributes>
      <ReturnValue>
        <ReturnType>System.Boolean</ReturnType>
      </ReturnValue>
      <Docs>
        <summary>
          <span data-ttu-id="db667-632">获取或设置一个值，用以指示 <see cref="T:System.Diagnostics.EventLog" /> 是否接收 <see cref="E:System.Diagnostics.EventLog.EntryWritten" /> 事件通知。</span>
          <span class="sxs-lookup">
            <span data-stu-id="db667-632">Gets or sets a value indicating whether the <see cref="T:System.Diagnostics.EventLog" /> receives <see cref="E:System.Diagnostics.EventLog.EntryWritten" /> event notifications.</span>
          </span>
        </summary>
        <value>
          <span data-ttu-id="db667-633">如果 <see cref="T:System.Diagnostics.EventLog" /> 在有项写入日志时接收通知，则为 <see langword="true" />；否则为 <see langword="false" />。</span>
          <span class="sxs-lookup">
            <span data-stu-id="db667-633">
              <see langword="true" /> if the <see cref="T:System.Diagnostics.EventLog" /> receives notification when an entry is written to the log; otherwise, <see langword="false" />.</span>
          </span>
        </value>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="db667-634"><xref:System.Diagnostics.EventLog.EnableRaisingEvents%2A>属性确定是否<xref:System.Diagnostics.EventLog>条目写入到日志时引发事件。</span><span class="sxs-lookup"><span data-stu-id="db667-634">The <xref:System.Diagnostics.EventLog.EnableRaisingEvents%2A> property determines whether the <xref:System.Diagnostics.EventLog> raises events when entries are written to the log.</span></span> <span data-ttu-id="db667-635">当该属性是`true`，接收的组件<xref:System.Diagnostics.EventLog.EntryWritten>事件将收到通知任何时间中指定的日志中写入一项<xref:System.Diagnostics.EventLog.Log%2A>属性。</span><span class="sxs-lookup"><span data-stu-id="db667-635">When the property is `true`, components that receive the <xref:System.Diagnostics.EventLog.EntryWritten> event will receive notification any time an entry is written to the log that is specified in the <xref:System.Diagnostics.EventLog.Log%2A> property.</span></span> <span data-ttu-id="db667-636">如果<xref:System.Diagnostics.EventLog.EnableRaisingEvents%2A>是`false`，会引发任何事件。</span><span class="sxs-lookup"><span data-stu-id="db667-636">If <xref:System.Diagnostics.EventLog.EnableRaisingEvents%2A> is `false`, no events are raised.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="db667-637">仅当在本地计算机上写入条目时，可以接收事件通知。</span><span class="sxs-lookup"><span data-stu-id="db667-637">You can receive event notifications only when entries are written on the local computer.</span></span> <span data-ttu-id="db667-638">不能接收在远程计算机上写入项的通知。</span><span class="sxs-lookup"><span data-stu-id="db667-638">You cannot receive notifications for entries written on remote computers.</span></span>  
  
   
  
## Examples  
 <span data-ttu-id="db667-639">下面的示例处理<xref:System.Diagnostics.EventLog.EntryWritten>事件。</span><span class="sxs-lookup"><span data-stu-id="db667-639">The following example handles an <xref:System.Diagnostics.EventLog.EntryWritten> event.</span></span>  
  
 [!code-cpp[Classic EventLog.EnableRaisingEvents Example#1](~/samples/snippets/cpp/VS_Snippets_CLR_Classic/classic EventLog.EnableRaisingEvents Example/CPP/source.cpp#1)]
 [!code-csharp[Classic EventLog.EnableRaisingEvents Example#1](~/samples/snippets/csharp/VS_Snippets_CLR_Classic/classic EventLog.EnableRaisingEvents Example/CS/source.cs#1)]
 [!code-vb[Classic EventLog.EnableRaisingEvents Example#1](~/samples/snippets/visualbasic/VS_Snippets_CLR_Classic/classic EventLog.EnableRaisingEvents Example/VB/source.vb#1)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.InvalidOperationException">
          <span data-ttu-id="db667-640">事件日志位于远程计算机上。</span>
          <span class="sxs-lookup">
            <span data-stu-id="db667-640">The event log is on a remote computer.</span>
          </span>
        </exception>
        <permission cref="T:System.Diagnostics.EventLogPermission">
          <span data-ttu-id="db667-641">用于写入的计算机上的事件日志信息。</span>
          <span class="sxs-lookup">
            <span data-stu-id="db667-641">for writing the event log information on the computer.</span>
          </span>
          <span data-ttu-id="db667-642">关联的枚举： <see cref="F:System.Diagnostics.EventLogPermissionAccess.Write" /></span>
          <span class="sxs-lookup">
            <span data-stu-id="db667-642">Associated enumeration: <see cref="F:System.Diagnostics.EventLogPermissionAccess.Write" /></span>
          </span>
        </permission>
        <altmember cref="E:System.Diagnostics.EventLog.EntryWritten" />
      </Docs>
    </Member>
    <Member MemberName="EndInit">
      <MemberSignature Language="C#" Value="public void EndInit ();" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig newslot virtual instance void EndInit() cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Diagnostics.EventLog.EndInit" />
      <MemberSignature Language="VB.NET" Value="Public Sub EndInit ()" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; virtual void EndInit();" />
      <MemberSignature Language="F#" Value="abstract member EndInit : unit -&gt; unit&#xA;override this.EndInit : unit -&gt; unit" Usage="eventLog.EndInit " />
      <MemberType>Method</MemberType>
      <Implements>
        <InterfaceMember>M:System.ComponentModel.ISupportInitialize.EndInit</InterfaceMember>
      </Implements>
      <AssemblyInfo>
        <AssemblyName>System</AssemblyName>
        <AssemblyVersion>1.0.5000.0</AssemblyVersion>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Void</ReturnType>
      </ReturnValue>
      <Parameters />
      <Docs>
        <summary>
          <span data-ttu-id="db667-643">结束用于窗体或由其他组件使用的 <see cref="T:System.Diagnostics.EventLog" /> 的初始化。</span>
          <span class="sxs-lookup">
            <span data-stu-id="db667-643">Ends the initialization of an <see cref="T:System.Diagnostics.EventLog" /> used on a form or by another component.</span>
          </span>
          <span data-ttu-id="db667-644">此初始化在运行时发生。</span>
          <span class="sxs-lookup">
            <span data-stu-id="db667-644">The initialization occurs at runtime.</span>
          </span>
        </summary>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="db667-645">[!INCLUDE[vsprvslong](~/includes/vsprvslong-md.md)]设计环境使用此方法来结束用于窗体或由另一个组件的组件的初始化。</span><span class="sxs-lookup"><span data-stu-id="db667-645">The [!INCLUDE[vsprvslong](~/includes/vsprvslong-md.md)] design environment uses this method to end the initialization of a component used on a form or by another component.</span></span> <span data-ttu-id="db667-646"><xref:System.Diagnostics.EventLog.BeginInit%2A>方法开始初始化。</span><span class="sxs-lookup"><span data-stu-id="db667-646">The <xref:System.Diagnostics.EventLog.BeginInit%2A> method starts the initialization.</span></span> <span data-ttu-id="db667-647">使用<xref:System.Diagnostics.EventLog.BeginInit%2A>和<xref:System.Diagnostics.EventLog.EndInit%2A>方法可以防止该控件完全初始化之前使用。</span><span class="sxs-lookup"><span data-stu-id="db667-647">Using the <xref:System.Diagnostics.EventLog.BeginInit%2A> and <xref:System.Diagnostics.EventLog.EndInit%2A> methods prevents the control from being used before it is fully initialized.</span></span>  
  
 ]]></format>
        </remarks>
        <permission cref="T:System.Diagnostics.EventLogPermission">
          <span data-ttu-id="db667-648">用于写入的计算机上的事件日志信息。</span>
          <span class="sxs-lookup">
            <span data-stu-id="db667-648">for writing the event log information on the computer.</span>
          </span>
          <span data-ttu-id="db667-649">关联的枚举： <see cref="F:System.Diagnostics.EventLogPermissionAccess.Write" /></span>
          <span class="sxs-lookup">
            <span data-stu-id="db667-649">Associated enumeration: <see cref="F:System.Diagnostics.EventLogPermissionAccess.Write" /></span>
          </span>
        </permission>
        <altmember cref="M:System.Diagnostics.EventLog.BeginInit" />
      </Docs>
    </Member>
    <Member MemberName="Entries">
      <MemberSignature Language="C#" Value="public System.Diagnostics.EventLogEntryCollection Entries { get; }" />
      <MemberSignature Language="ILAsm" Value=".property instance class System.Diagnostics.EventLogEntryCollection Entries" />
      <MemberSignature Language="DocId" Value="P:System.Diagnostics.EventLog.Entries" />
      <MemberSignature Language="VB.NET" Value="Public ReadOnly Property Entries As EventLogEntryCollection" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; property System::Diagnostics::EventLogEntryCollection ^ Entries { System::Diagnostics::EventLogEntryCollection ^ get(); };" />
      <MemberSignature Language="F#" Value="member this.Entries : System.Diagnostics.EventLogEntryCollection" Usage="System.Diagnostics.EventLog.Entries" />
      <MemberType>Property</MemberType>
      <AssemblyInfo>
        <AssemblyName>System</AssemblyName>
        <AssemblyVersion>1.0.5000.0</AssemblyVersion>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Attributes>
        <Attribute FrameworkAlternate="netframework-1.1;netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;xamarinmac-3.0">
          <AttributeName>System.ComponentModel.Browsable(false)</AttributeName>
        </Attribute>
        <Attribute FrameworkAlternate="netframework-1.1;netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;xamarinmac-3.0">
          <AttributeName>System.ComponentModel.DesignerSerializationVisibility(System.ComponentModel.DesignerSerializationVisibility.Hidden)</AttributeName>
        </Attribute>
        <Attribute FrameworkAlternate="xamarinmac-3.0">
          <AttributeName>System.Diagnostics.MonitoringDescription("The entries in the log.")</AttributeName>
        </Attribute>
        <Attribute FrameworkAlternate="netframework-1.1;netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2">
          <AttributeName>System.Diagnostics.MonitoringDescription("LogEntries")</AttributeName>
        </Attribute>
      </Attributes>
      <ReturnValue>
        <ReturnType>System.Diagnostics.EventLogEntryCollection</ReturnType>
      </ReturnValue>
      <Docs>
        <summary>
          <span data-ttu-id="db667-650">获取事件日志的内容。</span>
          <span class="sxs-lookup">
            <span data-stu-id="db667-650">Gets the contents of the event log.</span>
          </span>
        </summary>
        <value>
          <span data-ttu-id="db667-651">
            <see cref="T:System.Diagnostics.EventLogEntryCollection" />，保留事件日志中的项。</span>
          <span class="sxs-lookup">
            <span data-stu-id="db667-651">An <see cref="T:System.Diagnostics.EventLogEntryCollection" /> holding the entries in the event log.</span>
          </span>
          <span data-ttu-id="db667-652">每个项均与 <see cref="T:System.Diagnostics.EventLogEntry" /> 类的一个实例关联。</span>
          <span class="sxs-lookup">
            <span data-stu-id="db667-652">Each entry is associated with an instance of the <see cref="T:System.Diagnostics.EventLogEntry" /> class.</span>
          </span>
        </value>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="db667-653">使用<xref:System.Diagnostics.EventLog.Entries%2A>时从事件日志读取的成员。</span><span class="sxs-lookup"><span data-stu-id="db667-653">Use the <xref:System.Diagnostics.EventLog.Entries%2A> member when reading from the event log.</span></span>  
  
 <span data-ttu-id="db667-654">因为该属性是只读的不能修改该条目或写入到日志使用<xref:System.Diagnostics.EventLog.Entries%2A>。</span><span class="sxs-lookup"><span data-stu-id="db667-654">Because the property is read-only, you cannot modify an entry or write to the log using <xref:System.Diagnostics.EventLog.Entries%2A>.</span></span> <span data-ttu-id="db667-655">而应指定<xref:System.Diagnostics.EventLog.Source%2A>，并调用<xref:System.Diagnostics.EventLog.WriteEntry%2A>编写新的日志条目。</span><span class="sxs-lookup"><span data-stu-id="db667-655">Instead, specify a <xref:System.Diagnostics.EventLog.Source%2A> and call <xref:System.Diagnostics.EventLog.WriteEntry%2A> to write a new log entry.</span></span> <span data-ttu-id="db667-656">可以使用<xref:System.Diagnostics.EventLog.Entries%2A>若要计算的事件日志中的条目数，并查看每个<xref:System.Diagnostics.EventLogEntry>集合中。</span><span class="sxs-lookup"><span data-stu-id="db667-656">You can use <xref:System.Diagnostics.EventLog.Entries%2A> to count the number of entries in the event log, and view each <xref:System.Diagnostics.EventLogEntry> in the collection.</span></span> <span data-ttu-id="db667-657">使用已编制索引<xref:System.Diagnostics.EventLogEntryCollection.Item%2A>成员，才能检索特定项有关的信息，如<xref:System.Diagnostics.EventLogEntry.Message%2A>， <xref:System.Diagnostics.EventLogEntry.Category%2A>， <xref:System.Diagnostics.EventLogEntry.TimeWritten%2A>，或<xref:System.Diagnostics.EventLogEntry.EntryType%2A>。</span><span class="sxs-lookup"><span data-stu-id="db667-657">Use the indexed <xref:System.Diagnostics.EventLogEntryCollection.Item%2A> member to retrieve information about a specific entry, such as <xref:System.Diagnostics.EventLogEntry.Message%2A>, <xref:System.Diagnostics.EventLogEntry.Category%2A>, <xref:System.Diagnostics.EventLogEntry.TimeWritten%2A>, or <xref:System.Diagnostics.EventLogEntry.EntryType%2A>.</span></span>  
  
 <span data-ttu-id="db667-658">不需要指定<xref:System.Diagnostics.EventLog.Source%2A>仅从日志中读取。</span><span class="sxs-lookup"><span data-stu-id="db667-658">It is not necessary to specify a <xref:System.Diagnostics.EventLog.Source%2A> when only reading from a log.</span></span> <span data-ttu-id="db667-659">可以仅指定<xref:System.Diagnostics.EventLog.Log%2A>名称和<xref:System.Diagnostics.EventLog.MachineName%2A>（服务器计算机名称） 属性<xref:System.Diagnostics.EventLog>实例。</span><span class="sxs-lookup"><span data-stu-id="db667-659">You can specify only the <xref:System.Diagnostics.EventLog.Log%2A> name and <xref:System.Diagnostics.EventLog.MachineName%2A> (server computer name) properties for the <xref:System.Diagnostics.EventLog> instance.</span></span> <span data-ttu-id="db667-660">在任一情况下，<xref:System.Diagnostics.EventLog.Entries%2A>成员会自动填充的项的事件日志的列表。</span><span class="sxs-lookup"><span data-stu-id="db667-660">In either case, the <xref:System.Diagnostics.EventLog.Entries%2A> member is automatically populated with the event log's list of entries.</span></span> <span data-ttu-id="db667-661">在此列表中读取各项，可以选择适当的项的索引。</span><span class="sxs-lookup"><span data-stu-id="db667-661">You can select the appropriate index for an item in this list to read individual entries.</span></span>  
  
 <span data-ttu-id="db667-662">读取和写入日志条目之间的重要区别是不需要显式调用读取的方法。</span><span class="sxs-lookup"><span data-stu-id="db667-662">An important distinction between reading and writing log entries is that it is not necessary to explicitly call a read method.</span></span> <span data-ttu-id="db667-663">之后<xref:System.Diagnostics.EventLog.Log%2A>并<xref:System.Diagnostics.EventLog.MachineName%2A>指定，<xref:System.Diagnostics.EventLog.Entries%2A>属性自动填充。</span><span class="sxs-lookup"><span data-stu-id="db667-663">After the <xref:System.Diagnostics.EventLog.Log%2A> and <xref:System.Diagnostics.EventLog.MachineName%2A> are specified, the <xref:System.Diagnostics.EventLog.Entries%2A> property is automatically populated.</span></span> <span data-ttu-id="db667-664">如果您更改的值<xref:System.Diagnostics.EventLog.Log%2A>或<xref:System.Diagnostics.EventLog.MachineName%2A>属性，<xref:System.Diagnostics.EventLog.Entries%2A>属性重新读取它的下一个时间。</span><span class="sxs-lookup"><span data-stu-id="db667-664">If you change the value of the <xref:System.Diagnostics.EventLog.Log%2A> or <xref:System.Diagnostics.EventLog.MachineName%2A> property, the <xref:System.Diagnostics.EventLog.Entries%2A> property is repopulated the next time you read it.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="db667-665">您不需要指定<xref:System.Diagnostics.EventLog.MachineName%2A>如果要连接到日志。</span><span class="sxs-lookup"><span data-stu-id="db667-665">You are not required to specify the <xref:System.Diagnostics.EventLog.MachineName%2A> if you are connecting to a log.</span></span> <span data-ttu-id="db667-666">如果未指定<xref:System.Diagnostics.EventLog.MachineName%2A>，本地计算机"。"，则假定。</span><span class="sxs-lookup"><span data-stu-id="db667-666">If you do not specify the <xref:System.Diagnostics.EventLog.MachineName%2A>, the local computer, ".", is assumed.</span></span>  
  
   
  
## Examples  
 <span data-ttu-id="db667-667">下面的示例读取事件日志中，"MyNewLog"本地计算机上的条目。</span><span class="sxs-lookup"><span data-stu-id="db667-667">The following example reads entries in the event log, "MyNewLog", on the local computer.</span></span>  
  
 [!code-cpp[Classic EventLog.Entries Example#1](~/samples/snippets/cpp/VS_Snippets_CLR_Classic/classic EventLog.Entries Example/CPP/source.cpp#1)]
 [!code-csharp[Classic EventLog.Entries Example#1](~/samples/snippets/csharp/VS_Snippets_CLR_Classic/classic EventLog.Entries Example/CS/source.cs#1)]
 [!code-vb[Classic EventLog.Entries Example#1](~/samples/snippets/visualbasic/VS_Snippets_CLR_Classic/classic EventLog.Entries Example/VB/source.vb#1)]  
  
 ]]></format>
        </remarks>
        <permission cref="T:System.Diagnostics.EventLogPermission">
          <span data-ttu-id="db667-668">用于管理计算机上的事件日志信息。</span>
          <span class="sxs-lookup">
            <span data-stu-id="db667-668">for administering event log information on the computer.</span>
          </span>
          <span data-ttu-id="db667-669">关联的枚举： <see cref="F:System.Diagnostics.EventLogPermissionAccess.Administer" /></span>
          <span class="sxs-lookup">
            <span data-stu-id="db667-669">Associated enumeration: <see cref="F:System.Diagnostics.EventLogPermissionAccess.Administer" /></span>
          </span>
        </permission>
        <altmember cref="T:System.Diagnostics.EventLogEntryCollection" />
        <altmember cref="T:System.Diagnostics.EventLogEntry" />
        <altmember cref="P:System.Diagnostics.EventLog.Source" />
        <altmember cref="P:System.Diagnostics.EventLog.Log" />
        <altmember cref="P:System.Diagnostics.EventLog.MachineName" />
        <altmember cref="Overload:System.Diagnostics.EventLog.WriteEntry" />
      </Docs>
    </Member>
    <Member MemberName="EntryWritten">
      <MemberSignature Language="C#" Value="public event System.Diagnostics.EntryWrittenEventHandler EntryWritten;" />
      <MemberSignature Language="ILAsm" Value=".event class System.Diagnostics.EntryWrittenEventHandler EntryWritten" />
      <MemberSignature Language="DocId" Value="E:System.Diagnostics.EventLog.EntryWritten" />
      <MemberSignature Language="VB.NET" Value="Public Custom Event EntryWritten As EntryWrittenEventHandler " />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; event System::Diagnostics::EntryWrittenEventHandler ^ EntryWritten;" />
      <MemberSignature Language="F#" Value="member this.EntryWritten : System.Diagnostics.EntryWrittenEventHandler " Usage="member this.EntryWritten : System.Diagnostics.EntryWrittenEventHandler " />
      <MemberType>Event</MemberType>
      <AssemblyInfo>
        <AssemblyName>System</AssemblyName>
        <AssemblyVersion>1.0.5000.0</AssemblyVersion>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Attributes>
        <Attribute FrameworkAlternate="xamarinmac-3.0">
          <AttributeName>System.Diagnostics.MonitoringDescription("Raised for each EventLog entry written.")</AttributeName>
        </Attribute>
        <Attribute FrameworkAlternate="netframework-1.1;netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2">
          <AttributeName>System.Diagnostics.MonitoringDescription("LogEntryWritten")</AttributeName>
        </Attribute>
      </Attributes>
      <ReturnValue>
        <ReturnType>System.Diagnostics.EntryWrittenEventHandler</ReturnType>
      </ReturnValue>
      <Docs>
        <summary>
          <span data-ttu-id="db667-670">向本地计算机上的事件日志写入项时发生。</span>
          <span class="sxs-lookup">
            <span data-stu-id="db667-670">Occurs when an entry is written to an event log on the local computer.</span>
          </span>
        </summary>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="db667-671">若要获取事件通知，必须设置<xref:System.Diagnostics.EventLog.EnableRaisingEvents%2A>到`true`。</span><span class="sxs-lookup"><span data-stu-id="db667-671">To get event notifications, you must set <xref:System.Diagnostics.EventLog.EnableRaisingEvents%2A> to `true`.</span></span> <span data-ttu-id="db667-672">只能在本地计算机上写入项时，才能接收事件通知。</span><span class="sxs-lookup"><span data-stu-id="db667-672">You can only receive event notifications when entries are written on the local computer.</span></span> <span data-ttu-id="db667-673">不能接收在远程计算机上写入项的通知。</span><span class="sxs-lookup"><span data-stu-id="db667-673">You cannot receive notifications for entries written on remote computers.</span></span>  
  
 <span data-ttu-id="db667-674">创建 <xref:System.Diagnostics.EventLog.EntryWritten> 委托时，需要标识将要处理该事件的方法。</span><span class="sxs-lookup"><span data-stu-id="db667-674">When you create an <xref:System.Diagnostics.EventLog.EntryWritten> delegate, you identify the method that will handle the event.</span></span> <span data-ttu-id="db667-675">若要将事件与事件处理程序关联，请将该委托的一个实例添加到事件中。</span><span class="sxs-lookup"><span data-stu-id="db667-675">To associate the event with your event handler, add an instance of the delegate to the event.</span></span> <span data-ttu-id="db667-676">只要发生此事件，直到您删除委托调用事件处理程序。</span><span class="sxs-lookup"><span data-stu-id="db667-676">The event handler is called whenever the event occurs, until you remove the delegate.</span></span> <span data-ttu-id="db667-677">使用委托中处理事件的详细信息，请参阅[处理和引发事件](~/docs/standard/events/index.md)。</span><span class="sxs-lookup"><span data-stu-id="db667-677">For more information about handling events with delegates, see [Handling and Raising Events](~/docs/standard/events/index.md).</span></span>  
  
 <span data-ttu-id="db667-678">系统响应<xref:System.Diagnostics.EventLog.WriteEntry%2A>仅当最后一个的写入事件至少六个秒之前发生。</span><span class="sxs-lookup"><span data-stu-id="db667-678">The system responds to <xref:System.Diagnostics.EventLog.WriteEntry%2A> only if the last write event occurred at least six seconds previously.</span></span> <span data-ttu-id="db667-679">这意味着你将仅收到一个<xref:System.Diagnostics.EventLog.EntryWritten>六秒钟的间隔内的事件通知，即使多个事件日志更改时发生。</span><span class="sxs-lookup"><span data-stu-id="db667-679">This implies you will only receive one <xref:System.Diagnostics.EventLog.EntryWritten> event notification within a six-second interval, even if more than one event log change occurs.</span></span> <span data-ttu-id="db667-680">如果插入调用之间的足够长的休眠间隔 （约 10 秒） <xref:System.Diagnostics.EventLog.WriteEntry%2A>，您不太可能错过了活动。</span><span class="sxs-lookup"><span data-stu-id="db667-680">If you insert a sufficiently long sleep interval (around 10 seconds) between calls to <xref:System.Diagnostics.EventLog.WriteEntry%2A>, you are less likely to miss an event.</span></span> <span data-ttu-id="db667-681">但是，如果更频繁地发生写入事件，您可能无法收到事件通知，直到下一个间隔。</span><span class="sxs-lookup"><span data-stu-id="db667-681">However, if write events occur more frequently, you might not recieve the event notification until the next interval.</span></span> <span data-ttu-id="db667-682">通常情况下，错过的事件通知将不丢失，而延迟。</span><span class="sxs-lookup"><span data-stu-id="db667-682">Typically, missed event notifications are not lost, but delayed.</span></span>  
  
   
  
## Examples  
 <span data-ttu-id="db667-683">下面的示例处理一个项写入事件。</span><span class="sxs-lookup"><span data-stu-id="db667-683">The following example handles an entry written event.</span></span>  
  
 [!code-cpp[Classic EventLog.EntryWritten Example#1](~/samples/snippets/cpp/VS_Snippets_CLR_Classic/classic EventLog.EntryWritten Example/CPP/source.cpp#1)]
 [!code-csharp[Classic EventLog.EntryWritten Example#1](~/samples/snippets/csharp/VS_Snippets_CLR_Classic/classic EventLog.EntryWritten Example/CS/source.cs#1)]
 [!code-vb[Classic EventLog.EntryWritten Example#1](~/samples/snippets/visualbasic/VS_Snippets_CLR_Classic/classic EventLog.EntryWritten Example/VB/source.vb#1)]  
  
 ]]></format>
        </remarks>
        <permission cref="T:System.Diagnostics.EventLogPermission">
          <span data-ttu-id="db667-684">用于管理计算机上的事件日志信息。</span>
          <span class="sxs-lookup">
            <span data-stu-id="db667-684">for administering event log information on the computer.</span>
          </span>
          <span data-ttu-id="db667-685">关联的枚举： <see cref="F:System.Diagnostics.EventLogPermissionAccess.Administer" /></span>
          <span class="sxs-lookup">
            <span data-stu-id="db667-685">Associated enumeration: <see cref="F:System.Diagnostics.EventLogPermissionAccess.Administer" /></span>
          </span>
        </permission>
        <altmember cref="P:System.Diagnostics.EventLog.EnableRaisingEvents" />
      </Docs>
    </Member>
    <MemberGroup MemberName="Exists">
      <AssemblyInfo>
        <AssemblyName>System</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Docs>
        <summary>
          <span data-ttu-id="db667-686">确定指定的日志是否存在。</span>
          <span class="sxs-lookup">
            <span data-stu-id="db667-686">Determines whether the specified log exists.</span>
          </span>
        </summary>
      </Docs>
    </MemberGroup>
    <Member MemberName="Exists">
      <MemberSignature Language="C#" Value="public static bool Exists (string logName);" />
      <MemberSignature Language="ILAsm" Value=".method public static hidebysig bool Exists(string logName) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Diagnostics.EventLog.Exists(System.String)" />
      <MemberSignature Language="VB.NET" Value="Public Shared Function Exists (logName As String) As Boolean" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; static bool Exists(System::String ^ logName);" />
      <MemberSignature Language="F#" Value="static member Exists : string -&gt; bool" Usage="System.Diagnostics.EventLog.Exists logName" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System</AssemblyName>
        <AssemblyVersion>1.0.5000.0</AssemblyVersion>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Attributes>
        <Attribute FrameworkAlternate="netframework-4.0">
          <AttributeName>System.Runtime.TargetedPatchingOptOut("Performance critical to inline this type of method across NGen image boundaries")</AttributeName>
        </Attribute>
      </Attributes>
      <ReturnValue>
        <ReturnType>System.Boolean</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="logName" Type="System.String" />
      </Parameters>
      <Docs>
        <param name="logName">
          <span data-ttu-id="db667-687">要搜索的日志的名称。</span>
          <span class="sxs-lookup">
            <span data-stu-id="db667-687">The name of the log to search for.</span>
          </span>
          <span data-ttu-id="db667-688">可能的值包括：“应用程序”、“安全性”、“系统”、其他应用程序特定的日志（如与 Active Directory 关联的日志）或计算机上的任何自定义日志。</span>
          <span class="sxs-lookup">
            <span data-stu-id="db667-688">Possible values include: Application, Security, System, other application-specific logs (such as those associated with Active Directory), or any custom log on the computer.</span>
          </span>
        </param>
        <summary>
          <span data-ttu-id="db667-689">确定该日志是否存在于本地计算机上。</span>
          <span class="sxs-lookup">
            <span data-stu-id="db667-689">Determines whether the log exists on the local computer.</span>
          </span>
        </summary>
        <returns>
          <span data-ttu-id="db667-690">如果该日志存在于本地计算机上，则为 <see langword="true" />；否则为 <see langword="false" />。</span>
          <span class="sxs-lookup">
            <span data-stu-id="db667-690">
              <see langword="true" /> if the log exists on the local computer; otherwise, <see langword="false" />.</span>
          </span>
        </returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="db667-691">使用此方法以确定本地计算机上是否存在一个日志。</span><span class="sxs-lookup"><span data-stu-id="db667-691">Use this method to determine if a log exists on the local computer.</span></span> <span data-ttu-id="db667-692">如果你想要确定源是否存在的本地计算机上，使用<xref:System.Diagnostics.EventLog.SourceExists%2A>。</span><span class="sxs-lookup"><span data-stu-id="db667-692">If you want to determine whether a source exists on the local computer, use <xref:System.Diagnostics.EventLog.SourceExists%2A>.</span></span>  
  
 <span data-ttu-id="db667-693">由于此方法访问注册表，您必须在本地计算机，则拥有相应的注册表权限否则，查询将返回`false`。</span><span class="sxs-lookup"><span data-stu-id="db667-693">Because this method accesses the registry, you must have the appropriate registry permissions on the local computer; otherwise, the query returns `false`.</span></span>  
  
 <span data-ttu-id="db667-694">由于无法在同一台计算机上为新的日志的现有的日志名称，此方法用于创建新日志之前确定是否指定`logName`本地计算机上已存在。</span><span class="sxs-lookup"><span data-stu-id="db667-694">Because you cannot give a new log the name of an existing log on the same computer, use this method before creating a new log to determine if the specified `logName` already exists on the local computer.</span></span> <span data-ttu-id="db667-695">`logName`参数不区分大小写。</span><span class="sxs-lookup"><span data-stu-id="db667-695">The `logName` parameter is not case sensitive.</span></span>  
  
 <span data-ttu-id="db667-696"><xref:System.Diagnostics.EventLog.Exists%2A> 是`static`方法，使其可以调用类本身上。</span><span class="sxs-lookup"><span data-stu-id="db667-696"><xref:System.Diagnostics.EventLog.Exists%2A> is a `static` method, so it can be called on the class itself.</span></span> <span data-ttu-id="db667-697">不需要创建的实例<xref:System.Diagnostics.EventLog>调用<xref:System.Diagnostics.EventLog.Exists%2A>。</span><span class="sxs-lookup"><span data-stu-id="db667-697">It is not necessary to create an instance of <xref:System.Diagnostics.EventLog> to call <xref:System.Diagnostics.EventLog.Exists%2A>.</span></span>  
  
   
  
## Examples  
 [!code-cpp[EventLog_Exists_1#1](~/samples/snippets/cpp/VS_Snippets_CLR/EventLog_Exists_1/CPP/eventlog_exists_1.cpp#1)]
 [!code-csharp[EventLog_Exists_1#1](~/samples/snippets/csharp/VS_Snippets_CLR/EventLog_Exists_1/CS/eventlog_exists_1.cs#1)]
 [!code-vb[EventLog_Exists_1#1](~/samples/snippets/visualbasic/VS_Snippets_CLR/EventLog_Exists_1/VB/eventlog_exists_1.vb#1)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentException">
          <span data-ttu-id="db667-698">logName 为 <see langword="null" /> 或该值为空。</span>
          <span class="sxs-lookup">
            <span data-stu-id="db667-698">The logName is <see langword="null" /> or the value is empty.</span>
          </span>
        </exception>
        <permission cref="T:System.Diagnostics.EventLogPermission">
          <span data-ttu-id="db667-699">用于管理计算机上的事件日志信息。</span>
          <span class="sxs-lookup">
            <span data-stu-id="db667-699">for administering event log information on the computer.</span>
          </span>
          <span data-ttu-id="db667-700">关联的枚举： <see cref="F:System.Diagnostics.EventLogPermissionAccess.Administer" /></span>
          <span class="sxs-lookup">
            <span data-stu-id="db667-700">Associated enumeration: <see cref="F:System.Diagnostics.EventLogPermissionAccess.Administer" /></span>
          </span>
        </permission>
        <altmember cref="Overload:System.Diagnostics.EventLog.CreateEventSource" />
        <altmember cref="M:System.Diagnostics.EventLog.Delete(System.String)" />
        <altmember cref="M:System.Diagnostics.EventLog.SourceExists(System.String)" />
        <altmember cref="P:System.Diagnostics.EventLog.Log" />
      </Docs>
    </Member>
    <Member MemberName="Exists">
      <MemberSignature Language="C#" Value="public static bool Exists (string logName, string machineName);" />
      <MemberSignature Language="ILAsm" Value=".method public static hidebysig bool Exists(string logName, string machineName) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Diagnostics.EventLog.Exists(System.String,System.String)" />
      <MemberSignature Language="VB.NET" Value="Public Shared Function Exists (logName As String, machineName As String) As Boolean" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; static bool Exists(System::String ^ logName, System::String ^ machineName);" />
      <MemberSignature Language="F#" Value="static member Exists : string * string -&gt; bool" Usage="System.Diagnostics.EventLog.Exists (logName, machineName)" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System</AssemblyName>
        <AssemblyVersion>1.0.5000.0</AssemblyVersion>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Attributes>
        <Attribute FrameworkAlternate="xamarinmac-3.0">
          <AttributeName>System.MonoNotSupported("remote machine is not supported")</AttributeName>
        </Attribute>
      </Attributes>
      <ReturnValue>
        <ReturnType>System.Boolean</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="logName" Type="System.String" />
        <Parameter Name="machineName" Type="System.String" />
      </Parameters>
      <Docs>
        <param name="logName">
          <span data-ttu-id="db667-701">要搜索的日志。</span>
          <span class="sxs-lookup">
            <span data-stu-id="db667-701">The log for which to search.</span>
          </span>
          <span data-ttu-id="db667-702">可能的值包括：“应用程序”、“安全性”、“系统”、其他应用程序特定的日志（如与 Active Directory 关联的日志）或计算机上的任何自定义日志。</span>
          <span class="sxs-lookup">
            <span data-stu-id="db667-702">Possible values include: Application, Security, System, other application-specific logs (such as those associated with Active Directory), or any custom log on the computer.</span>
          </span>
        </param>
        <param name="machineName">
          <span data-ttu-id="db667-703">要在其上搜索日志的计算机的名称，对于本地计算机则为“.”。</span>
          <span class="sxs-lookup">
            <span data-stu-id="db667-703">The name of the computer on which to search for the log, or "." for the local computer.</span>
          </span>
        </param>
        <summary>
          <span data-ttu-id="db667-704">确定该日志是否存在于指定计算机上。</span>
          <span class="sxs-lookup">
            <span data-stu-id="db667-704">Determines whether the log exists on the specified computer.</span>
          </span>
        </summary>
        <returns>
          <span data-ttu-id="db667-705">如果该日志存在于指定的计算机上，则为 <see langword="true" />；否则为 <see langword="false" />。</span>
          <span class="sxs-lookup">
            <span data-stu-id="db667-705">
              <see langword="true" /> if the log exists on the specified computer; otherwise, <see langword="false" />.</span>
          </span>
        </returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="db667-706">使用此方法以确定远程计算机上是否存在一个日志。</span><span class="sxs-lookup"><span data-stu-id="db667-706">Use this method to determine if a log exists on a remote computer.</span></span> <span data-ttu-id="db667-707">如果你想要确定源是否存在的远程计算机上，使用<xref:System.Diagnostics.EventLog.SourceExists%2A>。</span><span class="sxs-lookup"><span data-stu-id="db667-707">If you want to determine whether a source exists on a remote computer, use <xref:System.Diagnostics.EventLog.SourceExists%2A>.</span></span>  
  
 <span data-ttu-id="db667-708">由于此方法访问注册表，必须指定计算机上具有相应的注册表权限否则，查询将返回`false`。</span><span class="sxs-lookup"><span data-stu-id="db667-708">Because this method accesses the registry, you must have the appropriate registry permissions on the specified computer; otherwise, the query returns `false`.</span></span>  
  
 <span data-ttu-id="db667-709">由于无法在同一台计算机上为新的日志的现有的日志名称，此方法用于创建新日志之前确定一个具有指定`logName`指定的服务器上已存在`machineName`参数。</span><span class="sxs-lookup"><span data-stu-id="db667-709">Because you cannot give a new log the name of an existing log on the same computer, use this method before creating a new log to determine if one with the specified `logName` already exists on the server specified by the `machineName` parameter.</span></span> <span data-ttu-id="db667-710">`logName`和`machineName`参数都不区分大小写。</span><span class="sxs-lookup"><span data-stu-id="db667-710">The `logName` and `machineName` parameters are not case sensitive.</span></span>  
  
 <span data-ttu-id="db667-711"><xref:System.Diagnostics.EventLog.Exists%2A> 是`static`方法，使其可以调用类本身上。</span><span class="sxs-lookup"><span data-stu-id="db667-711"><xref:System.Diagnostics.EventLog.Exists%2A> is a `static` method, so it can be called on the class itself.</span></span> <span data-ttu-id="db667-712">不需要创建的新实例<xref:System.Diagnostics.EventLog>调用<xref:System.Diagnostics.EventLog.Exists%2A>。</span><span class="sxs-lookup"><span data-stu-id="db667-712">It is not necessary to create a new instance of <xref:System.Diagnostics.EventLog> to call <xref:System.Diagnostics.EventLog.Exists%2A>.</span></span>  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentException">
          <span data-ttu-id="db667-713">
            <paramref name="machineName" /> 参数的格式无效。</span>
          <span class="sxs-lookup">
            <span data-stu-id="db667-713">The <paramref name="machineName" /> parameter is an invalid format.</span>
          </span>
          <span data-ttu-id="db667-714">请确保对在其上执行搜索的计算机使用了正确的语法。</span>
          <span class="sxs-lookup">
            <span data-stu-id="db667-714">Make sure you have used proper syntax for the computer on which you are searching.</span>
          </span>
          <span data-ttu-id="db667-715">或</span>
          <span class="sxs-lookup">
            <span data-stu-id="db667-715">-or-</span>
          </span>
          <span data-ttu-id="db667-716">
            <paramref name="logName" /> 为 <see langword="null" /> 或该值为空。</span>
          <span class="sxs-lookup">
            <span data-stu-id="db667-716">The <paramref name="logName" /> is <see langword="null" /> or the value is empty.</span>
          </span>
        </exception>
        <permission cref="T:System.Diagnostics.EventLogPermission">
          <span data-ttu-id="db667-717">用于管理计算机上的事件日志信息。</span>
          <span class="sxs-lookup">
            <span data-stu-id="db667-717">for administering event log information on the computer.</span>
          </span>
          <span data-ttu-id="db667-718">关联的枚举： <see cref="F:System.Diagnostics.EventLogPermissionAccess.Administer" /></span>
          <span class="sxs-lookup">
            <span data-stu-id="db667-718">Associated enumeration: <see cref="F:System.Diagnostics.EventLogPermissionAccess.Administer" /></span>
          </span>
        </permission>
        <altmember cref="Overload:System.Diagnostics.EventLog.CreateEventSource" />
        <altmember cref="M:System.Diagnostics.EventLog.Delete(System.String)" />
        <altmember cref="M:System.Diagnostics.EventLog.SourceExists(System.String)" />
        <altmember cref="P:System.Diagnostics.EventLog.Log" />
        <altmember cref="P:System.Diagnostics.EventLog.MachineName" />
      </Docs>
    </Member>
    <MemberGroup MemberName="GetEventLogs">
      <AssemblyInfo>
        <AssemblyName>System</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Docs>
        <summary>
          <span data-ttu-id="db667-719">创建事件日志的数组。</span>
          <span class="sxs-lookup">
            <span data-stu-id="db667-719">Creates an array of the event logs.</span>
          </span>
        </summary>
      </Docs>
    </MemberGroup>
    <Member MemberName="GetEventLogs">
      <MemberSignature Language="C#" Value="public static System.Diagnostics.EventLog[] GetEventLogs ();" />
      <MemberSignature Language="ILAsm" Value=".method public static hidebysig class System.Diagnostics.EventLog[] GetEventLogs() cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Diagnostics.EventLog.GetEventLogs" />
      <MemberSignature Language="VB.NET" Value="Public Shared Function GetEventLogs () As EventLog()" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; static cli::array &lt;System::Diagnostics::EventLog ^&gt; ^ GetEventLogs();" />
      <MemberSignature Language="F#" Value="static member GetEventLogs : unit -&gt; System.Diagnostics.EventLog[]" Usage="System.Diagnostics.EventLog.GetEventLogs " />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System</AssemblyName>
        <AssemblyVersion>1.0.5000.0</AssemblyVersion>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Attributes>
        <Attribute FrameworkAlternate="netframework-4.0">
          <AttributeName>System.Runtime.TargetedPatchingOptOut("Performance critical to inline this type of method across NGen image boundaries")</AttributeName>
        </Attribute>
      </Attributes>
      <ReturnValue>
        <ReturnType>System.Diagnostics.EventLog[]</ReturnType>
      </ReturnValue>
      <Parameters />
      <Docs>
        <summary>
          <span data-ttu-id="db667-720">在本地计算机上搜索所有的事件日志并创建一个包含该列表的 <see cref="T:System.Diagnostics.EventLog" /> 对象数组。</span>
          <span class="sxs-lookup">
            <span data-stu-id="db667-720">Searches for all event logs on the local computer and creates an array of <see cref="T:System.Diagnostics.EventLog" /> objects that contain the list.</span>
          </span>
        </summary>
        <returns>
          <span data-ttu-id="db667-721">
            <see cref="T:System.Diagnostics.EventLog" /> 类型的数组，表示本地计算机上的日志。</span>
          <span class="sxs-lookup">
            <span data-stu-id="db667-721">An array of type <see cref="T:System.Diagnostics.EventLog" /> that represents the logs on the local computer.</span>
          </span>
        </returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="db667-722">数组<xref:System.Diagnostics.EventLog>对象是在本地计算机上的所有事件日志的快照时对调用<xref:System.Diagnostics.EventLog.GetEventLogs%2A>进行。</span><span class="sxs-lookup"><span data-stu-id="db667-722">The array of <xref:System.Diagnostics.EventLog> objects is a snapshot of all event logs on the local computer when the call to <xref:System.Diagnostics.EventLog.GetEventLogs%2A> is made.</span></span> <span data-ttu-id="db667-723">这不是动态集合，因此它不反映删除或创建的实时日志。</span><span class="sxs-lookup"><span data-stu-id="db667-723">This is not a dynamic collection, so it does not reflect the deletion or creation of logs in real time.</span></span> <span data-ttu-id="db667-724">你应验证数组中的日志存在之前读取或写入到它。</span><span class="sxs-lookup"><span data-stu-id="db667-724">You should verify that a log in the array exists before you read or write to it.</span></span> <span data-ttu-id="db667-725">数组通常包括至少三个日志： 应用程序、 系统和安全。</span><span class="sxs-lookup"><span data-stu-id="db667-725">The array usually includes at least three logs: Application, System, and Security.</span></span> <span data-ttu-id="db667-726">如果在本地计算机上创建自定义日志，它们将显示以及数组中。</span><span class="sxs-lookup"><span data-stu-id="db667-726">If you created custom logs on the local computer, they will appear in the array as well.</span></span>  
  
 <span data-ttu-id="db667-727">若要检索事件日志的列表，您必须具有相应的注册表权限。</span><span class="sxs-lookup"><span data-stu-id="db667-727">To retrieve the list of event logs, you must have the appropriate registry permissions.</span></span> <span data-ttu-id="db667-728">这些权限是与调用所需的相同<xref:System.Diagnostics.EventLog.Exists%2A>和<xref:System.Diagnostics.EventLog.SourceExists%2A>。</span><span class="sxs-lookup"><span data-stu-id="db667-728">These permissions are identical to those required to call <xref:System.Diagnostics.EventLog.Exists%2A> and <xref:System.Diagnostics.EventLog.SourceExists%2A>.</span></span>  
  
   
  
## Examples  
 <span data-ttu-id="db667-729">下面的示例枚举在本地计算机上定义的事件日志，并显示每个事件日志的配置详细信息。</span><span class="sxs-lookup"><span data-stu-id="db667-729">The following example enumerates the event logs defined on the local computer, and displays configuration details for each event log.</span></span>  
  
 [!code-cpp[EventLogProperties#2](~/samples/snippets/cpp/VS_Snippets_CLR/EventLogProperties/CPP/source.cpp#2)]
 [!code-csharp[EventLogProperties#2](~/samples/snippets/csharp/VS_Snippets_CLR/EventLogProperties/CS/source.cs#2)]
 [!code-vb[EventLogProperties#2](~/samples/snippets/visualbasic/VS_Snippets_CLR/EventLogProperties/VB/source.vb#2)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.SystemException">
          <span data-ttu-id="db667-730">您对注册表没有读访问权。</span>
          <span class="sxs-lookup">
            <span data-stu-id="db667-730">You do not have read access to the registry.</span>
          </span>
          <span data-ttu-id="db667-731">或</span>
          <span class="sxs-lookup">
            <span data-stu-id="db667-731">-or-</span>
          </span>
          <span data-ttu-id="db667-732">计算机上没有事件日志服务。</span>
          <span class="sxs-lookup">
            <span data-stu-id="db667-732">There is no event log service on the computer.</span>
          </span>
        </exception>
        <permission cref="T:System.Diagnostics.EventLogPermission">
          <span data-ttu-id="db667-733">用于管理计算机上的事件日志信息。</span>
          <span class="sxs-lookup">
            <span data-stu-id="db667-733">for administering event log information on the computer.</span>
          </span>
          <span data-ttu-id="db667-734">关联的枚举： <see cref="F:System.Diagnostics.EventLogPermissionAccess.Administer" /></span>
          <span class="sxs-lookup">
            <span data-stu-id="db667-734">Associated enumeration: <see cref="F:System.Diagnostics.EventLogPermissionAccess.Administer" /></span>
          </span>
        </permission>
        <altmember cref="M:System.Diagnostics.EventLog.Exists(System.String)" />
        <altmember cref="P:System.Diagnostics.EventLog.Log" />
      </Docs>
    </Member>
    <Member MemberName="GetEventLogs">
      <MemberSignature Language="C#" Value="public static System.Diagnostics.EventLog[] GetEventLogs (string machineName);" />
      <MemberSignature Language="ILAsm" Value=".method public static hidebysig class System.Diagnostics.EventLog[] GetEventLogs(string machineName) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Diagnostics.EventLog.GetEventLogs(System.String)" />
      <MemberSignature Language="VB.NET" Value="Public Shared Function GetEventLogs (machineName As String) As EventLog()" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; static cli::array &lt;System::Diagnostics::EventLog ^&gt; ^ GetEventLogs(System::String ^ machineName);" />
      <MemberSignature Language="F#" Value="static member GetEventLogs : string -&gt; System.Diagnostics.EventLog[]" Usage="System.Diagnostics.EventLog.GetEventLogs machineName" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System</AssemblyName>
        <AssemblyVersion>1.0.5000.0</AssemblyVersion>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Attributes>
        <Attribute FrameworkAlternate="xamarinmac-3.0">
          <AttributeName>System.MonoNotSupported("remote machine is not supported")</AttributeName>
        </Attribute>
      </Attributes>
      <ReturnValue>
        <ReturnType>System.Diagnostics.EventLog[]</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="machineName" Type="System.String" />
      </Parameters>
      <Docs>
        <param name="machineName">
          <span data-ttu-id="db667-735">在其上搜索事件日志的计算机。</span>
          <span class="sxs-lookup">
            <span data-stu-id="db667-735">The computer on which to search for event logs.</span>
          </span>
        </param>
        <summary>
          <span data-ttu-id="db667-736">在给定计算机上搜索所有事件日志并创建一个包含该列表的 <see cref="T:System.Diagnostics.EventLog" /> 对象数组。</span>
          <span class="sxs-lookup">
            <span data-stu-id="db667-736">Searches for all event logs on the given computer and creates an array of <see cref="T:System.Diagnostics.EventLog" /> objects that contain the list.</span>
          </span>
        </summary>
        <returns>
          <span data-ttu-id="db667-737">
            <see cref="T:System.Diagnostics.EventLog" /> 类型的数组，表示给定计算机上的日志。</span>
          <span class="sxs-lookup">
            <span data-stu-id="db667-737">An array of type <see cref="T:System.Diagnostics.EventLog" /> that represents the logs on the given computer.</span>
          </span>
        </returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="db667-738">数组<xref:System.Diagnostics.EventLog>对象是指定的计算机上的所有事件日志的快照`machineName`参数时对调用<xref:System.Diagnostics.EventLog.GetEventLogs%2A>进行。</span><span class="sxs-lookup"><span data-stu-id="db667-738">The array of <xref:System.Diagnostics.EventLog> objects is a snapshot of all event logs on the computer specified by the `machineName` parameter when the call to <xref:System.Diagnostics.EventLog.GetEventLogs%2A> is made.</span></span> <span data-ttu-id="db667-739">这不是动态集合，因此它不反映删除或创建的实时日志。</span><span class="sxs-lookup"><span data-stu-id="db667-739">This is not a dynamic collection, so it does not reflect the deletion or creation of logs in real time.</span></span> <span data-ttu-id="db667-740">你应验证数组中的日志存在之前读取或写入到它。</span><span class="sxs-lookup"><span data-stu-id="db667-740">You should verify that a log in the array exists before you read or write to it.</span></span> <span data-ttu-id="db667-741">数组通常包括至少三个日志： 应用程序、 系统和安全。</span><span class="sxs-lookup"><span data-stu-id="db667-741">The array usually includes at least three logs: Application, System, and Security.</span></span> <span data-ttu-id="db667-742">如果在指定计算机上创建自定义日志，它们将显示以及数组中。</span><span class="sxs-lookup"><span data-stu-id="db667-742">If you created custom logs on the specified computer, they will appear in the array as well.</span></span>  
  
 <span data-ttu-id="db667-743"><xref:System.Diagnostics.EventLog.GetEventLogs%2A> 是`static`方法，使其可以调用上<xref:System.Diagnostics.EventLog>类本身。</span><span class="sxs-lookup"><span data-stu-id="db667-743"><xref:System.Diagnostics.EventLog.GetEventLogs%2A> is a `static` method, so it can be called on the <xref:System.Diagnostics.EventLog> class itself.</span></span> <span data-ttu-id="db667-744">不需要创建的实例<xref:System.Diagnostics.EventLog>对象，从而使对方法的调用。</span><span class="sxs-lookup"><span data-stu-id="db667-744">It is not necessary to create an instance of an <xref:System.Diagnostics.EventLog> object to make a call to the method.</span></span>  
  
 <span data-ttu-id="db667-745">若要检索事件日志的列表，您必须具有相应的注册表权限。</span><span class="sxs-lookup"><span data-stu-id="db667-745">To retrieve the list of event logs, you must have the appropriate registry permissions.</span></span> <span data-ttu-id="db667-746">这些权限是与调用所需的相同<xref:System.Diagnostics.EventLog.Exists%2A>和<xref:System.Diagnostics.EventLog.SourceExists%2A>。</span><span class="sxs-lookup"><span data-stu-id="db667-746">These permissions are identical to those required to call <xref:System.Diagnostics.EventLog.Exists%2A> and <xref:System.Diagnostics.EventLog.SourceExists%2A>.</span></span>  
  
   
  
## Examples  
 <span data-ttu-id="db667-747">下面的示例获取"myServer"的计算机上的一个日志列表。</span><span class="sxs-lookup"><span data-stu-id="db667-747">The following example gets a list of logs on the computer "myServer".</span></span> <span data-ttu-id="db667-748">然后，它将输出的每个日志的名称。</span><span class="sxs-lookup"><span data-stu-id="db667-748">It then outputs the name of each log.</span></span>  
  
 [!code-cpp[Classic EventLog.GetEventLogs1 Example#1](~/samples/snippets/cpp/VS_Snippets_CLR_Classic/classic EventLog.GetEventLogs1 Example/CPP/source.cpp#1)]
 [!code-csharp[Classic EventLog.GetEventLogs1 Example#1](~/samples/snippets/csharp/VS_Snippets_CLR_Classic/classic EventLog.GetEventLogs1 Example/CS/source.cs#1)]
 [!code-vb[Classic EventLog.GetEventLogs1 Example#1](~/samples/snippets/visualbasic/VS_Snippets_CLR_Classic/classic EventLog.GetEventLogs1 Example/VB/source.vb#1)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentException">
          <span data-ttu-id="db667-749">
            <paramref name="machineName" /> 参数是无效的计算机名称。</span>
          <span class="sxs-lookup">
            <span data-stu-id="db667-749">The <paramref name="machineName" /> parameter is an invalid computer name.</span>
          </span>
        </exception>
        <exception cref="T:System.InvalidOperationException">
          <span data-ttu-id="db667-750">您对注册表没有读访问权。</span>
          <span class="sxs-lookup">
            <span data-stu-id="db667-750">You do not have read access to the registry.</span>
          </span>
          <span data-ttu-id="db667-751">或</span>
          <span class="sxs-lookup">
            <span data-stu-id="db667-751">-or-</span>
          </span>
          <span data-ttu-id="db667-752">计算机上没有事件日志服务。</span>
          <span class="sxs-lookup">
            <span data-stu-id="db667-752">There is no event log service on the computer.</span>
          </span>
        </exception>
        <permission cref="T:System.Diagnostics.EventLogPermission">
          <span data-ttu-id="db667-753">用于管理计算机上的事件日志信息。</span>
          <span class="sxs-lookup">
            <span data-stu-id="db667-753">for administering event log information on the computer.</span>
          </span>
          <span data-ttu-id="db667-754">关联的枚举： <see cref="F:System.Diagnostics.EventLogPermissionAccess.Administer" /></span>
          <span class="sxs-lookup">
            <span data-stu-id="db667-754">Associated enumeration: <see cref="F:System.Diagnostics.EventLogPermissionAccess.Administer" /></span>
          </span>
        </permission>
        <altmember cref="M:System.Diagnostics.EventLog.Exists(System.String)" />
        <altmember cref="P:System.Diagnostics.EventLog.Log" />
        <altmember cref="P:System.Diagnostics.EventLog.MachineName" />
      </Docs>
    </Member>
    <Member MemberName="Log">
      <MemberSignature Language="C#" Value="public string Log { get; set; }" />
      <MemberSignature Language="ILAsm" Value=".property instance string Log" />
      <MemberSignature Language="DocId" Value="P:System.Diagnostics.EventLog.Log" />
      <MemberSignature Language="VB.NET" Value="Public Property Log As String" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; property System::String ^ Log { System::String ^ get(); void set(System::String ^ value); };" />
      <MemberSignature Language="F#" Value="member this.Log : string with get, set" Usage="System.Diagnostics.EventLog.Log" />
      <MemberType>Property</MemberType>
      <AssemblyInfo>
        <AssemblyName>System</AssemblyName>
        <AssemblyVersion>1.0.5000.0</AssemblyVersion>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Attributes>
        <Attribute FrameworkAlternate="netframework-1.1;netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;xamarinmac-3.0">
          <AttributeName>System.ComponentModel.DefaultValue("")</AttributeName>
        </Attribute>
        <Attribute FrameworkAlternate="netframework-1.1;netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;xamarinmac-3.0">
          <AttributeName>System.ComponentModel.ReadOnly(true)</AttributeName>
        </Attribute>
        <Attribute FrameworkAlternate="netframework-1.1;netframework-2.0;netframework-3.0;netframework-3.5;xamarinmac-3.0">
          <AttributeName>System.ComponentModel.RecommendedAsConfigurable(true)</AttributeName>
        </Attribute>
        <Attribute FrameworkAlternate="netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;xamarinmac-3.0">
          <AttributeName>System.ComponentModel.TypeConverter("System.Diagnostics.Design.LogConverter, System.Design, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b03f5f7f11d50a3a")</AttributeName>
        </Attribute>
        <Attribute FrameworkAlternate="xamarinmac-3.0">
          <AttributeName>System.Diagnostics.MonitoringDescription("Name of the log that is read and written.")</AttributeName>
        </Attribute>
        <Attribute FrameworkAlternate="netframework-1.1">
          <AttributeName>System.ComponentModel.TypeConverter("System.Diagnostics.Design.LogConverter, System.Design, Version=1.0.5000.0, Culture=neutral, PublicKeyToken=b03f5f7f11d50a3a")</AttributeName>
        </Attribute>
        <Attribute FrameworkAlternate="netframework-1.1;netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2">
          <AttributeName>System.Diagnostics.MonitoringDescription("LogLog")</AttributeName>
        </Attribute>
        <Attribute FrameworkAlternate="netframework-2.0;netframework-3.0;netframework-3.5">
          <AttributeName>System.ComponentModel.TypeConverter("System.Diagnostics.Design.LogConverter, System.Design, Version=2.0.0.0, Culture=neutral, PublicKeyToken=b03f5f7f11d50a3a")</AttributeName>
        </Attribute>
        <Attribute FrameworkAlternate="netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2">
          <AttributeName>System.ComponentModel.SettingsBindable(true)</AttributeName>
        </Attribute>
      </Attributes>
      <ReturnValue>
        <ReturnType>System.String</ReturnType>
      </ReturnValue>
      <Docs>
        <summary>
          <span data-ttu-id="db667-755">获取或设置读取或写入的日志名称。</span>
          <span class="sxs-lookup">
            <span data-stu-id="db667-755">Gets or sets the name of the log to read from or write to.</span>
          </span>
        </summary>
        <value>
          <span data-ttu-id="db667-756">日志的名称。</span>
          <span class="sxs-lookup">
            <span data-stu-id="db667-756">The name of the log.</span>
          </span>
          <span data-ttu-id="db667-757">这可以是“应用程序”、“系统”、“安全性”或一个自定义的日志名称。</span>
          <span class="sxs-lookup">
            <span data-stu-id="db667-757">This can be Application, System, Security, or a custom log name.</span>
          </span>
          <span data-ttu-id="db667-758">默认值为空字符串("")。</span>
          <span class="sxs-lookup">
            <span data-stu-id="db667-758">The default is an empty string ("").</span>
          </span>
        </value>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="db667-759">默认情况下，在服务器上存在三个日志文件： 应用程序、 系统和安全。</span><span class="sxs-lookup"><span data-stu-id="db667-759">Three log files exist by default on the server: Application, System, and Security.</span></span> <span data-ttu-id="db667-760">应用程序和服务使用的应用程序日志文件。</span><span class="sxs-lookup"><span data-stu-id="db667-760">Applications and services use the Application log file.</span></span> <span data-ttu-id="db667-761">设备驱动程序使用的系统日志文件。</span><span class="sxs-lookup"><span data-stu-id="db667-761">Device drivers use the System log file.</span></span> <span data-ttu-id="db667-762">审核打开的系统就会安全日志中生成成功和失败审核事件。</span><span class="sxs-lookup"><span data-stu-id="db667-762">The system generates success and failure audit events in the Security log when auditing is turned on.</span></span> <span data-ttu-id="db667-763">如果必须安装 Windows 服务器上的 Active Directory 等其他应用程序可能有其他默认日志文件。</span><span class="sxs-lookup"><span data-stu-id="db667-763">If you have other applications installed, like Active Directory on Windows servers, there might be other default log files.</span></span> <span data-ttu-id="db667-764">此外，您可以创建自定义日志文件的本地或远程计算机上。</span><span class="sxs-lookup"><span data-stu-id="db667-764">In addition, you can create custom log files on a local or remote computer.</span></span> <span data-ttu-id="db667-765">自定义日志可帮助组织您的项比您的组件将事件写入到默认应用程序日志时所允许的方式更详细的方式。</span><span class="sxs-lookup"><span data-stu-id="db667-765">Custom logs help organize your entries in a more detailed way than is allowed when your components write events to the default Application log.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="db667-766">日志名称被限制为八个字符。</span><span class="sxs-lookup"><span data-stu-id="db667-766">Log names are limited to eight characters.</span></span> <span data-ttu-id="db667-767">根据系统，MyLogSample1 和 MyLogSample2 是相同的日志。</span><span class="sxs-lookup"><span data-stu-id="db667-767">According to the system, MyLogSample1 and MyLogSample2 are the same log.</span></span>  
  
 <span data-ttu-id="db667-768">如果写入事件日志时，它没有足够可用于指定<xref:System.Diagnostics.EventLog.Log%2A>属性。</span><span class="sxs-lookup"><span data-stu-id="db667-768">If you write to an event log, it is not enough to specify the <xref:System.Diagnostics.EventLog.Log%2A> property.</span></span> <span data-ttu-id="db667-769">必须将关联<xref:System.Diagnostics.EventLog.Source%2A>与事件日志资源以将其连接到的特定日志的属性。</span><span class="sxs-lookup"><span data-stu-id="db667-769">You must associate a <xref:System.Diagnostics.EventLog.Source%2A> property with your event log resource to connect it to a particular log.</span></span> <span data-ttu-id="db667-770">不需要指定<xref:System.Diagnostics.EventLog.Source%2A>时仅从一个日志，但事件源中读取必须是与服务器的注册表中的事件日志资源相关联。</span><span class="sxs-lookup"><span data-stu-id="db667-770">It is not necessary to specify a <xref:System.Diagnostics.EventLog.Source%2A> when only reading from a log, but an event source must be associated with the event log resource in the server's registry.</span></span> <span data-ttu-id="db667-771">可以仅指定<xref:System.Diagnostics.EventLog.Log%2A>名称和<xref:System.Diagnostics.EventLog.MachineName%2A>（服务器计算机名称） 从其读取。</span><span class="sxs-lookup"><span data-stu-id="db667-771">You can specify only the <xref:System.Diagnostics.EventLog.Log%2A> name and <xref:System.Diagnostics.EventLog.MachineName%2A> (server computer name) to read from it.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="db667-772">您不需要指定<xref:System.Diagnostics.EventLog.MachineName%2A>如果要连接到日志。</span><span class="sxs-lookup"><span data-stu-id="db667-772">You are not required to specify the <xref:System.Diagnostics.EventLog.MachineName%2A> if you are connecting to a log.</span></span> <span data-ttu-id="db667-773">如果未指定<xref:System.Diagnostics.EventLog.MachineName%2A>，本地计算机 ("。") 假定。</span><span class="sxs-lookup"><span data-stu-id="db667-773">If you do not specify the <xref:System.Diagnostics.EventLog.MachineName%2A>, the local computer (".") is assumed.</span></span>  
  
 <span data-ttu-id="db667-774">如果<xref:System.Diagnostics.EventLog.Source%2A>未指定属性，调用<xref:System.Diagnostics.EventLog.Log%2A>如果，则返回空字符串<xref:System.Diagnostics.EventLog.Log%2A>未显式设置 (通过设置<xref:System.Diagnostics.EventLog.Log%2A>属性，或通过构造函数)。</span><span class="sxs-lookup"><span data-stu-id="db667-774">If the <xref:System.Diagnostics.EventLog.Source%2A> property has not been specified, a call to <xref:System.Diagnostics.EventLog.Log%2A> returns an empty string if <xref:System.Diagnostics.EventLog.Log%2A> has not been explicitly set (by setting the <xref:System.Diagnostics.EventLog.Log%2A> property, or through the constructor).</span></span> <span data-ttu-id="db667-775">如果<xref:System.Diagnostics.EventLog.Source%2A>已指定<xref:System.Diagnostics.EventLog.Log%2A>返回向其注册该源的日志的名称。</span><span class="sxs-lookup"><span data-stu-id="db667-775">If the <xref:System.Diagnostics.EventLog.Source%2A> has been specified, <xref:System.Diagnostics.EventLog.Log%2A> returns the name of the log to which that source was registered.</span></span>  
  
 <span data-ttu-id="db667-776">一个源一次只能注册到一个日志。</span><span class="sxs-lookup"><span data-stu-id="db667-776">A source can only be registered to one log at a time.</span></span> <span data-ttu-id="db667-777">如果<xref:System.Diagnostics.EventLog.Source%2A>属性设置的实例<xref:System.Diagnostics.EventLog>，不能更改<xref:System.Diagnostics.EventLog.Log%2A>属性中的为该<xref:System.Diagnostics.EventLog>而无需更改的值<xref:System.Diagnostics.EventLog.Source%2A>或调用<xref:System.Diagnostics.EventLog.DeleteEventSource%2A>第一个。</span><span class="sxs-lookup"><span data-stu-id="db667-777">If the <xref:System.Diagnostics.EventLog.Source%2A> property was set for an instance of <xref:System.Diagnostics.EventLog>, you cannot change the <xref:System.Diagnostics.EventLog.Log%2A> property for that <xref:System.Diagnostics.EventLog> without changing the value of <xref:System.Diagnostics.EventLog.Source%2A> or calling <xref:System.Diagnostics.EventLog.DeleteEventSource%2A> first.</span></span> <span data-ttu-id="db667-778">如果您更改<xref:System.Diagnostics.EventLog.Log%2A>属性后的<xref:System.Diagnostics.EventLog.Source%2A>属性已设置，编写一个日志条目将引发异常。</span><span class="sxs-lookup"><span data-stu-id="db667-778">If you change the <xref:System.Diagnostics.EventLog.Log%2A> property after the <xref:System.Diagnostics.EventLog.Source%2A> property has been set, writing a log entry throws an exception.</span></span>  
  
 <span data-ttu-id="db667-779">操作系统将事件日志存储为文件。</span><span class="sxs-lookup"><span data-stu-id="db667-779">The operating system stores event logs as files.</span></span> <span data-ttu-id="db667-780">当你使用<xref:System.Diagnostics.EventLogInstaller>或<xref:System.Diagnostics.EventLog.CreateEventSource%2A>若要创建新的事件日志，关联的文件存储在指定计算机上的 %SystemRoot%\System32\Config 目录。</span><span class="sxs-lookup"><span data-stu-id="db667-780">When you use <xref:System.Diagnostics.EventLogInstaller> or <xref:System.Diagnostics.EventLog.CreateEventSource%2A> to create a new event log, the associated file is stored in the %SystemRoot%\System32\Config directory on the specified computer.</span></span> <span data-ttu-id="db667-781">通过追加的前 8 个字符设置的文件名称<xref:System.Diagnostics.EventLog.Log%2A>".evt"文件扩展名的属性。</span><span class="sxs-lookup"><span data-stu-id="db667-781">The file name is set by appending the first 8 characters of the <xref:System.Diagnostics.EventLog.Log%2A> property with the ".evt" file name extension.</span></span>  
  
 <span data-ttu-id="db667-782">无法创建新的日志使用<xref:System.Diagnostics.EventLog.Log%2A>属性单独 （不带指定的日志源）。</span><span class="sxs-lookup"><span data-stu-id="db667-782">You cannot create a new log using the <xref:System.Diagnostics.EventLog.Log%2A> property alone (without specifying a source for the log).</span></span> <span data-ttu-id="db667-783">您可以调用<xref:System.Diagnostics.EventLog.CreateEventSource%2A>中，传入新的日志名称作为参数，然后再调用<xref:System.Diagnostics.EventLog.DeleteEventSource%2A>。</span><span class="sxs-lookup"><span data-stu-id="db667-783">You can call <xref:System.Diagnostics.EventLog.CreateEventSource%2A>, passing in a new log name as a parameter, and then call <xref:System.Diagnostics.EventLog.DeleteEventSource%2A>.</span></span> <span data-ttu-id="db667-784">但是，其目的通常是以创建 （并将项写入） 新的特定于应用程序日志，或从现有的日志读取。</span><span class="sxs-lookup"><span data-stu-id="db667-784">However, the intent is usually either to create (and write entries to) new application-specific logs, or to read from existing logs.</span></span>  
  
 <span data-ttu-id="db667-785">如果<xref:System.Diagnostics.EventLog.Log%2A>值发生更改，关闭事件日志并释放所有的事件句柄。</span><span class="sxs-lookup"><span data-stu-id="db667-785">If the <xref:System.Diagnostics.EventLog.Log%2A> value changes, the event log is closed and all event handles are released.</span></span>  
  
> [!CAUTION]
>  <span data-ttu-id="db667-786">如果您设置<xref:System.Diagnostics.EventLog.Log%2A>属性设置为不存在日志的名称，系统将附加<xref:System.Diagnostics.EventLog>到应用程序日志，但不会警告你它正在使用不是你指定的日志。</span><span class="sxs-lookup"><span data-stu-id="db667-786">If you set the <xref:System.Diagnostics.EventLog.Log%2A> property to the name of a log that does not exist, the system attaches the <xref:System.Diagnostics.EventLog> to the Application log, but does not warn you that it is using a log other than the one you specified.</span></span>  
  
   
  
## Examples  
 <span data-ttu-id="db667-787">下面的示例读取事件日志中，"NewEventLog"本地计算机上的条目。</span><span class="sxs-lookup"><span data-stu-id="db667-787">The following example reads entries in the event log, "NewEventLog", on the local computer.</span></span>  
  
 [!code-cpp[Classic EventLog.Log Example#1](~/samples/snippets/cpp/VS_Snippets_CLR_Classic/classic EventLog.Log Example/CPP/source.cpp#1)]
 [!code-csharp[Classic EventLog.Log Example#1](~/samples/snippets/csharp/VS_Snippets_CLR_Classic/classic EventLog.Log Example/CS/source.cs#1)]
 [!code-vb[Classic EventLog.Log Example#1](~/samples/snippets/visualbasic/VS_Snippets_CLR_Classic/classic EventLog.Log Example/VB/source.vb#1)]  
  
 ]]></format>
        </remarks>
        <permission cref="T:System.Diagnostics.EventLogPermission">
          <span data-ttu-id="db667-788">用于写入的计算机上的事件日志信息。</span>
          <span class="sxs-lookup">
            <span data-stu-id="db667-788">for writing the event log information on the computer.</span>
          </span>
          <span data-ttu-id="db667-789">关联的枚举： <see cref="F:System.Diagnostics.EventLogPermissionAccess.Write" /></span>
          <span class="sxs-lookup">
            <span data-stu-id="db667-789">Associated enumeration: <see cref="F:System.Diagnostics.EventLogPermissionAccess.Write" /></span>
          </span>
        </permission>
        <altmember cref="P:System.Diagnostics.EventLog.MachineName" />
        <altmember cref="P:System.Diagnostics.EventLog.Source" />
        <altmember cref="P:System.Diagnostics.EventLog.Entries" />
        <altmember cref="M:System.Diagnostics.EventLog.Exists(System.String)" />
        <altmember cref="M:System.Diagnostics.EventLog.Delete(System.String)" />
        <altmember cref="Overload:System.Diagnostics.EventLog.CreateEventSource" />
        <altmember cref="T:System.Diagnostics.EventLogEntryCollection" />
      </Docs>
    </Member>
    <Member MemberName="LogDisplayName">
      <MemberSignature Language="C#" Value="public string LogDisplayName { get; }" />
      <MemberSignature Language="ILAsm" Value=".property instance string LogDisplayName" />
      <MemberSignature Language="DocId" Value="P:System.Diagnostics.EventLog.LogDisplayName" />
      <MemberSignature Language="VB.NET" Value="Public ReadOnly Property LogDisplayName As String" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; property System::String ^ LogDisplayName { System::String ^ get(); };" />
      <MemberSignature Language="F#" Value="member this.LogDisplayName : string" Usage="System.Diagnostics.EventLog.LogDisplayName" />
      <MemberType>Property</MemberType>
      <AssemblyInfo>
        <AssemblyName>System</AssemblyName>
        <AssemblyVersion>1.0.5000.0</AssemblyVersion>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Attributes>
        <Attribute FrameworkAlternate="netframework-1.1;netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;xamarinmac-3.0">
          <AttributeName>System.ComponentModel.Browsable(false)</AttributeName>
        </Attribute>
      </Attributes>
      <ReturnValue>
        <ReturnType>System.String</ReturnType>
      </ReturnValue>
      <Docs>
        <summary>
          <span data-ttu-id="db667-790">获取事件日志的友好名称。</span>
          <span class="sxs-lookup">
            <span data-stu-id="db667-790">Gets the event log's friendly name.</span>
          </span>
        </summary>
        <value>
          <span data-ttu-id="db667-791">一个表示系统的事件查看器中事件日志的名称。</span>
          <span class="sxs-lookup">
            <span data-stu-id="db667-791">A name that represents the event log in the system's event viewer.</span>
          </span>
        </value>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
  
> [!NOTE]
>  <span data-ttu-id="db667-792">在 Windows Vista 及更高版本，用户没有访问安全日志的权限。</span><span class="sxs-lookup"><span data-stu-id="db667-792">In Windows Vista and later, users do not have permission to access the security log.</span></span> <span data-ttu-id="db667-793">如果运行的 Windows Vista 或更高版本作为用户，将收到<xref:System.Security.SecurityException>当你尝试访问安全日志中的事件的显示名称。</span><span class="sxs-lookup"><span data-stu-id="db667-793">If you are running Windows Vista or later as a user, you will get a <xref:System.Security.SecurityException> when you attempt to access the display name for an event in the security log.</span></span>  
>   
>  <span data-ttu-id="db667-794">在 Windows Vista 或更高版本中，用户帐户控制 (UAC) 决定用户的特权。</span><span class="sxs-lookup"><span data-stu-id="db667-794">In Windows Vista and later, User Account Control (UAC) determines the privileges of a user.</span></span> <span data-ttu-id="db667-795">如果您是内置的 Administrators 组的成员，将为您分配两个运行时访问令牌：一个标准用户访问令牌和一个管理员访问令牌。</span><span class="sxs-lookup"><span data-stu-id="db667-795">If you are a member of the Built-in Administrators group, you are assigned two run-time access tokens: a standard user access token and an administrator access token.</span></span> <span data-ttu-id="db667-796">默认情况下，您拥有标准用户角色。</span><span class="sxs-lookup"><span data-stu-id="db667-796">By default, you are in the standard user role.</span></span> <span data-ttu-id="db667-797">若要执行的代码访问安全日志，首先必须将你的特权从标准用户提升至管理员。</span><span class="sxs-lookup"><span data-stu-id="db667-797">To execute the code that accesses the security log, you must first elevate your privileges from standard user to administrator.</span></span> <span data-ttu-id="db667-798">你可以通过以下方式执行此操作：右键单击应用程序图标并指示需以管理员身份运行。</span><span class="sxs-lookup"><span data-stu-id="db667-798">You can do this when you start an application by right-clicking the application icon and indicating that you want to run as an administrator.</span></span>  
  
   
  
## Examples  
 <span data-ttu-id="db667-799">下面的示例枚举在本地计算机上定义的事件日志，并显示<xref:System.Diagnostics.EventLog.LogDisplayName%2A>每个事件日志。</span><span class="sxs-lookup"><span data-stu-id="db667-799">The following example enumerates the event logs defined on the local computer and displays the <xref:System.Diagnostics.EventLog.LogDisplayName%2A> for each event log.</span></span>  
  
 [!code-cpp[EventLogProperties#2](~/samples/snippets/cpp/VS_Snippets_CLR/EventLogProperties/CPP/source.cpp#2)]
 [!code-csharp[EventLogProperties#2](~/samples/snippets/csharp/VS_Snippets_CLR/EventLogProperties/CS/source.cs#2)]
 [!code-vb[EventLogProperties#2](~/samples/snippets/visualbasic/VS_Snippets_CLR/EventLogProperties/VB/source.vb#2)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.InvalidOperationException">
          <span data-ttu-id="db667-800">此计算机的注册表中不存在指定的 <see cref="P:System.Diagnostics.EventLog.Log" />。</span>
          <span class="sxs-lookup">
            <span data-stu-id="db667-800">The specified <see cref="P:System.Diagnostics.EventLog.Log" /> does not exist in the registry for this computer.</span>
          </span>
        </exception>
        <permission cref="T:System.Diagnostics.EventLogPermission">
          <span data-ttu-id="db667-801">用于管理计算机上的事件日志信息。</span>
          <span class="sxs-lookup">
            <span data-stu-id="db667-801">for administering event log information on the computer.</span>
          </span>
          <span data-ttu-id="db667-802">关联的枚举： <see cref="F:System.Diagnostics.EventLogPermissionAccess.Administer" /></span>
          <span class="sxs-lookup">
            <span data-stu-id="db667-802">Associated enumeration: <see cref="F:System.Diagnostics.EventLogPermissionAccess.Administer" /></span>
          </span>
        </permission>
        <permission cref="T:System.Security.Permissions.RegistryPermission">
          <span data-ttu-id="db667-803">用于读取指定的注册表项的功能。</span>
          <span class="sxs-lookup">
            <span data-stu-id="db667-803">for the ability to read the specified registry key.</span>
          </span>
          <span data-ttu-id="db667-804">关联的枚举： <see cref="F:System.Security.Permissions.RegistryPermissionAccess.Read" /></span>
          <span class="sxs-lookup">
            <span data-stu-id="db667-804">Associated enumeration: <see cref="F:System.Security.Permissions.RegistryPermissionAccess.Read" /></span>
          </span>
        </permission>
        <permission cref="T:System.Security.Permissions.SecurityPermission">
          <span data-ttu-id="db667-805">它能够访问指定的注册表密钥如果它是一个远程的密钥。</span>
          <span class="sxs-lookup">
            <span data-stu-id="db667-805">for the ability to access the specified registry key if it is a remote key.</span>
          </span>
          <span data-ttu-id="db667-806">关联的枚举： <see cref="F:System.Security.Permissions.SecurityPermissionFlag.UnmanagedCode" /></span>
          <span class="sxs-lookup">
            <span data-stu-id="db667-806">Associated enumeration: <see cref="F:System.Security.Permissions.SecurityPermissionFlag.UnmanagedCode" /></span>
          </span>
        </permission>
        <altmember cref="M:System.Diagnostics.EventLog.RegisterDisplayName(System.String,System.Int64)" />
      </Docs>
    </Member>
    <Member MemberName="LogNameFromSourceName">
      <MemberSignature Language="C#" Value="public static string LogNameFromSourceName (string source, string machineName);" />
      <MemberSignature Language="ILAsm" Value=".method public static hidebysig string LogNameFromSourceName(string source, string machineName) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Diagnostics.EventLog.LogNameFromSourceName(System.String,System.String)" />
      <MemberSignature Language="VB.NET" Value="Public Shared Function LogNameFromSourceName (source As String, machineName As String) As String" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; static System::String ^ LogNameFromSourceName(System::String ^ source, System::String ^ machineName);" />
      <MemberSignature Language="F#" Value="static member LogNameFromSourceName : string * string -&gt; string" Usage="System.Diagnostics.EventLog.LogNameFromSourceName (source, machineName)" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System</AssemblyName>
        <AssemblyVersion>1.0.5000.0</AssemblyVersion>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Attributes>
        <Attribute FrameworkAlternate="xamarinmac-3.0">
          <AttributeName>System.MonoNotSupported("remote machine is not supported")</AttributeName>
        </Attribute>
      </Attributes>
      <ReturnValue>
        <ReturnType>System.String</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="source" Type="System.String" />
        <Parameter Name="machineName" Type="System.String" />
      </Parameters>
      <Docs>
        <param name="source">
          <span data-ttu-id="db667-807">事件源的名称。</span>
          <span class="sxs-lookup">
            <span data-stu-id="db667-807">The name of the event source.</span>
          </span>
        </param>
        <param name="machineName">
          <span data-ttu-id="db667-808">要从中删除日志的计算机名称，对于本地计算机则为“.”。</span>
          <span class="sxs-lookup">
            <span data-stu-id="db667-808">The name of the computer on which to look, or "." for the local computer.</span>
          </span>
        </param>
        <summary>
          <span data-ttu-id="db667-809">获取指定的源注册到的日志的名称。</span>
          <span class="sxs-lookup">
            <span data-stu-id="db667-809">Gets the name of the log to which the specified source is registered.</span>
          </span>
        </summary>
        <returns>
          <span data-ttu-id="db667-810">与注册表中的指定源关联的日志名称。</span>
          <span class="sxs-lookup">
            <span data-stu-id="db667-810">The name of the log associated with the specified source in the registry.</span>
          </span>
        </returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="db667-811">事件源指示什么来记录事件。</span><span class="sxs-lookup"><span data-stu-id="db667-811">The event source indicates what logs the event.</span></span> <span data-ttu-id="db667-812">通常是应用程序的名称或子组件的应用程序的名称时应用程序非常大。</span><span class="sxs-lookup"><span data-stu-id="db667-812">It is often the name of the application, or the name of a subcomponent of the application, if the application is large.</span></span> <span data-ttu-id="db667-813">应用程序和服务应写入应用程序日志或自定义日志。</span><span class="sxs-lookup"><span data-stu-id="db667-813">Applications and services should write to the Application log or a custom log.</span></span> <span data-ttu-id="db667-814">设备驱动程序应该写入系统日志。</span><span class="sxs-lookup"><span data-stu-id="db667-814">Device drivers should write to the System log.</span></span>  
  
 <span data-ttu-id="db667-815">当创建新的源，它可以只写入一个日志一次，系统将你的应用程序与事件日志注册为有效项源。</span><span class="sxs-lookup"><span data-stu-id="db667-815">When you create a new source, which can only write to one log at a time, the system registers your application with the event log as a valid source of entries.</span></span> <span data-ttu-id="db667-816"><xref:System.Diagnostics.EventLog.Source%2A>属性可以是任意字符串，但名称不能由其他计算机上的源。</span><span class="sxs-lookup"><span data-stu-id="db667-816">The <xref:System.Diagnostics.EventLog.Source%2A> property can be any string, but the name cannot be used by other sources on the computer.</span></span> <span data-ttu-id="db667-817">尝试创建重复<xref:System.Diagnostics.EventLog.Source%2A>值将引发异常。</span><span class="sxs-lookup"><span data-stu-id="db667-817">An attempt to create a duplicated <xref:System.Diagnostics.EventLog.Source%2A> value throws an exception.</span></span> <span data-ttu-id="db667-818">但是，单个事件日志可以有多个不同源向其写入。</span><span class="sxs-lookup"><span data-stu-id="db667-818">However, a single event log can have many different sources writing to it.</span></span>  
  
   
  
## Examples  
 <span data-ttu-id="db667-819">下面的示例从本地计算机中删除源。</span><span class="sxs-lookup"><span data-stu-id="db667-819">The following example deletes a source from the local computer.</span></span> <span data-ttu-id="db667-820">该示例确定从其源的日志，然后删除该日志。</span><span class="sxs-lookup"><span data-stu-id="db667-820">The example determines the log from its source, and then deletes the log.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="db667-821">多个源可能会写入事件日志。</span><span class="sxs-lookup"><span data-stu-id="db667-821">More than one source might write to an event log.</span></span> <span data-ttu-id="db667-822">在删除之前自定义日志，请确保不没有写入该日志的任何其他源。</span><span class="sxs-lookup"><span data-stu-id="db667-822">Before deleting a custom log, make sure there are no other sources writing to that log.</span></span>  
  
 [!code-cpp[Classic EventLog.DeleteEventSource Example#1](~/samples/snippets/cpp/VS_Snippets_CLR_Classic/classic EventLog.DeleteEventSource Example/CPP/source.cpp#1)]
 [!code-csharp[Classic EventLog.DeleteEventSource Example#1](~/samples/snippets/csharp/VS_Snippets_CLR_Classic/classic EventLog.DeleteEventSource Example/CS/source.cs#1)]
 [!code-vb[Classic EventLog.DeleteEventSource Example#1](~/samples/snippets/visualbasic/VS_Snippets_CLR_Classic/classic EventLog.DeleteEventSource Example/VB/source.vb#1)]  
  
 ]]></format>
        </remarks>
        <permission cref="T:System.Diagnostics.EventLogPermission">
          <span data-ttu-id="db667-823">用于管理计算机上的事件日志信息。</span>
          <span class="sxs-lookup">
            <span data-stu-id="db667-823">for administering event log information on the computer.</span>
          </span>
          <span data-ttu-id="db667-824">关联的枚举： <see cref="F:System.Diagnostics.EventLogPermissionAccess.Administer" /></span>
          <span class="sxs-lookup">
            <span data-stu-id="db667-824">Associated enumeration: <see cref="F:System.Diagnostics.EventLogPermissionAccess.Administer" /></span>
          </span>
        </permission>
        <altmember cref="P:System.Diagnostics.EventLog.Source" />
        <altmember cref="P:System.Diagnostics.EventLog.MachineName" />
        <altmember cref="P:System.Diagnostics.EventLog.Log" />
        <altmember cref="M:System.Diagnostics.EventLog.SourceExists(System.String)" />
      </Docs>
    </Member>
    <Member MemberName="MachineName">
      <MemberSignature Language="C#" Value="public string MachineName { get; set; }" />
      <MemberSignature Language="ILAsm" Value=".property instance string MachineName" />
      <MemberSignature Language="DocId" Value="P:System.Diagnostics.EventLog.MachineName" />
      <MemberSignature Language="VB.NET" Value="Public Property MachineName As String" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; property System::String ^ MachineName { System::String ^ get(); void set(System::String ^ value); };" />
      <MemberSignature Language="F#" Value="member this.MachineName : string with get, set" Usage="System.Diagnostics.EventLog.MachineName" />
      <MemberType>Property</MemberType>
      <AssemblyInfo>
        <AssemblyName>System</AssemblyName>
        <AssemblyVersion>1.0.5000.0</AssemblyVersion>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Attributes>
        <Attribute FrameworkAlternate="netframework-1.1;netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;xamarinmac-3.0">
          <AttributeName>System.ComponentModel.DefaultValue(".")</AttributeName>
        </Attribute>
        <Attribute FrameworkAlternate="netframework-1.1;netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;xamarinmac-3.0">
          <AttributeName>System.ComponentModel.ReadOnly(true)</AttributeName>
        </Attribute>
        <Attribute FrameworkAlternate="netframework-1.1;netframework-2.0;netframework-3.0;netframework-3.5;xamarinmac-3.0">
          <AttributeName>System.ComponentModel.RecommendedAsConfigurable(true)</AttributeName>
        </Attribute>
        <Attribute FrameworkAlternate="xamarinmac-3.0">
          <AttributeName>System.Diagnostics.MonitoringDescription("Name of the machine that this log get written to.")</AttributeName>
        </Attribute>
        <Attribute FrameworkAlternate="netframework-1.1;netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2">
          <AttributeName>System.Diagnostics.MonitoringDescription("LogMachineName")</AttributeName>
        </Attribute>
        <Attribute FrameworkAlternate="netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2">
          <AttributeName>System.ComponentModel.SettingsBindable(true)</AttributeName>
        </Attribute>
      </Attributes>
      <ReturnValue>
        <ReturnType>System.String</ReturnType>
      </ReturnValue>
      <Docs>
        <summary>
          <span data-ttu-id="db667-825">获取或设置在其上读取或写入事件的计算机的名称。</span>
          <span class="sxs-lookup">
            <span data-stu-id="db667-825">Gets or sets the name of the computer on which to read or write events.</span>
          </span>
        </summary>
        <value>
          <span data-ttu-id="db667-826">事件日志驻留的服务器的名称。</span>
          <span class="sxs-lookup">
            <span data-stu-id="db667-826">The name of the server on which the event log resides.</span>
          </span>
          <span data-ttu-id="db667-827">默认为本地计算机 (".")。</span>
          <span class="sxs-lookup">
            <span data-stu-id="db667-827">The default is the local computer (".").</span>
          </span>
        </value>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="db667-828">如果写入事件日志，必须将关联<xref:System.Diagnostics.EventLog.Source%2A>提供事件日志对象，以将其连接到的特定日志。</span><span class="sxs-lookup"><span data-stu-id="db667-828">If you write to an event log, you must associate a <xref:System.Diagnostics.EventLog.Source%2A> with your event log object to connect it to a particular log.</span></span> <span data-ttu-id="db667-829">不需要指定<xref:System.Diagnostics.EventLog.Source%2A>仅从日志中读取的属性。</span><span class="sxs-lookup"><span data-stu-id="db667-829">It is not necessary to specify the <xref:System.Diagnostics.EventLog.Source%2A> property when only reading from a log.</span></span> <span data-ttu-id="db667-830">可以仅指定<xref:System.Diagnostics.EventLog.Log%2A>名称和<xref:System.Diagnostics.EventLog.MachineName%2A>（服务器计算机名称）。</span><span class="sxs-lookup"><span data-stu-id="db667-830">You can specify only the <xref:System.Diagnostics.EventLog.Log%2A> name and <xref:System.Diagnostics.EventLog.MachineName%2A> (server computer name).</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="db667-831">不需要指定<xref:System.Diagnostics.EventLog.MachineName%2A>如果要连接到日志。</span><span class="sxs-lookup"><span data-stu-id="db667-831">You need not specify the <xref:System.Diagnostics.EventLog.MachineName%2A> if you are connecting to a log.</span></span> <span data-ttu-id="db667-832">如果未指定<xref:System.Diagnostics.EventLog.MachineName%2A>，本地计算机 ("。") 假定。</span><span class="sxs-lookup"><span data-stu-id="db667-832">If you do not specify the <xref:System.Diagnostics.EventLog.MachineName%2A>, the local computer (".") is assumed.</span></span>  
  
 <span data-ttu-id="db667-833">一个源一次只能注册到一个日志。</span><span class="sxs-lookup"><span data-stu-id="db667-833">A source can only be registered to one log at a time.</span></span> <span data-ttu-id="db667-834">如果<xref:System.Diagnostics.EventLog.Source%2A>属性设置的实例<xref:System.Diagnostics.EventLog>，不能更改<xref:System.Diagnostics.EventLog.MachineName%2A>属性中的为该<xref:System.Diagnostics.EventLog>而无需更改的值<xref:System.Diagnostics.EventLog.Source%2A>或调用<xref:System.Diagnostics.EventLog.DeleteEventSource%2A>第一个。</span><span class="sxs-lookup"><span data-stu-id="db667-834">If the <xref:System.Diagnostics.EventLog.Source%2A> property was set for an instance of <xref:System.Diagnostics.EventLog>, you cannot change the <xref:System.Diagnostics.EventLog.MachineName%2A> property for that <xref:System.Diagnostics.EventLog> without changing the value of <xref:System.Diagnostics.EventLog.Source%2A> or calling <xref:System.Diagnostics.EventLog.DeleteEventSource%2A> first.</span></span> <span data-ttu-id="db667-835">如果您更改<xref:System.Diagnostics.EventLog.MachineName%2A>属性，<xref:System.Diagnostics.EventLog>关闭所有句柄并重新附加到的日志和新计算机上的源。</span><span class="sxs-lookup"><span data-stu-id="db667-835">If you change the <xref:System.Diagnostics.EventLog.MachineName%2A> property, the <xref:System.Diagnostics.EventLog> closes all handles and reattaches to the log and source on the new computer.</span></span>  
  
 <span data-ttu-id="db667-836"><xref:System.Diagnostics.EventLog.MachineName%2A>值不能为空字符串。</span><span class="sxs-lookup"><span data-stu-id="db667-836">The <xref:System.Diagnostics.EventLog.MachineName%2A> value cannot be an empty string.</span></span> <span data-ttu-id="db667-837">如果显式设置，则默认为本地计算机 ("。")。</span><span class="sxs-lookup"><span data-stu-id="db667-837">If it is not explicitly set, it defaults to the local computer (".").</span></span>  
  
   
  
## Examples  
 <span data-ttu-id="db667-838">下面的示例读取事件日志中，"NewEventLog"指定计算机上的条目。</span><span class="sxs-lookup"><span data-stu-id="db667-838">The following example reads entries in the event log, "NewEventLog", on a specified computer.</span></span>  
  
 [!code-cpp[Classic EventLog.MachineName Example#1](~/samples/snippets/cpp/VS_Snippets_CLR_Classic/classic EventLog.MachineName Example/CPP/source.cpp#1)]
 [!code-csharp[Classic EventLog.MachineName Example#1](~/samples/snippets/csharp/VS_Snippets_CLR_Classic/classic EventLog.MachineName Example/CS/source.cs#1)]
 [!code-vb[Classic EventLog.MachineName Example#1](~/samples/snippets/visualbasic/VS_Snippets_CLR_Classic/classic EventLog.MachineName Example/VB/source.vb#1)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentException">
          <span data-ttu-id="db667-839">计算机名称无效。</span>
          <span class="sxs-lookup">
            <span data-stu-id="db667-839">The computer name is invalid.</span>
          </span>
        </exception>
        <permission cref="T:System.Diagnostics.EventLogPermission">
          <span data-ttu-id="db667-840">用于写入的计算机上的事件日志信息。</span>
          <span class="sxs-lookup">
            <span data-stu-id="db667-840">for writing the event log information on the computer.</span>
          </span>
          <span data-ttu-id="db667-841">关联的枚举： <see cref="F:System.Diagnostics.EventLogPermissionAccess.Write" /></span>
          <span class="sxs-lookup">
            <span data-stu-id="db667-841">Associated enumeration: <see cref="F:System.Diagnostics.EventLogPermissionAccess.Write" /></span>
          </span>
        </permission>
        <altmember cref="P:System.Diagnostics.EventLog.Log" />
        <altmember cref="P:System.Diagnostics.EventLog.Source" />
        <altmember cref="Overload:System.Diagnostics.EventLog.CreateEventSource" />
        <altmember cref="M:System.Diagnostics.EventLog.DeleteEventSource(System.String)" />
        <altmember cref="M:System.Diagnostics.EventLog.Delete(System.String)" />
        <altmember cref="M:System.Diagnostics.EventLog.SourceExists(System.String)" />
        <altmember cref="M:System.Diagnostics.EventLog.Exists(System.String)" />
        <altmember cref="M:System.Diagnostics.EventLog.GetEventLogs" />
      </Docs>
    </Member>
    <Member MemberName="MaximumKilobytes">
      <MemberSignature Language="C#" Value="public long MaximumKilobytes { get; set; }" />
      <MemberSignature Language="ILAsm" Value=".property instance int64 MaximumKilobytes" />
      <MemberSignature Language="DocId" Value="P:System.Diagnostics.EventLog.MaximumKilobytes" />
      <MemberSignature Language="VB.NET" Value="Public Property MaximumKilobytes As Long" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; property long MaximumKilobytes { long get(); void set(long value); };" />
      <MemberSignature Language="F#" Value="member this.MaximumKilobytes : int64 with get, set" Usage="System.Diagnostics.EventLog.MaximumKilobytes" />
      <MemberType>Property</MemberType>
      <AssemblyInfo>
        <AssemblyName>System</AssemblyName>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Attributes>
        <Attribute FrameworkAlternate="netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;xamarinmac-3.0">
          <AttributeName>System.ComponentModel.Browsable(false)</AttributeName>
        </Attribute>
        <Attribute FrameworkAlternate="netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;xamarinmac-3.0">
          <AttributeName>System.ComponentModel.DesignerSerializationVisibility(System.ComponentModel.DesignerSerializationVisibility.Hidden)</AttributeName>
        </Attribute>
        <Attribute FrameworkAlternate="xamarinmac-3.0">
          <AttributeName>System.MonoTODO</AttributeName>
        </Attribute>
        <Attribute FrameworkAlternate="netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;xamarinmac-3.0">
          <AttributeName>System.Runtime.InteropServices.ComVisible(false)</AttributeName>
        </Attribute>
      </Attributes>
      <ReturnValue>
        <ReturnType>System.Int64</ReturnType>
      </ReturnValue>
      <Docs>
        <summary>
          <span data-ttu-id="db667-842">获取或设置最大事件日志大小（以 KB 为单位）。</span>
          <span class="sxs-lookup">
            <span data-stu-id="db667-842">Gets or sets the maximum event log size in kilobytes.</span>
          </span>
        </summary>
        <value>
          <span data-ttu-id="db667-843">最大事件日志大小（以 KB 为单位）。</span>
          <span class="sxs-lookup">
            <span data-stu-id="db667-843">The maximum event log size in kilobytes.</span>
          </span>
          <span data-ttu-id="db667-844">默认值为 512，表示最大文件大小为 512 KB。</span>
          <span class="sxs-lookup">
            <span data-stu-id="db667-844">The default is 512, indicating a maximum file size of 512 kilobytes.</span>
          </span>
        </value>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="db667-845"><xref:System.Diagnostics.EventLog.MaximumKilobytes%2A>属性表示的事件日志文件的大小限制。</span><span class="sxs-lookup"><span data-stu-id="db667-845">The <xref:System.Diagnostics.EventLog.MaximumKilobytes%2A> property represents the size limit of the event log file.</span></span> <span data-ttu-id="db667-846">当事件日志达到大小限制，已配置的<xref:System.Diagnostics.EventLog.OverflowAction%2A>值确定是否丢弃新条目，或是否新条目覆盖旧条目。</span><span class="sxs-lookup"><span data-stu-id="db667-846">When the event log reaches the size limit, the configured <xref:System.Diagnostics.EventLog.OverflowAction%2A> value determines whether new entries are discarded, or whether new entries overwrite older entries.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="db667-847">此属性表示此实例所表示的事件日志的配置设置。</span><span class="sxs-lookup"><span data-stu-id="db667-847">This property represents a configuration setting for the event log represented by this instance.</span></span> <span data-ttu-id="db667-848">当事件日志达到其最大大小时，此属性指定操作系统如何处理为事件日志注册的所有事件源都写入新条目。</span><span class="sxs-lookup"><span data-stu-id="db667-848">When the event log reaches its maximum size, this property specifies how the operating system handles new entries written by all event sources registered for the event log.</span></span>  
  
   
  
## Examples  
 <span data-ttu-id="db667-849">下面的示例枚举在本地计算机上定义的事件日志，并显示每个事件日志的配置详细信息。</span><span class="sxs-lookup"><span data-stu-id="db667-849">The following example enumerates the event logs defined on the local computer, and displays configuration details for each event log.</span></span>  
  
 [!code-cpp[EventLogProperties#2](~/samples/snippets/cpp/VS_Snippets_CLR/EventLogProperties/CPP/source.cpp#2)]
 [!code-csharp[EventLogProperties#2](~/samples/snippets/csharp/VS_Snippets_CLR/EventLogProperties/CS/source.cs#2)]
 [!code-vb[EventLogProperties#2](~/samples/snippets/visualbasic/VS_Snippets_CLR/EventLogProperties/VB/source.vb#2)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentOutOfRangeException">
          <span data-ttu-id="db667-850">指定值小于 64，或大于 4194240，或不是 64 的偶数倍。</span>
          <span class="sxs-lookup">
            <span data-stu-id="db667-850">The specified value is less than 64, or greater than 4194240, or not an even multiple of 64.</span>
          </span>
        </exception>
        <exception cref="T:System.InvalidOperationException">
          <span data-ttu-id="db667-851">
            <see cref="P:System.Diagnostics.EventLog.Log" /> 值不是有效的日志名。</span>
          <span class="sxs-lookup">
            <span data-stu-id="db667-851">The <see cref="P:System.Diagnostics.EventLog.Log" /> value is not a valid log name.</span>
          </span>
          <span data-ttu-id="db667-852">\- 或 -</span>
          <span class="sxs-lookup">
            <span data-stu-id="db667-852">\- or -</span>
          </span>
          <span data-ttu-id="db667-853">事件日志的注册表项无法在目标计算机上打开。</span>
          <span class="sxs-lookup">
            <span data-stu-id="db667-853">The registry key for the event log could not be opened on the target computer.</span>
          </span>
        </exception>
        <permission cref="T:System.Diagnostics.EventLogPermission">
          <span data-ttu-id="db667-854">用于管理计算机上的事件日志信息。</span>
          <span class="sxs-lookup">
            <span data-stu-id="db667-854">for administering event log information on the computer.</span>
          </span>
          <span data-ttu-id="db667-855">关联的枚举： <see cref="F:System.Diagnostics.EventLogPermissionAccess.Administer" /></span>
          <span class="sxs-lookup">
            <span data-stu-id="db667-855">Associated enumeration: <see cref="F:System.Diagnostics.EventLogPermissionAccess.Administer" /></span>
          </span>
        </permission>
        <altmember cref="P:System.Diagnostics.EventLog.OverflowAction" />
        <altmember cref="M:System.Diagnostics.EventLog.ModifyOverflowPolicy(System.Diagnostics.OverflowAction,System.Int32)" />
      </Docs>
    </Member>
    <Member MemberName="MinimumRetentionDays">
      <MemberSignature Language="C#" Value="public int MinimumRetentionDays { get; }" />
      <MemberSignature Language="ILAsm" Value=".property instance int32 MinimumRetentionDays" />
      <MemberSignature Language="DocId" Value="P:System.Diagnostics.EventLog.MinimumRetentionDays" />
      <MemberSignature Language="VB.NET" Value="Public ReadOnly Property MinimumRetentionDays As Integer" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; property int MinimumRetentionDays { int get(); };" />
      <MemberSignature Language="F#" Value="member this.MinimumRetentionDays : int" Usage="System.Diagnostics.EventLog.MinimumRetentionDays" />
      <MemberType>Property</MemberType>
      <AssemblyInfo>
        <AssemblyName>System</AssemblyName>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Attributes>
        <Attribute FrameworkAlternate="netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;xamarinmac-3.0">
          <AttributeName>System.ComponentModel.Browsable(false)</AttributeName>
        </Attribute>
        <Attribute FrameworkAlternate="xamarinmac-3.0">
          <AttributeName>System.MonoTODO</AttributeName>
        </Attribute>
        <Attribute FrameworkAlternate="netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;xamarinmac-3.0">
          <AttributeName>System.Runtime.InteropServices.ComVisible(false)</AttributeName>
        </Attribute>
      </Attributes>
      <ReturnValue>
        <ReturnType>System.Int32</ReturnType>
      </ReturnValue>
      <Docs>
        <summary>
          <span data-ttu-id="db667-856">获取要在事件日志中保留项的天数。</span>
          <span class="sxs-lookup">
            <span data-stu-id="db667-856">Gets the number of days to retain entries in the event log.</span>
          </span>
        </summary>
        <value>
          <span data-ttu-id="db667-857">事件日志中的项被保留的天数。</span>
          <span class="sxs-lookup">
            <span data-stu-id="db667-857">The number of days that entries in the event log are retained.</span>
          </span>
          <span data-ttu-id="db667-858">默认值为 7。</span>
          <span class="sxs-lookup">
            <span data-stu-id="db667-858">The default value is 7.</span>
          </span>
        </value>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="db667-859">使用<xref:System.Diagnostics.EventLog.MinimumRetentionDays%2A>属性可以检查事件日志的当前设置。</span><span class="sxs-lookup"><span data-stu-id="db667-859">Use the <xref:System.Diagnostics.EventLog.MinimumRetentionDays%2A> property to examine the current setting for an event log.</span></span> <span data-ttu-id="db667-860">使用<xref:System.Diagnostics.EventLog.ModifyOverflowPolicy%2A>更改最小数目的事件日志中的每个条目必须保留的天数。</span><span class="sxs-lookup"><span data-stu-id="db667-860">Use <xref:System.Diagnostics.EventLog.ModifyOverflowPolicy%2A> to change the minimum number of days that each entry in the event log must be retained.</span></span>  
  
 <span data-ttu-id="db667-861"><xref:System.Diagnostics.EventLog.MinimumRetentionDays%2A>值取决于事件日志的已配置的溢出行为。</span><span class="sxs-lookup"><span data-stu-id="db667-861">The <xref:System.Diagnostics.EventLog.MinimumRetentionDays%2A> value depends on the configured overflow behavior of the event log.</span></span> <span data-ttu-id="db667-862">如果<xref:System.Diagnostics.OverflowAction>事件日志的属性设置为<xref:System.Diagnostics.OverflowAction.OverwriteAsNeeded>，则<xref:System.Diagnostics.EventLog.MinimumRetentionDays%2A>值为 0。</span><span class="sxs-lookup"><span data-stu-id="db667-862">If the <xref:System.Diagnostics.OverflowAction> property for an event log is set to <xref:System.Diagnostics.OverflowAction.OverwriteAsNeeded>, then the <xref:System.Diagnostics.EventLog.MinimumRetentionDays%2A> value is 0.</span></span> <span data-ttu-id="db667-863">如果<xref:System.Diagnostics.OverflowAction>事件日志的属性设置为<xref:System.Diagnostics.OverflowAction.DoNotOverwrite>，则<xref:System.Diagnostics.EventLog.MinimumRetentionDays%2A>值为-1。</span><span class="sxs-lookup"><span data-stu-id="db667-863">If the <xref:System.Diagnostics.OverflowAction> property for an event log is set to <xref:System.Diagnostics.OverflowAction.DoNotOverwrite>, then the <xref:System.Diagnostics.EventLog.MinimumRetentionDays%2A> value is -1.</span></span> <span data-ttu-id="db667-864">如果<xref:System.Diagnostics.OverflowAction>事件日志的属性设置为<xref:System.Diagnostics.OverflowAction.OverwriteOlder>，则<xref:System.Diagnostics.EventLog.MinimumRetentionDays%2A>值大于零，并表示数的事件日志已满时保留事件日志条目的天数。</span><span class="sxs-lookup"><span data-stu-id="db667-864">If the <xref:System.Diagnostics.OverflowAction> property for an event log is set to <xref:System.Diagnostics.OverflowAction.OverwriteOlder>, then the <xref:System.Diagnostics.EventLog.MinimumRetentionDays%2A> value is greater than zero, and represents the number of days to retain event log entries when the event log is full.</span></span>  
  
 <span data-ttu-id="db667-865">事件日志达到其容量限制时，仅会发生溢出行为。</span><span class="sxs-lookup"><span data-stu-id="db667-865">The overflow behavior only occurs when an event log reaches its size limit.</span></span> <span data-ttu-id="db667-866">时<xref:System.Diagnostics.EventLog>具有其<xref:System.Diagnostics.EventLog.OverflowAction%2A>设置为<xref:System.Diagnostics.OverflowAction.OverwriteOlder>，并在事件日志达到其最大大小，然后新条目如果它们可以将为其保留时间超出的条目才写入<xref:System.Diagnostics.EventLog.MinimumRetentionDays%2A>段。</span><span class="sxs-lookup"><span data-stu-id="db667-866">When an <xref:System.Diagnostics.EventLog> has its <xref:System.Diagnostics.EventLog.OverflowAction%2A> set to <xref:System.Diagnostics.OverflowAction.OverwriteOlder>, and the event log reaches its maximum size, then new entries are written only if they can replace entries whose age exceeds the <xref:System.Diagnostics.EventLog.MinimumRetentionDays%2A> period.</span></span> <span data-ttu-id="db667-867">至少保留事件项适合定期存档事件日志时的不同而不同。</span><span class="sxs-lookup"><span data-stu-id="db667-867">Retaining event entries for a minimum period is appropriate when the event log is archived regularly.</span></span> <span data-ttu-id="db667-868">否则，则可能会丢失新条目时在事件日志达到其限制。</span><span class="sxs-lookup"><span data-stu-id="db667-868">Otherwise, you risk losing new entries when the event log reaches its limit.</span></span> <span data-ttu-id="db667-869">若要避免丢失事件的新信息，请设置根据特定的事件日志的存档计划事件的最小保留天数。</span><span class="sxs-lookup"><span data-stu-id="db667-869">To avoid losing new event information, set the minimum retention days for events based on your archive schedule for a particular event log.</span></span>  
  
   
  
## Examples  
 <span data-ttu-id="db667-870">下面的示例枚举在本地计算机上定义的事件日志，并显示每个事件日志的配置详细信息。</span><span class="sxs-lookup"><span data-stu-id="db667-870">The following example enumerates the event logs defined on the local computer, and displays configuration details for each event log.</span></span>  
  
 [!code-cpp[EventLogProperties#2](~/samples/snippets/cpp/VS_Snippets_CLR/EventLogProperties/CPP/source.cpp#2)]
 [!code-csharp[EventLogProperties#2](~/samples/snippets/csharp/VS_Snippets_CLR/EventLogProperties/CS/source.cs#2)]
 [!code-vb[EventLogProperties#2](~/samples/snippets/visualbasic/VS_Snippets_CLR/EventLogProperties/VB/source.vb#2)]  
  
 ]]></format>
        </remarks>
        <permission cref="T:System.Diagnostics.EventLogPermission">
          <span data-ttu-id="db667-871">用于管理计算机上的事件日志信息。</span>
          <span class="sxs-lookup">
            <span data-stu-id="db667-871">for administering event log information on the computer.</span>
          </span>
          <span data-ttu-id="db667-872">关联的枚举： <see cref="F:System.Diagnostics.EventLogPermissionAccess.Administer" /></span>
          <span class="sxs-lookup">
            <span data-stu-id="db667-872">Associated enumeration: <see cref="F:System.Diagnostics.EventLogPermissionAccess.Administer" /></span>
          </span>
        </permission>
        <altmember cref="P:System.Diagnostics.EventLog.MaximumKilobytes" />
        <altmember cref="M:System.Diagnostics.EventLog.ModifyOverflowPolicy(System.Diagnostics.OverflowAction,System.Int32)" />
        <altmember cref="P:System.Diagnostics.EventLog.OverflowAction" />
      </Docs>
    </Member>
    <Member MemberName="ModifyOverflowPolicy">
      <MemberSignature Language="C#" Value="public void ModifyOverflowPolicy (System.Diagnostics.OverflowAction action, int retentionDays);" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig instance void ModifyOverflowPolicy(valuetype System.Diagnostics.OverflowAction action, int32 retentionDays) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Diagnostics.EventLog.ModifyOverflowPolicy(System.Diagnostics.OverflowAction,System.Int32)" />
      <MemberSignature Language="VB.NET" Value="Public Sub ModifyOverflowPolicy (action As OverflowAction, retentionDays As Integer)" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; void ModifyOverflowPolicy(System::Diagnostics::OverflowAction action, int retentionDays);" />
      <MemberSignature Language="F#" Value="member this.ModifyOverflowPolicy : System.Diagnostics.OverflowAction * int -&gt; unit" Usage="eventLog.ModifyOverflowPolicy (action, retentionDays)" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System</AssemblyName>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Attributes>
        <Attribute FrameworkAlternate="xamarinmac-3.0">
          <AttributeName>System.MonoTODO</AttributeName>
        </Attribute>
        <Attribute FrameworkAlternate="netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;xamarinmac-3.0">
          <AttributeName>System.Runtime.InteropServices.ComVisible(false)</AttributeName>
        </Attribute>
      </Attributes>
      <ReturnValue>
        <ReturnType>System.Void</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="action" Type="System.Diagnostics.OverflowAction" />
        <Parameter Name="retentionDays" Type="System.Int32" />
      </Parameters>
      <Docs>
        <param name="action">
          <span data-ttu-id="db667-873">向事件日志写入新项的溢出行为。</span>
          <span class="sxs-lookup">
            <span data-stu-id="db667-873">The overflow behavior for writing new entries to the event log.</span>
          </span>
        </param>
        <param name="retentionDays">
          <span data-ttu-id="db667-874">每个事件日志项要保留的最小天数。</span>
          <span class="sxs-lookup">
            <span data-stu-id="db667-874">The minimum number of days each event log entry is retained.</span>
          </span>
          <span data-ttu-id="db667-875">只有在 <c>action</c> 设置为 <see cref="F:System.Diagnostics.OverflowAction.OverwriteOlder" /> 时，才使用此参数。</span>
          <span class="sxs-lookup">
            <span data-stu-id="db667-875">This parameter is used only if <c>action</c> is set to <see cref="F:System.Diagnostics.OverflowAction.OverwriteOlder" />.</span>
          </span>
        </param>
        <summary>
          <span data-ttu-id="db667-876">更改已配置的行为，以便在事件日志达到其最大文件大小时写入新项。</span>
          <span class="sxs-lookup">
            <span data-stu-id="db667-876">Changes the configured behavior for writing new entries when the event log reaches its maximum file size.</span>
          </span>
        </summary>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="db667-877">事件日志的溢出行为指定要写入到日志已达到其最大文件大小的新条目时，会发生什么情况。</span><span class="sxs-lookup"><span data-stu-id="db667-877">The overflow behavior for an event log specifies what happens when new entries are to be written to a log that has reached its maximum file size.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="db667-878">仅在事件日志达到其最大文件大小时生效的溢出行为。</span><span class="sxs-lookup"><span data-stu-id="db667-878">The overflow behavior takes effect only when an event log reaches its maximum file size.</span></span> <span data-ttu-id="db667-879">溢出行为不会影响到可以容纳其他事件日志条目的日志写入新的条目。</span><span class="sxs-lookup"><span data-stu-id="db667-879">The overflow behavior does not affect writing a new entry to a log that can accommodate additional event log entries.</span></span>  
  
 <span data-ttu-id="db667-880"><xref:System.Diagnostics.EventLog.ModifyOverflowPolicy%2A>方法可配置事件日志的溢出行为。</span><span class="sxs-lookup"><span data-stu-id="db667-880">The <xref:System.Diagnostics.EventLog.ModifyOverflowPolicy%2A> method configures the overflow behavior of an event log.</span></span> <span data-ttu-id="db667-881"><xref:System.Diagnostics.EventLog> 实例。</span><span class="sxs-lookup"><span data-stu-id="db667-881"><xref:System.Diagnostics.EventLog> instance.</span></span> <span data-ttu-id="db667-882">调用此方法为指定的事件日志后<xref:System.Diagnostics.EventLog.Log%2A>属性，<xref:System.Diagnostics.EventLog.OverflowAction%2A>和<xref:System.Diagnostics.EventLog.MinimumRetentionDays%2A>属性值反映新配置的溢出行为。</span><span class="sxs-lookup"><span data-stu-id="db667-882">After calling this method for the event log specified by the <xref:System.Diagnostics.EventLog.Log%2A> property, the <xref:System.Diagnostics.EventLog.OverflowAction%2A> and <xref:System.Diagnostics.EventLog.MinimumRetentionDays%2A> property values reflect the newly configured overflow behavior.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="db667-883">此属性表示此实例所表示的事件日志的配置设置。</span><span class="sxs-lookup"><span data-stu-id="db667-883">This property represents a configuration setting for the event log represented by this instance.</span></span> <span data-ttu-id="db667-884">当事件日志达到其最大大小时，此属性指定操作系统如何处理为事件日志注册的所有事件源都写入新条目。</span><span class="sxs-lookup"><span data-stu-id="db667-884">When the event log reaches its maximum size, this property specifies how the operating system handles new entries written by all event sources registered for the event log.</span></span>  
  
 <span data-ttu-id="db667-885">设置`action`参数<xref:System.Diagnostics.OverflowAction.OverwriteAsNeeded>以指示新条目覆盖最旧条目时<xref:System.Diagnostics.EventLog>达到其最大大小。</span><span class="sxs-lookup"><span data-stu-id="db667-885">Set the `action` parameter to <xref:System.Diagnostics.OverflowAction.OverwriteAsNeeded> to indicate that a new entry overwrites the oldest entry when the <xref:System.Diagnostics.EventLog> reaches its maximum size.</span></span> <span data-ttu-id="db667-886">如果`action`参数设置为<xref:System.Diagnostics.OverflowAction.OverwriteAsNeeded>，则`retentionDays`参数值将被忽略。</span><span class="sxs-lookup"><span data-stu-id="db667-886">If the `action` parameter is set to <xref:System.Diagnostics.OverflowAction.OverwriteAsNeeded>, the `retentionDays` parameter value is ignored.</span></span>  
  
 <span data-ttu-id="db667-887">设置`action`参数<xref:System.Diagnostics.OverflowAction.OverwriteOlder>以指示每个新条目覆盖旧条目时<xref:System.Diagnostics.EventLog>达到其最大大小。</span><span class="sxs-lookup"><span data-stu-id="db667-887">Set the `action` parameter to <xref:System.Diagnostics.OverflowAction.OverwriteOlder> to indicate that each new entry overwrites older entries when the <xref:System.Diagnostics.EventLog> reaches its maximum size.</span></span> <span data-ttu-id="db667-888">指定在日志中使用的事件必须保留的天数`retentionDays`参数。</span><span class="sxs-lookup"><span data-stu-id="db667-888">Specify the number of days that events must be retained in the log using the `retentionDays` parameter.</span></span> <span data-ttu-id="db667-889">新条目不会覆盖的保持期内写入的事件。</span><span class="sxs-lookup"><span data-stu-id="db667-889">Events written within the retention range are not overwritten by new entries.</span></span>  
  
 <span data-ttu-id="db667-890">设置`action`参数<xref:System.Diagnostics.OverflowAction.DoNotOverwrite>放弃新事件时已达到最大日志大小。</span><span class="sxs-lookup"><span data-stu-id="db667-890">Set the `action` parameter to <xref:System.Diagnostics.OverflowAction.DoNotOverwrite> to discard new events when the maximum log size is reached.</span></span> <span data-ttu-id="db667-891">如果`action`参数设置为<xref:System.Diagnostics.OverflowAction.DoNotOverwrite>，则`retentionDays`参数值将被忽略。</span><span class="sxs-lookup"><span data-stu-id="db667-891">If the `action` parameter is set to <xref:System.Diagnostics.OverflowAction.DoNotOverwrite>, the `retentionDays` parameter value is ignored.</span></span>  
  
> [!CAUTION]
>  <span data-ttu-id="db667-892">溢出策略设置为<xref:System.Diagnostics.OverflowAction.DoNotOverwrite>指定事件日志已满时，将丢弃新条目。</span><span class="sxs-lookup"><span data-stu-id="db667-892">Setting the overflow policy to <xref:System.Diagnostics.OverflowAction.DoNotOverwrite> specifies that new entries are discarded when the event log is full.</span></span> <span data-ttu-id="db667-893">如果使用此设置，请确保事件日志是定期存档和清除避免达到其最大大小限制。</span><span class="sxs-lookup"><span data-stu-id="db667-893">If you use this setting, ensure the event log is regularly archived and cleared to avoid reaching its maximum size limit.</span></span>  
  
   
  
## Examples  
 <span data-ttu-id="db667-894">下面的示例显示已配置的溢出策略为指定的事件日志，并允许用户选择新事件日志的溢出策略设置。</span><span class="sxs-lookup"><span data-stu-id="db667-894">The following example displays the configured overflow policy for a specified event log, and allows the user to select a new overflow policy setting for the event log.</span></span>  
  
 [!code-cpp[EventLogProperties#3](~/samples/snippets/cpp/VS_Snippets_CLR/EventLogProperties/CPP/source.cpp#3)]
 [!code-csharp[EventLogProperties#3](~/samples/snippets/csharp/VS_Snippets_CLR/EventLogProperties/CS/source.cs#3)]
 [!code-vb[EventLogProperties#3](~/samples/snippets/visualbasic/VS_Snippets_CLR/EventLogProperties/VB/source.vb#3)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ComponentModel.InvalidEnumArgumentException">
          <span data-ttu-id="db667-895">
            <paramref name="action" /> 不是有效的 <see cref="P:System.Diagnostics.EventLog.OverflowAction" /> 值。</span>
          <span class="sxs-lookup">
            <span data-stu-id="db667-895">
              <paramref name="action" /> is not a valid <see cref="P:System.Diagnostics.EventLog.OverflowAction" /> value.</span>
          </span>
        </exception>
        <exception cref="T:System.ArgumentOutOfRangeException">
          <span data-ttu-id="db667-896">
            <paramref name="retentionDays" /> 小于 1 或大于 365。</span>
          <span class="sxs-lookup">
            <span data-stu-id="db667-896">
              <paramref name="retentionDays" /> is less than one, or larger than 365.</span>
          </span>
        </exception>
        <exception cref="T:System.InvalidOperationException">
          <span data-ttu-id="db667-897">
            <see cref="P:System.Diagnostics.EventLog.Log" /> 值不是有效的日志名。</span>
          <span class="sxs-lookup">
            <span data-stu-id="db667-897">The <see cref="P:System.Diagnostics.EventLog.Log" /> value is not a valid log name.</span>
          </span>
          <span data-ttu-id="db667-898">\- 或 -</span>
          <span class="sxs-lookup">
            <span data-stu-id="db667-898">\- or -</span>
          </span>
          <span data-ttu-id="db667-899">事件日志的注册表项无法在目标计算机上打开。</span>
          <span class="sxs-lookup">
            <span data-stu-id="db667-899">The registry key for the event log could not be opened on the target computer.</span>
          </span>
        </exception>
        <permission cref="T:System.Diagnostics.EventLogPermission">
          <span data-ttu-id="db667-900">用于管理计算机上的事件日志信息。</span>
          <span class="sxs-lookup">
            <span data-stu-id="db667-900">for administering event log information on the computer.</span>
          </span>
          <span data-ttu-id="db667-901">关联的枚举： <see cref="F:System.Diagnostics.EventLogPermissionAccess.Administer" /></span>
          <span class="sxs-lookup">
            <span data-stu-id="db667-901">Associated enumeration: <see cref="F:System.Diagnostics.EventLogPermissionAccess.Administer" /></span>
          </span>
        </permission>
        <altmember cref="T:System.Diagnostics.OverflowAction" />
        <altmember cref="P:System.Diagnostics.EventLog.MaximumKilobytes" />
        <altmember cref="P:System.Diagnostics.EventLog.OverflowAction" />
        <altmember cref="P:System.Diagnostics.EventLog.MinimumRetentionDays" />
      </Docs>
    </Member>
    <Member MemberName="OverflowAction">
      <MemberSignature Language="C#" Value="public System.Diagnostics.OverflowAction OverflowAction { get; }" />
      <MemberSignature Language="ILAsm" Value=".property instance valuetype System.Diagnostics.OverflowAction OverflowAction" />
      <MemberSignature Language="DocId" Value="P:System.Diagnostics.EventLog.OverflowAction" />
      <MemberSignature Language="VB.NET" Value="Public ReadOnly Property OverflowAction As OverflowAction" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; property System::Diagnostics::OverflowAction OverflowAction { System::Diagnostics::OverflowAction get(); };" />
      <MemberSignature Language="F#" Value="member this.OverflowAction : System.Diagnostics.OverflowAction" Usage="System.Diagnostics.EventLog.OverflowAction" />
      <MemberType>Property</MemberType>
      <AssemblyInfo>
        <AssemblyName>System</AssemblyName>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Attributes>
        <Attribute FrameworkAlternate="netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;xamarinmac-3.0">
          <AttributeName>System.ComponentModel.Browsable(false)</AttributeName>
        </Attribute>
        <Attribute FrameworkAlternate="xamarinmac-3.0">
          <AttributeName>System.MonoTODO</AttributeName>
        </Attribute>
        <Attribute FrameworkAlternate="netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;xamarinmac-3.0">
          <AttributeName>System.Runtime.InteropServices.ComVisible(false)</AttributeName>
        </Attribute>
      </Attributes>
      <ReturnValue>
        <ReturnType>System.Diagnostics.OverflowAction</ReturnType>
      </ReturnValue>
      <Docs>
        <summary>
          <span data-ttu-id="db667-902">获取已配置的行为，以便在事件日志达到其最大文件大小时存储新项。</span>
          <span class="sxs-lookup">
            <span data-stu-id="db667-902">Gets the configured behavior for storing new entries when the event log reaches its maximum log file size.</span>
          </span>
        </summary>
        <value>
          <span data-ttu-id="db667-903">
            <see cref="T:System.Diagnostics.OverflowAction" /> 值，指定在事件日志达到其最大日志大小时存储新项的已配置行为。</span>
          <span class="sxs-lookup">
            <span data-stu-id="db667-903">The <see cref="T:System.Diagnostics.OverflowAction" /> value that specifies the configured behavior for storing new entries when the event log reaches its maximum log size.</span>
          </span>
          <span data-ttu-id="db667-904">默认值为 <see cref="F:System.Diagnostics.OverflowAction.OverwriteOlder" />。</span>
          <span class="sxs-lookup">
            <span data-stu-id="db667-904">The default is <see cref="F:System.Diagnostics.OverflowAction.OverwriteOlder" />.</span>
          </span>
        </value>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="db667-905">事件日志大小增大的新事件写入到它们。</span><span class="sxs-lookup"><span data-stu-id="db667-905">Event logs grow in size as new events are written to them.</span></span> <span data-ttu-id="db667-906">每个事件日志已配置的最大大小限制;<xref:System.Diagnostics.EventLog.MaximumKilobytes%2A>属性定义的最大事件日志文件大小所允许的千字节数。</span><span class="sxs-lookup"><span data-stu-id="db667-906">Each event log has a configured maximum size limit; the <xref:System.Diagnostics.EventLog.MaximumKilobytes%2A> property defines the maximum number of kilobytes allowed for the event log file size.</span></span>  
  
 <span data-ttu-id="db667-907">使用<xref:System.Diagnostics.EventLog.OverflowAction%2A>属性值来检查事件日志在其最大大小的已配置的溢出行为。</span><span class="sxs-lookup"><span data-stu-id="db667-907">Use the <xref:System.Diagnostics.EventLog.OverflowAction%2A> property value to examine the configured overflow behavior for an event log at its maximum size.</span></span> <span data-ttu-id="db667-908">使用<xref:System.Diagnostics.EventLog.ModifyOverflowPolicy%2A>方法，以更改事件日志的溢出行为。</span><span class="sxs-lookup"><span data-stu-id="db667-908">Use the <xref:System.Diagnostics.EventLog.ModifyOverflowPolicy%2A> method to change the overflow behavior for an event log.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="db667-909">仅在事件日志达到其最大文件大小时生效的溢出行为。</span><span class="sxs-lookup"><span data-stu-id="db667-909">The overflow behavior takes effect only when an event log reaches its maximum file size.</span></span> <span data-ttu-id="db667-910">溢出行为不会影响到可以容纳其他事件日志条目的日志写入新的条目。</span><span class="sxs-lookup"><span data-stu-id="db667-910">The overflow behavior does not affect writing a new entry to a log that can accommodate additional event log entries.</span></span>  
  
   
  
## Examples  
 <span data-ttu-id="db667-911">下面的示例枚举在本地计算机上定义的事件日志，并显示每个事件日志的配置详细信息。</span><span class="sxs-lookup"><span data-stu-id="db667-911">The following example enumerates the event logs defined on the local computer, and displays configuration details for each event log.</span></span>  
  
 [!code-cpp[EventLogProperties#2](~/samples/snippets/cpp/VS_Snippets_CLR/EventLogProperties/CPP/source.cpp#2)]
 [!code-csharp[EventLogProperties#2](~/samples/snippets/csharp/VS_Snippets_CLR/EventLogProperties/CS/source.cs#2)]
 [!code-vb[EventLogProperties#2](~/samples/snippets/visualbasic/VS_Snippets_CLR/EventLogProperties/VB/source.vb#2)]  
  
 ]]></format>
        </remarks>
        <permission cref="T:System.Diagnostics.EventLogPermission">
          <span data-ttu-id="db667-912">用于管理计算机上的事件日志信息。</span>
          <span class="sxs-lookup">
            <span data-stu-id="db667-912">for administering event log information on the computer.</span>
          </span>
          <span data-ttu-id="db667-913">关联的枚举： <see cref="F:System.Diagnostics.EventLogPermissionAccess.Administer" /></span>
          <span class="sxs-lookup">
            <span data-stu-id="db667-913">Associated enumeration: <see cref="F:System.Diagnostics.EventLogPermissionAccess.Administer" /></span>
          </span>
        </permission>
        <altmember cref="T:System.Diagnostics.OverflowAction" />
        <altmember cref="P:System.Diagnostics.EventLog.MaximumKilobytes" />
        <altmember cref="M:System.Diagnostics.EventLog.ModifyOverflowPolicy(System.Diagnostics.OverflowAction,System.Int32)" />
        <altmember cref="P:System.Diagnostics.EventLog.MinimumRetentionDays" />
      </Docs>
    </Member>
    <Member MemberName="RegisterDisplayName">
      <MemberSignature Language="C#" Value="public void RegisterDisplayName (string resourceFile, long resourceId);" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig instance void RegisterDisplayName(string resourceFile, int64 resourceId) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Diagnostics.EventLog.RegisterDisplayName(System.String,System.Int64)" />
      <MemberSignature Language="VB.NET" Value="Public Sub RegisterDisplayName (resourceFile As String, resourceId As Long)" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; void RegisterDisplayName(System::String ^ resourceFile, long resourceId);" />
      <MemberSignature Language="F#" Value="member this.RegisterDisplayName : string * int64 -&gt; unit" Usage="eventLog.RegisterDisplayName (resourceFile, resourceId)" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System</AssemblyName>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Attributes>
        <Attribute FrameworkAlternate="xamarinmac-3.0">
          <AttributeName>System.MonoTODO</AttributeName>
        </Attribute>
        <Attribute FrameworkAlternate="netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;xamarinmac-3.0">
          <AttributeName>System.Runtime.InteropServices.ComVisible(false)</AttributeName>
        </Attribute>
      </Attributes>
      <ReturnValue>
        <ReturnType>System.Void</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="resourceFile" Type="System.String" />
        <Parameter Name="resourceId" Type="System.Int64" />
      </Parameters>
      <Docs>
        <param name="resourceFile">
          <span data-ttu-id="db667-914">本地化资源文件的完全指定的路径。</span>
          <span class="sxs-lookup">
            <span data-stu-id="db667-914">The fully specified path to a localized resource file.</span>
          </span>
        </param>
        <param name="resourceId">
          <span data-ttu-id="db667-915">在资源文件内指明一个本地化字符串的资源标识符。</span>
          <span class="sxs-lookup">
            <span data-stu-id="db667-915">The resource identifier that indexes a localized string within the resource file.</span>
          </span>
        </param>
        <summary>
          <span data-ttu-id="db667-916">指定该事件日志的本地化名称，它显示在服务器事件查看器中。</span>
          <span class="sxs-lookup">
            <span data-stu-id="db667-916">Specifies the localized name of the event log, which is displayed in the server Event Viewer.</span>
          </span>
        </summary>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="db667-917">使用<xref:System.Diagnostics.EventLog.RegisterDisplayName%2A>进行注册和自定义事件日志的事件查看器中显示的本地化的名称。</span><span class="sxs-lookup"><span data-stu-id="db667-917">Use <xref:System.Diagnostics.EventLog.RegisterDisplayName%2A> to register and display a localized name in the Event Viewer for custom event logs.</span></span>  
  
 <span data-ttu-id="db667-918">指定的资源标识符必须对应于资源文件中定义的已本地化字符串。</span><span class="sxs-lookup"><span data-stu-id="db667-918">The specified resource identifier must correspond to a localized string defined in the resource file.</span></span> <span data-ttu-id="db667-919">事件查看器显示使用本地化的字符串和当前区域性设置的自定义事件日志名称。</span><span class="sxs-lookup"><span data-stu-id="db667-919">The Event Viewer displays the custom event log name using the localized string and the current culture settings.</span></span> <span data-ttu-id="db667-920">例如，可以定义多个资源文件中的不同区域性的本地化的事件日志名称。</span><span class="sxs-lookup"><span data-stu-id="db667-920">For example, you can define multiple event log names localized for different cultures in your resource file.</span></span> <span data-ttu-id="db667-921">事件查看器显示与当前用户的区域性设置相对应的本地化的字符串。</span><span class="sxs-lookup"><span data-stu-id="db667-921">The Event Viewer displays the localized string corresponding to the culture settings of the current user.</span></span>  
  
 <span data-ttu-id="db667-922">如果在事件查看器无法从资源文件中，加载已本地化的字符串，或如果没有显示名称已注册的事件日志，事件查看器显示中定义的事件日志名称<xref:System.Diagnostics.EventLog.Log%2A>。</span><span class="sxs-lookup"><span data-stu-id="db667-922">If the Event Viewer cannot load the localized string from the resource file, or if no display name was registered for the event log, then the Event Viewer displays the event log name defined in <xref:System.Diagnostics.EventLog.Log%2A>.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="db667-923">不需要注册预定义的事件日志的显示名称。</span><span class="sxs-lookup"><span data-stu-id="db667-923">You do not need to register a display name for the pre-defined event logs.</span></span> <span data-ttu-id="db667-924">操作系统注册应用程序、 系统和安全事件日志的本地化的显示名称。</span><span class="sxs-lookup"><span data-stu-id="db667-924">The operating system registers the localized display names for the Application, System, and Security event logs.</span></span>  
  
   
  
## Examples  
 <span data-ttu-id="db667-925">下面的示例确定是否在事件源名为`SampleApplicationSource`在本地计算机上注册。</span><span class="sxs-lookup"><span data-stu-id="db667-925">The following example determines whether the event source named `SampleApplicationSource` is registered on the local computer.</span></span> <span data-ttu-id="db667-926">如果事件源不存在，该示例设置源的消息资源文件，并创建新的事件源。</span><span class="sxs-lookup"><span data-stu-id="db667-926">If the event source does not exist, the example sets the message resource file for the source and creates the new event source.</span></span> <span data-ttu-id="db667-927">最后，该示例设置使用中的资源标识符值的事件日志的本地化的显示名称`DisplayNameMsgId`中的资源文件路径和`messageFile`。</span><span class="sxs-lookup"><span data-stu-id="db667-927">Finally, the example sets the localized display name for the event log, using the resource identifier value in `DisplayNameMsgId` and the resource file path in `messageFile`.</span></span>  
  
 [!code-cpp[EventLog_WriteEvent#6](~/samples/snippets/cpp/VS_Snippets_CLR/eventlog_WriteEvent/CPP/source.cpp#6)]
 [!code-csharp[EventLog_WriteEvent#6](~/samples/snippets/csharp/VS_Snippets_CLR/eventlog_WriteEvent/CS/source.cs#6)]
 [!code-vb[EventLog_WriteEvent#6](~/samples/snippets/visualbasic/VS_Snippets_CLR/eventlog_WriteEvent/VB/source.vb#6)]  
  
 <span data-ttu-id="db667-928">该示例使用下面的消息文本文件，内置的资源库 EventLogMsgs.dll。</span><span class="sxs-lookup"><span data-stu-id="db667-928">The example uses the following message text file, built into the resource library EventLogMsgs.dll.</span></span> <span data-ttu-id="db667-929">消息文本文件是从其创建的消息资源文件的源。</span><span class="sxs-lookup"><span data-stu-id="db667-929">A message text file is the source from which the message resource file is created.</span></span> <span data-ttu-id="db667-930">消息文本文件定义的资源标识符和类别、 事件消息和参数插入字符串的文本。</span><span class="sxs-lookup"><span data-stu-id="db667-930">The message text file defines the resource identifiers and text for the category, event message, and parameter insertion strings.</span></span> <span data-ttu-id="db667-931">具体而言，为事件日志的本地化名称定义了资源标识符为 5001。</span><span class="sxs-lookup"><span data-stu-id="db667-931">Specifically, resource identifier 5001 is defined for the localized name of the event log.</span></span>  
  
```  
; // EventLogMsgs.mc  
; // ********************************************************  
  
; // Use the following commands to build this file:  
  
; //   mc -s EventLogMsgs.mc  
; //   rc EventLogMsgs.rc  
; //   link /DLL /SUBSYSTEM:WINDOWS /NOENTRY /MACHINE:x86 EventLogMsgs.Res   
; // ********************************************************  
  
; // - Event categories -  
; // Categories must be numbered consecutively starting at 1.  
; // ********************************************************  
  
MessageId=0x1  
Severity=Success  
SymbolicName=INSTALL_CATEGORY  
Language=English  
Installation  
.  
  
MessageId=0x2  
Severity=Success  
SymbolicName=QUERY_CATEGORY  
Language=English  
Database Query  
.  
  
MessageId=0x3  
Severity=Success  
SymbolicName=REFRESH_CATEGORY  
Language=English  
Data Refresh  
.  
  
; // - Event messages -  
; // *********************************  
  
MessageId = 1000  
Severity = Success  
Facility = Application  
SymbolicName = AUDIT_SUCCESS_MESSAGE_ID_1000  
Language=English  
My application message text, in English, for message id 1000, called from %1.  
.  
  
MessageId = 1001  
Severity = Warning  
Facility = Application  
SymbolicName = AUDIT_FAILED_MESSAGE_ID_1001  
Language=English  
My application message text, in English, for message id 1001, called from %1.  
.  
  
MessageId = 1002  
Severity = Success  
Facility = Application  
SymbolicName = GENERIC_INFO_MESSAGE_ID_1002  
Language=English  
My generic information message in English, for message id 1002.  
.  
  
MessageId = 1003  
Severity = Warning  
Facility = Application  
SymbolicName = GENERIC_WARNING_MESSAGE_ID_1003  
Language=English  
My generic warning message in English, for message id 1003, called from %1.  
.  
  
MessageId = 1004  
Severity = Success  
Facility = Application  
SymbolicName = UPDATE_CYCLE_COMPLETE_MESSAGE_ID_1004  
Language=English  
The update cycle is complete for %%5002.  
.  
  
MessageId = 1005  
Severity = Warning  
Facility = Application  
SymbolicName = SERVER_CONNECTION_DOWN_MESSAGE_ID_1005  
Language=English  
The refresh operation did not complete because the connection to server %1 could not be established.  
.  
  
; // - Event log display name -  
; // ********************************************************  
  
MessageId = 5001  
Severity = Success  
Facility = Application  
SymbolicName = EVENT_LOG_DISPLAY_NAME_MSGID  
Language=English  
Sample Event Log  
.  
  
; // - Event message parameters -  
; //   Language independent insertion strings  
; // ********************************************************  
  
MessageId = 5002  
Severity = Success  
Facility = Application  
SymbolicName = EVENT_LOG_SERVICE_NAME_MSGID  
Language=English  
SVC_UPDATE.EXE  
.  
```  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.InvalidOperationException">
          <span data-ttu-id="db667-932">
            <see cref="P:System.Diagnostics.EventLog.Log" /> 值不是有效的日志名。</span>
          <span class="sxs-lookup">
            <span data-stu-id="db667-932">The <see cref="P:System.Diagnostics.EventLog.Log" /> value is not a valid log name.</span>
          </span>
          <span data-ttu-id="db667-933">\- 或 -</span>
          <span class="sxs-lookup">
            <span data-stu-id="db667-933">\- or -</span>
          </span>
          <span data-ttu-id="db667-934">事件日志的注册表项无法在目标计算机上打开。</span>
          <span class="sxs-lookup">
            <span data-stu-id="db667-934">The registry key for the event log could not be opened on the target computer.</span>
          </span>
        </exception>
        <exception cref="T:System.ArgumentNullException">
          <span data-ttu-id="db667-935">
            <paramref name="resourceFile" /> 为 <see langword="null" />。</span>
          <span class="sxs-lookup">
            <span data-stu-id="db667-935">
              <paramref name="resourceFile" /> is <see langword="null" />.</span>
          </span>
        </exception>
        <permission cref="T:System.Diagnostics.EventLogPermission">
          <span data-ttu-id="db667-936">用于管理计算机上的事件日志信息。</span>
          <span class="sxs-lookup">
            <span data-stu-id="db667-936">for administering event log information on the computer.</span>
          </span>
          <span data-ttu-id="db667-937">关联的枚举： <see cref="F:System.Diagnostics.EventLogPermissionAccess.Administer" /></span>
          <span class="sxs-lookup">
            <span data-stu-id="db667-937">Associated enumeration: <see cref="F:System.Diagnostics.EventLogPermissionAccess.Administer" /></span>
          </span>
        </permission>
        <altmember cref="P:System.Diagnostics.EventLog.LogDisplayName" />
      </Docs>
    </Member>
    <Member MemberName="Source">
      <MemberSignature Language="C#" Value="public string Source { get; set; }" />
      <MemberSignature Language="ILAsm" Value=".property instance string Source" />
      <MemberSignature Language="DocId" Value="P:System.Diagnostics.EventLog.Source" />
      <MemberSignature Language="VB.NET" Value="Public Property Source As String" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; property System::String ^ Source { System::String ^ get(); void set(System::String ^ value); };" />
      <MemberSignature Language="F#" Value="member this.Source : string with get, set" Usage="System.Diagnostics.EventLog.Source" />
      <MemberType>Property</MemberType>
      <AssemblyInfo>
        <AssemblyName>System</AssemblyName>
        <AssemblyVersion>1.0.5000.0</AssemblyVersion>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Attributes>
        <Attribute FrameworkAlternate="netframework-1.1;netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;xamarinmac-3.0">
          <AttributeName>System.ComponentModel.DefaultValue("")</AttributeName>
        </Attribute>
        <Attribute FrameworkAlternate="netframework-1.1;netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;xamarinmac-3.0">
          <AttributeName>System.ComponentModel.ReadOnly(true)</AttributeName>
        </Attribute>
        <Attribute FrameworkAlternate="netframework-1.1;netframework-2.0;netframework-3.0;netframework-3.5;xamarinmac-3.0">
          <AttributeName>System.ComponentModel.RecommendedAsConfigurable(true)</AttributeName>
        </Attribute>
        <Attribute FrameworkAlternate="netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;xamarinmac-3.0">
          <AttributeName>System.ComponentModel.TypeConverter("System.Diagnostics.Design.StringValueConverter, System.Design, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b03f5f7f11d50a3a")</AttributeName>
        </Attribute>
        <Attribute FrameworkAlternate="xamarinmac-3.0">
          <AttributeName>System.Diagnostics.MonitoringDescription("The application name that writes the log.")</AttributeName>
        </Attribute>
        <Attribute FrameworkAlternate="netframework-1.1">
          <AttributeName>System.ComponentModel.TypeConverter("System.Diagnostics.Design.StringValueConverter, System.Design, Version=1.0.5000.0, Culture=neutral, PublicKeyToken=b03f5f7f11d50a3a")</AttributeName>
        </Attribute>
        <Attribute FrameworkAlternate="netframework-1.1;netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2">
          <AttributeName>System.Diagnostics.MonitoringDescription("LogSource")</AttributeName>
        </Attribute>
        <Attribute FrameworkAlternate="netframework-2.0;netframework-3.0;netframework-3.5">
          <AttributeName>System.ComponentModel.TypeConverter("System.Diagnostics.Design.StringValueConverter, System.Design, Version=2.0.0.0, Culture=neutral, PublicKeyToken=b03f5f7f11d50a3a")</AttributeName>
        </Attribute>
        <Attribute FrameworkAlternate="netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2">
          <AttributeName>System.ComponentModel.SettingsBindable(true)</AttributeName>
        </Attribute>
      </Attributes>
      <ReturnValue>
        <ReturnType>System.String</ReturnType>
      </ReturnValue>
      <Docs>
        <summary>
          <span data-ttu-id="db667-938">获取或设置在写入事件日志时要注册和使用的源名称。</span>
          <span class="sxs-lookup">
            <span data-stu-id="db667-938">Gets or sets the source name to register and use when writing to the event log.</span>
          </span>
        </summary>
        <value>
          <span data-ttu-id="db667-939">在事件日志中注册为项源的名称。</span>
          <span class="sxs-lookup">
            <span data-stu-id="db667-939">The name registered with the event log as a source of entries.</span>
          </span>
          <span data-ttu-id="db667-940">默认值为空字符串("")。</span>
          <span class="sxs-lookup">
            <span data-stu-id="db667-940">The default is an empty string ("").</span>
          </span>
        </value>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="db667-941">事件源指示什么来记录事件。</span><span class="sxs-lookup"><span data-stu-id="db667-941">The event source indicates what logs the event.</span></span> <span data-ttu-id="db667-942">通常是应用程序的名称或子组件的应用程序的名称时应用程序非常大。</span><span class="sxs-lookup"><span data-stu-id="db667-942">It is often the name of the application, or the name of a subcomponent of the application, if the application is large.</span></span> <span data-ttu-id="db667-943">应用程序和服务应写入应用程序日志或自定义日志。</span><span class="sxs-lookup"><span data-stu-id="db667-943">Applications and services should write to the Application log or a custom log.</span></span> <span data-ttu-id="db667-944">设备驱动程序应该写入系统日志。</span><span class="sxs-lookup"><span data-stu-id="db667-944">Device drivers should write to the System log.</span></span>  
  
 <span data-ttu-id="db667-945">只需指定事件源，如果将写入事件日志。</span><span class="sxs-lookup"><span data-stu-id="db667-945">You only need to specify an event source if you are writing to an event log.</span></span> <span data-ttu-id="db667-946">之前向事件日志写入条目，您必须注册事件源的事件日志作为有效的事件源。</span><span class="sxs-lookup"><span data-stu-id="db667-946">Before writing an entry to an event log, you must register the event source with the event log as a valid source of events.</span></span> <span data-ttu-id="db667-947">写入日志条目时，系统会将<xref:System.Diagnostics.EventLog.Source%2A>属性来查找要在其中放置您的输入适当的日志。</span><span class="sxs-lookup"><span data-stu-id="db667-947">When you write a log entry, the system uses the <xref:System.Diagnostics.EventLog.Source%2A> property to find the appropriate log in which to place your entry.</span></span> <span data-ttu-id="db667-948">如果您正在读取事件日志，您可以指定<xref:System.Diagnostics.EventLog.Source%2A>，或<xref:System.Diagnostics.EventLog.Log%2A>和<xref:System.Diagnostics.EventLog.MachineName%2A>。</span><span class="sxs-lookup"><span data-stu-id="db667-948">If you are reading the event log, you can either specify the <xref:System.Diagnostics.EventLog.Source%2A>, or a <xref:System.Diagnostics.EventLog.Log%2A> and <xref:System.Diagnostics.EventLog.MachineName%2A>.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="db667-949">您不需要指定<xref:System.Diagnostics.EventLog.MachineName%2A>如果要连接到本地计算机上的日志。</span><span class="sxs-lookup"><span data-stu-id="db667-949">You are not required to specify the <xref:System.Diagnostics.EventLog.MachineName%2A> if you are connecting to a log on the local computer.</span></span> <span data-ttu-id="db667-950">如果未指定<xref:System.Diagnostics.EventLog.MachineName%2A>，本地计算机 ("。") 假定。</span><span class="sxs-lookup"><span data-stu-id="db667-950">If you do not specify the <xref:System.Diagnostics.EventLog.MachineName%2A>, the local computer (".") is assumed.</span></span>  
  
 <span data-ttu-id="db667-951">使用<xref:System.Diagnostics.EventLog.WriteEvent%2A>和<xref:System.Diagnostics.EventLog.WriteEntry%2A>将事件写入到事件日志。</span><span class="sxs-lookup"><span data-stu-id="db667-951">Use <xref:System.Diagnostics.EventLog.WriteEvent%2A> and <xref:System.Diagnostics.EventLog.WriteEntry%2A> to write events to an event log.</span></span> <span data-ttu-id="db667-952">必须指定事件源写入事件;必须创建并写入与源的第一项之前配置的事件源。</span><span class="sxs-lookup"><span data-stu-id="db667-952">You must specify an event source to write events; you must create and configure the event source before writing the first entry with the source.</span></span>  
  
 <span data-ttu-id="db667-953">在应用程序的安装过程中创建新的事件源。</span><span class="sxs-lookup"><span data-stu-id="db667-953">Create the new event source during the installation of your application.</span></span> <span data-ttu-id="db667-954">这允许操作系统以刷新其注册的事件源的列表和其配置的时间。</span><span class="sxs-lookup"><span data-stu-id="db667-954">This allows time for the operating system to refresh its list of registered event sources and their configuration.</span></span> <span data-ttu-id="db667-955">如果操作系统没有刷新其事件源的列表，并且尝试写入新的源的事件写入操作将失败。</span><span class="sxs-lookup"><span data-stu-id="db667-955">If the operating system has not refreshed its list of event sources, and you attempt to write an event with the new source, the write operation will fail.</span></span> <span data-ttu-id="db667-956">可以配置新的源使用<xref:System.Diagnostics.EventLogInstaller>，或使用<xref:System.Diagnostics.EventLog.CreateEventSource%2A>方法。</span><span class="sxs-lookup"><span data-stu-id="db667-956">You can configure a new source using an <xref:System.Diagnostics.EventLogInstaller>, or using the <xref:System.Diagnostics.EventLog.CreateEventSource%2A> method.</span></span> <span data-ttu-id="db667-957">若要创建新的事件源的计算机上，必须具有管理权限。</span><span class="sxs-lookup"><span data-stu-id="db667-957">You must have administrative rights on the computer to create a new event source.</span></span>  
  
 <span data-ttu-id="db667-958">可以创建现有事件日志或新的事件日志的事件源。</span><span class="sxs-lookup"><span data-stu-id="db667-958">You can create an event source for an existing event log or a new event log.</span></span> <span data-ttu-id="db667-959">创建新的源为新的事件日志时，系统注册该日志的源，但直到第一个条目写入不创建该日志。</span><span class="sxs-lookup"><span data-stu-id="db667-959">When you create a new source for a new event log, the system registers the source for that log, but the log is not created until the first entry is written to it.</span></span>  
  
 <span data-ttu-id="db667-960">源必须是本地计算机; 上唯一新的源名称不能与现有的源名称或现有的事件日志名称匹配。</span><span class="sxs-lookup"><span data-stu-id="db667-960">The source must be unique on the local computer; a new source name cannot match an existing source name or an existing event log name.</span></span> <span data-ttu-id="db667-961">每个源可以一次; 写入一个事件日志但是，你的应用程序可以使用多个源写入多个事件日志。</span><span class="sxs-lookup"><span data-stu-id="db667-961">Each source can write to only one event log at a time; however, your application can use multiple sources to write to multiple event logs.</span></span> <span data-ttu-id="db667-962">例如，你的应用程序可能需要多个源配置为使用不同的事件日志或不同的资源文件。</span><span class="sxs-lookup"><span data-stu-id="db667-962">For example, your application might require multiple sources configured for different event logs or different resource files.</span></span>  
  
 <span data-ttu-id="db667-963">如果您更改<xref:System.Diagnostics.EventLog.Source%2A>值，<xref:System.Diagnostics.EventLog>为它注册已关闭并释放所有的事件句柄。</span><span class="sxs-lookup"><span data-stu-id="db667-963">If you change the <xref:System.Diagnostics.EventLog.Source%2A> value, the <xref:System.Diagnostics.EventLog> to which it is registered is closed and all event handles are released.</span></span>  
  
 <span data-ttu-id="db667-964">要写入本地化的项还是要直接写入字符串，必须配置源。</span><span class="sxs-lookup"><span data-stu-id="db667-964">The source must be configured either for writing localized entries or for writing direct strings.</span></span> <span data-ttu-id="db667-965">如果你的应用程序将使用资源标识符和字符串值的条目写入，则必须注册两个单独的源。</span><span class="sxs-lookup"><span data-stu-id="db667-965">If your application writes entries using both resource identifiers and string values, you must register two separate sources.</span></span> <span data-ttu-id="db667-966">例如，配置一个源的资源文件，以及如何将该源中的<xref:System.Diagnostics.EventLog.WriteEvent%2A>方法来编写使用资源标识符添加到事件日志条目。</span><span class="sxs-lookup"><span data-stu-id="db667-966">For example, configure one source with resource files, and then use that source in the <xref:System.Diagnostics.EventLog.WriteEvent%2A> method to write entries using resource identifiers to the event log.</span></span> <span data-ttu-id="db667-967">然后创建不同的源，而无需资源文件，并使用在该源<xref:System.Diagnostics.EventLog.WriteEntry%2A>方法将字符串直接写入事件日志使用的源。</span><span class="sxs-lookup"><span data-stu-id="db667-967">Then create a different source without resource files, and use that source in the <xref:System.Diagnostics.EventLog.WriteEntry%2A> method to write strings directly to the event log using that source.</span></span>  
  
 <span data-ttu-id="db667-968">若要更改现有源的配置详细信息，必须删除源，然后使用新的配置创建它。</span><span class="sxs-lookup"><span data-stu-id="db667-968">To change the configuration details of an existing source, you must delete the source and then create it with the new configuration.</span></span> <span data-ttu-id="db667-969">如果其他应用程序或组件使用现有的源，请使用更新的配置，而无需删除现有源创建新的源。</span><span class="sxs-lookup"><span data-stu-id="db667-969">If other applications or components use the existing source, create a new source with the updated configuration rather than deleting the existing source.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="db667-970">如果源已映射到某个日志并重新映射到新的日志，必须重新启动计算机更改才能生效。</span><span class="sxs-lookup"><span data-stu-id="db667-970">If a source has already been mapped to a log and you remap it to a new log, you must restart the computer for the changes to take effect.</span></span>  
  
   
  
## Examples  
 <span data-ttu-id="db667-971">下面的示例创建源`MySource`如果它尚不存在，并将条目写入到事件日志`MyNewLog`。</span><span class="sxs-lookup"><span data-stu-id="db667-971">The following example creates the source `MySource` if it does not already exist, and writes an entry to the event log `MyNewLog`.</span></span>  
  
 [!code-cpp[Classic EventLog.Source Example#1](~/samples/snippets/cpp/VS_Snippets_CLR_Classic/classic EventLog.Source Example/CPP/source.cpp#1)]
 [!code-csharp[Classic EventLog.Source Example#1](~/samples/snippets/csharp/VS_Snippets_CLR_Classic/classic EventLog.Source Example/CS/source.cs#1)]
 [!code-vb[Classic EventLog.Source Example#1](~/samples/snippets/visualbasic/VS_Snippets_CLR_Classic/classic EventLog.Source Example/VB/source.vb#1)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentException">
          <span data-ttu-id="db667-972">此源名称导致注册表项路径的长度超过 254 个字符。</span>
          <span class="sxs-lookup">
            <span data-stu-id="db667-972">The source name results in a registry key path longer than 254 characters.</span>
          </span>
        </exception>
        <permission cref="T:System.Diagnostics.EventLogPermission">
          <span data-ttu-id="db667-973">用于写入的计算机上的事件日志信息。</span>
          <span class="sxs-lookup">
            <span data-stu-id="db667-973">for writing the event log information on the computer.</span>
          </span>
          <span data-ttu-id="db667-974">关联的枚举： <see cref="F:System.Diagnostics.EventLogPermissionAccess.Write" /></span>
          <span class="sxs-lookup">
            <span data-stu-id="db667-974">Associated enumeration: <see cref="F:System.Diagnostics.EventLogPermissionAccess.Write" /></span>
          </span>
        </permission>
        <altmember cref="P:System.Diagnostics.EventLog.Log" />
        <altmember cref="P:System.Diagnostics.EventLog.MachineName" />
        <altmember cref="Overload:System.Diagnostics.EventLog.CreateEventSource" />
        <altmember cref="M:System.Diagnostics.EventLog.DeleteEventSource(System.String)" />
        <altmember cref="M:System.Diagnostics.EventLog.SourceExists(System.String)" />
      </Docs>
    </Member>
    <MemberGroup MemberName="SourceExists">
      <AssemblyInfo>
        <AssemblyName>System</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Docs>
        <summary>
          <span data-ttu-id="db667-975">在计算机的注册表中搜索给定的事件源。</span>
          <span class="sxs-lookup">
            <span data-stu-id="db667-975">Searches a computer's registry for a given event source.</span>
          </span>
        </summary>
      </Docs>
    </MemberGroup>
    <Member MemberName="SourceExists">
      <MemberSignature Language="C#" Value="public static bool SourceExists (string source);" />
      <MemberSignature Language="ILAsm" Value=".method public static hidebysig bool SourceExists(string source) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Diagnostics.EventLog.SourceExists(System.String)" />
      <MemberSignature Language="VB.NET" Value="Public Shared Function SourceExists (source As String) As Boolean" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; static bool SourceExists(System::String ^ source);" />
      <MemberSignature Language="F#" Value="static member SourceExists : string -&gt; bool" Usage="System.Diagnostics.EventLog.SourceExists source" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System</AssemblyName>
        <AssemblyVersion>1.0.5000.0</AssemblyVersion>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Attributes>
        <Attribute FrameworkAlternate="netframework-4.0">
          <AttributeName>System.Runtime.TargetedPatchingOptOut("Performance critical to inline this type of method across NGen image boundaries")</AttributeName>
        </Attribute>
      </Attributes>
      <ReturnValue>
        <ReturnType>System.Boolean</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="source" Type="System.String" />
      </Parameters>
      <Docs>
        <param name="source">
          <span data-ttu-id="db667-976">事件源的名称。</span>
          <span class="sxs-lookup">
            <span data-stu-id="db667-976">The name of the event source.</span>
          </span>
        </param>
        <summary>
          <span data-ttu-id="db667-977">确定事件源是否已在本地计算机上注册。</span>
          <span class="sxs-lookup">
            <span data-stu-id="db667-977">Determines whether an event source is registered on the local computer.</span>
          </span>
        </summary>
        <returns>
          <span data-ttu-id="db667-978">如果事件源已在本地计算机上注册，则为 <see langword="true" />；否则为 <see langword="false" />。</span>
          <span class="sxs-lookup">
            <span data-stu-id="db667-978">
              <see langword="true" /> if the event source is registered on the local computer; otherwise, <see langword="false" />.</span>
          </span>
        </returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="db667-979">此方法用于确定本地计算机上是否存在的事件源。</span><span class="sxs-lookup"><span data-stu-id="db667-979">Use this method to determine whether an event source exists on the local computer.</span></span> <span data-ttu-id="db667-980">如果想要确定日志是否存在于在本地计算机上，使用<xref:System.Diagnostics.EventLog.Exists%2A>。</span><span class="sxs-lookup"><span data-stu-id="db667-980">If you want to determine whether a log exists on the local computer, use <xref:System.Diagnostics.EventLog.Exists%2A>.</span></span>  
  
 <span data-ttu-id="db667-981">由于此方法访问注册表，您必须在本地计算机，则拥有相应的注册表权限否则为<xref:System.Security.SecurityException>将引发。</span><span class="sxs-lookup"><span data-stu-id="db667-981">Because this method accesses the registry, you must have the appropriate registry permissions on the local computer; otherwise, a <xref:System.Security.SecurityException> will be thrown.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="db667-982">若要搜索的事件源在 Windows Vista 及更高版本或 Windows Server 2003，必须具有管理权限。</span><span class="sxs-lookup"><span data-stu-id="db667-982">To search for an event source in Windows Vista and later or Windows Server 2003, you must have administrative privileges.</span></span>  
>   
>  <span data-ttu-id="db667-983">这一要求的原因是必须搜索所有事件日志，包括安全性，以确定事件源是否唯一。</span><span class="sxs-lookup"><span data-stu-id="db667-983">The reason for this requirement is that all event logs, including security, must be searched to determine whether the event source is unique.</span></span> <span data-ttu-id="db667-984">从 Windows Vista 开始，用户没有权限访问该安全日志。因此，<xref:System.Security.SecurityException>引发。</span><span class="sxs-lookup"><span data-stu-id="db667-984">Starting with Windows Vista, users do not have permission to access the security log; therefore, a <xref:System.Security.SecurityException> is thrown.</span></span>  
>   
>  <span data-ttu-id="db667-985">从 Windows Vista 开始，用户帐户控制 (UAC) 决定用户的特权。</span><span class="sxs-lookup"><span data-stu-id="db667-985">Starting with Windows Vista, User Account Control (UAC) determines the privileges of a user.</span></span> <span data-ttu-id="db667-986">如果您是内置的 Administrators 组的成员，将为您分配两个运行时访问令牌：一个标准用户访问令牌和一个管理员访问令牌。</span><span class="sxs-lookup"><span data-stu-id="db667-986">If you are a member of the Built-in Administrators group, you are assigned two run-time access tokens: a standard user access token and an administrator access token.</span></span> <span data-ttu-id="db667-987">默认情况下，您拥有标准用户角色。</span><span class="sxs-lookup"><span data-stu-id="db667-987">By default, you are in the standard user role.</span></span> <span data-ttu-id="db667-988">若要执行访问性能计数器的代码，首先必须将你的特权从标准用户提升至管理员。</span><span class="sxs-lookup"><span data-stu-id="db667-988">To execute the code that accesses performance counters, you must first elevate your privileges from standard user to administrator.</span></span> <span data-ttu-id="db667-989">你可以通过以下方式执行此操作：右键单击应用程序图标并指示需以管理员身份运行。</span><span class="sxs-lookup"><span data-stu-id="db667-989">You can do this when you start an application by right-clicking the application icon and indicating that you want to run as an administrator.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="db667-990">执行时使用的服务<xref:System.ServiceProcess.ServiceAccount.LocalSystem>帐户没有执行此方法所需的权限。</span><span class="sxs-lookup"><span data-stu-id="db667-990">A service that is executing under the <xref:System.ServiceProcess.ServiceAccount.LocalSystem> account does not have the privileges required to execute this method.</span></span> <span data-ttu-id="db667-991">解决方法是检查中是否存在事件源<xref:System.ServiceProcess.ServiceInstaller>，并且如果它不存在，在安装程序中创建源。</span><span class="sxs-lookup"><span data-stu-id="db667-991">The solution is to check whether the event source exists in the <xref:System.ServiceProcess.ServiceInstaller>, and if it does not exist, to create the source in the installer.</span></span>  
  
 <span data-ttu-id="db667-992">由于不能为新的源提供的同一台计算机上的现有源名称，使用此方法尝试之前调用<xref:System.Diagnostics.EventLog.CreateEventSource%2A>，确保源与指定的名称`source`本地计算机上尚不存在。</span><span class="sxs-lookup"><span data-stu-id="db667-992">Because you cannot give a new source the name of an existing source on the same computer, use this method before attempting to call <xref:System.Diagnostics.EventLog.CreateEventSource%2A> to ensure that a source with the name specified by `source` does not already exist on the local computer.</span></span> <span data-ttu-id="db667-993">`source`参数不区分大小写。</span><span class="sxs-lookup"><span data-stu-id="db667-993">The `source` parameter is not case-sensitive.</span></span>  
  
   
  
## Examples  
 <span data-ttu-id="db667-994">下面的示例创建源`MySource`如果它尚不存在，并将条目写入到事件日志`MyNewLog`。</span><span class="sxs-lookup"><span data-stu-id="db667-994">The following example creates the source `MySource` if it does not already exist, and writes an entry to the event log `MyNewLog`.</span></span>  
  
 [!code-cpp[Classic EventLog.Source Example#1](~/samples/snippets/cpp/VS_Snippets_CLR_Classic/classic EventLog.Source Example/CPP/source.cpp#1)]
 [!code-csharp[Classic EventLog.Source Example#1](~/samples/snippets/csharp/VS_Snippets_CLR_Classic/classic EventLog.Source Example/CS/source.cs#1)]
 [!code-vb[Classic EventLog.Source Example#1](~/samples/snippets/visualbasic/VS_Snippets_CLR_Classic/classic EventLog.Source Example/VB/source.vb#1)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.Security.SecurityException">
          <span data-ttu-id="db667-995">未找到 <paramref name="source" />，无法搜索部分或全部事件日志。</span>
          <span class="sxs-lookup">
            <span data-stu-id="db667-995">
              <paramref name="source" /> was not found, but some or all of the event logs could not be searched.</span>
          </span>
        </exception>
        <permission cref="T:System.Diagnostics.EventLogPermission">
          <span data-ttu-id="db667-996">用于写入的计算机上的事件日志信息。</span>
          <span class="sxs-lookup">
            <span data-stu-id="db667-996">for writing the event log information on the computer.</span>
          </span>
          <span data-ttu-id="db667-997">关联的枚举： <see cref="F:System.Diagnostics.EventLogPermissionAccess.Write" /></span>
          <span class="sxs-lookup">
            <span data-stu-id="db667-997">Associated enumeration: <see cref="F:System.Diagnostics.EventLogPermissionAccess.Write" /></span>
          </span>
        </permission>
        <altmember cref="Overload:System.Diagnostics.EventLog.CreateEventSource" />
        <altmember cref="M:System.Diagnostics.EventLog.DeleteEventSource(System.String)" />
        <altmember cref="M:System.Diagnostics.EventLog.Exists(System.String)" />
        <altmember cref="P:System.Diagnostics.EventLog.Source" />
      </Docs>
    </Member>
    <Member MemberName="SourceExists">
      <MemberSignature Language="C#" Value="public static bool SourceExists (string source, string machineName);" />
      <MemberSignature Language="ILAsm" Value=".method public static hidebysig bool SourceExists(string source, string machineName) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Diagnostics.EventLog.SourceExists(System.String,System.String)" />
      <MemberSignature Language="VB.NET" Value="Public Shared Function SourceExists (source As String, machineName As String) As Boolean" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; static bool SourceExists(System::String ^ source, System::String ^ machineName);" />
      <MemberSignature Language="F#" Value="static member SourceExists : string * string -&gt; bool" Usage="System.Diagnostics.EventLog.SourceExists (source, machineName)" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System</AssemblyName>
        <AssemblyVersion>1.0.5000.0</AssemblyVersion>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Attributes>
        <Attribute FrameworkAlternate="xamarinmac-3.0">
          <AttributeName>System.MonoNotSupported("remote machine is not supported")</AttributeName>
        </Attribute>
        <Attribute FrameworkAlternate="netframework-4.0">
          <AttributeName>System.Runtime.TargetedPatchingOptOut("Performance critical to inline this type of method across NGen image boundaries")</AttributeName>
        </Attribute>
      </Attributes>
      <ReturnValue>
        <ReturnType>System.Boolean</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="source" Type="System.String" />
        <Parameter Name="machineName" Type="System.String" />
      </Parameters>
      <Docs>
        <param name="source">
          <span data-ttu-id="db667-998">事件源的名称。</span>
          <span class="sxs-lookup">
            <span data-stu-id="db667-998">The name of the event source.</span>
          </span>
        </param>
        <param name="machineName">
          <span data-ttu-id="db667-999">在其上查看的计算机的名称，对于本地计算机则为“.”。</span>
          <span class="sxs-lookup">
            <span data-stu-id="db667-999">The name the computer on which to look, or "." for the local computer.</span>
          </span>
        </param>
        <summary>
          <span data-ttu-id="db667-1000">确定事件源是否已在指定的计算机上注册。</span>
          <span class="sxs-lookup">
            <span data-stu-id="db667-1000">Determines whether an event source is registered on a specified computer.</span>
          </span>
        </summary>
        <returns>
          <span data-ttu-id="db667-1001">如果事件源已在给定计算机上注册，则为 <see langword="true" />；否则为 <see langword="false" />。</span>
          <span class="sxs-lookup">
            <span data-stu-id="db667-1001">
              <see langword="true" /> if the event source is registered on the given computer; otherwise, <see langword="false" />.</span>
          </span>
        </returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="db667-1002">此方法用于确定指定的计算机上是否存在的事件源`machineName`参数。</span><span class="sxs-lookup"><span data-stu-id="db667-1002">Use this method to determine whether an event source exists on the computer specified by the `machineName` parameter.</span></span> <span data-ttu-id="db667-1003">如果你想要确定使用指定的计算机上是否存在日志<xref:System.Diagnostics.EventLog.Exists%2A>。</span><span class="sxs-lookup"><span data-stu-id="db667-1003">If you want to determine whether a log exists on the specified computer, use <xref:System.Diagnostics.EventLog.Exists%2A>.</span></span>  
  
 <span data-ttu-id="db667-1004">由于此方法访问注册表，必须在给定的服务器; 上具有相应的注册表权限否则为<xref:System.Security.SecurityException>将引发。</span><span class="sxs-lookup"><span data-stu-id="db667-1004">Because this method accesses the registry, you must have the appropriate registry permissions on the given server; otherwise, a <xref:System.Security.SecurityException> will be thrown.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="db667-1005">若要搜索的事件源在 Windows Vista 及更高版本或 Windows Server 2003，必须具有管理权限。</span><span class="sxs-lookup"><span data-stu-id="db667-1005">To search for an event source in Windows Vista and later or Windows Server 2003, you must have administrative privileges.</span></span>  
>   
>  <span data-ttu-id="db667-1006">这一要求的原因是必须搜索所有事件日志，包括安全性，以确定事件源是否唯一。</span><span class="sxs-lookup"><span data-stu-id="db667-1006">The reason for this requirement is that all event logs, including security, must be searched to determine whether the event source is unique.</span></span> <span data-ttu-id="db667-1007">从 Windows Vista 开始，用户没有权限访问该安全日志。因此，<xref:System.Security.SecurityException>引发。</span><span class="sxs-lookup"><span data-stu-id="db667-1007">Starting with Windows Vista, users do not have permission to access the security log; therefore, a <xref:System.Security.SecurityException> is thrown.</span></span>  
>   
>  <span data-ttu-id="db667-1008">从 Windows Vista 开始，用户帐户控制 (UAC) 决定用户的特权。</span><span class="sxs-lookup"><span data-stu-id="db667-1008">Starting with Windows Vista, User Account Control (UAC) determines the privileges of a user.</span></span> <span data-ttu-id="db667-1009">如果您是内置的 Administrators 组的成员，将为您分配两个运行时访问令牌：一个标准用户访问令牌和一个管理员访问令牌。</span><span class="sxs-lookup"><span data-stu-id="db667-1009">If you are a member of the Built-in Administrators group, you are assigned two run-time access tokens: a standard user access token and an administrator access token.</span></span> <span data-ttu-id="db667-1010">默认情况下，您拥有标准用户角色。</span><span class="sxs-lookup"><span data-stu-id="db667-1010">By default, you are in the standard user role.</span></span> <span data-ttu-id="db667-1011">若要执行访问性能计数器的代码，首先必须将你的特权从标准用户提升至管理员。</span><span class="sxs-lookup"><span data-stu-id="db667-1011">To execute the code that accesses performance counters, you must first elevate your privileges from standard user to administrator.</span></span> <span data-ttu-id="db667-1012">你可以通过以下方式执行此操作：右键单击应用程序图标并指示需以管理员身份运行。</span><span class="sxs-lookup"><span data-stu-id="db667-1012">You can do this when you start an application by right-clicking the application icon and indicating that you want to run as an administrator.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="db667-1013">执行时使用的服务<xref:System.ServiceProcess.ServiceAccount.LocalSystem>帐户没有执行此方法所需的权限。</span><span class="sxs-lookup"><span data-stu-id="db667-1013">A service that is executing under the <xref:System.ServiceProcess.ServiceAccount.LocalSystem> account does not have the privileges required to execute this method.</span></span> <span data-ttu-id="db667-1014">解决方法是检查中是否存在事件源<xref:System.ServiceProcess.ServiceInstaller>，并且如果它不存在，在安装程序中创建源。</span><span class="sxs-lookup"><span data-stu-id="db667-1014">The solution is to check whether the event source exists in the <xref:System.ServiceProcess.ServiceInstaller>, and if it does not exist, to create the source in the installer.</span></span>  
  
 <span data-ttu-id="db667-1015">由于不能为新的源提供的同一台计算机上的现有源名称，使用此方法尝试之前调用<xref:System.Diagnostics.EventLog.CreateEventSource%2A>，确保源与指定的名称`source`的计算机上尚不存在。</span><span class="sxs-lookup"><span data-stu-id="db667-1015">Because you cannot give a new source the name of an existing source on the same computer, use this method before attempting to call <xref:System.Diagnostics.EventLog.CreateEventSource%2A> to ensure that a source with the name specified by `source` does not already exist on the computer.</span></span> <span data-ttu-id="db667-1016">`source`和`machineName`参数都不区分大小写。</span><span class="sxs-lookup"><span data-stu-id="db667-1016">The `source` and `machineName` parameters are not case sensitive.</span></span>  
  
 <span data-ttu-id="db667-1017"><xref:System.Diagnostics.EventLog.SourceExists%2A> 是`static`方法，使其可以调用类本身上。</span><span class="sxs-lookup"><span data-stu-id="db667-1017"><xref:System.Diagnostics.EventLog.SourceExists%2A> is a `static` method, so it can be called on the class itself.</span></span> <span data-ttu-id="db667-1018">不需要创建的实例<xref:System.Diagnostics.EventLog>调用<xref:System.Diagnostics.EventLog.SourceExists%2A>。</span><span class="sxs-lookup"><span data-stu-id="db667-1018">It is not necessary to create an instance of <xref:System.Diagnostics.EventLog> to call <xref:System.Diagnostics.EventLog.SourceExists%2A>.</span></span>  
  
   
  
## Examples  
 <span data-ttu-id="db667-1019">下面的示例创建源`MySource`的计算机上`MyServer`，并将条目写入到事件日志`MyNewLog`。</span><span class="sxs-lookup"><span data-stu-id="db667-1019">The following example creates the source `MySource` on the computer `MyServer`, and writes an entry to the event log `MyNewLog`.</span></span>  
  
 [!code-cpp[Classic EventLog.SourceExists1 Example#1](~/samples/snippets/cpp/VS_Snippets_CLR_Classic/classic EventLog.SourceExists1 Example/CPP/source.cpp#1)]
 [!code-csharp[Classic EventLog.SourceExists1 Example#1](~/samples/snippets/csharp/VS_Snippets_CLR_Classic/classic EventLog.SourceExists1 Example/CS/source.cs#1)]
 [!code-vb[Classic EventLog.SourceExists1 Example#1](~/samples/snippets/visualbasic/VS_Snippets_CLR_Classic/classic EventLog.SourceExists1 Example/VB/source.vb#1)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentException">
          <span data-ttu-id="db667-1020">
            <paramref name="machineName" /> 是无效的计算机名称。</span>
          <span class="sxs-lookup">
            <span data-stu-id="db667-1020">
              <paramref name="machineName" /> is an invalid computer name.</span>
          </span>
        </exception>
        <exception cref="T:System.Security.SecurityException">
          <span data-ttu-id="db667-1021">未找到 <paramref name="source" />，无法搜索部分或全部事件日志。</span>
          <span class="sxs-lookup">
            <span data-stu-id="db667-1021">
              <paramref name="source" /> was not found, but some or all of the event logs could not be searched.</span>
          </span>
        </exception>
        <permission cref="T:System.Diagnostics.EventLogPermission">
          <span data-ttu-id="db667-1022">用于写入的计算机上的事件日志信息。</span>
          <span class="sxs-lookup">
            <span data-stu-id="db667-1022">for writing the event log information on the computer.</span>
          </span>
          <span data-ttu-id="db667-1023">关联的枚举： <see cref="F:System.Diagnostics.EventLogPermissionAccess.Write" /></span>
          <span class="sxs-lookup">
            <span data-stu-id="db667-1023">Associated enumeration: <see cref="F:System.Diagnostics.EventLogPermissionAccess.Write" /></span>
          </span>
        </permission>
        <altmember cref="Overload:System.Diagnostics.EventLog.CreateEventSource" />
        <altmember cref="M:System.Diagnostics.EventLog.DeleteEventSource(System.String)" />
        <altmember cref="M:System.Diagnostics.EventLog.Exists(System.String)" />
        <altmember cref="P:System.Diagnostics.EventLog.Source" />
        <altmember cref="P:System.Diagnostics.EventLog.MachineName" />
      </Docs>
    </Member>
    <Member MemberName="SynchronizingObject">
      <MemberSignature Language="C#" Value="public System.ComponentModel.ISynchronizeInvoke SynchronizingObject { get; set; }" />
      <MemberSignature Language="ILAsm" Value=".property instance class System.ComponentModel.ISynchronizeInvoke SynchronizingObject" />
      <MemberSignature Language="DocId" Value="P:System.Diagnostics.EventLog.SynchronizingObject" />
      <MemberSignature Language="VB.NET" Value="Public Property SynchronizingObject As ISynchronizeInvoke" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; property System::ComponentModel::ISynchronizeInvoke ^ SynchronizingObject { System::ComponentModel::ISynchronizeInvoke ^ get(); void set(System::ComponentModel::ISynchronizeInvoke ^ value); };" />
      <MemberSignature Language="F#" Value="member this.SynchronizingObject : System.ComponentModel.ISynchronizeInvoke with get, set" Usage="System.Diagnostics.EventLog.SynchronizingObject" />
      <MemberType>Property</MemberType>
      <AssemblyInfo>
        <AssemblyName>System</AssemblyName>
        <AssemblyVersion>1.0.5000.0</AssemblyVersion>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Attributes>
        <Attribute FrameworkAlternate="netframework-1.1;netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;xamarinmac-3.0">
          <AttributeName>System.ComponentModel.Browsable(false)</AttributeName>
        </Attribute>
        <Attribute FrameworkAlternate="netframework-1.1;netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;xamarinmac-3.0">
          <AttributeName>System.ComponentModel.DefaultValue(null)</AttributeName>
        </Attribute>
        <Attribute FrameworkAlternate="xamarinmac-3.0">
          <AttributeName>System.Diagnostics.MonitoringDescription("An object that synchronizes event handler calls.")</AttributeName>
        </Attribute>
        <Attribute FrameworkAlternate="netframework-1.1;netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2">
          <AttributeName>System.Diagnostics.MonitoringDescription("LogSynchronizingObject")</AttributeName>
        </Attribute>
      </Attributes>
      <ReturnValue>
        <ReturnType>System.ComponentModel.ISynchronizeInvoke</ReturnType>
      </ReturnValue>
      <Docs>
        <summary>
          <span data-ttu-id="db667-1024">获取或设置用于封送事件处理程序调用的对象，该调用在有 <see cref="T:System.Diagnostics.EventLog" /> 项写入事件时发出。</span>
          <span class="sxs-lookup">
            <span data-stu-id="db667-1024">Gets or sets the object used to marshal the event handler calls issued as a result of an <see cref="T:System.Diagnostics.EventLog" /> entry written event.</span>
          </span>
        </summary>
        <value>
          <span data-ttu-id="db667-1025">
            <see cref="T:System.ComponentModel.ISynchronizeInvoke" />，用于封送由事件日志上的 <see cref="E:System.Diagnostics.EventLog.EntryWritten" /> 事件引发的事件处理程序调用。</span>
          <span class="sxs-lookup">
            <span data-stu-id="db667-1025">The <see cref="T:System.ComponentModel.ISynchronizeInvoke" /> used to marshal event-handler calls issued as a result of an <see cref="E:System.Diagnostics.EventLog.EntryWritten" /> event on the event log.</span>
          </span>
        </value>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="db667-1026">当<xref:System.Diagnostics.EventLog.SynchronizingObject%2A>是`null`，方法处理<xref:System.Diagnostics.EventLog.EntryWritten>从系统线程池线程上调用事件。</span><span class="sxs-lookup"><span data-stu-id="db667-1026">When <xref:System.Diagnostics.EventLog.SynchronizingObject%2A> is `null`, methods handling the <xref:System.Diagnostics.EventLog.EntryWritten> event are called on a thread from the system thread pool.</span></span> <span data-ttu-id="db667-1027">系统线程池的详细信息，请参阅<xref:System.Threading.ThreadPool>。</span><span class="sxs-lookup"><span data-stu-id="db667-1027">For more information on system thread pools, see <xref:System.Threading.ThreadPool>.</span></span>  
  
 <span data-ttu-id="db667-1028">当<xref:System.Diagnostics.EventLog.EntryWritten>事件由 visual Windows 窗体组件，如按钮，通过系统线程池访问组件可能无法工作，或可能会导致异常处理。</span><span class="sxs-lookup"><span data-stu-id="db667-1028">When the <xref:System.Diagnostics.EventLog.EntryWritten> event is handled by a visual Windows Forms component, such as a button, accessing the component through the system thread pool might not work, or might result in an exception.</span></span> <span data-ttu-id="db667-1029">通过设置来避免这<xref:System.Diagnostics.EventLog.SynchronizingObject%2A>到 Windows 窗体组件时，这将导致处理的方法<xref:System.Diagnostics.EventLog.EntryWritten>在其创建该组件在同一线程上调用的事件。</span><span class="sxs-lookup"><span data-stu-id="db667-1029">Avoid this by setting <xref:System.Diagnostics.EventLog.SynchronizingObject%2A> to a Windows Forms component, which causes the methods handling the <xref:System.Diagnostics.EventLog.EntryWritten> event to be called on the same thread on which the component was created.</span></span>  
  
 <span data-ttu-id="db667-1030">如果<xref:System.Diagnostics.EventLog>内部使用[!INCLUDE[vsprvslong](~/includes/vsprvslong-md.md)]在 Windows 窗体设计器中，<xref:System.Diagnostics.EventLog.SynchronizingObject%2A>自动设置为控件包含<xref:System.Diagnostics.EventLog>。</span><span class="sxs-lookup"><span data-stu-id="db667-1030">If the <xref:System.Diagnostics.EventLog> is used inside [!INCLUDE[vsprvslong](~/includes/vsprvslong-md.md)] in a Windows Forms designer, <xref:System.Diagnostics.EventLog.SynchronizingObject%2A> is automatically set to the control containing the <xref:System.Diagnostics.EventLog>.</span></span> <span data-ttu-id="db667-1031">例如，如果将置于<xref:System.Diagnostics.EventLog>Form1 的设计器上 (派生自<xref:System.Windows.Forms.Form>)<xref:System.Diagnostics.EventLog.SynchronizingObject%2A>属性的<xref:System.Diagnostics.EventLog>设置为 Form1 的实例。</span><span class="sxs-lookup"><span data-stu-id="db667-1031">For example, if you place an <xref:System.Diagnostics.EventLog> on a designer for Form1 (which inherits from <xref:System.Windows.Forms.Form>) the <xref:System.Diagnostics.EventLog.SynchronizingObject%2A> property of <xref:System.Diagnostics.EventLog> is set to the instance of Form1.</span></span>  
  
 ]]></format>
        </remarks>
        <permission cref="T:System.Diagnostics.EventLogPermission">
          <span data-ttu-id="db667-1032">用于写入的计算机上的事件日志信息。</span>
          <span class="sxs-lookup">
            <span data-stu-id="db667-1032">for writing the event log information on the computer.</span>
          </span>
          <span data-ttu-id="db667-1033">关联的枚举： <see cref="F:System.Diagnostics.EventLogPermissionAccess.Write" /></span>
          <span class="sxs-lookup">
            <span data-stu-id="db667-1033">Associated enumeration: <see cref="F:System.Diagnostics.EventLogPermissionAccess.Write" /></span>
          </span>
        </permission>
        <altmember cref="E:System.Diagnostics.EventLog.EntryWritten" />
        <altmember cref="T:System.Threading.ThreadPool" />
      </Docs>
    </Member>
    <MemberGroup MemberName="WriteEntry">
      <AssemblyInfo>
        <AssemblyName>System</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Docs>
        <summary>
          <span data-ttu-id="db667-1034">将项写入事件日志。</span>
          <span class="sxs-lookup">
            <span data-stu-id="db667-1034">Writes an entry in the event log.</span>
          </span>
        </summary>
      </Docs>
    </MemberGroup>
    <Member MemberName="WriteEntry">
      <MemberSignature Language="C#" Value="public void WriteEntry (string message);" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig instance void WriteEntry(string message) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Diagnostics.EventLog.WriteEntry(System.String)" />
      <MemberSignature Language="VB.NET" Value="Public Sub WriteEntry (message As String)" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; void WriteEntry(System::String ^ message);" />
      <MemberSignature Language="F#" Value="member this.WriteEntry : string -&gt; unit" Usage="eventLog.WriteEntry message" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System</AssemblyName>
        <AssemblyVersion>1.0.5000.0</AssemblyVersion>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Attributes>
        <Attribute FrameworkAlternate="netframework-4.0">
          <AttributeName>System.Runtime.TargetedPatchingOptOut("Performance critical to inline this type of method across NGen image boundaries")</AttributeName>
        </Attribute>
      </Attributes>
      <ReturnValue>
        <ReturnType>System.Void</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="message" Type="System.String" />
      </Parameters>
      <Docs>
        <param name="message">
          <span data-ttu-id="db667-1035">要写入事件日志的字符串。</span>
          <span class="sxs-lookup">
            <span data-stu-id="db667-1035">The string to write to the event log.</span>
          </span>
        </param>
        <summary>
          <span data-ttu-id="db667-1036">将信息类型项与给定的消息文本一起写入事件日志。</span>
          <span class="sxs-lookup">
            <span data-stu-id="db667-1036">Writes an information type entry, with the given message text, to the event log.</span>
          </span>
        </summary>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="db667-1037">此方法用于向与此关联的事件日志写入信息条目<xref:System.Diagnostics.EventLog>实例。</span><span class="sxs-lookup"><span data-stu-id="db667-1037">Use this method to write an information entry to the event log associated with this <xref:System.Diagnostics.EventLog> instance.</span></span> <span data-ttu-id="db667-1038">如果你想要指定任何其他<xref:System.Diagnostics.EventLogEntryType>，使用的不同重载<xref:System.Diagnostics.EventLog.WriteEntry%2A>。</span><span class="sxs-lookup"><span data-stu-id="db667-1038">If you want to specify any other <xref:System.Diagnostics.EventLogEntryType>, use a different overload of <xref:System.Diagnostics.EventLog.WriteEntry%2A>.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="db667-1039">`message`字符串不能包含 %*n*，其中*n*是一个整数值 (例如，%1)，因为事件查看器将其视为插入字符串。</span><span class="sxs-lookup"><span data-stu-id="db667-1039">The `message` string cannot contain %*n*, where *n* is an integer value (for example, %1), because the event viewer treats it as an insertion string.</span></span> <span data-ttu-id="db667-1040">Internet 协议版本 6 (IPv6) 地址可以包含此字符序列，因为无法记录事件消息包含 IPv6 地址。</span><span class="sxs-lookup"><span data-stu-id="db667-1040">Because an Internet Protocol, version 6 (IPv6) address can contain this character sequence, you cannot log an event message that contains an IPv6 address.</span></span>  
  
 <span data-ttu-id="db667-1041">必须设置<xref:System.Diagnostics.EventLog.Source%2A>上的属性在<xref:System.Diagnostics.EventLog>组件之前可以向日志写入条目。</span><span class="sxs-lookup"><span data-stu-id="db667-1041">You must set the <xref:System.Diagnostics.EventLog.Source%2A> property on your <xref:System.Diagnostics.EventLog> component before you can write entries to the log.</span></span> <span data-ttu-id="db667-1042">必须创建并写入与源的第一项之前配置的事件源。</span><span class="sxs-lookup"><span data-stu-id="db667-1042">You must create and configure the event source before writing the first entry with the source.</span></span>  
  
 <span data-ttu-id="db667-1043">在应用程序的安装过程中创建新的事件源。</span><span class="sxs-lookup"><span data-stu-id="db667-1043">Create the new event source during the installation of your application.</span></span> <span data-ttu-id="db667-1044">这允许操作系统以刷新其注册的事件源的列表和其配置的时间。</span><span class="sxs-lookup"><span data-stu-id="db667-1044">This allows time for the operating system to refresh its list of registered event sources and their configuration.</span></span> <span data-ttu-id="db667-1045">如果操作系统没有刷新其事件源的列表，并且尝试写入新的源的事件写入操作将失败。</span><span class="sxs-lookup"><span data-stu-id="db667-1045">If the operating system has not refreshed its list of event sources, and you attempt to write an event with the new source, the write operation will fail.</span></span> <span data-ttu-id="db667-1046">可以配置新的源使用<xref:System.Diagnostics.EventLogInstaller>，或使用<xref:System.Diagnostics.EventLog.CreateEventSource%2A>方法。</span><span class="sxs-lookup"><span data-stu-id="db667-1046">You can configure a new source using an <xref:System.Diagnostics.EventLogInstaller>, or using the <xref:System.Diagnostics.EventLog.CreateEventSource%2A> method.</span></span> <span data-ttu-id="db667-1047">若要创建新的事件源的计算机上，必须具有管理权限。</span><span class="sxs-lookup"><span data-stu-id="db667-1047">You must have administrative rights on the computer to create a new event source.</span></span>  
  
 <span data-ttu-id="db667-1048">如果在指定的源<xref:System.Diagnostics.EventLog.Source%2A>属性的这<xref:System.Diagnostics.EventLog>写入你的组件，在计算机上不注册实例<xref:System.Diagnostics.EventLog.WriteEntry%2A>调用<xref:System.Diagnostics.EventLog.CreateEventSource%2A>和注册源。</span><span class="sxs-lookup"><span data-stu-id="db667-1048">If the source specified in the <xref:System.Diagnostics.EventLog.Source%2A> property of this <xref:System.Diagnostics.EventLog> instance is not registered on the computer that your component is writing to, <xref:System.Diagnostics.EventLog.WriteEntry%2A> calls <xref:System.Diagnostics.EventLog.CreateEventSource%2A> and registers the source.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="db667-1049">如果未指定<xref:System.Diagnostics.EventLog.MachineName%2A>为你<xref:System.Diagnostics.EventLog>实例在调用之前<xref:System.Diagnostics.EventLog.CreateEventSource%2A>或<xref:System.Diagnostics.EventLog.WriteEntry%2A>，本地计算机 ("。") 假定。</span><span class="sxs-lookup"><span data-stu-id="db667-1049">If you do not specify a <xref:System.Diagnostics.EventLog.MachineName%2A> for your <xref:System.Diagnostics.EventLog> instance before you call <xref:System.Diagnostics.EventLog.CreateEventSource%2A> or <xref:System.Diagnostics.EventLog.WriteEntry%2A>, the local computer (".") is assumed.</span></span>  
  
 <span data-ttu-id="db667-1050">如果系统需要注册<xref:System.Diagnostics.EventLog.Source%2A>通过调用<xref:System.Diagnostics.EventLog.WriteEntry%2A>并<xref:System.Diagnostics.EventLog.Log%2A>不上设置属性在<xref:System.Diagnostics.EventLog>实例，默认为应用程序日志的日志。</span><span class="sxs-lookup"><span data-stu-id="db667-1050">If the system needs to register the <xref:System.Diagnostics.EventLog.Source%2A> through a call to <xref:System.Diagnostics.EventLog.WriteEntry%2A> and the <xref:System.Diagnostics.EventLog.Log%2A> property has not been set on your <xref:System.Diagnostics.EventLog> instance, the log defaults to the Application log.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="db667-1051">上面列出的异常的许多都由错误的注册过程中引发<xref:System.Diagnostics.EventLog.Source%2A>。</span><span class="sxs-lookup"><span data-stu-id="db667-1051">Many of the exceptions listed above are generated by errors raised during the process of registering the <xref:System.Diagnostics.EventLog.Source%2A>.</span></span>  
  
 <span data-ttu-id="db667-1052">要写入本地化的项还是要直接写入字符串，必须配置源。</span><span class="sxs-lookup"><span data-stu-id="db667-1052">The source must be configured either for writing localized entries or for writing direct strings.</span></span> <span data-ttu-id="db667-1053"><xref:System.Diagnostics.EventLog.WriteEntry%2A>方法直接写入事件日志写入给定的字符串; 它不使用可本地化的消息资源文件。</span><span class="sxs-lookup"><span data-stu-id="db667-1053">The <xref:System.Diagnostics.EventLog.WriteEntry%2A> method writes the given string directly to the event log; it does not use a localizable message resource file.</span></span> <span data-ttu-id="db667-1054">使用<xref:System.Diagnostics.EventLog.WriteEvent%2A>方法来写入事件时使用的本地化的消息资源文件。</span><span class="sxs-lookup"><span data-stu-id="db667-1054">Use the <xref:System.Diagnostics.EventLog.WriteEvent%2A> method to write events using a localized message resource file.</span></span>  
  
 <span data-ttu-id="db667-1055">如果你的应用程序将使用资源标识符和字符串值的条目写入，则必须注册两个单独的源。</span><span class="sxs-lookup"><span data-stu-id="db667-1055">If your application writes entries using both resource identifiers and string values, you must register two separate sources.</span></span> <span data-ttu-id="db667-1056">例如，配置一个源的资源文件，以及如何将该源中的<xref:System.Diagnostics.EventLog.WriteEvent%2A>方法来编写使用资源标识符添加到事件日志条目。</span><span class="sxs-lookup"><span data-stu-id="db667-1056">For example, configure one source with resource files, and then use that source in the <xref:System.Diagnostics.EventLog.WriteEvent%2A> method to write entries using resource identifiers to the event log.</span></span> <span data-ttu-id="db667-1057">然后创建不同的源，而无需资源文件，并使用在该源<xref:System.Diagnostics.EventLog.WriteEntry%2A>方法将字符串直接写入事件日志使用的源。</span><span class="sxs-lookup"><span data-stu-id="db667-1057">Then create a different source without resource files, and use that source in the <xref:System.Diagnostics.EventLog.WriteEntry%2A> method to write strings directly to the event log using that source.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="db667-1058">如果远程计算机中写入一个条目，消息 （文本字符串） 的值可能不是预期如果远程计算机未运行.NET Framework。</span><span class="sxs-lookup"><span data-stu-id="db667-1058">If you write an entry to a remote computer, the value of the message (the text string) might not be what you expect if the remote computer is not running the .NET Framework.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="db667-1059">如果`message`参数包含 NUL 字符，则在 NUL 字符处终止事件日志中的消息。</span><span class="sxs-lookup"><span data-stu-id="db667-1059">If the `message` parameter contains a NUL character, the message in the event log is terminated at the NUL character.</span></span>  
  
   
  
## Examples  
 <span data-ttu-id="db667-1060">下面的示例创建源`MySource`如果它尚不存在，并将条目写入到事件日志`MyNewLog`。</span><span class="sxs-lookup"><span data-stu-id="db667-1060">The following example creates the source `MySource` if it does not already exist, and writes an entry to the event log `MyNewLog`.</span></span>  
  
 [!code-cpp[Classic EventLog.CreateEventSource Example#1](~/samples/snippets/cpp/VS_Snippets_CLR_Classic/classic EventLog.CreateEventSource Example/CPP/source.cpp#1)]
 [!code-csharp[Classic EventLog.CreateEventSource Example#1](~/samples/snippets/csharp/VS_Snippets_CLR_Classic/classic EventLog.CreateEventSource Example/CS/source.cs#1)]
 [!code-vb[Classic EventLog.CreateEventSource Example#1](~/samples/snippets/visualbasic/VS_Snippets_CLR_Classic/classic EventLog.CreateEventSource Example/VB/source.vb#1)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentException">
          <span data-ttu-id="db667-1061">
            <see cref="P:System.Diagnostics.EventLog.Source" /> 的 <see cref="T:System.Diagnostics.EventLog" /> 属性尚未设置。</span>
          <span class="sxs-lookup">
            <span data-stu-id="db667-1061">The <see cref="P:System.Diagnostics.EventLog.Source" /> property of the <see cref="T:System.Diagnostics.EventLog" /> has not been set.</span>
          </span>
          <span data-ttu-id="db667-1062">或</span>
          <span class="sxs-lookup">
            <span data-stu-id="db667-1062">-or-</span>
          </span>
          <span data-ttu-id="db667-1063">该方法尝试注册新的事件源，但 <see cref="P:System.Diagnostics.EventLog.MachineName" /> 中的计算机名称无效。</span>
          <span class="sxs-lookup">
            <span data-stu-id="db667-1063">The method attempted to register a new event source, but the computer name in <see cref="P:System.Diagnostics.EventLog.MachineName" /> is not valid.</span>
          </span>
          <span data-ttu-id="db667-1064">\- 或 -</span>
          <span class="sxs-lookup">
            <span data-stu-id="db667-1064">\- or -</span>
          </span>
          <span data-ttu-id="db667-1065">已为其他事件日志注册了该源。</span>
          <span class="sxs-lookup">
            <span data-stu-id="db667-1065">The source is already registered for a different event log.</span>
          </span>
          <span data-ttu-id="db667-1066">\- 或 -</span>
          <span class="sxs-lookup">
            <span data-stu-id="db667-1066">\- or -</span>
          </span>
          <span data-ttu-id="db667-1067">消息字符串长于 31,839 字节（在 Windows Vista 之前，在 Windows 操作系统上为 32,766 字节)。</span>
          <span class="sxs-lookup">
            <span data-stu-id="db667-1067">The message string is longer than 31,839 bytes (32,766 bytes on Windows operating systems before Windows Vista).</span>
          </span>
          <span data-ttu-id="db667-1068">\- 或 -</span>
          <span class="sxs-lookup">
            <span data-stu-id="db667-1068">\- or -</span>
          </span>
          <span data-ttu-id="db667-1069">此源名称导致注册表项路径的长度超过 254 个字符。</span>
          <span class="sxs-lookup">
            <span data-stu-id="db667-1069">The source name results in a registry key path longer than 254 characters.</span>
          </span>
        </exception>
        <exception cref="T:System.InvalidOperationException">
          <span data-ttu-id="db667-1070">事件日志的注册表项未能打开。</span>
          <span class="sxs-lookup">
            <span data-stu-id="db667-1070">The registry key for the event log could not be opened.</span>
          </span>
        </exception>
        <exception cref="T:System.ComponentModel.Win32Exception">
          <span data-ttu-id="db667-1071">将事件项写入事件日志时，操作系统报告了一个错误。</span>
          <span class="sxs-lookup">
            <span data-stu-id="db667-1071">The operating system reported an error when writing the event entry to the event log.</span>
          </span>
          <span data-ttu-id="db667-1072">一个 Windows 错误代码不可用。</span>
          <span class="sxs-lookup">
            <span data-stu-id="db667-1072">A Windows error code is not available.</span>
          </span>
        </exception>
        <permission cref="T:System.Diagnostics.EventLogPermission">
          <span data-ttu-id="db667-1073">用于写入的计算机上的事件日志信息。</span>
          <span class="sxs-lookup">
            <span data-stu-id="db667-1073">for writing the event log information on the computer.</span>
          </span>
          <span data-ttu-id="db667-1074">关联的枚举： <see cref="F:System.Diagnostics.EventLogPermissionAccess.Write" /></span>
          <span class="sxs-lookup">
            <span data-stu-id="db667-1074">Associated enumeration: <see cref="F:System.Diagnostics.EventLogPermissionAccess.Write" /></span>
          </span>
        </permission>
        <altmember cref="P:System.Diagnostics.EventLog.Source" />
        <altmember cref="Overload:System.Diagnostics.EventLog.CreateEventSource" />
        <altmember cref="M:System.Diagnostics.EventLog.DeleteEventSource(System.String)" />
        <altmember cref="M:System.Diagnostics.EventLog.SourceExists(System.String)" />
        <altmember cref="P:System.Diagnostics.EventLog.Entries" />
      </Docs>
    </Member>
    <Member MemberName="WriteEntry">
      <MemberSignature Language="C#" Value="public void WriteEntry (string message, System.Diagnostics.EventLogEntryType type);" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig instance void WriteEntry(string message, valuetype System.Diagnostics.EventLogEntryType type) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Diagnostics.EventLog.WriteEntry(System.String,System.Diagnostics.EventLogEntryType)" />
      <MemberSignature Language="VB.NET" Value="Public Sub WriteEntry (message As String, type As EventLogEntryType)" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; void WriteEntry(System::String ^ message, System::Diagnostics::EventLogEntryType type);" />
      <MemberSignature Language="F#" Value="member this.WriteEntry : string * System.Diagnostics.EventLogEntryType -&gt; unit" Usage="eventLog.WriteEntry (message, type)" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System</AssemblyName>
        <AssemblyVersion>1.0.5000.0</AssemblyVersion>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Attributes>
        <Attribute FrameworkAlternate="netframework-4.0">
          <AttributeName>System.Runtime.TargetedPatchingOptOut("Performance critical to inline this type of method across NGen image boundaries")</AttributeName>
        </Attribute>
      </Attributes>
      <ReturnValue>
        <ReturnType>System.Void</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="message" Type="System.String" />
        <Parameter Name="type" Type="System.Diagnostics.EventLogEntryType" />
      </Parameters>
      <Docs>
        <param name="message">
          <span data-ttu-id="db667-1075">要写入事件日志的字符串。</span>
          <span class="sxs-lookup">
            <span data-stu-id="db667-1075">The string to write to the event log.</span>
          </span>
        </param>
        <param name="type">
          <span data-ttu-id="db667-1076">
            <see cref="T:System.Diagnostics.EventLogEntryType" /> 值之一。</span>
          <span class="sxs-lookup">
            <span data-stu-id="db667-1076">One of the <see cref="T:System.Diagnostics.EventLogEntryType" /> values.</span>
          </span>
        </param>
        <summary>
          <span data-ttu-id="db667-1077">将错误、警告、信息、成功审核或失败审核项与给定的消息文本一起写入事件日志。</span>
          <span class="sxs-lookup">
            <span data-stu-id="db667-1077">Writes an error, warning, information, success audit, or failure audit entry with the given message text to the event log.</span>
          </span>
        </summary>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="db667-1078">使用此方法的指定项写入<xref:System.Diagnostics.EventLogEntryType>到事件日志。</span><span class="sxs-lookup"><span data-stu-id="db667-1078">Use this method to write an entry of a specified <xref:System.Diagnostics.EventLogEntryType> to the event log.</span></span> <span data-ttu-id="db667-1079">`type`由一个图标和日志的事件查看器中的类型列中的文本指示。</span><span class="sxs-lookup"><span data-stu-id="db667-1079">The `type` is indicated by an icon and text in the Type column in the Event Viewer for a log.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="db667-1080">`message`字符串不能包含 %*n*，其中*n*是一个整数值 (例如，%1)，因为事件查看器将其视为插入字符串。</span><span class="sxs-lookup"><span data-stu-id="db667-1080">The `message` string cannot contain %*n*, where *n* is an integer value (for example, %1), because the event viewer treats it as an insertion string.</span></span> <span data-ttu-id="db667-1081">Internet 协议版本 6 (IPv6) 地址可以包含此字符序列，因为无法记录事件消息包含 IPv6 地址。</span><span class="sxs-lookup"><span data-stu-id="db667-1081">Because an Internet Protocol, version 6 (IPv6) address can contain this character sequence, you cannot log an event message that contains an IPv6 address.</span></span>  
  
 <span data-ttu-id="db667-1082">必须设置<xref:System.Diagnostics.EventLog.Source%2A>上的属性在<xref:System.Diagnostics.EventLog>组件之前可以向日志写入条目。</span><span class="sxs-lookup"><span data-stu-id="db667-1082">You must set the <xref:System.Diagnostics.EventLog.Source%2A> property on your <xref:System.Diagnostics.EventLog> component before you can write entries to the log.</span></span> <span data-ttu-id="db667-1083">必须创建并写入与源的第一项之前配置的事件源。</span><span class="sxs-lookup"><span data-stu-id="db667-1083">You must create and configure the event source before writing the first entry with the source.</span></span>  
  
 <span data-ttu-id="db667-1084">在应用程序的安装过程中创建新的事件源。</span><span class="sxs-lookup"><span data-stu-id="db667-1084">Create the new event source during the installation of your application.</span></span> <span data-ttu-id="db667-1085">这允许操作系统以刷新其注册的事件源的列表和其配置的时间。</span><span class="sxs-lookup"><span data-stu-id="db667-1085">This allows time for the operating system to refresh its list of registered event sources and their configuration.</span></span> <span data-ttu-id="db667-1086">如果操作系统没有刷新其事件源的列表，并且尝试写入新的源的事件写入操作将失败。</span><span class="sxs-lookup"><span data-stu-id="db667-1086">If the operating system has not refreshed its list of event sources, and you attempt to write an event with the new source, the write operation will fail.</span></span> <span data-ttu-id="db667-1087">可以配置新的源使用<xref:System.Diagnostics.EventLogInstaller>，或使用<xref:System.Diagnostics.EventLog.CreateEventSource%2A>方法。</span><span class="sxs-lookup"><span data-stu-id="db667-1087">You can configure a new source using an <xref:System.Diagnostics.EventLogInstaller>, or using the <xref:System.Diagnostics.EventLog.CreateEventSource%2A> method.</span></span> <span data-ttu-id="db667-1088">若要创建新的事件源的计算机上，必须具有管理权限。</span><span class="sxs-lookup"><span data-stu-id="db667-1088">You must have administrative rights on the computer to create a new event source.</span></span>  
  
 <span data-ttu-id="db667-1089">如果在指定的源<xref:System.Diagnostics.EventLog.Source%2A>属性的这<xref:System.Diagnostics.EventLog>写入你的组件，在计算机上不注册实例<xref:System.Diagnostics.EventLog.WriteEntry%2A>调用<xref:System.Diagnostics.EventLog.CreateEventSource%2A>和注册源。</span><span class="sxs-lookup"><span data-stu-id="db667-1089">If the source specified in the <xref:System.Diagnostics.EventLog.Source%2A> property of this <xref:System.Diagnostics.EventLog> instance is not registered on the computer that your component is writing to, <xref:System.Diagnostics.EventLog.WriteEntry%2A> calls <xref:System.Diagnostics.EventLog.CreateEventSource%2A> and registers the source.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="db667-1090">如果未指定<xref:System.Diagnostics.EventLog.MachineName%2A>为你<xref:System.Diagnostics.EventLog>实例在调用之前<xref:System.Diagnostics.EventLog.CreateEventSource%2A>或<xref:System.Diagnostics.EventLog.WriteEntry%2A>，本地计算机 ("。") 假定。</span><span class="sxs-lookup"><span data-stu-id="db667-1090">If you do not specify a <xref:System.Diagnostics.EventLog.MachineName%2A> for your <xref:System.Diagnostics.EventLog> instance before you call <xref:System.Diagnostics.EventLog.CreateEventSource%2A> or <xref:System.Diagnostics.EventLog.WriteEntry%2A>, the local computer (".") is assumed.</span></span>  
  
 <span data-ttu-id="db667-1091">如果系统需要注册<xref:System.Diagnostics.EventLog.Source%2A>通过调用<xref:System.Diagnostics.EventLog.WriteEntry%2A>并<xref:System.Diagnostics.EventLog.Log%2A>不上设置属性在<xref:System.Diagnostics.EventLog>实例，默认为应用程序日志的日志。</span><span class="sxs-lookup"><span data-stu-id="db667-1091">If the system needs to register the <xref:System.Diagnostics.EventLog.Source%2A> through a call to <xref:System.Diagnostics.EventLog.WriteEntry%2A> and the <xref:System.Diagnostics.EventLog.Log%2A> property has not been set on your <xref:System.Diagnostics.EventLog> instance, the log defaults to the Application log.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="db667-1092">上面列出的许多异常都由错误的注册过程中引发<xref:System.Diagnostics.EventLog.Source%2A>。</span><span class="sxs-lookup"><span data-stu-id="db667-1092">Many exceptions listed above are generated by errors raised during the process of registering the <xref:System.Diagnostics.EventLog.Source%2A>.</span></span>  
  
 <span data-ttu-id="db667-1093">要写入本地化的项还是要直接写入字符串，必须配置源。</span><span class="sxs-lookup"><span data-stu-id="db667-1093">The source must be configured either for writing localized entries or for writing direct strings.</span></span> <span data-ttu-id="db667-1094"><xref:System.Diagnostics.EventLog.WriteEntry%2A>方法直接写入事件日志写入给定的字符串; 它不使用可本地化的消息资源文件。</span><span class="sxs-lookup"><span data-stu-id="db667-1094">The <xref:System.Diagnostics.EventLog.WriteEntry%2A> method writes the given string directly to the event log; it does not use a localizable message resource file.</span></span> <span data-ttu-id="db667-1095">使用<xref:System.Diagnostics.EventLog.WriteEvent%2A>方法来写入事件时使用的本地化的消息资源文件。</span><span class="sxs-lookup"><span data-stu-id="db667-1095">Use the <xref:System.Diagnostics.EventLog.WriteEvent%2A> method to write events using a localized message resource file.</span></span>  
  
 <span data-ttu-id="db667-1096">如果你的应用程序将使用资源标识符和字符串值的条目写入，则必须注册两个单独的源。</span><span class="sxs-lookup"><span data-stu-id="db667-1096">If your application writes entries using both resource identifiers and string values, you must register two separate sources.</span></span> <span data-ttu-id="db667-1097">例如，配置一个源的资源文件，以及如何将该源中的<xref:System.Diagnostics.EventLog.WriteEvent%2A>方法来编写使用资源标识符添加到事件日志条目。</span><span class="sxs-lookup"><span data-stu-id="db667-1097">For example, configure one source with resource files, and then use that source in the <xref:System.Diagnostics.EventLog.WriteEvent%2A> method to write entries using resource identifiers to the event log.</span></span> <span data-ttu-id="db667-1098">然后创建不同的源，而无需资源文件，并使用在该源<xref:System.Diagnostics.EventLog.WriteEntry%2A>方法将字符串直接写入事件日志使用的源。</span><span class="sxs-lookup"><span data-stu-id="db667-1098">Then create a different source without resource files, and use that source in the <xref:System.Diagnostics.EventLog.WriteEntry%2A> method to write strings directly to the event log using that source.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="db667-1099">如果远程计算机中写入一个条目，消息 （文本字符串） 的值可能不是预期如果远程计算机未运行.NET Framework。</span><span class="sxs-lookup"><span data-stu-id="db667-1099">If you write an entry to a remote computer, the value of the message (the text string) might not be what you expect if the remote computer is not running the .NET Framework.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="db667-1100">如果`message`参数包含 NUL 字符，则在 NUL 字符处终止事件日志中的消息。</span><span class="sxs-lookup"><span data-stu-id="db667-1100">If the `message` parameter contains a NUL character, the message in the event log is terminated at the NUL character.</span></span>  
  
   
  
## Examples  
 <span data-ttu-id="db667-1101">下面的示例警告项写入事件日志中，"MyNewLog"本地计算机上。</span><span class="sxs-lookup"><span data-stu-id="db667-1101">The following example writes a warning entry to an event log, "MyNewLog", on the local computer.</span></span>  
  
 [!code-cpp[Classic EventLog.WriteEntry2 Example#1](~/samples/snippets/cpp/VS_Snippets_CLR_Classic/classic EventLog.WriteEntry2 Example/CPP/source.cpp#1)]
 [!code-csharp[Classic EventLog.WriteEntry2 Example#1](~/samples/snippets/csharp/VS_Snippets_CLR_Classic/classic EventLog.WriteEntry2 Example/CS/source.cs#1)]
 [!code-vb[Classic EventLog.WriteEntry2 Example#1](~/samples/snippets/visualbasic/VS_Snippets_CLR_Classic/classic EventLog.WriteEntry2 Example/VB/source.vb#1)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentException">
          <span data-ttu-id="db667-1102">
            <see cref="P:System.Diagnostics.EventLog.Source" /> 的 <see cref="T:System.Diagnostics.EventLog" /> 属性尚未设置。</span>
          <span class="sxs-lookup">
            <span data-stu-id="db667-1102">The <see cref="P:System.Diagnostics.EventLog.Source" /> property of the <see cref="T:System.Diagnostics.EventLog" /> has not been set.</span>
          </span>
          <span data-ttu-id="db667-1103">或</span>
          <span class="sxs-lookup">
            <span data-stu-id="db667-1103">-or-</span>
          </span>
          <span data-ttu-id="db667-1104">该方法尝试注册新的事件源，但 <see cref="P:System.Diagnostics.EventLog.MachineName" /> 中的计算机名称无效。</span>
          <span class="sxs-lookup">
            <span data-stu-id="db667-1104">The method attempted to register a new event source, but the computer name in <see cref="P:System.Diagnostics.EventLog.MachineName" /> is not valid.</span>
          </span>
          <span data-ttu-id="db667-1105">\- 或 -</span>
          <span class="sxs-lookup">
            <span data-stu-id="db667-1105">\- or -</span>
          </span>
          <span data-ttu-id="db667-1106">已为其他事件日志注册了该源。</span>
          <span class="sxs-lookup">
            <span data-stu-id="db667-1106">The source is already registered for a different event log.</span>
          </span>
          <span data-ttu-id="db667-1107">\- 或 -</span>
          <span class="sxs-lookup">
            <span data-stu-id="db667-1107">\- or -</span>
          </span>
          <span data-ttu-id="db667-1108">消息字符串长于 31,839 字节（在 Windows Vista 之前，在 Windows 操作系统上为 32,766 字节)。</span>
          <span class="sxs-lookup">
            <span data-stu-id="db667-1108">The message string is longer than 31,839 bytes (32,766 bytes on Windows operating systems before Windows Vista).</span>
          </span>
          <span data-ttu-id="db667-1109">\- 或 -</span>
          <span class="sxs-lookup">
            <span data-stu-id="db667-1109">\- or -</span>
          </span>
          <span data-ttu-id="db667-1110">此源名称导致注册表项路径的长度超过 254 个字符。</span>
          <span class="sxs-lookup">
            <span data-stu-id="db667-1110">The source name results in a registry key path longer than 254 characters.</span>
          </span>
        </exception>
        <exception cref="T:System.ComponentModel.InvalidEnumArgumentException">
          <span data-ttu-id="db667-1111">
            <paramref name="type" /> 不是有效的 <see cref="T:System.Diagnostics.EventLogEntryType" />。</span>
          <span class="sxs-lookup">
            <span data-stu-id="db667-1111">
              <paramref name="type" /> is not a valid <see cref="T:System.Diagnostics.EventLogEntryType" />.</span>
          </span>
        </exception>
        <exception cref="T:System.InvalidOperationException">
          <span data-ttu-id="db667-1112">事件日志的注册表项未能打开。</span>
          <span class="sxs-lookup">
            <span data-stu-id="db667-1112">The registry key for the event log could not be opened.</span>
          </span>
        </exception>
        <exception cref="T:System.ComponentModel.Win32Exception">
          <span data-ttu-id="db667-1113">将事件项写入事件日志时，操作系统报告了一个错误。</span>
          <span class="sxs-lookup">
            <span data-stu-id="db667-1113">The operating system reported an error when writing the event entry to the event log.</span>
          </span>
          <span data-ttu-id="db667-1114">一个 Windows 错误代码不可用。</span>
          <span class="sxs-lookup">
            <span data-stu-id="db667-1114">A Windows error code is not available.</span>
          </span>
        </exception>
        <permission cref="T:System.Diagnostics.EventLogPermission">
          <span data-ttu-id="db667-1115">用于写入的计算机上的事件日志信息。</span>
          <span class="sxs-lookup">
            <span data-stu-id="db667-1115">for writing the event log information on the computer.</span>
          </span>
          <span data-ttu-id="db667-1116">关联的枚举： <see cref="F:System.Diagnostics.EventLogPermissionAccess.Write" /></span>
          <span class="sxs-lookup">
            <span data-stu-id="db667-1116">Associated enumeration: <see cref="F:System.Diagnostics.EventLogPermissionAccess.Write" /></span>
          </span>
        </permission>
        <altmember cref="T:System.Diagnostics.EventLogEntryType" />
        <altmember cref="P:System.Diagnostics.EventLog.Source" />
        <altmember cref="Overload:System.Diagnostics.EventLog.CreateEventSource" />
        <altmember cref="M:System.Diagnostics.EventLog.DeleteEventSource(System.String)" />
        <altmember cref="M:System.Diagnostics.EventLog.SourceExists(System.String)" />
        <altmember cref="P:System.Diagnostics.EventLog.Entries" />
      </Docs>
    </Member>
    <Member MemberName="WriteEntry">
      <MemberSignature Language="C#" Value="public static void WriteEntry (string source, string message);" />
      <MemberSignature Language="ILAsm" Value=".method public static hidebysig void WriteEntry(string source, string message) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Diagnostics.EventLog.WriteEntry(System.String,System.String)" />
      <MemberSignature Language="VB.NET" Value="Public Shared Sub WriteEntry (source As String, message As String)" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; static void WriteEntry(System::String ^ source, System::String ^ message);" />
      <MemberSignature Language="F#" Value="static member WriteEntry : string * string -&gt; unit" Usage="System.Diagnostics.EventLog.WriteEntry (source, message)" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System</AssemblyName>
        <AssemblyVersion>1.0.5000.0</AssemblyVersion>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Attributes>
        <Attribute FrameworkAlternate="netframework-4.0">
          <AttributeName>System.Runtime.TargetedPatchingOptOut("Performance critical to inline this type of method across NGen image boundaries")</AttributeName>
        </Attribute>
      </Attributes>
      <ReturnValue>
        <ReturnType>System.Void</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="source" Type="System.String" />
        <Parameter Name="message" Type="System.String" />
      </Parameters>
      <Docs>
        <param name="source">
          <span data-ttu-id="db667-1117">应用程序在指定计算机上注册时所采用的源。</span>
          <span class="sxs-lookup">
            <span data-stu-id="db667-1117">The source by which the application is registered on the specified computer.</span>
          </span>
        </param>
        <param name="message">
          <span data-ttu-id="db667-1118">要写入事件日志的字符串。</span>
          <span class="sxs-lookup">
            <span data-stu-id="db667-1118">The string to write to the event log.</span>
          </span>
        </param>
        <summary>
          <span data-ttu-id="db667-1119">使用指定的注册事件源将信息类型项与给定的消息文本一起写入事件日志。</span>
          <span class="sxs-lookup">
            <span data-stu-id="db667-1119">Writes an information type entry with the given message text to the event log, using the specified registered event source.</span>
          </span>
        </summary>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="db667-1120">此方法用于向使用已注册为相应的日志的事件源的源的事件日志写入信息条目。</span><span class="sxs-lookup"><span data-stu-id="db667-1120">Use this method to write an information entry to the event log, using a source that is already registered as an event source for the appropriate log.</span></span> <span data-ttu-id="db667-1121">如果你想要指定任何其他<xref:System.Diagnostics.EventLogEntryType>，使用的不同重载<xref:System.Diagnostics.EventLog.WriteEntry%2A>。</span><span class="sxs-lookup"><span data-stu-id="db667-1121">If you want to specify any other <xref:System.Diagnostics.EventLogEntryType>, use a different overload of <xref:System.Diagnostics.EventLog.WriteEntry%2A>.</span></span>  
  
 <span data-ttu-id="db667-1122">必须创建并写入与源的第一项之前配置的事件源。</span><span class="sxs-lookup"><span data-stu-id="db667-1122">You must create and configure the event source before writing the first entry with the source.</span></span> <span data-ttu-id="db667-1123">在应用程序的安装过程中创建新的事件源。</span><span class="sxs-lookup"><span data-stu-id="db667-1123">Create the new event source during the installation of your application.</span></span> <span data-ttu-id="db667-1124">这允许操作系统以刷新其注册的事件源的列表和其配置的时间。</span><span class="sxs-lookup"><span data-stu-id="db667-1124">This allows time for the operating system to refresh its list of registered event sources and their configuration.</span></span> <span data-ttu-id="db667-1125">如果操作系统没有刷新其事件源的列表，并且尝试写入新的源的事件写入操作将失败。</span><span class="sxs-lookup"><span data-stu-id="db667-1125">If the operating system has not refreshed its list of event sources, and you attempt to write an event with the new source, the write operation will fail.</span></span> <span data-ttu-id="db667-1126">可以配置新的源使用<xref:System.Diagnostics.EventLogInstaller>，或使用<xref:System.Diagnostics.EventLog.CreateEventSource%2A>方法。</span><span class="sxs-lookup"><span data-stu-id="db667-1126">You can configure a new source using an <xref:System.Diagnostics.EventLogInstaller>, or using the <xref:System.Diagnostics.EventLog.CreateEventSource%2A> method.</span></span> <span data-ttu-id="db667-1127">若要创建新的事件源的计算机上，必须具有管理权限。</span><span class="sxs-lookup"><span data-stu-id="db667-1127">You must have administrative rights on the computer to create a new event source.</span></span>  
  
 <span data-ttu-id="db667-1128">要写入本地化的项还是要直接写入字符串，必须配置源。</span><span class="sxs-lookup"><span data-stu-id="db667-1128">The source must be configured either for writing localized entries or for writing direct strings.</span></span> <span data-ttu-id="db667-1129"><xref:System.Diagnostics.EventLog.WriteEntry%2A>方法直接写入事件日志写入给定的字符串; 它不使用可本地化的消息资源文件。</span><span class="sxs-lookup"><span data-stu-id="db667-1129">The <xref:System.Diagnostics.EventLog.WriteEntry%2A> method writes the given string directly to the event log; it does not use a localizable message resource file.</span></span> <span data-ttu-id="db667-1130">使用<xref:System.Diagnostics.EventLog.WriteEvent%2A>方法来写入事件时使用的本地化的消息资源文件。</span><span class="sxs-lookup"><span data-stu-id="db667-1130">Use the <xref:System.Diagnostics.EventLog.WriteEvent%2A> method to write events using a localized message resource file.</span></span>  
  
 <span data-ttu-id="db667-1131">如果你的应用程序将使用资源标识符和字符串值的条目写入，则必须注册两个单独的源。</span><span class="sxs-lookup"><span data-stu-id="db667-1131">If your application writes entries using both resource identifiers and string values, you must register two separate sources.</span></span> <span data-ttu-id="db667-1132">例如，配置一个源的资源文件，以及如何将该源中的<xref:System.Diagnostics.EventLog.WriteEvent%2A>方法来编写使用资源标识符添加到事件日志条目。</span><span class="sxs-lookup"><span data-stu-id="db667-1132">For example, configure one source with resource files, and then use that source in the <xref:System.Diagnostics.EventLog.WriteEvent%2A> method to write entries using resource identifiers to the event log.</span></span> <span data-ttu-id="db667-1133">然后创建不同的源，而无需资源文件，并使用在该源<xref:System.Diagnostics.EventLog.WriteEntry%2A>方法将字符串直接写入事件日志使用的源。</span><span class="sxs-lookup"><span data-stu-id="db667-1133">Then create a different source without resource files, and use that source in the <xref:System.Diagnostics.EventLog.WriteEntry%2A> method to write strings directly to the event log using that source.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="db667-1134">如果`message`参数包含 NUL 字符，则在 NUL 字符处终止事件日志中的消息。</span><span class="sxs-lookup"><span data-stu-id="db667-1134">If the `message` parameter contains a NUL character, the message in the event log is terminated at the NUL character.</span></span>  
>   
>  <span data-ttu-id="db667-1135">`message`字符串不能包含 %*n*，其中*n*是一个整数值 (例如，%1)，因为事件查看器将其视为插入字符串。</span><span class="sxs-lookup"><span data-stu-id="db667-1135">The `message` string cannot contain %*n*, where *n* is an integer value (for example, %1), because the event viewer treats it as an insertion string.</span></span> <span data-ttu-id="db667-1136">Internet 协议版本 6 (IPv6) 地址可以包含此字符序列，因为无法记录事件消息包含 IPv6 地址。</span><span class="sxs-lookup"><span data-stu-id="db667-1136">Because an Internet Protocol, version 6 (IPv6) address can contain this character sequence, you cannot log an event message that contains an IPv6 address.</span></span>  
  
   
  
## Examples  
 <span data-ttu-id="db667-1137">下面的示例创建源`MySource`如果它尚不存在，并将条目写入到事件日志`MyNewLog`。</span><span class="sxs-lookup"><span data-stu-id="db667-1137">The following example creates the source `MySource` if it does not already exist, and writes an entry to the event log `MyNewLog`.</span></span>  
  
 [!code-cpp[Classic EventLog.WriteEntry1 Example#1](~/samples/snippets/cpp/VS_Snippets_CLR_Classic/classic EventLog.WriteEntry1 Example/CPP/source.cpp#1)]
 [!code-csharp[Classic EventLog.WriteEntry1 Example#1](~/samples/snippets/csharp/VS_Snippets_CLR_Classic/classic EventLog.WriteEntry1 Example/CS/source.cs#1)]
 [!code-vb[Classic EventLog.WriteEntry1 Example#1](~/samples/snippets/visualbasic/VS_Snippets_CLR_Classic/classic EventLog.WriteEntry1 Example/VB/source.vb#1)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentException">
          <span data-ttu-id="db667-1138">
            <paramref name="source" /> 值是空字符串 ("")。</span>
          <span class="sxs-lookup">
            <span data-stu-id="db667-1138">The <paramref name="source" /> value is an empty string ("").</span>
          </span>
          <span data-ttu-id="db667-1139">\- 或 -</span>
          <span class="sxs-lookup">
            <span data-stu-id="db667-1139">\- or -</span>
          </span>
          <span data-ttu-id="db667-1140">
            <paramref name="source" /> 值为 <see langword="null" />。</span>
          <span class="sxs-lookup">
            <span data-stu-id="db667-1140">The <paramref name="source" /> value is <see langword="null" />.</span>
          </span>
          <span data-ttu-id="db667-1141">\- 或 -</span>
          <span class="sxs-lookup">
            <span data-stu-id="db667-1141">\- or -</span>
          </span>
          <span data-ttu-id="db667-1142">消息字符串长于 31,839 字节（在 Windows Vista 之前，在 Windows 操作系统上为 32,766 字节)。</span>
          <span class="sxs-lookup">
            <span data-stu-id="db667-1142">The message string is longer than 31,839 bytes (32,766 bytes on Windows operating systems before Windows Vista).</span>
          </span>
          <span data-ttu-id="db667-1143">\- 或 -</span>
          <span class="sxs-lookup">
            <span data-stu-id="db667-1143">\- or -</span>
          </span>
          <span data-ttu-id="db667-1144">此源名称导致注册表项路径的长度超过 254 个字符。</span>
          <span class="sxs-lookup">
            <span data-stu-id="db667-1144">The source name results in a registry key path longer than 254 characters.</span>
          </span>
        </exception>
        <exception cref="T:System.InvalidOperationException">
          <span data-ttu-id="db667-1145">事件日志的注册表项未能打开。</span>
          <span class="sxs-lookup">
            <span data-stu-id="db667-1145">The registry key for the event log could not be opened.</span>
          </span>
        </exception>
        <exception cref="T:System.ComponentModel.Win32Exception">
          <span data-ttu-id="db667-1146">将事件项写入事件日志时，操作系统报告了一个错误。</span>
          <span class="sxs-lookup">
            <span data-stu-id="db667-1146">The operating system reported an error when writing the event entry to the event log.</span>
          </span>
          <span data-ttu-id="db667-1147">一个 Windows 错误代码不可用。</span>
          <span class="sxs-lookup">
            <span data-stu-id="db667-1147">A Windows error code is not available.</span>
          </span>
        </exception>
        <permission cref="T:System.Diagnostics.EventLogPermission">
          <span data-ttu-id="db667-1148">用于写入的计算机上的事件日志信息。</span>
          <span class="sxs-lookup">
            <span data-stu-id="db667-1148">for writing the event log information on the computer.</span>
          </span>
          <span data-ttu-id="db667-1149">关联的枚举： <see cref="F:System.Diagnostics.EventLogPermissionAccess.Write" /></span>
          <span class="sxs-lookup">
            <span data-stu-id="db667-1149">Associated enumeration: <see cref="F:System.Diagnostics.EventLogPermissionAccess.Write" /></span>
          </span>
        </permission>
        <altmember cref="P:System.Diagnostics.EventLog.Source" />
        <altmember cref="Overload:System.Diagnostics.EventLog.CreateEventSource" />
        <altmember cref="M:System.Diagnostics.EventLog.DeleteEventSource(System.String)" />
        <altmember cref="M:System.Diagnostics.EventLog.SourceExists(System.String)" />
        <altmember cref="P:System.Diagnostics.EventLog.Entries" />
      </Docs>
    </Member>
    <Member MemberName="WriteEntry">
      <MemberSignature Language="C#" Value="public void WriteEntry (string message, System.Diagnostics.EventLogEntryType type, int eventID);" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig instance void WriteEntry(string message, valuetype System.Diagnostics.EventLogEntryType type, int32 eventID) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Diagnostics.EventLog.WriteEntry(System.String,System.Diagnostics.EventLogEntryType,System.Int32)" />
      <MemberSignature Language="VB.NET" Value="Public Sub WriteEntry (message As String, type As EventLogEntryType, eventID As Integer)" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; void WriteEntry(System::String ^ message, System::Diagnostics::EventLogEntryType type, int eventID);" />
      <MemberSignature Language="F#" Value="member this.WriteEntry : string * System.Diagnostics.EventLogEntryType * int -&gt; unit" Usage="eventLog.WriteEntry (message, type, eventID)" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System</AssemblyName>
        <AssemblyVersion>1.0.5000.0</AssemblyVersion>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Attributes>
        <Attribute FrameworkAlternate="netframework-4.0">
          <AttributeName>System.Runtime.TargetedPatchingOptOut("Performance critical to inline this type of method across NGen image boundaries")</AttributeName>
        </Attribute>
      </Attributes>
      <ReturnValue>
        <ReturnType>System.Void</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="message" Type="System.String" />
        <Parameter Name="type" Type="System.Diagnostics.EventLogEntryType" />
        <Parameter Name="eventID" Type="System.Int32" />
      </Parameters>
      <Docs>
        <param name="message">
          <span data-ttu-id="db667-1150">要写入事件日志的字符串。</span>
          <span class="sxs-lookup">
            <span data-stu-id="db667-1150">The string to write to the event log.</span>
          </span>
        </param>
        <param name="type">
          <span data-ttu-id="db667-1151">
            <see cref="T:System.Diagnostics.EventLogEntryType" /> 值之一。</span>
          <span class="sxs-lookup">
            <span data-stu-id="db667-1151">One of the <see cref="T:System.Diagnostics.EventLogEntryType" /> values.</span>
          </span>
        </param>
        <param name="eventID">
          <span data-ttu-id="db667-1152">事件的应用程序特定标识符。</span>
          <span class="sxs-lookup">
            <span data-stu-id="db667-1152">The application-specific identifier for the event.</span>
          </span>
        </param>
        <summary>
          <span data-ttu-id="db667-1153">将一个具有给定消息文本和应用程序定义的事件标识符的项写入事件日志。</span>
          <span class="sxs-lookup">
            <span data-stu-id="db667-1153">Writes an entry with the given message text and application-defined event identifier to the event log.</span>
          </span>
        </summary>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="db667-1154">使用此方法来编写一个包含应用程序定义的项`eventID`到事件日志。</span><span class="sxs-lookup"><span data-stu-id="db667-1154">Use this method to write an entry with an application-defined `eventID` to the event log.</span></span> <span data-ttu-id="db667-1155">`eventID`与源一起唯一地标识一个事件。</span><span class="sxs-lookup"><span data-stu-id="db667-1155">The `eventID` together with the source uniquely identify an event.</span></span> <span data-ttu-id="db667-1156">每个应用程序可以定义其自身带编号的事件以及它们映射到其中的描述字符串。</span><span class="sxs-lookup"><span data-stu-id="db667-1156">Each application can define its own numbered events and the description strings to which they map.</span></span> <span data-ttu-id="db667-1157">事件查看器显示这些字符串值，以帮助用户了解发生的问题并建议要采取的操作。</span><span class="sxs-lookup"><span data-stu-id="db667-1157">Event viewers display these string values to help the user understand what went wrong and suggest what actions to take.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="db667-1158">`message`字符串不能包含 %*n*，其中*n*是一个整数值 (例如，%1)，因为事件查看器将其视为插入字符串。</span><span class="sxs-lookup"><span data-stu-id="db667-1158">The `message` string cannot contain %*n*, where *n* is an integer value (for example, %1), because the event viewer treats it as an insertion string.</span></span> <span data-ttu-id="db667-1159">Internet 协议版本 6 (IPv6) 地址可以包含此字符序列，因为无法记录事件消息包含 IPv6 地址。</span><span class="sxs-lookup"><span data-stu-id="db667-1159">Because an Internet Protocol, version 6 (IPv6) address can contain this character sequence, you cannot log an event message that contains an IPv6 address.</span></span>  
  
 <span data-ttu-id="db667-1160">除了事件标识符，还可以指定<xref:System.Diagnostics.EventLogEntryType>为写入到事件日志的事件。</span><span class="sxs-lookup"><span data-stu-id="db667-1160">In addition to the event identifier, you can specify an <xref:System.Diagnostics.EventLogEntryType> for the event being written to the event log.</span></span> <span data-ttu-id="db667-1161">`type`由一个图标和日志的事件查看器中的类型列中的文本指示。</span><span class="sxs-lookup"><span data-stu-id="db667-1161">The `type` is indicated by an icon and text in the Type column in the Event Viewer for a log.</span></span> <span data-ttu-id="db667-1162">此参数指示的事件类型是否为错误、 警告、 信息、 成功审核或失败审核。</span><span class="sxs-lookup"><span data-stu-id="db667-1162">This parameter indicates whether the event type is error, warning, information, success audit, or failure audit.</span></span>  
  
 <span data-ttu-id="db667-1163">必须设置<xref:System.Diagnostics.EventLog.Source%2A>上的属性在<xref:System.Diagnostics.EventLog>组件之前可以向日志写入条目。</span><span class="sxs-lookup"><span data-stu-id="db667-1163">You must set the <xref:System.Diagnostics.EventLog.Source%2A> property on your <xref:System.Diagnostics.EventLog> component before you can write entries to the log.</span></span> <span data-ttu-id="db667-1164">必须创建并写入与源的第一项之前配置的事件源。</span><span class="sxs-lookup"><span data-stu-id="db667-1164">You must create and configure the event source before writing the first entry with the source.</span></span>  
  
 <span data-ttu-id="db667-1165">在应用程序的安装过程中创建新的事件源。</span><span class="sxs-lookup"><span data-stu-id="db667-1165">Create the new event source during the installation of your application.</span></span> <span data-ttu-id="db667-1166">这允许操作系统以刷新其注册的事件源的列表和其配置的时间。</span><span class="sxs-lookup"><span data-stu-id="db667-1166">This allows time for the operating system to refresh its list of registered event sources and their configuration.</span></span> <span data-ttu-id="db667-1167">如果操作系统没有刷新其事件源的列表，并且尝试写入新的源的事件写入操作将失败。</span><span class="sxs-lookup"><span data-stu-id="db667-1167">If the operating system has not refreshed its list of event sources, and you attempt to write an event with the new source, the write operation will fail.</span></span> <span data-ttu-id="db667-1168">可以配置新的源使用<xref:System.Diagnostics.EventLogInstaller>，或使用<xref:System.Diagnostics.EventLog.CreateEventSource%2A>方法。</span><span class="sxs-lookup"><span data-stu-id="db667-1168">You can configure a new source using an <xref:System.Diagnostics.EventLogInstaller>, or using the <xref:System.Diagnostics.EventLog.CreateEventSource%2A> method.</span></span> <span data-ttu-id="db667-1169">若要创建新的事件源的计算机上，必须具有管理权限。</span><span class="sxs-lookup"><span data-stu-id="db667-1169">You must have administrative rights on the computer to create a new event source.</span></span>  
  
 <span data-ttu-id="db667-1170">如果在指定的源<xref:System.Diagnostics.EventLog.Source%2A>属性的这<xref:System.Diagnostics.EventLog>写入你的组件，在计算机上不注册实例<xref:System.Diagnostics.EventLog.WriteEntry%2A>调用<xref:System.Diagnostics.EventLog.CreateEventSource%2A>和注册源。</span><span class="sxs-lookup"><span data-stu-id="db667-1170">If the source specified in the <xref:System.Diagnostics.EventLog.Source%2A> property of this <xref:System.Diagnostics.EventLog> instance is not registered on the computer that your component is writing to, <xref:System.Diagnostics.EventLog.WriteEntry%2A> calls <xref:System.Diagnostics.EventLog.CreateEventSource%2A> and registers the source.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="db667-1171">如果未指定<xref:System.Diagnostics.EventLog.MachineName%2A>为你<xref:System.Diagnostics.EventLog>实例在调用之前<xref:System.Diagnostics.EventLog.CreateEventSource%2A>或<xref:System.Diagnostics.EventLog.WriteEntry%2A>，本地计算机 ("。") 假定。</span><span class="sxs-lookup"><span data-stu-id="db667-1171">If you do not specify a <xref:System.Diagnostics.EventLog.MachineName%2A> for your <xref:System.Diagnostics.EventLog> instance before you call <xref:System.Diagnostics.EventLog.CreateEventSource%2A> or <xref:System.Diagnostics.EventLog.WriteEntry%2A>, the local computer (".") is assumed.</span></span>  
  
 <span data-ttu-id="db667-1172">如果系统需要注册<xref:System.Diagnostics.EventLog.Source%2A>通过调用<xref:System.Diagnostics.EventLog.WriteEntry%2A>并<xref:System.Diagnostics.EventLog.Log%2A>不上设置属性在<xref:System.Diagnostics.EventLog>实例，默认为应用程序日志的日志。</span><span class="sxs-lookup"><span data-stu-id="db667-1172">If the system needs to register the <xref:System.Diagnostics.EventLog.Source%2A> through a call to <xref:System.Diagnostics.EventLog.WriteEntry%2A> and the <xref:System.Diagnostics.EventLog.Log%2A> property has not been set on your <xref:System.Diagnostics.EventLog> instance, the log defaults to the Application log.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="db667-1173">上面列出的许多异常都由错误的注册过程中引发<xref:System.Diagnostics.EventLog.Source%2A>。</span><span class="sxs-lookup"><span data-stu-id="db667-1173">Many exceptions listed above are generated by errors raised during the process of registering the <xref:System.Diagnostics.EventLog.Source%2A>.</span></span>  
  
 <span data-ttu-id="db667-1174">要写入本地化的项还是要直接写入字符串，必须配置源。</span><span class="sxs-lookup"><span data-stu-id="db667-1174">The source must be configured either for writing localized entries or for writing direct strings.</span></span> <span data-ttu-id="db667-1175"><xref:System.Diagnostics.EventLog.WriteEntry%2A>方法直接写入事件日志写入给定的字符串; 它不使用可本地化的消息资源文件。</span><span class="sxs-lookup"><span data-stu-id="db667-1175">The <xref:System.Diagnostics.EventLog.WriteEntry%2A> method writes the given string directly to the event log; it does not use a localizable message resource file.</span></span> <span data-ttu-id="db667-1176">使用<xref:System.Diagnostics.EventLog.WriteEvent%2A>方法来写入事件时使用的本地化的消息资源文件。</span><span class="sxs-lookup"><span data-stu-id="db667-1176">Use the <xref:System.Diagnostics.EventLog.WriteEvent%2A> method to write events using a localized message resource file.</span></span>  
  
 <span data-ttu-id="db667-1177">如果你的应用程序将使用资源标识符和字符串值的条目写入，则必须注册两个单独的源。</span><span class="sxs-lookup"><span data-stu-id="db667-1177">If your application writes entries using both resource identifiers and string values, you must register two separate sources.</span></span> <span data-ttu-id="db667-1178">例如，配置一个源的资源文件，以及如何将该源中的<xref:System.Diagnostics.EventLog.WriteEvent%2A>方法来编写使用资源标识符添加到事件日志条目。</span><span class="sxs-lookup"><span data-stu-id="db667-1178">For example, configure one source with resource files, and then use that source in the <xref:System.Diagnostics.EventLog.WriteEvent%2A> method to write entries using resource identifiers to the event log.</span></span> <span data-ttu-id="db667-1179">然后创建不同的源，而无需资源文件，并使用在该源<xref:System.Diagnostics.EventLog.WriteEntry%2A>方法将字符串直接写入事件日志使用的源。</span><span class="sxs-lookup"><span data-stu-id="db667-1179">Then create a different source without resource files, and use that source in the <xref:System.Diagnostics.EventLog.WriteEntry%2A> method to write strings directly to the event log using that source.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="db667-1180">如果远程计算机中写入一个条目，消息 （文本字符串） 的值可能不是预期如果远程计算机未运行.NET Framework。</span><span class="sxs-lookup"><span data-stu-id="db667-1180">If you write an entry to a remote computer, the value of the message (the text string) might not be what you expect if the remote computer is not running the .NET Framework.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="db667-1181">如果`message`参数包含 NUL 字符，则在 NUL 字符处终止事件日志中的消息。</span><span class="sxs-lookup"><span data-stu-id="db667-1181">If the `message` parameter contains a NUL character, the message in the event log is terminated at the NUL character.</span></span>  
  
   
  
## Examples  
 [!code-cpp[EventLog_WriteEntry_1_3#3](~/samples/snippets/cpp/VS_Snippets_CLR/EventLog_WriteEntry_1_3/CPP/eventlog_writeentry_1_3.cpp#3)]
 [!code-csharp[EventLog_WriteEntry_1_3#3](~/samples/snippets/csharp/VS_Snippets_CLR/EventLog_WriteEntry_1_3/CS/eventlog_writeentry_1_3.cs#3)]
 [!code-vb[EventLog_WriteEntry_1_3#3](~/samples/snippets/visualbasic/VS_Snippets_CLR/EventLog_WriteEntry_1_3/VB/eventlog_writeentry_1_3.vb#3)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentException">
          <span data-ttu-id="db667-1182">
            <see cref="P:System.Diagnostics.EventLog.Source" /> 的 <see cref="T:System.Diagnostics.EventLog" /> 属性尚未设置。</span>
          <span class="sxs-lookup">
            <span data-stu-id="db667-1182">The <see cref="P:System.Diagnostics.EventLog.Source" /> property of the <see cref="T:System.Diagnostics.EventLog" /> has not been set.</span>
          </span>
          <span data-ttu-id="db667-1183">或</span>
          <span class="sxs-lookup">
            <span data-stu-id="db667-1183">-or-</span>
          </span>
          <span data-ttu-id="db667-1184">该方法尝试注册新的事件源，但 <see cref="P:System.Diagnostics.EventLog.MachineName" /> 中的计算机名称无效。</span>
          <span class="sxs-lookup">
            <span data-stu-id="db667-1184">The method attempted to register a new event source, but the computer name in <see cref="P:System.Diagnostics.EventLog.MachineName" /> is not valid.</span>
          </span>
          <span data-ttu-id="db667-1185">\- 或 -</span>
          <span class="sxs-lookup">
            <span data-stu-id="db667-1185">\- or -</span>
          </span>
          <span data-ttu-id="db667-1186">已为其他事件日志注册了该源。</span>
          <span class="sxs-lookup">
            <span data-stu-id="db667-1186">The source is already registered for a different event log.</span>
          </span>
          <span data-ttu-id="db667-1187">\- 或 -</span>
          <span class="sxs-lookup">
            <span data-stu-id="db667-1187">\- or -</span>
          </span>
          <span data-ttu-id="db667-1188">
            <paramref name="eventID" /> 小于零或大于 <see cref="F:System.UInt16.MaxValue" />。</span>
          <span class="sxs-lookup">
            <span data-stu-id="db667-1188">
              <paramref name="eventID" /> is less than zero or greater than <see cref="F:System.UInt16.MaxValue" />.</span>
          </span>
          <span data-ttu-id="db667-1189">\- 或 -</span>
          <span class="sxs-lookup">
            <span data-stu-id="db667-1189">\- or -</span>
          </span>
          <span data-ttu-id="db667-1190">消息字符串长于 31,839 字节（在 Windows Vista 之前，在 Windows 操作系统上为 32,766 字节)。</span>
          <span class="sxs-lookup">
            <span data-stu-id="db667-1190">The message string is longer than 31,839 bytes (32,766 bytes on Windows operating systems before Windows Vista).</span>
          </span>
          <span data-ttu-id="db667-1191">\- 或 -</span>
          <span class="sxs-lookup">
            <span data-stu-id="db667-1191">\- or -</span>
          </span>
          <span data-ttu-id="db667-1192">此源名称导致注册表项路径的长度超过 254 个字符。</span>
          <span class="sxs-lookup">
            <span data-stu-id="db667-1192">The source name results in a registry key path longer than 254 characters.</span>
          </span>
        </exception>
        <exception cref="T:System.InvalidOperationException">
          <span data-ttu-id="db667-1193">事件日志的注册表项未能打开。</span>
          <span class="sxs-lookup">
            <span data-stu-id="db667-1193">The registry key for the event log could not be opened.</span>
          </span>
        </exception>
        <exception cref="T:System.ComponentModel.InvalidEnumArgumentException">
          <span data-ttu-id="db667-1194">
            <paramref name="type" /> 不是有效的 <see cref="T:System.Diagnostics.EventLogEntryType" />。</span>
          <span class="sxs-lookup">
            <span data-stu-id="db667-1194">
              <paramref name="type" /> is not a valid <see cref="T:System.Diagnostics.EventLogEntryType" />.</span>
          </span>
        </exception>
        <exception cref="T:System.ComponentModel.Win32Exception">
          <span data-ttu-id="db667-1195">将事件项写入事件日志时，操作系统报告了一个错误。</span>
          <span class="sxs-lookup">
            <span data-stu-id="db667-1195">The operating system reported an error when writing the event entry to the event log.</span>
          </span>
          <span data-ttu-id="db667-1196">一个 Windows 错误代码不可用。</span>
          <span class="sxs-lookup">
            <span data-stu-id="db667-1196">A Windows error code is not available.</span>
          </span>
        </exception>
        <permission cref="T:System.Diagnostics.EventLogPermission">
          <span data-ttu-id="db667-1197">用于写入的计算机上的事件日志信息。</span>
          <span class="sxs-lookup">
            <span data-stu-id="db667-1197">for writing the event log information on the computer.</span>
          </span>
          <span data-ttu-id="db667-1198">关联的枚举： <see cref="F:System.Diagnostics.EventLogPermissionAccess.Write" /></span>
          <span class="sxs-lookup">
            <span data-stu-id="db667-1198">Associated enumeration: <see cref="F:System.Diagnostics.EventLogPermissionAccess.Write" /></span>
          </span>
        </permission>
        <altmember cref="T:System.Diagnostics.EventLogEntryType" />
        <altmember cref="P:System.Diagnostics.EventLog.Source" />
        <altmember cref="Overload:System.Diagnostics.EventLog.CreateEventSource" />
        <altmember cref="M:System.Diagnostics.EventLog.DeleteEventSource(System.String)" />
        <altmember cref="M:System.Diagnostics.EventLog.SourceExists(System.String)" />
        <altmember cref="P:System.Diagnostics.EventLog.Entries" />
      </Docs>
    </Member>
    <Member MemberName="WriteEntry">
      <MemberSignature Language="C#" Value="public static void WriteEntry (string source, string message, System.Diagnostics.EventLogEntryType type);" />
      <MemberSignature Language="ILAsm" Value=".method public static hidebysig void WriteEntry(string source, string message, valuetype System.Diagnostics.EventLogEntryType type) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Diagnostics.EventLog.WriteEntry(System.String,System.String,System.Diagnostics.EventLogEntryType)" />
      <MemberSignature Language="VB.NET" Value="Public Shared Sub WriteEntry (source As String, message As String, type As EventLogEntryType)" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; static void WriteEntry(System::String ^ source, System::String ^ message, System::Diagnostics::EventLogEntryType type);" />
      <MemberSignature Language="F#" Value="static member WriteEntry : string * string * System.Diagnostics.EventLogEntryType -&gt; unit" Usage="System.Diagnostics.EventLog.WriteEntry (source, message, type)" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System</AssemblyName>
        <AssemblyVersion>1.0.5000.0</AssemblyVersion>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Attributes>
        <Attribute FrameworkAlternate="netframework-4.0">
          <AttributeName>System.Runtime.TargetedPatchingOptOut("Performance critical to inline this type of method across NGen image boundaries")</AttributeName>
        </Attribute>
      </Attributes>
      <ReturnValue>
        <ReturnType>System.Void</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="source" Type="System.String" />
        <Parameter Name="message" Type="System.String" />
        <Parameter Name="type" Type="System.Diagnostics.EventLogEntryType" />
      </Parameters>
      <Docs>
        <param name="source">
          <span data-ttu-id="db667-1199">应用程序在指定计算机上注册时所采用的源。</span>
          <span class="sxs-lookup">
            <span data-stu-id="db667-1199">The source by which the application is registered on the specified computer.</span>
          </span>
        </param>
        <param name="message">
          <span data-ttu-id="db667-1200">要写入事件日志的字符串。</span>
          <span class="sxs-lookup">
            <span data-stu-id="db667-1200">The string to write to the event log.</span>
          </span>
        </param>
        <param name="type">
          <span data-ttu-id="db667-1201">
            <see cref="T:System.Diagnostics.EventLogEntryType" /> 值之一。</span>
          <span class="sxs-lookup">
            <span data-stu-id="db667-1201">One of the <see cref="T:System.Diagnostics.EventLogEntryType" /> values.</span>
          </span>
        </param>
        <summary>
          <span data-ttu-id="db667-1202">使用指定的注册事件源，将错误、警告、信息、成功审核或失败审核项与给定的消息文本一起写入事件日志。</span>
          <span class="sxs-lookup">
            <span data-stu-id="db667-1202">Writes an error, warning, information, success audit, or failure audit entry with the given message text to the event log, using the specified registered event source.</span>
          </span>
        </summary>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="db667-1203">使用此方法的指定项写入<xref:System.Diagnostics.EventLogEntryType>到事件日志中，将源使用已注册为相应的日志的事件源。</span><span class="sxs-lookup"><span data-stu-id="db667-1203">Use this method to write an entry of a specified <xref:System.Diagnostics.EventLogEntryType> to the event log, using a source already registered as an event source for the appropriate log.</span></span> <span data-ttu-id="db667-1204">`type`由一个图标和日志的事件查看器中的类型列中的文本指示。</span><span class="sxs-lookup"><span data-stu-id="db667-1204">The `type` is indicated by an icon and text in the Type column in the Event Viewer for a log.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="db667-1205">`message`字符串不能包含 %*n*，其中*n*是一个整数值 (例如，%1)，因为事件查看器将其视为插入字符串。</span><span class="sxs-lookup"><span data-stu-id="db667-1205">The `message` string cannot contain %*n*, where *n* is an integer value (for example, %1), because the event viewer treats it as an insertion string.</span></span> <span data-ttu-id="db667-1206">Internet 协议版本 6 (IPv6) 地址可以包含此字符序列，因为无法记录事件消息包含 IPv6 地址。</span><span class="sxs-lookup"><span data-stu-id="db667-1206">Because an Internet Protocol, version 6 (IPv6) address can contain this character sequence, you cannot log an event message that contains an IPv6 address.</span></span>  
  
 <span data-ttu-id="db667-1207">必须创建并写入与源的第一项之前配置的事件源。</span><span class="sxs-lookup"><span data-stu-id="db667-1207">You must create and configure the event source before writing the first entry with the source.</span></span> <span data-ttu-id="db667-1208">在应用程序的安装过程中创建新的事件源。</span><span class="sxs-lookup"><span data-stu-id="db667-1208">Create the new event source during the installation of your application.</span></span> <span data-ttu-id="db667-1209">这允许操作系统以刷新其注册的事件源的列表和其配置的时间。</span><span class="sxs-lookup"><span data-stu-id="db667-1209">This allows time for the operating system to refresh its list of registered event sources and their configuration.</span></span> <span data-ttu-id="db667-1210">如果操作系统没有刷新其事件源的列表，并且尝试写入新的源的事件写入操作将失败。</span><span class="sxs-lookup"><span data-stu-id="db667-1210">If the operating system has not refreshed its list of event sources, and you attempt to write an event with the new source, the write operation will fail.</span></span> <span data-ttu-id="db667-1211">可以配置新的源使用<xref:System.Diagnostics.EventLogInstaller>，或使用<xref:System.Diagnostics.EventLog.CreateEventSource%2A>方法。</span><span class="sxs-lookup"><span data-stu-id="db667-1211">You can configure a new source using an <xref:System.Diagnostics.EventLogInstaller>, or using the <xref:System.Diagnostics.EventLog.CreateEventSource%2A> method.</span></span> <span data-ttu-id="db667-1212">若要创建新的事件源的计算机上，必须具有管理权限。</span><span class="sxs-lookup"><span data-stu-id="db667-1212">You must have administrative rights on the computer to create a new event source.</span></span>  
  
 <span data-ttu-id="db667-1213">要写入本地化的项还是要直接写入字符串，必须配置源。</span><span class="sxs-lookup"><span data-stu-id="db667-1213">The source must be configured either for writing localized entries or for writing direct strings.</span></span> <span data-ttu-id="db667-1214"><xref:System.Diagnostics.EventLog.WriteEntry%2A>方法直接写入事件日志写入给定的字符串; 它不使用可本地化的消息资源文件。</span><span class="sxs-lookup"><span data-stu-id="db667-1214">The <xref:System.Diagnostics.EventLog.WriteEntry%2A> method writes the given string directly to the event log; it does not use a localizable message resource file.</span></span> <span data-ttu-id="db667-1215">使用<xref:System.Diagnostics.EventLog.WriteEvent%2A>方法来写入事件时使用的本地化的消息资源文件。</span><span class="sxs-lookup"><span data-stu-id="db667-1215">Use the <xref:System.Diagnostics.EventLog.WriteEvent%2A> method to write events using a localized message resource file.</span></span>  
  
 <span data-ttu-id="db667-1216">如果你的应用程序将使用资源标识符和字符串值的条目写入，则必须注册两个单独的源。</span><span class="sxs-lookup"><span data-stu-id="db667-1216">If your application writes entries using both resource identifiers and string values, you must register two separate sources.</span></span> <span data-ttu-id="db667-1217">例如，配置一个源的资源文件，以及如何将该源中的<xref:System.Diagnostics.EventLog.WriteEvent%2A>方法来编写使用资源标识符添加到事件日志条目。</span><span class="sxs-lookup"><span data-stu-id="db667-1217">For example, configure one source with resource files, and then use that source in the <xref:System.Diagnostics.EventLog.WriteEvent%2A> method to write entries using resource identifiers to the event log.</span></span> <span data-ttu-id="db667-1218">然后创建不同的源，而无需资源文件，并使用在该源<xref:System.Diagnostics.EventLog.WriteEntry%2A>方法将字符串直接写入事件日志使用的源。</span><span class="sxs-lookup"><span data-stu-id="db667-1218">Then create a different source without resource files, and use that source in the <xref:System.Diagnostics.EventLog.WriteEntry%2A> method to write strings directly to the event log using that source.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="db667-1219">如果`message`参数包含 NUL 字符，则在 NUL 字符处终止事件日志中的消息。</span><span class="sxs-lookup"><span data-stu-id="db667-1219">If the `message` parameter contains a NUL character, the message in the event log is terminated at the NUL character.</span></span>  
  
   
  
## Examples  
 <span data-ttu-id="db667-1220">下面的示例警告项写入事件日志中，"MyNewLog"本地计算机上。</span><span class="sxs-lookup"><span data-stu-id="db667-1220">The following example writes a warning entry to an event log, "MyNewLog", on the local computer.</span></span>  
  
 [!code-cpp[Classic EventLog.WriteEntry3 Example#1](~/samples/snippets/cpp/VS_Snippets_CLR_Classic/classic EventLog.WriteEntry3 Example/CPP/source.cpp#1)]
 [!code-csharp[Classic EventLog.WriteEntry3 Example#1](~/samples/snippets/csharp/VS_Snippets_CLR_Classic/classic EventLog.WriteEntry3 Example/CS/source.cs#1)]
 [!code-vb[Classic EventLog.WriteEntry3 Example#1](~/samples/snippets/visualbasic/VS_Snippets_CLR_Classic/classic EventLog.WriteEntry3 Example/VB/source.vb#1)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentException">
          <span data-ttu-id="db667-1221">
            <paramref name="source" /> 值是空字符串 ("")。</span>
          <span class="sxs-lookup">
            <span data-stu-id="db667-1221">The <paramref name="source" /> value is an empty string ("").</span>
          </span>
          <span data-ttu-id="db667-1222">\- 或 -</span>
          <span class="sxs-lookup">
            <span data-stu-id="db667-1222">\- or -</span>
          </span>
          <span data-ttu-id="db667-1223">
            <paramref name="source" /> 值为 <see langword="null" />。</span>
          <span class="sxs-lookup">
            <span data-stu-id="db667-1223">The <paramref name="source" /> value is <see langword="null" />.</span>
          </span>
          <span data-ttu-id="db667-1224">\- 或 -</span>
          <span class="sxs-lookup">
            <span data-stu-id="db667-1224">\- or -</span>
          </span>
          <span data-ttu-id="db667-1225">消息字符串长于 31,839 字节（在 Windows Vista 之前，在 Windows 操作系统上为 32,766 字节)。</span>
          <span class="sxs-lookup">
            <span data-stu-id="db667-1225">The message string is longer than 31,839 bytes (32,766 bytes on Windows operating systems before Windows Vista).</span>
          </span>
          <span data-ttu-id="db667-1226">\- 或 -</span>
          <span class="sxs-lookup">
            <span data-stu-id="db667-1226">\- or -</span>
          </span>
          <span data-ttu-id="db667-1227">此源名称导致注册表项路径的长度超过 254 个字符。</span>
          <span class="sxs-lookup">
            <span data-stu-id="db667-1227">The source name results in a registry key path longer than 254 characters.</span>
          </span>
        </exception>
        <exception cref="T:System.InvalidOperationException">
          <span data-ttu-id="db667-1228">事件日志的注册表项未能打开。</span>
          <span class="sxs-lookup">
            <span data-stu-id="db667-1228">The registry key for the event log could not be opened.</span>
          </span>
        </exception>
        <exception cref="T:System.ComponentModel.InvalidEnumArgumentException">
          <span data-ttu-id="db667-1229">
            <paramref name="type" /> 不是有效的 <see cref="T:System.Diagnostics.EventLogEntryType" />。</span>
          <span class="sxs-lookup">
            <span data-stu-id="db667-1229">
              <paramref name="type" /> is not a valid <see cref="T:System.Diagnostics.EventLogEntryType" />.</span>
          </span>
        </exception>
        <exception cref="T:System.ComponentModel.Win32Exception">
          <span data-ttu-id="db667-1230">将事件项写入事件日志时，操作系统报告了一个错误。</span>
          <span class="sxs-lookup">
            <span data-stu-id="db667-1230">The operating system reported an error when writing the event entry to the event log.</span>
          </span>
          <span data-ttu-id="db667-1231">一个 Windows 错误代码不可用。</span>
          <span class="sxs-lookup">
            <span data-stu-id="db667-1231">A Windows error code is not available.</span>
          </span>
        </exception>
        <permission cref="T:System.Diagnostics.EventLogPermission">
          <span data-ttu-id="db667-1232">用于写入的计算机上的事件日志信息。</span>
          <span class="sxs-lookup">
            <span data-stu-id="db667-1232">for writing the event log information on the computer.</span>
          </span>
          <span data-ttu-id="db667-1233">关联的枚举： <see cref="F:System.Diagnostics.EventLogPermissionAccess.Write" /></span>
          <span class="sxs-lookup">
            <span data-stu-id="db667-1233">Associated enumeration: <see cref="F:System.Diagnostics.EventLogPermissionAccess.Write" /></span>
          </span>
        </permission>
        <altmember cref="T:System.Diagnostics.EventLogEntryType" />
        <altmember cref="P:System.Diagnostics.EventLog.Source" />
        <altmember cref="Overload:System.Diagnostics.EventLog.CreateEventSource" />
        <altmember cref="M:System.Diagnostics.EventLog.DeleteEventSource(System.String)" />
        <altmember cref="M:System.Diagnostics.EventLog.SourceExists(System.String)" />
        <altmember cref="P:System.Diagnostics.EventLog.Entries" />
      </Docs>
    </Member>
    <Member MemberName="WriteEntry">
      <MemberSignature Language="C#" Value="public void WriteEntry (string message, System.Diagnostics.EventLogEntryType type, int eventID, short category);" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig instance void WriteEntry(string message, valuetype System.Diagnostics.EventLogEntryType type, int32 eventID, int16 category) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Diagnostics.EventLog.WriteEntry(System.String,System.Diagnostics.EventLogEntryType,System.Int32,System.Int16)" />
      <MemberSignature Language="VB.NET" Value="Public Sub WriteEntry (message As String, type As EventLogEntryType, eventID As Integer, category As Short)" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; void WriteEntry(System::String ^ message, System::Diagnostics::EventLogEntryType type, int eventID, short category);" />
      <MemberSignature Language="F#" Value="member this.WriteEntry : string * System.Diagnostics.EventLogEntryType * int * int16 -&gt; unit" Usage="eventLog.WriteEntry (message, type, eventID, category)" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System</AssemblyName>
        <AssemblyVersion>1.0.5000.0</AssemblyVersion>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Attributes>
        <Attribute FrameworkAlternate="netframework-4.0">
          <AttributeName>System.Runtime.TargetedPatchingOptOut("Performance critical to inline this type of method across NGen image boundaries")</AttributeName>
        </Attribute>
      </Attributes>
      <ReturnValue>
        <ReturnType>System.Void</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="message" Type="System.String" />
        <Parameter Name="type" Type="System.Diagnostics.EventLogEntryType" />
        <Parameter Name="eventID" Type="System.Int32" />
        <Parameter Name="category" Type="System.Int16" />
      </Parameters>
      <Docs>
        <param name="message">
          <span data-ttu-id="db667-1234">要写入事件日志的字符串。</span>
          <span class="sxs-lookup">
            <span data-stu-id="db667-1234">The string to write to the event log.</span>
          </span>
        </param>
        <param name="type">
          <span data-ttu-id="db667-1235">
            <see cref="T:System.Diagnostics.EventLogEntryType" /> 值之一。</span>
          <span class="sxs-lookup">
            <span data-stu-id="db667-1235">One of the <see cref="T:System.Diagnostics.EventLogEntryType" /> values.</span>
          </span>
        </param>
        <param name="eventID">
          <span data-ttu-id="db667-1236">事件的应用程序特定标识符。</span>
          <span class="sxs-lookup">
            <span data-stu-id="db667-1236">The application-specific identifier for the event.</span>
          </span>
        </param>
        <param name="category">
          <span data-ttu-id="db667-1237">与消息关联的应用程序特定子类别。</span>
          <span class="sxs-lookup">
            <span data-stu-id="db667-1237">The application-specific subcategory associated with the message.</span>
          </span>
        </param>
        <summary>
          <span data-ttu-id="db667-1238">将一个具有给定消息文本、应用程序定义的事件标识符和应用程序定义的类别的项写入事件日志。</span>
          <span class="sxs-lookup">
            <span data-stu-id="db667-1238">Writes an entry with the given message text, application-defined event identifier, and application-defined category to the event log.</span>
          </span>
        </summary>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="db667-1239">使用此方法来编写一个包含应用程序定义的项`category`到事件日志。</span><span class="sxs-lookup"><span data-stu-id="db667-1239">Use this method to write an entry with an application-defined `category` to the event log.</span></span> <span data-ttu-id="db667-1240">事件查看器使用的类别的事件源写入筛选器事件。</span><span class="sxs-lookup"><span data-stu-id="db667-1240">The Event Viewer uses the category to filter events written by an event source.</span></span> <span data-ttu-id="db667-1241">事件查看器可以将类别显示为数字值，或者它可以作为资源标识符使用类别来显示本地化的类别字符串。</span><span class="sxs-lookup"><span data-stu-id="db667-1241">The Event Viewer can display the category as a numeric value, or it can use the category as a resource identifier to display a localized category string.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="db667-1242">`category`参数应为正值。</span><span class="sxs-lookup"><span data-stu-id="db667-1242">The `category` parameter should be a positive value.</span></span> <span data-ttu-id="db667-1243">负类别值显示为互为补充的正数值在事件查看器。</span><span class="sxs-lookup"><span data-stu-id="db667-1243">Negative category values appear as a complementary positive number in the Event Viewer.</span></span> <span data-ttu-id="db667-1244">例如，– 10 显示为 65526，65535 为 – 1。</span><span class="sxs-lookup"><span data-stu-id="db667-1244">For example, a –10 appears as 65,526, a –1 as 65,535.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="db667-1245">`message`字符串不能包含 %*n*，其中*n*是一个整数值 (例如，%1)，因为事件查看器将其视为插入字符串。</span><span class="sxs-lookup"><span data-stu-id="db667-1245">The `message` string cannot contain %*n*, where *n* is an integer value (for example, %1), because the event viewer treats it as an insertion string.</span></span> <span data-ttu-id="db667-1246">Internet 协议版本 6 (IPv6) 地址可以包含此字符序列，因为无法记录事件消息包含 IPv6 地址。</span><span class="sxs-lookup"><span data-stu-id="db667-1246">Because an Internet Protocol, version 6 (IPv6) address can contain this character sequence, you cannot log an event message that contains an IPv6 address.</span></span>  
  
 <span data-ttu-id="db667-1247">若要在事件查看器中显示本地化的类别字符串，必须使用事件源的类别资源文件后，配置和设置`category`类别资源文件中的资源标识符。</span><span class="sxs-lookup"><span data-stu-id="db667-1247">To display localized category strings in the Event Viewer, you must use an event source configured with a category resource file, and set the `category` to a resource identifier in the category resource file.</span></span> <span data-ttu-id="db667-1248">如果事件源没有配置的类别资源文件，或指定`category`没有索引的字符串中的类别资源文件，则在事件查看器将显示该条目的数字型类别值。</span><span class="sxs-lookup"><span data-stu-id="db667-1248">If the event source does not have a configured category resource file, or the specified `category` does not index a string in the category resource file, then the Event Viewer displays the numeric category value for that entry.</span></span> <span data-ttu-id="db667-1249">配置类别资源文件，以及数量的资源文件中的类别字符串使用<xref:System.Diagnostics.EventLogInstaller>或<xref:System.Diagnostics.EventSourceCreationData>类。</span><span class="sxs-lookup"><span data-stu-id="db667-1249">Configure the category resource file, along with the number of category strings in the resource file, using the <xref:System.Diagnostics.EventLogInstaller> or the <xref:System.Diagnostics.EventSourceCreationData> class.</span></span>  
  
 <span data-ttu-id="db667-1250">除了类别，可以指定要写入到事件日志的事件的事件标识符。</span><span class="sxs-lookup"><span data-stu-id="db667-1250">In addition to the category, you can specify an event identifier for the event being written to the event log.</span></span> <span data-ttu-id="db667-1251">事件标识符的事件源，以及唯一地标识一个事件。</span><span class="sxs-lookup"><span data-stu-id="db667-1251">Event identifiers, along with the event source, uniquely identify an event.</span></span> <span data-ttu-id="db667-1252">每个应用程序可以定义其自身带编号的事件以及它们映射到其中的描述字符串。</span><span class="sxs-lookup"><span data-stu-id="db667-1252">Each application can define its own numbered events and the description strings to which they map.</span></span> <span data-ttu-id="db667-1253">事件查看器显示这些字符串值，以帮助用户了解发生的问题并建议要采取的操作。</span><span class="sxs-lookup"><span data-stu-id="db667-1253">Event viewers display these string values to help the user understand what went wrong and suggest what actions to take.</span></span>  
  
 <span data-ttu-id="db667-1254">最后，可以指定<xref:System.Diagnostics.EventLogEntryType>为写入到事件日志的事件。</span><span class="sxs-lookup"><span data-stu-id="db667-1254">Finally, you can specify an <xref:System.Diagnostics.EventLogEntryType> for the event being written to the event log.</span></span> <span data-ttu-id="db667-1255">`type`由一个图标和日志的事件查看器中的类型列中的文本指示。</span><span class="sxs-lookup"><span data-stu-id="db667-1255">The `type` is indicated by an icon and text in the Type column in the Event Viewer for a log.</span></span> <span data-ttu-id="db667-1256">此参数指示的事件类型是否为错误、 警告、 信息、 成功审核或失败审核。</span><span class="sxs-lookup"><span data-stu-id="db667-1256">This parameter indicates whether the event type is error, warning, information, success audit, or failure audit.</span></span>  
  
 <span data-ttu-id="db667-1257">必须设置<xref:System.Diagnostics.EventLog.Source%2A>上的属性在<xref:System.Diagnostics.EventLog>组件之前可以向日志写入条目。</span><span class="sxs-lookup"><span data-stu-id="db667-1257">You must set the <xref:System.Diagnostics.EventLog.Source%2A> property on your <xref:System.Diagnostics.EventLog> component before you can write entries to the log.</span></span> <span data-ttu-id="db667-1258">必须创建并写入与源的第一项之前配置的事件源。</span><span class="sxs-lookup"><span data-stu-id="db667-1258">You must create and configure the event source before writing the first entry with the source.</span></span>  
  
 <span data-ttu-id="db667-1259">在应用程序的安装过程中创建新的事件源。</span><span class="sxs-lookup"><span data-stu-id="db667-1259">Create the new event source during the installation of your application.</span></span> <span data-ttu-id="db667-1260">这允许操作系统以刷新其注册的事件源的列表和其配置的时间。</span><span class="sxs-lookup"><span data-stu-id="db667-1260">This allows time for the operating system to refresh its list of registered event sources and their configuration.</span></span> <span data-ttu-id="db667-1261">如果操作系统没有刷新其事件源的列表，并且尝试写入新的源的事件写入操作将失败。</span><span class="sxs-lookup"><span data-stu-id="db667-1261">If the operating system has not refreshed its list of event sources, and you attempt to write an event with the new source, the write operation will fail.</span></span> <span data-ttu-id="db667-1262">可以配置新的源使用<xref:System.Diagnostics.EventLogInstaller>，或使用<xref:System.Diagnostics.EventLog.CreateEventSource%2A>方法。</span><span class="sxs-lookup"><span data-stu-id="db667-1262">You can configure a new source using an <xref:System.Diagnostics.EventLogInstaller>, or using the <xref:System.Diagnostics.EventLog.CreateEventSource%2A> method.</span></span> <span data-ttu-id="db667-1263">若要创建新的事件源的计算机上，必须具有管理权限。</span><span class="sxs-lookup"><span data-stu-id="db667-1263">You must have administrative rights on the computer to create a new event source.</span></span>  
  
 <span data-ttu-id="db667-1264">如果在指定的源<xref:System.Diagnostics.EventLog.Source%2A>属性的这<xref:System.Diagnostics.EventLog>写入你的组件，在计算机上不注册实例<xref:System.Diagnostics.EventLog.WriteEntry%2A>调用<xref:System.Diagnostics.EventLog.CreateEventSource%2A>和注册源。</span><span class="sxs-lookup"><span data-stu-id="db667-1264">If the source specified in the <xref:System.Diagnostics.EventLog.Source%2A> property of this <xref:System.Diagnostics.EventLog> instance is not registered on the computer that your component is writing to, <xref:System.Diagnostics.EventLog.WriteEntry%2A> calls <xref:System.Diagnostics.EventLog.CreateEventSource%2A> and registers the source.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="db667-1265">如果未指定<xref:System.Diagnostics.EventLog.MachineName%2A>为你<xref:System.Diagnostics.EventLog>实例在调用之前<xref:System.Diagnostics.EventLog.CreateEventSource%2A>或<xref:System.Diagnostics.EventLog.WriteEntry%2A>，本地计算机 ("。") 假定。</span><span class="sxs-lookup"><span data-stu-id="db667-1265">If you do not specify a <xref:System.Diagnostics.EventLog.MachineName%2A> for your <xref:System.Diagnostics.EventLog> instance before you call <xref:System.Diagnostics.EventLog.CreateEventSource%2A> or <xref:System.Diagnostics.EventLog.WriteEntry%2A>, the local computer (".") is assumed.</span></span>  
  
 <span data-ttu-id="db667-1266">如果系统需要注册<xref:System.Diagnostics.EventLog.Source%2A>通过调用<xref:System.Diagnostics.EventLog.WriteEntry%2A>并<xref:System.Diagnostics.EventLog.Log%2A>不上设置属性在<xref:System.Diagnostics.EventLog>实例，默认为应用程序日志的日志。</span><span class="sxs-lookup"><span data-stu-id="db667-1266">If the system needs to register the <xref:System.Diagnostics.EventLog.Source%2A> through a call to <xref:System.Diagnostics.EventLog.WriteEntry%2A> and the <xref:System.Diagnostics.EventLog.Log%2A> property has not been set on your <xref:System.Diagnostics.EventLog> instance, the log defaults to the Application log.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="db667-1267">上面列出的许多异常都由错误的注册过程中引发<xref:System.Diagnostics.EventLog.Source%2A>。</span><span class="sxs-lookup"><span data-stu-id="db667-1267">Many exceptions listed above are generated by errors raised during the process of registering the <xref:System.Diagnostics.EventLog.Source%2A>.</span></span>  
  
 <span data-ttu-id="db667-1268">要写入本地化的项还是要直接写入字符串，必须配置源。</span><span class="sxs-lookup"><span data-stu-id="db667-1268">The source must be configured either for writing localized entries or for writing direct strings.</span></span> <span data-ttu-id="db667-1269"><xref:System.Diagnostics.EventLog.WriteEntry%2A>方法直接写入事件日志写入给定的字符串; 它不使用可本地化的消息资源文件。</span><span class="sxs-lookup"><span data-stu-id="db667-1269">The <xref:System.Diagnostics.EventLog.WriteEntry%2A> method writes the given string directly to the event log; it does not use a localizable message resource file.</span></span> <span data-ttu-id="db667-1270">使用<xref:System.Diagnostics.EventLog.WriteEvent%2A>方法来写入事件时使用的本地化的消息资源文件。</span><span class="sxs-lookup"><span data-stu-id="db667-1270">Use the <xref:System.Diagnostics.EventLog.WriteEvent%2A> method to write events using a localized message resource file.</span></span>  
  
 <span data-ttu-id="db667-1271">如果你的应用程序将使用资源标识符和字符串值的条目写入，则必须注册两个单独的源。</span><span class="sxs-lookup"><span data-stu-id="db667-1271">If your application writes entries using both resource identifiers and string values, you must register two separate sources.</span></span> <span data-ttu-id="db667-1272">例如，配置一个源的资源文件，以及如何将该源中的<xref:System.Diagnostics.EventLog.WriteEvent%2A>方法来编写使用资源标识符添加到事件日志条目。</span><span class="sxs-lookup"><span data-stu-id="db667-1272">For example, configure one source with resource files, and then use that source in the <xref:System.Diagnostics.EventLog.WriteEvent%2A> method to write entries using resource identifiers to the event log.</span></span> <span data-ttu-id="db667-1273">然后创建不同的源，而无需资源文件，并使用在该源<xref:System.Diagnostics.EventLog.WriteEntry%2A>方法将字符串直接写入事件日志使用的源。</span><span class="sxs-lookup"><span data-stu-id="db667-1273">Then create a different source without resource files, and use that source in the <xref:System.Diagnostics.EventLog.WriteEntry%2A> method to write strings directly to the event log using that source.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="db667-1274">如果远程计算机中写入一个条目，消息 （文本字符串） 的值可能不是预期如果远程计算机未运行.NET Framework。</span><span class="sxs-lookup"><span data-stu-id="db667-1274">If you write an entry to a remote computer, the value of the message (the text string) might not be what you expect if the remote computer is not running the .NET Framework.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="db667-1275">如果`message`参数包含 NUL 字符，则在 NUL 字符处终止事件日志中的消息。</span><span class="sxs-lookup"><span data-stu-id="db667-1275">If the `message` parameter contains a NUL character, the message in the event log is terminated at the NUL character.</span></span>  
  
   
  
## Examples  
 [!code-cpp[EventLog_WriteEntry_1_3#3](~/samples/snippets/cpp/VS_Snippets_CLR/EventLog_WriteEntry_1_3/CPP/eventlog_writeentry_1_3.cpp#3)]
 [!code-csharp[EventLog_WriteEntry_1_3#3](~/samples/snippets/csharp/VS_Snippets_CLR/EventLog_WriteEntry_1_3/CS/eventlog_writeentry_1_3.cs#3)]
 [!code-vb[EventLog_WriteEntry_1_3#3](~/samples/snippets/visualbasic/VS_Snippets_CLR/EventLog_WriteEntry_1_3/VB/eventlog_writeentry_1_3.vb#3)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentException">
          <span data-ttu-id="db667-1276">
            <see cref="P:System.Diagnostics.EventLog.Source" /> 的 <see cref="T:System.Diagnostics.EventLog" /> 属性尚未设置。</span>
          <span class="sxs-lookup">
            <span data-stu-id="db667-1276">The <see cref="P:System.Diagnostics.EventLog.Source" /> property of the <see cref="T:System.Diagnostics.EventLog" /> has not been set.</span>
          </span>
          <span data-ttu-id="db667-1277">或</span>
          <span class="sxs-lookup">
            <span data-stu-id="db667-1277">-or-</span>
          </span>
          <span data-ttu-id="db667-1278">该方法尝试注册新的事件源，但 <see cref="P:System.Diagnostics.EventLog.MachineName" /> 中的计算机名称无效。</span>
          <span class="sxs-lookup">
            <span data-stu-id="db667-1278">The method attempted to register a new event source, but the computer name in <see cref="P:System.Diagnostics.EventLog.MachineName" /> is not valid.</span>
          </span>
          <span data-ttu-id="db667-1279">\- 或 -</span>
          <span class="sxs-lookup">
            <span data-stu-id="db667-1279">\- or -</span>
          </span>
          <span data-ttu-id="db667-1280">已为其他事件日志注册了该源。</span>
          <span class="sxs-lookup">
            <span data-stu-id="db667-1280">The source is already registered for a different event log.</span>
          </span>
          <span data-ttu-id="db667-1281">\- 或 -</span>
          <span class="sxs-lookup">
            <span data-stu-id="db667-1281">\- or -</span>
          </span>
          <span data-ttu-id="db667-1282">
            <paramref name="eventID" /> 小于零或大于 <see cref="F:System.UInt16.MaxValue" />。</span>
          <span class="sxs-lookup">
            <span data-stu-id="db667-1282">
              <paramref name="eventID" /> is less than zero or greater than <see cref="F:System.UInt16.MaxValue" />.</span>
          </span>
          <span data-ttu-id="db667-1283">\- 或 -</span>
          <span class="sxs-lookup">
            <span data-stu-id="db667-1283">\- or -</span>
          </span>
          <span data-ttu-id="db667-1284">消息字符串长于 31,839 字节（在 Windows Vista 之前，在 Windows 操作系统上为 32,766 字节)。</span>
          <span class="sxs-lookup">
            <span data-stu-id="db667-1284">The message string is longer than 31,839 bytes (32,766 bytes on Windows operating systems before Windows Vista).</span>
          </span>
          <span data-ttu-id="db667-1285">\- 或 -</span>
          <span class="sxs-lookup">
            <span data-stu-id="db667-1285">\- or -</span>
          </span>
          <span data-ttu-id="db667-1286">此源名称导致注册表项路径的长度超过 254 个字符。</span>
          <span class="sxs-lookup">
            <span data-stu-id="db667-1286">The source name results in a registry key path longer than 254 characters.</span>
          </span>
        </exception>
        <exception cref="T:System.InvalidOperationException">
          <span data-ttu-id="db667-1287">事件日志的注册表项未能打开。</span>
          <span class="sxs-lookup">
            <span data-stu-id="db667-1287">The registry key for the event log could not be opened.</span>
          </span>
        </exception>
        <exception cref="T:System.ComponentModel.InvalidEnumArgumentException">
          <span data-ttu-id="db667-1288">
            <paramref name="type" /> 不是有效的 <see cref="T:System.Diagnostics.EventLogEntryType" />。</span>
          <span class="sxs-lookup">
            <span data-stu-id="db667-1288">
              <paramref name="type" /> is not a valid <see cref="T:System.Diagnostics.EventLogEntryType" />.</span>
          </span>
        </exception>
        <exception cref="T:System.ComponentModel.Win32Exception">
          <span data-ttu-id="db667-1289">将事件项写入事件日志时，操作系统报告了一个错误。</span>
          <span class="sxs-lookup">
            <span data-stu-id="db667-1289">The operating system reported an error when writing the event entry to the event log.</span>
          </span>
          <span data-ttu-id="db667-1290">一个 Windows 错误代码不可用。</span>
          <span class="sxs-lookup">
            <span data-stu-id="db667-1290">A Windows error code is not available.</span>
          </span>
        </exception>
        <permission cref="T:System.Diagnostics.EventLogPermission">
          <span data-ttu-id="db667-1291">用于写入的计算机上的事件日志信息。</span>
          <span class="sxs-lookup">
            <span data-stu-id="db667-1291">for writing the event log information on the computer.</span>
          </span>
          <span data-ttu-id="db667-1292">关联的枚举： <see cref="F:System.Diagnostics.EventLogPermissionAccess.Write" /></span>
          <span class="sxs-lookup">
            <span data-stu-id="db667-1292">Associated enumeration: <see cref="F:System.Diagnostics.EventLogPermissionAccess.Write" /></span>
          </span>
        </permission>
        <altmember cref="T:System.Diagnostics.EventLogEntryType" />
        <altmember cref="P:System.Diagnostics.EventLog.Source" />
        <altmember cref="Overload:System.Diagnostics.EventLog.CreateEventSource" />
        <altmember cref="M:System.Diagnostics.EventLog.DeleteEventSource(System.String)" />
        <altmember cref="M:System.Diagnostics.EventLog.SourceExists(System.String)" />
        <altmember cref="P:System.Diagnostics.EventLog.Entries" />
      </Docs>
    </Member>
    <Member MemberName="WriteEntry">
      <MemberSignature Language="C#" Value="public static void WriteEntry (string source, string message, System.Diagnostics.EventLogEntryType type, int eventID);" />
      <MemberSignature Language="ILAsm" Value=".method public static hidebysig void WriteEntry(string source, string message, valuetype System.Diagnostics.EventLogEntryType type, int32 eventID) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Diagnostics.EventLog.WriteEntry(System.String,System.String,System.Diagnostics.EventLogEntryType,System.Int32)" />
      <MemberSignature Language="VB.NET" Value="Public Shared Sub WriteEntry (source As String, message As String, type As EventLogEntryType, eventID As Integer)" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; static void WriteEntry(System::String ^ source, System::String ^ message, System::Diagnostics::EventLogEntryType type, int eventID);" />
      <MemberSignature Language="F#" Value="static member WriteEntry : string * string * System.Diagnostics.EventLogEntryType * int -&gt; unit" Usage="System.Diagnostics.EventLog.WriteEntry (source, message, type, eventID)" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System</AssemblyName>
        <AssemblyVersion>1.0.5000.0</AssemblyVersion>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Attributes>
        <Attribute FrameworkAlternate="netframework-4.0">
          <AttributeName>System.Runtime.TargetedPatchingOptOut("Performance critical to inline this type of method across NGen image boundaries")</AttributeName>
        </Attribute>
      </Attributes>
      <ReturnValue>
        <ReturnType>System.Void</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="source" Type="System.String" />
        <Parameter Name="message" Type="System.String" />
        <Parameter Name="type" Type="System.Diagnostics.EventLogEntryType" />
        <Parameter Name="eventID" Type="System.Int32" />
      </Parameters>
      <Docs>
        <param name="source">
          <span data-ttu-id="db667-1293">应用程序在指定计算机上注册时所采用的源。</span>
          <span class="sxs-lookup">
            <span data-stu-id="db667-1293">The source by which the application is registered on the specified computer.</span>
          </span>
        </param>
        <param name="message">
          <span data-ttu-id="db667-1294">要写入事件日志的字符串。</span>
          <span class="sxs-lookup">
            <span data-stu-id="db667-1294">The string to write to the event log.</span>
          </span>
        </param>
        <param name="type">
          <span data-ttu-id="db667-1295">
            <see cref="T:System.Diagnostics.EventLogEntryType" /> 值之一。</span>
          <span class="sxs-lookup">
            <span data-stu-id="db667-1295">One of the <see cref="T:System.Diagnostics.EventLogEntryType" /> values.</span>
          </span>
        </param>
        <param name="eventID">
          <span data-ttu-id="db667-1296">事件的应用程序特定标识符。</span>
          <span class="sxs-lookup">
            <span data-stu-id="db667-1296">The application-specific identifier for the event.</span>
          </span>
        </param>
        <summary>
          <span data-ttu-id="db667-1297">使用指定的注册事件源，将一个具有给定消息文本和应用程序定义的事件标识符的项写入事件日志。</span>
          <span class="sxs-lookup">
            <span data-stu-id="db667-1297">Writes an entry with the given message text and application-defined event identifier to the event log, using the specified registered event source.</span>
          </span>
        </summary>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="db667-1298">使用此方法来编写一个包含应用程序定义的项`eventID`到事件日志中，将源使用已注册为相应的日志的事件源。</span><span class="sxs-lookup"><span data-stu-id="db667-1298">Use this method to write an entry with an application-defined `eventID` to the event log, using a source already registered as an event source for the appropriate log.</span></span> <span data-ttu-id="db667-1299">`eventID`，以及源代码，唯一标识事件。</span><span class="sxs-lookup"><span data-stu-id="db667-1299">The `eventID`, along with the source, uniquely identify an event.</span></span> <span data-ttu-id="db667-1300">每个应用程序可以定义其自身带编号的事件以及它们映射到其中的描述字符串。</span><span class="sxs-lookup"><span data-stu-id="db667-1300">Each application can define its own numbered events and the description strings to which they map.</span></span> <span data-ttu-id="db667-1301">事件查看器呈现给用户以帮助用户了解发生的问题并建议要采取的操作这些字符串。</span><span class="sxs-lookup"><span data-stu-id="db667-1301">Event viewers present these strings to the user to help the user understand what went wrong and suggest what actions to take.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="db667-1302">`message`字符串不能包含 %*n*，其中*n*是一个整数值 (例如，%1)，因为事件查看器将其视为插入字符串。</span><span class="sxs-lookup"><span data-stu-id="db667-1302">The `message` string cannot contain %*n*, where *n* is an integer value (for example, %1), because the event viewer treats it as an insertion string.</span></span> <span data-ttu-id="db667-1303">Internet 协议版本 6 (IPv6) 地址可以包含此字符序列，因为无法记录事件消息包含 IPv6 地址。</span><span class="sxs-lookup"><span data-stu-id="db667-1303">Because an Internet Protocol, version 6 (IPv6) address can contain this character sequence, you cannot log an event message that contains an IPv6 address.</span></span>  
  
 <span data-ttu-id="db667-1304">除了事件标识符的此重载还<xref:System.Diagnostics.EventLog.WriteEntry%2A>允许您指定<xref:System.Diagnostics.EventLogEntryType>为写入到事件日志的事件。</span><span class="sxs-lookup"><span data-stu-id="db667-1304">In addition to the event identifier, this overload of <xref:System.Diagnostics.EventLog.WriteEntry%2A> lets you specify an <xref:System.Diagnostics.EventLogEntryType> for the event being written to the event log.</span></span> <span data-ttu-id="db667-1305">`type`由一个图标和日志的事件查看器中的类型列中的文本指示。</span><span class="sxs-lookup"><span data-stu-id="db667-1305">The `type` is indicated by an icon and text in the Type column in the Event Viewer for a log.</span></span> <span data-ttu-id="db667-1306">此参数指示的事件类型是否为错误、 警告、 信息、 成功审核或失败审核。</span><span class="sxs-lookup"><span data-stu-id="db667-1306">This parameter indicates whether the event type is error, warning, information, success audit, or failure audit.</span></span>  
  
 <span data-ttu-id="db667-1307">必须创建并写入与源的第一项之前配置的事件源。</span><span class="sxs-lookup"><span data-stu-id="db667-1307">You must create and configure the event source before writing the first entry with the source.</span></span> <span data-ttu-id="db667-1308">在应用程序的安装过程中创建新的事件源。</span><span class="sxs-lookup"><span data-stu-id="db667-1308">Create the new event source during the installation of your application.</span></span> <span data-ttu-id="db667-1309">这允许操作系统以刷新其注册的事件源的列表和其配置的时间。</span><span class="sxs-lookup"><span data-stu-id="db667-1309">This allows time for the operating system to refresh its list of registered event sources and their configuration.</span></span> <span data-ttu-id="db667-1310">如果操作系统没有刷新其事件源的列表，并且尝试写入新的源的事件写入操作将失败。</span><span class="sxs-lookup"><span data-stu-id="db667-1310">If the operating system has not refreshed its list of event sources, and you attempt to write an event with the new source, the write operation will fail.</span></span> <span data-ttu-id="db667-1311">可以配置新的源使用<xref:System.Diagnostics.EventLogInstaller>，或使用<xref:System.Diagnostics.EventLog.CreateEventSource%2A>方法。</span><span class="sxs-lookup"><span data-stu-id="db667-1311">You can configure a new source using an <xref:System.Diagnostics.EventLogInstaller>, or using the <xref:System.Diagnostics.EventLog.CreateEventSource%2A> method.</span></span> <span data-ttu-id="db667-1312">若要创建新的事件源的计算机上，必须具有管理权限。</span><span class="sxs-lookup"><span data-stu-id="db667-1312">You must have administrative rights on the computer to create a new event source.</span></span>  
  
 <span data-ttu-id="db667-1313">要写入本地化的项还是要直接写入字符串，必须配置源。</span><span class="sxs-lookup"><span data-stu-id="db667-1313">The source must be configured either for writing localized entries or for writing direct strings.</span></span> <span data-ttu-id="db667-1314"><xref:System.Diagnostics.EventLog.WriteEntry%2A>方法直接写入事件日志写入给定的字符串; 它不使用可本地化的消息资源文件。</span><span class="sxs-lookup"><span data-stu-id="db667-1314">The <xref:System.Diagnostics.EventLog.WriteEntry%2A> method writes the given string directly to the event log; it does not use a localizable message resource file.</span></span> <span data-ttu-id="db667-1315">使用<xref:System.Diagnostics.EventLog.WriteEvent%2A>方法来写入事件时使用的本地化的消息资源文件。</span><span class="sxs-lookup"><span data-stu-id="db667-1315">Use the <xref:System.Diagnostics.EventLog.WriteEvent%2A> method to write events using a localized message resource file.</span></span>  
  
 <span data-ttu-id="db667-1316">如果你的应用程序将使用资源标识符和字符串值的条目写入，则必须注册两个单独的源。</span><span class="sxs-lookup"><span data-stu-id="db667-1316">If your application writes entries using both resource identifiers and string values, you must register two separate sources.</span></span> <span data-ttu-id="db667-1317">例如，配置一个源的资源文件，以及如何将该源中的<xref:System.Diagnostics.EventLog.WriteEvent%2A>方法来编写使用资源标识符添加到事件日志条目。</span><span class="sxs-lookup"><span data-stu-id="db667-1317">For example, configure one source with resource files, and then use that source in the <xref:System.Diagnostics.EventLog.WriteEvent%2A> method to write entries using resource identifiers to the event log.</span></span> <span data-ttu-id="db667-1318">然后创建不同的源，而无需资源文件，并使用在该源<xref:System.Diagnostics.EventLog.WriteEntry%2A>方法将字符串直接写入事件日志使用的源。</span><span class="sxs-lookup"><span data-stu-id="db667-1318">Then create a different source without resource files, and use that source in the <xref:System.Diagnostics.EventLog.WriteEntry%2A> method to write strings directly to the event log using that source.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="db667-1319">如果`message`参数包含 NUL 字符，则在 NUL 字符处终止事件日志中的消息。</span><span class="sxs-lookup"><span data-stu-id="db667-1319">If the `message` parameter contains a NUL character, the message in the event log is terminated at the NUL character.</span></span>  
  
   
  
## Examples  
 [!code-cpp[EventLog_WriteEntry_4#1](~/samples/snippets/cpp/VS_Snippets_CLR/EventLog_WriteEntry_4/CPP/eventlog_writeentry_4.cpp#1)]
 [!code-csharp[EventLog_WriteEntry_4#1](~/samples/snippets/csharp/VS_Snippets_CLR/EventLog_WriteEntry_4/CS/eventlog_writeentry_4.cs#1)]
 [!code-vb[EventLog_WriteEntry_4#1](~/samples/snippets/visualbasic/VS_Snippets_CLR/EventLog_WriteEntry_4/VB/eventlog_writeentry_4.vb#1)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentException">
          <span data-ttu-id="db667-1320">
            <paramref name="source" /> 值是空字符串 ("")。</span>
          <span class="sxs-lookup">
            <span data-stu-id="db667-1320">The <paramref name="source" /> value is an empty string ("").</span>
          </span>
          <span data-ttu-id="db667-1321">\- 或 -</span>
          <span class="sxs-lookup">
            <span data-stu-id="db667-1321">\- or -</span>
          </span>
          <span data-ttu-id="db667-1322">
            <paramref name="source" /> 值为 <see langword="null" />。</span>
          <span class="sxs-lookup">
            <span data-stu-id="db667-1322">The <paramref name="source" /> value is <see langword="null" />.</span>
          </span>
          <span data-ttu-id="db667-1323">\- 或 -</span>
          <span class="sxs-lookup">
            <span data-stu-id="db667-1323">\- or -</span>
          </span>
          <span data-ttu-id="db667-1324">
            <paramref name="eventID" /> 小于零或大于 <see cref="F:System.UInt16.MaxValue" />。</span>
          <span class="sxs-lookup">
            <span data-stu-id="db667-1324">
              <paramref name="eventID" /> is less than zero or greater than <see cref="F:System.UInt16.MaxValue" />.</span>
          </span>
          <span data-ttu-id="db667-1325">\- 或 -</span>
          <span class="sxs-lookup">
            <span data-stu-id="db667-1325">\- or -</span>
          </span>
          <span data-ttu-id="db667-1326">消息字符串长于 31,839 字节（在 Windows Vista 之前，在 Windows 操作系统上为 32,766 字节)。</span>
          <span class="sxs-lookup">
            <span data-stu-id="db667-1326">The message string is longer than 31,839 bytes (32,766 bytes on Windows operating systems before Windows Vista).</span>
          </span>
          <span data-ttu-id="db667-1327">\- 或 -</span>
          <span class="sxs-lookup">
            <span data-stu-id="db667-1327">\- or -</span>
          </span>
          <span data-ttu-id="db667-1328">此源名称导致注册表项路径的长度超过 254 个字符。</span>
          <span class="sxs-lookup">
            <span data-stu-id="db667-1328">The source name results in a registry key path longer than 254 characters.</span>
          </span>
        </exception>
        <exception cref="T:System.InvalidOperationException">
          <span data-ttu-id="db667-1329">事件日志的注册表项未能打开。</span>
          <span class="sxs-lookup">
            <span data-stu-id="db667-1329">The registry key for the event log could not be opened.</span>
          </span>
        </exception>
        <exception cref="T:System.ComponentModel.InvalidEnumArgumentException">
          <span data-ttu-id="db667-1330">
            <paramref name="type" /> 不是有效的 <see cref="T:System.Diagnostics.EventLogEntryType" />。</span>
          <span class="sxs-lookup">
            <span data-stu-id="db667-1330">
              <paramref name="type" /> is not a valid <see cref="T:System.Diagnostics.EventLogEntryType" />.</span>
          </span>
        </exception>
        <exception cref="T:System.ComponentModel.Win32Exception">
          <span data-ttu-id="db667-1331">将事件项写入事件日志时，操作系统报告了一个错误。</span>
          <span class="sxs-lookup">
            <span data-stu-id="db667-1331">The operating system reported an error when writing the event entry to the event log.</span>
          </span>
          <span data-ttu-id="db667-1332">一个 Windows 错误代码不可用。</span>
          <span class="sxs-lookup">
            <span data-stu-id="db667-1332">A Windows error code is not available.</span>
          </span>
        </exception>
        <permission cref="T:System.Diagnostics.EventLogPermission">
          <span data-ttu-id="db667-1333">用于写入的计算机上的事件日志信息。</span>
          <span class="sxs-lookup">
            <span data-stu-id="db667-1333">for writing the event log information on the computer.</span>
          </span>
          <span data-ttu-id="db667-1334">关联的枚举： <see cref="F:System.Diagnostics.EventLogPermissionAccess.Write" /></span>
          <span class="sxs-lookup">
            <span data-stu-id="db667-1334">Associated enumeration: <see cref="F:System.Diagnostics.EventLogPermissionAccess.Write" /></span>
          </span>
        </permission>
        <altmember cref="T:System.Diagnostics.EventLogEntryType" />
        <altmember cref="P:System.Diagnostics.EventLog.Source" />
        <altmember cref="Overload:System.Diagnostics.EventLog.CreateEventSource" />
        <altmember cref="M:System.Diagnostics.EventLog.DeleteEventSource(System.String)" />
        <altmember cref="M:System.Diagnostics.EventLog.SourceExists(System.String)" />
        <altmember cref="P:System.Diagnostics.EventLog.Entries" />
      </Docs>
    </Member>
    <Member MemberName="WriteEntry">
      <MemberSignature Language="C#" Value="public void WriteEntry (string message, System.Diagnostics.EventLogEntryType type, int eventID, short category, byte[] rawData);" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig instance void WriteEntry(string message, valuetype System.Diagnostics.EventLogEntryType type, int32 eventID, int16 category, unsigned int8[] rawData) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Diagnostics.EventLog.WriteEntry(System.String,System.Diagnostics.EventLogEntryType,System.Int32,System.Int16,System.Byte[])" />
      <MemberSignature Language="VB.NET" Value="Public Sub WriteEntry (message As String, type As EventLogEntryType, eventID As Integer, category As Short, rawData As Byte())" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; void WriteEntry(System::String ^ message, System::Diagnostics::EventLogEntryType type, int eventID, short category, cli::array &lt;System::Byte&gt; ^ rawData);" />
      <MemberSignature Language="F#" Value="member this.WriteEntry : string * System.Diagnostics.EventLogEntryType * int * int16 * byte[] -&gt; unit" Usage="eventLog.WriteEntry (message, type, eventID, category, rawData)" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System</AssemblyName>
        <AssemblyVersion>1.0.5000.0</AssemblyVersion>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Void</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="message" Type="System.String" />
        <Parameter Name="type" Type="System.Diagnostics.EventLogEntryType" />
        <Parameter Name="eventID" Type="System.Int32" />
        <Parameter Name="category" Type="System.Int16" />
        <Parameter Name="rawData" Type="System.Byte[]" />
      </Parameters>
      <Docs>
        <param name="message">
          <span data-ttu-id="db667-1335">要写入事件日志的字符串。</span>
          <span class="sxs-lookup">
            <span data-stu-id="db667-1335">The string to write to the event log.</span>
          </span>
        </param>
        <param name="type">
          <span data-ttu-id="db667-1336">
            <see cref="T:System.Diagnostics.EventLogEntryType" /> 值之一。</span>
          <span class="sxs-lookup">
            <span data-stu-id="db667-1336">One of the <see cref="T:System.Diagnostics.EventLogEntryType" /> values.</span>
          </span>
        </param>
        <param name="eventID">
          <span data-ttu-id="db667-1337">事件的应用程序特定标识符。</span>
          <span class="sxs-lookup">
            <span data-stu-id="db667-1337">The application-specific identifier for the event.</span>
          </span>
        </param>
        <param name="category">
          <span data-ttu-id="db667-1338">与消息关联的应用程序特定子类别。</span>
          <span class="sxs-lookup">
            <span data-stu-id="db667-1338">The application-specific subcategory associated with the message.</span>
          </span>
        </param>
        <param name="rawData">
          <span data-ttu-id="db667-1339">包含与此项关联的二进制数据的字节数组。</span>
          <span class="sxs-lookup">
            <span data-stu-id="db667-1339">An array of bytes that holds the binary data associated with the entry.</span>
          </span>
        </param>
        <summary>
          <span data-ttu-id="db667-1340">将一个具有给定消息文本、应用程序定义的事件标识符和应用程序定义的类别的项写入事件日志，并向消息追加二进制数据。</span>
          <span class="sxs-lookup">
            <span data-stu-id="db667-1340">Writes an entry with the given message text, application-defined event identifier, and application-defined category to the event log, and appends binary data to the message.</span>
          </span>
        </summary>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="db667-1341">使用此重载将应用程序定义特定于事件的数据写入事件日志。</span><span class="sxs-lookup"><span data-stu-id="db667-1341">Use this overload to write application-defined event-specific data to the event log.</span></span> <span data-ttu-id="db667-1342">事件查看器不解释该数据。它仅采用组合的十六进制转义序列和文本格式显示原始数据。</span><span class="sxs-lookup"><span data-stu-id="db667-1342">The Event Viewer does not interpret this data; it displays raw data only in a combined hexadecimal and text format.</span></span> <span data-ttu-id="db667-1343">请慎用特定于事件的数据，包括它仅当你确信将很有用的某个人可以解决此问题。</span><span class="sxs-lookup"><span data-stu-id="db667-1343">Use event-specific data sparingly, including it only if you are sure it will be useful to someone debugging the problem.</span></span> <span data-ttu-id="db667-1344">特定于事件的数据还可用于存储应用程序可以处理独立于事件查看器的信息。</span><span class="sxs-lookup"><span data-stu-id="db667-1344">You can also use event-specific data to store information the application can process independently of the Event Viewer.</span></span> <span data-ttu-id="db667-1345">例如，可以专门为您的活动，编写一个查看器或编写一个程序来扫描日志文件并创建报告，包括来自特定于事件的数据的信息。</span><span class="sxs-lookup"><span data-stu-id="db667-1345">For example, you could write a viewer specifically for your events, or write a program that scans the logfile and creates reports that include information from the event-specific data.</span></span>  
  
 <span data-ttu-id="db667-1346">除了二进制数据，还可以指定应用程序定义的类别和应用程序定义的事件标识符。</span><span class="sxs-lookup"><span data-stu-id="db667-1346">In addition to the binary data, you can specify an application-defined category and an application-defined event identifier.</span></span> <span data-ttu-id="db667-1347">事件查看器使用的类别的事件源写入筛选器事件。</span><span class="sxs-lookup"><span data-stu-id="db667-1347">The Event Viewer uses the category to filter events written by an event source.</span></span> <span data-ttu-id="db667-1348">事件查看器可以将类别显示为数字值，或者它可以作为资源标识符使用类别来显示本地化的类别字符串。</span><span class="sxs-lookup"><span data-stu-id="db667-1348">The Event Viewer can display the category as a numeric value, or it can use the category as a resource identifier to display a localized category string.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="db667-1349">`message`字符串不能包含 %*n*，其中*n*是一个整数值 (例如，%1)，因为事件查看器将其视为插入字符串。</span><span class="sxs-lookup"><span data-stu-id="db667-1349">The `message` string cannot contain %*n*, where *n* is an integer value (for example, %1), because the event viewer treats it as an insertion string.</span></span> <span data-ttu-id="db667-1350">Internet 协议版本 6 (IPv6) 地址可以包含此字符序列，因为无法记录事件消息包含 IPv6 地址。</span><span class="sxs-lookup"><span data-stu-id="db667-1350">Because an Internet Protocol, version 6 (IPv6) address can contain this character sequence, you cannot log an event message that contains an IPv6 address.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="db667-1351">`category`参数应为正值。</span><span class="sxs-lookup"><span data-stu-id="db667-1351">The `category` parameter should be a positive value.</span></span> <span data-ttu-id="db667-1352">负类别值显示为互为补充的正数值在事件查看器。</span><span class="sxs-lookup"><span data-stu-id="db667-1352">Negative category values appear as a complementary positive number in the Event Viewer.</span></span> <span data-ttu-id="db667-1353">例如，– 10 显示为 65526，65535 为 – 1。</span><span class="sxs-lookup"><span data-stu-id="db667-1353">For example, a –10 appears as 65,526, a –1 as 65,535.</span></span>  
  
 <span data-ttu-id="db667-1354">若要在事件查看器中显示本地化的类别字符串，必须使用事件源的类别资源文件后，配置和设置`category`类别资源文件中的资源标识符。</span><span class="sxs-lookup"><span data-stu-id="db667-1354">To display localized category strings in the Event Viewer, you must use an event source configured with a category resource file, and set the `category` to a resource identifier in the category resource file.</span></span> <span data-ttu-id="db667-1355">如果事件源没有配置的类别资源文件，或指定`category`没有索引的字符串中的类别资源文件，则在事件查看器将显示该条目的数字型类别值。</span><span class="sxs-lookup"><span data-stu-id="db667-1355">If the event source does not have a configured category resource file, or the specified `category` does not index a string in the category resource file, then the Event Viewer displays the numeric category value for that entry.</span></span> <span data-ttu-id="db667-1356">配置类别资源文件，以及数量的资源文件中的类别字符串使用<xref:System.Diagnostics.EventLogInstaller>或<xref:System.Diagnostics.EventSourceCreationData>类。</span><span class="sxs-lookup"><span data-stu-id="db667-1356">Configure the category resource file, along with the number of category strings in the resource file, using the <xref:System.Diagnostics.EventLogInstaller> or the <xref:System.Diagnostics.EventSourceCreationData> class.</span></span>  
  
 <span data-ttu-id="db667-1357">事件标识符的事件源，以及唯一地标识一个事件。</span><span class="sxs-lookup"><span data-stu-id="db667-1357">Event identifiers, along with the event source, uniquely identify an event.</span></span> <span data-ttu-id="db667-1358">每个应用程序可以定义其自身带编号的事件以及它们映射到其中的描述字符串。</span><span class="sxs-lookup"><span data-stu-id="db667-1358">Each application can define its own numbered events and the description strings to which they map.</span></span> <span data-ttu-id="db667-1359">事件查看器显示这些字符串值，以帮助用户了解发生的问题并建议要采取的操作。</span><span class="sxs-lookup"><span data-stu-id="db667-1359">Event viewers display these string values to help the user understand what went wrong and suggest what actions to take.</span></span>  
  
 <span data-ttu-id="db667-1360">最后，可以指定<xref:System.Diagnostics.EventLogEntryType>为写入到事件日志的事件。</span><span class="sxs-lookup"><span data-stu-id="db667-1360">Finally, you can specify an <xref:System.Diagnostics.EventLogEntryType> for the event being written to the event log.</span></span> <span data-ttu-id="db667-1361">`type`由一个图标和日志的事件查看器中的类型列中的文本指示。</span><span class="sxs-lookup"><span data-stu-id="db667-1361">The `type` is indicated by an icon and text in the Type column in the Event Viewer for a log.</span></span> <span data-ttu-id="db667-1362">此参数指示的事件类型是否为错误、 警告、 信息、 成功审核或失败审核。</span><span class="sxs-lookup"><span data-stu-id="db667-1362">This parameter indicates whether the event type is error, warning, information, success audit, or failure audit.</span></span>  
  
 <span data-ttu-id="db667-1363">必须设置<xref:System.Diagnostics.EventLog.Source%2A>上的属性在<xref:System.Diagnostics.EventLog>组件之前可以向日志写入条目。</span><span class="sxs-lookup"><span data-stu-id="db667-1363">You must set the <xref:System.Diagnostics.EventLog.Source%2A> property on your <xref:System.Diagnostics.EventLog> component before you can write entries to the log.</span></span> <span data-ttu-id="db667-1364">必须创建并写入与源的第一项之前配置的事件源。</span><span class="sxs-lookup"><span data-stu-id="db667-1364">You must create and configure the event source before writing the first entry with the source.</span></span>  
  
 <span data-ttu-id="db667-1365">在应用程序的安装过程中创建新的事件源。</span><span class="sxs-lookup"><span data-stu-id="db667-1365">Create the new event source during the installation of your application.</span></span> <span data-ttu-id="db667-1366">这允许操作系统以刷新其注册的事件源的列表和其配置的时间。</span><span class="sxs-lookup"><span data-stu-id="db667-1366">This allows time for the operating system to refresh its list of registered event sources and their configuration.</span></span> <span data-ttu-id="db667-1367">如果操作系统没有刷新其事件源的列表，并且尝试写入新的源的事件写入操作将失败。</span><span class="sxs-lookup"><span data-stu-id="db667-1367">If the operating system has not refreshed its list of event sources, and you attempt to write an event with the new source, the write operation will fail.</span></span> <span data-ttu-id="db667-1368">可以配置新的源使用<xref:System.Diagnostics.EventLogInstaller>，或使用<xref:System.Diagnostics.EventLog.CreateEventSource%2A>方法。</span><span class="sxs-lookup"><span data-stu-id="db667-1368">You can configure a new source using an <xref:System.Diagnostics.EventLogInstaller>, or using the <xref:System.Diagnostics.EventLog.CreateEventSource%2A> method.</span></span> <span data-ttu-id="db667-1369">若要创建新的事件源的计算机上，必须具有管理权限。</span><span class="sxs-lookup"><span data-stu-id="db667-1369">You must have administrative rights on the computer to create a new event source.</span></span>  
  
 <span data-ttu-id="db667-1370">如果在指定的源<xref:System.Diagnostics.EventLog.Source%2A>属性的这<xref:System.Diagnostics.EventLog>写入你的组件，在计算机上不注册实例<xref:System.Diagnostics.EventLog.WriteEntry%2A>调用<xref:System.Diagnostics.EventLog.CreateEventSource%2A>和注册源。</span><span class="sxs-lookup"><span data-stu-id="db667-1370">If the source specified in the <xref:System.Diagnostics.EventLog.Source%2A> property of this <xref:System.Diagnostics.EventLog> instance is not registered on the computer that your component is writing to, <xref:System.Diagnostics.EventLog.WriteEntry%2A> calls <xref:System.Diagnostics.EventLog.CreateEventSource%2A> and registers the source.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="db667-1371">如果未指定<xref:System.Diagnostics.EventLog.MachineName%2A>为你<xref:System.Diagnostics.EventLog>实例在调用之前<xref:System.Diagnostics.EventLog.CreateEventSource%2A>或<xref:System.Diagnostics.EventLog.WriteEntry%2A>，本地计算机 ("。") 假定。</span><span class="sxs-lookup"><span data-stu-id="db667-1371">If you do not specify a <xref:System.Diagnostics.EventLog.MachineName%2A> for your <xref:System.Diagnostics.EventLog> instance before you call <xref:System.Diagnostics.EventLog.CreateEventSource%2A> or <xref:System.Diagnostics.EventLog.WriteEntry%2A>, the local computer (".") is assumed.</span></span>  
  
 <span data-ttu-id="db667-1372">如果系统需要注册<xref:System.Diagnostics.EventLog.Source%2A>通过调用<xref:System.Diagnostics.EventLog.WriteEntry%2A>并<xref:System.Diagnostics.EventLog.Log%2A>不上设置属性在<xref:System.Diagnostics.EventLog>实例，默认为应用程序日志的日志。</span><span class="sxs-lookup"><span data-stu-id="db667-1372">If the system needs to register the <xref:System.Diagnostics.EventLog.Source%2A> through a call to <xref:System.Diagnostics.EventLog.WriteEntry%2A> and the <xref:System.Diagnostics.EventLog.Log%2A> property has not been set on your <xref:System.Diagnostics.EventLog> instance, the log defaults to the Application log.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="db667-1373">上面列出的许多异常都由错误的注册过程中引发<xref:System.Diagnostics.EventLog.Source%2A>。</span><span class="sxs-lookup"><span data-stu-id="db667-1373">Many exceptions listed above are generated by errors raised during the process of registering the <xref:System.Diagnostics.EventLog.Source%2A>.</span></span>  
  
 <span data-ttu-id="db667-1374">要写入本地化的项还是要直接写入字符串，必须配置源。</span><span class="sxs-lookup"><span data-stu-id="db667-1374">The source must be configured either for writing localized entries or for writing direct strings.</span></span> <span data-ttu-id="db667-1375"><xref:System.Diagnostics.EventLog.WriteEntry%2A>方法直接写入事件日志写入给定的字符串; 它不使用可本地化的消息资源文件。</span><span class="sxs-lookup"><span data-stu-id="db667-1375">The <xref:System.Diagnostics.EventLog.WriteEntry%2A> method writes the given string directly to the event log; it does not use a localizable message resource file.</span></span> <span data-ttu-id="db667-1376">使用<xref:System.Diagnostics.EventLog.WriteEvent%2A>方法来写入事件时使用的本地化的消息资源文件。</span><span class="sxs-lookup"><span data-stu-id="db667-1376">Use the <xref:System.Diagnostics.EventLog.WriteEvent%2A> method to write events using a localized message resource file.</span></span>  
  
 <span data-ttu-id="db667-1377">如果你的应用程序将使用资源标识符和字符串值的条目写入，则必须注册两个单独的源。</span><span class="sxs-lookup"><span data-stu-id="db667-1377">If your application writes entries using both resource identifiers and string values, you must register two separate sources.</span></span> <span data-ttu-id="db667-1378">例如，配置一个源的资源文件，以及如何将该源中的<xref:System.Diagnostics.EventLog.WriteEvent%2A>方法来编写使用资源标识符添加到事件日志条目。</span><span class="sxs-lookup"><span data-stu-id="db667-1378">For example, configure one source with resource files, and then use that source in the <xref:System.Diagnostics.EventLog.WriteEvent%2A> method to write entries using resource identifiers to the event log.</span></span> <span data-ttu-id="db667-1379">然后创建不同的源，而无需资源文件，并使用在该源<xref:System.Diagnostics.EventLog.WriteEntry%2A>方法将字符串直接写入事件日志使用的源。</span><span class="sxs-lookup"><span data-stu-id="db667-1379">Then create a different source without resource files, and use that source in the <xref:System.Diagnostics.EventLog.WriteEntry%2A> method to write strings directly to the event log using that source.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="db667-1380">如果远程计算机中写入一个条目，消息 （文本字符串） 的值可能不是预期如果远程计算机未运行.NET Framework。</span><span class="sxs-lookup"><span data-stu-id="db667-1380">If you write an entry to a remote computer, the value of the message (the text string) might not be what you expect if the remote computer is not running the .NET Framework.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="db667-1381">如果`message`参数包含 NUL 字符，则在 NUL 字符处终止事件日志中的消息。</span><span class="sxs-lookup"><span data-stu-id="db667-1381">If the `message` parameter contains a NUL character, the message in the event log is terminated at the NUL character.</span></span>  
  
   
  
## Examples  
 [!code-cpp[EventLog_WriteEntry_5#1](~/samples/snippets/cpp/VS_Snippets_CLR/EventLog_WriteEntry_5/CPP/eventlog_writeentry_5.cpp#1)]
 [!code-csharp[EventLog_WriteEntry_5#1](~/samples/snippets/csharp/VS_Snippets_CLR/EventLog_WriteEntry_5/CS/eventlog_writeentry_5.cs#1)]
 [!code-vb[EventLog_WriteEntry_5#1](~/samples/snippets/visualbasic/VS_Snippets_CLR/EventLog_WriteEntry_5/VB/eventlog_writeentry_5.vb#1)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentException">
          <span data-ttu-id="db667-1382">
            <see cref="P:System.Diagnostics.EventLog.Source" /> 的 <see cref="T:System.Diagnostics.EventLog" /> 属性尚未设置。</span>
          <span class="sxs-lookup">
            <span data-stu-id="db667-1382">The <see cref="P:System.Diagnostics.EventLog.Source" /> property of the <see cref="T:System.Diagnostics.EventLog" /> has not been set.</span>
          </span>
          <span data-ttu-id="db667-1383">或</span>
          <span class="sxs-lookup">
            <span data-stu-id="db667-1383">-or-</span>
          </span>
          <span data-ttu-id="db667-1384">该方法尝试注册新的事件源，但 <see cref="P:System.Diagnostics.EventLog.MachineName" /> 中的计算机名称无效。</span>
          <span class="sxs-lookup">
            <span data-stu-id="db667-1384">The method attempted to register a new event source, but the computer name in <see cref="P:System.Diagnostics.EventLog.MachineName" /> is not valid.</span>
          </span>
          <span data-ttu-id="db667-1385">\- 或 -</span>
          <span class="sxs-lookup">
            <span data-stu-id="db667-1385">\- or -</span>
          </span>
          <span data-ttu-id="db667-1386">已为其他事件日志注册了该源。</span>
          <span class="sxs-lookup">
            <span data-stu-id="db667-1386">The source is already registered for a different event log.</span>
          </span>
          <span data-ttu-id="db667-1387">\- 或 -</span>
          <span class="sxs-lookup">
            <span data-stu-id="db667-1387">\- or -</span>
          </span>
          <span data-ttu-id="db667-1388">
            <paramref name="eventID" /> 小于零或大于 <see cref="F:System.UInt16.MaxValue" />。</span>
          <span class="sxs-lookup">
            <span data-stu-id="db667-1388">
              <paramref name="eventID" /> is less than zero or greater than <see cref="F:System.UInt16.MaxValue" />.</span>
          </span>
          <span data-ttu-id="db667-1389">\- 或 -</span>
          <span class="sxs-lookup">
            <span data-stu-id="db667-1389">\- or -</span>
          </span>
          <span data-ttu-id="db667-1390">消息字符串长于 31,839 字节（在 Windows Vista 之前，在 Windows 操作系统上为 32,766 字节)。</span>
          <span class="sxs-lookup">
            <span data-stu-id="db667-1390">The message string is longer than 31,839 bytes (32,766 bytes on Windows operating systems before Windows Vista).</span>
          </span>
          <span data-ttu-id="db667-1391">\- 或 -</span>
          <span class="sxs-lookup">
            <span data-stu-id="db667-1391">\- or -</span>
          </span>
          <span data-ttu-id="db667-1392">此源名称导致注册表项路径的长度超过 254 个字符。</span>
          <span class="sxs-lookup">
            <span data-stu-id="db667-1392">The source name results in a registry key path longer than 254 characters.</span>
          </span>
        </exception>
        <exception cref="T:System.InvalidOperationException">
          <span data-ttu-id="db667-1393">事件日志的注册表项未能打开。</span>
          <span class="sxs-lookup">
            <span data-stu-id="db667-1393">The registry key for the event log could not be opened.</span>
          </span>
        </exception>
        <exception cref="T:System.ComponentModel.InvalidEnumArgumentException">
          <span data-ttu-id="db667-1394">
            <paramref name="type" /> 不是有效的 <see cref="T:System.Diagnostics.EventLogEntryType" />。</span>
          <span class="sxs-lookup">
            <span data-stu-id="db667-1394">
              <paramref name="type" /> is not a valid <see cref="T:System.Diagnostics.EventLogEntryType" />.</span>
          </span>
        </exception>
        <exception cref="T:System.ComponentModel.Win32Exception">
          <span data-ttu-id="db667-1395">将事件项写入事件日志时，操作系统报告了一个错误。</span>
          <span class="sxs-lookup">
            <span data-stu-id="db667-1395">The operating system reported an error when writing the event entry to the event log.</span>
          </span>
          <span data-ttu-id="db667-1396">一个 Windows 错误代码不可用。</span>
          <span class="sxs-lookup">
            <span data-stu-id="db667-1396">A Windows error code is not available.</span>
          </span>
        </exception>
        <permission cref="T:System.Diagnostics.EventLogPermission">
          <span data-ttu-id="db667-1397">用于写入的计算机上的事件日志信息。</span>
          <span class="sxs-lookup">
            <span data-stu-id="db667-1397">for writing the event log information on the computer.</span>
          </span>
          <span data-ttu-id="db667-1398">关联的枚举： <see cref="F:System.Diagnostics.EventLogPermissionAccess.Write" /></span>
          <span class="sxs-lookup">
            <span data-stu-id="db667-1398">Associated enumeration: <see cref="F:System.Diagnostics.EventLogPermissionAccess.Write" /></span>
          </span>
        </permission>
        <altmember cref="T:System.Diagnostics.EventLogEntryType" />
        <altmember cref="P:System.Diagnostics.EventLog.Source" />
        <altmember cref="Overload:System.Diagnostics.EventLog.CreateEventSource" />
        <altmember cref="M:System.Diagnostics.EventLog.DeleteEventSource(System.String)" />
        <altmember cref="M:System.Diagnostics.EventLog.SourceExists(System.String)" />
        <altmember cref="P:System.Diagnostics.EventLog.Entries" />
      </Docs>
    </Member>
    <Member MemberName="WriteEntry">
      <MemberSignature Language="C#" Value="public static void WriteEntry (string source, string message, System.Diagnostics.EventLogEntryType type, int eventID, short category);" />
      <MemberSignature Language="ILAsm" Value=".method public static hidebysig void WriteEntry(string source, string message, valuetype System.Diagnostics.EventLogEntryType type, int32 eventID, int16 category) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Diagnostics.EventLog.WriteEntry(System.String,System.String,System.Diagnostics.EventLogEntryType,System.Int32,System.Int16)" />
      <MemberSignature Language="VB.NET" Value="Public Shared Sub WriteEntry (source As String, message As String, type As EventLogEntryType, eventID As Integer, category As Short)" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; static void WriteEntry(System::String ^ source, System::String ^ message, System::Diagnostics::EventLogEntryType type, int eventID, short category);" />
      <MemberSignature Language="F#" Value="static member WriteEntry : string * string * System.Diagnostics.EventLogEntryType * int * int16 -&gt; unit" Usage="System.Diagnostics.EventLog.WriteEntry (source, message, type, eventID, category)" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System</AssemblyName>
        <AssemblyVersion>1.0.5000.0</AssemblyVersion>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Attributes>
        <Attribute FrameworkAlternate="netframework-4.0">
          <AttributeName>System.Runtime.TargetedPatchingOptOut("Performance critical to inline this type of method across NGen image boundaries")</AttributeName>
        </Attribute>
      </Attributes>
      <ReturnValue>
        <ReturnType>System.Void</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="source" Type="System.String" />
        <Parameter Name="message" Type="System.String" />
        <Parameter Name="type" Type="System.Diagnostics.EventLogEntryType" />
        <Parameter Name="eventID" Type="System.Int32" />
        <Parameter Name="category" Type="System.Int16" />
      </Parameters>
      <Docs>
        <param name="source">
          <span data-ttu-id="db667-1399">应用程序在指定计算机上注册时所采用的源。</span>
          <span class="sxs-lookup">
            <span data-stu-id="db667-1399">The source by which the application is registered on the specified computer.</span>
          </span>
        </param>
        <param name="message">
          <span data-ttu-id="db667-1400">要写入事件日志的字符串。</span>
          <span class="sxs-lookup">
            <span data-stu-id="db667-1400">The string to write to the event log.</span>
          </span>
        </param>
        <param name="type">
          <span data-ttu-id="db667-1401">
            <see cref="T:System.Diagnostics.EventLogEntryType" /> 值之一。</span>
          <span class="sxs-lookup">
            <span data-stu-id="db667-1401">One of the <see cref="T:System.Diagnostics.EventLogEntryType" /> values.</span>
          </span>
        </param>
        <param name="eventID">
          <span data-ttu-id="db667-1402">事件的应用程序特定标识符。</span>
          <span class="sxs-lookup">
            <span data-stu-id="db667-1402">The application-specific identifier for the event.</span>
          </span>
        </param>
        <param name="category">
          <span data-ttu-id="db667-1403">与消息关联的应用程序特定子类别。</span>
          <span class="sxs-lookup">
            <span data-stu-id="db667-1403">The application-specific subcategory associated with the message.</span>
          </span>
        </param>
        <summary>
          <span data-ttu-id="db667-1404">通过使用指定的注册事件源，将一个具有给定消息文本、应用程序定义的事件标识符和应用程序定义的类别的项写入事件日志。</span>
          <span class="sxs-lookup">
            <span data-stu-id="db667-1404">Writes an entry with the given message text, application-defined event identifier, and application-defined category to the event log, using the specified registered event source.</span>
          </span>
          <span data-ttu-id="db667-1405">事件查看器可使用 <paramref name="category" /> 筛选日志中的事件。</span>
          <span class="sxs-lookup">
            <span data-stu-id="db667-1405">The <paramref name="category" /> can be used by the Event Viewer to filter events in the log.</span>
          </span>
        </summary>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="db667-1406">使用此方法来编写一个包含应用程序定义的项`category`到事件日志中，使用已注册为相应的日志的事件源的源。</span><span class="sxs-lookup"><span data-stu-id="db667-1406">Use this method to write an entry with an application-defined `category` to the event log, using a source that is already registered as an event source for the appropriate log.</span></span> <span data-ttu-id="db667-1407">事件查看器使用的类别的事件源写入筛选器事件。</span><span class="sxs-lookup"><span data-stu-id="db667-1407">The Event Viewer uses the category to filter events written by an event source.</span></span> <span data-ttu-id="db667-1408">事件查看器可以将类别显示为数字值，或者它可以作为资源标识符使用类别来显示本地化的类别字符串。</span><span class="sxs-lookup"><span data-stu-id="db667-1408">The Event Viewer can display the category as a numeric value, or it can use the category as a resource identifier to display a localized category string.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="db667-1409">`category`参数应为正值。</span><span class="sxs-lookup"><span data-stu-id="db667-1409">The `category` parameter should be a positive value.</span></span> <span data-ttu-id="db667-1410">负类别值显示为互为补充的正数值在事件查看器。</span><span class="sxs-lookup"><span data-stu-id="db667-1410">Negative category values appear as a complementary positive number in the Event Viewer.</span></span> <span data-ttu-id="db667-1411">例如，– 10 显示为 65526，65535 为 – 1。</span><span class="sxs-lookup"><span data-stu-id="db667-1411">For example, a –10 appears as 65,526, a –1 as 65,535.</span></span>  
  
 <span data-ttu-id="db667-1412">若要在事件查看器中显示本地化的类别字符串，必须使用事件源的类别资源文件后，配置和设置`category`类别资源文件中的资源标识符。</span><span class="sxs-lookup"><span data-stu-id="db667-1412">To display localized category strings in the Event Viewer, you must use an event source configured with a category resource file, and set the `category` to a resource identifier in the category resource file.</span></span> <span data-ttu-id="db667-1413">如果事件源没有配置的类别资源文件，或指定`category`没有索引的字符串中的类别资源文件，则在事件查看器将显示该条目的数字型类别值。</span><span class="sxs-lookup"><span data-stu-id="db667-1413">If the event source does not have a configured category resource file, or the specified `category` does not index a string in the category resource file, then the Event Viewer displays the numeric category value for that entry.</span></span> <span data-ttu-id="db667-1414">配置类别资源文件，以及数量的资源文件中的类别字符串使用<xref:System.Diagnostics.EventLogInstaller>或<xref:System.Diagnostics.EventSourceCreationData>类。</span><span class="sxs-lookup"><span data-stu-id="db667-1414">Configure the category resource file, along with the number of category strings in the resource file, using the <xref:System.Diagnostics.EventLogInstaller> or the <xref:System.Diagnostics.EventSourceCreationData> class.</span></span>  
  
 <span data-ttu-id="db667-1415">除了类别，可以指定要写入到事件日志的事件的事件标识符。</span><span class="sxs-lookup"><span data-stu-id="db667-1415">In addition to the category, you can specify an event identifier for the event being written to the event log.</span></span> <span data-ttu-id="db667-1416">事件标识符的事件源，以及唯一地标识一个事件。</span><span class="sxs-lookup"><span data-stu-id="db667-1416">Event identifiers, along with the event source, uniquely identify an event.</span></span> <span data-ttu-id="db667-1417">每个应用程序可以定义其自身带编号的事件以及它们映射到其中的描述字符串。</span><span class="sxs-lookup"><span data-stu-id="db667-1417">Each application can define its own numbered events and the description strings to which they map.</span></span> <span data-ttu-id="db667-1418">事件查看器显示这些字符串值，以帮助用户了解发生的问题并建议要采取的操作。</span><span class="sxs-lookup"><span data-stu-id="db667-1418">Event viewers display these string values to help the user understand what went wrong and suggest what actions to take.</span></span>  
  
 <span data-ttu-id="db667-1419">最后，可以指定<xref:System.Diagnostics.EventLogEntryType>为写入到事件日志的事件。</span><span class="sxs-lookup"><span data-stu-id="db667-1419">Finally, you can specify an <xref:System.Diagnostics.EventLogEntryType> for the event being written to the event log.</span></span> <span data-ttu-id="db667-1420">`type`由一个图标和日志的事件查看器中的类型列中的文本指示。</span><span class="sxs-lookup"><span data-stu-id="db667-1420">The `type` is indicated by an icon and text in the Type column in the Event Viewer for a log.</span></span> <span data-ttu-id="db667-1421">此参数指示的事件类型是否为错误、 警告、 信息、 成功审核或失败审核。</span><span class="sxs-lookup"><span data-stu-id="db667-1421">This parameter indicates whether the event type is error, warning, information, success audit, or failure audit.</span></span>  
  
 <span data-ttu-id="db667-1422">必须创建并写入与源的第一项之前配置的事件源。</span><span class="sxs-lookup"><span data-stu-id="db667-1422">You must create and configure the event source before writing the first entry with the source.</span></span> <span data-ttu-id="db667-1423">在应用程序的安装过程中创建新的事件源。</span><span class="sxs-lookup"><span data-stu-id="db667-1423">Create the new event source during the installation of your application.</span></span> <span data-ttu-id="db667-1424">这允许操作系统以刷新其注册的事件源的列表和其配置的时间。</span><span class="sxs-lookup"><span data-stu-id="db667-1424">This allows time for the operating system to refresh its list of registered event sources and their configuration.</span></span> <span data-ttu-id="db667-1425">如果操作系统没有刷新其事件源的列表，并且尝试写入新的源的事件写入操作将失败。</span><span class="sxs-lookup"><span data-stu-id="db667-1425">If the operating system has not refreshed its list of event sources, and you attempt to write an event with the new source, the write operation will fail.</span></span> <span data-ttu-id="db667-1426">可以配置新的源使用<xref:System.Diagnostics.EventLogInstaller>，或使用<xref:System.Diagnostics.EventLog.CreateEventSource%2A>方法。</span><span class="sxs-lookup"><span data-stu-id="db667-1426">You can configure a new source using an <xref:System.Diagnostics.EventLogInstaller>, or using the <xref:System.Diagnostics.EventLog.CreateEventSource%2A> method.</span></span> <span data-ttu-id="db667-1427">若要创建新的事件源的计算机上，必须具有管理权限。</span><span class="sxs-lookup"><span data-stu-id="db667-1427">You must have administrative rights on the computer to create a new event source.</span></span>  
  
 <span data-ttu-id="db667-1428">要写入本地化的项还是要直接写入字符串，必须配置源。</span><span class="sxs-lookup"><span data-stu-id="db667-1428">The source must be configured either for writing localized entries or for writing direct strings.</span></span> <span data-ttu-id="db667-1429"><xref:System.Diagnostics.EventLog.WriteEntry%2A>方法直接写入事件日志写入给定的字符串; 它不使用可本地化的消息资源文件。</span><span class="sxs-lookup"><span data-stu-id="db667-1429">The <xref:System.Diagnostics.EventLog.WriteEntry%2A> method writes the given string directly to the event log; it does not use a localizable message resource file.</span></span> <span data-ttu-id="db667-1430">使用<xref:System.Diagnostics.EventLog.WriteEvent%2A>方法来写入事件时使用的本地化的消息资源文件。</span><span class="sxs-lookup"><span data-stu-id="db667-1430">Use the <xref:System.Diagnostics.EventLog.WriteEvent%2A> method to write events using a localized message resource file.</span></span>  
  
 <span data-ttu-id="db667-1431">如果你的应用程序将使用资源标识符和字符串值的条目写入，则必须注册两个单独的源。</span><span class="sxs-lookup"><span data-stu-id="db667-1431">If your application writes entries using both resource identifiers and string values, you must register two separate sources.</span></span> <span data-ttu-id="db667-1432">例如，配置一个源的资源文件，以及如何将该源中的<xref:System.Diagnostics.EventLog.WriteEvent%2A>方法来编写使用资源标识符添加到事件日志条目。</span><span class="sxs-lookup"><span data-stu-id="db667-1432">For example, configure one source with resource files, and then use that source in the <xref:System.Diagnostics.EventLog.WriteEvent%2A> method to write entries using resource identifiers to the event log.</span></span> <span data-ttu-id="db667-1433">然后创建不同的源，而无需资源文件，并使用在该源<xref:System.Diagnostics.EventLog.WriteEntry%2A>方法将字符串直接写入事件日志使用的源。</span><span class="sxs-lookup"><span data-stu-id="db667-1433">Then create a different source without resource files, and use that source in the <xref:System.Diagnostics.EventLog.WriteEntry%2A> method to write strings directly to the event log using that source.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="db667-1434">如果`message`参数包含 NUL 字符，则在 NUL 字符处终止事件日志中的消息。</span><span class="sxs-lookup"><span data-stu-id="db667-1434">If the `message` parameter contains a NUL character, the message in the event log is terminated at the NUL character.</span></span>  
>   
>  <span data-ttu-id="db667-1435">`message`字符串不能包含 %*n*，其中*n*是一个整数值 (例如，%1)，因为事件查看器将其视为插入字符串。</span><span class="sxs-lookup"><span data-stu-id="db667-1435">The `message` string cannot contain %*n*, where *n* is an integer value (for example, %1), because the event viewer treats it as an insertion string.</span></span> <span data-ttu-id="db667-1436">Internet 协议版本 6 (IPv6) 地址可以包含此字符序列，因为无法记录事件消息包含 IPv6 地址。</span><span class="sxs-lookup"><span data-stu-id="db667-1436">Because an Internet Protocol, version 6 (IPv6) address can contain this character sequence, you cannot log an event message that contains an IPv6 address.</span></span>  
  
   
  
## Examples  
 [!code-cpp[EventLog_WriteEntry_1_3#1](~/samples/snippets/cpp/VS_Snippets_CLR/EventLog_WriteEntry_1_3/CPP/eventlog_writeentry_1_3.cpp#1)]
 [!code-csharp[EventLog_WriteEntry_1_3#1](~/samples/snippets/csharp/VS_Snippets_CLR/EventLog_WriteEntry_1_3/CS/eventlog_writeentry_1_3.cs#1)]
 [!code-vb[EventLog_WriteEntry_1_3#1](~/samples/snippets/visualbasic/VS_Snippets_CLR/EventLog_WriteEntry_1_3/VB/eventlog_writeentry_1_3.vb#1)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentException">
          <span data-ttu-id="db667-1437">
            <paramref name="source" /> 值是空字符串 ("")。</span>
          <span class="sxs-lookup">
            <span data-stu-id="db667-1437">The <paramref name="source" /> value is an empty string ("").</span>
          </span>
          <span data-ttu-id="db667-1438">\- 或 -</span>
          <span class="sxs-lookup">
            <span data-stu-id="db667-1438">\- or -</span>
          </span>
          <span data-ttu-id="db667-1439">
            <paramref name="source" /> 值为 <see langword="null" />。</span>
          <span class="sxs-lookup">
            <span data-stu-id="db667-1439">The <paramref name="source" /> value is <see langword="null" />.</span>
          </span>
          <span data-ttu-id="db667-1440">\- 或 -</span>
          <span class="sxs-lookup">
            <span data-stu-id="db667-1440">\- or -</span>
          </span>
          <span data-ttu-id="db667-1441">
            <paramref name="eventID" /> 小于零或大于 <see cref="F:System.UInt16.MaxValue" />。</span>
          <span class="sxs-lookup">
            <span data-stu-id="db667-1441">
              <paramref name="eventID" /> is less than zero or greater than <see cref="F:System.UInt16.MaxValue" />.</span>
          </span>
          <span data-ttu-id="db667-1442">\- 或 -</span>
          <span class="sxs-lookup">
            <span data-stu-id="db667-1442">\- or -</span>
          </span>
          <span data-ttu-id="db667-1443">消息字符串长于 31,839 字节（在 Windows Vista 之前，在 Windows 操作系统上为 32,766 字节)。</span>
          <span class="sxs-lookup">
            <span data-stu-id="db667-1443">The message string is longer than 31,839 bytes (32,766 bytes on Windows operating systems before Windows Vista).</span>
          </span>
          <span data-ttu-id="db667-1444">\- 或 -</span>
          <span class="sxs-lookup">
            <span data-stu-id="db667-1444">\- or -</span>
          </span>
          <span data-ttu-id="db667-1445">此源名称导致注册表项路径的长度超过 254 个字符。</span>
          <span class="sxs-lookup">
            <span data-stu-id="db667-1445">The source name results in a registry key path longer than 254 characters.</span>
          </span>
        </exception>
        <exception cref="T:System.InvalidOperationException">
          <span data-ttu-id="db667-1446">事件日志的注册表项未能打开。</span>
          <span class="sxs-lookup">
            <span data-stu-id="db667-1446">The registry key for the event log could not be opened.</span>
          </span>
        </exception>
        <exception cref="T:System.ComponentModel.InvalidEnumArgumentException">
          <span data-ttu-id="db667-1447">
            <paramref name="type" /> 不是有效的 <see cref="T:System.Diagnostics.EventLogEntryType" />。</span>
          <span class="sxs-lookup">
            <span data-stu-id="db667-1447">
              <paramref name="type" /> is not a valid <see cref="T:System.Diagnostics.EventLogEntryType" />.</span>
          </span>
        </exception>
        <exception cref="T:System.ComponentModel.Win32Exception">
          <span data-ttu-id="db667-1448">将事件项写入事件日志时，操作系统报告了一个错误。</span>
          <span class="sxs-lookup">
            <span data-stu-id="db667-1448">The operating system reported an error when writing the event entry to the event log.</span>
          </span>
          <span data-ttu-id="db667-1449">一个 Windows 错误代码不可用。</span>
          <span class="sxs-lookup">
            <span data-stu-id="db667-1449">A Windows error code is not available.</span>
          </span>
        </exception>
        <permission cref="T:System.Diagnostics.EventLogPermission">
          <span data-ttu-id="db667-1450">用于写入的计算机上的事件日志信息。</span>
          <span class="sxs-lookup">
            <span data-stu-id="db667-1450">for writing the event log information on the computer.</span>
          </span>
          <span data-ttu-id="db667-1451">关联的枚举： <see cref="F:System.Diagnostics.EventLogPermissionAccess.Write" /></span>
          <span class="sxs-lookup">
            <span data-stu-id="db667-1451">Associated enumeration: <see cref="F:System.Diagnostics.EventLogPermissionAccess.Write" /></span>
          </span>
        </permission>
        <altmember cref="T:System.Diagnostics.EventLogEntryType" />
        <altmember cref="P:System.Diagnostics.EventLog.Source" />
        <altmember cref="Overload:System.Diagnostics.EventLog.CreateEventSource" />
        <altmember cref="M:System.Diagnostics.EventLog.DeleteEventSource(System.String)" />
        <altmember cref="M:System.Diagnostics.EventLog.SourceExists(System.String)" />
        <altmember cref="P:System.Diagnostics.EventLog.Entries" />
      </Docs>
    </Member>
    <Member MemberName="WriteEntry">
      <MemberSignature Language="C#" Value="public static void WriteEntry (string source, string message, System.Diagnostics.EventLogEntryType type, int eventID, short category, byte[] rawData);" />
      <MemberSignature Language="ILAsm" Value=".method public static hidebysig void WriteEntry(string source, string message, valuetype System.Diagnostics.EventLogEntryType type, int32 eventID, int16 category, unsigned int8[] rawData) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Diagnostics.EventLog.WriteEntry(System.String,System.String,System.Diagnostics.EventLogEntryType,System.Int32,System.Int16,System.Byte[])" />
      <MemberSignature Language="VB.NET" Value="Public Shared Sub WriteEntry (source As String, message As String, type As EventLogEntryType, eventID As Integer, category As Short, rawData As Byte())" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; static void WriteEntry(System::String ^ source, System::String ^ message, System::Diagnostics::EventLogEntryType type, int eventID, short category, cli::array &lt;System::Byte&gt; ^ rawData);" />
      <MemberSignature Language="F#" Value="static member WriteEntry : string * string * System.Diagnostics.EventLogEntryType * int * int16 * byte[] -&gt; unit" Usage="System.Diagnostics.EventLog.WriteEntry (source, message, type, eventID, category, rawData)" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System</AssemblyName>
        <AssemblyVersion>1.0.5000.0</AssemblyVersion>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Void</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="source" Type="System.String" />
        <Parameter Name="message" Type="System.String" />
        <Parameter Name="type" Type="System.Diagnostics.EventLogEntryType" />
        <Parameter Name="eventID" Type="System.Int32" />
        <Parameter Name="category" Type="System.Int16" />
        <Parameter Name="rawData" Type="System.Byte[]" />
      </Parameters>
      <Docs>
        <param name="source">
          <span data-ttu-id="db667-1452">应用程序在指定计算机上注册时所采用的源。</span>
          <span class="sxs-lookup">
            <span data-stu-id="db667-1452">The source by which the application is registered on the specified computer.</span>
          </span>
        </param>
        <param name="message">
          <span data-ttu-id="db667-1453">要写入事件日志的字符串。</span>
          <span class="sxs-lookup">
            <span data-stu-id="db667-1453">The string to write to the event log.</span>
          </span>
        </param>
        <param name="type">
          <span data-ttu-id="db667-1454">
            <see cref="T:System.Diagnostics.EventLogEntryType" /> 值之一。</span>
          <span class="sxs-lookup">
            <span data-stu-id="db667-1454">One of the <see cref="T:System.Diagnostics.EventLogEntryType" /> values.</span>
          </span>
        </param>
        <param name="eventID">
          <span data-ttu-id="db667-1455">事件的应用程序特定标识符。</span>
          <span class="sxs-lookup">
            <span data-stu-id="db667-1455">The application-specific identifier for the event.</span>
          </span>
        </param>
        <param name="category">
          <span data-ttu-id="db667-1456">与消息关联的应用程序特定子类别。</span>
          <span class="sxs-lookup">
            <span data-stu-id="db667-1456">The application-specific subcategory associated with the message.</span>
          </span>
        </param>
        <param name="rawData">
          <span data-ttu-id="db667-1457">包含与此项关联的二进制数据的字节数组。</span>
          <span class="sxs-lookup">
            <span data-stu-id="db667-1457">An array of bytes that holds the binary data associated with the entry.</span>
          </span>
        </param>
        <summary>
          <span data-ttu-id="db667-1458">（使用指定的注册事件源）将一个包含给定消息文本、应用程序定义的事件标识符和应用程序定义的类别的项写入事件日志，并向消息追加二进制数据。</span>
          <span class="sxs-lookup">
            <span data-stu-id="db667-1458">Writes an entry with the given message text, application-defined event identifier, and application-defined category to the event log (using the specified registered event source) and appends binary data to the message.</span>
          </span>
        </summary>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="db667-1459">使用此方法将应用程序定义特定于事件的数据写入事件日志中，使用已注册为相应的日志的事件源的源。</span><span class="sxs-lookup"><span data-stu-id="db667-1459">Use this method to write application-defined event-specific data to the event log, using a source already registered as an event source for the appropriate log.</span></span> <span data-ttu-id="db667-1460">事件查看器不解释该数据。它仅采用组合的十六进制转义序列和文本格式显示原始数据。</span><span class="sxs-lookup"><span data-stu-id="db667-1460">The Event Viewer does not interpret this data; it displays raw data only in a combined hexadecimal and text format.</span></span> <span data-ttu-id="db667-1461">使用特定于事件的数据很谨慎;仅当你确信将很有用，包括它。</span><span class="sxs-lookup"><span data-stu-id="db667-1461">Use event-specific data sparingly; include it only if you are sure it will be useful.</span></span> <span data-ttu-id="db667-1462">特定于事件的数据还可用于存储应用程序可以处理独立于事件查看器的信息。</span><span class="sxs-lookup"><span data-stu-id="db667-1462">You can also use event-specific data to store information the application can process independently of the Event Viewer.</span></span> <span data-ttu-id="db667-1463">例如，可以专门为您的活动，编写一个查看器或编写一个程序来扫描日志文件并创建报告，包括来自特定于事件的数据的信息。</span><span class="sxs-lookup"><span data-stu-id="db667-1463">For example, you could write a viewer specifically for your events, or write a program that scans the logfile and creates reports that include information from the event-specific data.</span></span>  
  
 <span data-ttu-id="db667-1464">除了二进制数据，还可以指定应用程序定义的类别和应用程序定义的事件标识符。</span><span class="sxs-lookup"><span data-stu-id="db667-1464">In addition to the binary data, you can specify an application-defined category and an application-defined event identifier.</span></span> <span data-ttu-id="db667-1465">事件查看器使用的类别的事件源写入筛选器事件。</span><span class="sxs-lookup"><span data-stu-id="db667-1465">The Event Viewer uses the category to filter events written by an event source.</span></span> <span data-ttu-id="db667-1466">事件查看器可以将类别显示为数字值，或者它可以作为资源标识符使用类别来显示本地化的类别字符串。</span><span class="sxs-lookup"><span data-stu-id="db667-1466">The Event Viewer can display the category as a numeric value, or it can use the category as a resource identifier to display a localized category string.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="db667-1467">`category`参数应为正值。</span><span class="sxs-lookup"><span data-stu-id="db667-1467">The `category` parameter should be a positive value.</span></span> <span data-ttu-id="db667-1468">负类别值显示为互为补充的正数值在事件查看器。</span><span class="sxs-lookup"><span data-stu-id="db667-1468">Negative category values appear as a complementary positive number in the Event Viewer.</span></span> <span data-ttu-id="db667-1469">例如，– 10 将显示为 65526，65535 为 – 1。</span><span class="sxs-lookup"><span data-stu-id="db667-1469">For example, a –10 will appear as 65,526, a –1 as 65,535.</span></span>  
  
 <span data-ttu-id="db667-1470">若要在事件查看器中显示本地化的类别字符串，必须使用事件源的类别资源文件后，配置和设置`category`类别资源文件中的资源标识符。</span><span class="sxs-lookup"><span data-stu-id="db667-1470">To display localized category strings in the Event Viewer, you must use an event source configured with a category resource file, and set the `category` to a resource identifier in the category resource file.</span></span> <span data-ttu-id="db667-1471">如果事件源没有配置的类别资源文件，或指定`category`没有索引的字符串中的类别资源文件，则在事件查看器将显示该条目的数字型类别值。</span><span class="sxs-lookup"><span data-stu-id="db667-1471">If the event source does not have a configured category resource file, or the specified `category` does not index a string in the category resource file, then the Event Viewer displays the numeric category value for that entry.</span></span> <span data-ttu-id="db667-1472">配置类别资源文件，以及数量的资源文件中的类别字符串使用<xref:System.Diagnostics.EventLogInstaller>或<xref:System.Diagnostics.EventSourceCreationData>类。</span><span class="sxs-lookup"><span data-stu-id="db667-1472">Configure the category resource file, along with the number of category strings in the resource file, using the <xref:System.Diagnostics.EventLogInstaller> or the <xref:System.Diagnostics.EventSourceCreationData> class.</span></span>  
  
 <span data-ttu-id="db667-1473">事件标识符，与事件源，一起唯一地标识一个事件。</span><span class="sxs-lookup"><span data-stu-id="db667-1473">Event identifiers, together with the event source, uniquely identify an event.</span></span> <span data-ttu-id="db667-1474">每个应用程序可以定义其自身带编号的事件以及它们映射到其中的描述字符串。</span><span class="sxs-lookup"><span data-stu-id="db667-1474">Each application can define its own numbered events and the description strings to which they map.</span></span> <span data-ttu-id="db667-1475">事件查看器显示这些字符串值，以帮助用户了解发生的问题并建议要采取的操作。</span><span class="sxs-lookup"><span data-stu-id="db667-1475">Event viewers display these string values to help the user understand what went wrong and suggest what actions to take.</span></span>  
  
 <span data-ttu-id="db667-1476">最后，可以指定<xref:System.Diagnostics.EventLogEntryType>为写入到事件日志的事件。</span><span class="sxs-lookup"><span data-stu-id="db667-1476">Finally, you can specify an <xref:System.Diagnostics.EventLogEntryType> for the event being written to the event log.</span></span> <span data-ttu-id="db667-1477">`type`由一个图标和日志的事件查看器中的类型列中的文本指示。</span><span class="sxs-lookup"><span data-stu-id="db667-1477">The `type` is indicated by an icon and text in the Type column in the Event Viewer for a log.</span></span> <span data-ttu-id="db667-1478">此参数指示的事件类型是否为错误、 警告、 信息、 成功审核或失败审核。</span><span class="sxs-lookup"><span data-stu-id="db667-1478">This parameter indicates whether the event type is error, warning, information, success audit, or failure audit.</span></span>  
  
 <span data-ttu-id="db667-1479">必须创建并写入与源的第一项之前配置的事件源。</span><span class="sxs-lookup"><span data-stu-id="db667-1479">You must create and configure the event source before writing the first entry with the source.</span></span> <span data-ttu-id="db667-1480">在应用程序的安装过程中创建新的事件源。</span><span class="sxs-lookup"><span data-stu-id="db667-1480">Create the new event source during the installation of your application.</span></span> <span data-ttu-id="db667-1481">这允许操作系统以刷新其注册的事件源的列表和其配置的时间。</span><span class="sxs-lookup"><span data-stu-id="db667-1481">This allows time for the operating system to refresh its list of registered event sources and their configuration.</span></span> <span data-ttu-id="db667-1482">如果操作系统没有刷新其事件源的列表，并且尝试写入新的源的事件写入操作将失败。</span><span class="sxs-lookup"><span data-stu-id="db667-1482">If the operating system has not refreshed its list of event sources, and you attempt to write an event with the new source, the write operation will fail.</span></span> <span data-ttu-id="db667-1483">可以配置新的源使用<xref:System.Diagnostics.EventLogInstaller>，或使用<xref:System.Diagnostics.EventLog.CreateEventSource%2A>方法。</span><span class="sxs-lookup"><span data-stu-id="db667-1483">You can configure a new source using an <xref:System.Diagnostics.EventLogInstaller>, or using the <xref:System.Diagnostics.EventLog.CreateEventSource%2A> method.</span></span> <span data-ttu-id="db667-1484">若要创建新的事件源的计算机上，必须具有管理权限。</span><span class="sxs-lookup"><span data-stu-id="db667-1484">You must have administrative rights on the computer to create a new event source.</span></span>  
  
 <span data-ttu-id="db667-1485">要写入本地化的项还是要直接写入字符串，必须配置源。</span><span class="sxs-lookup"><span data-stu-id="db667-1485">The source must be configured either for writing localized entries or for writing direct strings.</span></span> <span data-ttu-id="db667-1486"><xref:System.Diagnostics.EventLog.WriteEntry%2A>方法直接写入事件日志写入给定的字符串; 它不使用可本地化的消息资源文件。</span><span class="sxs-lookup"><span data-stu-id="db667-1486">The <xref:System.Diagnostics.EventLog.WriteEntry%2A> method writes the given string directly to the event log; it does not use a localizable message resource file.</span></span> <span data-ttu-id="db667-1487">使用<xref:System.Diagnostics.EventLog.WriteEvent%2A>方法来写入事件时使用的本地化的消息资源文件。</span><span class="sxs-lookup"><span data-stu-id="db667-1487">Use the <xref:System.Diagnostics.EventLog.WriteEvent%2A> method to write events using a localized message resource file.</span></span>  
  
 <span data-ttu-id="db667-1488">如果你的应用程序将使用资源标识符和字符串值的条目写入，则必须注册两个单独的源。</span><span class="sxs-lookup"><span data-stu-id="db667-1488">If your application writes entries using both resource identifiers and string values, you must register two separate sources.</span></span> <span data-ttu-id="db667-1489">例如，配置一个源的资源文件，以及如何将该源中的<xref:System.Diagnostics.EventLog.WriteEvent%2A>方法来编写使用资源标识符添加到事件日志条目。</span><span class="sxs-lookup"><span data-stu-id="db667-1489">For example, configure one source with resource files, and then use that source in the <xref:System.Diagnostics.EventLog.WriteEvent%2A> method to write entries using resource identifiers to the event log.</span></span> <span data-ttu-id="db667-1490">然后创建不同的源，而无需资源文件，并使用在该源<xref:System.Diagnostics.EventLog.WriteEntry%2A>方法将字符串直接写入事件日志使用的源。</span><span class="sxs-lookup"><span data-stu-id="db667-1490">Then create a different source without resource files, and use that source in the <xref:System.Diagnostics.EventLog.WriteEntry%2A> method to write strings directly to the event log using that source.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="db667-1491">如果`message`参数包含 NUL 字符，则在 NUL 字符处终止事件日志中的消息。</span><span class="sxs-lookup"><span data-stu-id="db667-1491">If the `message` parameter contains a NUL character, the message in the event log is terminated at the NUL character.</span></span>  
>   
>  <span data-ttu-id="db667-1492">`message`字符串不能包含 %*n*，其中*n*是一个整数值 (例如，%1)，因为事件查看器将其视为插入字符串。</span><span class="sxs-lookup"><span data-stu-id="db667-1492">The `message` string cannot contain %*n*, where *n* is an integer value (for example, %1), because the event viewer treats it as an insertion string.</span></span> <span data-ttu-id="db667-1493">Internet 协议版本 6 (IPv6) 地址可以包含此字符序列，因为无法记录事件消息包含 IPv6 地址。</span><span class="sxs-lookup"><span data-stu-id="db667-1493">Because an Internet Protocol, version 6 (IPv6) address can contain this character sequence, you cannot log an event message that contains an IPv6 address.</span></span>  
  
   
  
## Examples  
 [!code-cpp[EventLog_WriteEntry_1_3#2](~/samples/snippets/cpp/VS_Snippets_CLR/EventLog_WriteEntry_1_3/CPP/eventlog_writeentry_1_3.cpp#2)]
 [!code-csharp[EventLog_WriteEntry_1_3#2](~/samples/snippets/csharp/VS_Snippets_CLR/EventLog_WriteEntry_1_3/CS/eventlog_writeentry_1_3.cs#2)]
 [!code-vb[EventLog_WriteEntry_1_3#2](~/samples/snippets/visualbasic/VS_Snippets_CLR/EventLog_WriteEntry_1_3/VB/eventlog_writeentry_1_3.vb#2)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentException">
          <span data-ttu-id="db667-1494">
            <paramref name="source" /> 值是空字符串 ("")。</span>
          <span class="sxs-lookup">
            <span data-stu-id="db667-1494">The <paramref name="source" /> value is an empty string ("").</span>
          </span>
          <span data-ttu-id="db667-1495">\- 或 -</span>
          <span class="sxs-lookup">
            <span data-stu-id="db667-1495">\- or -</span>
          </span>
          <span data-ttu-id="db667-1496">
            <paramref name="source" /> 值为 <see langword="null" />。</span>
          <span class="sxs-lookup">
            <span data-stu-id="db667-1496">The <paramref name="source" /> value is <see langword="null" />.</span>
          </span>
          <span data-ttu-id="db667-1497">\- 或 -</span>
          <span class="sxs-lookup">
            <span data-stu-id="db667-1497">\- or -</span>
          </span>
          <span data-ttu-id="db667-1498">
            <paramref name="eventID" /> 小于零或大于 <see cref="F:System.UInt16.MaxValue" />。</span>
          <span class="sxs-lookup">
            <span data-stu-id="db667-1498">
              <paramref name="eventID" /> is less than zero or greater than <see cref="F:System.UInt16.MaxValue" />.</span>
          </span>
          <span data-ttu-id="db667-1499">\- 或 -</span>
          <span class="sxs-lookup">
            <span data-stu-id="db667-1499">\- or -</span>
          </span>
          <span data-ttu-id="db667-1500">消息字符串长于 31,839 字节（在 Windows Vista 之前，在 Windows 操作系统上为 32,766 字节)。</span>
          <span class="sxs-lookup">
            <span data-stu-id="db667-1500">The message string is longer than 31,839 bytes (32,766 bytes on Windows operating systems before Windows Vista).</span>
          </span>
          <span data-ttu-id="db667-1501">\- 或 -</span>
          <span class="sxs-lookup">
            <span data-stu-id="db667-1501">\- or -</span>
          </span>
          <span data-ttu-id="db667-1502">此源名称导致注册表项路径的长度超过 254 个字符。</span>
          <span class="sxs-lookup">
            <span data-stu-id="db667-1502">The source name results in a registry key path longer than 254 characters.</span>
          </span>
        </exception>
        <exception cref="T:System.ComponentModel.InvalidEnumArgumentException">
          <span data-ttu-id="db667-1503">
            <paramref name="type" /> 不是有效的 <see cref="T:System.Diagnostics.EventLogEntryType" />。</span>
          <span class="sxs-lookup">
            <span data-stu-id="db667-1503">
              <paramref name="type" /> is not a valid <see cref="T:System.Diagnostics.EventLogEntryType" />.</span>
          </span>
        </exception>
        <exception cref="T:System.InvalidOperationException">
          <span data-ttu-id="db667-1504">事件日志的注册表项未能打开。</span>
          <span class="sxs-lookup">
            <span data-stu-id="db667-1504">The registry key for the event log could not be opened.</span>
          </span>
        </exception>
        <exception cref="T:System.ComponentModel.Win32Exception">
          <span data-ttu-id="db667-1505">将事件项写入事件日志时，操作系统报告了一个错误。</span>
          <span class="sxs-lookup">
            <span data-stu-id="db667-1505">The operating system reported an error when writing the event entry to the event log.</span>
          </span>
          <span data-ttu-id="db667-1506">一个 Windows 错误代码不可用。</span>
          <span class="sxs-lookup">
            <span data-stu-id="db667-1506">A Windows error code is not available.</span>
          </span>
        </exception>
        <permission cref="T:System.Diagnostics.EventLogPermission">
          <span data-ttu-id="db667-1507">用于写入的计算机上的事件日志信息。</span>
          <span class="sxs-lookup">
            <span data-stu-id="db667-1507">for writing the event log information on the computer.</span>
          </span>
          <span data-ttu-id="db667-1508">关联的枚举： <see cref="F:System.Diagnostics.EventLogPermissionAccess.Write" /></span>
          <span class="sxs-lookup">
            <span data-stu-id="db667-1508">Associated enumeration: <see cref="F:System.Diagnostics.EventLogPermissionAccess.Write" /></span>
          </span>
        </permission>
        <altmember cref="T:System.Diagnostics.EventLogEntryType" />
        <altmember cref="P:System.Diagnostics.EventLog.Source" />
        <altmember cref="Overload:System.Diagnostics.EventLog.CreateEventSource" />
        <altmember cref="M:System.Diagnostics.EventLog.DeleteEventSource(System.String)" />
        <altmember cref="M:System.Diagnostics.EventLog.SourceExists(System.String)" />
        <altmember cref="P:System.Diagnostics.EventLog.Entries" />
      </Docs>
    </Member>
    <MemberGroup MemberName="WriteEvent">
      <AssemblyInfo>
        <AssemblyName>System</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Docs>
        <summary>
          <span data-ttu-id="db667-1509">向事件日志写入本地化事件项。</span>
          <span class="sxs-lookup">
            <span data-stu-id="db667-1509">Writes a localized event entry to the event log.</span>
          </span>
        </summary>
      </Docs>
    </MemberGroup>
    <Member MemberName="WriteEvent">
      <MemberSignature Language="C#" Value="public void WriteEvent (System.Diagnostics.EventInstance instance, params object[] values);" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig instance void WriteEvent(class System.Diagnostics.EventInstance instance, object[] values) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Diagnostics.EventLog.WriteEvent(System.Diagnostics.EventInstance,System.Object[])" />
      <MemberSignature Language="VB.NET" Value="Public Sub WriteEvent (instance As EventInstance, ParamArray values As Object())" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; void WriteEvent(System::Diagnostics::EventInstance ^ instance, ... cli::array &lt;System::Object ^&gt; ^ values);" />
      <MemberSignature Language="F#" Value="member this.WriteEvent : System.Diagnostics.EventInstance * obj[] -&gt; unit" Usage="eventLog.WriteEvent (instance, values)" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System</AssemblyName>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Attributes>
        <Attribute FrameworkAlternate="netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;xamarinmac-3.0">
          <AttributeName>System.Runtime.InteropServices.ComVisible(false)</AttributeName>
        </Attribute>
        <Attribute FrameworkAlternate="netframework-4.0">
          <AttributeName>System.Runtime.TargetedPatchingOptOut("Performance critical to inline this type of method across NGen image boundaries")</AttributeName>
        </Attribute>
      </Attributes>
      <ReturnValue>
        <ReturnType>System.Void</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="instance" Type="System.Diagnostics.EventInstance" />
        <Parameter Name="values" Type="System.Object[]">
          <Attributes>
            <Attribute>
              <AttributeName>System.ParamArray</AttributeName>
            </Attribute>
          </Attributes>
        </Parameter>
      </Parameters>
      <Docs>
        <param name="instance">
          <span data-ttu-id="db667-1510">表示本地化事件日志项的 <see cref="T:System.Diagnostics.EventInstance" /> 实例。</span>
          <span class="sxs-lookup">
            <span data-stu-id="db667-1510">An <see cref="T:System.Diagnostics.EventInstance" /> instance that represents a localized event log entry.</span>
          </span>
        </param>
        <param name="values">
          <span data-ttu-id="db667-1511">要合并到事件日志项的消息文本中的字符串数组。</span>
          <span class="sxs-lookup">
            <span data-stu-id="db667-1511">An array of strings to merge into the message text of the event log entry.</span>
          </span>
        </param>
        <summary>
          <span data-ttu-id="db667-1512">向事件日志写入本地化项。</span>
          <span class="sxs-lookup">
            <span data-stu-id="db667-1512">Writes a localized entry to the event log.</span>
          </span>
        </summary>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="db667-1513">使用此方法向事件日志写入本地化的项。</span><span class="sxs-lookup"><span data-stu-id="db667-1513">Use this method to write a localized entry to the event log.</span></span> <span data-ttu-id="db667-1514">资源标识符而不是字符串值与指定的事件属性。</span><span class="sxs-lookup"><span data-stu-id="db667-1514">You specify the event properties with resource identifiers rather than string values.</span></span> <span data-ttu-id="db667-1515">事件查看器使用的资源标识符来显示的本地化的资源文件中的相应字符串<xref:System.Diagnostics.EventLog.Source%2A>。</span><span class="sxs-lookup"><span data-stu-id="db667-1515">The Event Viewer uses the resource identifiers to display the corresponding strings from the localized resource file for the <xref:System.Diagnostics.EventLog.Source%2A>.</span></span> <span data-ttu-id="db667-1516">编写使用资源标识符的事件之前，必须将源注册相应的资源文件。</span><span class="sxs-lookup"><span data-stu-id="db667-1516">You must register the source with the corresponding resource file before you write events using resource identifiers.</span></span>  
  
 <span data-ttu-id="db667-1517">输入`instance`实例指定的事件消息和属性。</span><span class="sxs-lookup"><span data-stu-id="db667-1517">The input `instance` instance specifies the event message and properties.</span></span> <span data-ttu-id="db667-1518">设置<xref:System.Diagnostics.EventInstance.InstanceId%2A>的`instance`源消息资源文件中定义的消息的输入。</span><span class="sxs-lookup"><span data-stu-id="db667-1518">Set the <xref:System.Diagnostics.EventInstance.InstanceId%2A> of the `instance` input for the defined message in the source message resource file.</span></span> <span data-ttu-id="db667-1519">可以选择性地设置<xref:System.Diagnostics.EventInstance.CategoryId%2A>并<xref:System.Diagnostics.EventInstance.EntryType%2A>的`instance`输入来定义事件条目的类别和事件类型。</span><span class="sxs-lookup"><span data-stu-id="db667-1519">You can optionally set the <xref:System.Diagnostics.EventInstance.CategoryId%2A> and <xref:System.Diagnostics.EventInstance.EntryType%2A> of the `instance` input to define the category and event type of your event entry.</span></span> <span data-ttu-id="db667-1520">此外可以指定一个要插入到本地化的消息文本的独立于语言的字符串数组。</span><span class="sxs-lookup"><span data-stu-id="db667-1520">You can also specify an array of language-independent strings to insert into the localized message text.</span></span> <span data-ttu-id="db667-1521">设置`values`到`null`如果事件消息不包含替换字符串的格式设置占位符。</span><span class="sxs-lookup"><span data-stu-id="db667-1521">Set `values` to `null` if the event message does not contain formatting placeholders for replacement strings.</span></span>  
  
 <span data-ttu-id="db667-1522">必须设置<xref:System.Diagnostics.EventLog.Source%2A>属性上的你<xref:System.Diagnostics.EventLog>组件之前使用<xref:System.Diagnostics.EventLog.WriteEvent%2A>。</span><span class="sxs-lookup"><span data-stu-id="db667-1522">You must set the <xref:System.Diagnostics.EventLog.Source%2A> property on your <xref:System.Diagnostics.EventLog> component before using <xref:System.Diagnostics.EventLog.WriteEvent%2A>.</span></span> <span data-ttu-id="db667-1523">指定的源必须配置用于本地化的项写入事件日志中。源最小值必须具有一个用于定义消息资源文件。</span><span class="sxs-lookup"><span data-stu-id="db667-1523">The specified source must be configured for writing localized entries to the log; the source must at minimum have a message resource file defined.</span></span>  
  
 <span data-ttu-id="db667-1524">必须创建并写入与源的第一项之前配置的事件源。</span><span class="sxs-lookup"><span data-stu-id="db667-1524">You must create and configure the event source before writing the first entry with the source.</span></span> <span data-ttu-id="db667-1525">在应用程序的安装过程中创建新的事件源。</span><span class="sxs-lookup"><span data-stu-id="db667-1525">Create the new event source during the installation of your application.</span></span> <span data-ttu-id="db667-1526">这允许操作系统以刷新其注册的事件源的列表和其配置的时间。</span><span class="sxs-lookup"><span data-stu-id="db667-1526">This allows time for the operating system to refresh its list of registered event sources and their configuration.</span></span> <span data-ttu-id="db667-1527">如果操作系统没有刷新其事件源的列表，并且尝试写入新的源的事件写入操作将失败。</span><span class="sxs-lookup"><span data-stu-id="db667-1527">If the operating system has not refreshed its list of event sources, and you attempt to write an event with the new source, the write operation will fail.</span></span> <span data-ttu-id="db667-1528">可以配置新的源使用<xref:System.Diagnostics.EventLogInstaller>，或使用<xref:System.Diagnostics.EventLog.CreateEventSource%2A>方法。</span><span class="sxs-lookup"><span data-stu-id="db667-1528">You can configure a new source using an <xref:System.Diagnostics.EventLogInstaller>, or using the <xref:System.Diagnostics.EventLog.CreateEventSource%2A> method.</span></span> <span data-ttu-id="db667-1529">若要创建新的事件源的计算机上，必须具有管理权限。</span><span class="sxs-lookup"><span data-stu-id="db667-1529">You must have administrative rights on the computer to create a new event source.</span></span>  
  
 <span data-ttu-id="db667-1530">要写入本地化的项还是要直接写入字符串，必须配置源。</span><span class="sxs-lookup"><span data-stu-id="db667-1530">The source must be configured either for writing localized entries or for writing direct strings.</span></span> <span data-ttu-id="db667-1531">使用<xref:System.Diagnostics.EventLog.WriteEntry%2A>方法如果你的应用程序将直接写入事件日志的字符串值。</span><span class="sxs-lookup"><span data-stu-id="db667-1531">Use the <xref:System.Diagnostics.EventLog.WriteEntry%2A> method if your application writes string values directly to the event log.</span></span>  
  
 <span data-ttu-id="db667-1532">如果你的应用程序将使用资源标识符和字符串值的条目写入，则必须注册两个单独的源。</span><span class="sxs-lookup"><span data-stu-id="db667-1532">If your application writes entries using both resource identifiers and string values, you must register two separate sources.</span></span> <span data-ttu-id="db667-1533">例如，配置一个源的资源文件，以及如何将该源中的<xref:System.Diagnostics.EventLog.WriteEvent%2A>方法来编写使用资源标识符添加到事件日志条目。</span><span class="sxs-lookup"><span data-stu-id="db667-1533">For example, configure one source with resource files, and then use that source in the <xref:System.Diagnostics.EventLog.WriteEvent%2A> method to write entries using resource identifiers to the event log.</span></span> <span data-ttu-id="db667-1534">然后创建不同的源，而无需资源文件，并使用在该源<xref:System.Diagnostics.EventLog.WriteEntry%2A>方法将字符串直接写入事件日志使用的源。</span><span class="sxs-lookup"><span data-stu-id="db667-1534">Then create a different source without resource files, and use that source in the <xref:System.Diagnostics.EventLog.WriteEntry%2A> method to write strings directly to the event log using that source.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="db667-1535">如果您向远程计算机的值写入条目`message`字符串可能不会与预期如果远程计算机未运行.NET Framework。</span><span class="sxs-lookup"><span data-stu-id="db667-1535">If you write an entry to a remote computer, the value of the `message` string might not be what you expect if the remote computer is not running the .NET Framework.</span></span> <span data-ttu-id="db667-1536">此外，`message`字符串不能包含 %*n*，其中*n*是一个整数值 (例如，%1)，因为事件查看器将其视为插入字符串。</span><span class="sxs-lookup"><span data-stu-id="db667-1536">Also, the `message` string cannot contain %*n*, where *n* is an integer value (for example, %1), because the event viewer treats it as an insertion string.</span></span> <span data-ttu-id="db667-1537">Internet 协议版本 6 (IPv6) 地址可以包含此字符序列，因为无法记录事件消息包含 IPv6 地址。</span><span class="sxs-lookup"><span data-stu-id="db667-1537">Because an Internet Protocol, version 6 (IPv6) address can contain this character sequence, you cannot log an event message that contains an IPv6 address.</span></span>  
  
   
  
## Examples  
 <span data-ttu-id="db667-1538">下面的示例将两个审核项写入事件日志`myNewLog`。</span><span class="sxs-lookup"><span data-stu-id="db667-1538">The following example writes two audit entries to the event log `myNewLog`.</span></span> <span data-ttu-id="db667-1539">如果在本地计算机上不存在，该示例创建一个新的事件源和一个新的事件日志。</span><span class="sxs-lookup"><span data-stu-id="db667-1539">The example creates a new event source and a new event log if they do not exist on the local computer.</span></span> <span data-ttu-id="db667-1540">事件消息文本被指定的资源文件中使用的资源标识符。</span><span class="sxs-lookup"><span data-stu-id="db667-1540">The event message text is specified using a resource identifier in a resource file.</span></span>  
  
 [!code-cpp[EventLog_WriteEvent#7](~/samples/snippets/cpp/VS_Snippets_CLR/eventlog_WriteEvent/CPP/source.cpp#7)]
 [!code-csharp[EventLog_WriteEvent#7](~/samples/snippets/csharp/VS_Snippets_CLR/eventlog_WriteEvent/CS/source.cs#7)]
 [!code-vb[EventLog_WriteEvent#7](~/samples/snippets/visualbasic/VS_Snippets_CLR/eventlog_WriteEvent/VB/source.vb#7)]  
  
 <span data-ttu-id="db667-1541">该示例使用下面的消息文本文件，内置的资源库 EventLogMsgs.dll。</span><span class="sxs-lookup"><span data-stu-id="db667-1541">The example uses the following message text file, built into the resource library EventLogMsgs.dll.</span></span> <span data-ttu-id="db667-1542">消息文本文件是从其创建的消息资源文件的源。</span><span class="sxs-lookup"><span data-stu-id="db667-1542">A message text file is the source from which the message resource file is created.</span></span> <span data-ttu-id="db667-1543">消息文本文件定义的资源标识符和类别、 事件消息和参数插入字符串的文本。</span><span class="sxs-lookup"><span data-stu-id="db667-1543">The message text file defines the resource identifiers and text for the category, event message, and parameter insertion strings.</span></span>  
  
```  
; // EventLogMsgs.mc  
; // ********************************************************  
  
; // Use the following commands to build this file:  
  
; //   mc -s EventLogMsgs.mc  
; //   rc EventLogMsgs.rc  
; //   link /DLL /SUBSYSTEM:WINDOWS /NOENTRY /MACHINE:x86 EventLogMsgs.Res   
; // ********************************************************  
  
; // - Event categories -  
; // Categories must be numbered consecutively starting at 1.  
; // ********************************************************  
  
MessageId=0x1  
Severity=Success  
SymbolicName=INSTALL_CATEGORY  
Language=English  
Installation  
.  
  
MessageId=0x2  
Severity=Success  
SymbolicName=QUERY_CATEGORY  
Language=English  
Database Query  
.  
  
MessageId=0x3  
Severity=Success  
SymbolicName=REFRESH_CATEGORY  
Language=English  
Data Refresh  
.  
  
; // - Event messages -  
; // *********************************  
  
MessageId = 1000  
Severity = Success  
Facility = Application  
SymbolicName = AUDIT_SUCCESS_MESSAGE_ID_1000  
Language=English  
My application message text, in English, for message id 1000, called from %1.  
.  
  
MessageId = 1001  
Severity = Warning  
Facility = Application  
SymbolicName = AUDIT_FAILED_MESSAGE_ID_1001  
Language=English  
My application message text, in English, for message id 1001, called from %1.  
.  
  
MessageId = 1002  
Severity = Success  
Facility = Application  
SymbolicName = GENERIC_INFO_MESSAGE_ID_1002  
Language=English  
My generic information message in English, for message id 1002.  
.  
  
MessageId = 1003  
Severity = Warning  
Facility = Application  
SymbolicName = GENERIC_WARNING_MESSAGE_ID_1003  
Language=English  
My generic warning message in English, for message id 1003, called from %1.  
.  
  
MessageId = 1004  
Severity = Success  
Facility = Application  
SymbolicName = UPDATE_CYCLE_COMPLETE_MESSAGE_ID_1004  
Language=English  
The update cycle is complete for %%5002.  
.  
  
MessageId = 1005  
Severity = Warning  
Facility = Application  
SymbolicName = SERVER_CONNECTION_DOWN_MESSAGE_ID_1005  
Language=English  
The refresh operation did not complete because the connection to server %1 could not be established.  
.  
  
; // - Event log display name -  
; // ********************************************************  
  
MessageId = 5001  
Severity = Success  
Facility = Application  
SymbolicName = EVENT_LOG_DISPLAY_NAME_MSGID  
Language=English  
Sample Event Log  
.  
  
; // - Event message parameters -  
; //   Language independent insertion strings  
; // ********************************************************  
  
MessageId = 5002  
Severity = Success  
Facility = Application  
SymbolicName = EVENT_LOG_SERVICE_NAME_MSGID  
Language=English  
SVC_UPDATE.EXE  
.  
```  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentException">
          <span data-ttu-id="db667-1544">
            <see cref="P:System.Diagnostics.EventLog.Source" /> 的 <see cref="T:System.Diagnostics.EventLog" /> 属性尚未设置。</span>
          <span class="sxs-lookup">
            <span data-stu-id="db667-1544">The <see cref="P:System.Diagnostics.EventLog.Source" /> property of the <see cref="T:System.Diagnostics.EventLog" /> has not been set.</span>
          </span>
          <span data-ttu-id="db667-1545">或</span>
          <span class="sxs-lookup">
            <span data-stu-id="db667-1545">-or-</span>
          </span>
          <span data-ttu-id="db667-1546">该方法尝试注册新的事件源，但 <see cref="P:System.Diagnostics.EventLog.MachineName" /> 中的计算机名称无效。</span>
          <span class="sxs-lookup">
            <span data-stu-id="db667-1546">The method attempted to register a new event source, but the computer name in <see cref="P:System.Diagnostics.EventLog.MachineName" /> is not valid.</span>
          </span>
          <span data-ttu-id="db667-1547">\- 或 -</span>
          <span class="sxs-lookup">
            <span data-stu-id="db667-1547">\- or -</span>
          </span>
          <span data-ttu-id="db667-1548">已为其他事件日志注册了该源。</span>
          <span class="sxs-lookup">
            <span data-stu-id="db667-1548">The source is already registered for a different event log.</span>
          </span>
          <span data-ttu-id="db667-1549">\- 或 -</span>
          <span class="sxs-lookup">
            <span data-stu-id="db667-1549">\- or -</span>
          </span>
          <span data-ttu-id="db667-1550">
            <paramref name="instance.InstanceId" /> 小于零或大于 <see cref="F:System.UInt16.MaxValue" />。</span>
          <span class="sxs-lookup">
            <span data-stu-id="db667-1550">
              <paramref name="instance.InstanceId" /> is less than zero or greater than <see cref="F:System.UInt16.MaxValue" />.</span>
          </span>
          <span data-ttu-id="db667-1551">\- 或 -</span>
          <span class="sxs-lookup">
            <span data-stu-id="db667-1551">\- or -</span>
          </span>
          <span data-ttu-id="db667-1552">
            <paramref name="values" /> 超过了 256 个元素。</span>
          <span class="sxs-lookup">
            <span data-stu-id="db667-1552">
              <paramref name="values" /> has more than 256 elements.</span>
          </span>
          <span data-ttu-id="db667-1553">\- 或 -</span>
          <span class="sxs-lookup">
            <span data-stu-id="db667-1553">\- or -</span>
          </span>
          <span data-ttu-id="db667-1554">
            <paramref name="values" /> 元素中有一个超过了 32766 个字节。</span>
          <span class="sxs-lookup">
            <span data-stu-id="db667-1554">One of the <paramref name="values" /> elements is longer than 32766 bytes.</span>
          </span>
          <span data-ttu-id="db667-1555">\- 或 -</span>
          <span class="sxs-lookup">
            <span data-stu-id="db667-1555">\- or -</span>
          </span>
          <span data-ttu-id="db667-1556">此源名称导致注册表项路径的长度超过 254 个字符。</span>
          <span class="sxs-lookup">
            <span data-stu-id="db667-1556">The source name results in a registry key path longer than 254 characters.</span>
          </span>
        </exception>
        <exception cref="T:System.ArgumentNullException">
          <span data-ttu-id="db667-1557">
            <paramref name="instance" /> 为 <see langword="null" />。</span>
          <span class="sxs-lookup">
            <span data-stu-id="db667-1557">
              <paramref name="instance" /> is <see langword="null" />.</span>
          </span>
        </exception>
        <exception cref="T:System.InvalidOperationException">
          <span data-ttu-id="db667-1558">事件日志的注册表项未能打开。</span>
          <span class="sxs-lookup">
            <span data-stu-id="db667-1558">The registry key for the event log could not be opened.</span>
          </span>
        </exception>
        <exception cref="T:System.ComponentModel.Win32Exception">
          <span data-ttu-id="db667-1559">将事件项写入事件日志时，操作系统报告了一个错误。</span>
          <span class="sxs-lookup">
            <span data-stu-id="db667-1559">The operating system reported an error when writing the event entry to the event log.</span>
          </span>
          <span data-ttu-id="db667-1560">一个 Windows 错误代码不可用。</span>
          <span class="sxs-lookup">
            <span data-stu-id="db667-1560">A Windows error code is not available.</span>
          </span>
        </exception>
        <permission cref="T:System.Diagnostics.EventLogPermission">
          <span data-ttu-id="db667-1561">用于写入的计算机上的事件日志信息。</span>
          <span class="sxs-lookup">
            <span data-stu-id="db667-1561">for writing the event log information on the computer.</span>
          </span>
          <span data-ttu-id="db667-1562">关联的枚举： <see cref="F:System.Diagnostics.EventLogPermissionAccess.Write" /></span>
          <span class="sxs-lookup">
            <span data-stu-id="db667-1562">Associated enumeration: <see cref="F:System.Diagnostics.EventLogPermissionAccess.Write" /></span>
          </span>
        </permission>
        <altmember cref="Overload:System.Diagnostics.EventLog.CreateEventSource" />
        <altmember cref="P:System.Diagnostics.EventLog.Source" />
        <altmember cref="P:System.Diagnostics.EventLog.Entries" />
        <altmember cref="T:System.Diagnostics.EventInstance" />
      </Docs>
    </Member>
    <Member MemberName="WriteEvent">
      <MemberSignature Language="C#" Value="public void WriteEvent (System.Diagnostics.EventInstance instance, byte[] data, params object[] values);" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig instance void WriteEvent(class System.Diagnostics.EventInstance instance, unsigned int8[] data, object[] values) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Diagnostics.EventLog.WriteEvent(System.Diagnostics.EventInstance,System.Byte[],System.Object[])" />
      <MemberSignature Language="VB.NET" Value="Public Sub WriteEvent (instance As EventInstance, data As Byte(), ParamArray values As Object())" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; void WriteEvent(System::Diagnostics::EventInstance ^ instance, cli::array &lt;System::Byte&gt; ^ data, ... cli::array &lt;System::Object ^&gt; ^ values);" />
      <MemberSignature Language="F#" Value="member this.WriteEvent : System.Diagnostics.EventInstance * byte[] * obj[] -&gt; unit" Usage="eventLog.WriteEvent (instance, data, values)" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System</AssemblyName>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Attributes>
        <Attribute FrameworkAlternate="netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;xamarinmac-3.0">
          <AttributeName>System.Runtime.InteropServices.ComVisible(false)</AttributeName>
        </Attribute>
      </Attributes>
      <ReturnValue>
        <ReturnType>System.Void</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="instance" Type="System.Diagnostics.EventInstance" />
        <Parameter Name="data" Type="System.Byte[]" />
        <Parameter Name="values" Type="System.Object[]">
          <Attributes>
            <Attribute>
              <AttributeName>System.ParamArray</AttributeName>
            </Attribute>
          </Attributes>
        </Parameter>
      </Parameters>
      <Docs>
        <param name="instance">
          <span data-ttu-id="db667-1563">表示本地化事件日志项的 <see cref="T:System.Diagnostics.EventInstance" /> 实例。</span>
          <span class="sxs-lookup">
            <span data-stu-id="db667-1563">An <see cref="T:System.Diagnostics.EventInstance" /> instance that represents a localized event log entry.</span>
          </span>
        </param>
        <param name="data">
          <span data-ttu-id="db667-1564">包含与此项关联的二进制数据的字节数组。</span>
          <span class="sxs-lookup">
            <span data-stu-id="db667-1564">An array of bytes that holds the binary data associated with the entry.</span>
          </span>
        </param>
        <param name="values">
          <span data-ttu-id="db667-1565">要合并到事件日志项的消息文本中的字符串数组。</span>
          <span class="sxs-lookup">
            <span data-stu-id="db667-1565">An array of strings to merge into the message text of the event log entry.</span>
          </span>
        </param>
        <summary>
          <span data-ttu-id="db667-1566">写入包含给定的事件数据、消息替换字符串和关联的二进制数据的事件日志项。</span>
          <span class="sxs-lookup">
            <span data-stu-id="db667-1566">Writes an event log entry with the given event data, message replacement strings, and associated binary data.</span>
          </span>
        </summary>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="db667-1567">使用此方法向事件日志写入本地化的项与其他特定于事件的数据。</span><span class="sxs-lookup"><span data-stu-id="db667-1567">Use this method to write a localized entry with additional event-specific data to the event log.</span></span> <span data-ttu-id="db667-1568">资源标识符而不是字符串值与指定的事件属性。</span><span class="sxs-lookup"><span data-stu-id="db667-1568">You specify the event properties with resource identifiers rather than string values.</span></span> <span data-ttu-id="db667-1569">事件查看器使用的资源标识符来显示的本地化的资源文件中的相应字符串<xref:System.Diagnostics.EventLog.Source%2A>。</span><span class="sxs-lookup"><span data-stu-id="db667-1569">The Event Viewer uses the resource identifiers to display the corresponding strings from the localized resource file for the <xref:System.Diagnostics.EventLog.Source%2A>.</span></span> <span data-ttu-id="db667-1570">编写使用资源标识符的事件之前，必须将源注册相应的资源文件。</span><span class="sxs-lookup"><span data-stu-id="db667-1570">You must register the source with the corresponding resource file before you write events using resource identifiers.</span></span>  
  
 <span data-ttu-id="db667-1571">输入`instance`实例指定的事件消息和属性。</span><span class="sxs-lookup"><span data-stu-id="db667-1571">The input `instance` instance specifies the event message and properties.</span></span> <span data-ttu-id="db667-1572">设置<xref:System.Diagnostics.EventInstance.InstanceId%2A>的`instance`源消息资源文件中定义的消息的输入。</span><span class="sxs-lookup"><span data-stu-id="db667-1572">Set the <xref:System.Diagnostics.EventInstance.InstanceId%2A> of the `instance` input for the defined message in the source message resource file.</span></span> <span data-ttu-id="db667-1573">可以选择性地设置<xref:System.Diagnostics.EventInstance.CategoryId%2A>并<xref:System.Diagnostics.EventInstance.EntryType%2A>的`instance`输入来定义事件条目的类别和事件类型。</span><span class="sxs-lookup"><span data-stu-id="db667-1573">You can optionally set the <xref:System.Diagnostics.EventInstance.CategoryId%2A> and <xref:System.Diagnostics.EventInstance.EntryType%2A> of the `instance` input to define the category and event type of your event entry.</span></span> <span data-ttu-id="db667-1574">此外可以指定一个要插入到本地化的消息文本的独立于语言的字符串数组。</span><span class="sxs-lookup"><span data-stu-id="db667-1574">You can also specify an array of language-independent strings to insert into the localized message text.</span></span> <span data-ttu-id="db667-1575">设置`values`到`null`如果事件消息不包含替换字符串的格式设置占位符。</span><span class="sxs-lookup"><span data-stu-id="db667-1575">Set `values` to `null` if the event message does not contain formatting placeholders for replacement strings.</span></span>  
  
 <span data-ttu-id="db667-1576">使用事件时需要为事件提供更多详细信息中指定的二进制数据。</span><span class="sxs-lookup"><span data-stu-id="db667-1576">Specify binary data with an event when it is necessary to provide additional details for the event.</span></span> <span data-ttu-id="db667-1577">例如，使用`data`参数，以包括有关特定错误的信息。</span><span class="sxs-lookup"><span data-stu-id="db667-1577">For example, use the `data` parameter to include information on a specific error.</span></span> <span data-ttu-id="db667-1578">事件查看器不会解释关联的事件数据中;它采用组合的十六进制转义序列和文本格式显示的数据。</span><span class="sxs-lookup"><span data-stu-id="db667-1578">The Event Viewer does not interpret the associated event data; it displays the data in a combined hexadecimal and text format.</span></span> <span data-ttu-id="db667-1579">使用特定于事件的数据很谨慎;仅当你确信将很有用，包括它。</span><span class="sxs-lookup"><span data-stu-id="db667-1579">Use event-specific data sparingly; include it only if you are sure it will be useful.</span></span> <span data-ttu-id="db667-1580">特定于事件的数据还可用于存储应用程序可以处理独立于事件查看器的信息。</span><span class="sxs-lookup"><span data-stu-id="db667-1580">You can also use event-specific data to store information the application can process independently of the Event Viewer.</span></span> <span data-ttu-id="db667-1581">例如，可以专门为您的活动，编写一个查看器或编写一个程序来扫描事件日志并创建报告，包括来自特定于事件的数据的信息。</span><span class="sxs-lookup"><span data-stu-id="db667-1581">For example, you could write a viewer specifically for your events, or write a program that scans the event log and creates reports that include information from the event-specific data.</span></span>  
  
 <span data-ttu-id="db667-1582">必须设置<xref:System.Diagnostics.EventLog.Source%2A>属性上的你<xref:System.Diagnostics.EventLog>组件之前使用的组件之前<xref:System.Diagnostics.EventLog.WriteEvent%2A>。</span><span class="sxs-lookup"><span data-stu-id="db667-1582">You must set the <xref:System.Diagnostics.EventLog.Source%2A> property on your <xref:System.Diagnostics.EventLog> component before component before using <xref:System.Diagnostics.EventLog.WriteEvent%2A>.</span></span> <span data-ttu-id="db667-1583">指定的源必须配置用于本地化的项写入事件日志中。源最小值必须具有一个用于定义消息资源文件。</span><span class="sxs-lookup"><span data-stu-id="db667-1583">The specified source must be configured for writing localized entries to the log; the source must at minimum have a message resource file defined.</span></span>  
  
 <span data-ttu-id="db667-1584">必须创建并写入与源的第一项之前配置的事件源。</span><span class="sxs-lookup"><span data-stu-id="db667-1584">You must create and configure the event source before writing the first entry with the source.</span></span> <span data-ttu-id="db667-1585">在应用程序的安装过程中创建新的事件源。</span><span class="sxs-lookup"><span data-stu-id="db667-1585">Create the new event source during the installation of your application.</span></span> <span data-ttu-id="db667-1586">这允许操作系统以刷新其注册的事件源的列表和其配置的时间。</span><span class="sxs-lookup"><span data-stu-id="db667-1586">This allows time for the operating system to refresh its list of registered event sources and their configuration.</span></span> <span data-ttu-id="db667-1587">如果操作系统没有刷新其事件源的列表，并且尝试写入新的源的事件写入操作将失败。</span><span class="sxs-lookup"><span data-stu-id="db667-1587">If the operating system has not refreshed its list of event sources, and you attempt to write an event with the new source, the write operation will fail.</span></span> <span data-ttu-id="db667-1588">可以配置新的源使用<xref:System.Diagnostics.EventLogInstaller>，或使用<xref:System.Diagnostics.EventLog.CreateEventSource%2A>方法。</span><span class="sxs-lookup"><span data-stu-id="db667-1588">You can configure a new source using an <xref:System.Diagnostics.EventLogInstaller>, or using the <xref:System.Diagnostics.EventLog.CreateEventSource%2A> method.</span></span> <span data-ttu-id="db667-1589">若要创建新的事件源的计算机上，必须具有管理权限。</span><span class="sxs-lookup"><span data-stu-id="db667-1589">You must have administrative rights on the computer to create a new event source.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="db667-1590">如果未指定<xref:System.Diagnostics.EventLog.MachineName%2A>为你<xref:System.Diagnostics.EventLog>实例，然后才能调用<xref:System.Diagnostics.EventLog.WriteEvent%2A>，本地计算机 ("。") 假定。</span><span class="sxs-lookup"><span data-stu-id="db667-1590">If you do not specify a <xref:System.Diagnostics.EventLog.MachineName%2A> for your <xref:System.Diagnostics.EventLog> instance before you call <xref:System.Diagnostics.EventLog.WriteEvent%2A>, the local computer (".") is assumed.</span></span>  
  
 <span data-ttu-id="db667-1591">要写入本地化的项还是要直接写入字符串，必须配置源。</span><span class="sxs-lookup"><span data-stu-id="db667-1591">The source must be configured either for writing localized entries or for writing direct strings.</span></span> <span data-ttu-id="db667-1592">使用<xref:System.Diagnostics.EventLog.WriteEntry%2A>方法如果你的应用程序将直接写入事件日志的字符串值。</span><span class="sxs-lookup"><span data-stu-id="db667-1592">Use the <xref:System.Diagnostics.EventLog.WriteEntry%2A> method if your application writes string values directly to the event log.</span></span>  
  
 <span data-ttu-id="db667-1593">如果你的应用程序将使用资源标识符和字符串值的条目写入，则必须注册两个单独的源。</span><span class="sxs-lookup"><span data-stu-id="db667-1593">If your application writes entries using both resource identifiers and string values, you must register two separate sources.</span></span> <span data-ttu-id="db667-1594">例如，配置一个源的资源文件，以及如何将该源中的<xref:System.Diagnostics.EventLog.WriteEvent%2A>方法来编写使用资源标识符添加到事件日志条目。</span><span class="sxs-lookup"><span data-stu-id="db667-1594">For example, configure one source with resource files, and then use that source in the <xref:System.Diagnostics.EventLog.WriteEvent%2A> method to write entries using resource identifiers to the event log.</span></span> <span data-ttu-id="db667-1595">然后创建不同的源，而无需资源文件，并使用在该源<xref:System.Diagnostics.EventLog.WriteEntry%2A>方法将字符串直接写入事件日志使用的源。</span><span class="sxs-lookup"><span data-stu-id="db667-1595">Then create a different source without resource files, and use that source in the <xref:System.Diagnostics.EventLog.WriteEntry%2A> method to write strings directly to the event log using that source.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="db667-1596">如果您向远程计算机的值写入条目`message`字符串可能不会与预期如果远程计算机未运行.NET Framework。</span><span class="sxs-lookup"><span data-stu-id="db667-1596">If you write an entry to a remote computer, the value of the `message` string might not be what you expect if the remote computer is not running the .NET Framework.</span></span> <span data-ttu-id="db667-1597">此外，`message`字符串不能包含 %*n*，其中*n*是一个整数值 (例如，%1)，因为事件查看器将其视为插入字符串。</span><span class="sxs-lookup"><span data-stu-id="db667-1597">Also, the `message` string cannot contain %*n*, where *n* is an integer value (for example, %1), because the event viewer treats it as an insertion string.</span></span> <span data-ttu-id="db667-1598">Internet 协议版本 6 (IPv6) 地址可以包含此字符序列，因为无法记录事件消息包含 IPv6 地址。</span><span class="sxs-lookup"><span data-stu-id="db667-1598">Because an Internet Protocol, version 6 (IPv6) address can contain this character sequence, you cannot log an event message that contains an IPv6 address.</span></span>  
  
   
  
## Examples  
 <span data-ttu-id="db667-1599">下面的示例将两个审核项写入事件日志`myNewLog`。</span><span class="sxs-lookup"><span data-stu-id="db667-1599">The following example writes two audit entries to the event log `myNewLog`.</span></span> <span data-ttu-id="db667-1600">如果在本地计算机上不存在，该示例创建一个新的事件源和一个新的事件日志。</span><span class="sxs-lookup"><span data-stu-id="db667-1600">The example creates a new event source and a new event log if they do not exist on the local computer.</span></span> <span data-ttu-id="db667-1601">事件消息文本被指定的资源文件中使用的资源标识符。</span><span class="sxs-lookup"><span data-stu-id="db667-1601">The event message text is specified using a resource identifier in a resource file.</span></span>  
  
 [!code-cpp[EventLog_WriteEvent#7](~/samples/snippets/cpp/VS_Snippets_CLR/eventlog_WriteEvent/CPP/source.cpp#7)]
 [!code-csharp[EventLog_WriteEvent#7](~/samples/snippets/csharp/VS_Snippets_CLR/eventlog_WriteEvent/CS/source.cs#7)]
 [!code-vb[EventLog_WriteEvent#7](~/samples/snippets/visualbasic/VS_Snippets_CLR/eventlog_WriteEvent/VB/source.vb#7)]  
  
 <span data-ttu-id="db667-1602">该示例使用下面的消息文本文件，内置的资源库 EventLogMsgs.dll。</span><span class="sxs-lookup"><span data-stu-id="db667-1602">The example uses the following message text file, built into the resource library EventLogMsgs.dll.</span></span> <span data-ttu-id="db667-1603">消息文本文件是从其创建的消息资源文件的源。</span><span class="sxs-lookup"><span data-stu-id="db667-1603">A message text file is the source from which the message resource file is created.</span></span> <span data-ttu-id="db667-1604">消息文本文件定义的资源标识符和类别、 事件消息和参数插入字符串的文本。</span><span class="sxs-lookup"><span data-stu-id="db667-1604">The message text file defines the resource identifiers and text for the category, event message, and parameter insertion strings.</span></span>  
  
```  
; // EventLogMsgs.mc  
; // ********************************************************  
  
; // Use the following commands to build this file:  
  
; //   mc -s EventLogMsgs.mc  
; //   rc EventLogMsgs.rc  
; //   link /DLL /SUBSYSTEM:WINDOWS /NOENTRY /MACHINE:x86 EventLogMsgs.Res   
; // ********************************************************  
  
; // - Event categories -  
; // Categories must be numbered consecutively starting at 1.  
; // ********************************************************  
  
MessageId=0x1  
Severity=Success  
SymbolicName=INSTALL_CATEGORY  
Language=English  
Installation  
.  
  
MessageId=0x2  
Severity=Success  
SymbolicName=QUERY_CATEGORY  
Language=English  
Database Query  
.  
  
MessageId=0x3  
Severity=Success  
SymbolicName=REFRESH_CATEGORY  
Language=English  
Data Refresh  
.  
  
; // - Event messages -  
; // *********************************  
  
MessageId = 1000  
Severity = Success  
Facility = Application  
SymbolicName = AUDIT_SUCCESS_MESSAGE_ID_1000  
Language=English  
My application message text, in English, for message id 1000, called from %1.  
.  
  
MessageId = 1001  
Severity = Warning  
Facility = Application  
SymbolicName = AUDIT_FAILED_MESSAGE_ID_1001  
Language=English  
My application message text, in English, for message id 1001, called from %1.  
.  
  
MessageId = 1002  
Severity = Success  
Facility = Application  
SymbolicName = GENERIC_INFO_MESSAGE_ID_1002  
Language=English  
My generic information message in English, for message id 1002.  
.  
  
MessageId = 1003  
Severity = Warning  
Facility = Application  
SymbolicName = GENERIC_WARNING_MESSAGE_ID_1003  
Language=English  
My generic warning message in English, for message id 1003, called from %1.  
.  
  
MessageId = 1004  
Severity = Success  
Facility = Application  
SymbolicName = UPDATE_CYCLE_COMPLETE_MESSAGE_ID_1004  
Language=English  
The update cycle is complete for %%5002.  
.  
  
MessageId = 1005  
Severity = Warning  
Facility = Application  
SymbolicName = SERVER_CONNECTION_DOWN_MESSAGE_ID_1005  
Language=English  
The refresh operation did not complete because the connection to server %1 could not be established.  
.  
  
; // - Event log display name -  
; // ********************************************************  
  
MessageId = 5001  
Severity = Success  
Facility = Application  
SymbolicName = EVENT_LOG_DISPLAY_NAME_MSGID  
Language=English  
Sample Event Log  
.  
  
; // - Event message parameters -  
; //   Language independent insertion strings  
; // ********************************************************  
  
MessageId = 5002  
Severity = Success  
Facility = Application  
SymbolicName = EVENT_LOG_SERVICE_NAME_MSGID  
Language=English  
SVC_UPDATE.EXE  
.  
```  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentException">
          <span data-ttu-id="db667-1605">
            <see cref="P:System.Diagnostics.EventLog.Source" /> 的 <see cref="T:System.Diagnostics.EventLog" /> 属性尚未设置。</span>
          <span class="sxs-lookup">
            <span data-stu-id="db667-1605">The <see cref="P:System.Diagnostics.EventLog.Source" /> property of the <see cref="T:System.Diagnostics.EventLog" /> has not been set.</span>
          </span>
          <span data-ttu-id="db667-1606">或</span>
          <span class="sxs-lookup">
            <span data-stu-id="db667-1606">-or-</span>
          </span>
          <span data-ttu-id="db667-1607">该方法尝试注册新的事件源，但 <see cref="P:System.Diagnostics.EventLog.MachineName" /> 中的计算机名称无效。</span>
          <span class="sxs-lookup">
            <span data-stu-id="db667-1607">The method attempted to register a new event source, but the computer name in <see cref="P:System.Diagnostics.EventLog.MachineName" /> is not valid.</span>
          </span>
          <span data-ttu-id="db667-1608">\- 或 -</span>
          <span class="sxs-lookup">
            <span data-stu-id="db667-1608">\- or -</span>
          </span>
          <span data-ttu-id="db667-1609">已为其他事件日志注册了该源。</span>
          <span class="sxs-lookup">
            <span data-stu-id="db667-1609">The source is already registered for a different event log.</span>
          </span>
          <span data-ttu-id="db667-1610">\- 或 -</span>
          <span class="sxs-lookup">
            <span data-stu-id="db667-1610">\- or -</span>
          </span>
          <span data-ttu-id="db667-1611">
            <paramref name="instance.InstanceId" /> 小于零或大于 <see cref="F:System.UInt16.MaxValue" />。</span>
          <span class="sxs-lookup">
            <span data-stu-id="db667-1611">
              <paramref name="instance.InstanceId" /> is less than zero or greater than <see cref="F:System.UInt16.MaxValue" />.</span>
          </span>
          <span data-ttu-id="db667-1612">\- 或 -</span>
          <span class="sxs-lookup">
            <span data-stu-id="db667-1612">\- or -</span>
          </span>
          <span data-ttu-id="db667-1613">
            <paramref name="values" /> 超过了 256 个元素。</span>
          <span class="sxs-lookup">
            <span data-stu-id="db667-1613">
              <paramref name="values" /> has more than 256 elements.</span>
          </span>
          <span data-ttu-id="db667-1614">\- 或 -</span>
          <span class="sxs-lookup">
            <span data-stu-id="db667-1614">\- or -</span>
          </span>
          <span data-ttu-id="db667-1615">
            <paramref name="values" /> 元素中有一个超过了 32766 个字节。</span>
          <span class="sxs-lookup">
            <span data-stu-id="db667-1615">One of the <paramref name="values" /> elements is longer than 32766 bytes.</span>
          </span>
          <span data-ttu-id="db667-1616">\- 或 -</span>
          <span class="sxs-lookup">
            <span data-stu-id="db667-1616">\- or -</span>
          </span>
          <span data-ttu-id="db667-1617">此源名称导致注册表项路径的长度超过 254 个字符。</span>
          <span class="sxs-lookup">
            <span data-stu-id="db667-1617">The source name results in a registry key path longer than 254 characters.</span>
          </span>
        </exception>
        <exception cref="T:System.ArgumentNullException">
          <span data-ttu-id="db667-1618">
            <paramref name="instance" /> 为 <see langword="null" />。</span>
          <span class="sxs-lookup">
            <span data-stu-id="db667-1618">
              <paramref name="instance" /> is <see langword="null" />.</span>
          </span>
        </exception>
        <exception cref="T:System.InvalidOperationException">
          <span data-ttu-id="db667-1619">事件日志的注册表项未能打开。</span>
          <span class="sxs-lookup">
            <span data-stu-id="db667-1619">The registry key for the event log could not be opened.</span>
          </span>
        </exception>
        <exception cref="T:System.ComponentModel.Win32Exception">
          <span data-ttu-id="db667-1620">将事件项写入事件日志时，操作系统报告了一个错误。</span>
          <span class="sxs-lookup">
            <span data-stu-id="db667-1620">The operating system reported an error when writing the event entry to the event log.</span>
          </span>
          <span data-ttu-id="db667-1621">一个 Windows 错误代码不可用。</span>
          <span class="sxs-lookup">
            <span data-stu-id="db667-1621">A Windows error code is not available.</span>
          </span>
        </exception>
        <permission cref="T:System.Diagnostics.EventLogPermission">
          <span data-ttu-id="db667-1622">用于写入的计算机上的事件日志信息。</span>
          <span class="sxs-lookup">
            <span data-stu-id="db667-1622">for writing the event log information on the computer.</span>
          </span>
          <span data-ttu-id="db667-1623">关联的枚举： <see cref="F:System.Diagnostics.EventLogPermissionAccess.Write" /></span>
          <span class="sxs-lookup">
            <span data-stu-id="db667-1623">Associated enumeration: <see cref="F:System.Diagnostics.EventLogPermissionAccess.Write" /></span>
          </span>
        </permission>
        <altmember cref="Overload:System.Diagnostics.EventLog.CreateEventSource" />
        <altmember cref="P:System.Diagnostics.EventLog.Source" />
        <altmember cref="P:System.Diagnostics.EventLog.Entries" />
        <altmember cref="T:System.Diagnostics.EventInstance" />
      </Docs>
    </Member>
    <Member MemberName="WriteEvent">
      <MemberSignature Language="C#" Value="public static void WriteEvent (string source, System.Diagnostics.EventInstance instance, params object[] values);" />
      <MemberSignature Language="ILAsm" Value=".method public static hidebysig void WriteEvent(string source, class System.Diagnostics.EventInstance instance, object[] values) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Diagnostics.EventLog.WriteEvent(System.String,System.Diagnostics.EventInstance,System.Object[])" />
      <MemberSignature Language="VB.NET" Value="Public Shared Sub WriteEvent (source As String, instance As EventInstance, ParamArray values As Object())" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; static void WriteEvent(System::String ^ source, System::Diagnostics::EventInstance ^ instance, ... cli::array &lt;System::Object ^&gt; ^ values);" />
      <MemberSignature Language="F#" Value="static member WriteEvent : string * System.Diagnostics.EventInstance * obj[] -&gt; unit" Usage="System.Diagnostics.EventLog.WriteEvent (source, instance, values)" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System</AssemblyName>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Void</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="source" Type="System.String" />
        <Parameter Name="instance" Type="System.Diagnostics.EventInstance" />
        <Parameter Name="values" Type="System.Object[]">
          <Attributes>
            <Attribute>
              <AttributeName>System.ParamArray</AttributeName>
            </Attribute>
          </Attributes>
        </Parameter>
      </Parameters>
      <Docs>
        <param name="source">
          <span data-ttu-id="db667-1624">在指定的计算机上为应用程序注册的事件源的名称。</span>
          <span class="sxs-lookup">
            <span data-stu-id="db667-1624">The name of the event source registered for the application on the specified computer.</span>
          </span>
        </param>
        <param name="instance">
          <span data-ttu-id="db667-1625">表示本地化事件日志项的 <see cref="T:System.Diagnostics.EventInstance" /> 实例。</span>
          <span class="sxs-lookup">
            <span data-stu-id="db667-1625">An <see cref="T:System.Diagnostics.EventInstance" /> instance that represents a localized event log entry.</span>
          </span>
        </param>
        <param name="values">
          <span data-ttu-id="db667-1626">要合并到事件日志项的消息文本中的字符串数组。</span>
          <span class="sxs-lookup">
            <span data-stu-id="db667-1626">An array of strings to merge into the message text of the event log entry.</span>
          </span>
        </param>
        <summary>
          <span data-ttu-id="db667-1627">使用指定的已注册事件源写入包含给定事件数据和消息替换字符串的事件日志项。</span>
          <span class="sxs-lookup">
            <span data-stu-id="db667-1627">Writes an event log entry with the given event data and message replacement strings, using the specified registered event source.</span>
          </span>
        </summary>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="db667-1628">使用此方法将使用已注册为相应的日志的事件源的源的事件日志写入本地化的项。</span><span class="sxs-lookup"><span data-stu-id="db667-1628">Use this method to write a localized entry to the event log, using a source already registered as an event source for the appropriate log.</span></span> <span data-ttu-id="db667-1629">资源标识符而不是字符串值与指定的事件属性。</span><span class="sxs-lookup"><span data-stu-id="db667-1629">You specify the event properties with resource identifiers rather than string values.</span></span> <span data-ttu-id="db667-1630">事件查看器使用的资源标识符来显示源的本地化的资源文件中的相应字符串。</span><span class="sxs-lookup"><span data-stu-id="db667-1630">The Event Viewer uses the resource identifiers to display the corresponding strings from the localized resource file for the source.</span></span> <span data-ttu-id="db667-1631">编写使用资源标识符的事件之前，必须将源注册相应的资源文件。</span><span class="sxs-lookup"><span data-stu-id="db667-1631">You must register the source with the corresponding resource file before you write events using resource identifiers.</span></span>  
  
 <span data-ttu-id="db667-1632">输入`instance`实例指定的事件消息和属性。</span><span class="sxs-lookup"><span data-stu-id="db667-1632">The input `instance` instance specifies the event message and properties.</span></span> <span data-ttu-id="db667-1633">设置<xref:System.Diagnostics.EventInstance.InstanceId%2A>的`instance`源消息资源文件中定义的消息的输入。</span><span class="sxs-lookup"><span data-stu-id="db667-1633">Set the <xref:System.Diagnostics.EventInstance.InstanceId%2A> of the `instance` input for the defined message in the source message resource file.</span></span> <span data-ttu-id="db667-1634">可以选择性地设置<xref:System.Diagnostics.EventInstance.CategoryId%2A>并<xref:System.Diagnostics.EventInstance.EntryType%2A>的`instance`输入来定义事件条目的类别和事件类型。</span><span class="sxs-lookup"><span data-stu-id="db667-1634">You can optionally set the <xref:System.Diagnostics.EventInstance.CategoryId%2A> and <xref:System.Diagnostics.EventInstance.EntryType%2A> of the `instance` input to define the category and event type of your event entry.</span></span> <span data-ttu-id="db667-1635">此外可以指定一个要插入到本地化的消息文本的独立于语言的字符串数组。</span><span class="sxs-lookup"><span data-stu-id="db667-1635">You can also specify an array of language-independent strings to insert into the localized message text.</span></span> <span data-ttu-id="db667-1636">设置`values`到`null`如果事件消息不包含替换字符串的格式设置占位符。</span><span class="sxs-lookup"><span data-stu-id="db667-1636">Set `values` to `null` if the event message does not contain formatting placeholders for replacement strings.</span></span>  
  
 <span data-ttu-id="db667-1637">指定的源必须在使用之前注册为事件日志<xref:System.Diagnostics.EventLog.WriteEvent%2A>。</span><span class="sxs-lookup"><span data-stu-id="db667-1637">The specified source must be registered for an event log before using <xref:System.Diagnostics.EventLog.WriteEvent%2A>.</span></span> <span data-ttu-id="db667-1638">指定的源必须配置用于本地化的项写入事件日志中。源最小值必须具有一个用于定义消息资源文件。</span><span class="sxs-lookup"><span data-stu-id="db667-1638">The specified source must be configured for writing localized entries to the log; the source must at minimum have a message resource file defined.</span></span>  
  
 <span data-ttu-id="db667-1639">必须创建并写入与源的第一项之前配置的事件源。</span><span class="sxs-lookup"><span data-stu-id="db667-1639">You must create and configure the event source before writing the first entry with the source.</span></span> <span data-ttu-id="db667-1640">在应用程序的安装过程中创建新的事件源。</span><span class="sxs-lookup"><span data-stu-id="db667-1640">Create the new event source during the installation of your application.</span></span> <span data-ttu-id="db667-1641">这允许操作系统以刷新其注册的事件源的列表和其配置的时间。</span><span class="sxs-lookup"><span data-stu-id="db667-1641">This allows time for the operating system to refresh its list of registered event sources and their configuration.</span></span> <span data-ttu-id="db667-1642">如果操作系统没有刷新其事件源的列表，并且尝试写入新的源的事件写入操作将失败。</span><span class="sxs-lookup"><span data-stu-id="db667-1642">If the operating system has not refreshed its list of event sources, and you attempt to write an event with the new source, the write operation will fail.</span></span> <span data-ttu-id="db667-1643">可以配置新的源使用<xref:System.Diagnostics.EventLogInstaller>，或使用<xref:System.Diagnostics.EventLog.CreateEventSource%2A>方法。</span><span class="sxs-lookup"><span data-stu-id="db667-1643">You can configure a new source using an <xref:System.Diagnostics.EventLogInstaller>, or using the <xref:System.Diagnostics.EventLog.CreateEventSource%2A> method.</span></span> <span data-ttu-id="db667-1644">若要创建新的事件源的计算机上，必须具有管理权限。</span><span class="sxs-lookup"><span data-stu-id="db667-1644">You must have administrative rights on the computer to create a new event source.</span></span>  
  
 <span data-ttu-id="db667-1645">要写入本地化的项还是要直接写入字符串，必须配置源。</span><span class="sxs-lookup"><span data-stu-id="db667-1645">The source must be configured either for writing localized entries or for writing direct strings.</span></span> <span data-ttu-id="db667-1646">使用<xref:System.Diagnostics.EventLog.WriteEntry%2A>方法如果你的应用程序将直接写入事件日志的字符串值。</span><span class="sxs-lookup"><span data-stu-id="db667-1646">Use the <xref:System.Diagnostics.EventLog.WriteEntry%2A> method if your application writes string values directly to the event log.</span></span>  
  
 <span data-ttu-id="db667-1647">如果你的应用程序将使用资源标识符和字符串值的条目写入，则必须注册两个单独的源。</span><span class="sxs-lookup"><span data-stu-id="db667-1647">If your application writes entries using both resource identifiers and string values, you must register two separate sources.</span></span> <span data-ttu-id="db667-1648">例如，配置一个源的资源文件，以及如何将该源中的<xref:System.Diagnostics.EventLog.WriteEvent%2A>方法来编写使用资源标识符添加到事件日志条目。</span><span class="sxs-lookup"><span data-stu-id="db667-1648">For example, configure one source with resource files, and then use that source in the <xref:System.Diagnostics.EventLog.WriteEvent%2A> method to write entries using resource identifiers to the event log.</span></span> <span data-ttu-id="db667-1649">然后创建不同的源，而无需资源文件，并使用在该源<xref:System.Diagnostics.EventLog.WriteEntry%2A>方法将字符串直接写入事件日志使用的源。</span><span class="sxs-lookup"><span data-stu-id="db667-1649">Then create a different source without resource files, and use that source in the <xref:System.Diagnostics.EventLog.WriteEntry%2A> method to write strings directly to the event log using that source.</span></span>  
  
   
  
## Examples  
 <span data-ttu-id="db667-1650">下面的示例将信息性事件条目和警告事件条目写入到现有的事件日志。</span><span class="sxs-lookup"><span data-stu-id="db667-1650">The following example writes an informational event entry and a warning event entry to an existing event log.</span></span> <span data-ttu-id="db667-1651">事件消息文本被指定的资源文件中使用的资源标识符。</span><span class="sxs-lookup"><span data-stu-id="db667-1651">The event message text is specified using a resource identifier in a resource file.</span></span> <span data-ttu-id="db667-1652">该示例假定已为源中注册相应的资源文件。</span><span class="sxs-lookup"><span data-stu-id="db667-1652">The example assumes the corresponding resource file has been registered for the source.</span></span>  
  
 [!code-cpp[EventLog_WriteEvent#8](~/samples/snippets/cpp/VS_Snippets_CLR/eventlog_WriteEvent/CPP/source.cpp#8)]
 [!code-csharp[EventLog_WriteEvent#8](~/samples/snippets/csharp/VS_Snippets_CLR/eventlog_WriteEvent/CS/source.cs#8)]
 [!code-vb[EventLog_WriteEvent#8](~/samples/snippets/visualbasic/VS_Snippets_CLR/eventlog_WriteEvent/VB/source.vb#8)]  
  
 <span data-ttu-id="db667-1653">该示例使用下面的消息文本文件，内置的资源库 EventLogMsgs.dll。</span><span class="sxs-lookup"><span data-stu-id="db667-1653">The example uses the following message text file, built into the resource library EventLogMsgs.dll.</span></span> <span data-ttu-id="db667-1654">消息文本文件是从其创建的消息资源文件的源。</span><span class="sxs-lookup"><span data-stu-id="db667-1654">A message text file is the source from which the message resource file is created.</span></span> <span data-ttu-id="db667-1655">消息文本文件定义的资源标识符和类别、 事件消息和参数插入字符串的文本。</span><span class="sxs-lookup"><span data-stu-id="db667-1655">The message text file defines the resource identifiers and text for the category, event message, and parameter insertion strings.</span></span>  
  
```  
; // EventLogMsgs.mc  
; // ********************************************************  
  
; // Use the following commands to build this file:  
  
; //   mc -s EventLogMsgs.mc  
; //   rc EventLogMsgs.rc  
; //   link /DLL /SUBSYSTEM:WINDOWS /NOENTRY /MACHINE:x86 EventLogMsgs.Res   
; // ********************************************************  
  
; // - Event categories -  
; // Categories must be numbered consecutively starting at 1.  
; // ********************************************************  
  
MessageId=0x1  
Severity=Success  
SymbolicName=INSTALL_CATEGORY  
Language=English  
Installation  
.  
  
MessageId=0x2  
Severity=Success  
SymbolicName=QUERY_CATEGORY  
Language=English  
Database Query  
.  
  
MessageId=0x3  
Severity=Success  
SymbolicName=REFRESH_CATEGORY  
Language=English  
Data Refresh  
.  
  
; // - Event messages -  
; // *********************************  
  
MessageId = 1000  
Severity = Success  
Facility = Application  
SymbolicName = AUDIT_SUCCESS_MESSAGE_ID_1000  
Language=English  
My application message text, in English, for message id 1000, called from %1.  
.  
  
MessageId = 1001  
Severity = Warning  
Facility = Application  
SymbolicName = AUDIT_FAILED_MESSAGE_ID_1001  
Language=English  
My application message text, in English, for message id 1001, called from %1.  
.  
  
MessageId = 1002  
Severity = Success  
Facility = Application  
SymbolicName = GENERIC_INFO_MESSAGE_ID_1002  
Language=English  
My generic information message in English, for message id 1002.  
.  
  
MessageId = 1003  
Severity = Warning  
Facility = Application  
SymbolicName = GENERIC_WARNING_MESSAGE_ID_1003  
Language=English  
My generic warning message in English, for message id 1003, called from %1.  
.  
  
MessageId = 1004  
Severity = Success  
Facility = Application  
SymbolicName = UPDATE_CYCLE_COMPLETE_MESSAGE_ID_1004  
Language=English  
The update cycle is complete for %%5002.  
.  
  
MessageId = 1005  
Severity = Warning  
Facility = Application  
SymbolicName = SERVER_CONNECTION_DOWN_MESSAGE_ID_1005  
Language=English  
The refresh operation did not complete because the connection to server %1 could not be established.  
.  
  
; // - Event log display name -  
; // ********************************************************  
  
MessageId = 5001  
Severity = Success  
Facility = Application  
SymbolicName = EVENT_LOG_DISPLAY_NAME_MSGID  
Language=English  
Sample Event Log  
.  
  
; // - Event message parameters -  
; //   Language independent insertion strings  
; // ********************************************************  
  
MessageId = 5002  
Severity = Success  
Facility = Application  
SymbolicName = EVENT_LOG_SERVICE_NAME_MSGID  
Language=English  
SVC_UPDATE.EXE  
.  
```  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentException">
          <span data-ttu-id="db667-1656">
            <paramref name="source" /> 值是空字符串 ("")。</span>
          <span class="sxs-lookup">
            <span data-stu-id="db667-1656">The <paramref name="source" /> value is an empty string ("").</span>
          </span>
          <span data-ttu-id="db667-1657">\- 或 -</span>
          <span class="sxs-lookup">
            <span data-stu-id="db667-1657">\- or -</span>
          </span>
          <span data-ttu-id="db667-1658">
            <paramref name="source" /> 值为 <see langword="null" />。</span>
          <span class="sxs-lookup">
            <span data-stu-id="db667-1658">The <paramref name="source" /> value is <see langword="null" />.</span>
          </span>
          <span data-ttu-id="db667-1659">\- 或 -</span>
          <span class="sxs-lookup">
            <span data-stu-id="db667-1659">\- or -</span>
          </span>
          <span data-ttu-id="db667-1660">
            <paramref name="instance.InstanceId" /> 小于零或大于 <see cref="F:System.UInt16.MaxValue" />。</span>
          <span class="sxs-lookup">
            <span data-stu-id="db667-1660">
              <paramref name="instance.InstanceId" /> is less than zero or greater than <see cref="F:System.UInt16.MaxValue" />.</span>
          </span>
          <span data-ttu-id="db667-1661">\- 或 -</span>
          <span class="sxs-lookup">
            <span data-stu-id="db667-1661">\- or -</span>
          </span>
          <span data-ttu-id="db667-1662">
            <paramref name="values" /> 超过了 256 个元素。</span>
          <span class="sxs-lookup">
            <span data-stu-id="db667-1662">
              <paramref name="values" /> has more than 256 elements.</span>
          </span>
          <span data-ttu-id="db667-1663">\- 或 -</span>
          <span class="sxs-lookup">
            <span data-stu-id="db667-1663">\- or -</span>
          </span>
          <span data-ttu-id="db667-1664">
            <paramref name="values" /> 元素中有一个超过了 32766 个字节。</span>
          <span class="sxs-lookup">
            <span data-stu-id="db667-1664">One of the <paramref name="values" /> elements is longer than 32766 bytes.</span>
          </span>
          <span data-ttu-id="db667-1665">\- 或 -</span>
          <span class="sxs-lookup">
            <span data-stu-id="db667-1665">\- or -</span>
          </span>
          <span data-ttu-id="db667-1666">此源名称导致注册表项路径的长度超过 254 个字符。</span>
          <span class="sxs-lookup">
            <span data-stu-id="db667-1666">The source name results in a registry key path longer than 254 characters.</span>
          </span>
        </exception>
        <exception cref="T:System.ArgumentNullException">
          <span data-ttu-id="db667-1667">
            <paramref name="instance" /> 为 <see langword="null" />。</span>
          <span class="sxs-lookup">
            <span data-stu-id="db667-1667">
              <paramref name="instance" /> is <see langword="null" />.</span>
          </span>
        </exception>
        <exception cref="T:System.InvalidOperationException">
          <span data-ttu-id="db667-1668">事件日志的注册表项未能打开。</span>
          <span class="sxs-lookup">
            <span data-stu-id="db667-1668">The registry key for the event log could not be opened.</span>
          </span>
        </exception>
        <exception cref="T:System.ComponentModel.Win32Exception">
          <span data-ttu-id="db667-1669">将事件项写入事件日志时，操作系统报告了一个错误。</span>
          <span class="sxs-lookup">
            <span data-stu-id="db667-1669">The operating system reported an error when writing the event entry to the event log.</span>
          </span>
          <span data-ttu-id="db667-1670">一个 Windows 错误代码不可用。</span>
          <span class="sxs-lookup">
            <span data-stu-id="db667-1670">A Windows error code is not available.</span>
          </span>
        </exception>
        <permission cref="T:System.Diagnostics.EventLogPermission">
          <span data-ttu-id="db667-1671">用于写入的计算机上的事件日志信息。</span>
          <span class="sxs-lookup">
            <span data-stu-id="db667-1671">for writing the event log information on the computer.</span>
          </span>
          <span data-ttu-id="db667-1672">关联的枚举： <see cref="F:System.Diagnostics.EventLogPermissionAccess.Write" /></span>
          <span class="sxs-lookup">
            <span data-stu-id="db667-1672">Associated enumeration: <see cref="F:System.Diagnostics.EventLogPermissionAccess.Write" /></span>
          </span>
        </permission>
        <altmember cref="Overload:System.Diagnostics.EventLog.CreateEventSource" />
        <altmember cref="P:System.Diagnostics.EventLog.Source" />
        <altmember cref="P:System.Diagnostics.EventLog.Entries" />
        <altmember cref="T:System.Diagnostics.EventInstance" />
      </Docs>
    </Member>
    <Member MemberName="WriteEvent">
      <MemberSignature Language="C#" Value="public static void WriteEvent (string source, System.Diagnostics.EventInstance instance, byte[] data, params object[] values);" />
      <MemberSignature Language="ILAsm" Value=".method public static hidebysig void WriteEvent(string source, class System.Diagnostics.EventInstance instance, unsigned int8[] data, object[] values) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Diagnostics.EventLog.WriteEvent(System.String,System.Diagnostics.EventInstance,System.Byte[],System.Object[])" />
      <MemberSignature Language="VB.NET" Value="Public Shared Sub WriteEvent (source As String, instance As EventInstance, data As Byte(), ParamArray values As Object())" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; static void WriteEvent(System::String ^ source, System::Diagnostics::EventInstance ^ instance, cli::array &lt;System::Byte&gt; ^ data, ... cli::array &lt;System::Object ^&gt; ^ values);" />
      <MemberSignature Language="F#" Value="static member WriteEvent : string * System.Diagnostics.EventInstance * byte[] * obj[] -&gt; unit" Usage="System.Diagnostics.EventLog.WriteEvent (source, instance, data, values)" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System</AssemblyName>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Void</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="source" Type="System.String" />
        <Parameter Name="instance" Type="System.Diagnostics.EventInstance" />
        <Parameter Name="data" Type="System.Byte[]" />
        <Parameter Name="values" Type="System.Object[]">
          <Attributes>
            <Attribute>
              <AttributeName>System.ParamArray</AttributeName>
            </Attribute>
          </Attributes>
        </Parameter>
      </Parameters>
      <Docs>
        <param name="source">
          <span data-ttu-id="db667-1673">在指定的计算机上为应用程序注册的事件源的名称。</span>
          <span class="sxs-lookup">
            <span data-stu-id="db667-1673">The name of the event source registered for the application on the specified computer.</span>
          </span>
        </param>
        <param name="instance">
          <span data-ttu-id="db667-1674">表示本地化事件日志项的 <see cref="T:System.Diagnostics.EventInstance" /> 实例。</span>
          <span class="sxs-lookup">
            <span data-stu-id="db667-1674">An <see cref="T:System.Diagnostics.EventInstance" /> instance that represents a localized event log entry.</span>
          </span>
        </param>
        <param name="data">
          <span data-ttu-id="db667-1675">包含与此项关联的二进制数据的字节数组。</span>
          <span class="sxs-lookup">
            <span data-stu-id="db667-1675">An array of bytes that holds the binary data associated with the entry.</span>
          </span>
        </param>
        <param name="values">
          <span data-ttu-id="db667-1676">要合并到事件日志项的消息文本中的字符串数组。</span>
          <span class="sxs-lookup">
            <span data-stu-id="db667-1676">An array of strings to merge into the message text of the event log entry.</span>
          </span>
        </param>
        <summary>
          <span data-ttu-id="db667-1677">使用指定的已注册事件源，写入包含给定的事件数据、消息替换字符串和关联的二进制数据的事件日志项。</span>
          <span class="sxs-lookup">
            <span data-stu-id="db667-1677">Writes an event log entry with the given event data, message replacement strings, and associated binary data, and using the specified registered event source.</span>
          </span>
        </summary>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="db667-1678">使用此方法将包含其他特定于事件的数据的本地化的项写入事件日志中，使用已注册为相应的日志的事件源的源。</span><span class="sxs-lookup"><span data-stu-id="db667-1678">Use this method to write a localized entry with additional event-specific data to the event log, using a source already registered as an event source for the appropriate log.</span></span> <span data-ttu-id="db667-1679">资源标识符而不是字符串值与指定的事件属性。</span><span class="sxs-lookup"><span data-stu-id="db667-1679">You specify the event properties with resource identifiers rather than string values.</span></span> <span data-ttu-id="db667-1680">事件查看器使用的资源标识符来显示源的本地化的资源文件中的相应字符串。</span><span class="sxs-lookup"><span data-stu-id="db667-1680">The Event Viewer uses the resource identifiers to display the corresponding strings from the localized resource file for the source.</span></span> <span data-ttu-id="db667-1681">编写使用资源标识符的事件之前，必须将源注册相应的资源文件。</span><span class="sxs-lookup"><span data-stu-id="db667-1681">You must register the source with the corresponding resource file before you write events using resource identifiers.</span></span>  
  
 <span data-ttu-id="db667-1682">输入`instance`实例指定的事件消息和属性。</span><span class="sxs-lookup"><span data-stu-id="db667-1682">The input `instance` instance specifies the event message and properties.</span></span> <span data-ttu-id="db667-1683">设置<xref:System.Diagnostics.EventInstance.InstanceId%2A>的`instance`源消息资源文件中定义的消息的输入。</span><span class="sxs-lookup"><span data-stu-id="db667-1683">Set the <xref:System.Diagnostics.EventInstance.InstanceId%2A> of the `instance` input for the defined message in the source message resource file.</span></span> <span data-ttu-id="db667-1684">可以选择性地设置<xref:System.Diagnostics.EventInstance.CategoryId%2A>并<xref:System.Diagnostics.EventInstance.EntryType%2A>的`instance`输入来定义事件条目的类别和事件类型。</span><span class="sxs-lookup"><span data-stu-id="db667-1684">You can optionally set the <xref:System.Diagnostics.EventInstance.CategoryId%2A> and <xref:System.Diagnostics.EventInstance.EntryType%2A> of the `instance` input to define the category and event type of your event entry.</span></span> <span data-ttu-id="db667-1685">此外可以指定一个要插入到本地化的消息文本的独立于语言的字符串数组。</span><span class="sxs-lookup"><span data-stu-id="db667-1685">You can also specify an array of language-independent strings to insert into the localized message text.</span></span> <span data-ttu-id="db667-1686">设置`values`到`null`如果事件消息不包含替换字符串的格式设置占位符。</span><span class="sxs-lookup"><span data-stu-id="db667-1686">Set `values` to `null` if the event message does not contain formatting placeholders for replacement strings.</span></span>  
  
 <span data-ttu-id="db667-1687">使用事件时需要为事件提供更多详细信息中指定的二进制数据。</span><span class="sxs-lookup"><span data-stu-id="db667-1687">Specify binary data with an event when it is necessary to provide additional details for the event.</span></span> <span data-ttu-id="db667-1688">例如，使用`data`参数，以包括有关特定错误的信息。</span><span class="sxs-lookup"><span data-stu-id="db667-1688">For example, use the `data` parameter to include information on a specific error.</span></span> <span data-ttu-id="db667-1689">事件查看器不会解释关联的事件数据中;它采用组合的十六进制转义序列和文本格式显示的数据。</span><span class="sxs-lookup"><span data-stu-id="db667-1689">The Event Viewer does not interpret the associated event data; it displays the data in a combined hexadecimal and text format.</span></span> <span data-ttu-id="db667-1690">使用特定于事件的数据很谨慎;仅当你确信将很有用，包括它。</span><span class="sxs-lookup"><span data-stu-id="db667-1690">Use event-specific data sparingly; include it only if you are sure it will be useful.</span></span> <span data-ttu-id="db667-1691">特定于事件的数据还可用于存储应用程序可以处理独立于事件查看器的信息。</span><span class="sxs-lookup"><span data-stu-id="db667-1691">You can also use event-specific data to store information the application can process independently of the Event Viewer.</span></span> <span data-ttu-id="db667-1692">例如，可以专门为您的活动，编写一个查看器或编写一个程序来扫描事件日志并创建报告，包括来自特定于事件的数据的信息。</span><span class="sxs-lookup"><span data-stu-id="db667-1692">For example, you could write a viewer specifically for your events, or write a program that scans the event log and creates reports that include information from the event-specific data.</span></span>  
  
 <span data-ttu-id="db667-1693">指定的源必须在使用之前注册为事件日志<xref:System.Diagnostics.EventLog.WriteEvent%2A>。</span><span class="sxs-lookup"><span data-stu-id="db667-1693">The specified source must be registered for an event log before using <xref:System.Diagnostics.EventLog.WriteEvent%2A>.</span></span> <span data-ttu-id="db667-1694">指定的源必须配置用于本地化的项写入事件日志中。源最小值必须具有一个用于定义消息资源文件。</span><span class="sxs-lookup"><span data-stu-id="db667-1694">The specified source must be configured for writing localized entries to the log; the source must at minimum have a message resource file defined.</span></span>  
  
 <span data-ttu-id="db667-1695">必须创建并写入与源的第一项之前配置的事件源。</span><span class="sxs-lookup"><span data-stu-id="db667-1695">You must create and configure the event source before writing the first entry with the source.</span></span> <span data-ttu-id="db667-1696">在应用程序的安装过程中创建新的事件源。</span><span class="sxs-lookup"><span data-stu-id="db667-1696">Create the new event source during the installation of your application.</span></span> <span data-ttu-id="db667-1697">这允许操作系统以刷新其注册的事件源的列表和其配置的时间。</span><span class="sxs-lookup"><span data-stu-id="db667-1697">This allows time for the operating system to refresh its list of registered event sources and their configuration.</span></span> <span data-ttu-id="db667-1698">如果操作系统没有刷新其事件源的列表，并且尝试写入新的源的事件写入操作将失败。</span><span class="sxs-lookup"><span data-stu-id="db667-1698">If the operating system has not refreshed its list of event sources, and you attempt to write an event with the new source, the write operation will fail.</span></span> <span data-ttu-id="db667-1699">可以配置新的源使用<xref:System.Diagnostics.EventLogInstaller>，或使用<xref:System.Diagnostics.EventLog.CreateEventSource%2A>方法。</span><span class="sxs-lookup"><span data-stu-id="db667-1699">You can configure a new source using an <xref:System.Diagnostics.EventLogInstaller>, or using the <xref:System.Diagnostics.EventLog.CreateEventSource%2A> method.</span></span> <span data-ttu-id="db667-1700">若要创建新的事件源的计算机上，必须具有管理权限。</span><span class="sxs-lookup"><span data-stu-id="db667-1700">You must have administrative rights on the computer to create a new event source.</span></span>  
  
 <span data-ttu-id="db667-1701">要写入本地化的项还是要直接写入字符串，必须配置源。</span><span class="sxs-lookup"><span data-stu-id="db667-1701">The source must be configured either for writing localized entries or for writing direct strings.</span></span> <span data-ttu-id="db667-1702">使用<xref:System.Diagnostics.EventLog.WriteEntry%2A>方法如果你的应用程序将直接写入事件日志的字符串值。</span><span class="sxs-lookup"><span data-stu-id="db667-1702">Use the <xref:System.Diagnostics.EventLog.WriteEntry%2A> method if your application writes string values directly to the event log.</span></span>  
  
 <span data-ttu-id="db667-1703">如果你的应用程序将使用资源标识符和字符串值的条目写入，则必须注册两个单独的源。</span><span class="sxs-lookup"><span data-stu-id="db667-1703">If your application writes entries using both resource identifiers and string values, you must register two separate sources.</span></span> <span data-ttu-id="db667-1704">例如，配置一个源的资源文件，以及如何将该源中的<xref:System.Diagnostics.EventLog.WriteEvent%2A>方法来编写使用资源标识符添加到事件日志条目。</span><span class="sxs-lookup"><span data-stu-id="db667-1704">For example, configure one source with resource files, and then use that source in the <xref:System.Diagnostics.EventLog.WriteEvent%2A> method to write entries using resource identifiers to the event log.</span></span> <span data-ttu-id="db667-1705">然后创建不同的源，而无需资源文件，并使用在该源<xref:System.Diagnostics.EventLog.WriteEntry%2A>方法将字符串直接写入事件日志使用的源。</span><span class="sxs-lookup"><span data-stu-id="db667-1705">Then create a different source without resource files, and use that source in the <xref:System.Diagnostics.EventLog.WriteEntry%2A> method to write strings directly to the event log using that source.</span></span>  
  
   
  
## Examples  
 <span data-ttu-id="db667-1706">下面的示例将信息性事件条目和警告事件条目写入到现有的事件日志。</span><span class="sxs-lookup"><span data-stu-id="db667-1706">The following example writes an informational event entry and a warning event entry to an existing event log.</span></span> <span data-ttu-id="db667-1707">事件消息文本被指定的资源文件中使用的资源标识符。</span><span class="sxs-lookup"><span data-stu-id="db667-1707">The event message text is specified using a resource identifier in a resource file.</span></span> <span data-ttu-id="db667-1708">该示例假定已为源中注册相应的资源文件。</span><span class="sxs-lookup"><span data-stu-id="db667-1708">The example assumes the corresponding resource file has been registered for the source.</span></span>  
  
 [!code-cpp[EventLog_WriteEvent#8](~/samples/snippets/cpp/VS_Snippets_CLR/eventlog_WriteEvent/CPP/source.cpp#8)]
 [!code-csharp[EventLog_WriteEvent#8](~/samples/snippets/csharp/VS_Snippets_CLR/eventlog_WriteEvent/CS/source.cs#8)]
 [!code-vb[EventLog_WriteEvent#8](~/samples/snippets/visualbasic/VS_Snippets_CLR/eventlog_WriteEvent/VB/source.vb#8)]  
  
 <span data-ttu-id="db667-1709">该示例使用下面的消息文本文件，内置的资源库 EventLogMsgs.dll。</span><span class="sxs-lookup"><span data-stu-id="db667-1709">The example uses the following message text file, built into the resource library EventLogMsgs.dll.</span></span> <span data-ttu-id="db667-1710">消息文本文件是从其创建的消息资源文件的源。</span><span class="sxs-lookup"><span data-stu-id="db667-1710">A message text file is the source from which the message resource file is created.</span></span> <span data-ttu-id="db667-1711">消息文本文件定义的资源标识符和类别、 事件消息和参数插入字符串的文本。</span><span class="sxs-lookup"><span data-stu-id="db667-1711">The message text file defines the resource identifiers and text for the category, event message, and parameter insertion strings.</span></span>  
  
```  
; // EventLogMsgs.mc  
; // ********************************************************  
  
; // Use the following commands to build this file:  
  
; //   mc -s EventLogMsgs.mc  
; //   rc EventLogMsgs.rc  
; //   link /DLL /SUBSYSTEM:WINDOWS /NOENTRY /MACHINE:x86 EventLogMsgs.Res   
; // ********************************************************  
  
; // - Event categories -  
; // Categories must be numbered consecutively starting at 1.  
; // ********************************************************  
  
MessageId=0x1  
Severity=Success  
SymbolicName=INSTALL_CATEGORY  
Language=English  
Installation  
.  
  
MessageId=0x2  
Severity=Success  
SymbolicName=QUERY_CATEGORY  
Language=English  
Database Query  
.  
  
MessageId=0x3  
Severity=Success  
SymbolicName=REFRESH_CATEGORY  
Language=English  
Data Refresh  
.  
  
; // - Event messages -  
; // *********************************  
  
MessageId = 1000  
Severity = Success  
Facility = Application  
SymbolicName = AUDIT_SUCCESS_MESSAGE_ID_1000  
Language=English  
My application message text, in English, for message id 1000, called from %1.  
.  
  
MessageId = 1001  
Severity = Warning  
Facility = Application  
SymbolicName = AUDIT_FAILED_MESSAGE_ID_1001  
Language=English  
My application message text, in English, for message id 1001, called from %1.  
.  
  
MessageId = 1002  
Severity = Success  
Facility = Application  
SymbolicName = GENERIC_INFO_MESSAGE_ID_1002  
Language=English  
My generic information message in English, for message id 1002.  
.  
  
MessageId = 1003  
Severity = Warning  
Facility = Application  
SymbolicName = GENERIC_WARNING_MESSAGE_ID_1003  
Language=English  
My generic warning message in English, for message id 1003, called from %1.  
.  
  
MessageId = 1004  
Severity = Success  
Facility = Application  
SymbolicName = UPDATE_CYCLE_COMPLETE_MESSAGE_ID_1004  
Language=English  
The update cycle is complete for %%5002.  
.  
  
MessageId = 1005  
Severity = Warning  
Facility = Application  
SymbolicName = SERVER_CONNECTION_DOWN_MESSAGE_ID_1005  
Language=English  
The refresh operation did not complete because the connection to server %1 could not be established.  
.  
  
; // - Event log display name -  
; // ********************************************************  
  
MessageId = 5001  
Severity = Success  
Facility = Application  
SymbolicName = EVENT_LOG_DISPLAY_NAME_MSGID  
Language=English  
Sample Event Log  
.  
  
; // - Event message parameters -  
; //   Language independent insertion strings  
; // ********************************************************  
  
MessageId = 5002  
Severity = Success  
Facility = Application  
SymbolicName = EVENT_LOG_SERVICE_NAME_MSGID  
Language=English  
SVC_UPDATE.EXE  
.  
```  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentException">
          <span data-ttu-id="db667-1712">
            <paramref name="source" /> 值是空字符串 ("")。</span>
          <span class="sxs-lookup">
            <span data-stu-id="db667-1712">The <paramref name="source" /> value is an empty string ("").</span>
          </span>
          <span data-ttu-id="db667-1713">\- 或 -</span>
          <span class="sxs-lookup">
            <span data-stu-id="db667-1713">\- or -</span>
          </span>
          <span data-ttu-id="db667-1714">
            <paramref name="source" /> 值为 <see langword="null" />。</span>
          <span class="sxs-lookup">
            <span data-stu-id="db667-1714">The <paramref name="source" /> value is <see langword="null" />.</span>
          </span>
          <span data-ttu-id="db667-1715">\- 或 -</span>
          <span class="sxs-lookup">
            <span data-stu-id="db667-1715">\- or -</span>
          </span>
          <span data-ttu-id="db667-1716">
            <paramref name="instance.InstanceId" /> 小于零或大于 <see cref="F:System.UInt16.MaxValue" />。</span>
          <span class="sxs-lookup">
            <span data-stu-id="db667-1716">
              <paramref name="instance.InstanceId" /> is less than zero or greater than <see cref="F:System.UInt16.MaxValue" />.</span>
          </span>
          <span data-ttu-id="db667-1717">\- 或 -</span>
          <span class="sxs-lookup">
            <span data-stu-id="db667-1717">\- or -</span>
          </span>
          <span data-ttu-id="db667-1718">
            <paramref name="values" /> 超过了 256 个元素。</span>
          <span class="sxs-lookup">
            <span data-stu-id="db667-1718">
              <paramref name="values" /> has more than 256 elements.</span>
          </span>
          <span data-ttu-id="db667-1719">\- 或 -</span>
          <span class="sxs-lookup">
            <span data-stu-id="db667-1719">\- or -</span>
          </span>
          <span data-ttu-id="db667-1720">
            <paramref name="values" /> 元素中有一个超过了 32766 个字节。</span>
          <span class="sxs-lookup">
            <span data-stu-id="db667-1720">One of the <paramref name="values" /> elements is longer than 32766 bytes.</span>
          </span>
          <span data-ttu-id="db667-1721">\- 或 -</span>
          <span class="sxs-lookup">
            <span data-stu-id="db667-1721">\- or -</span>
          </span>
          <span data-ttu-id="db667-1722">此源名称导致注册表项路径的长度超过 254 个字符。</span>
          <span class="sxs-lookup">
            <span data-stu-id="db667-1722">The source name results in a registry key path longer than 254 characters.</span>
          </span>
        </exception>
        <exception cref="T:System.ArgumentNullException">
          <span data-ttu-id="db667-1723">
            <paramref name="instance" /> 为 <see langword="null" />。</span>
          <span class="sxs-lookup">
            <span data-stu-id="db667-1723">
              <paramref name="instance" /> is <see langword="null" />.</span>
          </span>
        </exception>
        <exception cref="T:System.InvalidOperationException">
          <span data-ttu-id="db667-1724">事件日志的注册表项未能打开。</span>
          <span class="sxs-lookup">
            <span data-stu-id="db667-1724">The registry key for the event log could not be opened.</span>
          </span>
        </exception>
        <exception cref="T:System.ComponentModel.Win32Exception">
          <span data-ttu-id="db667-1725">将事件项写入事件日志时，操作系统报告了一个错误。</span>
          <span class="sxs-lookup">
            <span data-stu-id="db667-1725">The operating system reported an error when writing the event entry to the event log.</span>
          </span>
          <span data-ttu-id="db667-1726">一个 Windows 错误代码不可用。</span>
          <span class="sxs-lookup">
            <span data-stu-id="db667-1726">A Windows error code is not available.</span>
          </span>
        </exception>
        <permission cref="T:System.Diagnostics.EventLogPermission">
          <span data-ttu-id="db667-1727">用于写入的计算机上的事件日志信息。</span>
          <span class="sxs-lookup">
            <span data-stu-id="db667-1727">for writing the event log information on the computer.</span>
          </span>
          <span data-ttu-id="db667-1728">关联的枚举： <see cref="F:System.Diagnostics.EventLogPermissionAccess.Write" /></span>
          <span class="sxs-lookup">
            <span data-stu-id="db667-1728">Associated enumeration: <see cref="F:System.Diagnostics.EventLogPermissionAccess.Write" /></span>
          </span>
        </permission>
        <altmember cref="Overload:System.Diagnostics.EventLog.CreateEventSource" />
        <altmember cref="P:System.Diagnostics.EventLog.Source" />
        <altmember cref="P:System.Diagnostics.EventLog.Entries" />
        <altmember cref="T:System.Diagnostics.EventInstance" />
      </Docs>
    </Member>
  </Members>
</Type>