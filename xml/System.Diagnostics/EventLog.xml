<Type Name="EventLog" FullName="System.Diagnostics.EventLog">
  <TypeSignature Language="C#" Value="public class EventLog : System.ComponentModel.Component, System.ComponentModel.ISupportInitialize" />
  <TypeSignature Language="ILAsm" Value=".class public auto ansi beforefieldinit EventLog extends System.ComponentModel.Component implements class System.ComponentModel.ISupportInitialize" />
  <TypeSignature Language="DocId" Value="T:System.Diagnostics.EventLog" />
  <TypeSignature Language="VB.NET" Value="Public Class EventLog&#xA;Inherits Component&#xA;Implements ISupportInitialize" />
  <TypeSignature Language="C++ CLI" Value="public ref class EventLog : System::ComponentModel::Component, System::ComponentModel::ISupportInitialize" />
  <AssemblyInfo>
    <AssemblyName>System</AssemblyName>
    <AssemblyVersion>4.0.0.0</AssemblyVersion>
  </AssemblyInfo>
  <Base>
    <BaseTypeName>System.ComponentModel.Component</BaseTypeName>
  </Base>
  <Interfaces>
    <Interface>
      <InterfaceName>System.ComponentModel.ISupportInitialize</InterfaceName>
    </Interface>
  </Interfaces>
  <Attributes>
    <Attribute>
      <AttributeName>System.ComponentModel.DefaultEvent("EntryWritten")</AttributeName>
    </Attribute>
    <Attribute>
      <AttributeName>System.ComponentModel.InstallerType(typeof(System.Diagnostics.EventLogInstaller))</AttributeName>
    </Attribute>
    <Attribute>
      <AttributeName>System.Diagnostics.MonitoringDescription("Represents an event log")</AttributeName>
    </Attribute>
  </Attributes>
  <Docs>
    <summary><span data-ttu-id="6be2f-101">提供与 Windows 事件日志的交互。</span><span class="sxs-lookup"><span data-stu-id="6be2f-101">Provides interaction with Windows event logs.</span></span></summary>
    <remarks>
      <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="6be2f-102"><xref:System.Diagnostics.EventLog> 可访问或自定义 Windows 事件日志，记录有关重要的软件或硬件事件的信息。</span><span class="sxs-lookup"><span data-stu-id="6be2f-102"><xref:System.Diagnostics.EventLog> lets you access or customize Windows event logs, which record information about important software or hardware events.</span></span> <span data-ttu-id="6be2f-103">使用<xref:System.Diagnostics.EventLog>，可以从现有日志读取、 将条目写入到日志、 创建或删除事件源，删除日志，并响应日志条目。</span><span class="sxs-lookup"><span data-stu-id="6be2f-103">Using <xref:System.Diagnostics.EventLog>, you can read from existing logs, write entries to logs, create or delete event sources, delete logs, and respond to log entries.</span></span> <span data-ttu-id="6be2f-104">创建事件源时，你还可以创建新的日志。</span><span class="sxs-lookup"><span data-stu-id="6be2f-104">You can also create new logs when creating an event source.</span></span>  
  
> [!IMPORTANT]
>  <span data-ttu-id="6be2f-105">此类型实现<xref:System.IDisposable>接口。</span><span class="sxs-lookup"><span data-stu-id="6be2f-105">This type implements the <xref:System.IDisposable> interface.</span></span> <span data-ttu-id="6be2f-106">在使用完类型后，您应直接或间接释放类型。</span><span class="sxs-lookup"><span data-stu-id="6be2f-106">When you have finished using the type, you should dispose of it either directly or indirectly.</span></span> <span data-ttu-id="6be2f-107">若要直接释放类型，调用其<xref:System.IDisposable.Dispose%2A>中的方法`try` / `catch`块。</span><span class="sxs-lookup"><span data-stu-id="6be2f-107">To dispose of the type directly, call its <xref:System.IDisposable.Dispose%2A> method in a `try`/`catch` block.</span></span> <span data-ttu-id="6be2f-108">若要间接释放类型，请使用 `using`（在 C# 中）或 `Using`（在 Visual Basic 中）等语言构造。</span><span class="sxs-lookup"><span data-stu-id="6be2f-108">To dispose of it indirectly, use a language construct such as `using` (in C#) or `Using` (in Visual Basic).</span></span> <span data-ttu-id="6be2f-109">有关详细信息，请参阅中的"使用实现 IDisposable 的对象"部分<xref:System.IDisposable>接口主题。</span><span class="sxs-lookup"><span data-stu-id="6be2f-109">For more information, see the "Using an Object that Implements IDisposable" section in the <xref:System.IDisposable> interface topic.</span></span>  
  
 <span data-ttu-id="6be2f-110">除了提供对个人事件日志和其条目访问<xref:System.Diagnostics.EventLog>类可访问的所有事件日志的集合。</span><span class="sxs-lookup"><span data-stu-id="6be2f-110">In addition to providing access to individual event logs and their entries, the <xref:System.Diagnostics.EventLog> class lets you access the collection of all event logs.</span></span> <span data-ttu-id="6be2f-111">你可以使用`static`的成员<xref:System.Diagnostics.EventLog>若要删除日志，获取日志列表、 创建或删除源，或确定是否计算机已包含一个特定的源。</span><span class="sxs-lookup"><span data-stu-id="6be2f-111">You can use the `static` members of <xref:System.Diagnostics.EventLog> to delete logs, get log lists, create or delete a source, or determine if a computer already contains a particular source.</span></span>  
  
 <span data-ttu-id="6be2f-112">有三个默认事件日志： 应用程序、 系统和安全。</span><span class="sxs-lookup"><span data-stu-id="6be2f-112">There are three default event logs: Application, System, and Security.</span></span> <span data-ttu-id="6be2f-113">安全日志是只读的。</span><span class="sxs-lookup"><span data-stu-id="6be2f-113">A Security log is read-only.</span></span> <span data-ttu-id="6be2f-114">其他应用程序和安装，如 Active Directory 的服务可能具有其他事件日志。</span><span class="sxs-lookup"><span data-stu-id="6be2f-114">Other applications and services you install, such as Active Directory, might have additional event logs.</span></span>  
  
 <span data-ttu-id="6be2f-115">安全注意事项在使用时有<xref:System.Diagnostics.EventLog>类。</span><span class="sxs-lookup"><span data-stu-id="6be2f-115">There are security considerations when using the <xref:System.Diagnostics.EventLog> class.</span></span> <span data-ttu-id="6be2f-116"><xref:System.Diagnostics.EventLog> 需要<xref:System.Diagnostics.EventLogPermission>的.NET Framework 2.0 和更高版本中的特定操作或在.NET Framework 1.0 和 1.1 中的完全信任权限。</span><span class="sxs-lookup"><span data-stu-id="6be2f-116"><xref:System.Diagnostics.EventLog> requires <xref:System.Diagnostics.EventLogPermission> permissions for specific actions in the .NET Framework 2.0 and later versions, or full trust in the .NET Framework 1.0 and 1.1.</span></span> <span data-ttu-id="6be2f-117">我们建议，<xref:System.Diagnostics.EventLogPermission>不授予给部分受信任的代码。</span><span class="sxs-lookup"><span data-stu-id="6be2f-117">We recommend that <xref:System.Diagnostics.EventLogPermission> not be granted to partially trusted code.</span></span>  <span data-ttu-id="6be2f-118">你决不要将传递任何事件日志的对象，包括<xref:System.Diagnostics.EventLogEntryCollection>和<xref:System.Diagnostics.EventLogEntry>对象，不太受信任的代码。</span><span class="sxs-lookup"><span data-stu-id="6be2f-118">You should never pass any event log object, including <xref:System.Diagnostics.EventLogEntryCollection> and <xref:System.Diagnostics.EventLogEntry> objects, to less trusted code.</span></span> <span data-ttu-id="6be2f-119">例如，创建<xref:System.Diagnostics.EventLog>对象、 写入条目，然后将<xref:System.Diagnostics.EventLog>到部分受信任的代码的对象可以为创建安全问题，因为能够读取和写入事件日志允许代码执行操作，如发布另一个应用程序的名称的事件日志消息。</span><span class="sxs-lookup"><span data-stu-id="6be2f-119">For example, creating an <xref:System.Diagnostics.EventLog> object, writing an entry, and then passing the <xref:System.Diagnostics.EventLog> object to partially trusted code can create a security issue, because the ability to read and write to the event log allows code to perform actions such as issuing event log messages in the name of another application.</span></span>  
  
 <span data-ttu-id="6be2f-120">从 Windows Vista 开始，用户帐户控制 (UAC) 决定用户的凭据。</span><span class="sxs-lookup"><span data-stu-id="6be2f-120">Starting with Windows Vista, User Account Control (UAC) determines the credentials of a user.</span></span> <span data-ttu-id="6be2f-121">如果您是内置的 Administrators 组的成员，将为您分配两个运行时访问令牌：一个标准用户访问令牌和一个管理员访问令牌。</span><span class="sxs-lookup"><span data-stu-id="6be2f-121">If you are a member of the Built-in Administrators group, you are assigned two run-time access tokens: a standard user access token and an administrator access token.</span></span> <span data-ttu-id="6be2f-122">默认情况下，您拥有标准用户角色。</span><span class="sxs-lookup"><span data-stu-id="6be2f-122">By default, you are in the standard user role.</span></span> <span data-ttu-id="6be2f-123">若要运行的代码访问安全日志，首先必须将你的凭据从标准用户提升至管理员。</span><span class="sxs-lookup"><span data-stu-id="6be2f-123">To run the code that accesses the Security log, you must first elevate your credentials from standard user to administrator.</span></span> <span data-ttu-id="6be2f-124">通过打开应用程序的快捷菜单启动应用程序时可以执行此操作 （如果你使用鼠标，右键单击应用程序图标） 并指示你想要以管理员身份运行。</span><span class="sxs-lookup"><span data-stu-id="6be2f-124">You can do this when you start an application by opening the shortcut menu for the application (if you're using a mouse, right-click the application icon) and indicating that you want to run as an administrator.</span></span>  
  
 <span data-ttu-id="6be2f-125">你可以使用<xref:System.Diagnostics.EventLog>来创建自定义你可以查看通过服务器的事件日志的事件查看器。</span><span class="sxs-lookup"><span data-stu-id="6be2f-125">You can use <xref:System.Diagnostics.EventLog> to create custom event logs that you can view through the server's Event Viewer.</span></span> <span data-ttu-id="6be2f-126">使用<xref:System.Diagnostics.EventLog.RegisterDisplayName%2A>方法以在事件查看器显示你的事件日志的本地化的名称。</span><span class="sxs-lookup"><span data-stu-id="6be2f-126">Use the <xref:System.Diagnostics.EventLog.RegisterDisplayName%2A> method to display a localized name for your event log in the Event Viewer.</span></span> <span data-ttu-id="6be2f-127">使用<xref:System.Diagnostics.EventLog.ModifyOverflowPolicy%2A>方法来配置你的事件日志的行为，当它达到其最大日志大小。</span><span class="sxs-lookup"><span data-stu-id="6be2f-127">Use the <xref:System.Diagnostics.EventLog.ModifyOverflowPolicy%2A> method to configure the behavior of your event log when it reaches its maximum log size.</span></span>  
  
 <span data-ttu-id="6be2f-128">若要从事件日志中读取，指定日志名称 (<xref:System.Diagnostics.EventLog.Log%2A>属性) 和服务器计算机名称 (<xref:System.Diagnostics.EventLog.MachineName%2A>事件日志的属性。</span><span class="sxs-lookup"><span data-stu-id="6be2f-128">To read from an event log, specify the log name (<xref:System.Diagnostics.EventLog.Log%2A> property) and server computer name (<xref:System.Diagnostics.EventLog.MachineName%2A> property for the event log.</span></span> <span data-ttu-id="6be2f-129">如果你未指定服务器的计算机名称，本地计算机，"。"，则假定。</span><span class="sxs-lookup"><span data-stu-id="6be2f-129">If you don't specify the server computer name, the local computer, ".", is assumed.</span></span> <span data-ttu-id="6be2f-130">不需要指定事件源 (<xref:System.Diagnostics.EventLog.Source%2A>属性)，因为源是只有需要写入日志。</span><span class="sxs-lookup"><span data-stu-id="6be2f-130">It's not necessary to specify the event source (<xref:System.Diagnostics.EventLog.Source%2A> property), because a source is required only for writing to logs.</span></span> <span data-ttu-id="6be2f-131"><xref:System.Diagnostics.EventLog.Entries%2A>属性自动填充的条目的事件日志的列表。</span><span class="sxs-lookup"><span data-stu-id="6be2f-131">The  <xref:System.Diagnostics.EventLog.Entries%2A> property is automatically populated with the event log's list of entries.</span></span>  
  
 <span data-ttu-id="6be2f-132">若要写入事件日志，请指定或创建事件源 (<xref:System.Diagnostics.EventLog.Source%2A>属性)。</span><span class="sxs-lookup"><span data-stu-id="6be2f-132">To write to an event log, specify or create an event source (<xref:System.Diagnostics.EventLog.Source%2A> property).</span></span> <span data-ttu-id="6be2f-133">若要创建新的事件源的计算机上，必须具有管理凭据。</span><span class="sxs-lookup"><span data-stu-id="6be2f-133">You must have administrative credentials on the computer to create a new event source.</span></span> <span data-ttu-id="6be2f-134">事件源将你的应用程序注册的有效项源作为事件日志。</span><span class="sxs-lookup"><span data-stu-id="6be2f-134">The event source registers your application with the event log as a valid source of entries.</span></span> <span data-ttu-id="6be2f-135">事件源可用于写入一次只有一个日志。</span><span class="sxs-lookup"><span data-stu-id="6be2f-135">You can use the event source  to write to only one log at a time.</span></span> <span data-ttu-id="6be2f-136"><xref:System.Diagnostics.EventLog.Source%2A>属性可以是任何随机字符串，但该名称必须是不同于计算机上的其他源。</span><span class="sxs-lookup"><span data-stu-id="6be2f-136">The <xref:System.Diagnostics.EventLog.Source%2A> property can be any random string, but the name must be distinct from other sources on the computer.</span></span> <span data-ttu-id="6be2f-137">事件源通常是应用程序或另一个标识字符串的名称。</span><span class="sxs-lookup"><span data-stu-id="6be2f-137">The event source is typically the name of the application or another identifying string.</span></span> <span data-ttu-id="6be2f-138">尝试创建重复<xref:System.Diagnostics.EventLog.Source%2A>值引发异常。</span><span class="sxs-lookup"><span data-stu-id="6be2f-138">Trying to create a duplicate <xref:System.Diagnostics.EventLog.Source%2A> value throws an exception.</span></span> <span data-ttu-id="6be2f-139">但是，单个事件日志可能与多个源。</span><span class="sxs-lookup"><span data-stu-id="6be2f-139">However, a single event log can be associated with multiple sources.</span></span>  
  
 <span data-ttu-id="6be2f-140">如果事件日志的事件源关联<xref:System.Diagnostics.EventLog>实例不存在，则创建新的事件源。</span><span class="sxs-lookup"><span data-stu-id="6be2f-140">If the event source for the event log associated with the <xref:System.Diagnostics.EventLog> instance doesn't exist, a new event source is created.</span></span> <span data-ttu-id="6be2f-141">若要创建的事件源在 Windows Vista 或更高版本或 Windows Server 2003，必须具有管理凭据。</span><span class="sxs-lookup"><span data-stu-id="6be2f-141">To create an event source in Windows Vista and later or Windows Server 2003, you must have administrative credentials.</span></span>  
  
 <span data-ttu-id="6be2f-142">此要求是因为必须搜索所有事件日志，包括安全日志，以确定事件源是否是唯一的。</span><span class="sxs-lookup"><span data-stu-id="6be2f-142">This requirement is because all event logs, including Security logs, must be searched to determine whether the event source is unique.</span></span> <span data-ttu-id="6be2f-143">从 Windows Vista 开始，用户没有权限访问安全事件日志中。因此，<xref:System.Security.SecurityException>引发。</span><span class="sxs-lookup"><span data-stu-id="6be2f-143">Starting with Windows Vista, users do not have permission to access the Security log; therefore, a <xref:System.Security.SecurityException> is thrown.</span></span>  
  
> [!IMPORTANT]
>  <span data-ttu-id="6be2f-144">创建或删除事件源需要通过使用命名的互斥体的基础代码的同步。</span><span class="sxs-lookup"><span data-stu-id="6be2f-144">Creating or deleting an event source requires synchronization of the underlying code by using a named mutex.</span></span> <span data-ttu-id="6be2f-145">如果具有高特权的应用程序锁定命名互斥体，尝试创建或删除事件源将导致应用程序停止响应，直到该锁被释放。</span><span class="sxs-lookup"><span data-stu-id="6be2f-145">If a highly privileged application locks the named mutex, trying to create or delete an event source causes the application to stop responding until the lock is released.</span></span> <span data-ttu-id="6be2f-146">若要防止此问题，永远不会授予<xref:System.Security.Permissions.SecurityPermissionFlag.UnmanagedCode>到不受信任的代码的权限。</span><span class="sxs-lookup"><span data-stu-id="6be2f-146">To help prevent this problem, never grant <xref:System.Security.Permissions.SecurityPermissionFlag.UnmanagedCode> permission to untrusted code.</span></span> <span data-ttu-id="6be2f-147">此外，<xref:System.Security.Permissions.SecurityPermissionFlag.UnmanagedCode>权限可能允许绕开其他权限和仅应授予高度受信任的代码。</span><span class="sxs-lookup"><span data-stu-id="6be2f-147">In addition, <xref:System.Security.Permissions.SecurityPermissionFlag.UnmanagedCode> permission potentially allows other permissions to be bypassed and should only be granted to highly trusted code.</span></span>  
  
 <span data-ttu-id="6be2f-148">应用程序和服务应写入应用程序日志或自定义日志。</span><span class="sxs-lookup"><span data-stu-id="6be2f-148">Applications and services should write to the Application log or to a custom log.</span></span> <span data-ttu-id="6be2f-149">设备驱动程序应写入系统日志。</span><span class="sxs-lookup"><span data-stu-id="6be2f-149">Device drivers should write to the System log.</span></span> <span data-ttu-id="6be2f-150">如果未显式设置<xref:System.Diagnostics.EventLog.Log%2A>属性，默认为应用程序日志的事件日志。</span><span class="sxs-lookup"><span data-stu-id="6be2f-150">If you do not explicitly set the <xref:System.Diagnostics.EventLog.Log%2A> property, the event log defaults to the Application log.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="6be2f-151">无需进行任何以防止应用程序编写为任何已注册的源。</span><span class="sxs-lookup"><span data-stu-id="6be2f-151">There is nothing to protect an application from writing as any registered source.</span></span>  <span data-ttu-id="6be2f-152">如果应用程序被授予<xref:System.Diagnostics.EventLogPermissionAccess.Write>权限，它可以编写任何有效的源的计算机上注册的事件。</span><span class="sxs-lookup"><span data-stu-id="6be2f-152">If an application is granted <xref:System.Diagnostics.EventLogPermissionAccess.Write> permission, it can write events for any valid source registered on the computer.</span></span>  
  
 <span data-ttu-id="6be2f-153">使用<xref:System.Diagnostics.EventLog.WriteEvent%2A>和<xref:System.Diagnostics.EventLog.WriteEntry%2A>方法来向事件日志写入事件。</span><span class="sxs-lookup"><span data-stu-id="6be2f-153">Use the <xref:System.Diagnostics.EventLog.WriteEvent%2A> and <xref:System.Diagnostics.EventLog.WriteEntry%2A> methods to write events to an event log.</span></span> <span data-ttu-id="6be2f-154">必须指定事件源写入事件;你必须创建并在编写与源的第一个条目之前，配置事件源。</span><span class="sxs-lookup"><span data-stu-id="6be2f-154">You must specify an event source to write events; you must create and configure the event source before writing the first entry with the source.</span></span>  
  
 <span data-ttu-id="6be2f-155">在你的应用程序的安装过程中创建新的事件源。</span><span class="sxs-lookup"><span data-stu-id="6be2f-155">Create the new event source during the installation of your application.</span></span> <span data-ttu-id="6be2f-156">这样，可以为操作系统来刷新其已注册的事件源的列表和其配置的时间。</span><span class="sxs-lookup"><span data-stu-id="6be2f-156">This allows time for the operating system to refresh its list of registered event sources and their configuration.</span></span> <span data-ttu-id="6be2f-157">如果操作系统未刷新其事件源的列表，并且尝试写入新的源的事件写入操作将失败。</span><span class="sxs-lookup"><span data-stu-id="6be2f-157">If the operating system hasn't refreshed its list of event sources, and you try to write an event with the new source, the write operation will fail.</span></span> <span data-ttu-id="6be2f-158">你可以使用配置新的源<xref:System.Diagnostics.EventLogInstaller>对象或<xref:System.Diagnostics.EventLog.CreateEventSource%2A>方法。</span><span class="sxs-lookup"><span data-stu-id="6be2f-158">You can configure a new source by using an <xref:System.Diagnostics.EventLogInstaller> object or the <xref:System.Diagnostics.EventLog.CreateEventSource%2A> method.</span></span> <span data-ttu-id="6be2f-159">若要创建新的事件源的计算机上，必须具有管理凭据。</span><span class="sxs-lookup"><span data-stu-id="6be2f-159">You must have administrative credentials on the computer to create a new event source.</span></span>  
  
 <span data-ttu-id="6be2f-160">每个源可以一次; 写入只有一个事件日志但是，你的应用程序可以使用多个源写入多个事件日志。</span><span class="sxs-lookup"><span data-stu-id="6be2f-160">Each source can write to only one event log at a time; however, your application can use multiple sources to write to multiple event logs.</span></span> <span data-ttu-id="6be2f-161">例如，你的应用程序可能需要为不同的事件日志或不同的资源文件配置的多个源。</span><span class="sxs-lookup"><span data-stu-id="6be2f-161">For example, your application might require multiple sources configured for different event logs or different resource files.</span></span> <span data-ttu-id="6be2f-162">若要更改现有源的配置详细信息，必须删除源，然后使用新的配置创建。</span><span class="sxs-lookup"><span data-stu-id="6be2f-162">To change the configuration details of an existing source, you must delete the source and then create it with the new configuration.</span></span> <span data-ttu-id="6be2f-163">如果其他应用程序或组件使用的现有源，请使用更新的配置，而不是删除现有的源创建新的源。</span><span class="sxs-lookup"><span data-stu-id="6be2f-163">If other applications or components use the existing source, create a new source with the updated configuration instead of deleting the existing source.</span></span>  
  
 <span data-ttu-id="6be2f-164">你可以先使用本地化的资源注册事件源，为你的事件类别和消息字符串。</span><span class="sxs-lookup"><span data-stu-id="6be2f-164">You can register the event source with localized resources for your event category and message strings.</span></span> <span data-ttu-id="6be2f-165">你的应用程序可以通过使用资源标识符而不指定的实际字符串值编写事件日志条目。</span><span class="sxs-lookup"><span data-stu-id="6be2f-165">Your application can write event log entries by using resource identifiers instead of specifying the actual string values.</span></span> <span data-ttu-id="6be2f-166">请参阅<xref:System.Diagnostics.EventLogInstaller>和<xref:System.Diagnostics.EventSourceCreationData>有关的资源文件配置您的源的详细信息的类。</span><span class="sxs-lookup"><span data-stu-id="6be2f-166">Refer to the <xref:System.Diagnostics.EventLogInstaller> and <xref:System.Diagnostics.EventSourceCreationData> classes for more information about configuring your source with resource files.</span></span>  
  
 <span data-ttu-id="6be2f-167">如果你的应用程序将直接写入事件日志的字符串值，你不需要设置源的文件属性的资源。</span><span class="sxs-lookup"><span data-stu-id="6be2f-167">If your application writes string values directly to the event log, you do not have to set the resource file properties for the source.</span></span> <span data-ttu-id="6be2f-168">要写入本地化的项还是要直接写入字符串，则必须配置源。</span><span class="sxs-lookup"><span data-stu-id="6be2f-168">The source must be configured either for writing localized entries or for writing direct strings.</span></span> <span data-ttu-id="6be2f-169">如果你的应用程序将使用资源标识符和字符串值的条目，则必须注册两个单独的源。</span><span class="sxs-lookup"><span data-stu-id="6be2f-169">If your application writes entries using both resource identifiers and string values, you must register two separate sources.</span></span> <span data-ttu-id="6be2f-170">例如，使用资源文件，配置一个源，然后使用在该源<xref:System.Diagnostics.EventLog.WriteEvent%2A>方法来编写使用到事件日志的资源标识符的条目。</span><span class="sxs-lookup"><span data-stu-id="6be2f-170">For example, configure one source with resource files, and then use that source in the <xref:System.Diagnostics.EventLog.WriteEvent%2A> method to write entries using resource identifiers to the event log.</span></span> <span data-ttu-id="6be2f-171">然后创建不同的源，而无需资源文件，并使用在该源<xref:System.Diagnostics.EventLog.WriteEntry%2A>方法使用该源的事件日志中直接写入字符串。</span><span class="sxs-lookup"><span data-stu-id="6be2f-171">Then create a different source without resource files, and use that source in the <xref:System.Diagnostics.EventLog.WriteEntry%2A> method to write strings directly to the event log using that source.</span></span>  
  
 <span data-ttu-id="6be2f-172">写入事件时，你必须至少指定一个消息字符串或消息字符串的资源标识符。</span><span class="sxs-lookup"><span data-stu-id="6be2f-172">When writing events, you must at least specify either a message string or the resource identifier for a message string.</span></span> <span data-ttu-id="6be2f-173">其他事件属性都是可选的。</span><span class="sxs-lookup"><span data-stu-id="6be2f-173">Other event properties are optional.</span></span> <span data-ttu-id="6be2f-174">可选事件设置的示例包括：</span><span class="sxs-lookup"><span data-stu-id="6be2f-174">Examples of optional event settings include the following:</span></span>  
  
-   <span data-ttu-id="6be2f-175">你可以设置<xref:System.Diagnostics.EventLogEntryType>指定事件查看器显示的项的图标。</span><span class="sxs-lookup"><span data-stu-id="6be2f-175">You can set the <xref:System.Diagnostics.EventLogEntryType> to specify the icon that the Event Viewer displays for the entry.</span></span>  
  
-   <span data-ttu-id="6be2f-176">如果你的应用程序使用类别进行筛选的事件，可以指定事件的类别标识符。</span><span class="sxs-lookup"><span data-stu-id="6be2f-176">You can specify a category identifier for the event, if your application uses categories for filtering the events.</span></span>  
  
-   <span data-ttu-id="6be2f-177">如果你想要将其他信息与给定的事件相关联，你可以将二进制数据附加到事件项。</span><span class="sxs-lookup"><span data-stu-id="6be2f-177">You can attach binary data to your event entry if you want to associate additional information with a given event.</span></span>  
  
> [!IMPORTANT]
>  <span data-ttu-id="6be2f-178">事件日志记录占用磁盘空间、 处理器时间和其他系统资源。</span><span class="sxs-lookup"><span data-stu-id="6be2f-178">Event logging consumes disk space, processor time, and other system resources.</span></span> <span data-ttu-id="6be2f-179">请务必仅记录基本信息。</span><span class="sxs-lookup"><span data-stu-id="6be2f-179">It is important to log only essential information.</span></span> <span data-ttu-id="6be2f-180">我们建议将事件日志调用放在错误路径中，而不是在主代码路径中，因此它们不会影响性能。</span><span class="sxs-lookup"><span data-stu-id="6be2f-180">We recommend that you place event log calls in an error path, rather than in the main code path, so they don't adversely affect performance.</span></span>  
  
 <span data-ttu-id="6be2f-181">有关的实例的初始属性值的列表<xref:System.Diagnostics.EventLog>，请参阅<xref:System.Diagnostics.EventLog.%23ctor%2A>构造函数。</span><span class="sxs-lookup"><span data-stu-id="6be2f-181">For a list of initial property values for an instance of <xref:System.Diagnostics.EventLog>, see the <xref:System.Diagnostics.EventLog.%23ctor%2A> constructor.</span></span>  
  
   
  
## Examples  
 <span data-ttu-id="6be2f-182">下面的示例创建事件源`MySource`如果它尚不存在，并将项写入事件日志`MyNewLog`。</span><span class="sxs-lookup"><span data-stu-id="6be2f-182">The following example creates the event source `MySource` if it doesn't already exist, and writes an entry to the event log `MyNewLog`.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="6be2f-183">从 Windows Vista 开始，你必须以管理员身份运行此应用程序。</span><span class="sxs-lookup"><span data-stu-id="6be2f-183">Starting with Windows Vista, you must run this application as an administrator.</span></span>  
  
 [!code-cpp[Classic EventLog.CreateEventSource Example#1](~/samples/snippets/cpp/VS_Snippets_CLR_Classic/classic EventLog.CreateEventSource Example/CPP/source.cpp#1)]
 [!code-csharp[Classic EventLog.CreateEventSource Example#1](~/samples/snippets/csharp/VS_Snippets_CLR_Classic/classic EventLog.CreateEventSource Example/CS/source.cs#1)]
 [!code-vb[Classic EventLog.CreateEventSource Example#1](~/samples/snippets/visualbasic/VS_Snippets_CLR_Classic/classic EventLog.CreateEventSource Example/VB/source.vb#1)]  
  
 ]]></format>
    </remarks>
    <altmember cref="T:System.Diagnostics.EventLogInstaller" />
    <altmember cref="T:System.Diagnostics.EventLogEntry" />
    <altmember cref="T:System.Diagnostics.EntryWrittenEventArgs" />
    <altmember cref="T:System.ServiceProcess.ServiceBase" />
  </Docs>
  <Members>
    <MemberGroup MemberName=".ctor">
      <AssemblyInfo>
        <AssemblyName>System</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Docs>
        <summary><span data-ttu-id="6be2f-184">初始化 <see cref="T:System.Diagnostics.EventLog" /> 类的新实例。</span><span class="sxs-lookup"><span data-stu-id="6be2f-184">Initializes a new instance of the <see cref="T:System.Diagnostics.EventLog" /> class.</span></span></summary>
      </Docs>
    </MemberGroup>
    <Member MemberName=".ctor">
      <MemberSignature Language="C#" Value="public EventLog ();" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig specialname rtspecialname instance void .ctor() cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Diagnostics.EventLog.#ctor" />
      <MemberSignature Language="VB.NET" Value="Public Sub New ()" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; EventLog();" />
      <MemberType>Constructor</MemberType>
      <AssemblyInfo>
        <AssemblyName>System</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Parameters />
      <Docs>
        <summary><span data-ttu-id="6be2f-185">初始化 <see cref="T:System.Diagnostics.EventLog" /> 类的新实例。</span><span class="sxs-lookup"><span data-stu-id="6be2f-185">Initializes a new instance of the <see cref="T:System.Diagnostics.EventLog" /> class.</span></span> <span data-ttu-id="6be2f-186">不将该实例与任何日志关联。</span><span class="sxs-lookup"><span data-stu-id="6be2f-186">Does not associate the instance with any log.</span></span></summary>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="6be2f-187">之前调用<xref:System.Diagnostics.EventLog.WriteEntry%2A>，指定<xref:System.Diagnostics.EventLog.Source%2A>属性<xref:System.Diagnostics.EventLog>实例。</span><span class="sxs-lookup"><span data-stu-id="6be2f-187">Before calling <xref:System.Diagnostics.EventLog.WriteEntry%2A>, specify the <xref:System.Diagnostics.EventLog.Source%2A> property of the <xref:System.Diagnostics.EventLog> instance.</span></span> <span data-ttu-id="6be2f-188">如果您仅读取<xref:System.Diagnostics.EventLog.Entries%2A>从日志中，您可以另行指定仅<xref:System.Diagnostics.EventLog.Log%2A>和<xref:System.Diagnostics.EventLog.MachineName%2A>属性。</span><span class="sxs-lookup"><span data-stu-id="6be2f-188">If you are only reading <xref:System.Diagnostics.EventLog.Entries%2A> from the log, you can alternatively specify only the <xref:System.Diagnostics.EventLog.Log%2A> and <xref:System.Diagnostics.EventLog.MachineName%2A> properties.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="6be2f-189">如果不指定<xref:System.Diagnostics.EventLog.MachineName%2A>，本地计算机 ("。") 假定。</span><span class="sxs-lookup"><span data-stu-id="6be2f-189">If you do not specify a <xref:System.Diagnostics.EventLog.MachineName%2A>, the local computer (".") is assumed.</span></span>  
  
 <span data-ttu-id="6be2f-190">下表显示的实例的初始属性值<xref:System.Diagnostics.EventLog>。</span><span class="sxs-lookup"><span data-stu-id="6be2f-190">The following table shows initial property values for an instance of <xref:System.Diagnostics.EventLog>.</span></span>  
  
|<span data-ttu-id="6be2f-191">Property</span><span class="sxs-lookup"><span data-stu-id="6be2f-191">Property</span></span>|<span data-ttu-id="6be2f-192">初始值</span><span class="sxs-lookup"><span data-stu-id="6be2f-192">Initial Value</span></span>|  
|--------------|-------------------|  
|<xref:System.Diagnostics.EventLog.Source%2A>|<span data-ttu-id="6be2f-193">空字符串 ("")。</span><span class="sxs-lookup"><span data-stu-id="6be2f-193">An empty string ("").</span></span>|  
|<xref:System.Diagnostics.EventLog.Log%2A>|<span data-ttu-id="6be2f-194">空字符串 ("")。</span><span class="sxs-lookup"><span data-stu-id="6be2f-194">An empty string ("").</span></span>|  
|<xref:System.Diagnostics.EventLog.MachineName%2A>|<span data-ttu-id="6be2f-195">本地计算机 ("。")。</span><span class="sxs-lookup"><span data-stu-id="6be2f-195">The local computer (".").</span></span>|  
  
   
  
## Examples  
 <span data-ttu-id="6be2f-196">下面的示例创建源`MySource`如果它尚不存在，并将项写入事件日志`MyNewLog`。</span><span class="sxs-lookup"><span data-stu-id="6be2f-196">The following example creates the source `MySource` if it does not already exist, and writes an entry to the event log `MyNewLog`.</span></span>  
  
 [!code-cpp[Classic EventLog.CreateEventSource Example#1](~/samples/snippets/cpp/VS_Snippets_CLR_Classic/classic EventLog.CreateEventSource Example/CPP/source.cpp#1)]
 [!code-csharp[Classic EventLog.CreateEventSource Example#1](~/samples/snippets/csharp/VS_Snippets_CLR_Classic/classic EventLog.CreateEventSource Example/CS/source.cs#1)]
 [!code-vb[Classic EventLog.CreateEventSource Example#1](~/samples/snippets/visualbasic/VS_Snippets_CLR_Classic/classic EventLog.CreateEventSource Example/VB/source.vb#1)]  
  
 ]]></format>
        </remarks>
        <permission cref="T:System.Diagnostics.EventLogPermission"><span data-ttu-id="6be2f-197">用于写入的计算机上的事件日志信息。</span><span class="sxs-lookup"><span data-stu-id="6be2f-197">for writing the event log information on the computer.</span></span> <span data-ttu-id="6be2f-198">关联的枚举： <see cref="F:System.Diagnostics.EventLogPermissionAccess.Write" /></span><span class="sxs-lookup"><span data-stu-id="6be2f-198">Associated enumeration: <see cref="F:System.Diagnostics.EventLogPermissionAccess.Write" /></span></span></permission>
        <altmember cref="P:System.Diagnostics.EventLog.Source" />
        <altmember cref="P:System.Diagnostics.EventLog.Log" />
        <altmember cref="P:System.Diagnostics.EventLog.MachineName" />
        <altmember cref="P:System.Diagnostics.EventLog.Entries" />
        <altmember cref="Overload:System.Diagnostics.EventLog.WriteEntry" />
        <altmember cref="Overload:System.Diagnostics.EventLog.WriteEvent" />
        <altmember cref="T:System.Diagnostics.EventLogEntry" />
      </Docs>
    </Member>
    <Member MemberName=".ctor">
      <MemberSignature Language="C#" Value="public EventLog (string logName);" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig specialname rtspecialname instance void .ctor(string logName) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Diagnostics.EventLog.#ctor(System.String)" />
      <MemberSignature Language="VB.NET" Value="Public Sub New (logName As String)" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; EventLog(System::String ^ logName);" />
      <MemberType>Constructor</MemberType>
      <AssemblyInfo>
        <AssemblyName>System</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Parameters>
        <Parameter Name="logName" Type="System.String" />
      </Parameters>
      <Docs>
        <param name="logName"><span data-ttu-id="6be2f-199">本地计算机上日志的名称。</span><span class="sxs-lookup"><span data-stu-id="6be2f-199">The name of the log on the local computer.</span></span></param>
        <summary><span data-ttu-id="6be2f-200">初始化 <see cref="T:System.Diagnostics.EventLog" /> 类的新实例。</span><span class="sxs-lookup"><span data-stu-id="6be2f-200">Initializes a new instance of the <see cref="T:System.Diagnostics.EventLog" /> class.</span></span> <span data-ttu-id="6be2f-201">将该实例与本地计算机上的日志关联。</span><span class="sxs-lookup"><span data-stu-id="6be2f-201">Associates the instance with a log on the local computer.</span></span></summary>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="6be2f-202">此重载设置<xref:System.Diagnostics.EventLog.Log%2A>属性`logName`参数。</span><span class="sxs-lookup"><span data-stu-id="6be2f-202">This overload sets the <xref:System.Diagnostics.EventLog.Log%2A> property to the `logName` parameter.</span></span> <span data-ttu-id="6be2f-203">之前调用<xref:System.Diagnostics.EventLog.WriteEntry%2A>，指定<xref:System.Diagnostics.EventLog.Source%2A>属性<xref:System.Diagnostics.EventLog>实例。</span><span class="sxs-lookup"><span data-stu-id="6be2f-203">Before calling <xref:System.Diagnostics.EventLog.WriteEntry%2A>, specify the <xref:System.Diagnostics.EventLog.Source%2A> property of the <xref:System.Diagnostics.EventLog> instance.</span></span> <span data-ttu-id="6be2f-204">如果您仅读取<xref:System.Diagnostics.EventLog.Entries%2A>从日志中，您可以另行指定仅<xref:System.Diagnostics.EventLog.Log%2A>和<xref:System.Diagnostics.EventLog.MachineName%2A>属性。</span><span class="sxs-lookup"><span data-stu-id="6be2f-204">If you are only reading <xref:System.Diagnostics.EventLog.Entries%2A> from the log, you can alternatively specify only the <xref:System.Diagnostics.EventLog.Log%2A> and <xref:System.Diagnostics.EventLog.MachineName%2A> properties.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="6be2f-205">如果不指定<xref:System.Diagnostics.EventLog.MachineName%2A>，本地计算机 ("。") 假定。</span><span class="sxs-lookup"><span data-stu-id="6be2f-205">If you do not specify a <xref:System.Diagnostics.EventLog.MachineName%2A>, the local computer (".") is assumed.</span></span> <span data-ttu-id="6be2f-206">此重载构造函数指定<xref:System.Diagnostics.EventLog.Log%2A>属性，但您可以更改此读取操作之前<xref:System.Diagnostics.EventLog.Entries%2A>属性。</span><span class="sxs-lookup"><span data-stu-id="6be2f-206">This overload of the constructor specifies the <xref:System.Diagnostics.EventLog.Log%2A> property, but you can change this before reading the <xref:System.Diagnostics.EventLog.Entries%2A> property.</span></span>  
  
 <span data-ttu-id="6be2f-207">如果你在指定的源<xref:System.Diagnostics.EventLog.Source%2A>属性从其他源的计算机上，后续调用都是唯一<xref:System.Diagnostics.EventLog.WriteEntry%2A>如果不存在具有指定名称，创建一个日志。</span><span class="sxs-lookup"><span data-stu-id="6be2f-207">If the source you specify in the <xref:System.Diagnostics.EventLog.Source%2A> property is unique from other sources on the computer, a subsequent call to <xref:System.Diagnostics.EventLog.WriteEntry%2A> creates a log with the specified name, if it does not already exist.</span></span>  
  
 <span data-ttu-id="6be2f-208">下表显示的实例的初始属性值<xref:System.Diagnostics.EventLog>。</span><span class="sxs-lookup"><span data-stu-id="6be2f-208">The following table shows initial property values for an instance of <xref:System.Diagnostics.EventLog>.</span></span>  
  
|<span data-ttu-id="6be2f-209">Property</span><span class="sxs-lookup"><span data-stu-id="6be2f-209">Property</span></span>|<span data-ttu-id="6be2f-210">初始值</span><span class="sxs-lookup"><span data-stu-id="6be2f-210">Initial Value</span></span>|  
|--------------|-------------------|  
|<xref:System.Diagnostics.EventLog.Source%2A>|<span data-ttu-id="6be2f-211">空字符串 ("")。</span><span class="sxs-lookup"><span data-stu-id="6be2f-211">An empty string ("").</span></span>|  
|<xref:System.Diagnostics.EventLog.Log%2A>|<span data-ttu-id="6be2f-212">`logName` 参数。</span><span class="sxs-lookup"><span data-stu-id="6be2f-212">The `logName` parameter.</span></span>|  
|<xref:System.Diagnostics.EventLog.MachineName%2A>|<span data-ttu-id="6be2f-213">本地计算机 ("。")。</span><span class="sxs-lookup"><span data-stu-id="6be2f-213">The local computer (".").</span></span>|  
  
   
  
## Examples  
 <span data-ttu-id="6be2f-214">下面的示例读取在事件日志中，"myNewLog"本地计算机上的项。</span><span class="sxs-lookup"><span data-stu-id="6be2f-214">The following example reads entries in the event log, "myNewLog", on the local computer.</span></span>  
  
 [!code-cpp[Classic EventLog.EventLog1 Example#1](~/samples/snippets/cpp/VS_Snippets_CLR_Classic/classic EventLog.EventLog1 Example/CPP/source.cpp#1)]
 [!code-csharp[Classic EventLog.EventLog1 Example#1](~/samples/snippets/csharp/VS_Snippets_CLR_Classic/classic EventLog.EventLog1 Example/CS/source.cs#1)]
 [!code-vb[Classic EventLog.EventLog1 Example#1](~/samples/snippets/visualbasic/VS_Snippets_CLR_Classic/classic EventLog.EventLog1 Example/VB/source.vb#1)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentNullException"><span data-ttu-id="6be2f-215">日志名称为 <see langword="null" />。</span><span class="sxs-lookup"><span data-stu-id="6be2f-215">The log name is <see langword="null" />.</span></span></exception>
        <exception cref="T:System.ArgumentException"><span data-ttu-id="6be2f-216">日志名称无效。</span><span class="sxs-lookup"><span data-stu-id="6be2f-216">The log name is invalid.</span></span></exception>
        <permission cref="T:System.Diagnostics.EventLogPermission"><span data-ttu-id="6be2f-217">用于写入的计算机上的事件日志信息。</span><span class="sxs-lookup"><span data-stu-id="6be2f-217">for writing the event log information on the computer.</span></span> <span data-ttu-id="6be2f-218">关联的枚举： <see cref="F:System.Diagnostics.EventLogPermissionAccess.Write" /></span><span class="sxs-lookup"><span data-stu-id="6be2f-218">Associated enumeration: <see cref="F:System.Diagnostics.EventLogPermissionAccess.Write" /></span></span></permission>
        <altmember cref="P:System.Diagnostics.EventLog.Source" />
        <altmember cref="P:System.Diagnostics.EventLog.Log" />
        <altmember cref="P:System.Diagnostics.EventLog.MachineName" />
        <altmember cref="P:System.Diagnostics.EventLog.Entries" />
        <altmember cref="Overload:System.Diagnostics.EventLog.WriteEntry" />
        <altmember cref="Overload:System.Diagnostics.EventLog.WriteEvent" />
        <altmember cref="T:System.Diagnostics.EventLogEntry" />
      </Docs>
    </Member>
    <Member MemberName=".ctor">
      <MemberSignature Language="C#" Value="public EventLog (string logName, string machineName);" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig specialname rtspecialname instance void .ctor(string logName, string machineName) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Diagnostics.EventLog.#ctor(System.String,System.String)" />
      <MemberSignature Language="VB.NET" Value="Public Sub New (logName As String, machineName As String)" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; EventLog(System::String ^ logName, System::String ^ machineName);" />
      <MemberType>Constructor</MemberType>
      <AssemblyInfo>
        <AssemblyName>System</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Parameters>
        <Parameter Name="logName" Type="System.String" />
        <Parameter Name="machineName" Type="System.String" />
      </Parameters>
      <Docs>
        <param name="logName"><span data-ttu-id="6be2f-219">指定算机上日志的名称。</span><span class="sxs-lookup"><span data-stu-id="6be2f-219">The name of the log on the specified computer.</span></span></param>
        <param name="machineName"><span data-ttu-id="6be2f-220">日志所在的计算机。</span><span class="sxs-lookup"><span data-stu-id="6be2f-220">The computer on which the log exists.</span></span></param>
        <summary><span data-ttu-id="6be2f-221">初始化 <see cref="T:System.Diagnostics.EventLog" /> 类的新实例。</span><span class="sxs-lookup"><span data-stu-id="6be2f-221">Initializes a new instance of the <see cref="T:System.Diagnostics.EventLog" /> class.</span></span> <span data-ttu-id="6be2f-222">将该实例与指定计算机上的日志关联。</span><span class="sxs-lookup"><span data-stu-id="6be2f-222">Associates the instance with a log on the specified computer.</span></span></summary>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="6be2f-223">此重载设置<xref:System.Diagnostics.EventLog.Log%2A>属性`logName`参数和<xref:System.Diagnostics.EventLog.MachineName%2A>属性`machineName`参数。</span><span class="sxs-lookup"><span data-stu-id="6be2f-223">This overload sets the <xref:System.Diagnostics.EventLog.Log%2A> property to the `logName` parameter and the <xref:System.Diagnostics.EventLog.MachineName%2A> property to the `machineName` parameter.</span></span> <span data-ttu-id="6be2f-224">之前调用<xref:System.Diagnostics.EventLog.WriteEntry%2A>，指定<xref:System.Diagnostics.EventLog.Source%2A>属性<xref:System.Diagnostics.EventLog>。</span><span class="sxs-lookup"><span data-stu-id="6be2f-224">Before calling <xref:System.Diagnostics.EventLog.WriteEntry%2A>, specify the <xref:System.Diagnostics.EventLog.Source%2A> property of the <xref:System.Diagnostics.EventLog>.</span></span> <span data-ttu-id="6be2f-225">如果您仅读取<xref:System.Diagnostics.EventLog.Entries%2A>从日志中，您可以另行指定仅<xref:System.Diagnostics.EventLog.Log%2A>和<xref:System.Diagnostics.EventLog.MachineName%2A>属性。</span><span class="sxs-lookup"><span data-stu-id="6be2f-225">If you are only reading <xref:System.Diagnostics.EventLog.Entries%2A> from the log, you can alternatively specify only the <xref:System.Diagnostics.EventLog.Log%2A> and <xref:System.Diagnostics.EventLog.MachineName%2A> properties.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="6be2f-226">此重载构造函数指定<xref:System.Diagnostics.EventLog.Log%2A>和<xref:System.Diagnostics.EventLog.MachineName%2A>属性，但您可以更改之前读取或是<xref:System.Diagnostics.EventLog.Entries%2A>属性。</span><span class="sxs-lookup"><span data-stu-id="6be2f-226">This overload of the constructor specifies the <xref:System.Diagnostics.EventLog.Log%2A> and <xref:System.Diagnostics.EventLog.MachineName%2A> properties, but you can change either before reading the <xref:System.Diagnostics.EventLog.Entries%2A> property.</span></span>  
  
 <span data-ttu-id="6be2f-227">下表显示的实例的初始属性值<xref:System.Diagnostics.EventLog>。</span><span class="sxs-lookup"><span data-stu-id="6be2f-227">The following table shows initial property values for an instance of <xref:System.Diagnostics.EventLog>.</span></span>  
  
|<span data-ttu-id="6be2f-228">Property</span><span class="sxs-lookup"><span data-stu-id="6be2f-228">Property</span></span>|<span data-ttu-id="6be2f-229">初始值</span><span class="sxs-lookup"><span data-stu-id="6be2f-229">Initial Value</span></span>|  
|--------------|-------------------|  
|<xref:System.Diagnostics.EventLog.Source%2A>|<span data-ttu-id="6be2f-230">空字符串 ("")。</span><span class="sxs-lookup"><span data-stu-id="6be2f-230">An empty string ("").</span></span>|  
|<xref:System.Diagnostics.EventLog.Log%2A>|<span data-ttu-id="6be2f-231">`logName` 参数。</span><span class="sxs-lookup"><span data-stu-id="6be2f-231">The `logName` parameter.</span></span>|  
|<xref:System.Diagnostics.EventLog.MachineName%2A>|<span data-ttu-id="6be2f-232">`machineName` 参数。</span><span class="sxs-lookup"><span data-stu-id="6be2f-232">The `machineName` parameter.</span></span>|  
  
   
  
## Examples  
 <span data-ttu-id="6be2f-233">下面的示例读取在事件日志中，"myNewLog"计算机"myServer"上的项。</span><span class="sxs-lookup"><span data-stu-id="6be2f-233">The following example reads entries in the event log, "myNewLog", on the computer "myServer".</span></span>  
  
 [!code-cpp[Classic EventLog.EventLog2 Example#1](~/samples/snippets/cpp/VS_Snippets_CLR_Classic/classic EventLog.EventLog2 Example/CPP/source.cpp#1)]
 [!code-csharp[Classic EventLog.EventLog2 Example#1](~/samples/snippets/csharp/VS_Snippets_CLR_Classic/classic EventLog.EventLog2 Example/CS/source.cs#1)]
 [!code-vb[Classic EventLog.EventLog2 Example#1](~/samples/snippets/visualbasic/VS_Snippets_CLR_Classic/classic EventLog.EventLog2 Example/VB/source.vb#1)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentNullException"><span data-ttu-id="6be2f-234">日志名称为 <see langword="null" />。</span><span class="sxs-lookup"><span data-stu-id="6be2f-234">The log name is <see langword="null" />.</span></span></exception>
        <exception cref="T:System.ArgumentException"><span data-ttu-id="6be2f-235">日志名称无效。</span><span class="sxs-lookup"><span data-stu-id="6be2f-235">The log name is invalid.</span></span>  
  
 <span data-ttu-id="6be2f-236">或</span><span class="sxs-lookup"><span data-stu-id="6be2f-236">-or-</span></span>  
  
 <span data-ttu-id="6be2f-237">计算机名称无效。</span><span class="sxs-lookup"><span data-stu-id="6be2f-237">The computer name is invalid.</span></span></exception>
        <permission cref="T:System.Diagnostics.EventLogPermission"><span data-ttu-id="6be2f-238">用于写入的计算机上的事件日志信息。</span><span class="sxs-lookup"><span data-stu-id="6be2f-238">for writing the event log information on the computer.</span></span> <span data-ttu-id="6be2f-239">关联的枚举： <see cref="F:System.Diagnostics.EventLogPermissionAccess.Write" /></span><span class="sxs-lookup"><span data-stu-id="6be2f-239">Associated enumeration: <see cref="F:System.Diagnostics.EventLogPermissionAccess.Write" /></span></span></permission>
        <altmember cref="P:System.Diagnostics.EventLog.Source" />
        <altmember cref="P:System.Diagnostics.EventLog.Log" />
        <altmember cref="P:System.Diagnostics.EventLog.MachineName" />
        <altmember cref="P:System.Diagnostics.EventLog.Entries" />
        <altmember cref="Overload:System.Diagnostics.EventLog.WriteEntry" />
        <altmember cref="Overload:System.Diagnostics.EventLog.WriteEvent" />
        <altmember cref="T:System.Diagnostics.EventLogEntry" />
      </Docs>
    </Member>
    <Member MemberName=".ctor">
      <MemberSignature Language="C#" Value="public EventLog (string logName, string machineName, string source);" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig specialname rtspecialname instance void .ctor(string logName, string machineName, string source) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Diagnostics.EventLog.#ctor(System.String,System.String,System.String)" />
      <MemberSignature Language="VB.NET" Value="Public Sub New (logName As String, machineName As String, source As String)" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; EventLog(System::String ^ logName, System::String ^ machineName, System::String ^ source);" />
      <MemberType>Constructor</MemberType>
      <AssemblyInfo>
        <AssemblyName>System</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Parameters>
        <Parameter Name="logName" Type="System.String" />
        <Parameter Name="machineName" Type="System.String" />
        <Parameter Name="source" Type="System.String" />
      </Parameters>
      <Docs>
        <param name="logName"><span data-ttu-id="6be2f-240">指定的计算机上日志的名称</span><span class="sxs-lookup"><span data-stu-id="6be2f-240">The name of the log on the specified computer</span></span></param>
        <param name="machineName"><span data-ttu-id="6be2f-241">日志所在的计算机。</span><span class="sxs-lookup"><span data-stu-id="6be2f-241">The computer on which the log exists.</span></span></param>
        <param name="source"><span data-ttu-id="6be2f-242">事件日志项的源。</span><span class="sxs-lookup"><span data-stu-id="6be2f-242">The source of event log entries.</span></span></param>
        <summary><span data-ttu-id="6be2f-243">初始化 <see cref="T:System.Diagnostics.EventLog" /> 类的新实例。</span><span class="sxs-lookup"><span data-stu-id="6be2f-243">Initializes a new instance of the <see cref="T:System.Diagnostics.EventLog" /> class.</span></span> <span data-ttu-id="6be2f-244">将实例与指定的计算机上的日志关联，并为 <see cref="T:System.Diagnostics.EventLog" /> 实例创建或分配指定的源。</span><span class="sxs-lookup"><span data-stu-id="6be2f-244">Associates the instance with a log on the specified computer and creates or assigns the specified source to the <see cref="T:System.Diagnostics.EventLog" />.</span></span></summary>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="6be2f-245">此构造函数设置<xref:System.Diagnostics.EventLog.Log%2A>属性`logName`参数，<xref:System.Diagnostics.EventLog.MachineName%2A>属性`machineName`参数，与<xref:System.Diagnostics.EventLog.Source%2A>属性`source`参数。</span><span class="sxs-lookup"><span data-stu-id="6be2f-245">This constructor sets the <xref:System.Diagnostics.EventLog.Log%2A> property to the `logName` parameter, the <xref:System.Diagnostics.EventLog.MachineName%2A> property to the `machineName` parameter, and the <xref:System.Diagnostics.EventLog.Source%2A> property to the `source` parameter.</span></span> <span data-ttu-id="6be2f-246"><xref:System.Diagnostics.EventLog.Source%2A>属性是必需的写入事件日志时。</span><span class="sxs-lookup"><span data-stu-id="6be2f-246">The <xref:System.Diagnostics.EventLog.Source%2A> property is required when writing to an event log.</span></span> <span data-ttu-id="6be2f-247">但是，如果你只是从读取事件日志，仅<xref:System.Diagnostics.EventLog.Log%2A>和<xref:System.Diagnostics.EventLog.MachineName%2A>属性都是必需 （只要服务器上的事件日志具有已与它关联的源）。</span><span class="sxs-lookup"><span data-stu-id="6be2f-247">However, if you are only reading from an event log, only the <xref:System.Diagnostics.EventLog.Log%2A> and <xref:System.Diagnostics.EventLog.MachineName%2A> properties are required (as long as the event log on the server has a source already associated with it).</span></span> <span data-ttu-id="6be2f-248">如果你只是读取从事件日志，可能可以满足另一个重载构造函数。</span><span class="sxs-lookup"><span data-stu-id="6be2f-248">If you are only reading from the event log, another overload of the constructor might suffice.</span></span>  
  
 <span data-ttu-id="6be2f-249">下表显示的实例的初始属性值<xref:System.Diagnostics.EventLog>。</span><span class="sxs-lookup"><span data-stu-id="6be2f-249">The following table shows initial property values for an instance of <xref:System.Diagnostics.EventLog>.</span></span>  
  
|<span data-ttu-id="6be2f-250">Property</span><span class="sxs-lookup"><span data-stu-id="6be2f-250">Property</span></span>|<span data-ttu-id="6be2f-251">初始值</span><span class="sxs-lookup"><span data-stu-id="6be2f-251">Initial Value</span></span>|  
|--------------|-------------------|  
|<xref:System.Diagnostics.EventLog.Source%2A>|<span data-ttu-id="6be2f-252">`source` 参数。</span><span class="sxs-lookup"><span data-stu-id="6be2f-252">The `source` parameter.</span></span>|  
|<xref:System.Diagnostics.EventLog.Log%2A>|<span data-ttu-id="6be2f-253">`logName` 参数。</span><span class="sxs-lookup"><span data-stu-id="6be2f-253">The `logName` parameter.</span></span>|  
|<xref:System.Diagnostics.EventLog.MachineName%2A>|<span data-ttu-id="6be2f-254">`machineName` 参数。</span><span class="sxs-lookup"><span data-stu-id="6be2f-254">The `machineName` parameter.</span></span>|  
  
   
  
## Examples  
 <span data-ttu-id="6be2f-255">下面的示例一个项写入事件日志中，"MyNewLog"，使用源""的本地计算机上。</span><span class="sxs-lookup"><span data-stu-id="6be2f-255">The following example writes an entry to an event log, "MyNewLog", on the local computer, using the source "MySource".</span></span>  
  
 [!code-cpp[Classic EventLog.EventLog3 Example#1](~/samples/snippets/cpp/VS_Snippets_CLR_Classic/classic EventLog.EventLog3 Example/CPP/source.cpp#1)]
 [!code-csharp[Classic EventLog.EventLog3 Example#1](~/samples/snippets/csharp/VS_Snippets_CLR_Classic/classic EventLog.EventLog3 Example/CS/source.cs#1)]
 [!code-vb[Classic EventLog.EventLog3 Example#1](~/samples/snippets/visualbasic/VS_Snippets_CLR_Classic/classic EventLog.EventLog3 Example/VB/source.vb#1)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentNullException"><span data-ttu-id="6be2f-256">日志名称为 <see langword="null" />。</span><span class="sxs-lookup"><span data-stu-id="6be2f-256">The log name is <see langword="null" />.</span></span></exception>
        <exception cref="T:System.ArgumentException"><span data-ttu-id="6be2f-257">日志名称无效。</span><span class="sxs-lookup"><span data-stu-id="6be2f-257">The log name is invalid.</span></span>  
  
 <span data-ttu-id="6be2f-258">或</span><span class="sxs-lookup"><span data-stu-id="6be2f-258">-or-</span></span>  
  
 <span data-ttu-id="6be2f-259">计算机名称无效。</span><span class="sxs-lookup"><span data-stu-id="6be2f-259">The computer name is invalid.</span></span></exception>
        <permission cref="T:System.Diagnostics.EventLogPermission"><span data-ttu-id="6be2f-260">用于写入的计算机上的事件日志信息。</span><span class="sxs-lookup"><span data-stu-id="6be2f-260">for writing the event log information on the computer.</span></span> <span data-ttu-id="6be2f-261">关联的枚举： <see cref="F:System.Diagnostics.EventLogPermissionAccess.Write" /></span><span class="sxs-lookup"><span data-stu-id="6be2f-261">Associated enumeration: <see cref="F:System.Diagnostics.EventLogPermissionAccess.Write" /></span></span></permission>
        <altmember cref="P:System.Diagnostics.EventLog.Source" />
        <altmember cref="P:System.Diagnostics.EventLog.Log" />
        <altmember cref="P:System.Diagnostics.EventLog.MachineName" />
        <altmember cref="P:System.Diagnostics.EventLog.Entries" />
        <altmember cref="Overload:System.Diagnostics.EventLog.WriteEntry" />
        <altmember cref="Overload:System.Diagnostics.EventLog.WriteEvent" />
        <altmember cref="T:System.Diagnostics.EventLogEntry" />
      </Docs>
    </Member>
    <Member MemberName="BeginInit">
      <MemberSignature Language="C#" Value="public void BeginInit ();" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig newslot virtual instance void BeginInit() cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Diagnostics.EventLog.BeginInit" />
      <MemberSignature Language="VB.NET" Value="Public Sub BeginInit ()" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; virtual void BeginInit();" />
      <MemberType>Method</MemberType>
      <Implements>
        <InterfaceMember>M:System.ComponentModel.ISupportInitialize.BeginInit</InterfaceMember>
      </Implements>
      <AssemblyInfo>
        <AssemblyName>System</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Void</ReturnType>
      </ReturnValue>
      <Parameters />
      <Docs>
        <summary><span data-ttu-id="6be2f-262">开始初始化用于窗体或由其他组件使用的 <see cref="T:System.Diagnostics.EventLog" />。</span><span class="sxs-lookup"><span data-stu-id="6be2f-262">Begins the initialization of an <see cref="T:System.Diagnostics.EventLog" /> used on a form or used by another component.</span></span> <span data-ttu-id="6be2f-263">此初始化在运行时发生。</span><span class="sxs-lookup"><span data-stu-id="6be2f-263">The initialization occurs at runtime.</span></span></summary>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="6be2f-264">[!INCLUDE[vsprvslong](~/includes/vsprvslong-md.md)]设计环境使用此方法来开始使用窗体或由另一个组件的组件的初始化。</span><span class="sxs-lookup"><span data-stu-id="6be2f-264">The [!INCLUDE[vsprvslong](~/includes/vsprvslong-md.md)] design environment uses this method to start the initialization of a component used on a form or by another component.</span></span> <span data-ttu-id="6be2f-265"><xref:System.Diagnostics.EventLog.EndInit%2A>方法初始化已结束。</span><span class="sxs-lookup"><span data-stu-id="6be2f-265">The <xref:System.Diagnostics.EventLog.EndInit%2A> method ends the initialization.</span></span> <span data-ttu-id="6be2f-266">使用<xref:System.Diagnostics.EventLog.BeginInit%2A>和<xref:System.Diagnostics.EventLog.EndInit%2A>方法阻止中完全初始化之前使用的控件。</span><span class="sxs-lookup"><span data-stu-id="6be2f-266">Using the <xref:System.Diagnostics.EventLog.BeginInit%2A> and <xref:System.Diagnostics.EventLog.EndInit%2A> methods prevent the control from being used before it is fully initialized.</span></span>  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.InvalidOperationException">
          <span data-ttu-id="6be2f-267"><see cref="T:System.Diagnostics.EventLog" /> 已初始化完毕。</span><span class="sxs-lookup"><span data-stu-id="6be2f-267"><see cref="T:System.Diagnostics.EventLog" /> is already initialized.</span></span></exception>
        <permission cref="T:System.Diagnostics.EventLogPermission"><span data-ttu-id="6be2f-268">用于写入的计算机上的事件日志信息。</span><span class="sxs-lookup"><span data-stu-id="6be2f-268">for writing the event log information on the computer.</span></span> <span data-ttu-id="6be2f-269">关联的枚举： <see cref="F:System.Diagnostics.EventLogPermissionAccess.Write" /></span><span class="sxs-lookup"><span data-stu-id="6be2f-269">Associated enumeration: <see cref="F:System.Diagnostics.EventLogPermissionAccess.Write" /></span></span></permission>
        <altmember cref="M:System.Diagnostics.EventLog.EndInit" />
      </Docs>
    </Member>
    <Member MemberName="Clear">
      <MemberSignature Language="C#" Value="public void Clear ();" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig instance void Clear() cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Diagnostics.EventLog.Clear" />
      <MemberSignature Language="VB.NET" Value="Public Sub Clear ()" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; void Clear();" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Void</ReturnType>
      </ReturnValue>
      <Parameters />
      <Docs>
        <summary><span data-ttu-id="6be2f-270">从事件日志中移除所有项。</span><span class="sxs-lookup"><span data-stu-id="6be2f-270">Removes all entries from the event log.</span></span></summary>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="6be2f-271">事件日志设置最大大小，它确定它们可以包含的项数。</span><span class="sxs-lookup"><span data-stu-id="6be2f-271">Event logs are set with a maximum size that determines how many entries they can contain.</span></span> <span data-ttu-id="6be2f-272">当事件日志已满时，它将停止记录新的事件信息，或开始覆盖以前的项。</span><span class="sxs-lookup"><span data-stu-id="6be2f-272">When an event log is full, it stops recording new event information or begins to overwrite earlier entries.</span></span> <span data-ttu-id="6be2f-273">如果事件录制停止后，你可以使用此方法要清除日志中的现有条目，并允许它重新开始记录事件。</span><span class="sxs-lookup"><span data-stu-id="6be2f-273">If event recording stops, you can use this method to clear the log of existing entries and allow it to start recording events again.</span></span> <span data-ttu-id="6be2f-274">你必须具有到日志驻留以清除事件日志条目的计算机的管理员权限。</span><span class="sxs-lookup"><span data-stu-id="6be2f-274">You must have administrator permissions to the computer on which the log resides to clear event log entries.</span></span>  
  
 <span data-ttu-id="6be2f-275"><xref:System.Diagnostics.EventLog.Clear%2A> 关闭事件日志、 释放事件句柄，检索新读取和写入句柄，并重新打开事件日志。</span><span class="sxs-lookup"><span data-stu-id="6be2f-275"><xref:System.Diagnostics.EventLog.Clear%2A> closes the event log, releases the event handles, retrieves new read and write handles, and reopens the event log.</span></span> <span data-ttu-id="6be2f-276">对方法的调用后收到的事件不会清除与现有的事件中。</span><span class="sxs-lookup"><span data-stu-id="6be2f-276">Events received after the call to the method are not cleared along with the existing events.</span></span>  
  
   
  
## Examples  
 <span data-ttu-id="6be2f-277">下面的示例清除事件日志。</span><span class="sxs-lookup"><span data-stu-id="6be2f-277">The following example clears an event log.</span></span>  
  
> [!CAUTION]
>  <span data-ttu-id="6be2f-278">因为应用程序、 系统、 安全性和其他非自定义日志可能包含重要信息;请确保在执行此示例代码之前指定自定义日志。</span><span class="sxs-lookup"><span data-stu-id="6be2f-278">Because Application, System, Security, and other non-custom logs can contain crucial information; be sure to specify a custom log before executing this example code.</span></span> <span data-ttu-id="6be2f-279">此示例将删除自定义日志`myNewLog`。</span><span class="sxs-lookup"><span data-stu-id="6be2f-279">This example deletes the custom log `myNewLog`.</span></span>  
  
 [!code-cpp[Classic EventLog.Clear Example#1](~/samples/snippets/cpp/VS_Snippets_CLR_Classic/classic EventLog.Clear Example/CPP/source.cpp#1)]
 [!code-csharp[Classic EventLog.Clear Example#1](~/samples/snippets/csharp/VS_Snippets_CLR_Classic/classic EventLog.Clear Example/CS/source.cs#1)]
 [!code-vb[Classic EventLog.Clear Example#1](~/samples/snippets/visualbasic/VS_Snippets_CLR_Classic/classic EventLog.Clear Example/VB/source.vb#1)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ComponentModel.Win32Exception"><span data-ttu-id="6be2f-280">未成功清除事件日志。</span><span class="sxs-lookup"><span data-stu-id="6be2f-280">The event log was not cleared successfully.</span></span>  
  
 <span data-ttu-id="6be2f-281">或</span><span class="sxs-lookup"><span data-stu-id="6be2f-281">-or-</span></span>  
  
 <span data-ttu-id="6be2f-282">无法打开日志。</span><span class="sxs-lookup"><span data-stu-id="6be2f-282">The log cannot be opened.</span></span> <span data-ttu-id="6be2f-283">一个 Windows 错误代码不可用。</span><span class="sxs-lookup"><span data-stu-id="6be2f-283">A Windows error code is not available.</span></span></exception>
        <exception cref="T:System.ArgumentException"><span data-ttu-id="6be2f-284">没有为 <see cref="P:System.Diagnostics.EventLog.Log" /> 属性指定值。</span><span class="sxs-lookup"><span data-stu-id="6be2f-284">A value is not specified for the <see cref="P:System.Diagnostics.EventLog.Log" /> property.</span></span> <span data-ttu-id="6be2f-285">确保日志名称不是一个空字符串。</span><span class="sxs-lookup"><span data-stu-id="6be2f-285">Make sure the log name is not an empty string.</span></span></exception>
        <exception cref="T:System.InvalidOperationException"><span data-ttu-id="6be2f-286">该日志不存在。</span><span class="sxs-lookup"><span data-stu-id="6be2f-286">The log does not exist.</span></span></exception>
        <permission cref="T:System.Diagnostics.EventLogPermission"><span data-ttu-id="6be2f-287">用于管理的计算机上的事件日志信息。</span><span class="sxs-lookup"><span data-stu-id="6be2f-287">for administering event log information on the computer.</span></span> <span data-ttu-id="6be2f-288">关联的枚举： <see cref="F:System.Diagnostics.EventLogPermissionAccess.Administer" /></span><span class="sxs-lookup"><span data-stu-id="6be2f-288">Associated enumeration: <see cref="F:System.Diagnostics.EventLogPermissionAccess.Administer" /></span></span></permission>
        <altmember cref="M:System.Diagnostics.EventLog.Close" />
        <altmember cref="M:System.Diagnostics.EventLog.Delete(System.String)" />
      </Docs>
    </Member>
    <Member MemberName="Close">
      <MemberSignature Language="C#" Value="public void Close ();" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig instance void Close() cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Diagnostics.EventLog.Close" />
      <MemberSignature Language="VB.NET" Value="Public Sub Close ()" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; void Close();" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Void</ReturnType>
      </ReturnValue>
      <Parameters />
      <Docs>
        <summary><span data-ttu-id="6be2f-289">关闭事件日志并释放读写句柄。</span><span class="sxs-lookup"><span data-stu-id="6be2f-289">Closes the event log and releases read and write handles.</span></span></summary>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="6be2f-290"><xref:System.Diagnostics.EventLog.Close%2A>调用方法的受保护<xref:System.ComponentModel.Component.Dispose%2A>方法。</span><span class="sxs-lookup"><span data-stu-id="6be2f-290">The <xref:System.Diagnostics.EventLog.Close%2A> method is called by the protected <xref:System.ComponentModel.Component.Dispose%2A> method.</span></span> <span data-ttu-id="6be2f-291">不需要调用<xref:System.Diagnostics.EventLog.Close%2A>之前调用<xref:System.ComponentModel.Component.Dispose%2A>。</span><span class="sxs-lookup"><span data-stu-id="6be2f-291">You do not need to invoke <xref:System.Diagnostics.EventLog.Close%2A> before calling <xref:System.ComponentModel.Component.Dispose%2A>.</span></span>  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ComponentModel.Win32Exception"><span data-ttu-id="6be2f-292">事件日志的读句柄或写句柄未成功释放。</span><span class="sxs-lookup"><span data-stu-id="6be2f-292">The event log's read handle or write handle was not released successfully.</span></span></exception>
        <permission cref="T:System.Diagnostics.EventLogPermission"><span data-ttu-id="6be2f-293">用于写入的计算机上的事件日志信息。</span><span class="sxs-lookup"><span data-stu-id="6be2f-293">for writing the event log information on the computer.</span></span> <span data-ttu-id="6be2f-294">关联的枚举： <see cref="F:System.Diagnostics.EventLogPermissionAccess.Write" /></span><span class="sxs-lookup"><span data-stu-id="6be2f-294">Associated enumeration: <see cref="F:System.Diagnostics.EventLogPermissionAccess.Write" /></span></span></permission>
        <altmember cref="M:System.Diagnostics.EventLog.Delete(System.String)" />
        <altmember cref="M:System.Diagnostics.EventLog.Clear" />
      </Docs>
    </Member>
    <MemberGroup MemberName="CreateEventSource">
      <AssemblyInfo>
        <AssemblyName>System</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Docs>
        <summary><span data-ttu-id="6be2f-295">建立一个能够将事件信息写入到系统的特定日志中的应用程序。</span><span class="sxs-lookup"><span data-stu-id="6be2f-295">Establishes an application as able to write event information to a particular log on the system.</span></span></summary>
      </Docs>
    </MemberGroup>
    <Member MemberName="CreateEventSource">
      <MemberSignature Language="C#" Value="public static void CreateEventSource (System.Diagnostics.EventSourceCreationData sourceData);" />
      <MemberSignature Language="ILAsm" Value=".method public static hidebysig void CreateEventSource(class System.Diagnostics.EventSourceCreationData sourceData) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Diagnostics.EventLog.CreateEventSource(System.Diagnostics.EventSourceCreationData)" />
      <MemberSignature Language="VB.NET" Value="Public Shared Sub CreateEventSource (sourceData As EventSourceCreationData)" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; static void CreateEventSource(System::Diagnostics::EventSourceCreationData ^ sourceData);" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Attributes>
        <Attribute>
          <AttributeName>System.MonoNotSupported("remote machine is not supported")</AttributeName>
        </Attribute>
      </Attributes>
      <ReturnValue>
        <ReturnType>System.Void</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="sourceData" Type="System.Diagnostics.EventSourceCreationData" />
      </Parameters>
      <Docs>
        <param name="sourceData"><span data-ttu-id="6be2f-296">事件源及其目标事件日志的配置属性。</span><span class="sxs-lookup"><span data-stu-id="6be2f-296">The configuration properties for the event source and its target event log.</span></span></param>
        <summary><span data-ttu-id="6be2f-297">通过使用为该事件源和对应的事件日志指定的配置属性，建立一个写入本地化事件消息的有效事件源。</span><span class="sxs-lookup"><span data-stu-id="6be2f-297">Establishes a valid event source for writing localized event messages, using the specified configuration properties for the event source and the corresponding event log.</span></span></summary>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="6be2f-298">此重载用于配置新的源用于将本地计算机或远程计算机上写入事件日志条目。</span><span class="sxs-lookup"><span data-stu-id="6be2f-298">Use this overload to configure a new source for writing entries to an event log on the local computer or a remote computer.</span></span> <span data-ttu-id="6be2f-299">不需要使用此方法从事件日志进行读取。</span><span class="sxs-lookup"><span data-stu-id="6be2f-299">It is not necessary to use this method to read from an event log.</span></span>  
  
 <span data-ttu-id="6be2f-300"><xref:System.Diagnostics.EventLog.CreateEventSource%2A>方法使用输入`sourceData` <xref:System.Diagnostics.EventSourceCreationData.Source%2A>，<xref:System.Diagnostics.EventSourceCreationData.LogName%2A>和<xref:System.Diagnostics.EventSourceCreationData.MachineName%2A>属性以创建新的源和其关联的事件日志在目标计算机上的注册表值。</span><span class="sxs-lookup"><span data-stu-id="6be2f-300">The <xref:System.Diagnostics.EventLog.CreateEventSource%2A> method uses the input `sourceData`<xref:System.Diagnostics.EventSourceCreationData.Source%2A>, <xref:System.Diagnostics.EventSourceCreationData.LogName%2A> and <xref:System.Diagnostics.EventSourceCreationData.MachineName%2A> properties to create registry values on the target computer for the new source and its associated event log.</span></span> <span data-ttu-id="6be2f-301">新的源名称不能与现有源名称或目标计算机上的现有事件日志名称匹配。</span><span class="sxs-lookup"><span data-stu-id="6be2f-301">A new source name cannot match an existing source name or an existing event log name on the target computer.</span></span> <span data-ttu-id="6be2f-302">如果<xref:System.Diagnostics.EventSourceCreationData.LogName%2A>属性未设置，为应用程序事件日志注册源。</span><span class="sxs-lookup"><span data-stu-id="6be2f-302">If the <xref:System.Diagnostics.EventSourceCreationData.LogName%2A> property is not set, the source is registered for the Application event log.</span></span> <span data-ttu-id="6be2f-303">如果<xref:System.Diagnostics.EventSourceCreationData.MachineName%2A>未设置，在本地计算机上注册源。</span><span class="sxs-lookup"><span data-stu-id="6be2f-303">If the <xref:System.Diagnostics.EventSourceCreationData.MachineName%2A> is not set, the source is registered on the local computer.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="6be2f-304">若要创建的事件源在 Windows Vista 或更高版本或 Windows Server 2003，必须具有管理权限。</span><span class="sxs-lookup"><span data-stu-id="6be2f-304">To create an event source in Windows Vista and later or Windows Server 2003, you must have administrative privileges.</span></span>  
>   
>  <span data-ttu-id="6be2f-305">此要求的原因是所有的事件日志，包括安全性，必须进行搜索以确定事件源是否唯一。</span><span class="sxs-lookup"><span data-stu-id="6be2f-305">The reason for this requirement is that all event logs, including security, must be searched to determine whether the event source is unique.</span></span> <span data-ttu-id="6be2f-306">从 Windows Vista 开始，用户没有权限访问安全事件日志中。因此，<xref:System.Security.SecurityException>引发。</span><span class="sxs-lookup"><span data-stu-id="6be2f-306">Starting with Windows Vista, users do not have permission to access the security log; therefore, a <xref:System.Security.SecurityException> is thrown.</span></span>  
>   
>  <span data-ttu-id="6be2f-307">从 Windows Vista 开始，用户帐户控制 (UAC) 决定用户的特权。</span><span class="sxs-lookup"><span data-stu-id="6be2f-307">Starting with Windows Vista, User Account Control (UAC) determines the privileges of a user.</span></span> <span data-ttu-id="6be2f-308">如果您是内置的 Administrators 组的成员，将为您分配两个运行时访问令牌：一个标准用户访问令牌和一个管理员访问令牌。</span><span class="sxs-lookup"><span data-stu-id="6be2f-308">If you are a member of the Built-in Administrators group, you are assigned two run-time access tokens: a standard user access token and an administrator access token.</span></span> <span data-ttu-id="6be2f-309">默认情况下，您拥有标准用户角色。</span><span class="sxs-lookup"><span data-stu-id="6be2f-309">By default, you are in the standard user role.</span></span> <span data-ttu-id="6be2f-310">若要执行的代码访问安全日志，首先必须将你的特权从标准用户提升至管理员。</span><span class="sxs-lookup"><span data-stu-id="6be2f-310">To execute the code that accesses the security log, you must first elevate your privileges from standard user to administrator.</span></span> <span data-ttu-id="6be2f-311">你可以通过以下方式执行此操作：右键单击应用程序图标并指示需以管理员身份运行。</span><span class="sxs-lookup"><span data-stu-id="6be2f-311">You can do this when you start an application by right-clicking the application icon and indicating that you want to run as an administrator.</span></span>  
  
 <span data-ttu-id="6be2f-312">使用<xref:System.Diagnostics.EventLog.WriteEvent%2A>和<xref:System.Diagnostics.EventLog.WriteEntry%2A>事件写入事件日志。</span><span class="sxs-lookup"><span data-stu-id="6be2f-312">Use <xref:System.Diagnostics.EventLog.WriteEvent%2A> and <xref:System.Diagnostics.EventLog.WriteEntry%2A> to write events to an event log.</span></span> <span data-ttu-id="6be2f-313">必须指定事件源写入事件;你必须创建并在编写与源的第一个条目之前，配置事件源。</span><span class="sxs-lookup"><span data-stu-id="6be2f-313">You must specify an event source to write events; you must create and configure the event source before writing the first entry with the source.</span></span>  
  
 <span data-ttu-id="6be2f-314">在你的应用程序的安装过程中创建新的事件源。</span><span class="sxs-lookup"><span data-stu-id="6be2f-314">Create the new event source during the installation of your application.</span></span> <span data-ttu-id="6be2f-315">这样，可以为操作系统来刷新其已注册的事件源的列表和其配置的时间。</span><span class="sxs-lookup"><span data-stu-id="6be2f-315">This allows time for the operating system to refresh its list of registered event sources and their configuration.</span></span> <span data-ttu-id="6be2f-316">如果操作系统未刷新其事件源的列表，并尝试写入新的源的事件写入操作将失败。</span><span class="sxs-lookup"><span data-stu-id="6be2f-316">If the operating system has not refreshed its list of event sources, and you attempt to write an event with the new source, the write operation will fail.</span></span> <span data-ttu-id="6be2f-317">你可以配置新的源使用<xref:System.Diagnostics.EventLogInstaller>，或使用<xref:System.Diagnostics.EventLog.CreateEventSource%2A>方法。</span><span class="sxs-lookup"><span data-stu-id="6be2f-317">You can configure a new source using an <xref:System.Diagnostics.EventLogInstaller>, or using the <xref:System.Diagnostics.EventLog.CreateEventSource%2A> method.</span></span> <span data-ttu-id="6be2f-318">若要创建新的事件源的计算机上，必须具有管理权限。</span><span class="sxs-lookup"><span data-stu-id="6be2f-318">You must have administrative rights on the computer to create a new event source.</span></span>  
  
 <span data-ttu-id="6be2f-319">你可以创建现有的事件日志或新的事件日志的事件源。</span><span class="sxs-lookup"><span data-stu-id="6be2f-319">You can create an event source for an existing event log or a new event log.</span></span> <span data-ttu-id="6be2f-320">在创建新的源的新的事件日志时，系统将为该日志，此源注册，但之前向其中写入的第一个条目，将不会创建日志。</span><span class="sxs-lookup"><span data-stu-id="6be2f-320">When you create a new source for a new event log, the system registers the source for that log, but the log is not created until the first entry is written to it.</span></span>  
  
 <span data-ttu-id="6be2f-321">操作系统将事件日志存储为文件。</span><span class="sxs-lookup"><span data-stu-id="6be2f-321">The operating system stores event logs as files.</span></span> <span data-ttu-id="6be2f-322">当你使用<xref:System.Diagnostics.EventLogInstaller>或<xref:System.Diagnostics.EventLog.CreateEventSource%2A>若要创建新的事件日志，关联的文件存储在指定的计算机上的 %SystemRoot%\System32\Config 目录。</span><span class="sxs-lookup"><span data-stu-id="6be2f-322">When you use <xref:System.Diagnostics.EventLogInstaller> or <xref:System.Diagnostics.EventLog.CreateEventSource%2A> to create a new event log, the associated file is stored in the %SystemRoot%\System32\Config directory on the specified computer.</span></span> <span data-ttu-id="6be2f-323">通过追加的前 8 个字符设置的文件名称<xref:System.Diagnostics.EventLog.Log%2A>".evt"文件扩展名的属性。</span><span class="sxs-lookup"><span data-stu-id="6be2f-323">The file name is set by appending the first 8 characters of the <xref:System.Diagnostics.EventLog.Log%2A> property with the ".evt" file name extension.</span></span>  
  
 <span data-ttu-id="6be2f-324">每个源可以仅写入只有一个事件日志一次;但是，你的应用程序可以使用多个源写入多个事件日志。</span><span class="sxs-lookup"><span data-stu-id="6be2f-324">Each source can only write to only one event log at a time; however, your application can use multiple sources to write to multiple event logs.</span></span> <span data-ttu-id="6be2f-325">例如，你的应用程序可能需要为不同的事件日志或不同的资源文件配置的多个源。</span><span class="sxs-lookup"><span data-stu-id="6be2f-325">For example, your application might require multiple sources configured for different event logs or different resource files.</span></span>  
  
 <span data-ttu-id="6be2f-326">你可以先使用本地化的资源文件注册事件源，为你的事件类别和消息字符串。</span><span class="sxs-lookup"><span data-stu-id="6be2f-326">You can register the event source with localized resource file(s) for your event category and message strings.</span></span> <span data-ttu-id="6be2f-327">你的应用程序可以写入事件日志项使用资源标识符，而不指定实际的字符串。</span><span class="sxs-lookup"><span data-stu-id="6be2f-327">Your application can write event log entries using resource identifiers, rather than specifying the actual string.</span></span> <span data-ttu-id="6be2f-328">事件查看器使用的资源标识符来查找并显示基于当前语言设置的本地化的资源文件中的相应字符串。</span><span class="sxs-lookup"><span data-stu-id="6be2f-328">The Event Viewer uses the resource identifier to find and display the corresponding string from the localized resource file based on current language settings.</span></span> <span data-ttu-id="6be2f-329">你可以注册为事件类别、 消息和参数插入字符串，单独的文件，或者也可以注册为所有三种类型的字符串的相同资源文件。</span><span class="sxs-lookup"><span data-stu-id="6be2f-329">You can register a separate file for event categories, messages and parameter insertion strings, or you can register the same resource file for all three types of strings.</span></span> <span data-ttu-id="6be2f-330">使用<xref:System.Diagnostics.EventSourceCreationData.CategoryCount%2A>， <xref:System.Diagnostics.EventSourceCreationData.CategoryResourceFile%2A>， <xref:System.Diagnostics.EventSourceCreationData.MessageResourceFile%2A>，和<xref:System.Diagnostics.EventSourceCreationData.ParameterResourceFile%2A>属性来配置要向事件日志写入本地化的条目的源。</span><span class="sxs-lookup"><span data-stu-id="6be2f-330">Use the <xref:System.Diagnostics.EventSourceCreationData.CategoryCount%2A>, <xref:System.Diagnostics.EventSourceCreationData.CategoryResourceFile%2A>, <xref:System.Diagnostics.EventSourceCreationData.MessageResourceFile%2A>, and <xref:System.Diagnostics.EventSourceCreationData.ParameterResourceFile%2A> properties to configure the source to write localized entries to the event log.</span></span> <span data-ttu-id="6be2f-331">如果你的应用程序将直接写入事件日志的字符串值，你不需要设置这些属性。</span><span class="sxs-lookup"><span data-stu-id="6be2f-331">If your application writes strings values directly to the event log, you do not need to set these properties.</span></span>  
  
 <span data-ttu-id="6be2f-332">要写入本地化的项还是要直接写入字符串，则必须配置源。</span><span class="sxs-lookup"><span data-stu-id="6be2f-332">The source must be configured either for writing localized entries or for writing direct strings.</span></span> <span data-ttu-id="6be2f-333">如果你的应用程序将使用资源标识符和字符串值的条目，则必须注册两个单独的源。</span><span class="sxs-lookup"><span data-stu-id="6be2f-333">If your application writes entries using both resource identifiers and string values, you must register two separate sources.</span></span> <span data-ttu-id="6be2f-334">例如，使用资源文件，配置一个源，然后使用在该源<xref:System.Diagnostics.EventLog.WriteEvent%2A>方法来编写使用到事件日志的资源标识符的条目。</span><span class="sxs-lookup"><span data-stu-id="6be2f-334">For example, configure one source with resource files, and then use that source in the <xref:System.Diagnostics.EventLog.WriteEvent%2A> method to write entries using resource identifiers to the event log.</span></span> <span data-ttu-id="6be2f-335">然后创建不同的源，而无需资源文件，并使用在该源<xref:System.Diagnostics.EventLog.WriteEntry%2A>方法使用该源的事件日志中直接写入字符串。</span><span class="sxs-lookup"><span data-stu-id="6be2f-335">Then create a different source without resource files, and use that source in the <xref:System.Diagnostics.EventLog.WriteEntry%2A> method to write strings directly to the event log using that source.</span></span>  
  
 <span data-ttu-id="6be2f-336">若要更改现有源的配置详细信息，必须删除源，然后使用新的配置创建。</span><span class="sxs-lookup"><span data-stu-id="6be2f-336">To change the configuration details of an existing source, you must delete the source and then create it with the new configuration.</span></span> <span data-ttu-id="6be2f-337">如果其他应用程序或组件使用的现有源，请使用更新的配置，而无需删除现有的源创建新的源。</span><span class="sxs-lookup"><span data-stu-id="6be2f-337">If other applications or components use the existing source, create a new source with the updated configuration rather than deleting the existing source.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="6be2f-338">如果源配置为事件日志，并且重新配置为另一个事件日志，必须重新启动计算机才能使更改生效。</span><span class="sxs-lookup"><span data-stu-id="6be2f-338">If a source is configured for an event log, and you reconfigure it for another event log, you must restart the computer for the changes to take effect.</span></span>  
  
   
  
## Examples  
 <span data-ttu-id="6be2f-339">下面的示例确定是否将名为事件源`SampleApplicationSource`已在本地计算机上注册。</span><span class="sxs-lookup"><span data-stu-id="6be2f-339">The following example determines whether the event source named `SampleApplicationSource` is registered on the local computer.</span></span> <span data-ttu-id="6be2f-340">如果事件源不存在，该示例设置源的消息资源文件，并创建新的事件源。</span><span class="sxs-lookup"><span data-stu-id="6be2f-340">If the event source does not exist, the example sets the message resource file for the source and creates the new event source.</span></span> <span data-ttu-id="6be2f-341">最后，该示例设置使用中的资源标识符值的事件日志的本地化的显示名称`DisplayNameMsgId`和中的资源文件路径`messageFile`。</span><span class="sxs-lookup"><span data-stu-id="6be2f-341">Finally, the example sets the localized display name for the event log, using the resource identifier value in `DisplayNameMsgId` and the resource file path in `messageFile`.</span></span>  
  
 [!code-cpp[EventLog_WriteEvent#6](~/samples/snippets/cpp/VS_Snippets_CLR/eventlog_WriteEvent/CPP/source.cpp#6)]
 [!code-csharp[EventLog_WriteEvent#6](~/samples/snippets/csharp/VS_Snippets_CLR/eventlog_WriteEvent/CS/source.cs#6)]
 [!code-vb[EventLog_WriteEvent#6](~/samples/snippets/visualbasic/VS_Snippets_CLR/eventlog_WriteEvent/VB/source.vb#6)]  
  
 <span data-ttu-id="6be2f-342">该示例使用以下的消息文本文件，内置于 EventLogMsgs.dll 的资源库。</span><span class="sxs-lookup"><span data-stu-id="6be2f-342">The example uses the following message text file, built into the resource library EventLogMsgs.dll.</span></span> <span data-ttu-id="6be2f-343">消息文本文件是从其创建的消息资源文件的源。</span><span class="sxs-lookup"><span data-stu-id="6be2f-343">A message text file is the source from which the message resource file is created.</span></span> <span data-ttu-id="6be2f-344">消息文本文件定义的资源标识符和类别、 事件消息和参数插入字符串的文本。</span><span class="sxs-lookup"><span data-stu-id="6be2f-344">The message text file defines the resource identifiers and text for the category, event message, and parameter insertion strings.</span></span> <span data-ttu-id="6be2f-345">具体而言，为事件日志的本地化名称定义了资源标识符 5001。</span><span class="sxs-lookup"><span data-stu-id="6be2f-345">Specifically, resource identifier 5001 is defined for the localized name of the event log.</span></span>  
  
```  
; // EventLogMsgs.mc  
; // ********************************************************  
  
; // Use the following commands to build this file:  
  
; //   mc -s EventLogMsgs.mc  
; //   rc EventLogMsgs.rc  
; //   link /DLL /SUBSYSTEM:WINDOWS /NOENTRY /MACHINE:x86 EventLogMsgs.Res   
; // ********************************************************  
  
; // - Event categories -  
; // Categories must be numbered consecutively starting at 1.  
; // ********************************************************  
  
MessageId=0x1  
Severity=Success  
SymbolicName=INSTALL_CATEGORY  
Language=English  
Installation  
.  
  
MessageId=0x2  
Severity=Success  
SymbolicName=QUERY_CATEGORY  
Language=English  
Database Query  
.  
  
MessageId=0x3  
Severity=Success  
SymbolicName=REFRESH_CATEGORY  
Language=English  
Data Refresh  
.  
  
; // - Event messages -  
; // *********************************  
  
MessageId = 1000  
Severity = Success  
Facility = Application  
SymbolicName = AUDIT_SUCCESS_MESSAGE_ID_1000  
Language=English  
My application message text, in English, for message id 1000, called from %1.  
.  
  
MessageId = 1001  
Severity = Warning  
Facility = Application  
SymbolicName = AUDIT_FAILED_MESSAGE_ID_1001  
Language=English  
My application message text, in English, for message id 1001, called from %1.  
.  
  
MessageId = 1002  
Severity = Success  
Facility = Application  
SymbolicName = GENERIC_INFO_MESSAGE_ID_1002  
Language=English  
My generic information message in English, for message id 1002.  
.  
  
MessageId = 1003  
Severity = Warning  
Facility = Application  
SymbolicName = GENERIC_WARNING_MESSAGE_ID_1003  
Language=English  
My generic warning message in English, for message id 1003, called from %1.  
.  
  
MessageId = 1004  
Severity = Success  
Facility = Application  
SymbolicName = UPDATE_CYCLE_COMPLETE_MESSAGE_ID_1004  
Language=English  
The update cycle is complete for %%5002.  
.  
  
MessageId = 1005  
Severity = Warning  
Facility = Application  
SymbolicName = SERVER_CONNECTION_DOWN_MESSAGE_ID_1005  
Language=English  
The refresh operation did not complete because the connection to server %1 could not be established.  
.  
  
; // - Event log display name -  
; // ********************************************************  
  
MessageId = 5001  
Severity = Success  
Facility = Application  
SymbolicName = EVENT_LOG_DISPLAY_NAME_MSGID  
Language=English  
Sample Event Log  
.  
  
; // - Event message parameters -  
; //   Language independent insertion strings  
; // ********************************************************  
  
MessageId = 5002  
Severity = Success  
Facility = Application  
SymbolicName = EVENT_LOG_SERVICE_NAME_MSGID  
Language=English  
SVC_UPDATE.EXE  
.  
```  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentException"><span data-ttu-id="6be2f-346">在 <paramref name="sourceData" /> 中指定的计算机名称无效。</span><span class="sxs-lookup"><span data-stu-id="6be2f-346">The computer name specified in <paramref name="sourceData" /> is not valid.</span></span>  
  
 <span data-ttu-id="6be2f-347">\- 或 -</span><span class="sxs-lookup"><span data-stu-id="6be2f-347">\- or -</span></span>  
  
 <span data-ttu-id="6be2f-348">在 <paramref name="sourceData" /> 中指定的源名称为 <see langword="null" />。</span><span class="sxs-lookup"><span data-stu-id="6be2f-348">The source name specified in <paramref name="sourceData" /> is <see langword="null" />.</span></span>  
  
 <span data-ttu-id="6be2f-349">\- 或 -</span><span class="sxs-lookup"><span data-stu-id="6be2f-349">\- or -</span></span>  
  
 <span data-ttu-id="6be2f-350">在 <paramref name="sourceData" /> 中指定的日志名称无效。</span><span class="sxs-lookup"><span data-stu-id="6be2f-350">The log name specified in <paramref name="sourceData" /> is not valid.</span></span> <span data-ttu-id="6be2f-351">事件日志名称必须由可打印字符组成，且不得包含字符“\*”、“?”或“\\”。</span><span class="sxs-lookup"><span data-stu-id="6be2f-351">Event log names must consist of printable characters and cannot include the characters '\*', '?', or '\\'.</span></span>  
  
 <span data-ttu-id="6be2f-352">\- 或 -</span><span class="sxs-lookup"><span data-stu-id="6be2f-352">\- or -</span></span>  
  
 <span data-ttu-id="6be2f-353">在 <paramref name="sourceData" /> 中指定的日志名称对用户日志创建无效。</span><span class="sxs-lookup"><span data-stu-id="6be2f-353">The log name specified in <paramref name="sourceData" /> is not valid for user log creation.</span></span> <span data-ttu-id="6be2f-354">事件日志名称 AppEvent、SysEvent 和 SecEvent 是保留为系统使用的。</span><span class="sxs-lookup"><span data-stu-id="6be2f-354">The Event log names AppEvent, SysEvent, and SecEvent are reserved for system use.</span></span>  
  
 <span data-ttu-id="6be2f-355">\- 或 -</span><span class="sxs-lookup"><span data-stu-id="6be2f-355">\- or -</span></span>  
  
 <span data-ttu-id="6be2f-356">该日志名称与一个现有事件源名称相匹配。</span><span class="sxs-lookup"><span data-stu-id="6be2f-356">The log name matches an existing event source name.</span></span>  
  
 <span data-ttu-id="6be2f-357">\- 或 -</span><span class="sxs-lookup"><span data-stu-id="6be2f-357">\- or -</span></span>  
  
 <span data-ttu-id="6be2f-358">在 <paramref name="sourceData" /> 中指定的源名称导致注册表项路径的长度超过 254 个字符。</span><span class="sxs-lookup"><span data-stu-id="6be2f-358">The source name specified in <paramref name="sourceData" /> results in a registry key path longer than 254 characters.</span></span>  
  
 <span data-ttu-id="6be2f-359">\- 或 -</span><span class="sxs-lookup"><span data-stu-id="6be2f-359">\- or -</span></span>  
  
 <span data-ttu-id="6be2f-360">在 <paramref name="sourceData" /> 中指定的日志名称的前 8 个字符不唯一。</span><span class="sxs-lookup"><span data-stu-id="6be2f-360">The first 8 characters of the log name specified in <paramref name="sourceData" /> are not unique.</span></span>  
  
 <span data-ttu-id="6be2f-361">\- 或 -</span><span class="sxs-lookup"><span data-stu-id="6be2f-361">\- or -</span></span>  
  
 <span data-ttu-id="6be2f-362">在 <paramref name="sourceData" /> 中指定的源名称已经注册过。</span><span class="sxs-lookup"><span data-stu-id="6be2f-362">The source name specified in <paramref name="sourceData" /> is already registered.</span></span>  
  
 <span data-ttu-id="6be2f-363">\- 或 -</span><span class="sxs-lookup"><span data-stu-id="6be2f-363">\- or -</span></span>  
  
 <span data-ttu-id="6be2f-364">在 <paramref name="sourceData" /> 中指定的源名称与一个现有事件日志名称相匹配。</span><span class="sxs-lookup"><span data-stu-id="6be2f-364">The source name specified in <paramref name="sourceData" /> matches an existing event log name.</span></span></exception>
        <exception cref="T:System.InvalidOperationException"><span data-ttu-id="6be2f-365">事件日志的注册表项未能打开。</span><span class="sxs-lookup"><span data-stu-id="6be2f-365">The registry key for the event log could not be opened.</span></span></exception>
        <exception cref="T:System.ArgumentNullException">
          <span data-ttu-id="6be2f-366"><paramref name="sourceData" /> 为 <see langword="null" />。</span><span class="sxs-lookup"><span data-stu-id="6be2f-366"><paramref name="sourceData" /> is <see langword="null" />.</span></span></exception>
        <permission cref="T:System.Diagnostics.EventLogPermission"><span data-ttu-id="6be2f-367">用于管理的计算机上的事件日志信息。</span><span class="sxs-lookup"><span data-stu-id="6be2f-367">for administering event log information on the computer.</span></span> <span data-ttu-id="6be2f-368">关联的枚举： <see cref="F:System.Diagnostics.EventLogPermissionAccess.Administer" /></span><span class="sxs-lookup"><span data-stu-id="6be2f-368">Associated enumeration: <see cref="F:System.Diagnostics.EventLogPermissionAccess.Administer" /></span></span></permission>
        <altmember cref="T:System.Diagnostics.EventSourceCreationData" />
        <altmember cref="M:System.Diagnostics.EventLog.SourceExists(System.String)" />
        <altmember cref="M:System.Diagnostics.EventLog.DeleteEventSource(System.String)" />
        <altmember cref="P:System.Diagnostics.EventLog.Source" />
        <altmember cref="T:System.Diagnostics.EventLogInstaller" />
      </Docs>
    </Member>
    <Member MemberName="CreateEventSource">
      <MemberSignature Language="C#" Value="public static void CreateEventSource (string source, string logName);" />
      <MemberSignature Language="ILAsm" Value=".method public static hidebysig void CreateEventSource(string source, string logName) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Diagnostics.EventLog.CreateEventSource(System.String,System.String)" />
      <MemberSignature Language="VB.NET" Value="Public Shared Sub CreateEventSource (source As String, logName As String)" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; static void CreateEventSource(System::String ^ source, System::String ^ logName);" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Void</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="source" Type="System.String" />
        <Parameter Name="logName" Type="System.String" />
      </Parameters>
      <Docs>
        <param name="source"><span data-ttu-id="6be2f-369">应用程序在本地计算机上注册时所采用的源名称。</span><span class="sxs-lookup"><span data-stu-id="6be2f-369">The source name by which the application is registered on the local computer.</span></span></param>
        <param name="logName"><span data-ttu-id="6be2f-370">源的项写入的日志名。</span><span class="sxs-lookup"><span data-stu-id="6be2f-370">The name of the log the source's entries are written to.</span></span> <span data-ttu-id="6be2f-371">可能的值包括“应用程序”、“系统”或自定义事件日志。</span><span class="sxs-lookup"><span data-stu-id="6be2f-371">Possible values include Application, System, or a custom event log.</span></span></param>
        <summary><span data-ttu-id="6be2f-372">建立指定的源名称作为向本地计算机上的日志中写入日志项的有效事件源。</span><span class="sxs-lookup"><span data-stu-id="6be2f-372">Establishes the specified source name as a valid event source for writing entries to a log on the local computer.</span></span> <span data-ttu-id="6be2f-373">此方法还可在本地计算机上创建一个新的自定义日志。</span><span class="sxs-lookup"><span data-stu-id="6be2f-373">This method can also create a new custom log on the local computer.</span></span></summary>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="6be2f-374">使用此重载来创建自定义日志，或要创建并注册<xref:System.Diagnostics.EventLog.Source%2A>向本地计算机上现有的日志。</span><span class="sxs-lookup"><span data-stu-id="6be2f-374">Use this overload to create a custom log or to create and register a <xref:System.Diagnostics.EventLog.Source%2A> to an existing log on the local computer.</span></span>  
  
 <span data-ttu-id="6be2f-375">如果`logName`是`null`或空字符串 ("") 时调用<xref:System.Diagnostics.EventLog.CreateEventSource%2A>，日志将默认为应用程序日志。</span><span class="sxs-lookup"><span data-stu-id="6be2f-375">If `logName` is `null` or an empty string ("") when you call <xref:System.Diagnostics.EventLog.CreateEventSource%2A>, the log defaults to the Application log.</span></span> <span data-ttu-id="6be2f-376">如果本地计算机上不存在该日志，系统创建自定义日志，并将注册应用程序作为<xref:System.Diagnostics.EventLog.Source%2A>为该日志。</span><span class="sxs-lookup"><span data-stu-id="6be2f-376">If the log does not exist on the local computer, the system creates a custom log and registers your application as a <xref:System.Diagnostics.EventLog.Source%2A> for that log.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="6be2f-377">若要创建的事件源在 Windows Vista 或更高版本或 Windows Server 2003，必须具有管理权限。</span><span class="sxs-lookup"><span data-stu-id="6be2f-377">To create an event source in Windows Vista and later or Windows Server 2003, you must have administrative privileges.</span></span>  
>   
>  <span data-ttu-id="6be2f-378">此要求的原因是所有的事件日志，包括安全性，必须进行搜索以确定事件源是否唯一。</span><span class="sxs-lookup"><span data-stu-id="6be2f-378">The reason for this requirement is that all event logs, including security, must be searched to determine whether the event source is unique.</span></span> <span data-ttu-id="6be2f-379">从 Windows Vista 开始，用户没有权限访问安全事件日志中。因此，<xref:System.Security.SecurityException>引发。</span><span class="sxs-lookup"><span data-stu-id="6be2f-379">Starting with Windows Vista, users do not have permission to access the security log; therefore, a <xref:System.Security.SecurityException> is thrown.</span></span>  
>   
>  <span data-ttu-id="6be2f-380">在 Windows Vista 或更高版本中，用户帐户控制 (UAC) 决定用户的特权。</span><span class="sxs-lookup"><span data-stu-id="6be2f-380">In Windows Vista and later, User Account Control (UAC) determines the privileges of a user.</span></span> <span data-ttu-id="6be2f-381">如果您是内置的 Administrators 组的成员，将为您分配两个运行时访问令牌：一个标准用户访问令牌和一个管理员访问令牌。</span><span class="sxs-lookup"><span data-stu-id="6be2f-381">If you are a member of the Built-in Administrators group, you are assigned two run-time access tokens: a standard user access token and an administrator access token.</span></span> <span data-ttu-id="6be2f-382">默认情况下，您拥有标准用户角色。</span><span class="sxs-lookup"><span data-stu-id="6be2f-382">By default, you are in the standard user role.</span></span> <span data-ttu-id="6be2f-383">若要执行的代码访问安全日志，首先必须将你的特权从标准用户提升至管理员。</span><span class="sxs-lookup"><span data-stu-id="6be2f-383">To execute the code that accesses the security log, you must first elevate your privileges from standard user to administrator.</span></span> <span data-ttu-id="6be2f-384">你可以通过以下方式执行此操作：右键单击应用程序图标并指示需以管理员身份运行。</span><span class="sxs-lookup"><span data-stu-id="6be2f-384">You can do this when you start an application by right-clicking the application icon and indicating that you want to run as an administrator.</span></span>  
  
 <span data-ttu-id="6be2f-385">只需创建事件源，如果要写入事件日志。</span><span class="sxs-lookup"><span data-stu-id="6be2f-385">You only need to create an event source if you are writing to the event log.</span></span> <span data-ttu-id="6be2f-386">然后再写入事件日志条目，你必须将注册事件源的事件日志有效的事件源。</span><span class="sxs-lookup"><span data-stu-id="6be2f-386">Before writing an entry to an event log, you must register the event source with the event log as a valid source of events.</span></span> <span data-ttu-id="6be2f-387">当你编写日志条目时，系统将使用<xref:System.Diagnostics.EventLog.Source%2A>以查找相应的日志要在其中放置你的条目。</span><span class="sxs-lookup"><span data-stu-id="6be2f-387">When you write a log entry, the system uses the <xref:System.Diagnostics.EventLog.Source%2A> to find the appropriate log in which to place your entry.</span></span> <span data-ttu-id="6be2f-388">如果您正在读取事件日志，你可以指定<xref:System.Diagnostics.EventLog.Source%2A>，或<xref:System.Diagnostics.EventLog.Log%2A>和<xref:System.Diagnostics.EventLog.MachineName%2A>。</span><span class="sxs-lookup"><span data-stu-id="6be2f-388">If you are reading the event log, you can either specify the <xref:System.Diagnostics.EventLog.Source%2A>, or a <xref:System.Diagnostics.EventLog.Log%2A> and <xref:System.Diagnostics.EventLog.MachineName%2A>.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="6be2f-389">你不需要指定<xref:System.Diagnostics.EventLog.MachineName%2A>如果要连接到本地计算机上的日志。</span><span class="sxs-lookup"><span data-stu-id="6be2f-389">You are not required to specify the <xref:System.Diagnostics.EventLog.MachineName%2A> if you are connecting to a log on the local computer.</span></span> <span data-ttu-id="6be2f-390">如果不指定<xref:System.Diagnostics.EventLog.MachineName%2A>时从日志读取本地计算机 ("。") 假定。</span><span class="sxs-lookup"><span data-stu-id="6be2f-390">If you do not specify the <xref:System.Diagnostics.EventLog.MachineName%2A> when reading from a log, the local computer (".") is assumed.</span></span>  
  
 <span data-ttu-id="6be2f-391">使用<xref:System.Diagnostics.EventLog.WriteEvent%2A>和<xref:System.Diagnostics.EventLog.WriteEntry%2A>事件写入事件日志。</span><span class="sxs-lookup"><span data-stu-id="6be2f-391">Use <xref:System.Diagnostics.EventLog.WriteEvent%2A> and <xref:System.Diagnostics.EventLog.WriteEntry%2A> to write events to an event log.</span></span> <span data-ttu-id="6be2f-392">必须指定事件源写入事件;你必须创建并在编写与源的第一个条目之前，配置事件源。</span><span class="sxs-lookup"><span data-stu-id="6be2f-392">You must specify an event source to write events; you must create and configure the event source before writing the first entry with the source.</span></span>  
  
 <span data-ttu-id="6be2f-393">在你的应用程序的安装过程中创建新的事件源。</span><span class="sxs-lookup"><span data-stu-id="6be2f-393">Create the new event source during the installation of your application.</span></span> <span data-ttu-id="6be2f-394">这样，可以为操作系统来刷新其已注册的事件源的列表和其配置的时间。</span><span class="sxs-lookup"><span data-stu-id="6be2f-394">This allows time for the operating system to refresh its list of registered event sources and their configuration.</span></span> <span data-ttu-id="6be2f-395">如果操作系统未刷新其事件源的列表，并尝试写入新的源的事件写入操作将失败。</span><span class="sxs-lookup"><span data-stu-id="6be2f-395">If the operating system has not refreshed its list of event sources, and you attempt to write an event with the new source, the write operation will fail.</span></span> <span data-ttu-id="6be2f-396">你可以配置新的源使用<xref:System.Diagnostics.EventLogInstaller>，或使用<xref:System.Diagnostics.EventLog.CreateEventSource%2A>方法。</span><span class="sxs-lookup"><span data-stu-id="6be2f-396">You can configure a new source using an <xref:System.Diagnostics.EventLogInstaller>, or using the <xref:System.Diagnostics.EventLog.CreateEventSource%2A> method.</span></span> <span data-ttu-id="6be2f-397">若要创建新的事件源的计算机上，必须具有管理权限。</span><span class="sxs-lookup"><span data-stu-id="6be2f-397">You must have administrative rights on the computer to create a new event source.</span></span>  
  
 <span data-ttu-id="6be2f-398">你可以创建现有的事件日志或新的事件日志的事件源。</span><span class="sxs-lookup"><span data-stu-id="6be2f-398">You can create an event source for an existing event log or a new event log.</span></span> <span data-ttu-id="6be2f-399">在创建新的源的新的事件日志时，系统将为该日志，此源注册，但之前向其中写入的第一个条目，将不会创建日志。</span><span class="sxs-lookup"><span data-stu-id="6be2f-399">When you create a new source for a new event log, the system registers the source for that log, but the log is not created until the first entry is written to it.</span></span>  
  
 <span data-ttu-id="6be2f-400">操作系统将事件日志存储为文件。</span><span class="sxs-lookup"><span data-stu-id="6be2f-400">The operating system stores event logs as files.</span></span> <span data-ttu-id="6be2f-401">当你使用<xref:System.Diagnostics.EventLogInstaller>或<xref:System.Diagnostics.EventLog.CreateEventSource%2A>若要创建新的事件日志，关联的文件存储在指定的计算机上的 %SystemRoot%\System32\Config 目录。</span><span class="sxs-lookup"><span data-stu-id="6be2f-401">When you use <xref:System.Diagnostics.EventLogInstaller> or <xref:System.Diagnostics.EventLog.CreateEventSource%2A> to create a new event log, the associated file is stored in the %SystemRoot%\System32\Config directory on the specified computer.</span></span> <span data-ttu-id="6be2f-402">通过追加的前 8 个字符设置的文件名称<xref:System.Diagnostics.EventLog.Log%2A>".evt"文件扩展名的属性。</span><span class="sxs-lookup"><span data-stu-id="6be2f-402">The file name is set by appending the first 8 characters of the <xref:System.Diagnostics.EventLog.Log%2A> property with the ".evt" file name extension.</span></span>  
  
 <span data-ttu-id="6be2f-403">必须是唯一的本地计算机; 上的源新的源名称不能与现有源名称或现有的事件日志名称匹配。</span><span class="sxs-lookup"><span data-stu-id="6be2f-403">The source must be unique on the local computer; a new source name cannot match an existing source name or an existing event log name.</span></span> <span data-ttu-id="6be2f-404">每个源可以一次; 写入只有一个事件日志但是，你的应用程序可以使用多个源写入多个事件日志。</span><span class="sxs-lookup"><span data-stu-id="6be2f-404">Each source can write to only one event log at a time; however, your application can use multiple sources to write to multiple event logs.</span></span> <span data-ttu-id="6be2f-405">例如，你的应用程序可能需要为不同的事件日志或不同的资源文件配置的多个源。</span><span class="sxs-lookup"><span data-stu-id="6be2f-405">For example, your application might require multiple sources configured for different event logs or different resource files.</span></span>  
  
 <span data-ttu-id="6be2f-406">要写入本地化的项还是要直接写入字符串，则必须配置源。</span><span class="sxs-lookup"><span data-stu-id="6be2f-406">The source must be configured either for writing localized entries or for writing direct strings.</span></span> <span data-ttu-id="6be2f-407">如果你的应用程序将使用资源标识符和字符串值的条目，则必须注册两个单独的源。</span><span class="sxs-lookup"><span data-stu-id="6be2f-407">If your application writes entries using both resource identifiers and string values, you must register two separate sources.</span></span> <span data-ttu-id="6be2f-408">例如，使用资源文件，配置一个源，然后使用在该源<xref:System.Diagnostics.EventLog.WriteEvent%2A>方法来编写使用到事件日志的资源标识符的条目。</span><span class="sxs-lookup"><span data-stu-id="6be2f-408">For example, configure one source with resource files, and then use that source in the <xref:System.Diagnostics.EventLog.WriteEvent%2A> method to write entries using resource identifiers to the event log.</span></span> <span data-ttu-id="6be2f-409">然后创建不同的源，而无需资源文件，并使用在该源<xref:System.Diagnostics.EventLog.WriteEntry%2A>方法使用该源的事件日志中直接写入字符串。</span><span class="sxs-lookup"><span data-stu-id="6be2f-409">Then create a different source without resource files, and use that source in the <xref:System.Diagnostics.EventLog.WriteEntry%2A> method to write strings directly to the event log using that source.</span></span>  
  
 <span data-ttu-id="6be2f-410">若要更改现有源的配置详细信息，必须删除源，然后使用新的配置创建。</span><span class="sxs-lookup"><span data-stu-id="6be2f-410">To change the configuration details of an existing source, you must delete the source and then create it with the new configuration.</span></span> <span data-ttu-id="6be2f-411">如果其他应用程序或组件使用的现有源，请使用更新的配置，而无需删除现有的源创建新的源。</span><span class="sxs-lookup"><span data-stu-id="6be2f-411">If other applications or components use the existing source, create a new source with the updated configuration rather than deleting the existing source.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="6be2f-412">如果源已映射到某个日志并重新映射到新的日志，必须重新启动计算机才能使更改生效。</span><span class="sxs-lookup"><span data-stu-id="6be2f-412">If a source has already been mapped to a log and you remap it to a new log, you must restart the computer for the changes to take effect.</span></span>  
  
   
  
## Examples  
 <span data-ttu-id="6be2f-413">下面的示例创建源`MySource`如果它尚不存在，并将项写入事件日志`MyNewLog`。</span><span class="sxs-lookup"><span data-stu-id="6be2f-413">The following example creates the source `MySource` if it does not already exist, and writes an entry to the event log `MyNewLog`.</span></span>  
  
 [!code-cpp[Classic EventLog.CreateEventSource Example#1](~/samples/snippets/cpp/VS_Snippets_CLR_Classic/classic EventLog.CreateEventSource Example/CPP/source.cpp#1)]
 [!code-csharp[Classic EventLog.CreateEventSource Example#1](~/samples/snippets/csharp/VS_Snippets_CLR_Classic/classic EventLog.CreateEventSource Example/CS/source.cs#1)]
 [!code-vb[Classic EventLog.CreateEventSource Example#1](~/samples/snippets/visualbasic/VS_Snippets_CLR_Classic/classic EventLog.CreateEventSource Example/VB/source.vb#1)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentException">
          <span data-ttu-id="6be2f-414"><paramref name="source" /> 为空字符串 ("") 或 <see langword="null" />。</span><span class="sxs-lookup"><span data-stu-id="6be2f-414"><paramref name="source" /> is an empty string ("") or <see langword="null" />.</span></span>  
  
 <span data-ttu-id="6be2f-415">\- 或 -</span><span class="sxs-lookup"><span data-stu-id="6be2f-415">\- or -</span></span>  
  
 <span data-ttu-id="6be2f-416"><paramref name="logName" /> 不是有效的事件日志名称。</span><span class="sxs-lookup"><span data-stu-id="6be2f-416"><paramref name="logName" /> is not a valid event log name.</span></span> <span data-ttu-id="6be2f-417">事件日志名称必须由可打印字符组成，且不得包含字符“\*”、“?”或“\\”。</span><span class="sxs-lookup"><span data-stu-id="6be2f-417">Event log names must consist of printable characters, and cannot include the characters '\*', '?', or '\\'.</span></span>  
  
 <span data-ttu-id="6be2f-418">\- 或 -</span><span class="sxs-lookup"><span data-stu-id="6be2f-418">\- or -</span></span>  
  
 <span data-ttu-id="6be2f-419"><paramref name="logName" />对用户日志创建无效。</span><span class="sxs-lookup"><span data-stu-id="6be2f-419"><paramref name="logName" /> is not valid for user log creation.</span></span> <span data-ttu-id="6be2f-420">事件日志名称 AppEvent、SysEvent 和 SecEvent 是保留为系统使用的。</span><span class="sxs-lookup"><span data-stu-id="6be2f-420">The event log names AppEvent, SysEvent, and SecEvent are reserved for system use.</span></span>  
  
 <span data-ttu-id="6be2f-421">\- 或 -</span><span class="sxs-lookup"><span data-stu-id="6be2f-421">\- or -</span></span>  
  
 <span data-ttu-id="6be2f-422">该日志名称与一个现有事件源名称相匹配。</span><span class="sxs-lookup"><span data-stu-id="6be2f-422">The log name matches an existing event source name.</span></span>  
  
 <span data-ttu-id="6be2f-423">\- 或 -</span><span class="sxs-lookup"><span data-stu-id="6be2f-423">\- or -</span></span>  
  
 <span data-ttu-id="6be2f-424">此源名称导致注册表项路径的长度超过 254 个字符。</span><span class="sxs-lookup"><span data-stu-id="6be2f-424">The source name results in a registry key path longer than 254 characters.</span></span>  
  
 <span data-ttu-id="6be2f-425">\- 或 -</span><span class="sxs-lookup"><span data-stu-id="6be2f-425">\- or -</span></span>  
  
 <span data-ttu-id="6be2f-426"><paramref name="logName" /> 的前 8 个字符与现有事件日志名称的前 8 个字符相匹配。</span><span class="sxs-lookup"><span data-stu-id="6be2f-426">The first 8 characters of <paramref name="logName" /> match the first 8 characters of an existing event log name.</span></span>  
  
 <span data-ttu-id="6be2f-427">\- 或 -</span><span class="sxs-lookup"><span data-stu-id="6be2f-427">\- or -</span></span>  
  
 <span data-ttu-id="6be2f-428">无法注册该源，因为它已存在于本地计算机上。</span><span class="sxs-lookup"><span data-stu-id="6be2f-428">The source cannot be registered because it already exists on the local computer.</span></span>  
  
 <span data-ttu-id="6be2f-429">\- 或 -</span><span class="sxs-lookup"><span data-stu-id="6be2f-429">\- or -</span></span>  
  
 <span data-ttu-id="6be2f-430">该源名称与一个现有事件日志名称相匹配。</span><span class="sxs-lookup"><span data-stu-id="6be2f-430">The source name matches an existing event log name.</span></span></exception>
        <exception cref="T:System.InvalidOperationException"><span data-ttu-id="6be2f-431">事件日志的注册表项未能在本地计算机上打开。</span><span class="sxs-lookup"><span data-stu-id="6be2f-431">The registry key for the event log could not be opened on the local computer.</span></span></exception>
        <permission cref="T:System.Diagnostics.EventLogPermission"><span data-ttu-id="6be2f-432">用于管理的计算机上的事件日志信息。</span><span class="sxs-lookup"><span data-stu-id="6be2f-432">for administering event log information on the computer.</span></span> <span data-ttu-id="6be2f-433">关联的枚举： <see cref="F:System.Diagnostics.EventLogPermissionAccess.Administer" /></span><span class="sxs-lookup"><span data-stu-id="6be2f-433">Associated enumeration: <see cref="F:System.Diagnostics.EventLogPermissionAccess.Administer" /></span></span></permission>
        <altmember cref="M:System.Diagnostics.EventLog.DeleteEventSource(System.String)" />
        <altmember cref="M:System.Diagnostics.EventLog.SourceExists(System.String)" />
        <altmember cref="P:System.Diagnostics.EventLog.Source" />
        <altmember cref="P:System.Diagnostics.EventLog.Log" />
        <altmember cref="M:System.Diagnostics.EventLog.Delete(System.String)" />
      </Docs>
    </Member>
    <Member MemberName="CreateEventSource">
      <MemberSignature Language="C#" Value="public static void CreateEventSource (string source, string logName, string machineName);" />
      <MemberSignature Language="ILAsm" Value=".method public static hidebysig void CreateEventSource(string source, string logName, string machineName) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Diagnostics.EventLog.CreateEventSource(System.String,System.String,System.String)" />
      <MemberSignature Language="VB.NET" Value="Public Shared Sub CreateEventSource (source As String, logName As String, machineName As String)" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; static void CreateEventSource(System::String ^ source, System::String ^ logName, System::String ^ machineName);" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Attributes>
        <Attribute>
          <AttributeName>System.Obsolete("use CreateEventSource(EventSourceCreationData) instead")</AttributeName>
        </Attribute>
      </Attributes>
      <ReturnValue>
        <ReturnType>System.Void</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="source" Type="System.String" />
        <Parameter Name="logName" Type="System.String" />
        <Parameter Name="machineName" Type="System.String" />
      </Parameters>
      <Docs>
        <param name="source"><span data-ttu-id="6be2f-434">应用程序在指定计算机上注册时所采用的源。</span><span class="sxs-lookup"><span data-stu-id="6be2f-434">The source by which the application is registered on the specified computer.</span></span></param>
        <param name="logName"><span data-ttu-id="6be2f-435">源的项写入的日志名。</span><span class="sxs-lookup"><span data-stu-id="6be2f-435">The name of the log the source's entries are written to.</span></span> <span data-ttu-id="6be2f-436">可能的值包括“应用程序”、“系统”或自定义事件日志。</span><span class="sxs-lookup"><span data-stu-id="6be2f-436">Possible values include Application, System, or a custom event log.</span></span> <span data-ttu-id="6be2f-437">如果不指定值，则 <c>logName</c> 默认为应用程序。</span><span class="sxs-lookup"><span data-stu-id="6be2f-437">If you do not specify a value, <c>logName</c> defaults to Application.</span></span></param>
        <param name="machineName"><span data-ttu-id="6be2f-438">用来注册此事件源的计算机名称，对于本地计算机则为“.”。</span><span class="sxs-lookup"><span data-stu-id="6be2f-438">The name of the computer to register this event source with, or "." for the local computer.</span></span></param>
        <summary><span data-ttu-id="6be2f-439">建立指定的源名称作为向指定计算机上的日志中写入项的有效事件源。</span><span class="sxs-lookup"><span data-stu-id="6be2f-439">Establishes the specified source name as a valid event source for writing entries to a log on the specified computer.</span></span> <span data-ttu-id="6be2f-440">此方法还可用于在指定计算机上创建一个新的自定义日志。</span><span class="sxs-lookup"><span data-stu-id="6be2f-440">This method can also be used to create a new custom log on the specified computer.</span></span></summary>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="6be2f-441">使用此重载来创建自定义日志，或要创建并注册<xref:System.Diagnostics.EventLog.Source%2A>向指定的计算机上现有的日志。</span><span class="sxs-lookup"><span data-stu-id="6be2f-441">Use this overload to create a custom log or to create and register a <xref:System.Diagnostics.EventLog.Source%2A> to an existing log on the specified computer.</span></span>  
  
 <span data-ttu-id="6be2f-442">如果`logName`是`null`或空字符串 ("") 时调用<xref:System.Diagnostics.EventLog.CreateEventSource%2A>，日志将默认为应用程序日志。</span><span class="sxs-lookup"><span data-stu-id="6be2f-442">If `logName` is `null` or an empty string ("") when you call <xref:System.Diagnostics.EventLog.CreateEventSource%2A>, the log defaults to the Application log.</span></span> <span data-ttu-id="6be2f-443">如果指定的计算机上不存在该日志，系统创建自定义日志，并将注册应用程序作为<xref:System.Diagnostics.EventLog.Source%2A>为该日志。</span><span class="sxs-lookup"><span data-stu-id="6be2f-443">If the log does not exist on the specified computer, the system creates a custom log and registers your application as a <xref:System.Diagnostics.EventLog.Source%2A> for that log.</span></span>  
  
 <span data-ttu-id="6be2f-444">只需创建事件源，如果要写入事件日志。</span><span class="sxs-lookup"><span data-stu-id="6be2f-444">You only need to create an event source if you are writing to the event log.</span></span> <span data-ttu-id="6be2f-445">然后再写入事件日志条目，你必须将注册事件源的事件日志有效的事件源。</span><span class="sxs-lookup"><span data-stu-id="6be2f-445">Before writing an entry to an event log, you must register the event source with the event log as a valid source of events.</span></span> <span data-ttu-id="6be2f-446">当你编写日志条目时，系统将使用<xref:System.Diagnostics.EventLog.Source%2A>以查找相应的日志要在其中放置你的条目。</span><span class="sxs-lookup"><span data-stu-id="6be2f-446">When you write a log entry, the system uses the <xref:System.Diagnostics.EventLog.Source%2A> to find the appropriate log in which to place your entry.</span></span> <span data-ttu-id="6be2f-447">如果您正在读取事件日志，你可以指定<xref:System.Diagnostics.EventLog.Source%2A>，或<xref:System.Diagnostics.EventLog.Log%2A>和<xref:System.Diagnostics.EventLog.MachineName%2A>。</span><span class="sxs-lookup"><span data-stu-id="6be2f-447">If you are reading the event log, you can either specify the <xref:System.Diagnostics.EventLog.Source%2A>, or a <xref:System.Diagnostics.EventLog.Log%2A> and <xref:System.Diagnostics.EventLog.MachineName%2A>.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="6be2f-448">若要创建的事件源在 Windows Vista 或更高版本或 Windows Server 2003，必须具有管理权限。</span><span class="sxs-lookup"><span data-stu-id="6be2f-448">To create an event source in Windows Vista and later or Windows Server 2003, you must have administrative privileges.</span></span>  
>   
>  <span data-ttu-id="6be2f-449">此要求的原因是所有的事件日志，包括安全性，必须进行搜索以确定事件源是否唯一。</span><span class="sxs-lookup"><span data-stu-id="6be2f-449">The reason for this requirement is that all event logs, including security, must be searched to determine whether the event source is unique.</span></span> <span data-ttu-id="6be2f-450">在 Windows Vista 或更高版本，用户没有权限访问安全事件日志中。因此，<xref:System.Security.SecurityException>引发。</span><span class="sxs-lookup"><span data-stu-id="6be2f-450">In Windows Vista and later, users do not have permission to access the security log; therefore, a <xref:System.Security.SecurityException> is thrown.</span></span>  
>   
>  <span data-ttu-id="6be2f-451">在 Windows Vista 或更高版本中，用户帐户控制 (UAC) 决定用户的特权。</span><span class="sxs-lookup"><span data-stu-id="6be2f-451">In Windows Vista and later, User Account Control (UAC) determines the privileges of a user.</span></span> <span data-ttu-id="6be2f-452">如果您是内置的 Administrators 组的成员，将为您分配两个运行时访问令牌：一个标准用户访问令牌和一个管理员访问令牌。</span><span class="sxs-lookup"><span data-stu-id="6be2f-452">If you are a member of the Built-in Administrators group, you are assigned two run-time access tokens: a standard user access token and an administrator access token.</span></span> <span data-ttu-id="6be2f-453">默认情况下，您拥有标准用户角色。</span><span class="sxs-lookup"><span data-stu-id="6be2f-453">By default, you are in the standard user role.</span></span> <span data-ttu-id="6be2f-454">若要执行的代码访问安全日志，首先必须将你的特权从标准用户提升至管理员。</span><span class="sxs-lookup"><span data-stu-id="6be2f-454">To execute the code that accesses the security log, you must first elevate your privileges from standard user to administrator.</span></span> <span data-ttu-id="6be2f-455">你可以通过以下方式执行此操作：右键单击应用程序图标并指示需以管理员身份运行。</span><span class="sxs-lookup"><span data-stu-id="6be2f-455">You can do this when you start an application by right-clicking the application icon and indicating that you want to run as an administrator.</span></span>  
  
 <span data-ttu-id="6be2f-456">使用<xref:System.Diagnostics.EventLog.WriteEvent%2A>和<xref:System.Diagnostics.EventLog.WriteEntry%2A>事件写入事件日志。</span><span class="sxs-lookup"><span data-stu-id="6be2f-456">Use <xref:System.Diagnostics.EventLog.WriteEvent%2A> and <xref:System.Diagnostics.EventLog.WriteEntry%2A> to write events to an event log.</span></span> <span data-ttu-id="6be2f-457">必须指定事件源写入事件;你必须创建并在编写与源的第一个条目之前，配置事件源。</span><span class="sxs-lookup"><span data-stu-id="6be2f-457">You must specify an event source to write events; you must create and configure the event source before writing the first entry with the source.</span></span>  
  
 <span data-ttu-id="6be2f-458">在你的应用程序的安装过程中创建新的事件源。</span><span class="sxs-lookup"><span data-stu-id="6be2f-458">Create the new event source during the installation of your application.</span></span> <span data-ttu-id="6be2f-459">这样，可以为操作系统来刷新其已注册的事件源的列表和其配置的时间。</span><span class="sxs-lookup"><span data-stu-id="6be2f-459">This allows time for the operating system to refresh its list of registered event sources and their configuration.</span></span> <span data-ttu-id="6be2f-460">如果操作系统未刷新其事件源的列表，并尝试写入新的源的事件写入操作将失败。</span><span class="sxs-lookup"><span data-stu-id="6be2f-460">If the operating system has not refreshed its list of event sources, and you attempt to write an event with the new source, the write operation will fail.</span></span> <span data-ttu-id="6be2f-461">你可以配置新的源使用<xref:System.Diagnostics.EventLogInstaller>，或使用<xref:System.Diagnostics.EventLog.CreateEventSource%2A>方法。</span><span class="sxs-lookup"><span data-stu-id="6be2f-461">You can configure a new source using an <xref:System.Diagnostics.EventLogInstaller>, or using the <xref:System.Diagnostics.EventLog.CreateEventSource%2A> method.</span></span> <span data-ttu-id="6be2f-462">若要创建新的事件源的计算机上，必须具有管理权限。</span><span class="sxs-lookup"><span data-stu-id="6be2f-462">You must have administrative rights on the computer to create a new event source.</span></span>  
  
 <span data-ttu-id="6be2f-463">你可以创建现有的事件日志或新的事件日志的事件源。</span><span class="sxs-lookup"><span data-stu-id="6be2f-463">You can create an event source for an existing event log or a new event log.</span></span> <span data-ttu-id="6be2f-464">在创建新的源的新的事件日志时，系统将为该日志，此源注册，但之前向其中写入的第一个条目，将不会创建日志。</span><span class="sxs-lookup"><span data-stu-id="6be2f-464">When you create a new source for a new event log, the system registers the source for that log, but the log is not created until the first entry is written to it.</span></span>  
  
 <span data-ttu-id="6be2f-465">操作系统将事件日志存储为文件。</span><span class="sxs-lookup"><span data-stu-id="6be2f-465">The operating system stores event logs as files.</span></span> <span data-ttu-id="6be2f-466">当你使用<xref:System.Diagnostics.EventLogInstaller>或<xref:System.Diagnostics.EventLog.CreateEventSource%2A>若要创建新的事件日志，关联的文件存储在指定的计算机上的 %SystemRoot%\System32\Config 目录。</span><span class="sxs-lookup"><span data-stu-id="6be2f-466">When you use <xref:System.Diagnostics.EventLogInstaller> or <xref:System.Diagnostics.EventLog.CreateEventSource%2A> to create a new event log, the associated file is stored in the %SystemRoot%\System32\Config directory on the specified computer.</span></span> <span data-ttu-id="6be2f-467">通过追加的前 8 个字符设置的文件名称<xref:System.Diagnostics.EventLog.Log%2A>".evt"文件扩展名的属性。</span><span class="sxs-lookup"><span data-stu-id="6be2f-467">The file name is set by appending the first 8 characters of the <xref:System.Diagnostics.EventLog.Log%2A> property with the ".evt" file name extension.</span></span>  
  
 <span data-ttu-id="6be2f-468">必须是唯一的本地计算机; 上的源新的源名称不能与现有源名称或现有的事件日志名称匹配。</span><span class="sxs-lookup"><span data-stu-id="6be2f-468">The source must be unique on the local computer; a new source name cannot match an existing source name or an existing event log name.</span></span> <span data-ttu-id="6be2f-469">每个源可以一次; 写入只有一个事件日志但是，你的应用程序可以使用多个源写入多个事件日志。</span><span class="sxs-lookup"><span data-stu-id="6be2f-469">Each source can write to only one event log at a time; however, your application can use multiple sources to write to multiple event logs.</span></span> <span data-ttu-id="6be2f-470">例如，你的应用程序可能需要为不同的事件日志或不同的资源文件配置的多个源。</span><span class="sxs-lookup"><span data-stu-id="6be2f-470">For example, your application might require multiple sources configured for different event logs or different resource files.</span></span>  
  
 <span data-ttu-id="6be2f-471">要写入本地化的项还是要直接写入字符串，则必须配置源。</span><span class="sxs-lookup"><span data-stu-id="6be2f-471">The source must be configured either for writing localized entries or for writing direct strings.</span></span> <span data-ttu-id="6be2f-472">如果你的应用程序将使用资源标识符和字符串值的条目，则必须注册两个单独的源。</span><span class="sxs-lookup"><span data-stu-id="6be2f-472">If your application writes entries using both resource identifiers and string values, you must register two separate sources.</span></span> <span data-ttu-id="6be2f-473">例如，使用资源文件，配置一个源，然后使用在该源<xref:System.Diagnostics.EventLog.WriteEvent%2A>方法来编写使用到事件日志的资源标识符的条目。</span><span class="sxs-lookup"><span data-stu-id="6be2f-473">For example, configure one source with resource files, and then use that source in the <xref:System.Diagnostics.EventLog.WriteEvent%2A> method to write entries using resource identifiers to the event log.</span></span> <span data-ttu-id="6be2f-474">然后创建不同的源，而无需资源文件，并使用在该源<xref:System.Diagnostics.EventLog.WriteEntry%2A>方法使用该源的事件日志中直接写入字符串。</span><span class="sxs-lookup"><span data-stu-id="6be2f-474">Then create a different source without resource files, and use that source in the <xref:System.Diagnostics.EventLog.WriteEntry%2A> method to write strings directly to the event log using that source.</span></span>  
  
 <span data-ttu-id="6be2f-475">若要更改现有源的配置详细信息，必须删除源，然后使用新的配置创建。</span><span class="sxs-lookup"><span data-stu-id="6be2f-475">To change the configuration details of an existing source, you must delete the source and then create it with the new configuration.</span></span> <span data-ttu-id="6be2f-476">如果其他应用程序或组件使用的现有源，请使用更新的配置，而无需删除现有的源创建新的源。</span><span class="sxs-lookup"><span data-stu-id="6be2f-476">If other applications or components use the existing source, create a new source with the updated configuration rather than deleting the existing source.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="6be2f-477">如果源已映射到某个日志并重新映射到新的日志，必须重新启动计算机才能使更改生效。</span><span class="sxs-lookup"><span data-stu-id="6be2f-477">If a source has already been mapped to a log and you remap it to a new log, you must restart the computer for the changes to take effect.</span></span>  
  
   
  
## Examples  
 <span data-ttu-id="6be2f-478">下面的示例创建源`MySource`计算机上`MyServer`，和一个项写入事件日志`MyNewLog`。</span><span class="sxs-lookup"><span data-stu-id="6be2f-478">The following example creates the source `MySource` on the computer `MyServer`, and writes an entry to the event log `MyNewLog`.</span></span>  
  
 [!code-cpp[Classic EventLog.SourceExists1 Example#1](~/samples/snippets/cpp/VS_Snippets_CLR_Classic/classic EventLog.SourceExists1 Example/CPP/source.cpp#1)]
 [!code-csharp[Classic EventLog.SourceExists1 Example#1](~/samples/snippets/csharp/VS_Snippets_CLR_Classic/classic EventLog.SourceExists1 Example/CS/source.cs#1)]
 [!code-vb[Classic EventLog.SourceExists1 Example#1](~/samples/snippets/visualbasic/VS_Snippets_CLR_Classic/classic EventLog.SourceExists1 Example/VB/source.vb#1)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentException"><span data-ttu-id="6be2f-479"><paramref name="machineName" /> 不是有效的计算机名称。</span><span class="sxs-lookup"><span data-stu-id="6be2f-479">The <paramref name="machineName" /> is not a valid computer name.</span></span>  
  
 <span data-ttu-id="6be2f-480">\- 或 -</span><span class="sxs-lookup"><span data-stu-id="6be2f-480">\- or -</span></span>  
  
 <span data-ttu-id="6be2f-481"><paramref name="source" /> 为空字符串 ("") 或 <see langword="null" />。</span><span class="sxs-lookup"><span data-stu-id="6be2f-481"><paramref name="source" /> is an empty string ("") or <see langword="null" />.</span></span>  
  
 <span data-ttu-id="6be2f-482">\- 或 -</span><span class="sxs-lookup"><span data-stu-id="6be2f-482">\- or -</span></span>  
  
 <span data-ttu-id="6be2f-483"><paramref name="logName" /> 不是有效的事件日志名称。</span><span class="sxs-lookup"><span data-stu-id="6be2f-483"><paramref name="logName" /> is not a valid event log name.</span></span> <span data-ttu-id="6be2f-484">事件日志名称必须由可打印字符组成，且不得包含字符“\*”、“?”或“\\”。</span><span class="sxs-lookup"><span data-stu-id="6be2f-484">Event log names must consist of printable characters, and cannot include the characters '\*', '?', or '\\'.</span></span>  
  
 <span data-ttu-id="6be2f-485">\- 或 -</span><span class="sxs-lookup"><span data-stu-id="6be2f-485">\- or -</span></span>  
  
 <span data-ttu-id="6be2f-486"><paramref name="logName" />对用户日志创建无效。</span><span class="sxs-lookup"><span data-stu-id="6be2f-486"><paramref name="logName" /> is not valid for user log creation.</span></span> <span data-ttu-id="6be2f-487">事件日志名称 AppEvent、SysEvent 和 SecEvent 是保留为系统使用的。</span><span class="sxs-lookup"><span data-stu-id="6be2f-487">The event log names AppEvent, SysEvent, and SecEvent are reserved for system use.</span></span>  
  
 <span data-ttu-id="6be2f-488">\- 或 -</span><span class="sxs-lookup"><span data-stu-id="6be2f-488">\- or -</span></span>  
  
 <span data-ttu-id="6be2f-489">该日志名称与一个现有事件源名称相匹配。</span><span class="sxs-lookup"><span data-stu-id="6be2f-489">The log name matches an existing event source name.</span></span>  
  
 <span data-ttu-id="6be2f-490">\- 或 -</span><span class="sxs-lookup"><span data-stu-id="6be2f-490">\- or -</span></span>  
  
 <span data-ttu-id="6be2f-491">此源名称导致注册表项路径的长度超过 254 个字符。</span><span class="sxs-lookup"><span data-stu-id="6be2f-491">The source name results in a registry key path longer than 254 characters.</span></span>  
  
 <span data-ttu-id="6be2f-492">\- 或 -</span><span class="sxs-lookup"><span data-stu-id="6be2f-492">\- or -</span></span>  
  
 <span data-ttu-id="6be2f-493"><paramref name="logName" /> 的前 8 个字符与指定计算机上现有事件日志名称的前 8 个字符相匹配。</span><span class="sxs-lookup"><span data-stu-id="6be2f-493">The first 8 characters of <paramref name="logName" /> match the first 8 characters of an existing event log name on the specified computer.</span></span>  
  
 <span data-ttu-id="6be2f-494">\- 或 -</span><span class="sxs-lookup"><span data-stu-id="6be2f-494">\- or -</span></span>  
  
 <span data-ttu-id="6be2f-495">源无法注册，因为它已存在于指定的计算机上。</span><span class="sxs-lookup"><span data-stu-id="6be2f-495">The source cannot be registered because it already exists on the specified computer.</span></span>  
  
 <span data-ttu-id="6be2f-496">\- 或 -</span><span class="sxs-lookup"><span data-stu-id="6be2f-496">\- or -</span></span>  
  
 <span data-ttu-id="6be2f-497">该源名称与一个现有事件源名称相匹配。</span><span class="sxs-lookup"><span data-stu-id="6be2f-497">The source name matches an existing event source name.</span></span></exception>
        <exception cref="T:System.InvalidOperationException"><span data-ttu-id="6be2f-498">事件日志的注册表项未能在指定的计算机上打开。</span><span class="sxs-lookup"><span data-stu-id="6be2f-498">The registry key for the event log could not be opened on the specified computer.</span></span></exception>
        <permission cref="T:System.Diagnostics.EventLogPermission"><span data-ttu-id="6be2f-499">用于管理的计算机上的事件日志信息。</span><span class="sxs-lookup"><span data-stu-id="6be2f-499">for administering event log information on the computer.</span></span> <span data-ttu-id="6be2f-500">关联的枚举： <see cref="F:System.Diagnostics.EventLogPermissionAccess.Administer" /></span><span class="sxs-lookup"><span data-stu-id="6be2f-500">Associated enumeration: <see cref="F:System.Diagnostics.EventLogPermissionAccess.Administer" /></span></span></permission>
        <altmember cref="M:System.Diagnostics.EventLog.DeleteEventSource(System.String)" />
        <altmember cref="M:System.Diagnostics.EventLog.SourceExists(System.String)" />
        <altmember cref="P:System.Diagnostics.EventLog.MachineName" />
        <altmember cref="P:System.Diagnostics.EventLog.Source" />
        <altmember cref="P:System.Diagnostics.EventLog.Log" />
        <altmember cref="M:System.Diagnostics.EventLog.Delete(System.String)" />
      </Docs>
    </Member>
    <MemberGroup MemberName="Delete">
      <AssemblyInfo>
        <AssemblyName>System</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Docs>
        <summary><span data-ttu-id="6be2f-501">移除日志资源。</span><span class="sxs-lookup"><span data-stu-id="6be2f-501">Removes a log resource.</span></span></summary>
      </Docs>
    </MemberGroup>
    <Member MemberName="Delete">
      <MemberSignature Language="C#" Value="public static void Delete (string logName);" />
      <MemberSignature Language="ILAsm" Value=".method public static hidebysig void Delete(string logName) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Diagnostics.EventLog.Delete(System.String)" />
      <MemberSignature Language="VB.NET" Value="Public Shared Sub Delete (logName As String)" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; static void Delete(System::String ^ logName);" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Void</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="logName" Type="System.String" />
      </Parameters>
      <Docs>
        <param name="logName"><span data-ttu-id="6be2f-502">要删除的日志的名称。</span><span class="sxs-lookup"><span data-stu-id="6be2f-502">The name of the log to delete.</span></span> <span data-ttu-id="6be2f-503">可能的值包括：“应用程序”、“安全性”、“系统”和计算机上的任何自定义事件日志。</span><span class="sxs-lookup"><span data-stu-id="6be2f-503">Possible values include: Application, Security, System, and any custom event logs on the computer.</span></span></param>
        <summary><span data-ttu-id="6be2f-504">从本地计算机上移除事件日志。</span><span class="sxs-lookup"><span data-stu-id="6be2f-504">Removes an event log from the local computer.</span></span></summary>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="6be2f-505">当你想要删除的日志位于本地计算机上，请使用此方法。</span><span class="sxs-lookup"><span data-stu-id="6be2f-505">Use this method when the log you want to delete is on the local computer.</span></span> <span data-ttu-id="6be2f-506">你可以删除的计算机上，任何日志，前提是您具有适当的注册表权限。</span><span class="sxs-lookup"><span data-stu-id="6be2f-506">You can delete any log on the computer, provided you have the appropriate registry permissions.</span></span>  
  
 <span data-ttu-id="6be2f-507"><xref:System.Diagnostics.EventLog.Delete%2A> 删除指定的日志`logName`来自本地计算机。</span><span class="sxs-lookup"><span data-stu-id="6be2f-507"><xref:System.Diagnostics.EventLog.Delete%2A> removes the log specified by `logName` from the local computer.</span></span> <span data-ttu-id="6be2f-508">如果你想要删除仅源注册到日志，请调用<xref:System.Diagnostics.EventLog.DeleteEventSource%2A>。</span><span class="sxs-lookup"><span data-stu-id="6be2f-508">If you want to delete only the source registered to a log, call <xref:System.Diagnostics.EventLog.DeleteEventSource%2A>.</span></span> <span data-ttu-id="6be2f-509">如果你只想要删除的日志条目，调用<xref:System.Diagnostics.EventLog.Clear%2A>。</span><span class="sxs-lookup"><span data-stu-id="6be2f-509">If you only want to delete the log entries, call <xref:System.Diagnostics.EventLog.Clear%2A>.</span></span> <span data-ttu-id="6be2f-510"><xref:System.Diagnostics.EventLog.Delete%2A> 和<xref:System.Diagnostics.EventLog.DeleteEventSource%2A>是`static`方法，以便它们可以调用类本身上。</span><span class="sxs-lookup"><span data-stu-id="6be2f-510"><xref:System.Diagnostics.EventLog.Delete%2A> and <xref:System.Diagnostics.EventLog.DeleteEventSource%2A> are `static` methods, so they can be called on the class itself.</span></span> <span data-ttu-id="6be2f-511">不需要创建的新实例<xref:System.Diagnostics.EventLog>调用任何一种方法。</span><span class="sxs-lookup"><span data-stu-id="6be2f-511">It is not necessary to create a new instance of <xref:System.Diagnostics.EventLog> to call either method.</span></span>  
  
 <span data-ttu-id="6be2f-512"><xref:System.Diagnostics.EventLog.Delete%2A>方法首先删除存储日志的内容的文件。</span><span class="sxs-lookup"><span data-stu-id="6be2f-512">The <xref:System.Diagnostics.EventLog.Delete%2A> method first deletes the file that holds the contents of the log.</span></span> <span data-ttu-id="6be2f-513">然后，访问注册表，并删除为该日志注册的所有事件源。</span><span class="sxs-lookup"><span data-stu-id="6be2f-513">It then accesses the registry and removes all the event sources registered for that log.</span></span> <span data-ttu-id="6be2f-514">如果重新创建在以后的日志时，你应该它们是否要重用再次注册事件源。</span><span class="sxs-lookup"><span data-stu-id="6be2f-514">If you recreate the log at a later point, you should register the event sources again, if they are to be reused.</span></span> <span data-ttu-id="6be2f-515">如果不注册事件源和其他用户的事件源编写无需指定日志名称，将在应用程序事件日志中创建事件源。</span><span class="sxs-lookup"><span data-stu-id="6be2f-515">If you do not register the event sources and other users write to an event source without specifying a log name, the event source will be created in the Application event log.</span></span> <span data-ttu-id="6be2f-516">因此，应用程序以前曾经将条目写入到删除并重新创建的日志将写入到应用程序日志相反，因为它现在包含事件源。</span><span class="sxs-lookup"><span data-stu-id="6be2f-516">Therefore, applications that previously were able to write entries to the log you deleted and recreated will write to the Application log instead, because it now contains the event source.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="6be2f-517">重新创建事件日志可以是一个复杂的过程。</span><span class="sxs-lookup"><span data-stu-id="6be2f-517">Recreating an event log can be a difficult process.</span></span> <span data-ttu-id="6be2f-518">避免删除任何系统创建事件日志，如应用程序日志。</span><span class="sxs-lookup"><span data-stu-id="6be2f-518">Avoid deleting any of the system-created event logs, such as the Application log.</span></span>  
  
 <span data-ttu-id="6be2f-519">删除通过调用日志<xref:System.Diagnostics.EventLog.Delete%2A>会自动删除已注册到该日志的源。</span><span class="sxs-lookup"><span data-stu-id="6be2f-519">Deleting a log through a call to <xref:System.Diagnostics.EventLog.Delete%2A> automatically deletes the sources registered to that log.</span></span> <span data-ttu-id="6be2f-520">这会使其他应用程序使用该日志不起作用。</span><span class="sxs-lookup"><span data-stu-id="6be2f-520">This can make other applications using that log inoperative.</span></span>  
  
   
  
## Examples  
 <span data-ttu-id="6be2f-521">下面的示例从本地计算机中删除日志。</span><span class="sxs-lookup"><span data-stu-id="6be2f-521">The following example deletes a log from the local computer.</span></span> <span data-ttu-id="6be2f-522">该示例可确定从其源日志。</span><span class="sxs-lookup"><span data-stu-id="6be2f-522">The example determines the log from its source.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="6be2f-523">多个源可能会写入事件日志。</span><span class="sxs-lookup"><span data-stu-id="6be2f-523">More than one source might write to an event log.</span></span> <span data-ttu-id="6be2f-524">在删除之前自定义日志，请确保没有其他源写入该日志。</span><span class="sxs-lookup"><span data-stu-id="6be2f-524">Before deleting a custom log, make sure there are no other sources writing to that log.</span></span>  
  
 [!code-cpp[Classic EventLog.DeleteEventSource Example#1](~/samples/snippets/cpp/VS_Snippets_CLR_Classic/classic EventLog.DeleteEventSource Example/CPP/source.cpp#1)]
 [!code-csharp[Classic EventLog.DeleteEventSource Example#1](~/samples/snippets/csharp/VS_Snippets_CLR_Classic/classic EventLog.DeleteEventSource Example/CS/source.cs#1)]
 [!code-vb[Classic EventLog.DeleteEventSource Example#1](~/samples/snippets/visualbasic/VS_Snippets_CLR_Classic/classic EventLog.DeleteEventSource Example/VB/source.vb#1)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentException">
          <span data-ttu-id="6be2f-525"><paramref name="logName" /> 为空字符串 ("") 或 <see langword="null" />。</span><span class="sxs-lookup"><span data-stu-id="6be2f-525"><paramref name="logName" /> is an empty string ("") or <see langword="null" />.</span></span></exception>
        <exception cref="T:System.InvalidOperationException"><span data-ttu-id="6be2f-526">事件日志的注册表项未能在本地计算机上打开。</span><span class="sxs-lookup"><span data-stu-id="6be2f-526">The registry key for the event log could not be opened on the local computer.</span></span>  
  
 <span data-ttu-id="6be2f-527">\- 或 -</span><span class="sxs-lookup"><span data-stu-id="6be2f-527">\- or -</span></span>  
  
 <span data-ttu-id="6be2f-528">本地计算机上不存在该日志。</span><span class="sxs-lookup"><span data-stu-id="6be2f-528">The log does not exist on the local computer.</span></span></exception>
        <exception cref="T:System.ComponentModel.Win32Exception"><span data-ttu-id="6be2f-529">未成功清除事件日志。</span><span class="sxs-lookup"><span data-stu-id="6be2f-529">The event log was not cleared successfully.</span></span>  
  
 <span data-ttu-id="6be2f-530">或</span><span class="sxs-lookup"><span data-stu-id="6be2f-530">-or-</span></span>  
  
 <span data-ttu-id="6be2f-531">无法打开日志。</span><span class="sxs-lookup"><span data-stu-id="6be2f-531">The log cannot be opened.</span></span> <span data-ttu-id="6be2f-532">一个 Windows 错误代码不可用。</span><span class="sxs-lookup"><span data-stu-id="6be2f-532">A Windows error code is not available.</span></span></exception>
        <permission cref="T:System.Diagnostics.EventLogPermission"><span data-ttu-id="6be2f-533">用于管理的计算机上的事件日志信息。</span><span class="sxs-lookup"><span data-stu-id="6be2f-533">for administering event log information on the computer.</span></span> <span data-ttu-id="6be2f-534">关联的枚举： <see cref="F:System.Diagnostics.EventLogPermissionAccess.Administer" /></span><span class="sxs-lookup"><span data-stu-id="6be2f-534">Associated enumeration: <see cref="F:System.Diagnostics.EventLogPermissionAccess.Administer" /></span></span></permission>
        <altmember cref="M:System.Diagnostics.EventLog.Clear" />
        <altmember cref="M:System.Diagnostics.EventLog.Close" />
        <altmember cref="M:System.Diagnostics.EventLog.DeleteEventSource(System.String)" />
        <altmember cref="P:System.Diagnostics.EventLog.Log" />
      </Docs>
    </Member>
    <Member MemberName="Delete">
      <MemberSignature Language="C#" Value="public static void Delete (string logName, string machineName);" />
      <MemberSignature Language="ILAsm" Value=".method public static hidebysig void Delete(string logName, string machineName) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Diagnostics.EventLog.Delete(System.String,System.String)" />
      <MemberSignature Language="VB.NET" Value="Public Shared Sub Delete (logName As String, machineName As String)" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; static void Delete(System::String ^ logName, System::String ^ machineName);" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Attributes>
        <Attribute>
          <AttributeName>System.MonoNotSupported("remote machine is not supported")</AttributeName>
        </Attribute>
      </Attributes>
      <ReturnValue>
        <ReturnType>System.Void</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="logName" Type="System.String" />
        <Parameter Name="machineName" Type="System.String" />
      </Parameters>
      <Docs>
        <param name="logName"><span data-ttu-id="6be2f-535">要删除的日志的名称。</span><span class="sxs-lookup"><span data-stu-id="6be2f-535">The name of the log to delete.</span></span> <span data-ttu-id="6be2f-536">可能的值包括：“应用程序”、“安全”、“系统”和指定计算机上的任何自定义事件日志。</span><span class="sxs-lookup"><span data-stu-id="6be2f-536">Possible values include: Application, Security, System, and any custom event logs on the specified computer.</span></span></param>
        <param name="machineName"><span data-ttu-id="6be2f-537">要从中删除日志的计算机名称，对于本地计算机则为“.”。</span><span class="sxs-lookup"><span data-stu-id="6be2f-537">The name of the computer to delete the log from, or "." for the local computer.</span></span></param>
        <summary><span data-ttu-id="6be2f-538">从指定计算机上移除事件日志。</span><span class="sxs-lookup"><span data-stu-id="6be2f-538">Removes an event log from the specified computer.</span></span></summary>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="6be2f-539">当你想要删除的日志位于远程计算机上，请使用此方法。</span><span class="sxs-lookup"><span data-stu-id="6be2f-539">Use this method when the log you want to delete is on a remote computer.</span></span> <span data-ttu-id="6be2f-540">你可以删除的计算机上，任何日志，前提是您具有适当的注册表权限。</span><span class="sxs-lookup"><span data-stu-id="6be2f-540">You can delete any log on the computer, provided you have the appropriate registry permissions.</span></span>  
  
 <span data-ttu-id="6be2f-541"><xref:System.Diagnostics.EventLog.Delete%2A> 删除指定的日志`logName`从指定的计算机`machineName`。</span><span class="sxs-lookup"><span data-stu-id="6be2f-541"><xref:System.Diagnostics.EventLog.Delete%2A> removes the log specified by `logName` from the computer specified by `machineName`.</span></span> <span data-ttu-id="6be2f-542">如果你想要删除仅源注册到日志，请调用<xref:System.Diagnostics.EventLog.DeleteEventSource%2A>。</span><span class="sxs-lookup"><span data-stu-id="6be2f-542">If you want to delete only the source registered to a log, call <xref:System.Diagnostics.EventLog.DeleteEventSource%2A>.</span></span> <span data-ttu-id="6be2f-543">如果你只想要删除的日志条目，调用<xref:System.Diagnostics.EventLog.Clear%2A>。</span><span class="sxs-lookup"><span data-stu-id="6be2f-543">If you only want to delete the log entries, call <xref:System.Diagnostics.EventLog.Clear%2A>.</span></span> <span data-ttu-id="6be2f-544"><xref:System.Diagnostics.EventLog.Delete%2A> 和<xref:System.Diagnostics.EventLog.DeleteEventSource%2A>是`static`方法，以便它们可以调用类本身上。</span><span class="sxs-lookup"><span data-stu-id="6be2f-544"><xref:System.Diagnostics.EventLog.Delete%2A> and <xref:System.Diagnostics.EventLog.DeleteEventSource%2A> are `static` methods, so they can be called on the class itself.</span></span> <span data-ttu-id="6be2f-545">不需要创建的实例<xref:System.Diagnostics.EventLog>调用任何一种方法。</span><span class="sxs-lookup"><span data-stu-id="6be2f-545">It is not necessary to create an instance of <xref:System.Diagnostics.EventLog> to call either method.</span></span>  
  
 <span data-ttu-id="6be2f-546">此方法首先删除存储日志的内容的文件。</span><span class="sxs-lookup"><span data-stu-id="6be2f-546">This method first deletes the file that holds the contents of the log.</span></span> <span data-ttu-id="6be2f-547">然后，访问注册表，并删除为该日志注册的所有事件源。</span><span class="sxs-lookup"><span data-stu-id="6be2f-547">It then accesses the registry and removes all the event sources registered for that log.</span></span> <span data-ttu-id="6be2f-548">如果重新创建在以后的日志时，你应该它们是否要重用再次注册事件源。</span><span class="sxs-lookup"><span data-stu-id="6be2f-548">If you recreate the log at a later point, you should register the event sources again, if they are to be reused.</span></span> <span data-ttu-id="6be2f-549">如果不注册事件源和其他用户的事件源编写无需指定日志名称，将在应用程序事件日志中创建事件源。</span><span class="sxs-lookup"><span data-stu-id="6be2f-549">If you do not register the event sources and other users write to an event source without specifying a log name, the event source will be created in the Application event log.</span></span> <span data-ttu-id="6be2f-550">因此，应用程序以前曾经将条目写入到删除并重新创建的日志将写入到应用程序日志相反，因为它现在包含事件源。</span><span class="sxs-lookup"><span data-stu-id="6be2f-550">Therefore, applications that previously were able to write entries to the log you deleted and recreated will write to the Application log instead, because it now contains the event source.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="6be2f-551">重新创建事件日志可以是一个复杂的过程。</span><span class="sxs-lookup"><span data-stu-id="6be2f-551">Recreating an event log can be a difficult process.</span></span> <span data-ttu-id="6be2f-552">避免删除任何系统创建事件日志，如应用程序日志。</span><span class="sxs-lookup"><span data-stu-id="6be2f-552">Avoid deleting any of the system-created event logs, such as the Application log.</span></span>  
  
 <span data-ttu-id="6be2f-553">删除通过调用日志<xref:System.Diagnostics.EventLog.Delete%2A>会自动删除已注册到该日志的源。</span><span class="sxs-lookup"><span data-stu-id="6be2f-553">Deleting a log through a call to <xref:System.Diagnostics.EventLog.Delete%2A> automatically deletes the sources registered to that log.</span></span> <span data-ttu-id="6be2f-554">这会使其他应用程序使用该日志不起作用。</span><span class="sxs-lookup"><span data-stu-id="6be2f-554">This can make other applications using that log inoperative.</span></span>  
  
   
  
## Examples  
 <span data-ttu-id="6be2f-555">下面的示例从指定的计算机中删除日志。</span><span class="sxs-lookup"><span data-stu-id="6be2f-555">The following example deletes a log from the specified computer.</span></span> <span data-ttu-id="6be2f-556">该示例可确定从其源日志。</span><span class="sxs-lookup"><span data-stu-id="6be2f-556">The example determines the log from its source.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="6be2f-557">多个源可能会写入事件日志。</span><span class="sxs-lookup"><span data-stu-id="6be2f-557">More than one source might write to an event log.</span></span> <span data-ttu-id="6be2f-558">在删除之前自定义日志，请确保没有其他源写入该日志。</span><span class="sxs-lookup"><span data-stu-id="6be2f-558">Before deleting a custom log, make sure there are no other sources writing to that log.</span></span>  
  
 [!code-cpp[Classic EventLog.Delete1 Example#1](~/samples/snippets/cpp/VS_Snippets_CLR_Classic/classic EventLog.Delete1 Example/CPP/source.cpp#1)]
 [!code-csharp[Classic EventLog.Delete1 Example#1](~/samples/snippets/csharp/VS_Snippets_CLR_Classic/classic EventLog.Delete1 Example/CS/source.cs#1)]
 [!code-vb[Classic EventLog.Delete1 Example#1](~/samples/snippets/visualbasic/VS_Snippets_CLR_Classic/classic EventLog.Delete1 Example/VB/source.vb#1)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentException">
          <span data-ttu-id="6be2f-559"><paramref name="logName" /> 为空字符串 ("") 或 <see langword="null" />。</span><span class="sxs-lookup"><span data-stu-id="6be2f-559"><paramref name="logName" /> is an empty string ("") or <see langword="null" />.</span></span>  
  
 <span data-ttu-id="6be2f-560">\- 或 -</span><span class="sxs-lookup"><span data-stu-id="6be2f-560">\- or -</span></span>  
  
 <span data-ttu-id="6be2f-561"><paramref name="machineName" /> 不是有效的计算机名称。</span><span class="sxs-lookup"><span data-stu-id="6be2f-561"><paramref name="machineName" /> is not a valid computer name.</span></span></exception>
        <exception cref="T:System.InvalidOperationException"><span data-ttu-id="6be2f-562">事件日志的注册表项未能在指定的计算机上打开。</span><span class="sxs-lookup"><span data-stu-id="6be2f-562">The registry key for the event log could not be opened on the specified computer.</span></span>  
  
 <span data-ttu-id="6be2f-563">\- 或 -</span><span class="sxs-lookup"><span data-stu-id="6be2f-563">\- or -</span></span>  
  
 <span data-ttu-id="6be2f-564">指定的计算机上不存在该日志。</span><span class="sxs-lookup"><span data-stu-id="6be2f-564">The log does not exist on the specified computer.</span></span></exception>
        <exception cref="T:System.ComponentModel.Win32Exception"><span data-ttu-id="6be2f-565">未成功清除事件日志。</span><span class="sxs-lookup"><span data-stu-id="6be2f-565">The event log was not cleared successfully.</span></span>  
  
 <span data-ttu-id="6be2f-566">或</span><span class="sxs-lookup"><span data-stu-id="6be2f-566">-or-</span></span>  
  
 <span data-ttu-id="6be2f-567">无法打开日志。</span><span class="sxs-lookup"><span data-stu-id="6be2f-567">The log cannot be opened.</span></span> <span data-ttu-id="6be2f-568">一个 Windows 错误代码不可用。</span><span class="sxs-lookup"><span data-stu-id="6be2f-568">A Windows error code is not available.</span></span></exception>
        <permission cref="T:System.Diagnostics.EventLogPermission"><span data-ttu-id="6be2f-569">用于管理的计算机上的事件日志信息。</span><span class="sxs-lookup"><span data-stu-id="6be2f-569">for administering event log information on the computer.</span></span> <span data-ttu-id="6be2f-570">关联的枚举： <see cref="F:System.Diagnostics.EventLogPermissionAccess.Administer" /></span><span class="sxs-lookup"><span data-stu-id="6be2f-570">Associated enumeration: <see cref="F:System.Diagnostics.EventLogPermissionAccess.Administer" /></span></span></permission>
        <altmember cref="M:System.Diagnostics.EventLog.Clear" />
        <altmember cref="M:System.Diagnostics.EventLog.Close" />
        <altmember cref="M:System.Diagnostics.EventLog.DeleteEventSource(System.String)" />
        <altmember cref="P:System.Diagnostics.EventLog.Log" />
        <altmember cref="P:System.Diagnostics.EventLog.MachineName" />
      </Docs>
    </Member>
    <MemberGroup MemberName="DeleteEventSource">
      <AssemblyInfo>
        <AssemblyName>System</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Docs>
        <summary><span data-ttu-id="6be2f-571">从事件日志中移除应用程序的事件源注册。</span><span class="sxs-lookup"><span data-stu-id="6be2f-571">Removes an application's event source registration from the event log.</span></span></summary>
      </Docs>
    </MemberGroup>
    <Member MemberName="DeleteEventSource">
      <MemberSignature Language="C#" Value="public static void DeleteEventSource (string source);" />
      <MemberSignature Language="ILAsm" Value=".method public static hidebysig void DeleteEventSource(string source) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Diagnostics.EventLog.DeleteEventSource(System.String)" />
      <MemberSignature Language="VB.NET" Value="Public Shared Sub DeleteEventSource (source As String)" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; static void DeleteEventSource(System::String ^ source);" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Void</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="source" Type="System.String" />
      </Parameters>
      <Docs>
        <param name="source"><span data-ttu-id="6be2f-572">应用程序在事件日志系统中用来注册的名称。</span><span class="sxs-lookup"><span data-stu-id="6be2f-572">The name by which the application is registered in the event log system.</span></span></param>
        <summary><span data-ttu-id="6be2f-573">从本地计算机的事件日志中移除事件源注册。</span><span class="sxs-lookup"><span data-stu-id="6be2f-573">Removes the event source registration from the event log of the local computer.</span></span></summary>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="6be2f-574">此方法用于删除的注册<xref:System.Diagnostics.EventLog.Source%2A>来自本地计算机。</span><span class="sxs-lookup"><span data-stu-id="6be2f-574">Use this method to remove the registration of a <xref:System.Diagnostics.EventLog.Source%2A> from the local computer.</span></span> <span data-ttu-id="6be2f-575"><xref:System.Diagnostics.EventLog.DeleteEventSource%2A> 访问本地计算机上的注册表并删除的应用程序作为有效的事件源注册。</span><span class="sxs-lookup"><span data-stu-id="6be2f-575"><xref:System.Diagnostics.EventLog.DeleteEventSource%2A> accesses the registry on the local computer and removes the registration of your application as a valid source of events.</span></span>  
  
 <span data-ttu-id="6be2f-576">如果你不再需要它来写入该日志条目，则可以删除你的组件作为有效的事件源。</span><span class="sxs-lookup"><span data-stu-id="6be2f-576">You can remove your component as a valid source of events if you no longer need it to write entries to that log.</span></span> <span data-ttu-id="6be2f-577">例如，如果你需要将你的组件从一个日志更改为另一个可能会执行此操作。</span><span class="sxs-lookup"><span data-stu-id="6be2f-577">For example, you might do this if you need to change your component from one log to another.</span></span> <span data-ttu-id="6be2f-578">因为源一次只能注册到一个日志，更改日志，您必须删除当前的注册。</span><span class="sxs-lookup"><span data-stu-id="6be2f-578">Because a source can only be registered to one log at a time, changing the log requires you to remove the current registration.</span></span>  
  
 <span data-ttu-id="6be2f-579"><xref:System.Diagnostics.EventLog.DeleteEventSource%2A> 删除中仅注册到日志的源。</span><span class="sxs-lookup"><span data-stu-id="6be2f-579"><xref:System.Diagnostics.EventLog.DeleteEventSource%2A> removes only the source registered to a log.</span></span> <span data-ttu-id="6be2f-580">如果你想要移除日志本身，调用<xref:System.Diagnostics.EventLog.Delete%2A>。</span><span class="sxs-lookup"><span data-stu-id="6be2f-580">If you want to remove the log itself, call <xref:System.Diagnostics.EventLog.Delete%2A>.</span></span> <span data-ttu-id="6be2f-581">如果你只想要删除的日志条目，调用<xref:System.Diagnostics.EventLog.Clear%2A>。</span><span class="sxs-lookup"><span data-stu-id="6be2f-581">If you only want to delete the log entries, call <xref:System.Diagnostics.EventLog.Clear%2A>.</span></span> <span data-ttu-id="6be2f-582"><xref:System.Diagnostics.EventLog.Delete%2A> 和<xref:System.Diagnostics.EventLog.DeleteEventSource%2A>是`static`方法，以便它们可以调用类本身上。</span><span class="sxs-lookup"><span data-stu-id="6be2f-582"><xref:System.Diagnostics.EventLog.Delete%2A> and <xref:System.Diagnostics.EventLog.DeleteEventSource%2A> are `static` methods, so they can be called on the class itself.</span></span> <span data-ttu-id="6be2f-583">不需要创建的实例<xref:System.Diagnostics.EventLog>调用任何一种方法。</span><span class="sxs-lookup"><span data-stu-id="6be2f-583">It is not necessary to create an instance of <xref:System.Diagnostics.EventLog> to call either method.</span></span>  
  
 <span data-ttu-id="6be2f-584">删除通过调用日志<xref:System.Diagnostics.EventLog.Delete%2A>会自动删除已注册到该日志的源。</span><span class="sxs-lookup"><span data-stu-id="6be2f-584">Deleting a log through a call to <xref:System.Diagnostics.EventLog.Delete%2A> automatically deletes the sources registered to that log.</span></span> <span data-ttu-id="6be2f-585">这会使其他应用程序使用该日志不起作用。</span><span class="sxs-lookup"><span data-stu-id="6be2f-585">This can make other applications using that log inoperative.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="6be2f-586">如果源已映射到某个日志并重新映射到新的日志，必须重新启动计算机才能使更改生效。</span><span class="sxs-lookup"><span data-stu-id="6be2f-586">If a source has already been mapped to a log and you remap it to a new log, you must restart the computer for the changes to take effect.</span></span>  
  
   
  
## Examples  
 <span data-ttu-id="6be2f-587">下面的示例从本地计算机中删除源。</span><span class="sxs-lookup"><span data-stu-id="6be2f-587">The following example deletes a source from the local computer.</span></span> <span data-ttu-id="6be2f-588">该示例确定从其源日志，然后删除该日志。</span><span class="sxs-lookup"><span data-stu-id="6be2f-588">The example determines the log from its source, and then deletes the log.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="6be2f-589">多个源可能会写入事件日志。</span><span class="sxs-lookup"><span data-stu-id="6be2f-589">More than one source might write to an event log.</span></span> <span data-ttu-id="6be2f-590">在删除之前自定义日志，请确保没有其他源写入该日志。</span><span class="sxs-lookup"><span data-stu-id="6be2f-590">Before deleting a custom log, make sure there are no other sources writing to that log.</span></span>  
  
 [!code-cpp[Classic EventLog.DeleteEventSource Example#1](~/samples/snippets/cpp/VS_Snippets_CLR_Classic/classic EventLog.DeleteEventSource Example/CPP/source.cpp#1)]
 [!code-csharp[Classic EventLog.DeleteEventSource Example#1](~/samples/snippets/csharp/VS_Snippets_CLR_Classic/classic EventLog.DeleteEventSource Example/CS/source.cs#1)]
 [!code-vb[Classic EventLog.DeleteEventSource Example#1](~/samples/snippets/visualbasic/VS_Snippets_CLR_Classic/classic EventLog.DeleteEventSource Example/VB/source.vb#1)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentException"><span data-ttu-id="6be2f-591">本地计算机的注册表中不存在 <paramref name="source" /> 参数。</span><span class="sxs-lookup"><span data-stu-id="6be2f-591">The <paramref name="source" /> parameter does not exist in the registry of the local computer.</span></span>  
  
 <span data-ttu-id="6be2f-592">\- 或 -</span><span class="sxs-lookup"><span data-stu-id="6be2f-592">\- or -</span></span>  
  
 <span data-ttu-id="6be2f-593">您对事件日志的注册表项没有写访问权。</span><span class="sxs-lookup"><span data-stu-id="6be2f-593">You do not have write access on the registry key for the event log.</span></span></exception>
        <permission cref="T:System.Diagnostics.EventLogPermission"><span data-ttu-id="6be2f-594">用于管理的计算机上的事件日志信息。</span><span class="sxs-lookup"><span data-stu-id="6be2f-594">for administering event log information on the computer.</span></span> <span data-ttu-id="6be2f-595">关联的枚举： <see cref="F:System.Diagnostics.EventLogPermissionAccess.Administer" /></span><span class="sxs-lookup"><span data-stu-id="6be2f-595">Associated enumeration: <see cref="F:System.Diagnostics.EventLogPermissionAccess.Administer" /></span></span></permission>
        <altmember cref="Overload:System.Diagnostics.EventLog.CreateEventSource" />
        <altmember cref="P:System.Diagnostics.EventLog.Source" />
        <altmember cref="M:System.Diagnostics.EventLog.SourceExists(System.String)" />
        <altmember cref="M:System.Diagnostics.EventLog.Delete(System.String)" />
        <altmember cref="M:System.Diagnostics.EventLog.Clear" />
      </Docs>
    </Member>
    <Member MemberName="DeleteEventSource">
      <MemberSignature Language="C#" Value="public static void DeleteEventSource (string source, string machineName);" />
      <MemberSignature Language="ILAsm" Value=".method public static hidebysig void DeleteEventSource(string source, string machineName) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Diagnostics.EventLog.DeleteEventSource(System.String,System.String)" />
      <MemberSignature Language="VB.NET" Value="Public Shared Sub DeleteEventSource (source As String, machineName As String)" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; static void DeleteEventSource(System::String ^ source, System::String ^ machineName);" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Attributes>
        <Attribute>
          <AttributeName>System.MonoNotSupported("remote machine is not supported")</AttributeName>
        </Attribute>
      </Attributes>
      <ReturnValue>
        <ReturnType>System.Void</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="source" Type="System.String" />
        <Parameter Name="machineName" Type="System.String" />
      </Parameters>
      <Docs>
        <param name="source"><span data-ttu-id="6be2f-596">应用程序在事件日志系统中用来注册的名称。</span><span class="sxs-lookup"><span data-stu-id="6be2f-596">The name by which the application is registered in the event log system.</span></span></param>
        <param name="machineName"><span data-ttu-id="6be2f-597">要从中移除注册的计算机名，对于本地计算机则为“.”。</span><span class="sxs-lookup"><span data-stu-id="6be2f-597">The name of the computer to remove the registration from, or "." for the local computer.</span></span></param>
        <summary><span data-ttu-id="6be2f-598">从指定的计算机上移除应用程序的事件源注册。</span><span class="sxs-lookup"><span data-stu-id="6be2f-598">Removes the application's event source registration from the specified computer.</span></span></summary>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="6be2f-599">此重载用于删除的注册<xref:System.Diagnostics.EventLog.Source%2A>从远程计算机。</span><span class="sxs-lookup"><span data-stu-id="6be2f-599">Use this overload to remove the registration of a <xref:System.Diagnostics.EventLog.Source%2A> from a remote computer.</span></span> <span data-ttu-id="6be2f-600"><xref:System.Diagnostics.EventLog.DeleteEventSource%2A> 访问指定的计算机上的注册表`machineName`并删除应用程序作为有效的事件源的注册。</span><span class="sxs-lookup"><span data-stu-id="6be2f-600"><xref:System.Diagnostics.EventLog.DeleteEventSource%2A> accesses the registry on the computer specified by `machineName` and removes the registration of your application as a valid source of events.</span></span>  
  
 <span data-ttu-id="6be2f-601">如果你不再需要它来写入该日志条目，则可以删除你的组件作为有效的事件源。</span><span class="sxs-lookup"><span data-stu-id="6be2f-601">You can remove your component as a valid source of events if you no longer need it to write entries to that log.</span></span> <span data-ttu-id="6be2f-602">例如，如果你需要将你的组件从一个日志更改为另一个可能会执行此操作。</span><span class="sxs-lookup"><span data-stu-id="6be2f-602">For example, you might do this if you need to change your component from one log to another.</span></span> <span data-ttu-id="6be2f-603">因为源一次只能注册到一个日志，更改日志，您必须删除当前的注册。</span><span class="sxs-lookup"><span data-stu-id="6be2f-603">Because a source can only be registered to one log at a time, changing the log requires you to remove the current registration.</span></span>  
  
 <span data-ttu-id="6be2f-604"><xref:System.Diagnostics.EventLog.DeleteEventSource%2A> 删除中仅注册到日志的源。</span><span class="sxs-lookup"><span data-stu-id="6be2f-604"><xref:System.Diagnostics.EventLog.DeleteEventSource%2A> removes only the source registered to a log.</span></span> <span data-ttu-id="6be2f-605">如果你想要移除日志本身，调用<xref:System.Diagnostics.EventLog.Delete%2A>。</span><span class="sxs-lookup"><span data-stu-id="6be2f-605">If you want to remove the log itself, call <xref:System.Diagnostics.EventLog.Delete%2A>.</span></span> <span data-ttu-id="6be2f-606">如果你只想要删除的日志条目，调用<xref:System.Diagnostics.EventLog.Clear%2A>。</span><span class="sxs-lookup"><span data-stu-id="6be2f-606">If you only want to delete the log entries, call <xref:System.Diagnostics.EventLog.Clear%2A>.</span></span> <span data-ttu-id="6be2f-607"><xref:System.Diagnostics.EventLog.Delete%2A> 和<xref:System.Diagnostics.EventLog.DeleteEventSource%2A>是`static`方法，以便它们可以调用类本身上。</span><span class="sxs-lookup"><span data-stu-id="6be2f-607"><xref:System.Diagnostics.EventLog.Delete%2A> and <xref:System.Diagnostics.EventLog.DeleteEventSource%2A> are `static` methods, so they can be called on the class itself.</span></span> <span data-ttu-id="6be2f-608">不需要创建的实例<xref:System.Diagnostics.EventLog>调用任何一种方法。</span><span class="sxs-lookup"><span data-stu-id="6be2f-608">It is not necessary to create an instance of <xref:System.Diagnostics.EventLog> to call either method.</span></span>  
  
 <span data-ttu-id="6be2f-609">删除通过调用日志<xref:System.Diagnostics.EventLog.Delete%2A>会自动删除已注册到该日志的源。</span><span class="sxs-lookup"><span data-stu-id="6be2f-609">Deleting a log through a call to <xref:System.Diagnostics.EventLog.Delete%2A> automatically deletes the sources registered to that log.</span></span> <span data-ttu-id="6be2f-610">这会使其他应用程序使用该日志不起作用。</span><span class="sxs-lookup"><span data-stu-id="6be2f-610">This can make other applications using that log inoperative.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="6be2f-611">如果源已映射到某个日志并重新映射到新的日志，必须重新启动计算机才能使更改生效。</span><span class="sxs-lookup"><span data-stu-id="6be2f-611">If a source has already been mapped to a log and you remap it to a new log, you must restart the computer for the changes to take effect.</span></span>  
  
   
  
## Examples  
 <span data-ttu-id="6be2f-612">下面的示例从指定的计算机中删除源。</span><span class="sxs-lookup"><span data-stu-id="6be2f-612">The following example deletes a source from the specified computer.</span></span> <span data-ttu-id="6be2f-613">该示例确定从其源日志，然后删除该日志。</span><span class="sxs-lookup"><span data-stu-id="6be2f-613">The example determines the log from its source, and then deletes the log.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="6be2f-614">多个源可能会写入事件日志。</span><span class="sxs-lookup"><span data-stu-id="6be2f-614">More than one source might write to an event log.</span></span> <span data-ttu-id="6be2f-615">在删除之前自定义日志，请确保没有其他源写入该日志。</span><span class="sxs-lookup"><span data-stu-id="6be2f-615">Before deleting a custom log, make sure there are no other sources writing to that log.</span></span>  
  
 [!code-cpp[Classic EventLog.Delete1 Example#1](~/samples/snippets/cpp/VS_Snippets_CLR_Classic/classic EventLog.Delete1 Example/CPP/source.cpp#1)]
 [!code-csharp[Classic EventLog.Delete1 Example#1](~/samples/snippets/csharp/VS_Snippets_CLR_Classic/classic EventLog.Delete1 Example/CS/source.cs#1)]
 [!code-vb[Classic EventLog.Delete1 Example#1](~/samples/snippets/visualbasic/VS_Snippets_CLR_Classic/classic EventLog.Delete1 Example/VB/source.vb#1)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentException"><span data-ttu-id="6be2f-616"><paramref name="machineName" /> 参数无效。</span><span class="sxs-lookup"><span data-stu-id="6be2f-616">The <paramref name="machineName" /> parameter is invalid.</span></span>  
  
 <span data-ttu-id="6be2f-617">\- 或 -</span><span class="sxs-lookup"><span data-stu-id="6be2f-617">\- or -</span></span>  
  
 <span data-ttu-id="6be2f-618">指定计算机的注册表中不存在 <paramref name="source" /> 参数。</span><span class="sxs-lookup"><span data-stu-id="6be2f-618">The <paramref name="source" /> parameter does not exist in the registry of the specified computer.</span></span>  
  
 <span data-ttu-id="6be2f-619">\- 或 -</span><span class="sxs-lookup"><span data-stu-id="6be2f-619">\- or -</span></span>  
  
 <span data-ttu-id="6be2f-620">您对事件日志的注册表项没有写访问权。</span><span class="sxs-lookup"><span data-stu-id="6be2f-620">You do not have write access on the registry key for the event log.</span></span></exception>
        <exception cref="T:System.InvalidOperationException">
          <span data-ttu-id="6be2f-621">无法删除 <paramref name="source" />，原因是在注册表中，<paramref name="source" /> 的父注册表项不包含与其同名的子项。</span><span class="sxs-lookup"><span data-stu-id="6be2f-621"><paramref name="source" /> cannot be deleted because in the registry, the parent registry key for <paramref name="source" /> does not contain a subkey with the same name.</span></span></exception>
        <permission cref="T:System.Diagnostics.EventLogPermission"><span data-ttu-id="6be2f-622">用于管理的计算机上的事件日志信息。</span><span class="sxs-lookup"><span data-stu-id="6be2f-622">for administering event log information on the computer.</span></span> <span data-ttu-id="6be2f-623">关联的枚举： <see cref="F:System.Diagnostics.EventLogPermissionAccess.Administer" /></span><span class="sxs-lookup"><span data-stu-id="6be2f-623">Associated enumeration: <see cref="F:System.Diagnostics.EventLogPermissionAccess.Administer" /></span></span></permission>
        <altmember cref="Overload:System.Diagnostics.EventLog.CreateEventSource" />
        <altmember cref="P:System.Diagnostics.EventLog.Source" />
        <altmember cref="P:System.Diagnostics.EventLog.MachineName" />
        <altmember cref="M:System.Diagnostics.EventLog.SourceExists(System.String)" />
        <altmember cref="M:System.Diagnostics.EventLog.Delete(System.String)" />
        <altmember cref="M:System.Diagnostics.EventLog.Clear" />
      </Docs>
    </Member>
    <Member MemberName="Dispose">
      <MemberSignature Language="C#" Value="protected override void Dispose (bool disposing);" />
      <MemberSignature Language="ILAsm" Value=".method familyhidebysig virtual instance void Dispose(bool disposing) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Diagnostics.EventLog.Dispose(System.Boolean)" />
      <MemberSignature Language="VB.NET" Value="Protected Overrides Sub Dispose (disposing As Boolean)" />
      <MemberSignature Language="C++ CLI" Value="protected:&#xA; override void Dispose(bool disposing);" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Void</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="disposing" Type="System.Boolean" />
      </Parameters>
      <Docs>
        <param name="disposing">
          <span data-ttu-id="6be2f-624">若要释放托管资源和非托管资源，则为 <see langword="true" />；若仅释放非托管资源，则为 <see langword="false" />。</span><span class="sxs-lookup"><span data-stu-id="6be2f-624"><see langword="true" /> to release both managed and unmanaged resources; <see langword="false" /> to release only unmanaged resources.</span></span></param>
        <summary><span data-ttu-id="6be2f-625">释放由 <see cref="T:System.Diagnostics.EventLog" /> 占用的非托管资源，还可以另外再释放托管资源。</span><span class="sxs-lookup"><span data-stu-id="6be2f-625">Releases the unmanaged resources used by the <see cref="T:System.Diagnostics.EventLog" />, and optionally releases the managed resources.</span></span></summary>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="6be2f-626">此方法称为由公共`Dispose()`方法和<xref:System.Object.Finalize%2A>方法。</span><span class="sxs-lookup"><span data-stu-id="6be2f-626">This method is called by the public `Dispose()` method and the <xref:System.Object.Finalize%2A> method.</span></span> <span data-ttu-id="6be2f-627">`Dispose()` 调用受保护`Dispose(Boolean)`方法替换`disposing`参数设置为`true`。</span><span class="sxs-lookup"><span data-stu-id="6be2f-627">`Dispose()` invokes the protected `Dispose(Boolean)` method with the `disposing` parameter set to `true`.</span></span> <span data-ttu-id="6be2f-628"><xref:System.Object.Finalize%2A> 调用`Dispose`与`disposing`设置为`false`。</span><span class="sxs-lookup"><span data-stu-id="6be2f-628"><xref:System.Object.Finalize%2A> invokes `Dispose` with `disposing` set to `false`.</span></span>  
  
 <span data-ttu-id="6be2f-629">当`disposing`参数为 true 时，此方法释放由任何托管对象持有的全部资源此<xref:System.Diagnostics.EventLog>引用。</span><span class="sxs-lookup"><span data-stu-id="6be2f-629">When the `disposing` parameter is true, this method releases all resources held by any managed objects that this <xref:System.Diagnostics.EventLog> references.</span></span> <span data-ttu-id="6be2f-630">此方法调用每个引用对象的 `Dispose()` 方法。</span><span class="sxs-lookup"><span data-stu-id="6be2f-630">This method invokes the `Dispose()` method of each referenced object.</span></span>  
  
 ]]></format>
        </remarks>
        <block subset="none" type="overrides">
          <para>
            <span data-ttu-id="6be2f-631"><see langword="Dispose" /> 可以由其他对象多次调用。</span><span class="sxs-lookup"><span data-stu-id="6be2f-631"><see langword="Dispose" /> can be called multiple times by other objects.</span></span> <span data-ttu-id="6be2f-632">在重写<see langword="Dispose(Boolean)" />请注意不要引用已释放的以前调用中的对象<see langword="Dispose" />。</span><span class="sxs-lookup"><span data-stu-id="6be2f-632">When overriding <see langword="Dispose(Boolean)" /> be careful not to reference objects that have been previously disposed of in an earlier call to <see langword="Dispose" />.</span></span> <span data-ttu-id="6be2f-633">有关如何实现详细信息<see langword="Dispose(Boolean)" />，请参阅[实现 Dispose 方法](~/docs/standard/garbage-collection/implementing-dispose.md)。</span><span class="sxs-lookup"><span data-stu-id="6be2f-633">For more information about how to implement <see langword="Dispose(Boolean)" />, see [Implementing a Dispose Method](~/docs/standard/garbage-collection/implementing-dispose.md).</span></span>  
  
 <span data-ttu-id="6be2f-634">有关详细信息<see langword="Dispose" />和<see cref="M:System.Object.Finalize" />，请参阅[清洗向上非托管资源](~/docs/standard/garbage-collection/unmanaged.md)。</span><span class="sxs-lookup"><span data-stu-id="6be2f-634">For more information about <see langword="Dispose" /> and <see cref="M:System.Object.Finalize" />, see [Cleaning Up Unmanaged Resources](~/docs/standard/garbage-collection/unmanaged.md).</span></span></para>
        </block>
      </Docs>
    </Member>
    <Member MemberName="EnableRaisingEvents">
      <MemberSignature Language="C#" Value="public bool EnableRaisingEvents { get; set; }" />
      <MemberSignature Language="ILAsm" Value=".property instance bool EnableRaisingEvents" />
      <MemberSignature Language="DocId" Value="P:System.Diagnostics.EventLog.EnableRaisingEvents" />
      <MemberSignature Language="VB.NET" Value="Public Property EnableRaisingEvents As Boolean" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; property bool EnableRaisingEvents { bool get(); void set(bool value); };" />
      <MemberType>Property</MemberType>
      <AssemblyInfo>
        <AssemblyName>System</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Attributes>
        <Attribute>
          <AttributeName>System.ComponentModel.Browsable(false)</AttributeName>
        </Attribute>
        <Attribute>
          <AttributeName>System.ComponentModel.DefaultValue(false)</AttributeName>
        </Attribute>
        <Attribute>
          <AttributeName>System.Diagnostics.MonitoringDescription("If enabled raises event when a log is written.")</AttributeName>
        </Attribute>
      </Attributes>
      <ReturnValue>
        <ReturnType>System.Boolean</ReturnType>
      </ReturnValue>
      <Docs>
        <summary><span data-ttu-id="6be2f-635">获取或设置一个值，用以指示 <see cref="T:System.Diagnostics.EventLog" /> 是否接收 <see cref="E:System.Diagnostics.EventLog.EntryWritten" /> 事件通知。</span><span class="sxs-lookup"><span data-stu-id="6be2f-635">Gets or sets a value indicating whether the <see cref="T:System.Diagnostics.EventLog" /> receives <see cref="E:System.Diagnostics.EventLog.EntryWritten" /> event notifications.</span></span></summary>
        <value>
          <span data-ttu-id="6be2f-636">如果 <see cref="T:System.Diagnostics.EventLog" /> 在有项写入日志时接收通知，则为 <see langword="true" />；否则为 <see langword="false" />。</span><span class="sxs-lookup"><span data-stu-id="6be2f-636"><see langword="true" /> if the <see cref="T:System.Diagnostics.EventLog" /> receives notification when an entry is written to the log; otherwise, <see langword="false" />.</span></span></value>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="6be2f-637"><xref:System.Diagnostics.EventLog.EnableRaisingEvents%2A>属性确定是否<xref:System.Diagnostics.EventLog>条目写入到日志时引发事件。</span><span class="sxs-lookup"><span data-stu-id="6be2f-637">The <xref:System.Diagnostics.EventLog.EnableRaisingEvents%2A> property determines whether the <xref:System.Diagnostics.EventLog> raises events when entries are written to the log.</span></span> <span data-ttu-id="6be2f-638">当该属性是`true`，接收组件<xref:System.Diagnostics.EventLog.EntryWritten>事件将收到通知任何时间在指定的日志中写入一项<xref:System.Diagnostics.EventLog.Log%2A>属性。</span><span class="sxs-lookup"><span data-stu-id="6be2f-638">When the property is `true`, components that receive the <xref:System.Diagnostics.EventLog.EntryWritten> event will receive notification any time an entry is written to the log that is specified in the <xref:System.Diagnostics.EventLog.Log%2A> property.</span></span> <span data-ttu-id="6be2f-639">如果<xref:System.Diagnostics.EventLog.EnableRaisingEvents%2A>是`false`，会引发任何事件。</span><span class="sxs-lookup"><span data-stu-id="6be2f-639">If <xref:System.Diagnostics.EventLog.EnableRaisingEvents%2A> is `false`, no events are raised.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="6be2f-640">仅在本地计算机上写入项时，可以接收事件通知。</span><span class="sxs-lookup"><span data-stu-id="6be2f-640">You can receive event notifications only when entries are written on the local computer.</span></span> <span data-ttu-id="6be2f-641">无法接收在远程计算机上写入项的通知。</span><span class="sxs-lookup"><span data-stu-id="6be2f-641">You cannot receive notifications for entries written on remote computers.</span></span>  
  
   
  
## Examples  
 <span data-ttu-id="6be2f-642">下面的示例处理<xref:System.Diagnostics.EventLog.EntryWritten>事件。</span><span class="sxs-lookup"><span data-stu-id="6be2f-642">The following example handles an <xref:System.Diagnostics.EventLog.EntryWritten> event.</span></span>  
  
 [!code-cpp[Classic EventLog.EnableRaisingEvents Example#1](~/samples/snippets/cpp/VS_Snippets_CLR_Classic/classic EventLog.EnableRaisingEvents Example/CPP/source.cpp#1)]
 [!code-csharp[Classic EventLog.EnableRaisingEvents Example#1](~/samples/snippets/csharp/VS_Snippets_CLR_Classic/classic EventLog.EnableRaisingEvents Example/CS/source.cs#1)]
 [!code-vb[Classic EventLog.EnableRaisingEvents Example#1](~/samples/snippets/visualbasic/VS_Snippets_CLR_Classic/classic EventLog.EnableRaisingEvents Example/VB/source.vb#1)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.InvalidOperationException"><span data-ttu-id="6be2f-643">事件日志位于远程计算机上。</span><span class="sxs-lookup"><span data-stu-id="6be2f-643">The event log is on a remote computer.</span></span></exception>
        <permission cref="T:System.Diagnostics.EventLogPermission"><span data-ttu-id="6be2f-644">用于写入的计算机上的事件日志信息。</span><span class="sxs-lookup"><span data-stu-id="6be2f-644">for writing the event log information on the computer.</span></span> <span data-ttu-id="6be2f-645">关联的枚举： <see cref="F:System.Diagnostics.EventLogPermissionAccess.Write" /></span><span class="sxs-lookup"><span data-stu-id="6be2f-645">Associated enumeration: <see cref="F:System.Diagnostics.EventLogPermissionAccess.Write" /></span></span></permission>
        <altmember cref="E:System.Diagnostics.EventLog.EntryWritten" />
      </Docs>
    </Member>
    <Member MemberName="EndInit">
      <MemberSignature Language="C#" Value="public void EndInit ();" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig newslot virtual instance void EndInit() cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Diagnostics.EventLog.EndInit" />
      <MemberSignature Language="VB.NET" Value="Public Sub EndInit ()" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; virtual void EndInit();" />
      <MemberType>Method</MemberType>
      <Implements>
        <InterfaceMember>M:System.ComponentModel.ISupportInitialize.EndInit</InterfaceMember>
      </Implements>
      <AssemblyInfo>
        <AssemblyName>System</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Void</ReturnType>
      </ReturnValue>
      <Parameters />
      <Docs>
        <summary><span data-ttu-id="6be2f-646">结束用于窗体或由其他组件使用的 <see cref="T:System.Diagnostics.EventLog" /> 的初始化。</span><span class="sxs-lookup"><span data-stu-id="6be2f-646">Ends the initialization of an <see cref="T:System.Diagnostics.EventLog" /> used on a form or by another component.</span></span> <span data-ttu-id="6be2f-647">此初始化在运行时发生。</span><span class="sxs-lookup"><span data-stu-id="6be2f-647">The initialization occurs at runtime.</span></span></summary>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="6be2f-648">[!INCLUDE[vsprvslong](~/includes/vsprvslong-md.md)]设计环境使用此方法来结束使用窗体或由另一个组件的组件的初始化。</span><span class="sxs-lookup"><span data-stu-id="6be2f-648">The [!INCLUDE[vsprvslong](~/includes/vsprvslong-md.md)] design environment uses this method to end the initialization of a component used on a form or by another component.</span></span> <span data-ttu-id="6be2f-649"><xref:System.Diagnostics.EventLog.BeginInit%2A>方法开始初始化。</span><span class="sxs-lookup"><span data-stu-id="6be2f-649">The <xref:System.Diagnostics.EventLog.BeginInit%2A> method starts the initialization.</span></span> <span data-ttu-id="6be2f-650">使用<xref:System.Diagnostics.EventLog.BeginInit%2A>和<xref:System.Diagnostics.EventLog.EndInit%2A>方法阻止控件完全初始化之前使用。</span><span class="sxs-lookup"><span data-stu-id="6be2f-650">Using the <xref:System.Diagnostics.EventLog.BeginInit%2A> and <xref:System.Diagnostics.EventLog.EndInit%2A> methods prevents the control from being used before it is fully initialized.</span></span>  
  
 ]]></format>
        </remarks>
        <permission cref="T:System.Diagnostics.EventLogPermission"><span data-ttu-id="6be2f-651">用于写入的计算机上的事件日志信息。</span><span class="sxs-lookup"><span data-stu-id="6be2f-651">for writing the event log information on the computer.</span></span> <span data-ttu-id="6be2f-652">关联的枚举： <see cref="F:System.Diagnostics.EventLogPermissionAccess.Write" /></span><span class="sxs-lookup"><span data-stu-id="6be2f-652">Associated enumeration: <see cref="F:System.Diagnostics.EventLogPermissionAccess.Write" /></span></span></permission>
        <altmember cref="M:System.Diagnostics.EventLog.BeginInit" />
      </Docs>
    </Member>
    <Member MemberName="Entries">
      <MemberSignature Language="C#" Value="public System.Diagnostics.EventLogEntryCollection Entries { get; }" />
      <MemberSignature Language="ILAsm" Value=".property instance class System.Diagnostics.EventLogEntryCollection Entries" />
      <MemberSignature Language="DocId" Value="P:System.Diagnostics.EventLog.Entries" />
      <MemberSignature Language="VB.NET" Value="Public ReadOnly Property Entries As EventLogEntryCollection" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; property System::Diagnostics::EventLogEntryCollection ^ Entries { System::Diagnostics::EventLogEntryCollection ^ get(); };" />
      <MemberType>Property</MemberType>
      <AssemblyInfo>
        <AssemblyName>System</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Attributes>
        <Attribute>
          <AttributeName>System.ComponentModel.Browsable(false)</AttributeName>
        </Attribute>
        <Attribute>
          <AttributeName>System.ComponentModel.DesignerSerializationVisibility(System.ComponentModel.DesignerSerializationVisibility.Hidden)</AttributeName>
        </Attribute>
        <Attribute>
          <AttributeName>System.Diagnostics.MonitoringDescription("The entries in the log.")</AttributeName>
        </Attribute>
      </Attributes>
      <ReturnValue>
        <ReturnType>System.Diagnostics.EventLogEntryCollection</ReturnType>
      </ReturnValue>
      <Docs>
        <summary><span data-ttu-id="6be2f-653">获取事件日志的内容。</span><span class="sxs-lookup"><span data-stu-id="6be2f-653">Gets the contents of the event log.</span></span></summary>
        <value><span data-ttu-id="6be2f-654"><see cref="T:System.Diagnostics.EventLogEntryCollection" />，保留事件日志中的项。</span><span class="sxs-lookup"><span data-stu-id="6be2f-654">An <see cref="T:System.Diagnostics.EventLogEntryCollection" /> holding the entries in the event log.</span></span> <span data-ttu-id="6be2f-655">每个项均与 <see cref="T:System.Diagnostics.EventLogEntry" /> 类的一个实例关联。</span><span class="sxs-lookup"><span data-stu-id="6be2f-655">Each entry is associated with an instance of the <see cref="T:System.Diagnostics.EventLogEntry" /> class.</span></span></value>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="6be2f-656">使用<xref:System.Diagnostics.EventLog.Entries%2A>成员从事件日志中读取时。</span><span class="sxs-lookup"><span data-stu-id="6be2f-656">Use the <xref:System.Diagnostics.EventLog.Entries%2A> member when reading from the event log.</span></span>  
  
 <span data-ttu-id="6be2f-657">因为该属性是只读的不能修改一项或写入日志使用<xref:System.Diagnostics.EventLog.Entries%2A>。</span><span class="sxs-lookup"><span data-stu-id="6be2f-657">Because the property is read-only, you cannot modify an entry or write to the log using <xref:System.Diagnostics.EventLog.Entries%2A>.</span></span> <span data-ttu-id="6be2f-658">相反，指定<xref:System.Diagnostics.EventLog.Source%2A>并调用<xref:System.Diagnostics.EventLog.WriteEntry%2A>写入新的日志项。</span><span class="sxs-lookup"><span data-stu-id="6be2f-658">Instead, specify a <xref:System.Diagnostics.EventLog.Source%2A> and call <xref:System.Diagnostics.EventLog.WriteEntry%2A> to write a new log entry.</span></span> <span data-ttu-id="6be2f-659">你可以使用<xref:System.Diagnostics.EventLog.Entries%2A>若要计算的事件日志中的条目数并查看每个<xref:System.Diagnostics.EventLogEntry>集合中。</span><span class="sxs-lookup"><span data-stu-id="6be2f-659">You can use <xref:System.Diagnostics.EventLog.Entries%2A> to count the number of entries in the event log, and view each <xref:System.Diagnostics.EventLogEntry> in the collection.</span></span> <span data-ttu-id="6be2f-660">使用索引<xref:System.Diagnostics.EventLogEntryCollection.Item%2A>成员，如检索有关特定条目，信息<xref:System.Diagnostics.EventLogEntry.Message%2A>， <xref:System.Diagnostics.EventLogEntry.Category%2A>， <xref:System.Diagnostics.EventLogEntry.TimeWritten%2A>，或<xref:System.Diagnostics.EventLogEntry.EntryType%2A>。</span><span class="sxs-lookup"><span data-stu-id="6be2f-660">Use the indexed <xref:System.Diagnostics.EventLogEntryCollection.Item%2A> member to retrieve information about a specific entry, such as <xref:System.Diagnostics.EventLogEntry.Message%2A>, <xref:System.Diagnostics.EventLogEntry.Category%2A>, <xref:System.Diagnostics.EventLogEntry.TimeWritten%2A>, or <xref:System.Diagnostics.EventLogEntry.EntryType%2A>.</span></span>  
  
 <span data-ttu-id="6be2f-661">不需要指定<xref:System.Diagnostics.EventLog.Source%2A>时仅从日志中读取。</span><span class="sxs-lookup"><span data-stu-id="6be2f-661">It is not necessary to specify a <xref:System.Diagnostics.EventLog.Source%2A> when only reading from a log.</span></span> <span data-ttu-id="6be2f-662">你可以仅指定<xref:System.Diagnostics.EventLog.Log%2A>名称和<xref:System.Diagnostics.EventLog.MachineName%2A>（服务器计算机名称） 属性<xref:System.Diagnostics.EventLog>实例。</span><span class="sxs-lookup"><span data-stu-id="6be2f-662">You can specify only the <xref:System.Diagnostics.EventLog.Log%2A> name and <xref:System.Diagnostics.EventLog.MachineName%2A> (server computer name) properties for the <xref:System.Diagnostics.EventLog> instance.</span></span> <span data-ttu-id="6be2f-663">在任一情况下，<xref:System.Diagnostics.EventLog.Entries%2A>成员会自动填充的条目的事件日志的列表。</span><span class="sxs-lookup"><span data-stu-id="6be2f-663">In either case, the <xref:System.Diagnostics.EventLog.Entries%2A> member is automatically populated with the event log's list of entries.</span></span> <span data-ttu-id="6be2f-664">此列表以读取各个项中，可以选择适当的索引的项。</span><span class="sxs-lookup"><span data-stu-id="6be2f-664">You can select the appropriate index for an item in this list to read individual entries.</span></span>  
  
 <span data-ttu-id="6be2f-665">读取和写入日志项之间的一个重要区别在于不需要显式调用读取的方法。</span><span class="sxs-lookup"><span data-stu-id="6be2f-665">An important distinction between reading and writing log entries is that it is not necessary to explicitly call a read method.</span></span> <span data-ttu-id="6be2f-666">后<xref:System.Diagnostics.EventLog.Log%2A>和<xref:System.Diagnostics.EventLog.MachineName%2A>指定，<xref:System.Diagnostics.EventLog.Entries%2A>属性自动填充。</span><span class="sxs-lookup"><span data-stu-id="6be2f-666">After the <xref:System.Diagnostics.EventLog.Log%2A> and <xref:System.Diagnostics.EventLog.MachineName%2A> are specified, the <xref:System.Diagnostics.EventLog.Entries%2A> property is automatically populated.</span></span> <span data-ttu-id="6be2f-667">如果你更改的值<xref:System.Diagnostics.EventLog.Log%2A>或<xref:System.Diagnostics.EventLog.MachineName%2A>属性，<xref:System.Diagnostics.EventLog.Entries%2A>属性重新填充你阅读下一次。</span><span class="sxs-lookup"><span data-stu-id="6be2f-667">If you change the value of the <xref:System.Diagnostics.EventLog.Log%2A> or <xref:System.Diagnostics.EventLog.MachineName%2A> property, the <xref:System.Diagnostics.EventLog.Entries%2A> property is repopulated the next time you read it.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="6be2f-668">你不需要指定<xref:System.Diagnostics.EventLog.MachineName%2A>如果要连接到日志。</span><span class="sxs-lookup"><span data-stu-id="6be2f-668">You are not required to specify the <xref:System.Diagnostics.EventLog.MachineName%2A> if you are connecting to a log.</span></span> <span data-ttu-id="6be2f-669">如果不指定<xref:System.Diagnostics.EventLog.MachineName%2A>，本地计算机，"。"，则假定。</span><span class="sxs-lookup"><span data-stu-id="6be2f-669">If you do not specify the <xref:System.Diagnostics.EventLog.MachineName%2A>, the local computer, ".", is assumed.</span></span>  
  
   
  
## Examples  
 <span data-ttu-id="6be2f-670">下面的示例读取在事件日志中，"MyNewLog"本地计算机上的项。</span><span class="sxs-lookup"><span data-stu-id="6be2f-670">The following example reads entries in the event log, "MyNewLog", on the local computer.</span></span>  
  
 [!code-cpp[Classic EventLog.Entries Example#1](~/samples/snippets/cpp/VS_Snippets_CLR_Classic/classic EventLog.Entries Example/CPP/source.cpp#1)]
 [!code-csharp[Classic EventLog.Entries Example#1](~/samples/snippets/csharp/VS_Snippets_CLR_Classic/classic EventLog.Entries Example/CS/source.cs#1)]
 [!code-vb[Classic EventLog.Entries Example#1](~/samples/snippets/visualbasic/VS_Snippets_CLR_Classic/classic EventLog.Entries Example/VB/source.vb#1)]  
  
 ]]></format>
        </remarks>
        <permission cref="T:System.Diagnostics.EventLogPermission"><span data-ttu-id="6be2f-671">用于管理的计算机上的事件日志信息。</span><span class="sxs-lookup"><span data-stu-id="6be2f-671">for administering event log information on the computer.</span></span> <span data-ttu-id="6be2f-672">关联的枚举： <see cref="F:System.Diagnostics.EventLogPermissionAccess.Administer" /></span><span class="sxs-lookup"><span data-stu-id="6be2f-672">Associated enumeration: <see cref="F:System.Diagnostics.EventLogPermissionAccess.Administer" /></span></span></permission>
        <altmember cref="T:System.Diagnostics.EventLogEntryCollection" />
        <altmember cref="T:System.Diagnostics.EventLogEntry" />
        <altmember cref="P:System.Diagnostics.EventLog.Source" />
        <altmember cref="P:System.Diagnostics.EventLog.Log" />
        <altmember cref="P:System.Diagnostics.EventLog.MachineName" />
        <altmember cref="Overload:System.Diagnostics.EventLog.WriteEntry" />
      </Docs>
    </Member>
    <Member MemberName="EntryWritten">
      <MemberSignature Language="C#" Value="public event System.Diagnostics.EntryWrittenEventHandler EntryWritten;" />
      <MemberSignature Language="ILAsm" Value=".event class System.Diagnostics.EntryWrittenEventHandler EntryWritten" />
      <MemberSignature Language="DocId" Value="E:System.Diagnostics.EventLog.EntryWritten" />
      <MemberSignature Language="VB.NET" Value="Public Custom Event EntryWritten As EntryWrittenEventHandler " />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; event System::Diagnostics::EntryWrittenEventHandler ^ EntryWritten;" />
      <MemberType>Event</MemberType>
      <AssemblyInfo>
        <AssemblyName>System</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Attributes>
        <Attribute>
          <AttributeName>System.Diagnostics.MonitoringDescription("Raised for each EventLog entry written.")</AttributeName>
        </Attribute>
      </Attributes>
      <ReturnValue>
        <ReturnType>System.Diagnostics.EntryWrittenEventHandler</ReturnType>
      </ReturnValue>
      <Docs>
        <summary><span data-ttu-id="6be2f-673">向本地计算机上的事件日志写入项时发生。</span><span class="sxs-lookup"><span data-stu-id="6be2f-673">Occurs when an entry is written to an event log on the local computer.</span></span></summary>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="6be2f-674">若要获取事件通知，必须设置<xref:System.Diagnostics.EventLog.EnableRaisingEvents%2A>到`true`。</span><span class="sxs-lookup"><span data-stu-id="6be2f-674">To get event notifications, you must set <xref:System.Diagnostics.EventLog.EnableRaisingEvents%2A> to `true`.</span></span> <span data-ttu-id="6be2f-675">只有在本地计算机上写入项时，只能接收事件通知。</span><span class="sxs-lookup"><span data-stu-id="6be2f-675">You can only receive event notifications when entries are written on the local computer.</span></span> <span data-ttu-id="6be2f-676">无法接收在远程计算机上写入项的通知。</span><span class="sxs-lookup"><span data-stu-id="6be2f-676">You cannot receive notifications for entries written on remote computers.</span></span>  
  
 <span data-ttu-id="6be2f-677">创建 <xref:System.Diagnostics.EventLog.EntryWritten> 委托时，需要标识将要处理该事件的方法。</span><span class="sxs-lookup"><span data-stu-id="6be2f-677">When you create an <xref:System.Diagnostics.EventLog.EntryWritten> delegate, you identify the method that will handle the event.</span></span> <span data-ttu-id="6be2f-678">若要将事件与事件处理程序关联，请将该委托的一个实例添加到事件中。</span><span class="sxs-lookup"><span data-stu-id="6be2f-678">To associate the event with your event handler, add an instance of the delegate to the event.</span></span> <span data-ttu-id="6be2f-679">每当发生该事件时，直到移除了该委托，都会调用事件处理程序。</span><span class="sxs-lookup"><span data-stu-id="6be2f-679">The event handler is called whenever the event occurs, until you remove the delegate.</span></span> <span data-ttu-id="6be2f-680">有关与委托一起处理事件的详细信息，请参阅[处理和引发事件](~/docs/standard/events/index.md)。</span><span class="sxs-lookup"><span data-stu-id="6be2f-680">For more information about handling events with delegates, see [Handling and Raising Events](~/docs/standard/events/index.md).</span></span>  
  
 <span data-ttu-id="6be2f-681">系统响应<xref:System.Diagnostics.EventLog.WriteEntry%2A>仅当最后一个写入事件发生至少为六秒以前。</span><span class="sxs-lookup"><span data-stu-id="6be2f-681">The system responds to <xref:System.Diagnostics.EventLog.WriteEntry%2A> only if the last write event occurred at least six seconds previously.</span></span> <span data-ttu-id="6be2f-682">这意味着你将仅收到一个<xref:System.Diagnostics.EventLog.EntryWritten>六秒间隔内的事件通知，即使多个事件日志更改时发生。</span><span class="sxs-lookup"><span data-stu-id="6be2f-682">This implies you will only receive one <xref:System.Diagnostics.EventLog.EntryWritten> event notification within a six-second interval, even if more than one event log change occurs.</span></span> <span data-ttu-id="6be2f-683">如果插入到的调用之间的足够长的休眠时间间隔 （大约为 10 秒钟） <xref:System.Diagnostics.EventLog.WriteEntry%2A>，你不太可能丢失事件。</span><span class="sxs-lookup"><span data-stu-id="6be2f-683">If you insert a sufficiently long sleep interval (around 10 seconds) between calls to <xref:System.Diagnostics.EventLog.WriteEntry%2A>, you are less likely to miss an event.</span></span> <span data-ttu-id="6be2f-684">但是，如果更频繁地发生写入事件，你可能无法收到事件通知，直到下一个间隔。</span><span class="sxs-lookup"><span data-stu-id="6be2f-684">However, if write events occur more frequently, you might not recieve the event notification until the next interval.</span></span> <span data-ttu-id="6be2f-685">通常情况下，丢失的事件通知将不丢失，而延迟。</span><span class="sxs-lookup"><span data-stu-id="6be2f-685">Typically, missed event notifications are not lost, but delayed.</span></span>  
  
   
  
## Examples  
 <span data-ttu-id="6be2f-686">下面的示例处理一个项写入事件。</span><span class="sxs-lookup"><span data-stu-id="6be2f-686">The following example handles an entry written event.</span></span>  
  
 [!code-cpp[Classic EventLog.EntryWritten Example#1](~/samples/snippets/cpp/VS_Snippets_CLR_Classic/classic EventLog.EntryWritten Example/CPP/source.cpp#1)]
 [!code-csharp[Classic EventLog.EntryWritten Example#1](~/samples/snippets/csharp/VS_Snippets_CLR_Classic/classic EventLog.EntryWritten Example/CS/source.cs#1)]
 [!code-vb[Classic EventLog.EntryWritten Example#1](~/samples/snippets/visualbasic/VS_Snippets_CLR_Classic/classic EventLog.EntryWritten Example/VB/source.vb#1)]  
  
 ]]></format>
        </remarks>
        <permission cref="T:System.Diagnostics.EventLogPermission"><span data-ttu-id="6be2f-687">用于管理的计算机上的事件日志信息。</span><span class="sxs-lookup"><span data-stu-id="6be2f-687">for administering event log information on the computer.</span></span> <span data-ttu-id="6be2f-688">关联的枚举： <see cref="F:System.Diagnostics.EventLogPermissionAccess.Administer" /></span><span class="sxs-lookup"><span data-stu-id="6be2f-688">Associated enumeration: <see cref="F:System.Diagnostics.EventLogPermissionAccess.Administer" /></span></span></permission>
        <altmember cref="P:System.Diagnostics.EventLog.EnableRaisingEvents" />
      </Docs>
    </Member>
    <MemberGroup MemberName="Exists">
      <AssemblyInfo>
        <AssemblyName>System</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Docs>
        <summary><span data-ttu-id="6be2f-689">确定指定的日志是否存在。</span><span class="sxs-lookup"><span data-stu-id="6be2f-689">Determines whether the specified log exists.</span></span></summary>
      </Docs>
    </MemberGroup>
    <Member MemberName="Exists">
      <MemberSignature Language="C#" Value="public static bool Exists (string logName);" />
      <MemberSignature Language="ILAsm" Value=".method public static hidebysig bool Exists(string logName) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Diagnostics.EventLog.Exists(System.String)" />
      <MemberSignature Language="VB.NET" Value="Public Shared Function Exists (logName As String) As Boolean" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; static bool Exists(System::String ^ logName);" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Boolean</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="logName" Type="System.String" />
      </Parameters>
      <Docs>
        <param name="logName"><span data-ttu-id="6be2f-690">要搜索的日志的名称。</span><span class="sxs-lookup"><span data-stu-id="6be2f-690">The name of the log to search for.</span></span> <span data-ttu-id="6be2f-691">可能的值包括：“应用程序”、“安全性”、“系统”、其他应用程序特定的日志（如与 Active Directory 关联的日志）或计算机上的任何自定义日志。</span><span class="sxs-lookup"><span data-stu-id="6be2f-691">Possible values include: Application, Security, System, other application-specific logs (such as those associated with Active Directory), or any custom log on the computer.</span></span></param>
        <summary><span data-ttu-id="6be2f-692">确定该日志是否存在于本地计算机上。</span><span class="sxs-lookup"><span data-stu-id="6be2f-692">Determines whether the log exists on the local computer.</span></span></summary>
        <returns>
          <span data-ttu-id="6be2f-693">如果该日志存在于本地计算机上，则为 <see langword="true" />；否则为 <see langword="false" />。</span><span class="sxs-lookup"><span data-stu-id="6be2f-693"><see langword="true" /> if the log exists on the local computer; otherwise, <see langword="false" />.</span></span></returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="6be2f-694">此方法用于确定本地计算机上是否存在日志。</span><span class="sxs-lookup"><span data-stu-id="6be2f-694">Use this method to determine if a log exists on the local computer.</span></span> <span data-ttu-id="6be2f-695">如果你想要确定是否在本地计算机上，使用存在的源<xref:System.Diagnostics.EventLog.SourceExists%2A>。</span><span class="sxs-lookup"><span data-stu-id="6be2f-695">If you want to determine whether a source exists on the local computer, use <xref:System.Diagnostics.EventLog.SourceExists%2A>.</span></span>  
  
 <span data-ttu-id="6be2f-696">因为此方法访问注册表，你必须在本地计算机，则具有相应的注册表权限否则，查询将返回`false`。</span><span class="sxs-lookup"><span data-stu-id="6be2f-696">Because this method accesses the registry, you must have the appropriate registry permissions on the local computer; otherwise, the query returns `false`.</span></span>  
  
 <span data-ttu-id="6be2f-697">因为你无法在同一台计算机上为新的日志的现有的日志名称，使用此方法之前创建新的日志以确定是否指定`logName`本地计算机上已存在。</span><span class="sxs-lookup"><span data-stu-id="6be2f-697">Because you cannot give a new log the name of an existing log on the same computer, use this method before creating a new log to determine if the specified `logName` already exists on the local computer.</span></span> <span data-ttu-id="6be2f-698">`logName`参数不区分大小写。</span><span class="sxs-lookup"><span data-stu-id="6be2f-698">The `logName` parameter is not case sensitive.</span></span>  
  
 <span data-ttu-id="6be2f-699"><xref:System.Diagnostics.EventLog.Exists%2A> 是`static`方法，使其可以调用类本身上。</span><span class="sxs-lookup"><span data-stu-id="6be2f-699"><xref:System.Diagnostics.EventLog.Exists%2A> is a `static` method, so it can be called on the class itself.</span></span> <span data-ttu-id="6be2f-700">不需要创建的实例<xref:System.Diagnostics.EventLog>调用<xref:System.Diagnostics.EventLog.Exists%2A>。</span><span class="sxs-lookup"><span data-stu-id="6be2f-700">It is not necessary to create an instance of <xref:System.Diagnostics.EventLog> to call <xref:System.Diagnostics.EventLog.Exists%2A>.</span></span>  
  
   
  
## Examples  
 [!code-cpp[EventLog_Exists_1#1](~/samples/snippets/cpp/VS_Snippets_CLR/EventLog_Exists_1/CPP/eventlog_exists_1.cpp#1)]
 [!code-csharp[EventLog_Exists_1#1](~/samples/snippets/csharp/VS_Snippets_CLR/EventLog_Exists_1/CS/eventlog_exists_1.cs#1)]
 [!code-vb[EventLog_Exists_1#1](~/samples/snippets/visualbasic/VS_Snippets_CLR/EventLog_Exists_1/VB/eventlog_exists_1.vb#1)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentException"><span data-ttu-id="6be2f-701">logName 为 <see langword="null" /> 或该值为空。</span><span class="sxs-lookup"><span data-stu-id="6be2f-701">The logName is <see langword="null" /> or the value is empty.</span></span></exception>
        <permission cref="T:System.Diagnostics.EventLogPermission"><span data-ttu-id="6be2f-702">用于管理的计算机上的事件日志信息。</span><span class="sxs-lookup"><span data-stu-id="6be2f-702">for administering event log information on the computer.</span></span> <span data-ttu-id="6be2f-703">关联的枚举： <see cref="F:System.Diagnostics.EventLogPermissionAccess.Administer" /></span><span class="sxs-lookup"><span data-stu-id="6be2f-703">Associated enumeration: <see cref="F:System.Diagnostics.EventLogPermissionAccess.Administer" /></span></span></permission>
        <altmember cref="Overload:System.Diagnostics.EventLog.CreateEventSource" />
        <altmember cref="M:System.Diagnostics.EventLog.Delete(System.String)" />
        <altmember cref="M:System.Diagnostics.EventLog.SourceExists(System.String)" />
        <altmember cref="P:System.Diagnostics.EventLog.Log" />
      </Docs>
    </Member>
    <Member MemberName="Exists">
      <MemberSignature Language="C#" Value="public static bool Exists (string logName, string machineName);" />
      <MemberSignature Language="ILAsm" Value=".method public static hidebysig bool Exists(string logName, string machineName) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Diagnostics.EventLog.Exists(System.String,System.String)" />
      <MemberSignature Language="VB.NET" Value="Public Shared Function Exists (logName As String, machineName As String) As Boolean" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; static bool Exists(System::String ^ logName, System::String ^ machineName);" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Attributes>
        <Attribute>
          <AttributeName>System.MonoNotSupported("remote machine is not supported")</AttributeName>
        </Attribute>
      </Attributes>
      <ReturnValue>
        <ReturnType>System.Boolean</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="logName" Type="System.String" />
        <Parameter Name="machineName" Type="System.String" />
      </Parameters>
      <Docs>
        <param name="logName"><span data-ttu-id="6be2f-704">要搜索的日志。</span><span class="sxs-lookup"><span data-stu-id="6be2f-704">The log for which to search.</span></span> <span data-ttu-id="6be2f-705">可能的值包括：“应用程序”、“安全性”、“系统”、其他应用程序特定的日志（如与 Active Directory 关联的日志）或计算机上的任何自定义日志。</span><span class="sxs-lookup"><span data-stu-id="6be2f-705">Possible values include: Application, Security, System, other application-specific logs (such as those associated with Active Directory), or any custom log on the computer.</span></span></param>
        <param name="machineName"><span data-ttu-id="6be2f-706">要在其上搜索日志的计算机的名称，对于本地计算机则为“.”。</span><span class="sxs-lookup"><span data-stu-id="6be2f-706">The name of the computer on which to search for the log, or "." for the local computer.</span></span></param>
        <summary><span data-ttu-id="6be2f-707">确定该日志是否存在于指定计算机上。</span><span class="sxs-lookup"><span data-stu-id="6be2f-707">Determines whether the log exists on the specified computer.</span></span></summary>
        <returns>
          <span data-ttu-id="6be2f-708">如果该日志存在于指定的计算机上，则为 <see langword="true" />；否则为 <see langword="false" />。</span><span class="sxs-lookup"><span data-stu-id="6be2f-708"><see langword="true" /> if the log exists on the specified computer; otherwise, <see langword="false" />.</span></span></returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="6be2f-709">使用此方法以确定远程计算机上是否存在日志。</span><span class="sxs-lookup"><span data-stu-id="6be2f-709">Use this method to determine if a log exists on a remote computer.</span></span> <span data-ttu-id="6be2f-710">如果你想要确定源是否存在的远程计算机上，使用<xref:System.Diagnostics.EventLog.SourceExists%2A>。</span><span class="sxs-lookup"><span data-stu-id="6be2f-710">If you want to determine whether a source exists on a remote computer, use <xref:System.Diagnostics.EventLog.SourceExists%2A>.</span></span>  
  
 <span data-ttu-id="6be2f-711">因为此方法访问注册表，你必须指定计算机上具有相应的注册表权限否则，查询将返回`false`。</span><span class="sxs-lookup"><span data-stu-id="6be2f-711">Because this method accesses the registry, you must have the appropriate registry permissions on the specified computer; otherwise, the query returns `false`.</span></span>  
  
 <span data-ttu-id="6be2f-712">由于你无法在同一台计算机上为新的日志的现有的日志名称，使用此方法在创建新日志之前确定如果一个具有指定`logName`按指定的服务器上已存在`machineName`参数。</span><span class="sxs-lookup"><span data-stu-id="6be2f-712">Because you cannot give a new log the name of an existing log on the same computer, use this method before creating a new log to determine if one with the specified `logName` already exists on the server specified by the `machineName` parameter.</span></span> <span data-ttu-id="6be2f-713">`logName`和`machineName`参数不区分大小写。</span><span class="sxs-lookup"><span data-stu-id="6be2f-713">The `logName` and `machineName` parameters are not case sensitive.</span></span>  
  
 <span data-ttu-id="6be2f-714"><xref:System.Diagnostics.EventLog.Exists%2A> 是`static`方法，使其可以调用类本身上。</span><span class="sxs-lookup"><span data-stu-id="6be2f-714"><xref:System.Diagnostics.EventLog.Exists%2A> is a `static` method, so it can be called on the class itself.</span></span> <span data-ttu-id="6be2f-715">不需要创建的新实例<xref:System.Diagnostics.EventLog>调用<xref:System.Diagnostics.EventLog.Exists%2A>。</span><span class="sxs-lookup"><span data-stu-id="6be2f-715">It is not necessary to create a new instance of <xref:System.Diagnostics.EventLog> to call <xref:System.Diagnostics.EventLog.Exists%2A>.</span></span>  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentException"><span data-ttu-id="6be2f-716"><paramref name="machineName" /> 参数的格式无效。</span><span class="sxs-lookup"><span data-stu-id="6be2f-716">The <paramref name="machineName" /> parameter is an invalid format.</span></span> <span data-ttu-id="6be2f-717">请确保对在其上执行搜索的计算机使用了正确的语法。</span><span class="sxs-lookup"><span data-stu-id="6be2f-717">Make sure you have used proper syntax for the computer on which you are searching.</span></span>  
  
 <span data-ttu-id="6be2f-718">或</span><span class="sxs-lookup"><span data-stu-id="6be2f-718">-or-</span></span>  
  
 <span data-ttu-id="6be2f-719"><paramref name="logName" /> 为 <see langword="null" /> 或该值为空。</span><span class="sxs-lookup"><span data-stu-id="6be2f-719">The <paramref name="logName" /> is <see langword="null" /> or the value is empty.</span></span></exception>
        <permission cref="T:System.Diagnostics.EventLogPermission"><span data-ttu-id="6be2f-720">用于管理的计算机上的事件日志信息。</span><span class="sxs-lookup"><span data-stu-id="6be2f-720">for administering event log information on the computer.</span></span> <span data-ttu-id="6be2f-721">关联的枚举： <see cref="F:System.Diagnostics.EventLogPermissionAccess.Administer" /></span><span class="sxs-lookup"><span data-stu-id="6be2f-721">Associated enumeration: <see cref="F:System.Diagnostics.EventLogPermissionAccess.Administer" /></span></span></permission>
        <altmember cref="Overload:System.Diagnostics.EventLog.CreateEventSource" />
        <altmember cref="M:System.Diagnostics.EventLog.Delete(System.String)" />
        <altmember cref="M:System.Diagnostics.EventLog.SourceExists(System.String)" />
        <altmember cref="P:System.Diagnostics.EventLog.Log" />
        <altmember cref="P:System.Diagnostics.EventLog.MachineName" />
      </Docs>
    </Member>
    <MemberGroup MemberName="GetEventLogs">
      <AssemblyInfo>
        <AssemblyName>System</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Docs>
        <summary><span data-ttu-id="6be2f-722">创建事件日志的数组。</span><span class="sxs-lookup"><span data-stu-id="6be2f-722">Creates an array of the event logs.</span></span></summary>
      </Docs>
    </MemberGroup>
    <Member MemberName="GetEventLogs">
      <MemberSignature Language="C#" Value="public static System.Diagnostics.EventLog[] GetEventLogs ();" />
      <MemberSignature Language="ILAsm" Value=".method public static hidebysig class System.Diagnostics.EventLog[] GetEventLogs() cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Diagnostics.EventLog.GetEventLogs" />
      <MemberSignature Language="VB.NET" Value="Public Shared Function GetEventLogs () As EventLog()" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; static cli::array &lt;System::Diagnostics::EventLog ^&gt; ^ GetEventLogs();" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Diagnostics.EventLog[]</ReturnType>
      </ReturnValue>
      <Parameters />
      <Docs>
        <summary><span data-ttu-id="6be2f-723">在本地计算机上搜索所有的事件日志并创建一个包含该列表的 <see cref="T:System.Diagnostics.EventLog" /> 对象数组。</span><span class="sxs-lookup"><span data-stu-id="6be2f-723">Searches for all event logs on the local computer and creates an array of <see cref="T:System.Diagnostics.EventLog" /> objects that contain the list.</span></span></summary>
        <returns><span data-ttu-id="6be2f-724"><see cref="T:System.Diagnostics.EventLog" /> 类型的数组，表示本地计算机上的日志。</span><span class="sxs-lookup"><span data-stu-id="6be2f-724">An array of type <see cref="T:System.Diagnostics.EventLog" /> that represents the logs on the local computer.</span></span></returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="6be2f-725">数组<xref:System.Diagnostics.EventLog>对象是本地计算机上的所有事件日志的快照时对调用<xref:System.Diagnostics.EventLog.GetEventLogs%2A>进行。</span><span class="sxs-lookup"><span data-stu-id="6be2f-725">The array of <xref:System.Diagnostics.EventLog> objects is a snapshot of all event logs on the local computer when the call to <xref:System.Diagnostics.EventLog.GetEventLogs%2A> is made.</span></span> <span data-ttu-id="6be2f-726">这不是动态集合，因此它不反映的删除或创建的实时日志。</span><span class="sxs-lookup"><span data-stu-id="6be2f-726">This is not a dynamic collection, so it does not reflect the deletion or creation of logs in real time.</span></span> <span data-ttu-id="6be2f-727">你应验证数组中的日志存在之前读取或写入到它。</span><span class="sxs-lookup"><span data-stu-id="6be2f-727">You should verify that a log in the array exists before you read or write to it.</span></span> <span data-ttu-id="6be2f-728">数组通常包含至少三个日志： 应用程序、 系统和安全。</span><span class="sxs-lookup"><span data-stu-id="6be2f-728">The array usually includes at least three logs: Application, System, and Security.</span></span> <span data-ttu-id="6be2f-729">如果你在本地计算机上创建自定义日志，则它们将显示以及数组中。</span><span class="sxs-lookup"><span data-stu-id="6be2f-729">If you created custom logs on the local computer, they will appear in the array as well.</span></span>  
  
 <span data-ttu-id="6be2f-730">若要检索事件日志的列表，你必须具有相应的注册表权限。</span><span class="sxs-lookup"><span data-stu-id="6be2f-730">To retrieve the list of event logs, you must have the appropriate registry permissions.</span></span> <span data-ttu-id="6be2f-731">这些权限是与调用所需的相同<xref:System.Diagnostics.EventLog.Exists%2A>和<xref:System.Diagnostics.EventLog.SourceExists%2A>。</span><span class="sxs-lookup"><span data-stu-id="6be2f-731">These permissions are identical to those required to call <xref:System.Diagnostics.EventLog.Exists%2A> and <xref:System.Diagnostics.EventLog.SourceExists%2A>.</span></span>  
  
   
  
## Examples  
 <span data-ttu-id="6be2f-732">下面的示例枚举的本地计算机上定义的事件日志，并显示每个事件日志的配置详细信息。</span><span class="sxs-lookup"><span data-stu-id="6be2f-732">The following example enumerates the event logs defined on the local computer, and displays configuration details for each event log.</span></span>  
  
 [!code-cpp[EventLogProperties#2](~/samples/snippets/cpp/VS_Snippets_CLR/EventLogProperties/CPP/source.cpp#2)]
 [!code-csharp[EventLogProperties#2](~/samples/snippets/csharp/VS_Snippets_CLR/EventLogProperties/CS/source.cs#2)]
 [!code-vb[EventLogProperties#2](~/samples/snippets/visualbasic/VS_Snippets_CLR/EventLogProperties/VB/source.vb#2)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.SystemException"><span data-ttu-id="6be2f-733">您对注册表没有读访问权。</span><span class="sxs-lookup"><span data-stu-id="6be2f-733">You do not have read access to the registry.</span></span>  
  
 <span data-ttu-id="6be2f-734">或</span><span class="sxs-lookup"><span data-stu-id="6be2f-734">-or-</span></span>  
  
 <span data-ttu-id="6be2f-735">计算机上没有事件日志服务。</span><span class="sxs-lookup"><span data-stu-id="6be2f-735">There is no event log service on the computer.</span></span></exception>
        <permission cref="T:System.Diagnostics.EventLogPermission"><span data-ttu-id="6be2f-736">用于管理的计算机上的事件日志信息。</span><span class="sxs-lookup"><span data-stu-id="6be2f-736">for administering event log information on the computer.</span></span> <span data-ttu-id="6be2f-737">关联的枚举： <see cref="F:System.Diagnostics.EventLogPermissionAccess.Administer" /></span><span class="sxs-lookup"><span data-stu-id="6be2f-737">Associated enumeration: <see cref="F:System.Diagnostics.EventLogPermissionAccess.Administer" /></span></span></permission>
        <altmember cref="M:System.Diagnostics.EventLog.Exists(System.String)" />
        <altmember cref="P:System.Diagnostics.EventLog.Log" />
      </Docs>
    </Member>
    <Member MemberName="GetEventLogs">
      <MemberSignature Language="C#" Value="public static System.Diagnostics.EventLog[] GetEventLogs (string machineName);" />
      <MemberSignature Language="ILAsm" Value=".method public static hidebysig class System.Diagnostics.EventLog[] GetEventLogs(string machineName) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Diagnostics.EventLog.GetEventLogs(System.String)" />
      <MemberSignature Language="VB.NET" Value="Public Shared Function GetEventLogs (machineName As String) As EventLog()" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; static cli::array &lt;System::Diagnostics::EventLog ^&gt; ^ GetEventLogs(System::String ^ machineName);" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Attributes>
        <Attribute>
          <AttributeName>System.MonoNotSupported("remote machine is not supported")</AttributeName>
        </Attribute>
      </Attributes>
      <ReturnValue>
        <ReturnType>System.Diagnostics.EventLog[]</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="machineName" Type="System.String" />
      </Parameters>
      <Docs>
        <param name="machineName"><span data-ttu-id="6be2f-738">在其上搜索事件日志的计算机。</span><span class="sxs-lookup"><span data-stu-id="6be2f-738">The computer on which to search for event logs.</span></span></param>
        <summary><span data-ttu-id="6be2f-739">在给定计算机上搜索所有事件日志并创建一个包含该列表的 <see cref="T:System.Diagnostics.EventLog" /> 对象数组。</span><span class="sxs-lookup"><span data-stu-id="6be2f-739">Searches for all event logs on the given computer and creates an array of <see cref="T:System.Diagnostics.EventLog" /> objects that contain the list.</span></span></summary>
        <returns><span data-ttu-id="6be2f-740"><see cref="T:System.Diagnostics.EventLog" /> 类型的数组，表示给定计算机上的日志。</span><span class="sxs-lookup"><span data-stu-id="6be2f-740">An array of type <see cref="T:System.Diagnostics.EventLog" /> that represents the logs on the given computer.</span></span></returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="6be2f-741">数组<xref:System.Diagnostics.EventLog>对象是指定的计算机上的所有事件日志的快照`machineName`参数时对调用<xref:System.Diagnostics.EventLog.GetEventLogs%2A>进行。</span><span class="sxs-lookup"><span data-stu-id="6be2f-741">The array of <xref:System.Diagnostics.EventLog> objects is a snapshot of all event logs on the computer specified by the `machineName` parameter when the call to <xref:System.Diagnostics.EventLog.GetEventLogs%2A> is made.</span></span> <span data-ttu-id="6be2f-742">这不是动态集合，因此它不反映的删除或创建的实时日志。</span><span class="sxs-lookup"><span data-stu-id="6be2f-742">This is not a dynamic collection, so it does not reflect the deletion or creation of logs in real time.</span></span> <span data-ttu-id="6be2f-743">你应验证数组中的日志存在之前读取或写入到它。</span><span class="sxs-lookup"><span data-stu-id="6be2f-743">You should verify that a log in the array exists before you read or write to it.</span></span> <span data-ttu-id="6be2f-744">数组通常包含至少三个日志： 应用程序、 系统和安全。</span><span class="sxs-lookup"><span data-stu-id="6be2f-744">The array usually includes at least three logs: Application, System, and Security.</span></span> <span data-ttu-id="6be2f-745">如果指定的计算机上创建自定义日志，则它们将显示以及数组中。</span><span class="sxs-lookup"><span data-stu-id="6be2f-745">If you created custom logs on the specified computer, they will appear in the array as well.</span></span>  
  
 <span data-ttu-id="6be2f-746"><xref:System.Diagnostics.EventLog.GetEventLogs%2A> 是`static`方法，使其可以调用上<xref:System.Diagnostics.EventLog>类本身。</span><span class="sxs-lookup"><span data-stu-id="6be2f-746"><xref:System.Diagnostics.EventLog.GetEventLogs%2A> is a `static` method, so it can be called on the <xref:System.Diagnostics.EventLog> class itself.</span></span> <span data-ttu-id="6be2f-747">不需要创建的实例<xref:System.Diagnostics.EventLog>要使其对方法的调用对象。</span><span class="sxs-lookup"><span data-stu-id="6be2f-747">It is not necessary to create an instance of an <xref:System.Diagnostics.EventLog> object to make a call to the method.</span></span>  
  
 <span data-ttu-id="6be2f-748">若要检索事件日志的列表，你必须具有相应的注册表权限。</span><span class="sxs-lookup"><span data-stu-id="6be2f-748">To retrieve the list of event logs, you must have the appropriate registry permissions.</span></span> <span data-ttu-id="6be2f-749">这些权限是与调用所需的相同<xref:System.Diagnostics.EventLog.Exists%2A>和<xref:System.Diagnostics.EventLog.SourceExists%2A>。</span><span class="sxs-lookup"><span data-stu-id="6be2f-749">These permissions are identical to those required to call <xref:System.Diagnostics.EventLog.Exists%2A> and <xref:System.Diagnostics.EventLog.SourceExists%2A>.</span></span>  
  
   
  
## Examples  
 <span data-ttu-id="6be2f-750">下面的示例获取在计算机"myServer"上的日志的列表。</span><span class="sxs-lookup"><span data-stu-id="6be2f-750">The following example gets a list of logs on the computer "myServer".</span></span> <span data-ttu-id="6be2f-751">然后，它将输出的每个日志的名称。</span><span class="sxs-lookup"><span data-stu-id="6be2f-751">It then outputs the name of each log.</span></span>  
  
 [!code-cpp[Classic EventLog.GetEventLogs1 Example#1](~/samples/snippets/cpp/VS_Snippets_CLR_Classic/classic EventLog.GetEventLogs1 Example/CPP/source.cpp#1)]
 [!code-csharp[Classic EventLog.GetEventLogs1 Example#1](~/samples/snippets/csharp/VS_Snippets_CLR_Classic/classic EventLog.GetEventLogs1 Example/CS/source.cs#1)]
 [!code-vb[Classic EventLog.GetEventLogs1 Example#1](~/samples/snippets/visualbasic/VS_Snippets_CLR_Classic/classic EventLog.GetEventLogs1 Example/VB/source.vb#1)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentException"><span data-ttu-id="6be2f-752"><paramref name="machineName" /> 参数是无效的计算机名称。</span><span class="sxs-lookup"><span data-stu-id="6be2f-752">The <paramref name="machineName" /> parameter is an invalid computer name.</span></span></exception>
        <exception cref="T:System.InvalidOperationException"><span data-ttu-id="6be2f-753">您对注册表没有读访问权。</span><span class="sxs-lookup"><span data-stu-id="6be2f-753">You do not have read access to the registry.</span></span>  
  
 <span data-ttu-id="6be2f-754">或</span><span class="sxs-lookup"><span data-stu-id="6be2f-754">-or-</span></span>  
  
 <span data-ttu-id="6be2f-755">计算机上没有事件日志服务。</span><span class="sxs-lookup"><span data-stu-id="6be2f-755">There is no event log service on the computer.</span></span></exception>
        <permission cref="T:System.Diagnostics.EventLogPermission"><span data-ttu-id="6be2f-756">用于管理的计算机上的事件日志信息。</span><span class="sxs-lookup"><span data-stu-id="6be2f-756">for administering event log information on the computer.</span></span> <span data-ttu-id="6be2f-757">关联的枚举： <see cref="F:System.Diagnostics.EventLogPermissionAccess.Administer" /></span><span class="sxs-lookup"><span data-stu-id="6be2f-757">Associated enumeration: <see cref="F:System.Diagnostics.EventLogPermissionAccess.Administer" /></span></span></permission>
        <altmember cref="M:System.Diagnostics.EventLog.Exists(System.String)" />
        <altmember cref="P:System.Diagnostics.EventLog.Log" />
        <altmember cref="P:System.Diagnostics.EventLog.MachineName" />
      </Docs>
    </Member>
    <Member MemberName="Log">
      <MemberSignature Language="C#" Value="public string Log { get; set; }" />
      <MemberSignature Language="ILAsm" Value=".property instance string Log" />
      <MemberSignature Language="DocId" Value="P:System.Diagnostics.EventLog.Log" />
      <MemberSignature Language="VB.NET" Value="Public Property Log As String" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; property System::String ^ Log { System::String ^ get(); void set(System::String ^ value); };" />
      <MemberType>Property</MemberType>
      <AssemblyInfo>
        <AssemblyName>System</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Attributes>
        <Attribute>
          <AttributeName>System.ComponentModel.DefaultValue("")</AttributeName>
        </Attribute>
        <Attribute>
          <AttributeName>System.ComponentModel.ReadOnly(true)</AttributeName>
        </Attribute>
        <Attribute>
          <AttributeName>System.ComponentModel.RecommendedAsConfigurable(true)</AttributeName>
        </Attribute>
        <Attribute>
          <AttributeName>System.ComponentModel.TypeConverter("System.Diagnostics.Design.LogConverter, System.Design, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b03f5f7f11d50a3a")</AttributeName>
        </Attribute>
        <Attribute>
          <AttributeName>System.Diagnostics.MonitoringDescription("Name of the log that is read and written.")</AttributeName>
        </Attribute>
      </Attributes>
      <ReturnValue>
        <ReturnType>System.String</ReturnType>
      </ReturnValue>
      <Docs>
        <summary><span data-ttu-id="6be2f-758">获取或设置读取或写入的日志名称。</span><span class="sxs-lookup"><span data-stu-id="6be2f-758">Gets or sets the name of the log to read from or write to.</span></span></summary>
        <value><span data-ttu-id="6be2f-759">日志的名称。</span><span class="sxs-lookup"><span data-stu-id="6be2f-759">The name of the log.</span></span> <span data-ttu-id="6be2f-760">这可以是“应用程序”、“系统”、“安全性”或一个自定义的日志名称。</span><span class="sxs-lookup"><span data-stu-id="6be2f-760">This can be Application, System, Security, or a custom log name.</span></span> <span data-ttu-id="6be2f-761">默认值为空字符串("")。</span><span class="sxs-lookup"><span data-stu-id="6be2f-761">The default is an empty string ("").</span></span></value>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="6be2f-762">默认情况下，在服务器上存在三个日志文件： 应用程序、 系统和安全。</span><span class="sxs-lookup"><span data-stu-id="6be2f-762">Three log files exist by default on the server: Application, System, and Security.</span></span> <span data-ttu-id="6be2f-763">应用程序和服务使用应用程序日志文件。</span><span class="sxs-lookup"><span data-stu-id="6be2f-763">Applications and services use the Application log file.</span></span> <span data-ttu-id="6be2f-764">设备驱动程序使用的系统日志文件。</span><span class="sxs-lookup"><span data-stu-id="6be2f-764">Device drivers use the System log file.</span></span> <span data-ttu-id="6be2f-765">启用审核后，系统会在安全日志中生成成功和失败审核事件。</span><span class="sxs-lookup"><span data-stu-id="6be2f-765">The system generates success and failure audit events in the Security log when auditing is turned on.</span></span> <span data-ttu-id="6be2f-766">如果你有其他安装，如 Windows 服务器上的 Active Directory 的应用程序可能有其他默认日志文件。</span><span class="sxs-lookup"><span data-stu-id="6be2f-766">If you have other applications installed, like Active Directory on Windows servers, there might be other default log files.</span></span> <span data-ttu-id="6be2f-767">此外，你可以创建本地或远程计算机上的自定义日志文件。</span><span class="sxs-lookup"><span data-stu-id="6be2f-767">In addition, you can create custom log files on a local or remote computer.</span></span> <span data-ttu-id="6be2f-768">自定义日志可帮助组织您的项比你的组件的默认应用程序日志中写入事件时所允许的方式更详细的方式。</span><span class="sxs-lookup"><span data-stu-id="6be2f-768">Custom logs help organize your entries in a more detailed way than is allowed when your components write events to the default Application log.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="6be2f-769">日志名称被限制为 8 个字符。</span><span class="sxs-lookup"><span data-stu-id="6be2f-769">Log names are limited to eight characters.</span></span> <span data-ttu-id="6be2f-770">根据系统，MyLogSample1 和 MyLogSample2 都是相同的日志。</span><span class="sxs-lookup"><span data-stu-id="6be2f-770">According to the system, MyLogSample1 and MyLogSample2 are the same log.</span></span>  
  
 <span data-ttu-id="6be2f-771">如果写入事件日志时，它没有足够可用于指定<xref:System.Diagnostics.EventLog.Log%2A>属性。</span><span class="sxs-lookup"><span data-stu-id="6be2f-771">If you write to an event log, it is not enough to specify the <xref:System.Diagnostics.EventLog.Log%2A> property.</span></span> <span data-ttu-id="6be2f-772">必须将关联<xref:System.Diagnostics.EventLog.Source%2A>使用事件日志资源连接到的特定日志的属性。</span><span class="sxs-lookup"><span data-stu-id="6be2f-772">You must associate a <xref:System.Diagnostics.EventLog.Source%2A> property with your event log resource to connect it to a particular log.</span></span> <span data-ttu-id="6be2f-773">不需要指定<xref:System.Diagnostics.EventLog.Source%2A>时仅从一个日志，但事件源中读取必须是与服务器的注册表中的事件日志资源相关联。</span><span class="sxs-lookup"><span data-stu-id="6be2f-773">It is not necessary to specify a <xref:System.Diagnostics.EventLog.Source%2A> when only reading from a log, but an event source must be associated with the event log resource in the server's registry.</span></span> <span data-ttu-id="6be2f-774">你可以仅指定<xref:System.Diagnostics.EventLog.Log%2A>名称和<xref:System.Diagnostics.EventLog.MachineName%2A>（服务器计算机名称） 以从其中进行读取。</span><span class="sxs-lookup"><span data-stu-id="6be2f-774">You can specify only the <xref:System.Diagnostics.EventLog.Log%2A> name and <xref:System.Diagnostics.EventLog.MachineName%2A> (server computer name) to read from it.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="6be2f-775">你不需要指定<xref:System.Diagnostics.EventLog.MachineName%2A>如果要连接到日志。</span><span class="sxs-lookup"><span data-stu-id="6be2f-775">You are not required to specify the <xref:System.Diagnostics.EventLog.MachineName%2A> if you are connecting to a log.</span></span> <span data-ttu-id="6be2f-776">如果不指定<xref:System.Diagnostics.EventLog.MachineName%2A>，本地计算机 ("。") 假定。</span><span class="sxs-lookup"><span data-stu-id="6be2f-776">If you do not specify the <xref:System.Diagnostics.EventLog.MachineName%2A>, the local computer (".") is assumed.</span></span>  
  
 <span data-ttu-id="6be2f-777">如果<xref:System.Diagnostics.EventLog.Source%2A>未指定属性，调用<xref:System.Diagnostics.EventLog.Log%2A>返回空字符串，如果<xref:System.Diagnostics.EventLog.Log%2A>未显式设置 (通过设置<xref:System.Diagnostics.EventLog.Log%2A>属性，或通过构造函数)。</span><span class="sxs-lookup"><span data-stu-id="6be2f-777">If the <xref:System.Diagnostics.EventLog.Source%2A> property has not been specified, a call to <xref:System.Diagnostics.EventLog.Log%2A> returns an empty string if <xref:System.Diagnostics.EventLog.Log%2A> has not been explicitly set (by setting the <xref:System.Diagnostics.EventLog.Log%2A> property, or through the constructor).</span></span> <span data-ttu-id="6be2f-778">如果<xref:System.Diagnostics.EventLog.Source%2A>已指定，<xref:System.Diagnostics.EventLog.Log%2A>返回该源已注册到日志的名称。</span><span class="sxs-lookup"><span data-stu-id="6be2f-778">If the <xref:System.Diagnostics.EventLog.Source%2A> has been specified, <xref:System.Diagnostics.EventLog.Log%2A> returns the name of the log to which that source was registered.</span></span>  
  
 <span data-ttu-id="6be2f-779">一个源一次仅注册到一个日志。</span><span class="sxs-lookup"><span data-stu-id="6be2f-779">A source can only be registered to one log at a time.</span></span> <span data-ttu-id="6be2f-780">如果<xref:System.Diagnostics.EventLog.Source%2A>属性已设置的实例<xref:System.Diagnostics.EventLog>，不能更改<xref:System.Diagnostics.EventLog.Log%2A>属性中的为该<xref:System.Diagnostics.EventLog>而无需更改的值<xref:System.Diagnostics.EventLog.Source%2A>或调用<xref:System.Diagnostics.EventLog.DeleteEventSource%2A>第一个。</span><span class="sxs-lookup"><span data-stu-id="6be2f-780">If the <xref:System.Diagnostics.EventLog.Source%2A> property was set for an instance of <xref:System.Diagnostics.EventLog>, you cannot change the <xref:System.Diagnostics.EventLog.Log%2A> property for that <xref:System.Diagnostics.EventLog> without changing the value of <xref:System.Diagnostics.EventLog.Source%2A> or calling <xref:System.Diagnostics.EventLog.DeleteEventSource%2A> first.</span></span> <span data-ttu-id="6be2f-781">如果你更改<xref:System.Diagnostics.EventLog.Log%2A>属性后的<xref:System.Diagnostics.EventLog.Source%2A>属性已设置，编写日志条目会引发异常。</span><span class="sxs-lookup"><span data-stu-id="6be2f-781">If you change the <xref:System.Diagnostics.EventLog.Log%2A> property after the <xref:System.Diagnostics.EventLog.Source%2A> property has been set, writing a log entry throws an exception.</span></span>  
  
 <span data-ttu-id="6be2f-782">操作系统将事件日志存储为文件。</span><span class="sxs-lookup"><span data-stu-id="6be2f-782">The operating system stores event logs as files.</span></span> <span data-ttu-id="6be2f-783">当你使用<xref:System.Diagnostics.EventLogInstaller>或<xref:System.Diagnostics.EventLog.CreateEventSource%2A>若要创建新的事件日志，关联的文件存储在指定的计算机上的 %SystemRoot%\System32\Config 目录。</span><span class="sxs-lookup"><span data-stu-id="6be2f-783">When you use <xref:System.Diagnostics.EventLogInstaller> or <xref:System.Diagnostics.EventLog.CreateEventSource%2A> to create a new event log, the associated file is stored in the %SystemRoot%\System32\Config directory on the specified computer.</span></span> <span data-ttu-id="6be2f-784">通过追加的前 8 个字符设置的文件名称<xref:System.Diagnostics.EventLog.Log%2A>".evt"文件扩展名的属性。</span><span class="sxs-lookup"><span data-stu-id="6be2f-784">The file name is set by appending the first 8 characters of the <xref:System.Diagnostics.EventLog.Log%2A> property with the ".evt" file name extension.</span></span>  
  
 <span data-ttu-id="6be2f-785">无法创建新的日志使用<xref:System.Diagnostics.EventLog.Log%2A>单独 （而不指定日志的源） 的属性。</span><span class="sxs-lookup"><span data-stu-id="6be2f-785">You cannot create a new log using the <xref:System.Diagnostics.EventLog.Log%2A> property alone (without specifying a source for the log).</span></span> <span data-ttu-id="6be2f-786">你可以调用<xref:System.Diagnostics.EventLog.CreateEventSource%2A>，在一个新的日志名称作为参数传递，然后调用<xref:System.Diagnostics.EventLog.DeleteEventSource%2A>。</span><span class="sxs-lookup"><span data-stu-id="6be2f-786">You can call <xref:System.Diagnostics.EventLog.CreateEventSource%2A>, passing in a new log name as a parameter, and then call <xref:System.Diagnostics.EventLog.DeleteEventSource%2A>.</span></span> <span data-ttu-id="6be2f-787">但是，目的是通常以创建 （并将条目写入） 新的应用程序特定日志，或用于从现有日志读取。</span><span class="sxs-lookup"><span data-stu-id="6be2f-787">However, the intent is usually either to create (and write entries to) new application-specific logs, or to read from existing logs.</span></span>  
  
 <span data-ttu-id="6be2f-788">如果<xref:System.Diagnostics.EventLog.Log%2A>值更改，关闭事件日志并释放所有事件句柄。</span><span class="sxs-lookup"><span data-stu-id="6be2f-788">If the <xref:System.Diagnostics.EventLog.Log%2A> value changes, the event log is closed and all event handles are released.</span></span>  
  
> [!CAUTION]
>  <span data-ttu-id="6be2f-789">如果你设置<xref:System.Diagnostics.EventLog.Log%2A>属性不存在日志的名称，系统将附加<xref:System.Diagnostics.EventLog>向应用程序日志中，但不会警告你它正在使用不是你指定的日志。</span><span class="sxs-lookup"><span data-stu-id="6be2f-789">If you set the <xref:System.Diagnostics.EventLog.Log%2A> property to the name of a log that does not exist, the system attaches the <xref:System.Diagnostics.EventLog> to the Application log, but does not warn you that it is using a log other than the one you specified.</span></span>  
  
   
  
## Examples  
 <span data-ttu-id="6be2f-790">下面的示例读取在事件日志中，"NewEventLog"本地计算机上的项。</span><span class="sxs-lookup"><span data-stu-id="6be2f-790">The following example reads entries in the event log, "NewEventLog", on the local computer.</span></span>  
  
 [!code-cpp[Classic EventLog.Log Example#1](~/samples/snippets/cpp/VS_Snippets_CLR_Classic/classic EventLog.Log Example/CPP/source.cpp#1)]
 [!code-csharp[Classic EventLog.Log Example#1](~/samples/snippets/csharp/VS_Snippets_CLR_Classic/classic EventLog.Log Example/CS/source.cs#1)]
 [!code-vb[Classic EventLog.Log Example#1](~/samples/snippets/visualbasic/VS_Snippets_CLR_Classic/classic EventLog.Log Example/VB/source.vb#1)]  
  
 ]]></format>
        </remarks>
        <permission cref="T:System.Diagnostics.EventLogPermission"><span data-ttu-id="6be2f-791">用于写入的计算机上的事件日志信息。</span><span class="sxs-lookup"><span data-stu-id="6be2f-791">for writing the event log information on the computer.</span></span> <span data-ttu-id="6be2f-792">关联的枚举： <see cref="F:System.Diagnostics.EventLogPermissionAccess.Write" /></span><span class="sxs-lookup"><span data-stu-id="6be2f-792">Associated enumeration: <see cref="F:System.Diagnostics.EventLogPermissionAccess.Write" /></span></span></permission>
        <altmember cref="P:System.Diagnostics.EventLog.MachineName" />
        <altmember cref="P:System.Diagnostics.EventLog.Source" />
        <altmember cref="P:System.Diagnostics.EventLog.Entries" />
        <altmember cref="M:System.Diagnostics.EventLog.Exists(System.String)" />
        <altmember cref="M:System.Diagnostics.EventLog.Delete(System.String)" />
        <altmember cref="Overload:System.Diagnostics.EventLog.CreateEventSource" />
        <altmember cref="T:System.Diagnostics.EventLogEntryCollection" />
      </Docs>
    </Member>
    <Member MemberName="LogDisplayName">
      <MemberSignature Language="C#" Value="public string LogDisplayName { get; }" />
      <MemberSignature Language="ILAsm" Value=".property instance string LogDisplayName" />
      <MemberSignature Language="DocId" Value="P:System.Diagnostics.EventLog.LogDisplayName" />
      <MemberSignature Language="VB.NET" Value="Public ReadOnly Property LogDisplayName As String" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; property System::String ^ LogDisplayName { System::String ^ get(); };" />
      <MemberType>Property</MemberType>
      <AssemblyInfo>
        <AssemblyName>System</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Attributes>
        <Attribute>
          <AttributeName>System.ComponentModel.Browsable(false)</AttributeName>
        </Attribute>
      </Attributes>
      <ReturnValue>
        <ReturnType>System.String</ReturnType>
      </ReturnValue>
      <Docs>
        <summary><span data-ttu-id="6be2f-793">获取事件日志的友好名称。</span><span class="sxs-lookup"><span data-stu-id="6be2f-793">Gets the event log's friendly name.</span></span></summary>
        <value><span data-ttu-id="6be2f-794">一个表示系统的事件查看器中事件日志的名称。</span><span class="sxs-lookup"><span data-stu-id="6be2f-794">A name that represents the event log in the system's event viewer.</span></span></value>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
  
> [!NOTE]
>  <span data-ttu-id="6be2f-795">在 Windows Vista 或更高版本，则用户没有访问安全日志的权限。</span><span class="sxs-lookup"><span data-stu-id="6be2f-795">In Windows Vista and later, users do not have permission to access the security log.</span></span> <span data-ttu-id="6be2f-796">如果你正在运行 Windows Vista 或更高版本作为一个用户，你将获得<xref:System.Security.SecurityException>当你尝试访问安全日志中的事件的显示名称。</span><span class="sxs-lookup"><span data-stu-id="6be2f-796">If you are running Windows Vista or later as a user, you will get a <xref:System.Security.SecurityException> when you attempt to access the display name for an event in the security log.</span></span>  
>   
>  <span data-ttu-id="6be2f-797">在 Windows Vista 或更高版本中，用户帐户控制 (UAC) 决定用户的特权。</span><span class="sxs-lookup"><span data-stu-id="6be2f-797">In Windows Vista and later, User Account Control (UAC) determines the privileges of a user.</span></span> <span data-ttu-id="6be2f-798">如果您是内置的 Administrators 组的成员，将为您分配两个运行时访问令牌：一个标准用户访问令牌和一个管理员访问令牌。</span><span class="sxs-lookup"><span data-stu-id="6be2f-798">If you are a member of the Built-in Administrators group, you are assigned two run-time access tokens: a standard user access token and an administrator access token.</span></span> <span data-ttu-id="6be2f-799">默认情况下，您拥有标准用户角色。</span><span class="sxs-lookup"><span data-stu-id="6be2f-799">By default, you are in the standard user role.</span></span> <span data-ttu-id="6be2f-800">若要执行的代码访问安全日志，首先必须将你的特权从标准用户提升至管理员。</span><span class="sxs-lookup"><span data-stu-id="6be2f-800">To execute the code that accesses the security log, you must first elevate your privileges from standard user to administrator.</span></span> <span data-ttu-id="6be2f-801">你可以通过以下方式执行此操作：右键单击应用程序图标并指示需以管理员身份运行。</span><span class="sxs-lookup"><span data-stu-id="6be2f-801">You can do this when you start an application by right-clicking the application icon and indicating that you want to run as an administrator.</span></span>  
  
   
  
## Examples  
 <span data-ttu-id="6be2f-802">下面的示例将枚举在本地计算机上定义的事件日志，并显示<xref:System.Diagnostics.EventLog.LogDisplayName%2A>每个事件日志。</span><span class="sxs-lookup"><span data-stu-id="6be2f-802">The following example enumerates the event logs defined on the local computer and displays the <xref:System.Diagnostics.EventLog.LogDisplayName%2A> for each event log.</span></span>  
  
 [!code-cpp[EventLogProperties#2](~/samples/snippets/cpp/VS_Snippets_CLR/EventLogProperties/CPP/source.cpp#2)]
 [!code-csharp[EventLogProperties#2](~/samples/snippets/csharp/VS_Snippets_CLR/EventLogProperties/CS/source.cs#2)]
 [!code-vb[EventLogProperties#2](~/samples/snippets/visualbasic/VS_Snippets_CLR/EventLogProperties/VB/source.vb#2)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.InvalidOperationException"><span data-ttu-id="6be2f-803">此计算机的注册表中不存在指定的 <see cref="P:System.Diagnostics.EventLog.Log" />。</span><span class="sxs-lookup"><span data-stu-id="6be2f-803">The specified <see cref="P:System.Diagnostics.EventLog.Log" /> does not exist in the registry for this computer.</span></span></exception>
        <permission cref="T:System.Diagnostics.EventLogPermission"><span data-ttu-id="6be2f-804">用于管理的计算机上的事件日志信息。</span><span class="sxs-lookup"><span data-stu-id="6be2f-804">for administering event log information on the computer.</span></span> <span data-ttu-id="6be2f-805">关联的枚举： <see cref="F:System.Diagnostics.EventLogPermissionAccess.Administer" /></span><span class="sxs-lookup"><span data-stu-id="6be2f-805">Associated enumeration: <see cref="F:System.Diagnostics.EventLogPermissionAccess.Administer" /></span></span></permission>
        <permission cref="T:System.Security.Permissions.RegistryPermission"><span data-ttu-id="6be2f-806">读取指定的注册表项的功能。</span><span class="sxs-lookup"><span data-stu-id="6be2f-806">for the ability to read the specified registry key.</span></span> <span data-ttu-id="6be2f-807">关联的枚举： <see cref="F:System.Security.Permissions.RegistryPermissionAccess.Read" /></span><span class="sxs-lookup"><span data-stu-id="6be2f-807">Associated enumeration: <see cref="F:System.Security.Permissions.RegistryPermissionAccess.Read" /></span></span></permission>
        <permission cref="T:System.Security.Permissions.SecurityPermission"><span data-ttu-id="6be2f-808">它能够访问指定的注册表密钥如果它是一个远程的键。</span><span class="sxs-lookup"><span data-stu-id="6be2f-808">for the ability to access the specified registry key if it is a remote key.</span></span> <span data-ttu-id="6be2f-809">关联的枚举： <see cref="F:System.Security.Permissions.SecurityPermissionFlag.UnmanagedCode" /></span><span class="sxs-lookup"><span data-stu-id="6be2f-809">Associated enumeration: <see cref="F:System.Security.Permissions.SecurityPermissionFlag.UnmanagedCode" /></span></span></permission>
        <altmember cref="M:System.Diagnostics.EventLog.RegisterDisplayName(System.String,System.Int64)" />
      </Docs>
    </Member>
    <Member MemberName="LogNameFromSourceName">
      <MemberSignature Language="C#" Value="public static string LogNameFromSourceName (string source, string machineName);" />
      <MemberSignature Language="ILAsm" Value=".method public static hidebysig string LogNameFromSourceName(string source, string machineName) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Diagnostics.EventLog.LogNameFromSourceName(System.String,System.String)" />
      <MemberSignature Language="VB.NET" Value="Public Shared Function LogNameFromSourceName (source As String, machineName As String) As String" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; static System::String ^ LogNameFromSourceName(System::String ^ source, System::String ^ machineName);" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Attributes>
        <Attribute>
          <AttributeName>System.MonoNotSupported("remote machine is not supported")</AttributeName>
        </Attribute>
      </Attributes>
      <ReturnValue>
        <ReturnType>System.String</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="source" Type="System.String" />
        <Parameter Name="machineName" Type="System.String" />
      </Parameters>
      <Docs>
        <param name="source"><span data-ttu-id="6be2f-810">事件源的名称。</span><span class="sxs-lookup"><span data-stu-id="6be2f-810">The name of the event source.</span></span></param>
        <param name="machineName"><span data-ttu-id="6be2f-811">要从中删除日志的计算机名称，对于本地计算机则为“.”。</span><span class="sxs-lookup"><span data-stu-id="6be2f-811">The name of the computer on which to look, or "." for the local computer.</span></span></param>
        <summary><span data-ttu-id="6be2f-812">获取指定的源注册到的日志的名称。</span><span class="sxs-lookup"><span data-stu-id="6be2f-812">Gets the name of the log to which the specified source is registered.</span></span></summary>
        <returns><span data-ttu-id="6be2f-813">与注册表中的指定源关联的日志名称。</span><span class="sxs-lookup"><span data-stu-id="6be2f-813">The name of the log associated with the specified source in the registry.</span></span></returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="6be2f-814">事件源指示什么来记录事件。</span><span class="sxs-lookup"><span data-stu-id="6be2f-814">The event source indicates what logs the event.</span></span> <span data-ttu-id="6be2f-815">通常很的应用程序，名称或名称的子组件的应用程序，如果应用程序非常大。</span><span class="sxs-lookup"><span data-stu-id="6be2f-815">It is often the name of the application, or the name of a subcomponent of the application, if the application is large.</span></span> <span data-ttu-id="6be2f-816">应用程序和服务应写入应用程序日志或自定义日志。</span><span class="sxs-lookup"><span data-stu-id="6be2f-816">Applications and services should write to the Application log or a custom log.</span></span> <span data-ttu-id="6be2f-817">设备驱动程序应写入系统日志。</span><span class="sxs-lookup"><span data-stu-id="6be2f-817">Device drivers should write to the System log.</span></span>  
  
 <span data-ttu-id="6be2f-818">在你创建新的源，可以仅写入一个日志一次，系统将你的应用程序的事件日志注册为有效项源。</span><span class="sxs-lookup"><span data-stu-id="6be2f-818">When you create a new source, which can only write to one log at a time, the system registers your application with the event log as a valid source of entries.</span></span> <span data-ttu-id="6be2f-819"><xref:System.Diagnostics.EventLog.Source%2A>属性可以是任意字符串，但名称不能由计算机上的其他源。</span><span class="sxs-lookup"><span data-stu-id="6be2f-819">The <xref:System.Diagnostics.EventLog.Source%2A> property can be any string, but the name cannot be used by other sources on the computer.</span></span> <span data-ttu-id="6be2f-820">尝试创建重复的<xref:System.Diagnostics.EventLog.Source%2A>值引发异常。</span><span class="sxs-lookup"><span data-stu-id="6be2f-820">An attempt to create a duplicated <xref:System.Diagnostics.EventLog.Source%2A> value throws an exception.</span></span> <span data-ttu-id="6be2f-821">但是，单个事件日志可以有许多不同的源向其写入。</span><span class="sxs-lookup"><span data-stu-id="6be2f-821">However, a single event log can have many different sources writing to it.</span></span>  
  
   
  
## Examples  
 <span data-ttu-id="6be2f-822">下面的示例从本地计算机中删除源。</span><span class="sxs-lookup"><span data-stu-id="6be2f-822">The following example deletes a source from the local computer.</span></span> <span data-ttu-id="6be2f-823">该示例确定从其源日志，然后删除该日志。</span><span class="sxs-lookup"><span data-stu-id="6be2f-823">The example determines the log from its source, and then deletes the log.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="6be2f-824">多个源可能会写入事件日志。</span><span class="sxs-lookup"><span data-stu-id="6be2f-824">More than one source might write to an event log.</span></span> <span data-ttu-id="6be2f-825">在删除之前自定义日志，请确保没有其他源写入该日志。</span><span class="sxs-lookup"><span data-stu-id="6be2f-825">Before deleting a custom log, make sure there are no other sources writing to that log.</span></span>  
  
 [!code-cpp[Classic EventLog.DeleteEventSource Example#1](~/samples/snippets/cpp/VS_Snippets_CLR_Classic/classic EventLog.DeleteEventSource Example/CPP/source.cpp#1)]
 [!code-csharp[Classic EventLog.DeleteEventSource Example#1](~/samples/snippets/csharp/VS_Snippets_CLR_Classic/classic EventLog.DeleteEventSource Example/CS/source.cs#1)]
 [!code-vb[Classic EventLog.DeleteEventSource Example#1](~/samples/snippets/visualbasic/VS_Snippets_CLR_Classic/classic EventLog.DeleteEventSource Example/VB/source.vb#1)]  
  
 ]]></format>
        </remarks>
        <permission cref="T:System.Diagnostics.EventLogPermission"><span data-ttu-id="6be2f-826">用于管理的计算机上的事件日志信息。</span><span class="sxs-lookup"><span data-stu-id="6be2f-826">for administering event log information on the computer.</span></span> <span data-ttu-id="6be2f-827">关联的枚举： <see cref="F:System.Diagnostics.EventLogPermissionAccess.Administer" /></span><span class="sxs-lookup"><span data-stu-id="6be2f-827">Associated enumeration: <see cref="F:System.Diagnostics.EventLogPermissionAccess.Administer" /></span></span></permission>
        <altmember cref="P:System.Diagnostics.EventLog.Source" />
        <altmember cref="P:System.Diagnostics.EventLog.MachineName" />
        <altmember cref="P:System.Diagnostics.EventLog.Log" />
        <altmember cref="M:System.Diagnostics.EventLog.SourceExists(System.String)" />
      </Docs>
    </Member>
    <Member MemberName="MachineName">
      <MemberSignature Language="C#" Value="public string MachineName { get; set; }" />
      <MemberSignature Language="ILAsm" Value=".property instance string MachineName" />
      <MemberSignature Language="DocId" Value="P:System.Diagnostics.EventLog.MachineName" />
      <MemberSignature Language="VB.NET" Value="Public Property MachineName As String" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; property System::String ^ MachineName { System::String ^ get(); void set(System::String ^ value); };" />
      <MemberType>Property</MemberType>
      <AssemblyInfo>
        <AssemblyName>System</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Attributes>
        <Attribute>
          <AttributeName>System.ComponentModel.DefaultValue(".")</AttributeName>
        </Attribute>
        <Attribute>
          <AttributeName>System.ComponentModel.ReadOnly(true)</AttributeName>
        </Attribute>
        <Attribute>
          <AttributeName>System.ComponentModel.RecommendedAsConfigurable(true)</AttributeName>
        </Attribute>
        <Attribute>
          <AttributeName>System.Diagnostics.MonitoringDescription("Name of the machine that this log get written to.")</AttributeName>
        </Attribute>
      </Attributes>
      <ReturnValue>
        <ReturnType>System.String</ReturnType>
      </ReturnValue>
      <Docs>
        <summary><span data-ttu-id="6be2f-828">获取或设置在其上读取或写入事件的计算机的名称。</span><span class="sxs-lookup"><span data-stu-id="6be2f-828">Gets or sets the name of the computer on which to read or write events.</span></span></summary>
        <value><span data-ttu-id="6be2f-829">事件日志驻留的服务器的名称。</span><span class="sxs-lookup"><span data-stu-id="6be2f-829">The name of the server on which the event log resides.</span></span> <span data-ttu-id="6be2f-830">默认为本地计算机 (".")。</span><span class="sxs-lookup"><span data-stu-id="6be2f-830">The default is the local computer (".").</span></span></value>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="6be2f-831">如果写入事件日志时，必须将关联<xref:System.Diagnostics.EventLog.Source%2A>使用你要将其连接到的特定日志的事件日志对象。</span><span class="sxs-lookup"><span data-stu-id="6be2f-831">If you write to an event log, you must associate a <xref:System.Diagnostics.EventLog.Source%2A> with your event log object to connect it to a particular log.</span></span> <span data-ttu-id="6be2f-832">不需要指定<xref:System.Diagnostics.EventLog.Source%2A>时仅从日志中读取的属性。</span><span class="sxs-lookup"><span data-stu-id="6be2f-832">It is not necessary to specify the <xref:System.Diagnostics.EventLog.Source%2A> property when only reading from a log.</span></span> <span data-ttu-id="6be2f-833">你可以仅指定<xref:System.Diagnostics.EventLog.Log%2A>名称和<xref:System.Diagnostics.EventLog.MachineName%2A>（服务器计算机名称）。</span><span class="sxs-lookup"><span data-stu-id="6be2f-833">You can specify only the <xref:System.Diagnostics.EventLog.Log%2A> name and <xref:System.Diagnostics.EventLog.MachineName%2A> (server computer name).</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="6be2f-834">不需要指定<xref:System.Diagnostics.EventLog.MachineName%2A>如果要连接到日志。</span><span class="sxs-lookup"><span data-stu-id="6be2f-834">You need not specify the <xref:System.Diagnostics.EventLog.MachineName%2A> if you are connecting to a log.</span></span> <span data-ttu-id="6be2f-835">如果不指定<xref:System.Diagnostics.EventLog.MachineName%2A>，本地计算机 ("。") 假定。</span><span class="sxs-lookup"><span data-stu-id="6be2f-835">If you do not specify the <xref:System.Diagnostics.EventLog.MachineName%2A>, the local computer (".") is assumed.</span></span>  
  
 <span data-ttu-id="6be2f-836">一个源一次仅注册到一个日志。</span><span class="sxs-lookup"><span data-stu-id="6be2f-836">A source can only be registered to one log at a time.</span></span> <span data-ttu-id="6be2f-837">如果<xref:System.Diagnostics.EventLog.Source%2A>属性已设置的实例<xref:System.Diagnostics.EventLog>，不能更改<xref:System.Diagnostics.EventLog.MachineName%2A>属性中的为该<xref:System.Diagnostics.EventLog>而无需更改的值<xref:System.Diagnostics.EventLog.Source%2A>或调用<xref:System.Diagnostics.EventLog.DeleteEventSource%2A>第一个。</span><span class="sxs-lookup"><span data-stu-id="6be2f-837">If the <xref:System.Diagnostics.EventLog.Source%2A> property was set for an instance of <xref:System.Diagnostics.EventLog>, you cannot change the <xref:System.Diagnostics.EventLog.MachineName%2A> property for that <xref:System.Diagnostics.EventLog> without changing the value of <xref:System.Diagnostics.EventLog.Source%2A> or calling <xref:System.Diagnostics.EventLog.DeleteEventSource%2A> first.</span></span> <span data-ttu-id="6be2f-838">如果你更改<xref:System.Diagnostics.EventLog.MachineName%2A>属性，<xref:System.Diagnostics.EventLog>关闭所有句柄并重新附加到的日志和新的计算机上的源。</span><span class="sxs-lookup"><span data-stu-id="6be2f-838">If you change the <xref:System.Diagnostics.EventLog.MachineName%2A> property, the <xref:System.Diagnostics.EventLog> closes all handles and reattaches to the log and source on the new computer.</span></span>  
  
 <span data-ttu-id="6be2f-839"><xref:System.Diagnostics.EventLog.MachineName%2A>值不能为空字符串。</span><span class="sxs-lookup"><span data-stu-id="6be2f-839">The <xref:System.Diagnostics.EventLog.MachineName%2A> value cannot be an empty string.</span></span> <span data-ttu-id="6be2f-840">如果显式设置，则默认为本地计算机 ("。")。</span><span class="sxs-lookup"><span data-stu-id="6be2f-840">If it is not explicitly set, it defaults to the local computer (".").</span></span>  
  
   
  
## Examples  
 <span data-ttu-id="6be2f-841">下面的示例读取在事件日志中，"NewEventLog"指定计算机上的项。</span><span class="sxs-lookup"><span data-stu-id="6be2f-841">The following example reads entries in the event log, "NewEventLog", on a specified computer.</span></span>  
  
 [!code-cpp[Classic EventLog.MachineName Example#1](~/samples/snippets/cpp/VS_Snippets_CLR_Classic/classic EventLog.MachineName Example/CPP/source.cpp#1)]
 [!code-csharp[Classic EventLog.MachineName Example#1](~/samples/snippets/csharp/VS_Snippets_CLR_Classic/classic EventLog.MachineName Example/CS/source.cs#1)]
 [!code-vb[Classic EventLog.MachineName Example#1](~/samples/snippets/visualbasic/VS_Snippets_CLR_Classic/classic EventLog.MachineName Example/VB/source.vb#1)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentException"><span data-ttu-id="6be2f-842">计算机名称无效。</span><span class="sxs-lookup"><span data-stu-id="6be2f-842">The computer name is invalid.</span></span></exception>
        <permission cref="T:System.Diagnostics.EventLogPermission"><span data-ttu-id="6be2f-843">用于写入的计算机上的事件日志信息。</span><span class="sxs-lookup"><span data-stu-id="6be2f-843">for writing the event log information on the computer.</span></span> <span data-ttu-id="6be2f-844">关联的枚举： <see cref="F:System.Diagnostics.EventLogPermissionAccess.Write" /></span><span class="sxs-lookup"><span data-stu-id="6be2f-844">Associated enumeration: <see cref="F:System.Diagnostics.EventLogPermissionAccess.Write" /></span></span></permission>
        <altmember cref="P:System.Diagnostics.EventLog.Log" />
        <altmember cref="P:System.Diagnostics.EventLog.Source" />
        <altmember cref="Overload:System.Diagnostics.EventLog.CreateEventSource" />
        <altmember cref="M:System.Diagnostics.EventLog.DeleteEventSource(System.String)" />
        <altmember cref="M:System.Diagnostics.EventLog.Delete(System.String)" />
        <altmember cref="M:System.Diagnostics.EventLog.SourceExists(System.String)" />
        <altmember cref="M:System.Diagnostics.EventLog.Exists(System.String)" />
        <altmember cref="M:System.Diagnostics.EventLog.GetEventLogs" />
      </Docs>
    </Member>
    <Member MemberName="MaximumKilobytes">
      <MemberSignature Language="C#" Value="public long MaximumKilobytes { get; set; }" />
      <MemberSignature Language="ILAsm" Value=".property instance int64 MaximumKilobytes" />
      <MemberSignature Language="DocId" Value="P:System.Diagnostics.EventLog.MaximumKilobytes" />
      <MemberSignature Language="VB.NET" Value="Public Property MaximumKilobytes As Long" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; property long MaximumKilobytes { long get(); void set(long value); };" />
      <MemberType>Property</MemberType>
      <AssemblyInfo>
        <AssemblyName>System</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Attributes>
        <Attribute>
          <AttributeName>System.ComponentModel.Browsable(false)</AttributeName>
        </Attribute>
        <Attribute>
          <AttributeName>System.ComponentModel.DesignerSerializationVisibility(System.ComponentModel.DesignerSerializationVisibility.Hidden)</AttributeName>
        </Attribute>
        <Attribute>
          <AttributeName>System.MonoTODO</AttributeName>
        </Attribute>
        <Attribute>
          <AttributeName>System.Runtime.InteropServices.ComVisible(false)</AttributeName>
        </Attribute>
      </Attributes>
      <ReturnValue>
        <ReturnType>System.Int64</ReturnType>
      </ReturnValue>
      <Docs>
        <summary><span data-ttu-id="6be2f-845">获取或设置最大事件日志大小（以 KB 为单位）。</span><span class="sxs-lookup"><span data-stu-id="6be2f-845">Gets or sets the maximum event log size in kilobytes.</span></span></summary>
        <value><span data-ttu-id="6be2f-846">最大事件日志大小（以 KB 为单位）。</span><span class="sxs-lookup"><span data-stu-id="6be2f-846">The maximum event log size in kilobytes.</span></span> <span data-ttu-id="6be2f-847">默认值为 512，表示最大文件大小为 512 KB。</span><span class="sxs-lookup"><span data-stu-id="6be2f-847">The default is 512, indicating a maximum file size of 512 kilobytes.</span></span></value>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="6be2f-848"><xref:System.Diagnostics.EventLog.MaximumKilobytes%2A>属性表示的事件日志文件的大小限制。</span><span class="sxs-lookup"><span data-stu-id="6be2f-848">The <xref:System.Diagnostics.EventLog.MaximumKilobytes%2A> property represents the size limit of the event log file.</span></span> <span data-ttu-id="6be2f-849">当在事件日志达到配置的大小限制<xref:System.Diagnostics.EventLog.OverflowAction%2A>值确定是否将丢弃新条目，或是否新条目覆盖旧条目。</span><span class="sxs-lookup"><span data-stu-id="6be2f-849">When the event log reaches the size limit, the configured <xref:System.Diagnostics.EventLog.OverflowAction%2A> value determines whether new entries are discarded, or whether new entries overwrite older entries.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="6be2f-850">此属性表示此实例所表示的事件日志的配置设置。</span><span class="sxs-lookup"><span data-stu-id="6be2f-850">This property represents a configuration setting for the event log represented by this instance.</span></span> <span data-ttu-id="6be2f-851">当事件日志达到其最大大小时，此属性指定操作系统如何处理为事件日志已注册的所有事件源都写入新条目。</span><span class="sxs-lookup"><span data-stu-id="6be2f-851">When the event log reaches its maximum size, this property specifies how the operating system handles new entries written by all event sources registered for the event log.</span></span>  
  
   
  
## Examples  
 <span data-ttu-id="6be2f-852">下面的示例枚举的本地计算机上定义的事件日志，并显示每个事件日志的配置详细信息。</span><span class="sxs-lookup"><span data-stu-id="6be2f-852">The following example enumerates the event logs defined on the local computer, and displays configuration details for each event log.</span></span>  
  
 [!code-cpp[EventLogProperties#2](~/samples/snippets/cpp/VS_Snippets_CLR/EventLogProperties/CPP/source.cpp#2)]
 [!code-csharp[EventLogProperties#2](~/samples/snippets/csharp/VS_Snippets_CLR/EventLogProperties/CS/source.cs#2)]
 [!code-vb[EventLogProperties#2](~/samples/snippets/visualbasic/VS_Snippets_CLR/EventLogProperties/VB/source.vb#2)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentOutOfRangeException"><span data-ttu-id="6be2f-853">指定值小于 64，或大于 4194240，或不是 64 的偶数倍。</span><span class="sxs-lookup"><span data-stu-id="6be2f-853">The specified value is less than 64, or greater than 4194240, or not an even multiple of 64.</span></span></exception>
        <exception cref="T:System.InvalidOperationException"><span data-ttu-id="6be2f-854"><see cref="P:System.Diagnostics.EventLog.Log" /> 值不是有效的日志名。</span><span class="sxs-lookup"><span data-stu-id="6be2f-854">The <see cref="P:System.Diagnostics.EventLog.Log" /> value is not a valid log name.</span></span>  
  
 <span data-ttu-id="6be2f-855">\- 或 -</span><span class="sxs-lookup"><span data-stu-id="6be2f-855">\- or -</span></span>  
  
 <span data-ttu-id="6be2f-856">事件日志的注册表项无法在目标计算机上打开。</span><span class="sxs-lookup"><span data-stu-id="6be2f-856">The registry key for the event log could not be opened on the target computer.</span></span></exception>
        <permission cref="T:System.Diagnostics.EventLogPermission"><span data-ttu-id="6be2f-857">用于管理的计算机上的事件日志信息。</span><span class="sxs-lookup"><span data-stu-id="6be2f-857">for administering event log information on the computer.</span></span> <span data-ttu-id="6be2f-858">关联的枚举： <see cref="F:System.Diagnostics.EventLogPermissionAccess.Administer" /></span><span class="sxs-lookup"><span data-stu-id="6be2f-858">Associated enumeration: <see cref="F:System.Diagnostics.EventLogPermissionAccess.Administer" /></span></span></permission>
        <altmember cref="P:System.Diagnostics.EventLog.OverflowAction" />
        <altmember cref="M:System.Diagnostics.EventLog.ModifyOverflowPolicy(System.Diagnostics.OverflowAction,System.Int32)" />
      </Docs>
    </Member>
    <Member MemberName="MinimumRetentionDays">
      <MemberSignature Language="C#" Value="public int MinimumRetentionDays { get; }" />
      <MemberSignature Language="ILAsm" Value=".property instance int32 MinimumRetentionDays" />
      <MemberSignature Language="DocId" Value="P:System.Diagnostics.EventLog.MinimumRetentionDays" />
      <MemberSignature Language="VB.NET" Value="Public ReadOnly Property MinimumRetentionDays As Integer" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; property int MinimumRetentionDays { int get(); };" />
      <MemberType>Property</MemberType>
      <AssemblyInfo>
        <AssemblyName>System</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Attributes>
        <Attribute>
          <AttributeName>System.ComponentModel.Browsable(false)</AttributeName>
        </Attribute>
        <Attribute>
          <AttributeName>System.MonoTODO</AttributeName>
        </Attribute>
        <Attribute>
          <AttributeName>System.Runtime.InteropServices.ComVisible(false)</AttributeName>
        </Attribute>
      </Attributes>
      <ReturnValue>
        <ReturnType>System.Int32</ReturnType>
      </ReturnValue>
      <Docs>
        <summary><span data-ttu-id="6be2f-859">获取要在事件日志中保留项的天数。</span><span class="sxs-lookup"><span data-stu-id="6be2f-859">Gets the number of days to retain entries in the event log.</span></span></summary>
        <value><span data-ttu-id="6be2f-860">事件日志中的项被保留的天数。</span><span class="sxs-lookup"><span data-stu-id="6be2f-860">The number of days that entries in the event log are retained.</span></span> <span data-ttu-id="6be2f-861">默认值为 7。</span><span class="sxs-lookup"><span data-stu-id="6be2f-861">The default value is 7.</span></span></value>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="6be2f-862">使用<xref:System.Diagnostics.EventLog.MinimumRetentionDays%2A>属性可以检查事件日志的当前设置。</span><span class="sxs-lookup"><span data-stu-id="6be2f-862">Use the <xref:System.Diagnostics.EventLog.MinimumRetentionDays%2A> property to examine the current setting for an event log.</span></span> <span data-ttu-id="6be2f-863">使用<xref:System.Diagnostics.EventLog.ModifyOverflowPolicy%2A>若要更改的最小天数必须保留在事件日志中的每个条目数。</span><span class="sxs-lookup"><span data-stu-id="6be2f-863">Use <xref:System.Diagnostics.EventLog.ModifyOverflowPolicy%2A> to change the minimum number of days that each entry in the event log must be retained.</span></span>  
  
 <span data-ttu-id="6be2f-864"><xref:System.Diagnostics.EventLog.MinimumRetentionDays%2A>值取决于在事件日志的已配置的溢出行为。</span><span class="sxs-lookup"><span data-stu-id="6be2f-864">The <xref:System.Diagnostics.EventLog.MinimumRetentionDays%2A> value depends on the configured overflow behavior of the event log.</span></span> <span data-ttu-id="6be2f-865">如果<xref:System.Diagnostics.OverflowAction>事件日志的属性设置为<xref:System.Diagnostics.OverflowAction.OverwriteAsNeeded>，则<xref:System.Diagnostics.EventLog.MinimumRetentionDays%2A>值为 0。</span><span class="sxs-lookup"><span data-stu-id="6be2f-865">If the <xref:System.Diagnostics.OverflowAction> property for an event log is set to <xref:System.Diagnostics.OverflowAction.OverwriteAsNeeded>, then the <xref:System.Diagnostics.EventLog.MinimumRetentionDays%2A> value is 0.</span></span> <span data-ttu-id="6be2f-866">如果<xref:System.Diagnostics.OverflowAction>事件日志的属性设置为<xref:System.Diagnostics.OverflowAction.DoNotOverwrite>，则<xref:System.Diagnostics.EventLog.MinimumRetentionDays%2A>值为-1。</span><span class="sxs-lookup"><span data-stu-id="6be2f-866">If the <xref:System.Diagnostics.OverflowAction> property for an event log is set to <xref:System.Diagnostics.OverflowAction.DoNotOverwrite>, then the <xref:System.Diagnostics.EventLog.MinimumRetentionDays%2A> value is -1.</span></span> <span data-ttu-id="6be2f-867">如果<xref:System.Diagnostics.OverflowAction>事件日志的属性设置为<xref:System.Diagnostics.OverflowAction.OverwriteOlder>，则<xref:System.Diagnostics.EventLog.MinimumRetentionDays%2A>值是大于零，并且表示的事件日志已满时保留事件日志条目的天数。</span><span class="sxs-lookup"><span data-stu-id="6be2f-867">If the <xref:System.Diagnostics.OverflowAction> property for an event log is set to <xref:System.Diagnostics.OverflowAction.OverwriteOlder>, then the <xref:System.Diagnostics.EventLog.MinimumRetentionDays%2A> value is greater than zero, and represents the number of days to retain event log entries when the event log is full.</span></span>  
  
 <span data-ttu-id="6be2f-868">溢出行为仅会在事件日志达到其容量限制时发生。</span><span class="sxs-lookup"><span data-stu-id="6be2f-868">The overflow behavior only occurs when an event log reaches its size limit.</span></span> <span data-ttu-id="6be2f-869">当<xref:System.Diagnostics.EventLog>具有其<xref:System.Diagnostics.EventLog.OverflowAction%2A>设置为<xref:System.Diagnostics.OverflowAction.OverwriteOlder>，和在事件日志达到其最大大小，则新条目如果它们可以将其保留时间超出的条目只能写入<xref:System.Diagnostics.EventLog.MinimumRetentionDays%2A>段。</span><span class="sxs-lookup"><span data-stu-id="6be2f-869">When an <xref:System.Diagnostics.EventLog> has its <xref:System.Diagnostics.EventLog.OverflowAction%2A> set to <xref:System.Diagnostics.OverflowAction.OverwriteOlder>, and the event log reaches its maximum size, then new entries are written only if they can replace entries whose age exceeds the <xref:System.Diagnostics.EventLog.MinimumRetentionDays%2A> period.</span></span> <span data-ttu-id="6be2f-870">事件项保留最短期限适合定期存档事件日志时的不同而不同。</span><span class="sxs-lookup"><span data-stu-id="6be2f-870">Retaining event entries for a minimum period is appropriate when the event log is archived regularly.</span></span> <span data-ttu-id="6be2f-871">否则，则可能在事件日志达到其限制时丢失新条目。</span><span class="sxs-lookup"><span data-stu-id="6be2f-871">Otherwise, you risk losing new entries when the event log reaches its limit.</span></span> <span data-ttu-id="6be2f-872">若要避免丢失新的事件信息，请设置基于对您的存档计划为特定的事件日志的事件的最小保留天数。</span><span class="sxs-lookup"><span data-stu-id="6be2f-872">To avoid losing new event information, set the minimum retention days for events based on your archive schedule for a particular event log.</span></span>  
  
   
  
## Examples  
 <span data-ttu-id="6be2f-873">下面的示例枚举的本地计算机上定义的事件日志，并显示每个事件日志的配置详细信息。</span><span class="sxs-lookup"><span data-stu-id="6be2f-873">The following example enumerates the event logs defined on the local computer, and displays configuration details for each event log.</span></span>  
  
 [!code-cpp[EventLogProperties#2](~/samples/snippets/cpp/VS_Snippets_CLR/EventLogProperties/CPP/source.cpp#2)]
 [!code-csharp[EventLogProperties#2](~/samples/snippets/csharp/VS_Snippets_CLR/EventLogProperties/CS/source.cs#2)]
 [!code-vb[EventLogProperties#2](~/samples/snippets/visualbasic/VS_Snippets_CLR/EventLogProperties/VB/source.vb#2)]  
  
 ]]></format>
        </remarks>
        <permission cref="T:System.Diagnostics.EventLogPermission"><span data-ttu-id="6be2f-874">用于管理的计算机上的事件日志信息。</span><span class="sxs-lookup"><span data-stu-id="6be2f-874">for administering event log information on the computer.</span></span> <span data-ttu-id="6be2f-875">关联的枚举： <see cref="F:System.Diagnostics.EventLogPermissionAccess.Administer" /></span><span class="sxs-lookup"><span data-stu-id="6be2f-875">Associated enumeration: <see cref="F:System.Diagnostics.EventLogPermissionAccess.Administer" /></span></span></permission>
        <altmember cref="P:System.Diagnostics.EventLog.MaximumKilobytes" />
        <altmember cref="M:System.Diagnostics.EventLog.ModifyOverflowPolicy(System.Diagnostics.OverflowAction,System.Int32)" />
        <altmember cref="P:System.Diagnostics.EventLog.OverflowAction" />
      </Docs>
    </Member>
    <Member MemberName="ModifyOverflowPolicy">
      <MemberSignature Language="C#" Value="public void ModifyOverflowPolicy (System.Diagnostics.OverflowAction action, int retentionDays);" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig instance void ModifyOverflowPolicy(valuetype System.Diagnostics.OverflowAction action, int32 retentionDays) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Diagnostics.EventLog.ModifyOverflowPolicy(System.Diagnostics.OverflowAction,System.Int32)" />
      <MemberSignature Language="VB.NET" Value="Public Sub ModifyOverflowPolicy (action As OverflowAction, retentionDays As Integer)" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; void ModifyOverflowPolicy(System::Diagnostics::OverflowAction action, int retentionDays);" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Attributes>
        <Attribute>
          <AttributeName>System.MonoTODO</AttributeName>
        </Attribute>
        <Attribute>
          <AttributeName>System.Runtime.InteropServices.ComVisible(false)</AttributeName>
        </Attribute>
      </Attributes>
      <ReturnValue>
        <ReturnType>System.Void</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="action" Type="System.Diagnostics.OverflowAction" />
        <Parameter Name="retentionDays" Type="System.Int32" />
      </Parameters>
      <Docs>
        <param name="action"><span data-ttu-id="6be2f-876">向事件日志写入新项的溢出行为。</span><span class="sxs-lookup"><span data-stu-id="6be2f-876">The overflow behavior for writing new entries to the event log.</span></span></param>
        <param name="retentionDays"><span data-ttu-id="6be2f-877">每个事件日志项要保留的最小天数。</span><span class="sxs-lookup"><span data-stu-id="6be2f-877">The minimum number of days each event log entry is retained.</span></span> <span data-ttu-id="6be2f-878">只有在 <c>action</c> 设置为 <see cref="F:System.Diagnostics.OverflowAction.OverwriteOlder" /> 时，才使用此参数。</span><span class="sxs-lookup"><span data-stu-id="6be2f-878">This parameter is used only if <c>action</c> is set to <see cref="F:System.Diagnostics.OverflowAction.OverwriteOlder" />.</span></span></param>
        <summary><span data-ttu-id="6be2f-879">更改已配置的行为，以便在事件日志达到其最大文件大小时写入新项。</span><span class="sxs-lookup"><span data-stu-id="6be2f-879">Changes the configured behavior for writing new entries when the event log reaches its maximum file size.</span></span></summary>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="6be2f-880">事件日志的溢出行为指定要写入到日志已达到其最大文件大小新条目时，会发生什么情况。</span><span class="sxs-lookup"><span data-stu-id="6be2f-880">The overflow behavior for an event log specifies what happens when new entries are to be written to a log that has reached its maximum file size.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="6be2f-881">溢出行为仅在事件日志达到其最大文件大小时生效。</span><span class="sxs-lookup"><span data-stu-id="6be2f-881">The overflow behavior takes effect only when an event log reaches its maximum file size.</span></span> <span data-ttu-id="6be2f-882">溢出行为不会影响到可以容纳其他事件日志条目的日志写入新的条目。</span><span class="sxs-lookup"><span data-stu-id="6be2f-882">The overflow behavior does not affect writing a new entry to a log that can accommodate additional event log entries.</span></span>  
  
 <span data-ttu-id="6be2f-883"><xref:System.Diagnostics.EventLog.ModifyOverflowPolicy%2A>方法配置事件日志的溢出行为。</span><span class="sxs-lookup"><span data-stu-id="6be2f-883">The <xref:System.Diagnostics.EventLog.ModifyOverflowPolicy%2A> method configures the overflow behavior of an event log.</span></span> <span data-ttu-id="6be2f-884"><xref:System.Diagnostics.EventLog> 实例。</span><span class="sxs-lookup"><span data-stu-id="6be2f-884"><xref:System.Diagnostics.EventLog> instance.</span></span> <span data-ttu-id="6be2f-885">为指定的事件日志中调用此方法后<xref:System.Diagnostics.EventLog.Log%2A>属性，<xref:System.Diagnostics.EventLog.OverflowAction%2A>和<xref:System.Diagnostics.EventLog.MinimumRetentionDays%2A>属性值反映新配置的溢出行为。</span><span class="sxs-lookup"><span data-stu-id="6be2f-885">After calling this method for the event log specified by the <xref:System.Diagnostics.EventLog.Log%2A> property, the <xref:System.Diagnostics.EventLog.OverflowAction%2A> and <xref:System.Diagnostics.EventLog.MinimumRetentionDays%2A> property values reflect the newly configured overflow behavior.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="6be2f-886">此属性表示此实例所表示的事件日志的配置设置。</span><span class="sxs-lookup"><span data-stu-id="6be2f-886">This property represents a configuration setting for the event log represented by this instance.</span></span> <span data-ttu-id="6be2f-887">当事件日志达到其最大大小时，此属性指定操作系统如何处理为事件日志已注册的所有事件源都写入新条目。</span><span class="sxs-lookup"><span data-stu-id="6be2f-887">When the event log reaches its maximum size, this property specifies how the operating system handles new entries written by all event sources registered for the event log.</span></span>  
  
 <span data-ttu-id="6be2f-888">设置`action`参数<xref:System.Diagnostics.OverflowAction.OverwriteAsNeeded>以指示新条目覆盖最旧条目时<xref:System.Diagnostics.EventLog>达到其最大大小。</span><span class="sxs-lookup"><span data-stu-id="6be2f-888">Set the `action` parameter to <xref:System.Diagnostics.OverflowAction.OverwriteAsNeeded> to indicate that a new entry overwrites the oldest entry when the <xref:System.Diagnostics.EventLog> reaches its maximum size.</span></span> <span data-ttu-id="6be2f-889">如果`action`参数设置为<xref:System.Diagnostics.OverflowAction.OverwriteAsNeeded>、`retentionDays`参数值将被忽略。</span><span class="sxs-lookup"><span data-stu-id="6be2f-889">If the `action` parameter is set to <xref:System.Diagnostics.OverflowAction.OverwriteAsNeeded>, the `retentionDays` parameter value is ignored.</span></span>  
  
 <span data-ttu-id="6be2f-890">设置`action`参数<xref:System.Diagnostics.OverflowAction.OverwriteOlder>以指示每个新条目将覆盖旧条目时<xref:System.Diagnostics.EventLog>达到其最大大小。</span><span class="sxs-lookup"><span data-stu-id="6be2f-890">Set the `action` parameter to <xref:System.Diagnostics.OverflowAction.OverwriteOlder> to indicate that each new entry overwrites older entries when the <xref:System.Diagnostics.EventLog> reaches its maximum size.</span></span> <span data-ttu-id="6be2f-891">指定在日志中使用的事件必须保留的天数`retentionDays`参数。</span><span class="sxs-lookup"><span data-stu-id="6be2f-891">Specify the number of days that events must be retained in the log using the `retentionDays` parameter.</span></span> <span data-ttu-id="6be2f-892">保持期内写入的事件不会覆盖通过新的条目。</span><span class="sxs-lookup"><span data-stu-id="6be2f-892">Events written within the retention range are not overwritten by new entries.</span></span>  
  
 <span data-ttu-id="6be2f-893">设置`action`参数<xref:System.Diagnostics.OverflowAction.DoNotOverwrite>丢弃新事件时已达到最大日志大小。</span><span class="sxs-lookup"><span data-stu-id="6be2f-893">Set the `action` parameter to <xref:System.Diagnostics.OverflowAction.DoNotOverwrite> to discard new events when the maximum log size is reached.</span></span> <span data-ttu-id="6be2f-894">如果`action`参数设置为<xref:System.Diagnostics.OverflowAction.DoNotOverwrite>、`retentionDays`参数值将被忽略。</span><span class="sxs-lookup"><span data-stu-id="6be2f-894">If the `action` parameter is set to <xref:System.Diagnostics.OverflowAction.DoNotOverwrite>, the `retentionDays` parameter value is ignored.</span></span>  
  
> [!CAUTION]
>  <span data-ttu-id="6be2f-895">将溢出策略设置为<xref:System.Diagnostics.OverflowAction.DoNotOverwrite>指定当事件日志已满而丢弃新条目。</span><span class="sxs-lookup"><span data-stu-id="6be2f-895">Setting the overflow policy to <xref:System.Diagnostics.OverflowAction.DoNotOverwrite> specifies that new entries are discarded when the event log is full.</span></span> <span data-ttu-id="6be2f-896">如果你使用此设置，请确保定期存档和清除避免达到其最大大小限制事件日志。</span><span class="sxs-lookup"><span data-stu-id="6be2f-896">If you use this setting, ensure the event log is regularly archived and cleared to avoid reaching its maximum size limit.</span></span>  
  
   
  
## Examples  
 <span data-ttu-id="6be2f-897">下面的示例显示一个指定的事件日志的已配置的溢出策略，并允许用户选择新事件日志的溢出策略设置。</span><span class="sxs-lookup"><span data-stu-id="6be2f-897">The following example displays the configured overflow policy for a specified event log, and allows the user to select a new overflow policy setting for the event log.</span></span>  
  
 [!code-cpp[EventLogProperties#3](~/samples/snippets/cpp/VS_Snippets_CLR/EventLogProperties/CPP/source.cpp#3)]
 [!code-csharp[EventLogProperties#3](~/samples/snippets/csharp/VS_Snippets_CLR/EventLogProperties/CS/source.cs#3)]
 [!code-vb[EventLogProperties#3](~/samples/snippets/visualbasic/VS_Snippets_CLR/EventLogProperties/VB/source.vb#3)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ComponentModel.InvalidEnumArgumentException">
          <span data-ttu-id="6be2f-898"><paramref name="action" /> 不是有效的 <see cref="P:System.Diagnostics.EventLog.OverflowAction" /> 值。</span><span class="sxs-lookup"><span data-stu-id="6be2f-898"><paramref name="action" /> is not a valid <see cref="P:System.Diagnostics.EventLog.OverflowAction" /> value.</span></span></exception>
        <exception cref="T:System.ArgumentOutOfRangeException">
          <span data-ttu-id="6be2f-899"><paramref name="retentionDays" /> 小于 1 或大于 365。</span><span class="sxs-lookup"><span data-stu-id="6be2f-899"><paramref name="retentionDays" /> is less than one, or larger than 365.</span></span></exception>
        <exception cref="T:System.InvalidOperationException"><span data-ttu-id="6be2f-900"><see cref="P:System.Diagnostics.EventLog.Log" /> 值不是有效的日志名。</span><span class="sxs-lookup"><span data-stu-id="6be2f-900">The <see cref="P:System.Diagnostics.EventLog.Log" /> value is not a valid log name.</span></span>  
  
 <span data-ttu-id="6be2f-901">\- 或 -</span><span class="sxs-lookup"><span data-stu-id="6be2f-901">\- or -</span></span>  
  
 <span data-ttu-id="6be2f-902">事件日志的注册表项无法在目标计算机上打开。</span><span class="sxs-lookup"><span data-stu-id="6be2f-902">The registry key for the event log could not be opened on the target computer.</span></span></exception>
        <permission cref="T:System.Diagnostics.EventLogPermission"><span data-ttu-id="6be2f-903">用于管理的计算机上的事件日志信息。</span><span class="sxs-lookup"><span data-stu-id="6be2f-903">for administering event log information on the computer.</span></span> <span data-ttu-id="6be2f-904">关联的枚举： <see cref="F:System.Diagnostics.EventLogPermissionAccess.Administer" /></span><span class="sxs-lookup"><span data-stu-id="6be2f-904">Associated enumeration: <see cref="F:System.Diagnostics.EventLogPermissionAccess.Administer" /></span></span></permission>
        <altmember cref="T:System.Diagnostics.OverflowAction" />
        <altmember cref="P:System.Diagnostics.EventLog.MaximumKilobytes" />
        <altmember cref="P:System.Diagnostics.EventLog.OverflowAction" />
        <altmember cref="P:System.Diagnostics.EventLog.MinimumRetentionDays" />
      </Docs>
    </Member>
    <Member MemberName="OverflowAction">
      <MemberSignature Language="C#" Value="public System.Diagnostics.OverflowAction OverflowAction { get; }" />
      <MemberSignature Language="ILAsm" Value=".property instance valuetype System.Diagnostics.OverflowAction OverflowAction" />
      <MemberSignature Language="DocId" Value="P:System.Diagnostics.EventLog.OverflowAction" />
      <MemberSignature Language="VB.NET" Value="Public ReadOnly Property OverflowAction As OverflowAction" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; property System::Diagnostics::OverflowAction OverflowAction { System::Diagnostics::OverflowAction get(); };" />
      <MemberType>Property</MemberType>
      <AssemblyInfo>
        <AssemblyName>System</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Attributes>
        <Attribute>
          <AttributeName>System.ComponentModel.Browsable(false)</AttributeName>
        </Attribute>
        <Attribute>
          <AttributeName>System.MonoTODO</AttributeName>
        </Attribute>
        <Attribute>
          <AttributeName>System.Runtime.InteropServices.ComVisible(false)</AttributeName>
        </Attribute>
      </Attributes>
      <ReturnValue>
        <ReturnType>System.Diagnostics.OverflowAction</ReturnType>
      </ReturnValue>
      <Docs>
        <summary><span data-ttu-id="6be2f-905">获取已配置的行为，以便在事件日志达到其最大文件大小时存储新项。</span><span class="sxs-lookup"><span data-stu-id="6be2f-905">Gets the configured behavior for storing new entries when the event log reaches its maximum log file size.</span></span></summary>
        <value><span data-ttu-id="6be2f-906"><see cref="T:System.Diagnostics.OverflowAction" /> 值，指定在事件日志达到其最大日志大小时存储新项的已配置行为。</span><span class="sxs-lookup"><span data-stu-id="6be2f-906">The <see cref="T:System.Diagnostics.OverflowAction" /> value that specifies the configured behavior for storing new entries when the event log reaches its maximum log size.</span></span> <span data-ttu-id="6be2f-907">默认值为 <see cref="F:System.Diagnostics.OverflowAction.OverwriteOlder" />。</span><span class="sxs-lookup"><span data-stu-id="6be2f-907">The default is <see cref="F:System.Diagnostics.OverflowAction.OverwriteOlder" />.</span></span></value>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="6be2f-908">事件日志大小增大新事件写入到它们。</span><span class="sxs-lookup"><span data-stu-id="6be2f-908">Event logs grow in size as new events are written to them.</span></span> <span data-ttu-id="6be2f-909">每个事件日志的配置的最大大小限制;<xref:System.Diagnostics.EventLog.MaximumKilobytes%2A>属性定义的最大事件日志文件大小所允许的千字节数。</span><span class="sxs-lookup"><span data-stu-id="6be2f-909">Each event log has a configured maximum size limit; the <xref:System.Diagnostics.EventLog.MaximumKilobytes%2A> property defines the maximum number of kilobytes allowed for the event log file size.</span></span>  
  
 <span data-ttu-id="6be2f-910">使用<xref:System.Diagnostics.EventLog.OverflowAction%2A>要检查其最大大小在事件日志的已配置的溢出行为的属性值。</span><span class="sxs-lookup"><span data-stu-id="6be2f-910">Use the <xref:System.Diagnostics.EventLog.OverflowAction%2A> property value to examine the configured overflow behavior for an event log at its maximum size.</span></span> <span data-ttu-id="6be2f-911">使用<xref:System.Diagnostics.EventLog.ModifyOverflowPolicy%2A>方法来更改事件日志的溢出行为。</span><span class="sxs-lookup"><span data-stu-id="6be2f-911">Use the <xref:System.Diagnostics.EventLog.ModifyOverflowPolicy%2A> method to change the overflow behavior for an event log.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="6be2f-912">溢出行为仅在事件日志达到其最大文件大小时生效。</span><span class="sxs-lookup"><span data-stu-id="6be2f-912">The overflow behavior takes effect only when an event log reaches its maximum file size.</span></span> <span data-ttu-id="6be2f-913">溢出行为不会影响到可以容纳其他事件日志条目的日志写入新的条目。</span><span class="sxs-lookup"><span data-stu-id="6be2f-913">The overflow behavior does not affect writing a new entry to a log that can accommodate additional event log entries.</span></span>  
  
   
  
## Examples  
 <span data-ttu-id="6be2f-914">下面的示例枚举的本地计算机上定义的事件日志，并显示每个事件日志的配置详细信息。</span><span class="sxs-lookup"><span data-stu-id="6be2f-914">The following example enumerates the event logs defined on the local computer, and displays configuration details for each event log.</span></span>  
  
 [!code-cpp[EventLogProperties#2](~/samples/snippets/cpp/VS_Snippets_CLR/EventLogProperties/CPP/source.cpp#2)]
 [!code-csharp[EventLogProperties#2](~/samples/snippets/csharp/VS_Snippets_CLR/EventLogProperties/CS/source.cs#2)]
 [!code-vb[EventLogProperties#2](~/samples/snippets/visualbasic/VS_Snippets_CLR/EventLogProperties/VB/source.vb#2)]  
  
 ]]></format>
        </remarks>
        <permission cref="T:System.Diagnostics.EventLogPermission"><span data-ttu-id="6be2f-915">用于管理的计算机上的事件日志信息。</span><span class="sxs-lookup"><span data-stu-id="6be2f-915">for administering event log information on the computer.</span></span> <span data-ttu-id="6be2f-916">关联的枚举： <see cref="F:System.Diagnostics.EventLogPermissionAccess.Administer" /></span><span class="sxs-lookup"><span data-stu-id="6be2f-916">Associated enumeration: <see cref="F:System.Diagnostics.EventLogPermissionAccess.Administer" /></span></span></permission>
        <altmember cref="T:System.Diagnostics.OverflowAction" />
        <altmember cref="P:System.Diagnostics.EventLog.MaximumKilobytes" />
        <altmember cref="M:System.Diagnostics.EventLog.ModifyOverflowPolicy(System.Diagnostics.OverflowAction,System.Int32)" />
        <altmember cref="P:System.Diagnostics.EventLog.MinimumRetentionDays" />
      </Docs>
    </Member>
    <Member MemberName="RegisterDisplayName">
      <MemberSignature Language="C#" Value="public void RegisterDisplayName (string resourceFile, long resourceId);" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig instance void RegisterDisplayName(string resourceFile, int64 resourceId) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Diagnostics.EventLog.RegisterDisplayName(System.String,System.Int64)" />
      <MemberSignature Language="VB.NET" Value="Public Sub RegisterDisplayName (resourceFile As String, resourceId As Long)" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; void RegisterDisplayName(System::String ^ resourceFile, long resourceId);" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Attributes>
        <Attribute>
          <AttributeName>System.MonoTODO</AttributeName>
        </Attribute>
        <Attribute>
          <AttributeName>System.Runtime.InteropServices.ComVisible(false)</AttributeName>
        </Attribute>
      </Attributes>
      <ReturnValue>
        <ReturnType>System.Void</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="resourceFile" Type="System.String" />
        <Parameter Name="resourceId" Type="System.Int64" />
      </Parameters>
      <Docs>
        <param name="resourceFile"><span data-ttu-id="6be2f-917">本地化资源文件的完全指定的路径。</span><span class="sxs-lookup"><span data-stu-id="6be2f-917">The fully specified path to a localized resource file.</span></span></param>
        <param name="resourceId"><span data-ttu-id="6be2f-918">在资源文件内指明一个本地化字符串的资源标识符。</span><span class="sxs-lookup"><span data-stu-id="6be2f-918">The resource identifier that indexes a localized string within the resource file.</span></span></param>
        <summary><span data-ttu-id="6be2f-919">指定该事件日志的本地化名称，它显示在服务器事件查看器中。</span><span class="sxs-lookup"><span data-stu-id="6be2f-919">Specifies the localized name of the event log, which is displayed in the server Event Viewer.</span></span></summary>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="6be2f-920">使用<xref:System.Diagnostics.EventLog.RegisterDisplayName%2A>注册以及自定义事件日志事件查看器中显示的本地化的名称。</span><span class="sxs-lookup"><span data-stu-id="6be2f-920">Use <xref:System.Diagnostics.EventLog.RegisterDisplayName%2A> to register and display a localized name in the Event Viewer for custom event logs.</span></span>  
  
 <span data-ttu-id="6be2f-921">指定的资源标识符必须对应于在资源文件中定义的本地化字符串。</span><span class="sxs-lookup"><span data-stu-id="6be2f-921">The specified resource identifier must correspond to a localized string defined in the resource file.</span></span> <span data-ttu-id="6be2f-922">事件查看器显示使用本地化的字符串和当前区域性设置的自定义事件日志名称。</span><span class="sxs-lookup"><span data-stu-id="6be2f-922">The Event Viewer displays the custom event log name using the localized string and the current culture settings.</span></span> <span data-ttu-id="6be2f-923">例如，你可以定义多个资源文件中的不同区域性的本地化的事件日志名称。</span><span class="sxs-lookup"><span data-stu-id="6be2f-923">For example, you can define multiple event log names localized for different cultures in your resource file.</span></span> <span data-ttu-id="6be2f-924">事件查看器显示当前用户的区域性设置相对应的本地化的字符串。</span><span class="sxs-lookup"><span data-stu-id="6be2f-924">The Event Viewer displays the localized string corresponding to the culture settings of the current user.</span></span>  
  
 <span data-ttu-id="6be2f-925">如果事件查看器无法从资源文件中，加载本地化的字符串，或如果没有显示名称已注册的事件日志中，事件查看器显示中定义的事件日志名称<xref:System.Diagnostics.EventLog.Log%2A>。</span><span class="sxs-lookup"><span data-stu-id="6be2f-925">If the Event Viewer cannot load the localized string from the resource file, or if no display name was registered for the event log, then the Event Viewer displays the event log name defined in <xref:System.Diagnostics.EventLog.Log%2A>.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="6be2f-926">不需要注册预定义的事件日志的显示名称。</span><span class="sxs-lookup"><span data-stu-id="6be2f-926">You do not need to register a display name for the pre-defined event logs.</span></span> <span data-ttu-id="6be2f-927">操作系统注册应用程序、 系统和安全事件日志的本地化的显示名称。</span><span class="sxs-lookup"><span data-stu-id="6be2f-927">The operating system registers the localized display names for the Application, System, and Security event logs.</span></span>  
  
   
  
## Examples  
 <span data-ttu-id="6be2f-928">下面的示例确定是否将名为事件源`SampleApplicationSource`已在本地计算机上注册。</span><span class="sxs-lookup"><span data-stu-id="6be2f-928">The following example determines whether the event source named `SampleApplicationSource` is registered on the local computer.</span></span> <span data-ttu-id="6be2f-929">如果事件源不存在，该示例设置源的消息资源文件，并创建新的事件源。</span><span class="sxs-lookup"><span data-stu-id="6be2f-929">If the event source does not exist, the example sets the message resource file for the source and creates the new event source.</span></span> <span data-ttu-id="6be2f-930">最后，该示例设置使用中的资源标识符值的事件日志的本地化的显示名称`DisplayNameMsgId`和中的资源文件路径`messageFile`。</span><span class="sxs-lookup"><span data-stu-id="6be2f-930">Finally, the example sets the localized display name for the event log, using the resource identifier value in `DisplayNameMsgId` and the resource file path in `messageFile`.</span></span>  
  
 [!code-cpp[EventLog_WriteEvent#6](~/samples/snippets/cpp/VS_Snippets_CLR/eventlog_WriteEvent/CPP/source.cpp#6)]
 [!code-csharp[EventLog_WriteEvent#6](~/samples/snippets/csharp/VS_Snippets_CLR/eventlog_WriteEvent/CS/source.cs#6)]
 [!code-vb[EventLog_WriteEvent#6](~/samples/snippets/visualbasic/VS_Snippets_CLR/eventlog_WriteEvent/VB/source.vb#6)]  
  
 <span data-ttu-id="6be2f-931">该示例使用以下的消息文本文件，内置于 EventLogMsgs.dll 的资源库。</span><span class="sxs-lookup"><span data-stu-id="6be2f-931">The example uses the following message text file, built into the resource library EventLogMsgs.dll.</span></span> <span data-ttu-id="6be2f-932">消息文本文件是从其创建的消息资源文件的源。</span><span class="sxs-lookup"><span data-stu-id="6be2f-932">A message text file is the source from which the message resource file is created.</span></span> <span data-ttu-id="6be2f-933">消息文本文件定义的资源标识符和类别、 事件消息和参数插入字符串的文本。</span><span class="sxs-lookup"><span data-stu-id="6be2f-933">The message text file defines the resource identifiers and text for the category, event message, and parameter insertion strings.</span></span> <span data-ttu-id="6be2f-934">具体而言，为事件日志的本地化名称定义了资源标识符 5001。</span><span class="sxs-lookup"><span data-stu-id="6be2f-934">Specifically, resource identifier 5001 is defined for the localized name of the event log.</span></span>  
  
```  
; // EventLogMsgs.mc  
; // ********************************************************  
  
; // Use the following commands to build this file:  
  
; //   mc -s EventLogMsgs.mc  
; //   rc EventLogMsgs.rc  
; //   link /DLL /SUBSYSTEM:WINDOWS /NOENTRY /MACHINE:x86 EventLogMsgs.Res   
; // ********************************************************  
  
; // - Event categories -  
; // Categories must be numbered consecutively starting at 1.  
; // ********************************************************  
  
MessageId=0x1  
Severity=Success  
SymbolicName=INSTALL_CATEGORY  
Language=English  
Installation  
.  
  
MessageId=0x2  
Severity=Success  
SymbolicName=QUERY_CATEGORY  
Language=English  
Database Query  
.  
  
MessageId=0x3  
Severity=Success  
SymbolicName=REFRESH_CATEGORY  
Language=English  
Data Refresh  
.  
  
; // - Event messages -  
; // *********************************  
  
MessageId = 1000  
Severity = Success  
Facility = Application  
SymbolicName = AUDIT_SUCCESS_MESSAGE_ID_1000  
Language=English  
My application message text, in English, for message id 1000, called from %1.  
.  
  
MessageId = 1001  
Severity = Warning  
Facility = Application  
SymbolicName = AUDIT_FAILED_MESSAGE_ID_1001  
Language=English  
My application message text, in English, for message id 1001, called from %1.  
.  
  
MessageId = 1002  
Severity = Success  
Facility = Application  
SymbolicName = GENERIC_INFO_MESSAGE_ID_1002  
Language=English  
My generic information message in English, for message id 1002.  
.  
  
MessageId = 1003  
Severity = Warning  
Facility = Application  
SymbolicName = GENERIC_WARNING_MESSAGE_ID_1003  
Language=English  
My generic warning message in English, for message id 1003, called from %1.  
.  
  
MessageId = 1004  
Severity = Success  
Facility = Application  
SymbolicName = UPDATE_CYCLE_COMPLETE_MESSAGE_ID_1004  
Language=English  
The update cycle is complete for %%5002.  
.  
  
MessageId = 1005  
Severity = Warning  
Facility = Application  
SymbolicName = SERVER_CONNECTION_DOWN_MESSAGE_ID_1005  
Language=English  
The refresh operation did not complete because the connection to server %1 could not be established.  
.  
  
; // - Event log display name -  
; // ********************************************************  
  
MessageId = 5001  
Severity = Success  
Facility = Application  
SymbolicName = EVENT_LOG_DISPLAY_NAME_MSGID  
Language=English  
Sample Event Log  
.  
  
; // - Event message parameters -  
; //   Language independent insertion strings  
; // ********************************************************  
  
MessageId = 5002  
Severity = Success  
Facility = Application  
SymbolicName = EVENT_LOG_SERVICE_NAME_MSGID  
Language=English  
SVC_UPDATE.EXE  
.  
```  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.InvalidOperationException"><span data-ttu-id="6be2f-935"><see cref="P:System.Diagnostics.EventLog.Log" /> 值不是有效的日志名。</span><span class="sxs-lookup"><span data-stu-id="6be2f-935">The <see cref="P:System.Diagnostics.EventLog.Log" /> value is not a valid log name.</span></span>  
  
 <span data-ttu-id="6be2f-936">\- 或 -</span><span class="sxs-lookup"><span data-stu-id="6be2f-936">\- or -</span></span>  
  
 <span data-ttu-id="6be2f-937">事件日志的注册表项无法在目标计算机上打开。</span><span class="sxs-lookup"><span data-stu-id="6be2f-937">The registry key for the event log could not be opened on the target computer.</span></span></exception>
        <exception cref="T:System.ArgumentNullException">
          <span data-ttu-id="6be2f-938"><paramref name="resourceFile" /> 为 <see langword="null" />。</span><span class="sxs-lookup"><span data-stu-id="6be2f-938"><paramref name="resourceFile" /> is <see langword="null" />.</span></span></exception>
        <permission cref="T:System.Diagnostics.EventLogPermission"><span data-ttu-id="6be2f-939">用于管理的计算机上的事件日志信息。</span><span class="sxs-lookup"><span data-stu-id="6be2f-939">for administering event log information on the computer.</span></span> <span data-ttu-id="6be2f-940">关联的枚举： <see cref="F:System.Diagnostics.EventLogPermissionAccess.Administer" /></span><span class="sxs-lookup"><span data-stu-id="6be2f-940">Associated enumeration: <see cref="F:System.Diagnostics.EventLogPermissionAccess.Administer" /></span></span></permission>
        <altmember cref="P:System.Diagnostics.EventLog.LogDisplayName" />
      </Docs>
    </Member>
    <Member MemberName="Source">
      <MemberSignature Language="C#" Value="public string Source { get; set; }" />
      <MemberSignature Language="ILAsm" Value=".property instance string Source" />
      <MemberSignature Language="DocId" Value="P:System.Diagnostics.EventLog.Source" />
      <MemberSignature Language="VB.NET" Value="Public Property Source As String" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; property System::String ^ Source { System::String ^ get(); void set(System::String ^ value); };" />
      <MemberType>Property</MemberType>
      <AssemblyInfo>
        <AssemblyName>System</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Attributes>
        <Attribute>
          <AttributeName>System.ComponentModel.DefaultValue("")</AttributeName>
        </Attribute>
        <Attribute>
          <AttributeName>System.ComponentModel.ReadOnly(true)</AttributeName>
        </Attribute>
        <Attribute>
          <AttributeName>System.ComponentModel.RecommendedAsConfigurable(true)</AttributeName>
        </Attribute>
        <Attribute>
          <AttributeName>System.ComponentModel.TypeConverter("System.Diagnostics.Design.StringValueConverter, System.Design, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b03f5f7f11d50a3a")</AttributeName>
        </Attribute>
        <Attribute>
          <AttributeName>System.Diagnostics.MonitoringDescription("The application name that writes the log.")</AttributeName>
        </Attribute>
      </Attributes>
      <ReturnValue>
        <ReturnType>System.String</ReturnType>
      </ReturnValue>
      <Docs>
        <summary><span data-ttu-id="6be2f-941">获取或设置在写入事件日志时要注册和使用的源名称。</span><span class="sxs-lookup"><span data-stu-id="6be2f-941">Gets or sets the source name to register and use when writing to the event log.</span></span></summary>
        <value><span data-ttu-id="6be2f-942">在事件日志中注册为项源的名称。</span><span class="sxs-lookup"><span data-stu-id="6be2f-942">The name registered with the event log as a source of entries.</span></span> <span data-ttu-id="6be2f-943">默认值为空字符串("")。</span><span class="sxs-lookup"><span data-stu-id="6be2f-943">The default is an empty string ("").</span></span></value>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="6be2f-944">事件源指示什么来记录事件。</span><span class="sxs-lookup"><span data-stu-id="6be2f-944">The event source indicates what logs the event.</span></span> <span data-ttu-id="6be2f-945">通常很的应用程序，名称或名称的子组件的应用程序，如果应用程序非常大。</span><span class="sxs-lookup"><span data-stu-id="6be2f-945">It is often the name of the application, or the name of a subcomponent of the application, if the application is large.</span></span> <span data-ttu-id="6be2f-946">应用程序和服务应写入应用程序日志或自定义日志。</span><span class="sxs-lookup"><span data-stu-id="6be2f-946">Applications and services should write to the Application log or a custom log.</span></span> <span data-ttu-id="6be2f-947">设备驱动程序应写入系统日志。</span><span class="sxs-lookup"><span data-stu-id="6be2f-947">Device drivers should write to the System log.</span></span>  
  
 <span data-ttu-id="6be2f-948">只需指定事件源，如果要写入事件日志。</span><span class="sxs-lookup"><span data-stu-id="6be2f-948">You only need to specify an event source if you are writing to an event log.</span></span> <span data-ttu-id="6be2f-949">然后再写入事件日志条目，你必须将注册事件源的事件日志有效的事件源。</span><span class="sxs-lookup"><span data-stu-id="6be2f-949">Before writing an entry to an event log, you must register the event source with the event log as a valid source of events.</span></span> <span data-ttu-id="6be2f-950">当你编写日志条目时，系统将使用<xref:System.Diagnostics.EventLog.Source%2A>属性以查找要在其中放置你的输入适当的日志。</span><span class="sxs-lookup"><span data-stu-id="6be2f-950">When you write a log entry, the system uses the <xref:System.Diagnostics.EventLog.Source%2A> property to find the appropriate log in which to place your entry.</span></span> <span data-ttu-id="6be2f-951">如果您正在读取事件日志，你可以指定<xref:System.Diagnostics.EventLog.Source%2A>，或<xref:System.Diagnostics.EventLog.Log%2A>和<xref:System.Diagnostics.EventLog.MachineName%2A>。</span><span class="sxs-lookup"><span data-stu-id="6be2f-951">If you are reading the event log, you can either specify the <xref:System.Diagnostics.EventLog.Source%2A>, or a <xref:System.Diagnostics.EventLog.Log%2A> and <xref:System.Diagnostics.EventLog.MachineName%2A>.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="6be2f-952">你不需要指定<xref:System.Diagnostics.EventLog.MachineName%2A>如果要连接到本地计算机上的日志。</span><span class="sxs-lookup"><span data-stu-id="6be2f-952">You are not required to specify the <xref:System.Diagnostics.EventLog.MachineName%2A> if you are connecting to a log on the local computer.</span></span> <span data-ttu-id="6be2f-953">如果不指定<xref:System.Diagnostics.EventLog.MachineName%2A>，本地计算机 ("。") 假定。</span><span class="sxs-lookup"><span data-stu-id="6be2f-953">If you do not specify the <xref:System.Diagnostics.EventLog.MachineName%2A>, the local computer (".") is assumed.</span></span>  
  
 <span data-ttu-id="6be2f-954">使用<xref:System.Diagnostics.EventLog.WriteEvent%2A>和<xref:System.Diagnostics.EventLog.WriteEntry%2A>事件写入事件日志。</span><span class="sxs-lookup"><span data-stu-id="6be2f-954">Use <xref:System.Diagnostics.EventLog.WriteEvent%2A> and <xref:System.Diagnostics.EventLog.WriteEntry%2A> to write events to an event log.</span></span> <span data-ttu-id="6be2f-955">必须指定事件源写入事件;你必须创建并在编写与源的第一个条目之前，配置事件源。</span><span class="sxs-lookup"><span data-stu-id="6be2f-955">You must specify an event source to write events; you must create and configure the event source before writing the first entry with the source.</span></span>  
  
 <span data-ttu-id="6be2f-956">在你的应用程序的安装过程中创建新的事件源。</span><span class="sxs-lookup"><span data-stu-id="6be2f-956">Create the new event source during the installation of your application.</span></span> <span data-ttu-id="6be2f-957">这样，可以为操作系统来刷新其已注册的事件源的列表和其配置的时间。</span><span class="sxs-lookup"><span data-stu-id="6be2f-957">This allows time for the operating system to refresh its list of registered event sources and their configuration.</span></span> <span data-ttu-id="6be2f-958">如果操作系统未刷新其事件源的列表，并尝试写入新的源的事件写入操作将失败。</span><span class="sxs-lookup"><span data-stu-id="6be2f-958">If the operating system has not refreshed its list of event sources, and you attempt to write an event with the new source, the write operation will fail.</span></span> <span data-ttu-id="6be2f-959">你可以配置新的源使用<xref:System.Diagnostics.EventLogInstaller>，或使用<xref:System.Diagnostics.EventLog.CreateEventSource%2A>方法。</span><span class="sxs-lookup"><span data-stu-id="6be2f-959">You can configure a new source using an <xref:System.Diagnostics.EventLogInstaller>, or using the <xref:System.Diagnostics.EventLog.CreateEventSource%2A> method.</span></span> <span data-ttu-id="6be2f-960">若要创建新的事件源的计算机上，必须具有管理权限。</span><span class="sxs-lookup"><span data-stu-id="6be2f-960">You must have administrative rights on the computer to create a new event source.</span></span>  
  
 <span data-ttu-id="6be2f-961">你可以创建现有的事件日志或新的事件日志的事件源。</span><span class="sxs-lookup"><span data-stu-id="6be2f-961">You can create an event source for an existing event log or a new event log.</span></span> <span data-ttu-id="6be2f-962">在创建新的源的新的事件日志时，系统将为该日志，此源注册，但之前向其中写入的第一个条目，将不会创建日志。</span><span class="sxs-lookup"><span data-stu-id="6be2f-962">When you create a new source for a new event log, the system registers the source for that log, but the log is not created until the first entry is written to it.</span></span>  
  
 <span data-ttu-id="6be2f-963">必须是唯一的本地计算机; 上的源新的源名称不能与现有源名称或现有的事件日志名称匹配。</span><span class="sxs-lookup"><span data-stu-id="6be2f-963">The source must be unique on the local computer; a new source name cannot match an existing source name or an existing event log name.</span></span> <span data-ttu-id="6be2f-964">每个源可以一次; 写入只有一个事件日志但是，你的应用程序可以使用多个源写入多个事件日志。</span><span class="sxs-lookup"><span data-stu-id="6be2f-964">Each source can write to only one event log at a time; however, your application can use multiple sources to write to multiple event logs.</span></span> <span data-ttu-id="6be2f-965">例如，你的应用程序可能需要为不同的事件日志或不同的资源文件配置的多个源。</span><span class="sxs-lookup"><span data-stu-id="6be2f-965">For example, your application might require multiple sources configured for different event logs or different resource files.</span></span>  
  
 <span data-ttu-id="6be2f-966">如果你更改<xref:System.Diagnostics.EventLog.Source%2A>值，<xref:System.Diagnostics.EventLog>到它注册已关闭并释放所有事件句柄。</span><span class="sxs-lookup"><span data-stu-id="6be2f-966">If you change the <xref:System.Diagnostics.EventLog.Source%2A> value, the <xref:System.Diagnostics.EventLog> to which it is registered is closed and all event handles are released.</span></span>  
  
 <span data-ttu-id="6be2f-967">要写入本地化的项还是要直接写入字符串，则必须配置源。</span><span class="sxs-lookup"><span data-stu-id="6be2f-967">The source must be configured either for writing localized entries or for writing direct strings.</span></span> <span data-ttu-id="6be2f-968">如果你的应用程序将使用资源标识符和字符串值的条目，则必须注册两个单独的源。</span><span class="sxs-lookup"><span data-stu-id="6be2f-968">If your application writes entries using both resource identifiers and string values, you must register two separate sources.</span></span> <span data-ttu-id="6be2f-969">例如，使用资源文件，配置一个源，然后使用在该源<xref:System.Diagnostics.EventLog.WriteEvent%2A>方法来编写使用到事件日志的资源标识符的条目。</span><span class="sxs-lookup"><span data-stu-id="6be2f-969">For example, configure one source with resource files, and then use that source in the <xref:System.Diagnostics.EventLog.WriteEvent%2A> method to write entries using resource identifiers to the event log.</span></span> <span data-ttu-id="6be2f-970">然后创建不同的源，而无需资源文件，并使用在该源<xref:System.Diagnostics.EventLog.WriteEntry%2A>方法使用该源的事件日志中直接写入字符串。</span><span class="sxs-lookup"><span data-stu-id="6be2f-970">Then create a different source without resource files, and use that source in the <xref:System.Diagnostics.EventLog.WriteEntry%2A> method to write strings directly to the event log using that source.</span></span>  
  
 <span data-ttu-id="6be2f-971">若要更改现有源的配置详细信息，必须删除源，然后使用新的配置创建。</span><span class="sxs-lookup"><span data-stu-id="6be2f-971">To change the configuration details of an existing source, you must delete the source and then create it with the new configuration.</span></span> <span data-ttu-id="6be2f-972">如果其他应用程序或组件使用的现有源，请使用更新的配置，而无需删除现有的源创建新的源。</span><span class="sxs-lookup"><span data-stu-id="6be2f-972">If other applications or components use the existing source, create a new source with the updated configuration rather than deleting the existing source.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="6be2f-973">如果源已映射到某个日志并重新映射到新的日志，必须重新启动计算机才能使更改生效。</span><span class="sxs-lookup"><span data-stu-id="6be2f-973">If a source has already been mapped to a log and you remap it to a new log, you must restart the computer for the changes to take effect.</span></span>  
  
   
  
## Examples  
 <span data-ttu-id="6be2f-974">下面的示例创建源`MySource`如果它尚不存在，并将项写入事件日志`MyNewLog`。</span><span class="sxs-lookup"><span data-stu-id="6be2f-974">The following example creates the source `MySource` if it does not already exist, and writes an entry to the event log `MyNewLog`.</span></span>  
  
 [!code-cpp[Classic EventLog.Source Example#1](~/samples/snippets/cpp/VS_Snippets_CLR_Classic/classic EventLog.Source Example/CPP/source.cpp#1)]
 [!code-csharp[Classic EventLog.Source Example#1](~/samples/snippets/csharp/VS_Snippets_CLR_Classic/classic EventLog.Source Example/CS/source.cs#1)]
 [!code-vb[Classic EventLog.Source Example#1](~/samples/snippets/visualbasic/VS_Snippets_CLR_Classic/classic EventLog.Source Example/VB/source.vb#1)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentException"><span data-ttu-id="6be2f-975">此源名称导致注册表项路径的长度超过 254 个字符。</span><span class="sxs-lookup"><span data-stu-id="6be2f-975">The source name results in a registry key path longer than 254 characters.</span></span></exception>
        <permission cref="T:System.Diagnostics.EventLogPermission"><span data-ttu-id="6be2f-976">用于写入的计算机上的事件日志信息。</span><span class="sxs-lookup"><span data-stu-id="6be2f-976">for writing the event log information on the computer.</span></span> <span data-ttu-id="6be2f-977">关联的枚举： <see cref="F:System.Diagnostics.EventLogPermissionAccess.Write" /></span><span class="sxs-lookup"><span data-stu-id="6be2f-977">Associated enumeration: <see cref="F:System.Diagnostics.EventLogPermissionAccess.Write" /></span></span></permission>
        <altmember cref="P:System.Diagnostics.EventLog.Log" />
        <altmember cref="P:System.Diagnostics.EventLog.MachineName" />
        <altmember cref="Overload:System.Diagnostics.EventLog.CreateEventSource" />
        <altmember cref="M:System.Diagnostics.EventLog.DeleteEventSource(System.String)" />
        <altmember cref="M:System.Diagnostics.EventLog.SourceExists(System.String)" />
      </Docs>
    </Member>
    <MemberGroup MemberName="SourceExists">
      <AssemblyInfo>
        <AssemblyName>System</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Docs>
        <summary><span data-ttu-id="6be2f-978">在计算机的注册表中搜索给定的事件源。</span><span class="sxs-lookup"><span data-stu-id="6be2f-978">Searches a computer's registry for a given event source.</span></span></summary>
      </Docs>
    </MemberGroup>
    <Member MemberName="SourceExists">
      <MemberSignature Language="C#" Value="public static bool SourceExists (string source);" />
      <MemberSignature Language="ILAsm" Value=".method public static hidebysig bool SourceExists(string source) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Diagnostics.EventLog.SourceExists(System.String)" />
      <MemberSignature Language="VB.NET" Value="Public Shared Function SourceExists (source As String) As Boolean" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; static bool SourceExists(System::String ^ source);" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Boolean</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="source" Type="System.String" />
      </Parameters>
      <Docs>
        <param name="source"><span data-ttu-id="6be2f-979">事件源的名称。</span><span class="sxs-lookup"><span data-stu-id="6be2f-979">The name of the event source.</span></span></param>
        <summary><span data-ttu-id="6be2f-980">确定事件源是否已在本地计算机上注册。</span><span class="sxs-lookup"><span data-stu-id="6be2f-980">Determines whether an event source is registered on the local computer.</span></span></summary>
        <returns>
          <span data-ttu-id="6be2f-981">如果事件源已在本地计算机上注册，则为 <see langword="true" />；否则为 <see langword="false" />。</span><span class="sxs-lookup"><span data-stu-id="6be2f-981"><see langword="true" /> if the event source is registered on the local computer; otherwise, <see langword="false" />.</span></span></returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="6be2f-982">此方法用于确定本地计算机上是否存在事件源。</span><span class="sxs-lookup"><span data-stu-id="6be2f-982">Use this method to determine whether an event source exists on the local computer.</span></span> <span data-ttu-id="6be2f-983">如果你想要确定本地计算机，使用上是否存在日志<xref:System.Diagnostics.EventLog.Exists%2A>。</span><span class="sxs-lookup"><span data-stu-id="6be2f-983">If you want to determine whether a log exists on the local computer, use <xref:System.Diagnostics.EventLog.Exists%2A>.</span></span>  
  
 <span data-ttu-id="6be2f-984">因为此方法访问注册表，你必须在本地计算机，则具有相应的注册表权限否则为<xref:System.Security.SecurityException>将引发。</span><span class="sxs-lookup"><span data-stu-id="6be2f-984">Because this method accesses the registry, you must have the appropriate registry permissions on the local computer; otherwise, a <xref:System.Security.SecurityException> will be thrown.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="6be2f-985">若要搜索的事件源在 Windows Vista 或更高版本或 Windows Server 2003，必须具有管理权限。</span><span class="sxs-lookup"><span data-stu-id="6be2f-985">To search for an event source in Windows Vista and later or Windows Server 2003, you must have administrative privileges.</span></span>  
>   
>  <span data-ttu-id="6be2f-986">此要求的原因是所有的事件日志，包括安全性，必须进行搜索以确定事件源是否唯一。</span><span class="sxs-lookup"><span data-stu-id="6be2f-986">The reason for this requirement is that all event logs, including security, must be searched to determine whether the event source is unique.</span></span> <span data-ttu-id="6be2f-987">从 Windows Vista 开始，用户没有权限访问安全事件日志中。因此，<xref:System.Security.SecurityException>引发。</span><span class="sxs-lookup"><span data-stu-id="6be2f-987">Starting with Windows Vista, users do not have permission to access the security log; therefore, a <xref:System.Security.SecurityException> is thrown.</span></span>  
>   
>  <span data-ttu-id="6be2f-988">从 Windows Vista 开始，用户帐户控制 (UAC) 决定用户的特权。</span><span class="sxs-lookup"><span data-stu-id="6be2f-988">Starting with Windows Vista, User Account Control (UAC) determines the privileges of a user.</span></span> <span data-ttu-id="6be2f-989">如果您是内置的 Administrators 组的成员，将为您分配两个运行时访问令牌：一个标准用户访问令牌和一个管理员访问令牌。</span><span class="sxs-lookup"><span data-stu-id="6be2f-989">If you are a member of the Built-in Administrators group, you are assigned two run-time access tokens: a standard user access token and an administrator access token.</span></span> <span data-ttu-id="6be2f-990">默认情况下，您拥有标准用户角色。</span><span class="sxs-lookup"><span data-stu-id="6be2f-990">By default, you are in the standard user role.</span></span> <span data-ttu-id="6be2f-991">若要执行访问性能计数器的代码，首先必须将你的特权从标准用户提升至管理员。</span><span class="sxs-lookup"><span data-stu-id="6be2f-991">To execute the code that accesses performance counters, you must first elevate your privileges from standard user to administrator.</span></span> <span data-ttu-id="6be2f-992">你可以通过以下方式执行此操作：右键单击应用程序图标并指示需以管理员身份运行。</span><span class="sxs-lookup"><span data-stu-id="6be2f-992">You can do this when you start an application by right-clicking the application icon and indicating that you want to run as an administrator.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="6be2f-993">在下执行服务<xref:System.ServiceProcess.ServiceAccount.LocalSystem>帐户没有执行此方法所需的权限。</span><span class="sxs-lookup"><span data-stu-id="6be2f-993">A service that is executing under the <xref:System.ServiceProcess.ServiceAccount.LocalSystem> account does not have the privileges required to execute this method.</span></span> <span data-ttu-id="6be2f-994">解决方法是检查中是否存在事件源<xref:System.ServiceProcess.ServiceInstaller>，并且如果它不存在，在安装程序中创建源。</span><span class="sxs-lookup"><span data-stu-id="6be2f-994">The solution is to check whether the event source exists in the <xref:System.ServiceProcess.ServiceInstaller>, and if it does not exist, to create the source in the installer.</span></span>  
  
 <span data-ttu-id="6be2f-995">因为你无法为新的源的同一台计算机上的现有源名称，使用此方法尝试之前调用<xref:System.Diagnostics.EventLog.CreateEventSource%2A>以确保源指定的名称与`source`本地计算机上尚不存在。</span><span class="sxs-lookup"><span data-stu-id="6be2f-995">Because you cannot give a new source the name of an existing source on the same computer, use this method before attempting to call <xref:System.Diagnostics.EventLog.CreateEventSource%2A> to ensure that a source with the name specified by `source` does not already exist on the local computer.</span></span> <span data-ttu-id="6be2f-996">`source`参数不区分大小写。</span><span class="sxs-lookup"><span data-stu-id="6be2f-996">The `source` parameter is not case-sensitive.</span></span>  
  
   
  
## Examples  
 <span data-ttu-id="6be2f-997">下面的示例创建源`MySource`如果它尚不存在，并将项写入事件日志`MyNewLog`。</span><span class="sxs-lookup"><span data-stu-id="6be2f-997">The following example creates the source `MySource` if it does not already exist, and writes an entry to the event log `MyNewLog`.</span></span>  
  
 [!code-cpp[Classic EventLog.Source Example#1](~/samples/snippets/cpp/VS_Snippets_CLR_Classic/classic EventLog.Source Example/CPP/source.cpp#1)]
 [!code-csharp[Classic EventLog.Source Example#1](~/samples/snippets/csharp/VS_Snippets_CLR_Classic/classic EventLog.Source Example/CS/source.cs#1)]
 [!code-vb[Classic EventLog.Source Example#1](~/samples/snippets/visualbasic/VS_Snippets_CLR_Classic/classic EventLog.Source Example/VB/source.vb#1)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.Security.SecurityException">
          <span data-ttu-id="6be2f-998">未找到 <paramref name="source" />，无法搜索部分或全部事件日志。</span><span class="sxs-lookup"><span data-stu-id="6be2f-998"><paramref name="source" /> was not found, but some or all of the event logs could not be searched.</span></span></exception>
        <permission cref="T:System.Diagnostics.EventLogPermission"><span data-ttu-id="6be2f-999">用于写入的计算机上的事件日志信息。</span><span class="sxs-lookup"><span data-stu-id="6be2f-999">for writing the event log information on the computer.</span></span> <span data-ttu-id="6be2f-1000">关联的枚举： <see cref="F:System.Diagnostics.EventLogPermissionAccess.Write" /></span><span class="sxs-lookup"><span data-stu-id="6be2f-1000">Associated enumeration: <see cref="F:System.Diagnostics.EventLogPermissionAccess.Write" /></span></span></permission>
        <altmember cref="Overload:System.Diagnostics.EventLog.CreateEventSource" />
        <altmember cref="M:System.Diagnostics.EventLog.DeleteEventSource(System.String)" />
        <altmember cref="M:System.Diagnostics.EventLog.Exists(System.String)" />
        <altmember cref="P:System.Diagnostics.EventLog.Source" />
      </Docs>
    </Member>
    <Member MemberName="SourceExists">
      <MemberSignature Language="C#" Value="public static bool SourceExists (string source, string machineName);" />
      <MemberSignature Language="ILAsm" Value=".method public static hidebysig bool SourceExists(string source, string machineName) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Diagnostics.EventLog.SourceExists(System.String,System.String)" />
      <MemberSignature Language="VB.NET" Value="Public Shared Function SourceExists (source As String, machineName As String) As Boolean" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; static bool SourceExists(System::String ^ source, System::String ^ machineName);" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Attributes>
        <Attribute>
          <AttributeName>System.MonoNotSupported("remote machine is not supported")</AttributeName>
        </Attribute>
      </Attributes>
      <ReturnValue>
        <ReturnType>System.Boolean</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="source" Type="System.String" />
        <Parameter Name="machineName" Type="System.String" />
      </Parameters>
      <Docs>
        <param name="source"><span data-ttu-id="6be2f-1001">事件源的名称。</span><span class="sxs-lookup"><span data-stu-id="6be2f-1001">The name of the event source.</span></span></param>
        <param name="machineName"><span data-ttu-id="6be2f-1002">在其上查看的计算机的名称，对于本地计算机则为“.”。</span><span class="sxs-lookup"><span data-stu-id="6be2f-1002">The name the computer on which to look, or "." for the local computer.</span></span></param>
        <summary><span data-ttu-id="6be2f-1003">确定事件源是否已在指定的计算机上注册。</span><span class="sxs-lookup"><span data-stu-id="6be2f-1003">Determines whether an event source is registered on a specified computer.</span></span></summary>
        <returns>
          <span data-ttu-id="6be2f-1004">如果事件源已在给定计算机上注册，则为 <see langword="true" />；否则为 <see langword="false" />。</span><span class="sxs-lookup"><span data-stu-id="6be2f-1004"><see langword="true" /> if the event source is registered on the given computer; otherwise, <see langword="false" />.</span></span></returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="6be2f-1005">此方法用于确定指定的计算机上是否存在事件源`machineName`参数。</span><span class="sxs-lookup"><span data-stu-id="6be2f-1005">Use this method to determine whether an event source exists on the computer specified by the `machineName` parameter.</span></span> <span data-ttu-id="6be2f-1006">如果你想要确定使用指定的计算机上是否存在日志<xref:System.Diagnostics.EventLog.Exists%2A>。</span><span class="sxs-lookup"><span data-stu-id="6be2f-1006">If you want to determine whether a log exists on the specified computer, use <xref:System.Diagnostics.EventLog.Exists%2A>.</span></span>  
  
 <span data-ttu-id="6be2f-1007">因为此方法访问注册表，你必须在给定的服务器中; 上具有相应的注册表权限否则为<xref:System.Security.SecurityException>将引发。</span><span class="sxs-lookup"><span data-stu-id="6be2f-1007">Because this method accesses the registry, you must have the appropriate registry permissions on the given server; otherwise, a <xref:System.Security.SecurityException> will be thrown.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="6be2f-1008">若要搜索的事件源在 Windows Vista 或更高版本或 Windows Server 2003，必须具有管理权限。</span><span class="sxs-lookup"><span data-stu-id="6be2f-1008">To search for an event source in Windows Vista and later or Windows Server 2003, you must have administrative privileges.</span></span>  
>   
>  <span data-ttu-id="6be2f-1009">此要求的原因是所有的事件日志，包括安全性，必须进行搜索以确定事件源是否唯一。</span><span class="sxs-lookup"><span data-stu-id="6be2f-1009">The reason for this requirement is that all event logs, including security, must be searched to determine whether the event source is unique.</span></span> <span data-ttu-id="6be2f-1010">从 Windows Vista 开始，用户没有权限访问安全事件日志中。因此，<xref:System.Security.SecurityException>引发。</span><span class="sxs-lookup"><span data-stu-id="6be2f-1010">Starting with Windows Vista, users do not have permission to access the security log; therefore, a <xref:System.Security.SecurityException> is thrown.</span></span>  
>   
>  <span data-ttu-id="6be2f-1011">从 Windows Vista 开始，用户帐户控制 (UAC) 决定用户的特权。</span><span class="sxs-lookup"><span data-stu-id="6be2f-1011">Starting with Windows Vista, User Account Control (UAC) determines the privileges of a user.</span></span> <span data-ttu-id="6be2f-1012">如果您是内置的 Administrators 组的成员，将为您分配两个运行时访问令牌：一个标准用户访问令牌和一个管理员访问令牌。</span><span class="sxs-lookup"><span data-stu-id="6be2f-1012">If you are a member of the Built-in Administrators group, you are assigned two run-time access tokens: a standard user access token and an administrator access token.</span></span> <span data-ttu-id="6be2f-1013">默认情况下，您拥有标准用户角色。</span><span class="sxs-lookup"><span data-stu-id="6be2f-1013">By default, you are in the standard user role.</span></span> <span data-ttu-id="6be2f-1014">若要执行访问性能计数器的代码，首先必须将你的特权从标准用户提升至管理员。</span><span class="sxs-lookup"><span data-stu-id="6be2f-1014">To execute the code that accesses performance counters, you must first elevate your privileges from standard user to administrator.</span></span> <span data-ttu-id="6be2f-1015">你可以通过以下方式执行此操作：右键单击应用程序图标并指示需以管理员身份运行。</span><span class="sxs-lookup"><span data-stu-id="6be2f-1015">You can do this when you start an application by right-clicking the application icon and indicating that you want to run as an administrator.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="6be2f-1016">在下执行服务<xref:System.ServiceProcess.ServiceAccount.LocalSystem>帐户没有执行此方法所需的权限。</span><span class="sxs-lookup"><span data-stu-id="6be2f-1016">A service that is executing under the <xref:System.ServiceProcess.ServiceAccount.LocalSystem> account does not have the privileges required to execute this method.</span></span> <span data-ttu-id="6be2f-1017">解决方法是检查中是否存在事件源<xref:System.ServiceProcess.ServiceInstaller>，并且如果它不存在，在安装程序中创建源。</span><span class="sxs-lookup"><span data-stu-id="6be2f-1017">The solution is to check whether the event source exists in the <xref:System.ServiceProcess.ServiceInstaller>, and if it does not exist, to create the source in the installer.</span></span>  
  
 <span data-ttu-id="6be2f-1018">因为你无法为新的源的同一台计算机上的现有源名称，使用此方法尝试之前调用<xref:System.Diagnostics.EventLog.CreateEventSource%2A>以确保源指定的名称与`source`计算机上尚不存在。</span><span class="sxs-lookup"><span data-stu-id="6be2f-1018">Because you cannot give a new source the name of an existing source on the same computer, use this method before attempting to call <xref:System.Diagnostics.EventLog.CreateEventSource%2A> to ensure that a source with the name specified by `source` does not already exist on the computer.</span></span> <span data-ttu-id="6be2f-1019">`source`和`machineName`参数不区分大小写。</span><span class="sxs-lookup"><span data-stu-id="6be2f-1019">The `source` and `machineName` parameters are not case sensitive.</span></span>  
  
 <span data-ttu-id="6be2f-1020"><xref:System.Diagnostics.EventLog.SourceExists%2A> 是`static`方法，使其可以调用类本身上。</span><span class="sxs-lookup"><span data-stu-id="6be2f-1020"><xref:System.Diagnostics.EventLog.SourceExists%2A> is a `static` method, so it can be called on the class itself.</span></span> <span data-ttu-id="6be2f-1021">不需要创建的实例<xref:System.Diagnostics.EventLog>调用<xref:System.Diagnostics.EventLog.SourceExists%2A>。</span><span class="sxs-lookup"><span data-stu-id="6be2f-1021">It is not necessary to create an instance of <xref:System.Diagnostics.EventLog> to call <xref:System.Diagnostics.EventLog.SourceExists%2A>.</span></span>  
  
   
  
## Examples  
 <span data-ttu-id="6be2f-1022">下面的示例创建源`MySource`计算机上`MyServer`，和一个项写入事件日志`MyNewLog`。</span><span class="sxs-lookup"><span data-stu-id="6be2f-1022">The following example creates the source `MySource` on the computer `MyServer`, and writes an entry to the event log `MyNewLog`.</span></span>  
  
 [!code-cpp[Classic EventLog.SourceExists1 Example#1](~/samples/snippets/cpp/VS_Snippets_CLR_Classic/classic EventLog.SourceExists1 Example/CPP/source.cpp#1)]
 [!code-csharp[Classic EventLog.SourceExists1 Example#1](~/samples/snippets/csharp/VS_Snippets_CLR_Classic/classic EventLog.SourceExists1 Example/CS/source.cs#1)]
 [!code-vb[Classic EventLog.SourceExists1 Example#1](~/samples/snippets/visualbasic/VS_Snippets_CLR_Classic/classic EventLog.SourceExists1 Example/VB/source.vb#1)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentException">
          <span data-ttu-id="6be2f-1023"><paramref name="machineName" /> 是无效的计算机名称。</span><span class="sxs-lookup"><span data-stu-id="6be2f-1023"><paramref name="machineName" /> is an invalid computer name.</span></span></exception>
        <exception cref="T:System.Security.SecurityException">
          <span data-ttu-id="6be2f-1024">未找到 <paramref name="source" />，无法搜索部分或全部事件日志。</span><span class="sxs-lookup"><span data-stu-id="6be2f-1024"><paramref name="source" /> was not found, but some or all of the event logs could not be searched.</span></span></exception>
        <permission cref="T:System.Diagnostics.EventLogPermission"><span data-ttu-id="6be2f-1025">用于写入的计算机上的事件日志信息。</span><span class="sxs-lookup"><span data-stu-id="6be2f-1025">for writing the event log information on the computer.</span></span> <span data-ttu-id="6be2f-1026">关联的枚举： <see cref="F:System.Diagnostics.EventLogPermissionAccess.Write" /></span><span class="sxs-lookup"><span data-stu-id="6be2f-1026">Associated enumeration: <see cref="F:System.Diagnostics.EventLogPermissionAccess.Write" /></span></span></permission>
        <altmember cref="Overload:System.Diagnostics.EventLog.CreateEventSource" />
        <altmember cref="M:System.Diagnostics.EventLog.DeleteEventSource(System.String)" />
        <altmember cref="M:System.Diagnostics.EventLog.Exists(System.String)" />
        <altmember cref="P:System.Diagnostics.EventLog.Source" />
        <altmember cref="P:System.Diagnostics.EventLog.MachineName" />
      </Docs>
    </Member>
    <Member MemberName="SynchronizingObject">
      <MemberSignature Language="C#" Value="public System.ComponentModel.ISynchronizeInvoke SynchronizingObject { get; set; }" />
      <MemberSignature Language="ILAsm" Value=".property instance class System.ComponentModel.ISynchronizeInvoke SynchronizingObject" />
      <MemberSignature Language="DocId" Value="P:System.Diagnostics.EventLog.SynchronizingObject" />
      <MemberSignature Language="VB.NET" Value="Public Property SynchronizingObject As ISynchronizeInvoke" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; property System::ComponentModel::ISynchronizeInvoke ^ SynchronizingObject { System::ComponentModel::ISynchronizeInvoke ^ get(); void set(System::ComponentModel::ISynchronizeInvoke ^ value); };" />
      <MemberType>Property</MemberType>
      <AssemblyInfo>
        <AssemblyName>System</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Attributes>
        <Attribute>
          <AttributeName>System.ComponentModel.Browsable(false)</AttributeName>
        </Attribute>
        <Attribute>
          <AttributeName>System.ComponentModel.DefaultValue(null)</AttributeName>
        </Attribute>
        <Attribute>
          <AttributeName>System.Diagnostics.MonitoringDescription("An object that synchronizes event handler calls.")</AttributeName>
        </Attribute>
      </Attributes>
      <ReturnValue>
        <ReturnType>System.ComponentModel.ISynchronizeInvoke</ReturnType>
      </ReturnValue>
      <Docs>
        <summary><span data-ttu-id="6be2f-1027">获取或设置用于封送事件处理程序调用的对象，该调用在有 <see cref="T:System.Diagnostics.EventLog" /> 项写入事件时发出。</span><span class="sxs-lookup"><span data-stu-id="6be2f-1027">Gets or sets the object used to marshal the event handler calls issued as a result of an <see cref="T:System.Diagnostics.EventLog" /> entry written event.</span></span></summary>
        <value><span data-ttu-id="6be2f-1028"><see cref="T:System.ComponentModel.ISynchronizeInvoke" />，用于封送由事件日志上的 <see cref="E:System.Diagnostics.EventLog.EntryWritten" /> 事件引发的事件处理程序调用。</span><span class="sxs-lookup"><span data-stu-id="6be2f-1028">The <see cref="T:System.ComponentModel.ISynchronizeInvoke" /> used to marshal event-handler calls issued as a result of an <see cref="E:System.Diagnostics.EventLog.EntryWritten" /> event on the event log.</span></span></value>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="6be2f-1029">当<xref:System.Diagnostics.EventLog.SynchronizingObject%2A>是`null`，方法处理<xref:System.Diagnostics.EventLog.EntryWritten>事件调用从系统线程池线程上。</span><span class="sxs-lookup"><span data-stu-id="6be2f-1029">When <xref:System.Diagnostics.EventLog.SynchronizingObject%2A> is `null`, methods handling the <xref:System.Diagnostics.EventLog.EntryWritten> event are called on a thread from the system thread pool.</span></span> <span data-ttu-id="6be2f-1030">系统线程池的详细信息，请参阅<xref:System.Threading.ThreadPool>。</span><span class="sxs-lookup"><span data-stu-id="6be2f-1030">For more information on system thread pools, see <xref:System.Threading.ThreadPool>.</span></span>  
  
 <span data-ttu-id="6be2f-1031">当<xref:System.Diagnostics.EventLog.EntryWritten>事件由 visual Windows 窗体组件，如按钮，通过系统线程池访问组件可能无法工作，或可能导致的异常处理。</span><span class="sxs-lookup"><span data-stu-id="6be2f-1031">When the <xref:System.Diagnostics.EventLog.EntryWritten> event is handled by a visual Windows Forms component, such as a button, accessing the component through the system thread pool might not work, or might result in an exception.</span></span> <span data-ttu-id="6be2f-1032">通过设置来避免这<xref:System.Diagnostics.EventLog.SynchronizingObject%2A>到 Windows 窗体组件时，这将导致处理的方法<xref:System.Diagnostics.EventLog.EntryWritten>事件在其创建该组件在同一线程上调用。</span><span class="sxs-lookup"><span data-stu-id="6be2f-1032">Avoid this by setting <xref:System.Diagnostics.EventLog.SynchronizingObject%2A> to a Windows Forms component, which causes the methods handling the <xref:System.Diagnostics.EventLog.EntryWritten> event to be called on the same thread on which the component was created.</span></span>  
  
 <span data-ttu-id="6be2f-1033">如果<xref:System.Diagnostics.EventLog>在内部使用[!INCLUDE[vsprvslong](~/includes/vsprvslong-md.md)]在 Windows 窗体设计器中，<xref:System.Diagnostics.EventLog.SynchronizingObject%2A>自动设置为控件包含<xref:System.Diagnostics.EventLog>。</span><span class="sxs-lookup"><span data-stu-id="6be2f-1033">If the <xref:System.Diagnostics.EventLog> is used inside [!INCLUDE[vsprvslong](~/includes/vsprvslong-md.md)] in a Windows Forms designer, <xref:System.Diagnostics.EventLog.SynchronizingObject%2A> is automatically set to the control containing the <xref:System.Diagnostics.EventLog>.</span></span> <span data-ttu-id="6be2f-1034">例如，如果你将放置<xref:System.Diagnostics.EventLog>form1 设计器上 (其继承自<xref:System.Windows.Forms.Form>)<xref:System.Diagnostics.EventLog.SynchronizingObject%2A>属性<xref:System.Diagnostics.EventLog>被设置为 form1 的实例。</span><span class="sxs-lookup"><span data-stu-id="6be2f-1034">For example, if you place an <xref:System.Diagnostics.EventLog> on a designer for Form1 (which inherits from <xref:System.Windows.Forms.Form>) the <xref:System.Diagnostics.EventLog.SynchronizingObject%2A> property of <xref:System.Diagnostics.EventLog> is set to the instance of Form1.</span></span>  
  
 ]]></format>
        </remarks>
        <permission cref="T:System.Diagnostics.EventLogPermission"><span data-ttu-id="6be2f-1035">用于写入的计算机上的事件日志信息。</span><span class="sxs-lookup"><span data-stu-id="6be2f-1035">for writing the event log information on the computer.</span></span> <span data-ttu-id="6be2f-1036">关联的枚举： <see cref="F:System.Diagnostics.EventLogPermissionAccess.Write" /></span><span class="sxs-lookup"><span data-stu-id="6be2f-1036">Associated enumeration: <see cref="F:System.Diagnostics.EventLogPermissionAccess.Write" /></span></span></permission>
        <altmember cref="E:System.Diagnostics.EventLog.EntryWritten" />
        <altmember cref="T:System.Threading.ThreadPool" />
      </Docs>
    </Member>
    <MemberGroup MemberName="WriteEntry">
      <AssemblyInfo>
        <AssemblyName>System</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Docs>
        <summary><span data-ttu-id="6be2f-1037">将项写入事件日志。</span><span class="sxs-lookup"><span data-stu-id="6be2f-1037">Writes an entry in the event log.</span></span></summary>
      </Docs>
    </MemberGroup>
    <Member MemberName="WriteEntry">
      <MemberSignature Language="C#" Value="public void WriteEntry (string message);" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig instance void WriteEntry(string message) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Diagnostics.EventLog.WriteEntry(System.String)" />
      <MemberSignature Language="VB.NET" Value="Public Sub WriteEntry (message As String)" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; void WriteEntry(System::String ^ message);" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Void</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="message" Type="System.String" />
      </Parameters>
      <Docs>
        <param name="message"><span data-ttu-id="6be2f-1038">要写入事件日志的字符串。</span><span class="sxs-lookup"><span data-stu-id="6be2f-1038">The string to write to the event log.</span></span></param>
        <summary><span data-ttu-id="6be2f-1039">将信息类型项与给定的消息文本一起写入事件日志。</span><span class="sxs-lookup"><span data-stu-id="6be2f-1039">Writes an information type entry, with the given message text, to the event log.</span></span></summary>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="6be2f-1040">使用此方法与此关联的事件日志中写入信息项<xref:System.Diagnostics.EventLog>实例。</span><span class="sxs-lookup"><span data-stu-id="6be2f-1040">Use this method to write an information entry to the event log associated with this <xref:System.Diagnostics.EventLog> instance.</span></span> <span data-ttu-id="6be2f-1041">如果你想要指定任何其他<xref:System.Diagnostics.EventLogEntryType>，使用的不同重载<xref:System.Diagnostics.EventLog.WriteEntry%2A>。</span><span class="sxs-lookup"><span data-stu-id="6be2f-1041">If you want to specify any other <xref:System.Diagnostics.EventLogEntryType>, use a different overload of <xref:System.Diagnostics.EventLog.WriteEntry%2A>.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="6be2f-1042">`message`字符串不能包含 %*n*，其中*n*是整数值 (例如，%1)，因为事件查看器会将其视为插入字符串。</span><span class="sxs-lookup"><span data-stu-id="6be2f-1042">The `message` string cannot contain %*n*, where *n* is an integer value (for example, %1), because the event viewer treats it as an insertion string.</span></span> <span data-ttu-id="6be2f-1043">Internet 协议版本 6 (IPv6) 地址只能包含此字符序列，因为无法记录事件消息包含 IPv6 地址。</span><span class="sxs-lookup"><span data-stu-id="6be2f-1043">Because an Internet Protocol, version 6 (IPv6) address can contain this character sequence, you cannot log an event message that contains an IPv6 address.</span></span>  
  
 <span data-ttu-id="6be2f-1044">必须设置<xref:System.Diagnostics.EventLog.Source%2A>属性你<xref:System.Diagnostics.EventLog>组件之前可以将条目写入日志。</span><span class="sxs-lookup"><span data-stu-id="6be2f-1044">You must set the <xref:System.Diagnostics.EventLog.Source%2A> property on your <xref:System.Diagnostics.EventLog> component before you can write entries to the log.</span></span> <span data-ttu-id="6be2f-1045">你必须创建并在编写与源的第一个条目之前，配置事件源。</span><span class="sxs-lookup"><span data-stu-id="6be2f-1045">You must create and configure the event source before writing the first entry with the source.</span></span>  
  
 <span data-ttu-id="6be2f-1046">在你的应用程序的安装过程中创建新的事件源。</span><span class="sxs-lookup"><span data-stu-id="6be2f-1046">Create the new event source during the installation of your application.</span></span> <span data-ttu-id="6be2f-1047">这样，可以为操作系统来刷新其已注册的事件源的列表和其配置的时间。</span><span class="sxs-lookup"><span data-stu-id="6be2f-1047">This allows time for the operating system to refresh its list of registered event sources and their configuration.</span></span> <span data-ttu-id="6be2f-1048">如果操作系统未刷新其事件源的列表，并尝试写入新的源的事件写入操作将失败。</span><span class="sxs-lookup"><span data-stu-id="6be2f-1048">If the operating system has not refreshed its list of event sources, and you attempt to write an event with the new source, the write operation will fail.</span></span> <span data-ttu-id="6be2f-1049">你可以配置新的源使用<xref:System.Diagnostics.EventLogInstaller>，或使用<xref:System.Diagnostics.EventLog.CreateEventSource%2A>方法。</span><span class="sxs-lookup"><span data-stu-id="6be2f-1049">You can configure a new source using an <xref:System.Diagnostics.EventLogInstaller>, or using the <xref:System.Diagnostics.EventLog.CreateEventSource%2A> method.</span></span> <span data-ttu-id="6be2f-1050">若要创建新的事件源的计算机上，必须具有管理权限。</span><span class="sxs-lookup"><span data-stu-id="6be2f-1050">You must have administrative rights on the computer to create a new event source.</span></span>  
  
 <span data-ttu-id="6be2f-1051">如果在指定的源<xref:System.Diagnostics.EventLog.Source%2A>此属性<xref:System.Diagnostics.EventLog>写入你的组件，在计算机上未注册实例<xref:System.Diagnostics.EventLog.WriteEntry%2A>调用<xref:System.Diagnostics.EventLog.CreateEventSource%2A>并注册源。</span><span class="sxs-lookup"><span data-stu-id="6be2f-1051">If the source specified in the <xref:System.Diagnostics.EventLog.Source%2A> property of this <xref:System.Diagnostics.EventLog> instance is not registered on the computer that your component is writing to, <xref:System.Diagnostics.EventLog.WriteEntry%2A> calls <xref:System.Diagnostics.EventLog.CreateEventSource%2A> and registers the source.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="6be2f-1052">如果不指定<xref:System.Diagnostics.EventLog.MachineName%2A>为你<xref:System.Diagnostics.EventLog>实例然后才能调用<xref:System.Diagnostics.EventLog.CreateEventSource%2A>或<xref:System.Diagnostics.EventLog.WriteEntry%2A>，本地计算机 ("。") 假定。</span><span class="sxs-lookup"><span data-stu-id="6be2f-1052">If you do not specify a <xref:System.Diagnostics.EventLog.MachineName%2A> for your <xref:System.Diagnostics.EventLog> instance before you call <xref:System.Diagnostics.EventLog.CreateEventSource%2A> or <xref:System.Diagnostics.EventLog.WriteEntry%2A>, the local computer (".") is assumed.</span></span>  
  
 <span data-ttu-id="6be2f-1053">如果系统需要注册<xref:System.Diagnostics.EventLog.Source%2A>通过调用<xref:System.Diagnostics.EventLog.WriteEntry%2A>和<xref:System.Diagnostics.EventLog.Log%2A>未上设置属性你<xref:System.Diagnostics.EventLog>实例，该日志将默认为应用程序日志。</span><span class="sxs-lookup"><span data-stu-id="6be2f-1053">If the system needs to register the <xref:System.Diagnostics.EventLog.Source%2A> through a call to <xref:System.Diagnostics.EventLog.WriteEntry%2A> and the <xref:System.Diagnostics.EventLog.Log%2A> property has not been set on your <xref:System.Diagnostics.EventLog> instance, the log defaults to the Application log.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="6be2f-1054">许多上面列出的异常由错误生成的注册过程中发生<xref:System.Diagnostics.EventLog.Source%2A>。</span><span class="sxs-lookup"><span data-stu-id="6be2f-1054">Many of the exceptions listed above are generated by errors raised during the process of registering the <xref:System.Diagnostics.EventLog.Source%2A>.</span></span>  
  
 <span data-ttu-id="6be2f-1055">要写入本地化的项还是要直接写入字符串，则必须配置源。</span><span class="sxs-lookup"><span data-stu-id="6be2f-1055">The source must be configured either for writing localized entries or for writing direct strings.</span></span> <span data-ttu-id="6be2f-1056"><xref:System.Diagnostics.EventLog.WriteEntry%2A>方法直接写入事件日志将写入给定的字符串; 它不使用可本地化的消息资源文件。</span><span class="sxs-lookup"><span data-stu-id="6be2f-1056">The <xref:System.Diagnostics.EventLog.WriteEntry%2A> method writes the given string directly to the event log; it does not use a localizable message resource file.</span></span> <span data-ttu-id="6be2f-1057">使用<xref:System.Diagnostics.EventLog.WriteEvent%2A>方法来写入事件时使用本地化的消息资源文件。</span><span class="sxs-lookup"><span data-stu-id="6be2f-1057">Use the <xref:System.Diagnostics.EventLog.WriteEvent%2A> method to write events using a localized message resource file.</span></span>  
  
 <span data-ttu-id="6be2f-1058">如果你的应用程序将使用资源标识符和字符串值的条目，则必须注册两个单独的源。</span><span class="sxs-lookup"><span data-stu-id="6be2f-1058">If your application writes entries using both resource identifiers and string values, you must register two separate sources.</span></span> <span data-ttu-id="6be2f-1059">例如，使用资源文件，配置一个源，然后使用在该源<xref:System.Diagnostics.EventLog.WriteEvent%2A>方法来编写使用到事件日志的资源标识符的条目。</span><span class="sxs-lookup"><span data-stu-id="6be2f-1059">For example, configure one source with resource files, and then use that source in the <xref:System.Diagnostics.EventLog.WriteEvent%2A> method to write entries using resource identifiers to the event log.</span></span> <span data-ttu-id="6be2f-1060">然后创建不同的源，而无需资源文件，并使用在该源<xref:System.Diagnostics.EventLog.WriteEntry%2A>方法使用该源的事件日志中直接写入字符串。</span><span class="sxs-lookup"><span data-stu-id="6be2f-1060">Then create a different source without resource files, and use that source in the <xref:System.Diagnostics.EventLog.WriteEntry%2A> method to write strings directly to the event log using that source.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="6be2f-1061">如果远程计算机中写入一个条目，消息 （文本字符串） 的值可能不是你所预期如果远程计算机未在运行.NET Framework。</span><span class="sxs-lookup"><span data-stu-id="6be2f-1061">If you write an entry to a remote computer, the value of the message (the text string) might not be what you expect if the remote computer is not running the .NET Framework.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="6be2f-1062">如果`message`参数包含 NUL 字符，则在 NUL 字符处终止事件日志的消息中。</span><span class="sxs-lookup"><span data-stu-id="6be2f-1062">If the `message` parameter contains a NUL character, the message in the event log is terminated at the NUL character.</span></span>  
  
   
  
## Examples  
 <span data-ttu-id="6be2f-1063">下面的示例创建源`MySource`如果它尚不存在，并将项写入事件日志`MyNewLog`。</span><span class="sxs-lookup"><span data-stu-id="6be2f-1063">The following example creates the source `MySource` if it does not already exist, and writes an entry to the event log `MyNewLog`.</span></span>  
  
 [!code-cpp[Classic EventLog.CreateEventSource Example#1](~/samples/snippets/cpp/VS_Snippets_CLR_Classic/classic EventLog.CreateEventSource Example/CPP/source.cpp#1)]
 [!code-csharp[Classic EventLog.CreateEventSource Example#1](~/samples/snippets/csharp/VS_Snippets_CLR_Classic/classic EventLog.CreateEventSource Example/CS/source.cs#1)]
 [!code-vb[Classic EventLog.CreateEventSource Example#1](~/samples/snippets/visualbasic/VS_Snippets_CLR_Classic/classic EventLog.CreateEventSource Example/VB/source.vb#1)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentException"><span data-ttu-id="6be2f-1064"><see cref="P:System.Diagnostics.EventLog.Source" /> 的 <see cref="T:System.Diagnostics.EventLog" /> 属性尚未设置。</span><span class="sxs-lookup"><span data-stu-id="6be2f-1064">The <see cref="P:System.Diagnostics.EventLog.Source" /> property of the <see cref="T:System.Diagnostics.EventLog" /> has not been set.</span></span>  
  
 <span data-ttu-id="6be2f-1065">或</span><span class="sxs-lookup"><span data-stu-id="6be2f-1065">-or-</span></span>  
  
 <span data-ttu-id="6be2f-1066">该方法尝试注册新的事件源，但 <see cref="P:System.Diagnostics.EventLog.MachineName" /> 中的计算机名称无效。</span><span class="sxs-lookup"><span data-stu-id="6be2f-1066">The method attempted to register a new event source, but the computer name in <see cref="P:System.Diagnostics.EventLog.MachineName" /> is not valid.</span></span>  
  
 <span data-ttu-id="6be2f-1067">\- 或 -</span><span class="sxs-lookup"><span data-stu-id="6be2f-1067">\- or -</span></span>  
  
 <span data-ttu-id="6be2f-1068">已为其他事件日志注册了该源。</span><span class="sxs-lookup"><span data-stu-id="6be2f-1068">The source is already registered for a different event log.</span></span>  
  
 <span data-ttu-id="6be2f-1069">\- 或 -</span><span class="sxs-lookup"><span data-stu-id="6be2f-1069">\- or -</span></span>  
  
 <span data-ttu-id="6be2f-1070">消息字符串长于 31,839 字节（在 Windows Vista 之前，在 Windows 操作系统上为 32,766 字节)。</span><span class="sxs-lookup"><span data-stu-id="6be2f-1070">The message string is longer than 31,839 bytes (32,766 bytes on Windows operating systems before Windows Vista).</span></span>  
  
 <span data-ttu-id="6be2f-1071">\- 或 -</span><span class="sxs-lookup"><span data-stu-id="6be2f-1071">\- or -</span></span>  
  
 <span data-ttu-id="6be2f-1072">此源名称导致注册表项路径的长度超过 254 个字符。</span><span class="sxs-lookup"><span data-stu-id="6be2f-1072">The source name results in a registry key path longer than 254 characters.</span></span></exception>
        <exception cref="T:System.InvalidOperationException"><span data-ttu-id="6be2f-1073">事件日志的注册表项未能打开。</span><span class="sxs-lookup"><span data-stu-id="6be2f-1073">The registry key for the event log could not be opened.</span></span></exception>
        <exception cref="T:System.ComponentModel.Win32Exception"><span data-ttu-id="6be2f-1074">将事件项写入事件日志时，操作系统报告了一个错误。</span><span class="sxs-lookup"><span data-stu-id="6be2f-1074">The operating system reported an error when writing the event entry to the event log.</span></span> <span data-ttu-id="6be2f-1075">一个 Windows 错误代码不可用。</span><span class="sxs-lookup"><span data-stu-id="6be2f-1075">A Windows error code is not available.</span></span></exception>
        <permission cref="T:System.Diagnostics.EventLogPermission"><span data-ttu-id="6be2f-1076">用于写入的计算机上的事件日志信息。</span><span class="sxs-lookup"><span data-stu-id="6be2f-1076">for writing the event log information on the computer.</span></span> <span data-ttu-id="6be2f-1077">关联的枚举： <see cref="F:System.Diagnostics.EventLogPermissionAccess.Write" /></span><span class="sxs-lookup"><span data-stu-id="6be2f-1077">Associated enumeration: <see cref="F:System.Diagnostics.EventLogPermissionAccess.Write" /></span></span></permission>
        <altmember cref="P:System.Diagnostics.EventLog.Source" />
        <altmember cref="Overload:System.Diagnostics.EventLog.CreateEventSource" />
        <altmember cref="M:System.Diagnostics.EventLog.DeleteEventSource(System.String)" />
        <altmember cref="M:System.Diagnostics.EventLog.SourceExists(System.String)" />
        <altmember cref="P:System.Diagnostics.EventLog.Entries" />
      </Docs>
    </Member>
    <Member MemberName="WriteEntry">
      <MemberSignature Language="C#" Value="public void WriteEntry (string message, System.Diagnostics.EventLogEntryType type);" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig instance void WriteEntry(string message, valuetype System.Diagnostics.EventLogEntryType type) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Diagnostics.EventLog.WriteEntry(System.String,System.Diagnostics.EventLogEntryType)" />
      <MemberSignature Language="VB.NET" Value="Public Sub WriteEntry (message As String, type As EventLogEntryType)" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; void WriteEntry(System::String ^ message, System::Diagnostics::EventLogEntryType type);" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Void</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="message" Type="System.String" />
        <Parameter Name="type" Type="System.Diagnostics.EventLogEntryType" />
      </Parameters>
      <Docs>
        <param name="message"><span data-ttu-id="6be2f-1078">要写入事件日志的字符串。</span><span class="sxs-lookup"><span data-stu-id="6be2f-1078">The string to write to the event log.</span></span></param>
        <param name="type"><span data-ttu-id="6be2f-1079"><see cref="T:System.Diagnostics.EventLogEntryType" /> 值之一。</span><span class="sxs-lookup"><span data-stu-id="6be2f-1079">One of the <see cref="T:System.Diagnostics.EventLogEntryType" /> values.</span></span></param>
        <summary><span data-ttu-id="6be2f-1080">将错误、警告、信息、成功审核或失败审核项与给定的消息文本一起写入事件日志。</span><span class="sxs-lookup"><span data-stu-id="6be2f-1080">Writes an error, warning, information, success audit, or failure audit entry with the given message text to the event log.</span></span></summary>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="6be2f-1081">使用此方法的指定项写入<xref:System.Diagnostics.EventLogEntryType>到事件日志。</span><span class="sxs-lookup"><span data-stu-id="6be2f-1081">Use this method to write an entry of a specified <xref:System.Diagnostics.EventLogEntryType> to the event log.</span></span> <span data-ttu-id="6be2f-1082">`type`指示由一个图标和事件查看器日志中的类型列中的文本。</span><span class="sxs-lookup"><span data-stu-id="6be2f-1082">The `type` is indicated by an icon and text in the Type column in the Event Viewer for a log.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="6be2f-1083">`message`字符串不能包含 %*n*，其中*n*是整数值 (例如，%1)，因为事件查看器会将其视为插入字符串。</span><span class="sxs-lookup"><span data-stu-id="6be2f-1083">The `message` string cannot contain %*n*, where *n* is an integer value (for example, %1), because the event viewer treats it as an insertion string.</span></span> <span data-ttu-id="6be2f-1084">Internet 协议版本 6 (IPv6) 地址只能包含此字符序列，因为无法记录事件消息包含 IPv6 地址。</span><span class="sxs-lookup"><span data-stu-id="6be2f-1084">Because an Internet Protocol, version 6 (IPv6) address can contain this character sequence, you cannot log an event message that contains an IPv6 address.</span></span>  
  
 <span data-ttu-id="6be2f-1085">必须设置<xref:System.Diagnostics.EventLog.Source%2A>属性你<xref:System.Diagnostics.EventLog>组件之前可以将条目写入日志。</span><span class="sxs-lookup"><span data-stu-id="6be2f-1085">You must set the <xref:System.Diagnostics.EventLog.Source%2A> property on your <xref:System.Diagnostics.EventLog> component before you can write entries to the log.</span></span> <span data-ttu-id="6be2f-1086">你必须创建并在编写与源的第一个条目之前，配置事件源。</span><span class="sxs-lookup"><span data-stu-id="6be2f-1086">You must create and configure the event source before writing the first entry with the source.</span></span>  
  
 <span data-ttu-id="6be2f-1087">在你的应用程序的安装过程中创建新的事件源。</span><span class="sxs-lookup"><span data-stu-id="6be2f-1087">Create the new event source during the installation of your application.</span></span> <span data-ttu-id="6be2f-1088">这样，可以为操作系统来刷新其已注册的事件源的列表和其配置的时间。</span><span class="sxs-lookup"><span data-stu-id="6be2f-1088">This allows time for the operating system to refresh its list of registered event sources and their configuration.</span></span> <span data-ttu-id="6be2f-1089">如果操作系统未刷新其事件源的列表，并尝试写入新的源的事件写入操作将失败。</span><span class="sxs-lookup"><span data-stu-id="6be2f-1089">If the operating system has not refreshed its list of event sources, and you attempt to write an event with the new source, the write operation will fail.</span></span> <span data-ttu-id="6be2f-1090">你可以配置新的源使用<xref:System.Diagnostics.EventLogInstaller>，或使用<xref:System.Diagnostics.EventLog.CreateEventSource%2A>方法。</span><span class="sxs-lookup"><span data-stu-id="6be2f-1090">You can configure a new source using an <xref:System.Diagnostics.EventLogInstaller>, or using the <xref:System.Diagnostics.EventLog.CreateEventSource%2A> method.</span></span> <span data-ttu-id="6be2f-1091">若要创建新的事件源的计算机上，必须具有管理权限。</span><span class="sxs-lookup"><span data-stu-id="6be2f-1091">You must have administrative rights on the computer to create a new event source.</span></span>  
  
 <span data-ttu-id="6be2f-1092">如果在指定的源<xref:System.Diagnostics.EventLog.Source%2A>此属性<xref:System.Diagnostics.EventLog>写入你的组件，在计算机上未注册实例<xref:System.Diagnostics.EventLog.WriteEntry%2A>调用<xref:System.Diagnostics.EventLog.CreateEventSource%2A>并注册源。</span><span class="sxs-lookup"><span data-stu-id="6be2f-1092">If the source specified in the <xref:System.Diagnostics.EventLog.Source%2A> property of this <xref:System.Diagnostics.EventLog> instance is not registered on the computer that your component is writing to, <xref:System.Diagnostics.EventLog.WriteEntry%2A> calls <xref:System.Diagnostics.EventLog.CreateEventSource%2A> and registers the source.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="6be2f-1093">如果不指定<xref:System.Diagnostics.EventLog.MachineName%2A>为你<xref:System.Diagnostics.EventLog>实例然后才能调用<xref:System.Diagnostics.EventLog.CreateEventSource%2A>或<xref:System.Diagnostics.EventLog.WriteEntry%2A>，本地计算机 ("。") 假定。</span><span class="sxs-lookup"><span data-stu-id="6be2f-1093">If you do not specify a <xref:System.Diagnostics.EventLog.MachineName%2A> for your <xref:System.Diagnostics.EventLog> instance before you call <xref:System.Diagnostics.EventLog.CreateEventSource%2A> or <xref:System.Diagnostics.EventLog.WriteEntry%2A>, the local computer (".") is assumed.</span></span>  
  
 <span data-ttu-id="6be2f-1094">如果系统需要注册<xref:System.Diagnostics.EventLog.Source%2A>通过调用<xref:System.Diagnostics.EventLog.WriteEntry%2A>和<xref:System.Diagnostics.EventLog.Log%2A>未上设置属性你<xref:System.Diagnostics.EventLog>实例，该日志将默认为应用程序日志。</span><span class="sxs-lookup"><span data-stu-id="6be2f-1094">If the system needs to register the <xref:System.Diagnostics.EventLog.Source%2A> through a call to <xref:System.Diagnostics.EventLog.WriteEntry%2A> and the <xref:System.Diagnostics.EventLog.Log%2A> property has not been set on your <xref:System.Diagnostics.EventLog> instance, the log defaults to the Application log.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="6be2f-1095">上面列出的许多异常由错误生成的注册过程中发生<xref:System.Diagnostics.EventLog.Source%2A>。</span><span class="sxs-lookup"><span data-stu-id="6be2f-1095">Many exceptions listed above are generated by errors raised during the process of registering the <xref:System.Diagnostics.EventLog.Source%2A>.</span></span>  
  
 <span data-ttu-id="6be2f-1096">要写入本地化的项还是要直接写入字符串，则必须配置源。</span><span class="sxs-lookup"><span data-stu-id="6be2f-1096">The source must be configured either for writing localized entries or for writing direct strings.</span></span> <span data-ttu-id="6be2f-1097"><xref:System.Diagnostics.EventLog.WriteEntry%2A>方法直接写入事件日志将写入给定的字符串; 它不使用可本地化的消息资源文件。</span><span class="sxs-lookup"><span data-stu-id="6be2f-1097">The <xref:System.Diagnostics.EventLog.WriteEntry%2A> method writes the given string directly to the event log; it does not use a localizable message resource file.</span></span> <span data-ttu-id="6be2f-1098">使用<xref:System.Diagnostics.EventLog.WriteEvent%2A>方法来写入事件时使用本地化的消息资源文件。</span><span class="sxs-lookup"><span data-stu-id="6be2f-1098">Use the <xref:System.Diagnostics.EventLog.WriteEvent%2A> method to write events using a localized message resource file.</span></span>  
  
 <span data-ttu-id="6be2f-1099">如果你的应用程序将使用资源标识符和字符串值的条目，则必须注册两个单独的源。</span><span class="sxs-lookup"><span data-stu-id="6be2f-1099">If your application writes entries using both resource identifiers and string values, you must register two separate sources.</span></span> <span data-ttu-id="6be2f-1100">例如，使用资源文件，配置一个源，然后使用在该源<xref:System.Diagnostics.EventLog.WriteEvent%2A>方法来编写使用到事件日志的资源标识符的条目。</span><span class="sxs-lookup"><span data-stu-id="6be2f-1100">For example, configure one source with resource files, and then use that source in the <xref:System.Diagnostics.EventLog.WriteEvent%2A> method to write entries using resource identifiers to the event log.</span></span> <span data-ttu-id="6be2f-1101">然后创建不同的源，而无需资源文件，并使用在该源<xref:System.Diagnostics.EventLog.WriteEntry%2A>方法使用该源的事件日志中直接写入字符串。</span><span class="sxs-lookup"><span data-stu-id="6be2f-1101">Then create a different source without resource files, and use that source in the <xref:System.Diagnostics.EventLog.WriteEntry%2A> method to write strings directly to the event log using that source.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="6be2f-1102">如果远程计算机中写入一个条目，消息 （文本字符串） 的值可能不是你所预期如果远程计算机未在运行.NET Framework。</span><span class="sxs-lookup"><span data-stu-id="6be2f-1102">If you write an entry to a remote computer, the value of the message (the text string) might not be what you expect if the remote computer is not running the .NET Framework.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="6be2f-1103">如果`message`参数包含 NUL 字符，则在 NUL 字符处终止事件日志的消息中。</span><span class="sxs-lookup"><span data-stu-id="6be2f-1103">If the `message` parameter contains a NUL character, the message in the event log is terminated at the NUL character.</span></span>  
  
   
  
## Examples  
 <span data-ttu-id="6be2f-1104">下面的示例在本地计算机上，向事件日志中，"MyNewLog"写入警告项。</span><span class="sxs-lookup"><span data-stu-id="6be2f-1104">The following example writes a warning entry to an event log, "MyNewLog", on the local computer.</span></span>  
  
 [!code-cpp[Classic EventLog.WriteEntry2 Example#1](~/samples/snippets/cpp/VS_Snippets_CLR_Classic/classic EventLog.WriteEntry2 Example/CPP/source.cpp#1)]
 [!code-csharp[Classic EventLog.WriteEntry2 Example#1](~/samples/snippets/csharp/VS_Snippets_CLR_Classic/classic EventLog.WriteEntry2 Example/CS/source.cs#1)]
 [!code-vb[Classic EventLog.WriteEntry2 Example#1](~/samples/snippets/visualbasic/VS_Snippets_CLR_Classic/classic EventLog.WriteEntry2 Example/VB/source.vb#1)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentException"><span data-ttu-id="6be2f-1105"><see cref="P:System.Diagnostics.EventLog.Source" /> 的 <see cref="T:System.Diagnostics.EventLog" /> 属性尚未设置。</span><span class="sxs-lookup"><span data-stu-id="6be2f-1105">The <see cref="P:System.Diagnostics.EventLog.Source" /> property of the <see cref="T:System.Diagnostics.EventLog" /> has not been set.</span></span>  
  
 <span data-ttu-id="6be2f-1106">或</span><span class="sxs-lookup"><span data-stu-id="6be2f-1106">-or-</span></span>  
  
 <span data-ttu-id="6be2f-1107">该方法尝试注册新的事件源，但 <see cref="P:System.Diagnostics.EventLog.MachineName" /> 中的计算机名称无效。</span><span class="sxs-lookup"><span data-stu-id="6be2f-1107">The method attempted to register a new event source, but the computer name in <see cref="P:System.Diagnostics.EventLog.MachineName" /> is not valid.</span></span>  
  
 <span data-ttu-id="6be2f-1108">\- 或 -</span><span class="sxs-lookup"><span data-stu-id="6be2f-1108">\- or -</span></span>  
  
 <span data-ttu-id="6be2f-1109">已为其他事件日志注册了该源。</span><span class="sxs-lookup"><span data-stu-id="6be2f-1109">The source is already registered for a different event log.</span></span>  
  
 <span data-ttu-id="6be2f-1110">\- 或 -</span><span class="sxs-lookup"><span data-stu-id="6be2f-1110">\- or -</span></span>  
  
 <span data-ttu-id="6be2f-1111">消息字符串长于 31,839 字节（在 Windows Vista 之前，在 Windows 操作系统上为 32,766 字节)。</span><span class="sxs-lookup"><span data-stu-id="6be2f-1111">The message string is longer than 31,839 bytes (32,766 bytes on Windows operating systems before Windows Vista).</span></span>  
  
 <span data-ttu-id="6be2f-1112">\- 或 -</span><span class="sxs-lookup"><span data-stu-id="6be2f-1112">\- or -</span></span>  
  
 <span data-ttu-id="6be2f-1113">此源名称导致注册表项路径的长度超过 254 个字符。</span><span class="sxs-lookup"><span data-stu-id="6be2f-1113">The source name results in a registry key path longer than 254 characters.</span></span></exception>
        <exception cref="T:System.ComponentModel.InvalidEnumArgumentException">
          <span data-ttu-id="6be2f-1114"><paramref name="type" /> 不是有效的 <see cref="T:System.Diagnostics.EventLogEntryType" />。</span><span class="sxs-lookup"><span data-stu-id="6be2f-1114"><paramref name="type" /> is not a valid <see cref="T:System.Diagnostics.EventLogEntryType" />.</span></span></exception>
        <exception cref="T:System.InvalidOperationException"><span data-ttu-id="6be2f-1115">事件日志的注册表项未能打开。</span><span class="sxs-lookup"><span data-stu-id="6be2f-1115">The registry key for the event log could not be opened.</span></span></exception>
        <exception cref="T:System.ComponentModel.Win32Exception"><span data-ttu-id="6be2f-1116">将事件项写入事件日志时，操作系统报告了一个错误。</span><span class="sxs-lookup"><span data-stu-id="6be2f-1116">The operating system reported an error when writing the event entry to the event log.</span></span> <span data-ttu-id="6be2f-1117">一个 Windows 错误代码不可用。</span><span class="sxs-lookup"><span data-stu-id="6be2f-1117">A Windows error code is not available.</span></span></exception>
        <permission cref="T:System.Diagnostics.EventLogPermission"><span data-ttu-id="6be2f-1118">用于写入的计算机上的事件日志信息。</span><span class="sxs-lookup"><span data-stu-id="6be2f-1118">for writing the event log information on the computer.</span></span> <span data-ttu-id="6be2f-1119">关联的枚举： <see cref="F:System.Diagnostics.EventLogPermissionAccess.Write" /></span><span class="sxs-lookup"><span data-stu-id="6be2f-1119">Associated enumeration: <see cref="F:System.Diagnostics.EventLogPermissionAccess.Write" /></span></span></permission>
        <altmember cref="T:System.Diagnostics.EventLogEntryType" />
        <altmember cref="P:System.Diagnostics.EventLog.Source" />
        <altmember cref="Overload:System.Diagnostics.EventLog.CreateEventSource" />
        <altmember cref="M:System.Diagnostics.EventLog.DeleteEventSource(System.String)" />
        <altmember cref="M:System.Diagnostics.EventLog.SourceExists(System.String)" />
        <altmember cref="P:System.Diagnostics.EventLog.Entries" />
      </Docs>
    </Member>
    <Member MemberName="WriteEntry">
      <MemberSignature Language="C#" Value="public static void WriteEntry (string source, string message);" />
      <MemberSignature Language="ILAsm" Value=".method public static hidebysig void WriteEntry(string source, string message) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Diagnostics.EventLog.WriteEntry(System.String,System.String)" />
      <MemberSignature Language="VB.NET" Value="Public Shared Sub WriteEntry (source As String, message As String)" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; static void WriteEntry(System::String ^ source, System::String ^ message);" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Void</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="source" Type="System.String" />
        <Parameter Name="message" Type="System.String" />
      </Parameters>
      <Docs>
        <param name="source"><span data-ttu-id="6be2f-1120">应用程序在指定计算机上注册时所采用的源。</span><span class="sxs-lookup"><span data-stu-id="6be2f-1120">The source by which the application is registered on the specified computer.</span></span></param>
        <param name="message"><span data-ttu-id="6be2f-1121">要写入事件日志的字符串。</span><span class="sxs-lookup"><span data-stu-id="6be2f-1121">The string to write to the event log.</span></span></param>
        <summary><span data-ttu-id="6be2f-1122">使用指定的注册事件源将信息类型项与给定的消息文本一起写入事件日志。</span><span class="sxs-lookup"><span data-stu-id="6be2f-1122">Writes an information type entry with the given message text to the event log, using the specified registered event source.</span></span></summary>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="6be2f-1123">使用此方法要使用已注册为相应的日志的事件源的源的事件日志中写入信息项。</span><span class="sxs-lookup"><span data-stu-id="6be2f-1123">Use this method to write an information entry to the event log, using a source that is already registered as an event source for the appropriate log.</span></span> <span data-ttu-id="6be2f-1124">如果你想要指定任何其他<xref:System.Diagnostics.EventLogEntryType>，使用的不同重载<xref:System.Diagnostics.EventLog.WriteEntry%2A>。</span><span class="sxs-lookup"><span data-stu-id="6be2f-1124">If you want to specify any other <xref:System.Diagnostics.EventLogEntryType>, use a different overload of <xref:System.Diagnostics.EventLog.WriteEntry%2A>.</span></span>  
  
 <span data-ttu-id="6be2f-1125">你必须创建并在编写与源的第一个条目之前，配置事件源。</span><span class="sxs-lookup"><span data-stu-id="6be2f-1125">You must create and configure the event source before writing the first entry with the source.</span></span> <span data-ttu-id="6be2f-1126">在你的应用程序的安装过程中创建新的事件源。</span><span class="sxs-lookup"><span data-stu-id="6be2f-1126">Create the new event source during the installation of your application.</span></span> <span data-ttu-id="6be2f-1127">这样，可以为操作系统来刷新其已注册的事件源的列表和其配置的时间。</span><span class="sxs-lookup"><span data-stu-id="6be2f-1127">This allows time for the operating system to refresh its list of registered event sources and their configuration.</span></span> <span data-ttu-id="6be2f-1128">如果操作系统未刷新其事件源的列表，并尝试写入新的源的事件写入操作将失败。</span><span class="sxs-lookup"><span data-stu-id="6be2f-1128">If the operating system has not refreshed its list of event sources, and you attempt to write an event with the new source, the write operation will fail.</span></span> <span data-ttu-id="6be2f-1129">你可以配置新的源使用<xref:System.Diagnostics.EventLogInstaller>，或使用<xref:System.Diagnostics.EventLog.CreateEventSource%2A>方法。</span><span class="sxs-lookup"><span data-stu-id="6be2f-1129">You can configure a new source using an <xref:System.Diagnostics.EventLogInstaller>, or using the <xref:System.Diagnostics.EventLog.CreateEventSource%2A> method.</span></span> <span data-ttu-id="6be2f-1130">若要创建新的事件源的计算机上，必须具有管理权限。</span><span class="sxs-lookup"><span data-stu-id="6be2f-1130">You must have administrative rights on the computer to create a new event source.</span></span>  
  
 <span data-ttu-id="6be2f-1131">要写入本地化的项还是要直接写入字符串，则必须配置源。</span><span class="sxs-lookup"><span data-stu-id="6be2f-1131">The source must be configured either for writing localized entries or for writing direct strings.</span></span> <span data-ttu-id="6be2f-1132"><xref:System.Diagnostics.EventLog.WriteEntry%2A>方法直接写入事件日志将写入给定的字符串; 它不使用可本地化的消息资源文件。</span><span class="sxs-lookup"><span data-stu-id="6be2f-1132">The <xref:System.Diagnostics.EventLog.WriteEntry%2A> method writes the given string directly to the event log; it does not use a localizable message resource file.</span></span> <span data-ttu-id="6be2f-1133">使用<xref:System.Diagnostics.EventLog.WriteEvent%2A>方法来写入事件时使用本地化的消息资源文件。</span><span class="sxs-lookup"><span data-stu-id="6be2f-1133">Use the <xref:System.Diagnostics.EventLog.WriteEvent%2A> method to write events using a localized message resource file.</span></span>  
  
 <span data-ttu-id="6be2f-1134">如果你的应用程序将使用资源标识符和字符串值的条目，则必须注册两个单独的源。</span><span class="sxs-lookup"><span data-stu-id="6be2f-1134">If your application writes entries using both resource identifiers and string values, you must register two separate sources.</span></span> <span data-ttu-id="6be2f-1135">例如，使用资源文件，配置一个源，然后使用在该源<xref:System.Diagnostics.EventLog.WriteEvent%2A>方法来编写使用到事件日志的资源标识符的条目。</span><span class="sxs-lookup"><span data-stu-id="6be2f-1135">For example, configure one source with resource files, and then use that source in the <xref:System.Diagnostics.EventLog.WriteEvent%2A> method to write entries using resource identifiers to the event log.</span></span> <span data-ttu-id="6be2f-1136">然后创建不同的源，而无需资源文件，并使用在该源<xref:System.Diagnostics.EventLog.WriteEntry%2A>方法使用该源的事件日志中直接写入字符串。</span><span class="sxs-lookup"><span data-stu-id="6be2f-1136">Then create a different source without resource files, and use that source in the <xref:System.Diagnostics.EventLog.WriteEntry%2A> method to write strings directly to the event log using that source.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="6be2f-1137">如果`message`参数包含 NUL 字符，则在 NUL 字符处终止事件日志的消息中。</span><span class="sxs-lookup"><span data-stu-id="6be2f-1137">If the `message` parameter contains a NUL character, the message in the event log is terminated at the NUL character.</span></span>  
>   
>  <span data-ttu-id="6be2f-1138">`message`字符串不能包含 %*n*，其中*n*是整数值 (例如，%1)，因为事件查看器会将其视为插入字符串。</span><span class="sxs-lookup"><span data-stu-id="6be2f-1138">The `message` string cannot contain %*n*, where *n* is an integer value (for example, %1), because the event viewer treats it as an insertion string.</span></span> <span data-ttu-id="6be2f-1139">Internet 协议版本 6 (IPv6) 地址只能包含此字符序列，因为无法记录事件消息包含 IPv6 地址。</span><span class="sxs-lookup"><span data-stu-id="6be2f-1139">Because an Internet Protocol, version 6 (IPv6) address can contain this character sequence, you cannot log an event message that contains an IPv6 address.</span></span>  
  
   
  
## Examples  
 <span data-ttu-id="6be2f-1140">下面的示例创建源`MySource`如果它尚不存在，并将项写入事件日志`MyNewLog`。</span><span class="sxs-lookup"><span data-stu-id="6be2f-1140">The following example creates the source `MySource` if it does not already exist, and writes an entry to the event log `MyNewLog`.</span></span>  
  
 [!code-cpp[Classic EventLog.WriteEntry1 Example#1](~/samples/snippets/cpp/VS_Snippets_CLR_Classic/classic EventLog.WriteEntry1 Example/CPP/source.cpp#1)]
 [!code-csharp[Classic EventLog.WriteEntry1 Example#1](~/samples/snippets/csharp/VS_Snippets_CLR_Classic/classic EventLog.WriteEntry1 Example/CS/source.cs#1)]
 [!code-vb[Classic EventLog.WriteEntry1 Example#1](~/samples/snippets/visualbasic/VS_Snippets_CLR_Classic/classic EventLog.WriteEntry1 Example/VB/source.vb#1)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentException"><span data-ttu-id="6be2f-1141"><paramref name="source" /> 值是空字符串 ("")。</span><span class="sxs-lookup"><span data-stu-id="6be2f-1141">The <paramref name="source" /> value is an empty string ("").</span></span>  
  
 <span data-ttu-id="6be2f-1142">\- 或 -</span><span class="sxs-lookup"><span data-stu-id="6be2f-1142">\- or -</span></span>  
  
 <span data-ttu-id="6be2f-1143"><paramref name="source" /> 值为 <see langword="null" />。</span><span class="sxs-lookup"><span data-stu-id="6be2f-1143">The <paramref name="source" /> value is <see langword="null" />.</span></span>  
  
 <span data-ttu-id="6be2f-1144">\- 或 -</span><span class="sxs-lookup"><span data-stu-id="6be2f-1144">\- or -</span></span>  
  
 <span data-ttu-id="6be2f-1145">消息字符串长于 31,839 字节（在 Windows Vista 之前，在 Windows 操作系统上为 32,766 字节)。</span><span class="sxs-lookup"><span data-stu-id="6be2f-1145">The message string is longer than 31,839 bytes (32,766 bytes on Windows operating systems before Windows Vista).</span></span>  
  
 <span data-ttu-id="6be2f-1146">\- 或 -</span><span class="sxs-lookup"><span data-stu-id="6be2f-1146">\- or -</span></span>  
  
 <span data-ttu-id="6be2f-1147">此源名称导致注册表项路径的长度超过 254 个字符。</span><span class="sxs-lookup"><span data-stu-id="6be2f-1147">The source name results in a registry key path longer than 254 characters.</span></span></exception>
        <exception cref="T:System.InvalidOperationException"><span data-ttu-id="6be2f-1148">事件日志的注册表项未能打开。</span><span class="sxs-lookup"><span data-stu-id="6be2f-1148">The registry key for the event log could not be opened.</span></span></exception>
        <exception cref="T:System.ComponentModel.Win32Exception"><span data-ttu-id="6be2f-1149">将事件项写入事件日志时，操作系统报告了一个错误。</span><span class="sxs-lookup"><span data-stu-id="6be2f-1149">The operating system reported an error when writing the event entry to the event log.</span></span> <span data-ttu-id="6be2f-1150">一个 Windows 错误代码不可用。</span><span class="sxs-lookup"><span data-stu-id="6be2f-1150">A Windows error code is not available.</span></span></exception>
        <permission cref="T:System.Diagnostics.EventLogPermission"><span data-ttu-id="6be2f-1151">用于写入的计算机上的事件日志信息。</span><span class="sxs-lookup"><span data-stu-id="6be2f-1151">for writing the event log information on the computer.</span></span> <span data-ttu-id="6be2f-1152">关联的枚举： <see cref="F:System.Diagnostics.EventLogPermissionAccess.Write" /></span><span class="sxs-lookup"><span data-stu-id="6be2f-1152">Associated enumeration: <see cref="F:System.Diagnostics.EventLogPermissionAccess.Write" /></span></span></permission>
        <altmember cref="P:System.Diagnostics.EventLog.Source" />
        <altmember cref="Overload:System.Diagnostics.EventLog.CreateEventSource" />
        <altmember cref="M:System.Diagnostics.EventLog.DeleteEventSource(System.String)" />
        <altmember cref="M:System.Diagnostics.EventLog.SourceExists(System.String)" />
        <altmember cref="P:System.Diagnostics.EventLog.Entries" />
      </Docs>
    </Member>
    <Member MemberName="WriteEntry">
      <MemberSignature Language="C#" Value="public void WriteEntry (string message, System.Diagnostics.EventLogEntryType type, int eventID);" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig instance void WriteEntry(string message, valuetype System.Diagnostics.EventLogEntryType type, int32 eventID) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Diagnostics.EventLog.WriteEntry(System.String,System.Diagnostics.EventLogEntryType,System.Int32)" />
      <MemberSignature Language="VB.NET" Value="Public Sub WriteEntry (message As String, type As EventLogEntryType, eventID As Integer)" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; void WriteEntry(System::String ^ message, System::Diagnostics::EventLogEntryType type, int eventID);" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Void</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="message" Type="System.String" />
        <Parameter Name="type" Type="System.Diagnostics.EventLogEntryType" />
        <Parameter Name="eventID" Type="System.Int32" />
      </Parameters>
      <Docs>
        <param name="message"><span data-ttu-id="6be2f-1153">要写入事件日志的字符串。</span><span class="sxs-lookup"><span data-stu-id="6be2f-1153">The string to write to the event log.</span></span></param>
        <param name="type"><span data-ttu-id="6be2f-1154"><see cref="T:System.Diagnostics.EventLogEntryType" /> 值之一。</span><span class="sxs-lookup"><span data-stu-id="6be2f-1154">One of the <see cref="T:System.Diagnostics.EventLogEntryType" /> values.</span></span></param>
        <param name="eventID"><span data-ttu-id="6be2f-1155">事件的应用程序特定标识符。</span><span class="sxs-lookup"><span data-stu-id="6be2f-1155">The application-specific identifier for the event.</span></span></param>
        <summary><span data-ttu-id="6be2f-1156">将一个具有给定消息文本和应用程序定义的事件标识符的项写入事件日志。</span><span class="sxs-lookup"><span data-stu-id="6be2f-1156">Writes an entry with the given message text and application-defined event identifier to the event log.</span></span></summary>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="6be2f-1157">使用此方法写入与应用程序定义条目`eventID`到事件日志。</span><span class="sxs-lookup"><span data-stu-id="6be2f-1157">Use this method to write an entry with an application-defined `eventID` to the event log.</span></span> <span data-ttu-id="6be2f-1158">`eventID`与源一起唯一地标识事件。</span><span class="sxs-lookup"><span data-stu-id="6be2f-1158">The `eventID` together with the source uniquely identify an event.</span></span> <span data-ttu-id="6be2f-1159">每个应用程序可以定义其自己的编号的事件以及它们映射到其中的描述字符串。</span><span class="sxs-lookup"><span data-stu-id="6be2f-1159">Each application can define its own numbered events and the description strings to which they map.</span></span> <span data-ttu-id="6be2f-1160">事件查看器显示这些字符串值，以帮助用户了解发生的问题和建议采取的操作。</span><span class="sxs-lookup"><span data-stu-id="6be2f-1160">Event viewers display these string values to help the user understand what went wrong and suggest what actions to take.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="6be2f-1161">`message`字符串不能包含 %*n*，其中*n*是整数值 (例如，%1)，因为事件查看器会将其视为插入字符串。</span><span class="sxs-lookup"><span data-stu-id="6be2f-1161">The `message` string cannot contain %*n*, where *n* is an integer value (for example, %1), because the event viewer treats it as an insertion string.</span></span> <span data-ttu-id="6be2f-1162">Internet 协议版本 6 (IPv6) 地址只能包含此字符序列，因为无法记录事件消息包含 IPv6 地址。</span><span class="sxs-lookup"><span data-stu-id="6be2f-1162">Because an Internet Protocol, version 6 (IPv6) address can contain this character sequence, you cannot log an event message that contains an IPv6 address.</span></span>  
  
 <span data-ttu-id="6be2f-1163">除了事件标识符，还可以指定<xref:System.Diagnostics.EventLogEntryType>写入到事件日志的事件。</span><span class="sxs-lookup"><span data-stu-id="6be2f-1163">In addition to the event identifier, you can specify an <xref:System.Diagnostics.EventLogEntryType> for the event being written to the event log.</span></span> <span data-ttu-id="6be2f-1164">`type`指示由一个图标和事件查看器日志中的类型列中的文本。</span><span class="sxs-lookup"><span data-stu-id="6be2f-1164">The `type` is indicated by an icon and text in the Type column in the Event Viewer for a log.</span></span> <span data-ttu-id="6be2f-1165">此参数指示事件类型是否是错误、 警告、 信息、 成功审核或失败审核。</span><span class="sxs-lookup"><span data-stu-id="6be2f-1165">This parameter indicates whether the event type is error, warning, information, success audit, or failure audit.</span></span>  
  
 <span data-ttu-id="6be2f-1166">必须设置<xref:System.Diagnostics.EventLog.Source%2A>属性你<xref:System.Diagnostics.EventLog>组件之前可以将条目写入日志。</span><span class="sxs-lookup"><span data-stu-id="6be2f-1166">You must set the <xref:System.Diagnostics.EventLog.Source%2A> property on your <xref:System.Diagnostics.EventLog> component before you can write entries to the log.</span></span> <span data-ttu-id="6be2f-1167">你必须创建并在编写与源的第一个条目之前，配置事件源。</span><span class="sxs-lookup"><span data-stu-id="6be2f-1167">You must create and configure the event source before writing the first entry with the source.</span></span>  
  
 <span data-ttu-id="6be2f-1168">在你的应用程序的安装过程中创建新的事件源。</span><span class="sxs-lookup"><span data-stu-id="6be2f-1168">Create the new event source during the installation of your application.</span></span> <span data-ttu-id="6be2f-1169">这样，可以为操作系统来刷新其已注册的事件源的列表和其配置的时间。</span><span class="sxs-lookup"><span data-stu-id="6be2f-1169">This allows time for the operating system to refresh its list of registered event sources and their configuration.</span></span> <span data-ttu-id="6be2f-1170">如果操作系统未刷新其事件源的列表，并尝试写入新的源的事件写入操作将失败。</span><span class="sxs-lookup"><span data-stu-id="6be2f-1170">If the operating system has not refreshed its list of event sources, and you attempt to write an event with the new source, the write operation will fail.</span></span> <span data-ttu-id="6be2f-1171">你可以配置新的源使用<xref:System.Diagnostics.EventLogInstaller>，或使用<xref:System.Diagnostics.EventLog.CreateEventSource%2A>方法。</span><span class="sxs-lookup"><span data-stu-id="6be2f-1171">You can configure a new source using an <xref:System.Diagnostics.EventLogInstaller>, or using the <xref:System.Diagnostics.EventLog.CreateEventSource%2A> method.</span></span> <span data-ttu-id="6be2f-1172">若要创建新的事件源的计算机上，必须具有管理权限。</span><span class="sxs-lookup"><span data-stu-id="6be2f-1172">You must have administrative rights on the computer to create a new event source.</span></span>  
  
 <span data-ttu-id="6be2f-1173">如果在指定的源<xref:System.Diagnostics.EventLog.Source%2A>此属性<xref:System.Diagnostics.EventLog>写入你的组件，在计算机上未注册实例<xref:System.Diagnostics.EventLog.WriteEntry%2A>调用<xref:System.Diagnostics.EventLog.CreateEventSource%2A>并注册源。</span><span class="sxs-lookup"><span data-stu-id="6be2f-1173">If the source specified in the <xref:System.Diagnostics.EventLog.Source%2A> property of this <xref:System.Diagnostics.EventLog> instance is not registered on the computer that your component is writing to, <xref:System.Diagnostics.EventLog.WriteEntry%2A> calls <xref:System.Diagnostics.EventLog.CreateEventSource%2A> and registers the source.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="6be2f-1174">如果不指定<xref:System.Diagnostics.EventLog.MachineName%2A>为你<xref:System.Diagnostics.EventLog>实例然后才能调用<xref:System.Diagnostics.EventLog.CreateEventSource%2A>或<xref:System.Diagnostics.EventLog.WriteEntry%2A>，本地计算机 ("。") 假定。</span><span class="sxs-lookup"><span data-stu-id="6be2f-1174">If you do not specify a <xref:System.Diagnostics.EventLog.MachineName%2A> for your <xref:System.Diagnostics.EventLog> instance before you call <xref:System.Diagnostics.EventLog.CreateEventSource%2A> or <xref:System.Diagnostics.EventLog.WriteEntry%2A>, the local computer (".") is assumed.</span></span>  
  
 <span data-ttu-id="6be2f-1175">如果系统需要注册<xref:System.Diagnostics.EventLog.Source%2A>通过调用<xref:System.Diagnostics.EventLog.WriteEntry%2A>和<xref:System.Diagnostics.EventLog.Log%2A>未上设置属性你<xref:System.Diagnostics.EventLog>实例，该日志将默认为应用程序日志。</span><span class="sxs-lookup"><span data-stu-id="6be2f-1175">If the system needs to register the <xref:System.Diagnostics.EventLog.Source%2A> through a call to <xref:System.Diagnostics.EventLog.WriteEntry%2A> and the <xref:System.Diagnostics.EventLog.Log%2A> property has not been set on your <xref:System.Diagnostics.EventLog> instance, the log defaults to the Application log.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="6be2f-1176">上面列出的许多异常由错误生成的注册过程中发生<xref:System.Diagnostics.EventLog.Source%2A>。</span><span class="sxs-lookup"><span data-stu-id="6be2f-1176">Many exceptions listed above are generated by errors raised during the process of registering the <xref:System.Diagnostics.EventLog.Source%2A>.</span></span>  
  
 <span data-ttu-id="6be2f-1177">要写入本地化的项还是要直接写入字符串，则必须配置源。</span><span class="sxs-lookup"><span data-stu-id="6be2f-1177">The source must be configured either for writing localized entries or for writing direct strings.</span></span> <span data-ttu-id="6be2f-1178"><xref:System.Diagnostics.EventLog.WriteEntry%2A>方法直接写入事件日志将写入给定的字符串; 它不使用可本地化的消息资源文件。</span><span class="sxs-lookup"><span data-stu-id="6be2f-1178">The <xref:System.Diagnostics.EventLog.WriteEntry%2A> method writes the given string directly to the event log; it does not use a localizable message resource file.</span></span> <span data-ttu-id="6be2f-1179">使用<xref:System.Diagnostics.EventLog.WriteEvent%2A>方法来写入事件时使用本地化的消息资源文件。</span><span class="sxs-lookup"><span data-stu-id="6be2f-1179">Use the <xref:System.Diagnostics.EventLog.WriteEvent%2A> method to write events using a localized message resource file.</span></span>  
  
 <span data-ttu-id="6be2f-1180">如果你的应用程序将使用资源标识符和字符串值的条目，则必须注册两个单独的源。</span><span class="sxs-lookup"><span data-stu-id="6be2f-1180">If your application writes entries using both resource identifiers and string values, you must register two separate sources.</span></span> <span data-ttu-id="6be2f-1181">例如，使用资源文件，配置一个源，然后使用在该源<xref:System.Diagnostics.EventLog.WriteEvent%2A>方法来编写使用到事件日志的资源标识符的条目。</span><span class="sxs-lookup"><span data-stu-id="6be2f-1181">For example, configure one source with resource files, and then use that source in the <xref:System.Diagnostics.EventLog.WriteEvent%2A> method to write entries using resource identifiers to the event log.</span></span> <span data-ttu-id="6be2f-1182">然后创建不同的源，而无需资源文件，并使用在该源<xref:System.Diagnostics.EventLog.WriteEntry%2A>方法使用该源的事件日志中直接写入字符串。</span><span class="sxs-lookup"><span data-stu-id="6be2f-1182">Then create a different source without resource files, and use that source in the <xref:System.Diagnostics.EventLog.WriteEntry%2A> method to write strings directly to the event log using that source.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="6be2f-1183">如果远程计算机中写入一个条目，消息 （文本字符串） 的值可能不是你所预期如果远程计算机未在运行.NET Framework。</span><span class="sxs-lookup"><span data-stu-id="6be2f-1183">If you write an entry to a remote computer, the value of the message (the text string) might not be what you expect if the remote computer is not running the .NET Framework.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="6be2f-1184">如果`message`参数包含 NUL 字符，则在 NUL 字符处终止事件日志的消息中。</span><span class="sxs-lookup"><span data-stu-id="6be2f-1184">If the `message` parameter contains a NUL character, the message in the event log is terminated at the NUL character.</span></span>  
  
   
  
## Examples  
 [!code-cpp[EventLog_WriteEntry_1_3#3](~/samples/snippets/cpp/VS_Snippets_CLR/EventLog_WriteEntry_1_3/CPP/eventlog_writeentry_1_3.cpp#3)]
 [!code-csharp[EventLog_WriteEntry_1_3#3](~/samples/snippets/csharp/VS_Snippets_CLR/EventLog_WriteEntry_1_3/CS/eventlog_writeentry_1_3.cs#3)]
 [!code-vb[EventLog_WriteEntry_1_3#3](~/samples/snippets/visualbasic/VS_Snippets_CLR/EventLog_WriteEntry_1_3/VB/eventlog_writeentry_1_3.vb#3)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentException"><span data-ttu-id="6be2f-1185"><see cref="P:System.Diagnostics.EventLog.Source" /> 的 <see cref="T:System.Diagnostics.EventLog" /> 属性尚未设置。</span><span class="sxs-lookup"><span data-stu-id="6be2f-1185">The <see cref="P:System.Diagnostics.EventLog.Source" /> property of the <see cref="T:System.Diagnostics.EventLog" /> has not been set.</span></span>  
  
 <span data-ttu-id="6be2f-1186">或</span><span class="sxs-lookup"><span data-stu-id="6be2f-1186">-or-</span></span>  
  
 <span data-ttu-id="6be2f-1187">该方法尝试注册新的事件源，但 <see cref="P:System.Diagnostics.EventLog.MachineName" /> 中的计算机名称无效。</span><span class="sxs-lookup"><span data-stu-id="6be2f-1187">The method attempted to register a new event source, but the computer name in <see cref="P:System.Diagnostics.EventLog.MachineName" /> is not valid.</span></span>  
  
 <span data-ttu-id="6be2f-1188">\- 或 -</span><span class="sxs-lookup"><span data-stu-id="6be2f-1188">\- or -</span></span>  
  
 <span data-ttu-id="6be2f-1189">已为其他事件日志注册了该源。</span><span class="sxs-lookup"><span data-stu-id="6be2f-1189">The source is already registered for a different event log.</span></span>  
  
 <span data-ttu-id="6be2f-1190">\- 或 -</span><span class="sxs-lookup"><span data-stu-id="6be2f-1190">\- or -</span></span>  
  
 <span data-ttu-id="6be2f-1191"><paramref name="eventID" /> 小于零或大于 <see cref="F:System.UInt16.MaxValue" />。</span><span class="sxs-lookup"><span data-stu-id="6be2f-1191"><paramref name="eventID" /> is less than zero or greater than <see cref="F:System.UInt16.MaxValue" />.</span></span>  
  
 <span data-ttu-id="6be2f-1192">\- 或 -</span><span class="sxs-lookup"><span data-stu-id="6be2f-1192">\- or -</span></span>  
  
 <span data-ttu-id="6be2f-1193">消息字符串长于 31,839 字节（在 Windows Vista 之前，在 Windows 操作系统上为 32,766 字节)。</span><span class="sxs-lookup"><span data-stu-id="6be2f-1193">The message string is longer than 31,839 bytes (32,766 bytes on Windows operating systems before Windows Vista).</span></span>  
  
 <span data-ttu-id="6be2f-1194">\- 或 -</span><span class="sxs-lookup"><span data-stu-id="6be2f-1194">\- or -</span></span>  
  
 <span data-ttu-id="6be2f-1195">此源名称导致注册表项路径的长度超过 254 个字符。</span><span class="sxs-lookup"><span data-stu-id="6be2f-1195">The source name results in a registry key path longer than 254 characters.</span></span></exception>
        <exception cref="T:System.InvalidOperationException"><span data-ttu-id="6be2f-1196">事件日志的注册表项未能打开。</span><span class="sxs-lookup"><span data-stu-id="6be2f-1196">The registry key for the event log could not be opened.</span></span></exception>
        <exception cref="T:System.ComponentModel.InvalidEnumArgumentException">
          <span data-ttu-id="6be2f-1197"><paramref name="type" /> 不是有效的 <see cref="T:System.Diagnostics.EventLogEntryType" />。</span><span class="sxs-lookup"><span data-stu-id="6be2f-1197"><paramref name="type" /> is not a valid <see cref="T:System.Diagnostics.EventLogEntryType" />.</span></span></exception>
        <exception cref="T:System.ComponentModel.Win32Exception"><span data-ttu-id="6be2f-1198">将事件项写入事件日志时，操作系统报告了一个错误。</span><span class="sxs-lookup"><span data-stu-id="6be2f-1198">The operating system reported an error when writing the event entry to the event log.</span></span> <span data-ttu-id="6be2f-1199">一个 Windows 错误代码不可用。</span><span class="sxs-lookup"><span data-stu-id="6be2f-1199">A Windows error code is not available.</span></span></exception>
        <permission cref="T:System.Diagnostics.EventLogPermission"><span data-ttu-id="6be2f-1200">用于写入的计算机上的事件日志信息。</span><span class="sxs-lookup"><span data-stu-id="6be2f-1200">for writing the event log information on the computer.</span></span> <span data-ttu-id="6be2f-1201">关联的枚举： <see cref="F:System.Diagnostics.EventLogPermissionAccess.Write" /></span><span class="sxs-lookup"><span data-stu-id="6be2f-1201">Associated enumeration: <see cref="F:System.Diagnostics.EventLogPermissionAccess.Write" /></span></span></permission>
        <altmember cref="T:System.Diagnostics.EventLogEntryType" />
        <altmember cref="P:System.Diagnostics.EventLog.Source" />
        <altmember cref="Overload:System.Diagnostics.EventLog.CreateEventSource" />
        <altmember cref="M:System.Diagnostics.EventLog.DeleteEventSource(System.String)" />
        <altmember cref="M:System.Diagnostics.EventLog.SourceExists(System.String)" />
        <altmember cref="P:System.Diagnostics.EventLog.Entries" />
      </Docs>
    </Member>
    <Member MemberName="WriteEntry">
      <MemberSignature Language="C#" Value="public static void WriteEntry (string source, string message, System.Diagnostics.EventLogEntryType type);" />
      <MemberSignature Language="ILAsm" Value=".method public static hidebysig void WriteEntry(string source, string message, valuetype System.Diagnostics.EventLogEntryType type) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Diagnostics.EventLog.WriteEntry(System.String,System.String,System.Diagnostics.EventLogEntryType)" />
      <MemberSignature Language="VB.NET" Value="Public Shared Sub WriteEntry (source As String, message As String, type As EventLogEntryType)" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; static void WriteEntry(System::String ^ source, System::String ^ message, System::Diagnostics::EventLogEntryType type);" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Void</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="source" Type="System.String" />
        <Parameter Name="message" Type="System.String" />
        <Parameter Name="type" Type="System.Diagnostics.EventLogEntryType" />
      </Parameters>
      <Docs>
        <param name="source"><span data-ttu-id="6be2f-1202">应用程序在指定计算机上注册时所采用的源。</span><span class="sxs-lookup"><span data-stu-id="6be2f-1202">The source by which the application is registered on the specified computer.</span></span></param>
        <param name="message"><span data-ttu-id="6be2f-1203">要写入事件日志的字符串。</span><span class="sxs-lookup"><span data-stu-id="6be2f-1203">The string to write to the event log.</span></span></param>
        <param name="type"><span data-ttu-id="6be2f-1204"><see cref="T:System.Diagnostics.EventLogEntryType" /> 值之一。</span><span class="sxs-lookup"><span data-stu-id="6be2f-1204">One of the <see cref="T:System.Diagnostics.EventLogEntryType" /> values.</span></span></param>
        <summary><span data-ttu-id="6be2f-1205">使用指定的注册事件源，将错误、警告、信息、成功审核或失败审核项与给定的消息文本一起写入事件日志。</span><span class="sxs-lookup"><span data-stu-id="6be2f-1205">Writes an error, warning, information, success audit, or failure audit entry with the given message text to the event log, using the specified registered event source.</span></span></summary>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="6be2f-1206">使用此方法的指定项写入<xref:System.Diagnostics.EventLogEntryType>到事件日志中，将源使用已注册为相应的日志的事件源。</span><span class="sxs-lookup"><span data-stu-id="6be2f-1206">Use this method to write an entry of a specified <xref:System.Diagnostics.EventLogEntryType> to the event log, using a source already registered as an event source for the appropriate log.</span></span> <span data-ttu-id="6be2f-1207">`type`指示由一个图标和事件查看器日志中的类型列中的文本。</span><span class="sxs-lookup"><span data-stu-id="6be2f-1207">The `type` is indicated by an icon and text in the Type column in the Event Viewer for a log.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="6be2f-1208">`message`字符串不能包含 %*n*，其中*n*是整数值 (例如，%1)，因为事件查看器会将其视为插入字符串。</span><span class="sxs-lookup"><span data-stu-id="6be2f-1208">The `message` string cannot contain %*n*, where *n* is an integer value (for example, %1), because the event viewer treats it as an insertion string.</span></span> <span data-ttu-id="6be2f-1209">Internet 协议版本 6 (IPv6) 地址只能包含此字符序列，因为无法记录事件消息包含 IPv6 地址。</span><span class="sxs-lookup"><span data-stu-id="6be2f-1209">Because an Internet Protocol, version 6 (IPv6) address can contain this character sequence, you cannot log an event message that contains an IPv6 address.</span></span>  
  
 <span data-ttu-id="6be2f-1210">你必须创建并在编写与源的第一个条目之前，配置事件源。</span><span class="sxs-lookup"><span data-stu-id="6be2f-1210">You must create and configure the event source before writing the first entry with the source.</span></span> <span data-ttu-id="6be2f-1211">在你的应用程序的安装过程中创建新的事件源。</span><span class="sxs-lookup"><span data-stu-id="6be2f-1211">Create the new event source during the installation of your application.</span></span> <span data-ttu-id="6be2f-1212">这样，可以为操作系统来刷新其已注册的事件源的列表和其配置的时间。</span><span class="sxs-lookup"><span data-stu-id="6be2f-1212">This allows time for the operating system to refresh its list of registered event sources and their configuration.</span></span> <span data-ttu-id="6be2f-1213">如果操作系统未刷新其事件源的列表，并尝试写入新的源的事件写入操作将失败。</span><span class="sxs-lookup"><span data-stu-id="6be2f-1213">If the operating system has not refreshed its list of event sources, and you attempt to write an event with the new source, the write operation will fail.</span></span> <span data-ttu-id="6be2f-1214">你可以配置新的源使用<xref:System.Diagnostics.EventLogInstaller>，或使用<xref:System.Diagnostics.EventLog.CreateEventSource%2A>方法。</span><span class="sxs-lookup"><span data-stu-id="6be2f-1214">You can configure a new source using an <xref:System.Diagnostics.EventLogInstaller>, or using the <xref:System.Diagnostics.EventLog.CreateEventSource%2A> method.</span></span> <span data-ttu-id="6be2f-1215">若要创建新的事件源的计算机上，必须具有管理权限。</span><span class="sxs-lookup"><span data-stu-id="6be2f-1215">You must have administrative rights on the computer to create a new event source.</span></span>  
  
 <span data-ttu-id="6be2f-1216">要写入本地化的项还是要直接写入字符串，则必须配置源。</span><span class="sxs-lookup"><span data-stu-id="6be2f-1216">The source must be configured either for writing localized entries or for writing direct strings.</span></span> <span data-ttu-id="6be2f-1217"><xref:System.Diagnostics.EventLog.WriteEntry%2A>方法直接写入事件日志将写入给定的字符串; 它不使用可本地化的消息资源文件。</span><span class="sxs-lookup"><span data-stu-id="6be2f-1217">The <xref:System.Diagnostics.EventLog.WriteEntry%2A> method writes the given string directly to the event log; it does not use a localizable message resource file.</span></span> <span data-ttu-id="6be2f-1218">使用<xref:System.Diagnostics.EventLog.WriteEvent%2A>方法来写入事件时使用本地化的消息资源文件。</span><span class="sxs-lookup"><span data-stu-id="6be2f-1218">Use the <xref:System.Diagnostics.EventLog.WriteEvent%2A> method to write events using a localized message resource file.</span></span>  
  
 <span data-ttu-id="6be2f-1219">如果你的应用程序将使用资源标识符和字符串值的条目，则必须注册两个单独的源。</span><span class="sxs-lookup"><span data-stu-id="6be2f-1219">If your application writes entries using both resource identifiers and string values, you must register two separate sources.</span></span> <span data-ttu-id="6be2f-1220">例如，使用资源文件，配置一个源，然后使用在该源<xref:System.Diagnostics.EventLog.WriteEvent%2A>方法来编写使用到事件日志的资源标识符的条目。</span><span class="sxs-lookup"><span data-stu-id="6be2f-1220">For example, configure one source with resource files, and then use that source in the <xref:System.Diagnostics.EventLog.WriteEvent%2A> method to write entries using resource identifiers to the event log.</span></span> <span data-ttu-id="6be2f-1221">然后创建不同的源，而无需资源文件，并使用在该源<xref:System.Diagnostics.EventLog.WriteEntry%2A>方法使用该源的事件日志中直接写入字符串。</span><span class="sxs-lookup"><span data-stu-id="6be2f-1221">Then create a different source without resource files, and use that source in the <xref:System.Diagnostics.EventLog.WriteEntry%2A> method to write strings directly to the event log using that source.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="6be2f-1222">如果`message`参数包含 NUL 字符，则在 NUL 字符处终止事件日志的消息中。</span><span class="sxs-lookup"><span data-stu-id="6be2f-1222">If the `message` parameter contains a NUL character, the message in the event log is terminated at the NUL character.</span></span>  
  
   
  
## Examples  
 <span data-ttu-id="6be2f-1223">下面的示例在本地计算机上，向事件日志中，"MyNewLog"写入警告项。</span><span class="sxs-lookup"><span data-stu-id="6be2f-1223">The following example writes a warning entry to an event log, "MyNewLog", on the local computer.</span></span>  
  
 [!code-cpp[Classic EventLog.WriteEntry3 Example#1](~/samples/snippets/cpp/VS_Snippets_CLR_Classic/classic EventLog.WriteEntry3 Example/CPP/source.cpp#1)]
 [!code-csharp[Classic EventLog.WriteEntry3 Example#1](~/samples/snippets/csharp/VS_Snippets_CLR_Classic/classic EventLog.WriteEntry3 Example/CS/source.cs#1)]
 [!code-vb[Classic EventLog.WriteEntry3 Example#1](~/samples/snippets/visualbasic/VS_Snippets_CLR_Classic/classic EventLog.WriteEntry3 Example/VB/source.vb#1)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentException"><span data-ttu-id="6be2f-1224"><paramref name="source" /> 值是空字符串 ("")。</span><span class="sxs-lookup"><span data-stu-id="6be2f-1224">The <paramref name="source" /> value is an empty string ("").</span></span>  
  
 <span data-ttu-id="6be2f-1225">\- 或 -</span><span class="sxs-lookup"><span data-stu-id="6be2f-1225">\- or -</span></span>  
  
 <span data-ttu-id="6be2f-1226"><paramref name="source" /> 值为 <see langword="null" />。</span><span class="sxs-lookup"><span data-stu-id="6be2f-1226">The <paramref name="source" /> value is <see langword="null" />.</span></span>  
  
 <span data-ttu-id="6be2f-1227">\- 或 -</span><span class="sxs-lookup"><span data-stu-id="6be2f-1227">\- or -</span></span>  
  
 <span data-ttu-id="6be2f-1228">消息字符串长于 31,839 字节（在 Windows Vista 之前，在 Windows 操作系统上为 32,766 字节)。</span><span class="sxs-lookup"><span data-stu-id="6be2f-1228">The message string is longer than 31,839 bytes (32,766 bytes on Windows operating systems before Windows Vista).</span></span>  
  
 <span data-ttu-id="6be2f-1229">\- 或 -</span><span class="sxs-lookup"><span data-stu-id="6be2f-1229">\- or -</span></span>  
  
 <span data-ttu-id="6be2f-1230">此源名称导致注册表项路径的长度超过 254 个字符。</span><span class="sxs-lookup"><span data-stu-id="6be2f-1230">The source name results in a registry key path longer than 254 characters.</span></span></exception>
        <exception cref="T:System.InvalidOperationException"><span data-ttu-id="6be2f-1231">事件日志的注册表项未能打开。</span><span class="sxs-lookup"><span data-stu-id="6be2f-1231">The registry key for the event log could not be opened.</span></span></exception>
        <exception cref="T:System.ComponentModel.InvalidEnumArgumentException">
          <span data-ttu-id="6be2f-1232"><paramref name="type" /> 不是有效的 <see cref="T:System.Diagnostics.EventLogEntryType" />。</span><span class="sxs-lookup"><span data-stu-id="6be2f-1232"><paramref name="type" /> is not a valid <see cref="T:System.Diagnostics.EventLogEntryType" />.</span></span></exception>
        <exception cref="T:System.ComponentModel.Win32Exception"><span data-ttu-id="6be2f-1233">将事件项写入事件日志时，操作系统报告了一个错误。</span><span class="sxs-lookup"><span data-stu-id="6be2f-1233">The operating system reported an error when writing the event entry to the event log.</span></span> <span data-ttu-id="6be2f-1234">一个 Windows 错误代码不可用。</span><span class="sxs-lookup"><span data-stu-id="6be2f-1234">A Windows error code is not available.</span></span></exception>
        <permission cref="T:System.Diagnostics.EventLogPermission"><span data-ttu-id="6be2f-1235">用于写入的计算机上的事件日志信息。</span><span class="sxs-lookup"><span data-stu-id="6be2f-1235">for writing the event log information on the computer.</span></span> <span data-ttu-id="6be2f-1236">关联的枚举： <see cref="F:System.Diagnostics.EventLogPermissionAccess.Write" /></span><span class="sxs-lookup"><span data-stu-id="6be2f-1236">Associated enumeration: <see cref="F:System.Diagnostics.EventLogPermissionAccess.Write" /></span></span></permission>
        <altmember cref="T:System.Diagnostics.EventLogEntryType" />
        <altmember cref="P:System.Diagnostics.EventLog.Source" />
        <altmember cref="Overload:System.Diagnostics.EventLog.CreateEventSource" />
        <altmember cref="M:System.Diagnostics.EventLog.DeleteEventSource(System.String)" />
        <altmember cref="M:System.Diagnostics.EventLog.SourceExists(System.String)" />
        <altmember cref="P:System.Diagnostics.EventLog.Entries" />
      </Docs>
    </Member>
    <Member MemberName="WriteEntry">
      <MemberSignature Language="C#" Value="public void WriteEntry (string message, System.Diagnostics.EventLogEntryType type, int eventID, short category);" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig instance void WriteEntry(string message, valuetype System.Diagnostics.EventLogEntryType type, int32 eventID, int16 category) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Diagnostics.EventLog.WriteEntry(System.String,System.Diagnostics.EventLogEntryType,System.Int32,System.Int16)" />
      <MemberSignature Language="VB.NET" Value="Public Sub WriteEntry (message As String, type As EventLogEntryType, eventID As Integer, category As Short)" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; void WriteEntry(System::String ^ message, System::Diagnostics::EventLogEntryType type, int eventID, short category);" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Void</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="message" Type="System.String" />
        <Parameter Name="type" Type="System.Diagnostics.EventLogEntryType" />
        <Parameter Name="eventID" Type="System.Int32" />
        <Parameter Name="category" Type="System.Int16" />
      </Parameters>
      <Docs>
        <param name="message"><span data-ttu-id="6be2f-1237">要写入事件日志的字符串。</span><span class="sxs-lookup"><span data-stu-id="6be2f-1237">The string to write to the event log.</span></span></param>
        <param name="type"><span data-ttu-id="6be2f-1238"><see cref="T:System.Diagnostics.EventLogEntryType" /> 值之一。</span><span class="sxs-lookup"><span data-stu-id="6be2f-1238">One of the <see cref="T:System.Diagnostics.EventLogEntryType" /> values.</span></span></param>
        <param name="eventID"><span data-ttu-id="6be2f-1239">事件的应用程序特定标识符。</span><span class="sxs-lookup"><span data-stu-id="6be2f-1239">The application-specific identifier for the event.</span></span></param>
        <param name="category"><span data-ttu-id="6be2f-1240">与消息关联的应用程序特定子类别。</span><span class="sxs-lookup"><span data-stu-id="6be2f-1240">The application-specific subcategory associated with the message.</span></span></param>
        <summary><span data-ttu-id="6be2f-1241">将一个具有给定消息文本、应用程序定义的事件标识符和应用程序定义的类别的项写入事件日志。</span><span class="sxs-lookup"><span data-stu-id="6be2f-1241">Writes an entry with the given message text, application-defined event identifier, and application-defined category to the event log.</span></span></summary>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="6be2f-1242">使用此方法写入与应用程序定义条目`category`到事件日志。</span><span class="sxs-lookup"><span data-stu-id="6be2f-1242">Use this method to write an entry with an application-defined `category` to the event log.</span></span> <span data-ttu-id="6be2f-1243">事件查看器将使用到按事件源写入筛选器事件类别。</span><span class="sxs-lookup"><span data-stu-id="6be2f-1243">The Event Viewer uses the category to filter events written by an event source.</span></span> <span data-ttu-id="6be2f-1244">事件查看器可将类别显示为数字值，或者它可以作为资源标识符使用类别，以显示本地化的类别字符串。</span><span class="sxs-lookup"><span data-stu-id="6be2f-1244">The Event Viewer can display the category as a numeric value, or it can use the category as a resource identifier to display a localized category string.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="6be2f-1245">`category`参数应是正数值。</span><span class="sxs-lookup"><span data-stu-id="6be2f-1245">The `category` parameter should be a positive value.</span></span> <span data-ttu-id="6be2f-1246">负类别值显示为正补数在事件查看器。</span><span class="sxs-lookup"><span data-stu-id="6be2f-1246">Negative category values appear as a complementary positive number in the Event Viewer.</span></span> <span data-ttu-id="6be2f-1247">例如，– 10 显示为 65526，为 65535 为-1。</span><span class="sxs-lookup"><span data-stu-id="6be2f-1247">For example, a –10 appears as 65,526, a –1 as 65,535.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="6be2f-1248">`message`字符串不能包含 %*n*，其中*n*是整数值 (例如，%1)，因为事件查看器会将其视为插入字符串。</span><span class="sxs-lookup"><span data-stu-id="6be2f-1248">The `message` string cannot contain %*n*, where *n* is an integer value (for example, %1), because the event viewer treats it as an insertion string.</span></span> <span data-ttu-id="6be2f-1249">Internet 协议版本 6 (IPv6) 地址只能包含此字符序列，因为无法记录事件消息包含 IPv6 地址。</span><span class="sxs-lookup"><span data-stu-id="6be2f-1249">Because an Internet Protocol, version 6 (IPv6) address can contain this character sequence, you cannot log an event message that contains an IPv6 address.</span></span>  
  
 <span data-ttu-id="6be2f-1250">若要在事件查看器中显示本地化的类别字符串，必须使用事件源使用类别资源文件，配置和设置`category`类别资源文件中的资源标识符。</span><span class="sxs-lookup"><span data-stu-id="6be2f-1250">To display localized category strings in the Event Viewer, you must use an event source configured with a category resource file, and set the `category` to a resource identifier in the category resource file.</span></span> <span data-ttu-id="6be2f-1251">如果事件源没有配置的类别资源文件，或指定`category`没有索引在类别资源文件中，一个字符串，则事件查看器将显示该条目的数字类别值。</span><span class="sxs-lookup"><span data-stu-id="6be2f-1251">If the event source does not have a configured category resource file, or the specified `category` does not index a string in the category resource file, then the Event Viewer displays the numeric category value for that entry.</span></span> <span data-ttu-id="6be2f-1252">配置类别资源文件，以及数量的类别字符串在资源文件中，使用<xref:System.Diagnostics.EventLogInstaller>或<xref:System.Diagnostics.EventSourceCreationData>类。</span><span class="sxs-lookup"><span data-stu-id="6be2f-1252">Configure the category resource file, along with the number of category strings in the resource file, using the <xref:System.Diagnostics.EventLogInstaller> or the <xref:System.Diagnostics.EventSourceCreationData> class.</span></span>  
  
 <span data-ttu-id="6be2f-1253">除了类别，你可以指定要写入事件日志事件的事件标识符。</span><span class="sxs-lookup"><span data-stu-id="6be2f-1253">In addition to the category, you can specify an event identifier for the event being written to the event log.</span></span> <span data-ttu-id="6be2f-1254">事件标识符以及事件源，唯一标识的事件。</span><span class="sxs-lookup"><span data-stu-id="6be2f-1254">Event identifiers, along with the event source, uniquely identify an event.</span></span> <span data-ttu-id="6be2f-1255">每个应用程序可以定义其自己的编号的事件以及它们映射到其中的描述字符串。</span><span class="sxs-lookup"><span data-stu-id="6be2f-1255">Each application can define its own numbered events and the description strings to which they map.</span></span> <span data-ttu-id="6be2f-1256">事件查看器显示这些字符串值，以帮助用户了解发生的问题和建议采取的操作。</span><span class="sxs-lookup"><span data-stu-id="6be2f-1256">Event viewers display these string values to help the user understand what went wrong and suggest what actions to take.</span></span>  
  
 <span data-ttu-id="6be2f-1257">最后，你可以指定<xref:System.Diagnostics.EventLogEntryType>写入到事件日志的事件。</span><span class="sxs-lookup"><span data-stu-id="6be2f-1257">Finally, you can specify an <xref:System.Diagnostics.EventLogEntryType> for the event being written to the event log.</span></span> <span data-ttu-id="6be2f-1258">`type`指示由一个图标和事件查看器日志中的类型列中的文本。</span><span class="sxs-lookup"><span data-stu-id="6be2f-1258">The `type` is indicated by an icon and text in the Type column in the Event Viewer for a log.</span></span> <span data-ttu-id="6be2f-1259">此参数指示事件类型是否是错误、 警告、 信息、 成功审核或失败审核。</span><span class="sxs-lookup"><span data-stu-id="6be2f-1259">This parameter indicates whether the event type is error, warning, information, success audit, or failure audit.</span></span>  
  
 <span data-ttu-id="6be2f-1260">必须设置<xref:System.Diagnostics.EventLog.Source%2A>属性你<xref:System.Diagnostics.EventLog>组件之前可以将条目写入日志。</span><span class="sxs-lookup"><span data-stu-id="6be2f-1260">You must set the <xref:System.Diagnostics.EventLog.Source%2A> property on your <xref:System.Diagnostics.EventLog> component before you can write entries to the log.</span></span> <span data-ttu-id="6be2f-1261">你必须创建并在编写与源的第一个条目之前，配置事件源。</span><span class="sxs-lookup"><span data-stu-id="6be2f-1261">You must create and configure the event source before writing the first entry with the source.</span></span>  
  
 <span data-ttu-id="6be2f-1262">在你的应用程序的安装过程中创建新的事件源。</span><span class="sxs-lookup"><span data-stu-id="6be2f-1262">Create the new event source during the installation of your application.</span></span> <span data-ttu-id="6be2f-1263">这样，可以为操作系统来刷新其已注册的事件源的列表和其配置的时间。</span><span class="sxs-lookup"><span data-stu-id="6be2f-1263">This allows time for the operating system to refresh its list of registered event sources and their configuration.</span></span> <span data-ttu-id="6be2f-1264">如果操作系统未刷新其事件源的列表，并尝试写入新的源的事件写入操作将失败。</span><span class="sxs-lookup"><span data-stu-id="6be2f-1264">If the operating system has not refreshed its list of event sources, and you attempt to write an event with the new source, the write operation will fail.</span></span> <span data-ttu-id="6be2f-1265">你可以配置新的源使用<xref:System.Diagnostics.EventLogInstaller>，或使用<xref:System.Diagnostics.EventLog.CreateEventSource%2A>方法。</span><span class="sxs-lookup"><span data-stu-id="6be2f-1265">You can configure a new source using an <xref:System.Diagnostics.EventLogInstaller>, or using the <xref:System.Diagnostics.EventLog.CreateEventSource%2A> method.</span></span> <span data-ttu-id="6be2f-1266">若要创建新的事件源的计算机上，必须具有管理权限。</span><span class="sxs-lookup"><span data-stu-id="6be2f-1266">You must have administrative rights on the computer to create a new event source.</span></span>  
  
 <span data-ttu-id="6be2f-1267">如果在指定的源<xref:System.Diagnostics.EventLog.Source%2A>此属性<xref:System.Diagnostics.EventLog>写入你的组件，在计算机上未注册实例<xref:System.Diagnostics.EventLog.WriteEntry%2A>调用<xref:System.Diagnostics.EventLog.CreateEventSource%2A>并注册源。</span><span class="sxs-lookup"><span data-stu-id="6be2f-1267">If the source specified in the <xref:System.Diagnostics.EventLog.Source%2A> property of this <xref:System.Diagnostics.EventLog> instance is not registered on the computer that your component is writing to, <xref:System.Diagnostics.EventLog.WriteEntry%2A> calls <xref:System.Diagnostics.EventLog.CreateEventSource%2A> and registers the source.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="6be2f-1268">如果不指定<xref:System.Diagnostics.EventLog.MachineName%2A>为你<xref:System.Diagnostics.EventLog>实例然后才能调用<xref:System.Diagnostics.EventLog.CreateEventSource%2A>或<xref:System.Diagnostics.EventLog.WriteEntry%2A>，本地计算机 ("。") 假定。</span><span class="sxs-lookup"><span data-stu-id="6be2f-1268">If you do not specify a <xref:System.Diagnostics.EventLog.MachineName%2A> for your <xref:System.Diagnostics.EventLog> instance before you call <xref:System.Diagnostics.EventLog.CreateEventSource%2A> or <xref:System.Diagnostics.EventLog.WriteEntry%2A>, the local computer (".") is assumed.</span></span>  
  
 <span data-ttu-id="6be2f-1269">如果系统需要注册<xref:System.Diagnostics.EventLog.Source%2A>通过调用<xref:System.Diagnostics.EventLog.WriteEntry%2A>和<xref:System.Diagnostics.EventLog.Log%2A>未上设置属性你<xref:System.Diagnostics.EventLog>实例，该日志将默认为应用程序日志。</span><span class="sxs-lookup"><span data-stu-id="6be2f-1269">If the system needs to register the <xref:System.Diagnostics.EventLog.Source%2A> through a call to <xref:System.Diagnostics.EventLog.WriteEntry%2A> and the <xref:System.Diagnostics.EventLog.Log%2A> property has not been set on your <xref:System.Diagnostics.EventLog> instance, the log defaults to the Application log.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="6be2f-1270">上面列出的许多异常由错误生成的注册过程中发生<xref:System.Diagnostics.EventLog.Source%2A>。</span><span class="sxs-lookup"><span data-stu-id="6be2f-1270">Many exceptions listed above are generated by errors raised during the process of registering the <xref:System.Diagnostics.EventLog.Source%2A>.</span></span>  
  
 <span data-ttu-id="6be2f-1271">要写入本地化的项还是要直接写入字符串，则必须配置源。</span><span class="sxs-lookup"><span data-stu-id="6be2f-1271">The source must be configured either for writing localized entries or for writing direct strings.</span></span> <span data-ttu-id="6be2f-1272"><xref:System.Diagnostics.EventLog.WriteEntry%2A>方法直接写入事件日志将写入给定的字符串; 它不使用可本地化的消息资源文件。</span><span class="sxs-lookup"><span data-stu-id="6be2f-1272">The <xref:System.Diagnostics.EventLog.WriteEntry%2A> method writes the given string directly to the event log; it does not use a localizable message resource file.</span></span> <span data-ttu-id="6be2f-1273">使用<xref:System.Diagnostics.EventLog.WriteEvent%2A>方法来写入事件时使用本地化的消息资源文件。</span><span class="sxs-lookup"><span data-stu-id="6be2f-1273">Use the <xref:System.Diagnostics.EventLog.WriteEvent%2A> method to write events using a localized message resource file.</span></span>  
  
 <span data-ttu-id="6be2f-1274">如果你的应用程序将使用资源标识符和字符串值的条目，则必须注册两个单独的源。</span><span class="sxs-lookup"><span data-stu-id="6be2f-1274">If your application writes entries using both resource identifiers and string values, you must register two separate sources.</span></span> <span data-ttu-id="6be2f-1275">例如，使用资源文件，配置一个源，然后使用在该源<xref:System.Diagnostics.EventLog.WriteEvent%2A>方法来编写使用到事件日志的资源标识符的条目。</span><span class="sxs-lookup"><span data-stu-id="6be2f-1275">For example, configure one source with resource files, and then use that source in the <xref:System.Diagnostics.EventLog.WriteEvent%2A> method to write entries using resource identifiers to the event log.</span></span> <span data-ttu-id="6be2f-1276">然后创建不同的源，而无需资源文件，并使用在该源<xref:System.Diagnostics.EventLog.WriteEntry%2A>方法使用该源的事件日志中直接写入字符串。</span><span class="sxs-lookup"><span data-stu-id="6be2f-1276">Then create a different source without resource files, and use that source in the <xref:System.Diagnostics.EventLog.WriteEntry%2A> method to write strings directly to the event log using that source.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="6be2f-1277">如果远程计算机中写入一个条目，消息 （文本字符串） 的值可能不是你所预期如果远程计算机未在运行.NET Framework。</span><span class="sxs-lookup"><span data-stu-id="6be2f-1277">If you write an entry to a remote computer, the value of the message (the text string) might not be what you expect if the remote computer is not running the .NET Framework.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="6be2f-1278">如果`message`参数包含 NUL 字符，则在 NUL 字符处终止事件日志的消息中。</span><span class="sxs-lookup"><span data-stu-id="6be2f-1278">If the `message` parameter contains a NUL character, the message in the event log is terminated at the NUL character.</span></span>  
  
   
  
## Examples  
 [!code-cpp[EventLog_WriteEntry_1_3#3](~/samples/snippets/cpp/VS_Snippets_CLR/EventLog_WriteEntry_1_3/CPP/eventlog_writeentry_1_3.cpp#3)]
 [!code-csharp[EventLog_WriteEntry_1_3#3](~/samples/snippets/csharp/VS_Snippets_CLR/EventLog_WriteEntry_1_3/CS/eventlog_writeentry_1_3.cs#3)]
 [!code-vb[EventLog_WriteEntry_1_3#3](~/samples/snippets/visualbasic/VS_Snippets_CLR/EventLog_WriteEntry_1_3/VB/eventlog_writeentry_1_3.vb#3)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentException"><span data-ttu-id="6be2f-1279"><see cref="P:System.Diagnostics.EventLog.Source" /> 的 <see cref="T:System.Diagnostics.EventLog" /> 属性尚未设置。</span><span class="sxs-lookup"><span data-stu-id="6be2f-1279">The <see cref="P:System.Diagnostics.EventLog.Source" /> property of the <see cref="T:System.Diagnostics.EventLog" /> has not been set.</span></span>  
  
 <span data-ttu-id="6be2f-1280">或</span><span class="sxs-lookup"><span data-stu-id="6be2f-1280">-or-</span></span>  
  
 <span data-ttu-id="6be2f-1281">该方法尝试注册新的事件源，但 <see cref="P:System.Diagnostics.EventLog.MachineName" /> 中的计算机名称无效。</span><span class="sxs-lookup"><span data-stu-id="6be2f-1281">The method attempted to register a new event source, but the computer name in <see cref="P:System.Diagnostics.EventLog.MachineName" /> is not valid.</span></span>  
  
 <span data-ttu-id="6be2f-1282">\- 或 -</span><span class="sxs-lookup"><span data-stu-id="6be2f-1282">\- or -</span></span>  
  
 <span data-ttu-id="6be2f-1283">已为其他事件日志注册了该源。</span><span class="sxs-lookup"><span data-stu-id="6be2f-1283">The source is already registered for a different event log.</span></span>  
  
 <span data-ttu-id="6be2f-1284">\- 或 -</span><span class="sxs-lookup"><span data-stu-id="6be2f-1284">\- or -</span></span>  
  
 <span data-ttu-id="6be2f-1285"><paramref name="eventID" /> 小于零或大于 <see cref="F:System.UInt16.MaxValue" />。</span><span class="sxs-lookup"><span data-stu-id="6be2f-1285"><paramref name="eventID" /> is less than zero or greater than <see cref="F:System.UInt16.MaxValue" />.</span></span>  
  
 <span data-ttu-id="6be2f-1286">\- 或 -</span><span class="sxs-lookup"><span data-stu-id="6be2f-1286">\- or -</span></span>  
  
 <span data-ttu-id="6be2f-1287">消息字符串长于 31,839 字节（在 Windows Vista 之前，在 Windows 操作系统上为 32,766 字节)。</span><span class="sxs-lookup"><span data-stu-id="6be2f-1287">The message string is longer than 31,839 bytes (32,766 bytes on Windows operating systems before Windows Vista).</span></span>  
  
 <span data-ttu-id="6be2f-1288">\- 或 -</span><span class="sxs-lookup"><span data-stu-id="6be2f-1288">\- or -</span></span>  
  
 <span data-ttu-id="6be2f-1289">此源名称导致注册表项路径的长度超过 254 个字符。</span><span class="sxs-lookup"><span data-stu-id="6be2f-1289">The source name results in a registry key path longer than 254 characters.</span></span></exception>
        <exception cref="T:System.InvalidOperationException"><span data-ttu-id="6be2f-1290">事件日志的注册表项未能打开。</span><span class="sxs-lookup"><span data-stu-id="6be2f-1290">The registry key for the event log could not be opened.</span></span></exception>
        <exception cref="T:System.ComponentModel.InvalidEnumArgumentException">
          <span data-ttu-id="6be2f-1291"><paramref name="type" /> 不是有效的 <see cref="T:System.Diagnostics.EventLogEntryType" />。</span><span class="sxs-lookup"><span data-stu-id="6be2f-1291"><paramref name="type" /> is not a valid <see cref="T:System.Diagnostics.EventLogEntryType" />.</span></span></exception>
        <exception cref="T:System.ComponentModel.Win32Exception"><span data-ttu-id="6be2f-1292">将事件项写入事件日志时，操作系统报告了一个错误。</span><span class="sxs-lookup"><span data-stu-id="6be2f-1292">The operating system reported an error when writing the event entry to the event log.</span></span> <span data-ttu-id="6be2f-1293">一个 Windows 错误代码不可用。</span><span class="sxs-lookup"><span data-stu-id="6be2f-1293">A Windows error code is not available.</span></span></exception>
        <permission cref="T:System.Diagnostics.EventLogPermission"><span data-ttu-id="6be2f-1294">用于写入的计算机上的事件日志信息。</span><span class="sxs-lookup"><span data-stu-id="6be2f-1294">for writing the event log information on the computer.</span></span> <span data-ttu-id="6be2f-1295">关联的枚举： <see cref="F:System.Diagnostics.EventLogPermissionAccess.Write" /></span><span class="sxs-lookup"><span data-stu-id="6be2f-1295">Associated enumeration: <see cref="F:System.Diagnostics.EventLogPermissionAccess.Write" /></span></span></permission>
        <altmember cref="T:System.Diagnostics.EventLogEntryType" />
        <altmember cref="P:System.Diagnostics.EventLog.Source" />
        <altmember cref="Overload:System.Diagnostics.EventLog.CreateEventSource" />
        <altmember cref="M:System.Diagnostics.EventLog.DeleteEventSource(System.String)" />
        <altmember cref="M:System.Diagnostics.EventLog.SourceExists(System.String)" />
        <altmember cref="P:System.Diagnostics.EventLog.Entries" />
      </Docs>
    </Member>
    <Member MemberName="WriteEntry">
      <MemberSignature Language="C#" Value="public static void WriteEntry (string source, string message, System.Diagnostics.EventLogEntryType type, int eventID);" />
      <MemberSignature Language="ILAsm" Value=".method public static hidebysig void WriteEntry(string source, string message, valuetype System.Diagnostics.EventLogEntryType type, int32 eventID) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Diagnostics.EventLog.WriteEntry(System.String,System.String,System.Diagnostics.EventLogEntryType,System.Int32)" />
      <MemberSignature Language="VB.NET" Value="Public Shared Sub WriteEntry (source As String, message As String, type As EventLogEntryType, eventID As Integer)" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; static void WriteEntry(System::String ^ source, System::String ^ message, System::Diagnostics::EventLogEntryType type, int eventID);" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Void</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="source" Type="System.String" />
        <Parameter Name="message" Type="System.String" />
        <Parameter Name="type" Type="System.Diagnostics.EventLogEntryType" />
        <Parameter Name="eventID" Type="System.Int32" />
      </Parameters>
      <Docs>
        <param name="source"><span data-ttu-id="6be2f-1296">应用程序在指定计算机上注册时所采用的源。</span><span class="sxs-lookup"><span data-stu-id="6be2f-1296">The source by which the application is registered on the specified computer.</span></span></param>
        <param name="message"><span data-ttu-id="6be2f-1297">要写入事件日志的字符串。</span><span class="sxs-lookup"><span data-stu-id="6be2f-1297">The string to write to the event log.</span></span></param>
        <param name="type"><span data-ttu-id="6be2f-1298"><see cref="T:System.Diagnostics.EventLogEntryType" /> 值之一。</span><span class="sxs-lookup"><span data-stu-id="6be2f-1298">One of the <see cref="T:System.Diagnostics.EventLogEntryType" /> values.</span></span></param>
        <param name="eventID"><span data-ttu-id="6be2f-1299">事件的应用程序特定标识符。</span><span class="sxs-lookup"><span data-stu-id="6be2f-1299">The application-specific identifier for the event.</span></span></param>
        <summary><span data-ttu-id="6be2f-1300">使用指定的注册事件源，将一个具有给定消息文本和应用程序定义的事件标识符的项写入事件日志。</span><span class="sxs-lookup"><span data-stu-id="6be2f-1300">Writes an entry with the given message text and application-defined event identifier to the event log, using the specified registered event source.</span></span></summary>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="6be2f-1301">使用此方法写入与应用程序定义条目`eventID`到事件日志中，将源使用已注册为相应的日志的事件源。</span><span class="sxs-lookup"><span data-stu-id="6be2f-1301">Use this method to write an entry with an application-defined `eventID` to the event log, using a source already registered as an event source for the appropriate log.</span></span> <span data-ttu-id="6be2f-1302">`eventID`，以及源，唯一标识事件。</span><span class="sxs-lookup"><span data-stu-id="6be2f-1302">The `eventID`, along with the source, uniquely identify an event.</span></span> <span data-ttu-id="6be2f-1303">每个应用程序可以定义其自己的编号的事件以及它们映射到其中的描述字符串。</span><span class="sxs-lookup"><span data-stu-id="6be2f-1303">Each application can define its own numbered events and the description strings to which they map.</span></span> <span data-ttu-id="6be2f-1304">事件查看器将这些字符串向用户以帮助用户了解发生的问题并建议采取的操作。</span><span class="sxs-lookup"><span data-stu-id="6be2f-1304">Event viewers present these strings to the user to help the user understand what went wrong and suggest what actions to take.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="6be2f-1305">`message`字符串不能包含 %*n*，其中*n*是整数值 (例如，%1)，因为事件查看器会将其视为插入字符串。</span><span class="sxs-lookup"><span data-stu-id="6be2f-1305">The `message` string cannot contain %*n*, where *n* is an integer value (for example, %1), because the event viewer treats it as an insertion string.</span></span> <span data-ttu-id="6be2f-1306">Internet 协议版本 6 (IPv6) 地址只能包含此字符序列，因为无法记录事件消息包含 IPv6 地址。</span><span class="sxs-lookup"><span data-stu-id="6be2f-1306">Because an Internet Protocol, version 6 (IPv6) address can contain this character sequence, you cannot log an event message that contains an IPv6 address.</span></span>  
  
 <span data-ttu-id="6be2f-1307">此重载的事件标识符，除了<xref:System.Diagnostics.EventLog.WriteEntry%2A>允许您指定<xref:System.Diagnostics.EventLogEntryType>写入到事件日志的事件。</span><span class="sxs-lookup"><span data-stu-id="6be2f-1307">In addition to the event identifier, this overload of <xref:System.Diagnostics.EventLog.WriteEntry%2A> lets you specify an <xref:System.Diagnostics.EventLogEntryType> for the event being written to the event log.</span></span> <span data-ttu-id="6be2f-1308">`type`指示由一个图标和事件查看器日志中的类型列中的文本。</span><span class="sxs-lookup"><span data-stu-id="6be2f-1308">The `type` is indicated by an icon and text in the Type column in the Event Viewer for a log.</span></span> <span data-ttu-id="6be2f-1309">此参数指示事件类型是否是错误、 警告、 信息、 成功审核或失败审核。</span><span class="sxs-lookup"><span data-stu-id="6be2f-1309">This parameter indicates whether the event type is error, warning, information, success audit, or failure audit.</span></span>  
  
 <span data-ttu-id="6be2f-1310">你必须创建并在编写与源的第一个条目之前，配置事件源。</span><span class="sxs-lookup"><span data-stu-id="6be2f-1310">You must create and configure the event source before writing the first entry with the source.</span></span> <span data-ttu-id="6be2f-1311">在你的应用程序的安装过程中创建新的事件源。</span><span class="sxs-lookup"><span data-stu-id="6be2f-1311">Create the new event source during the installation of your application.</span></span> <span data-ttu-id="6be2f-1312">这样，可以为操作系统来刷新其已注册的事件源的列表和其配置的时间。</span><span class="sxs-lookup"><span data-stu-id="6be2f-1312">This allows time for the operating system to refresh its list of registered event sources and their configuration.</span></span> <span data-ttu-id="6be2f-1313">如果操作系统未刷新其事件源的列表，并尝试写入新的源的事件写入操作将失败。</span><span class="sxs-lookup"><span data-stu-id="6be2f-1313">If the operating system has not refreshed its list of event sources, and you attempt to write an event with the new source, the write operation will fail.</span></span> <span data-ttu-id="6be2f-1314">你可以配置新的源使用<xref:System.Diagnostics.EventLogInstaller>，或使用<xref:System.Diagnostics.EventLog.CreateEventSource%2A>方法。</span><span class="sxs-lookup"><span data-stu-id="6be2f-1314">You can configure a new source using an <xref:System.Diagnostics.EventLogInstaller>, or using the <xref:System.Diagnostics.EventLog.CreateEventSource%2A> method.</span></span> <span data-ttu-id="6be2f-1315">若要创建新的事件源的计算机上，必须具有管理权限。</span><span class="sxs-lookup"><span data-stu-id="6be2f-1315">You must have administrative rights on the computer to create a new event source.</span></span>  
  
 <span data-ttu-id="6be2f-1316">要写入本地化的项还是要直接写入字符串，则必须配置源。</span><span class="sxs-lookup"><span data-stu-id="6be2f-1316">The source must be configured either for writing localized entries or for writing direct strings.</span></span> <span data-ttu-id="6be2f-1317"><xref:System.Diagnostics.EventLog.WriteEntry%2A>方法直接写入事件日志将写入给定的字符串; 它不使用可本地化的消息资源文件。</span><span class="sxs-lookup"><span data-stu-id="6be2f-1317">The <xref:System.Diagnostics.EventLog.WriteEntry%2A> method writes the given string directly to the event log; it does not use a localizable message resource file.</span></span> <span data-ttu-id="6be2f-1318">使用<xref:System.Diagnostics.EventLog.WriteEvent%2A>方法来写入事件时使用本地化的消息资源文件。</span><span class="sxs-lookup"><span data-stu-id="6be2f-1318">Use the <xref:System.Diagnostics.EventLog.WriteEvent%2A> method to write events using a localized message resource file.</span></span>  
  
 <span data-ttu-id="6be2f-1319">如果你的应用程序将使用资源标识符和字符串值的条目，则必须注册两个单独的源。</span><span class="sxs-lookup"><span data-stu-id="6be2f-1319">If your application writes entries using both resource identifiers and string values, you must register two separate sources.</span></span> <span data-ttu-id="6be2f-1320">例如，使用资源文件，配置一个源，然后使用在该源<xref:System.Diagnostics.EventLog.WriteEvent%2A>方法来编写使用到事件日志的资源标识符的条目。</span><span class="sxs-lookup"><span data-stu-id="6be2f-1320">For example, configure one source with resource files, and then use that source in the <xref:System.Diagnostics.EventLog.WriteEvent%2A> method to write entries using resource identifiers to the event log.</span></span> <span data-ttu-id="6be2f-1321">然后创建不同的源，而无需资源文件，并使用在该源<xref:System.Diagnostics.EventLog.WriteEntry%2A>方法使用该源的事件日志中直接写入字符串。</span><span class="sxs-lookup"><span data-stu-id="6be2f-1321">Then create a different source without resource files, and use that source in the <xref:System.Diagnostics.EventLog.WriteEntry%2A> method to write strings directly to the event log using that source.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="6be2f-1322">如果`message`参数包含 NUL 字符，则在 NUL 字符处终止事件日志的消息中。</span><span class="sxs-lookup"><span data-stu-id="6be2f-1322">If the `message` parameter contains a NUL character, the message in the event log is terminated at the NUL character.</span></span>  
  
   
  
## Examples  
 [!code-cpp[EventLog_WriteEntry_4#1](~/samples/snippets/cpp/VS_Snippets_CLR/EventLog_WriteEntry_4/CPP/eventlog_writeentry_4.cpp#1)]
 [!code-csharp[EventLog_WriteEntry_4#1](~/samples/snippets/csharp/VS_Snippets_CLR/EventLog_WriteEntry_4/CS/eventlog_writeentry_4.cs#1)]
 [!code-vb[EventLog_WriteEntry_4#1](~/samples/snippets/visualbasic/VS_Snippets_CLR/EventLog_WriteEntry_4/VB/eventlog_writeentry_4.vb#1)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentException"><span data-ttu-id="6be2f-1323"><paramref name="source" /> 值是空字符串 ("")。</span><span class="sxs-lookup"><span data-stu-id="6be2f-1323">The <paramref name="source" /> value is an empty string ("").</span></span>  
  
 <span data-ttu-id="6be2f-1324">\- 或 -</span><span class="sxs-lookup"><span data-stu-id="6be2f-1324">\- or -</span></span>  
  
 <span data-ttu-id="6be2f-1325"><paramref name="source" /> 值为 <see langword="null" />。</span><span class="sxs-lookup"><span data-stu-id="6be2f-1325">The <paramref name="source" /> value is <see langword="null" />.</span></span>  
  
 <span data-ttu-id="6be2f-1326">\- 或 -</span><span class="sxs-lookup"><span data-stu-id="6be2f-1326">\- or -</span></span>  
  
 <span data-ttu-id="6be2f-1327"><paramref name="eventID" /> 小于零或大于 <see cref="F:System.UInt16.MaxValue" />。</span><span class="sxs-lookup"><span data-stu-id="6be2f-1327"><paramref name="eventID" /> is less than zero or greater than <see cref="F:System.UInt16.MaxValue" />.</span></span>  
  
 <span data-ttu-id="6be2f-1328">\- 或 -</span><span class="sxs-lookup"><span data-stu-id="6be2f-1328">\- or -</span></span>  
  
 <span data-ttu-id="6be2f-1329">消息字符串长于 31,839 字节（在 Windows Vista 之前，在 Windows 操作系统上为 32,766 字节)。</span><span class="sxs-lookup"><span data-stu-id="6be2f-1329">The message string is longer than 31,839 bytes (32,766 bytes on Windows operating systems before Windows Vista).</span></span>  
  
 <span data-ttu-id="6be2f-1330">\- 或 -</span><span class="sxs-lookup"><span data-stu-id="6be2f-1330">\- or -</span></span>  
  
 <span data-ttu-id="6be2f-1331">此源名称导致注册表项路径的长度超过 254 个字符。</span><span class="sxs-lookup"><span data-stu-id="6be2f-1331">The source name results in a registry key path longer than 254 characters.</span></span></exception>
        <exception cref="T:System.InvalidOperationException"><span data-ttu-id="6be2f-1332">事件日志的注册表项未能打开。</span><span class="sxs-lookup"><span data-stu-id="6be2f-1332">The registry key for the event log could not be opened.</span></span></exception>
        <exception cref="T:System.ComponentModel.InvalidEnumArgumentException">
          <span data-ttu-id="6be2f-1333"><paramref name="type" /> 不是有效的 <see cref="T:System.Diagnostics.EventLogEntryType" />。</span><span class="sxs-lookup"><span data-stu-id="6be2f-1333"><paramref name="type" /> is not a valid <see cref="T:System.Diagnostics.EventLogEntryType" />.</span></span></exception>
        <exception cref="T:System.ComponentModel.Win32Exception"><span data-ttu-id="6be2f-1334">将事件项写入事件日志时，操作系统报告了一个错误。</span><span class="sxs-lookup"><span data-stu-id="6be2f-1334">The operating system reported an error when writing the event entry to the event log.</span></span> <span data-ttu-id="6be2f-1335">一个 Windows 错误代码不可用。</span><span class="sxs-lookup"><span data-stu-id="6be2f-1335">A Windows error code is not available.</span></span></exception>
        <permission cref="T:System.Diagnostics.EventLogPermission"><span data-ttu-id="6be2f-1336">用于写入的计算机上的事件日志信息。</span><span class="sxs-lookup"><span data-stu-id="6be2f-1336">for writing the event log information on the computer.</span></span> <span data-ttu-id="6be2f-1337">关联的枚举： <see cref="F:System.Diagnostics.EventLogPermissionAccess.Write" /></span><span class="sxs-lookup"><span data-stu-id="6be2f-1337">Associated enumeration: <see cref="F:System.Diagnostics.EventLogPermissionAccess.Write" /></span></span></permission>
        <altmember cref="T:System.Diagnostics.EventLogEntryType" />
        <altmember cref="P:System.Diagnostics.EventLog.Source" />
        <altmember cref="Overload:System.Diagnostics.EventLog.CreateEventSource" />
        <altmember cref="M:System.Diagnostics.EventLog.DeleteEventSource(System.String)" />
        <altmember cref="M:System.Diagnostics.EventLog.SourceExists(System.String)" />
        <altmember cref="P:System.Diagnostics.EventLog.Entries" />
      </Docs>
    </Member>
    <Member MemberName="WriteEntry">
      <MemberSignature Language="C#" Value="public void WriteEntry (string message, System.Diagnostics.EventLogEntryType type, int eventID, short category, byte[] rawData);" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig instance void WriteEntry(string message, valuetype System.Diagnostics.EventLogEntryType type, int32 eventID, int16 category, unsigned int8[] rawData) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Diagnostics.EventLog.WriteEntry(System.String,System.Diagnostics.EventLogEntryType,System.Int32,System.Int16,System.Byte[])" />
      <MemberSignature Language="VB.NET" Value="Public Sub WriteEntry (message As String, type As EventLogEntryType, eventID As Integer, category As Short, rawData As Byte())" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; void WriteEntry(System::String ^ message, System::Diagnostics::EventLogEntryType type, int eventID, short category, cli::array &lt;System::Byte&gt; ^ rawData);" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Void</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="message" Type="System.String" />
        <Parameter Name="type" Type="System.Diagnostics.EventLogEntryType" />
        <Parameter Name="eventID" Type="System.Int32" />
        <Parameter Name="category" Type="System.Int16" />
        <Parameter Name="rawData" Type="System.Byte[]" />
      </Parameters>
      <Docs>
        <param name="message"><span data-ttu-id="6be2f-1338">要写入事件日志的字符串。</span><span class="sxs-lookup"><span data-stu-id="6be2f-1338">The string to write to the event log.</span></span></param>
        <param name="type"><span data-ttu-id="6be2f-1339"><see cref="T:System.Diagnostics.EventLogEntryType" /> 值之一。</span><span class="sxs-lookup"><span data-stu-id="6be2f-1339">One of the <see cref="T:System.Diagnostics.EventLogEntryType" /> values.</span></span></param>
        <param name="eventID"><span data-ttu-id="6be2f-1340">事件的应用程序特定标识符。</span><span class="sxs-lookup"><span data-stu-id="6be2f-1340">The application-specific identifier for the event.</span></span></param>
        <param name="category"><span data-ttu-id="6be2f-1341">与消息关联的应用程序特定子类别。</span><span class="sxs-lookup"><span data-stu-id="6be2f-1341">The application-specific subcategory associated with the message.</span></span></param>
        <param name="rawData"><span data-ttu-id="6be2f-1342">包含与此项关联的二进制数据的字节数组。</span><span class="sxs-lookup"><span data-stu-id="6be2f-1342">An array of bytes that holds the binary data associated with the entry.</span></span></param>
        <summary><span data-ttu-id="6be2f-1343">将一个具有给定消息文本、应用程序定义的事件标识符和应用程序定义的类别的项写入事件日志，并向消息追加二进制数据。</span><span class="sxs-lookup"><span data-stu-id="6be2f-1343">Writes an entry with the given message text, application-defined event identifier, and application-defined category to the event log, and appends binary data to the message.</span></span></summary>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="6be2f-1344">使用此重载将应用程序定义特定于事件的数据写入事件日志。</span><span class="sxs-lookup"><span data-stu-id="6be2f-1344">Use this overload to write application-defined event-specific data to the event log.</span></span> <span data-ttu-id="6be2f-1345">事件查看器不解释该数据。它仅在组合的十六进制转义序列和文本格式显示原始数据。</span><span class="sxs-lookup"><span data-stu-id="6be2f-1345">The Event Viewer does not interpret this data; it displays raw data only in a combined hexadecimal and text format.</span></span> <span data-ttu-id="6be2f-1346">特定于事件的数据应谨慎使用，包括它仅当你确信它将会对某人调试问题很有用。</span><span class="sxs-lookup"><span data-stu-id="6be2f-1346">Use event-specific data sparingly, including it only if you are sure it will be useful to someone debugging the problem.</span></span> <span data-ttu-id="6be2f-1347">特定于事件的数据还可用于存储应用程序可以处理独立于事件查看器的信息。</span><span class="sxs-lookup"><span data-stu-id="6be2f-1347">You can also use event-specific data to store information the application can process independently of the Event Viewer.</span></span> <span data-ttu-id="6be2f-1348">例如，你无法专门为事件，编写一个查看器或编写扫描日志文件，并创建报告，包括来自特定事件的数据的信息的程序。</span><span class="sxs-lookup"><span data-stu-id="6be2f-1348">For example, you could write a viewer specifically for your events, or write a program that scans the logfile and creates reports that include information from the event-specific data.</span></span>  
  
 <span data-ttu-id="6be2f-1349">除了二进制数据，还可以指定应用程序定义的类别和应用程序定义的事件标识符。</span><span class="sxs-lookup"><span data-stu-id="6be2f-1349">In addition to the binary data, you can specify an application-defined category and an application-defined event identifier.</span></span> <span data-ttu-id="6be2f-1350">事件查看器将使用到按事件源写入筛选器事件类别。</span><span class="sxs-lookup"><span data-stu-id="6be2f-1350">The Event Viewer uses the category to filter events written by an event source.</span></span> <span data-ttu-id="6be2f-1351">事件查看器可将类别显示为数字值，或者它可以作为资源标识符使用类别，以显示本地化的类别字符串。</span><span class="sxs-lookup"><span data-stu-id="6be2f-1351">The Event Viewer can display the category as a numeric value, or it can use the category as a resource identifier to display a localized category string.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="6be2f-1352">`message`字符串不能包含 %*n*，其中*n*是整数值 (例如，%1)，因为事件查看器会将其视为插入字符串。</span><span class="sxs-lookup"><span data-stu-id="6be2f-1352">The `message` string cannot contain %*n*, where *n* is an integer value (for example, %1), because the event viewer treats it as an insertion string.</span></span> <span data-ttu-id="6be2f-1353">Internet 协议版本 6 (IPv6) 地址只能包含此字符序列，因为无法记录事件消息包含 IPv6 地址。</span><span class="sxs-lookup"><span data-stu-id="6be2f-1353">Because an Internet Protocol, version 6 (IPv6) address can contain this character sequence, you cannot log an event message that contains an IPv6 address.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="6be2f-1354">`category`参数应是正数值。</span><span class="sxs-lookup"><span data-stu-id="6be2f-1354">The `category` parameter should be a positive value.</span></span> <span data-ttu-id="6be2f-1355">负类别值显示为正补数在事件查看器。</span><span class="sxs-lookup"><span data-stu-id="6be2f-1355">Negative category values appear as a complementary positive number in the Event Viewer.</span></span> <span data-ttu-id="6be2f-1356">例如，– 10 显示为 65526，为 65535 为-1。</span><span class="sxs-lookup"><span data-stu-id="6be2f-1356">For example, a –10 appears as 65,526, a –1 as 65,535.</span></span>  
  
 <span data-ttu-id="6be2f-1357">若要在事件查看器中显示本地化的类别字符串，必须使用事件源使用类别资源文件，配置和设置`category`类别资源文件中的资源标识符。</span><span class="sxs-lookup"><span data-stu-id="6be2f-1357">To display localized category strings in the Event Viewer, you must use an event source configured with a category resource file, and set the `category` to a resource identifier in the category resource file.</span></span> <span data-ttu-id="6be2f-1358">如果事件源没有配置的类别资源文件，或指定`category`没有索引在类别资源文件中，一个字符串，则事件查看器将显示该条目的数字类别值。</span><span class="sxs-lookup"><span data-stu-id="6be2f-1358">If the event source does not have a configured category resource file, or the specified `category` does not index a string in the category resource file, then the Event Viewer displays the numeric category value for that entry.</span></span> <span data-ttu-id="6be2f-1359">配置类别资源文件，以及数量的类别字符串在资源文件中，使用<xref:System.Diagnostics.EventLogInstaller>或<xref:System.Diagnostics.EventSourceCreationData>类。</span><span class="sxs-lookup"><span data-stu-id="6be2f-1359">Configure the category resource file, along with the number of category strings in the resource file, using the <xref:System.Diagnostics.EventLogInstaller> or the <xref:System.Diagnostics.EventSourceCreationData> class.</span></span>  
  
 <span data-ttu-id="6be2f-1360">事件标识符以及事件源，唯一标识的事件。</span><span class="sxs-lookup"><span data-stu-id="6be2f-1360">Event identifiers, along with the event source, uniquely identify an event.</span></span> <span data-ttu-id="6be2f-1361">每个应用程序可以定义其自己的编号的事件以及它们映射到其中的描述字符串。</span><span class="sxs-lookup"><span data-stu-id="6be2f-1361">Each application can define its own numbered events and the description strings to which they map.</span></span> <span data-ttu-id="6be2f-1362">事件查看器显示这些字符串值，以帮助用户了解发生的问题和建议采取的操作。</span><span class="sxs-lookup"><span data-stu-id="6be2f-1362">Event viewers display these string values to help the user understand what went wrong and suggest what actions to take.</span></span>  
  
 <span data-ttu-id="6be2f-1363">最后，你可以指定<xref:System.Diagnostics.EventLogEntryType>写入到事件日志的事件。</span><span class="sxs-lookup"><span data-stu-id="6be2f-1363">Finally, you can specify an <xref:System.Diagnostics.EventLogEntryType> for the event being written to the event log.</span></span> <span data-ttu-id="6be2f-1364">`type`指示由一个图标和事件查看器日志中的类型列中的文本。</span><span class="sxs-lookup"><span data-stu-id="6be2f-1364">The `type` is indicated by an icon and text in the Type column in the Event Viewer for a log.</span></span> <span data-ttu-id="6be2f-1365">此参数指示事件类型是否是错误、 警告、 信息、 成功审核或失败审核。</span><span class="sxs-lookup"><span data-stu-id="6be2f-1365">This parameter indicates whether the event type is error, warning, information, success audit, or failure audit.</span></span>  
  
 <span data-ttu-id="6be2f-1366">必须设置<xref:System.Diagnostics.EventLog.Source%2A>属性你<xref:System.Diagnostics.EventLog>组件之前可以将条目写入日志。</span><span class="sxs-lookup"><span data-stu-id="6be2f-1366">You must set the <xref:System.Diagnostics.EventLog.Source%2A> property on your <xref:System.Diagnostics.EventLog> component before you can write entries to the log.</span></span> <span data-ttu-id="6be2f-1367">你必须创建并在编写与源的第一个条目之前，配置事件源。</span><span class="sxs-lookup"><span data-stu-id="6be2f-1367">You must create and configure the event source before writing the first entry with the source.</span></span>  
  
 <span data-ttu-id="6be2f-1368">在你的应用程序的安装过程中创建新的事件源。</span><span class="sxs-lookup"><span data-stu-id="6be2f-1368">Create the new event source during the installation of your application.</span></span> <span data-ttu-id="6be2f-1369">这样，可以为操作系统来刷新其已注册的事件源的列表和其配置的时间。</span><span class="sxs-lookup"><span data-stu-id="6be2f-1369">This allows time for the operating system to refresh its list of registered event sources and their configuration.</span></span> <span data-ttu-id="6be2f-1370">如果操作系统未刷新其事件源的列表，并尝试写入新的源的事件写入操作将失败。</span><span class="sxs-lookup"><span data-stu-id="6be2f-1370">If the operating system has not refreshed its list of event sources, and you attempt to write an event with the new source, the write operation will fail.</span></span> <span data-ttu-id="6be2f-1371">你可以配置新的源使用<xref:System.Diagnostics.EventLogInstaller>，或使用<xref:System.Diagnostics.EventLog.CreateEventSource%2A>方法。</span><span class="sxs-lookup"><span data-stu-id="6be2f-1371">You can configure a new source using an <xref:System.Diagnostics.EventLogInstaller>, or using the <xref:System.Diagnostics.EventLog.CreateEventSource%2A> method.</span></span> <span data-ttu-id="6be2f-1372">若要创建新的事件源的计算机上，必须具有管理权限。</span><span class="sxs-lookup"><span data-stu-id="6be2f-1372">You must have administrative rights on the computer to create a new event source.</span></span>  
  
 <span data-ttu-id="6be2f-1373">如果在指定的源<xref:System.Diagnostics.EventLog.Source%2A>此属性<xref:System.Diagnostics.EventLog>写入你的组件，在计算机上未注册实例<xref:System.Diagnostics.EventLog.WriteEntry%2A>调用<xref:System.Diagnostics.EventLog.CreateEventSource%2A>并注册源。</span><span class="sxs-lookup"><span data-stu-id="6be2f-1373">If the source specified in the <xref:System.Diagnostics.EventLog.Source%2A> property of this <xref:System.Diagnostics.EventLog> instance is not registered on the computer that your component is writing to, <xref:System.Diagnostics.EventLog.WriteEntry%2A> calls <xref:System.Diagnostics.EventLog.CreateEventSource%2A> and registers the source.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="6be2f-1374">如果不指定<xref:System.Diagnostics.EventLog.MachineName%2A>为你<xref:System.Diagnostics.EventLog>实例然后才能调用<xref:System.Diagnostics.EventLog.CreateEventSource%2A>或<xref:System.Diagnostics.EventLog.WriteEntry%2A>，本地计算机 ("。") 假定。</span><span class="sxs-lookup"><span data-stu-id="6be2f-1374">If you do not specify a <xref:System.Diagnostics.EventLog.MachineName%2A> for your <xref:System.Diagnostics.EventLog> instance before you call <xref:System.Diagnostics.EventLog.CreateEventSource%2A> or <xref:System.Diagnostics.EventLog.WriteEntry%2A>, the local computer (".") is assumed.</span></span>  
  
 <span data-ttu-id="6be2f-1375">如果系统需要注册<xref:System.Diagnostics.EventLog.Source%2A>通过调用<xref:System.Diagnostics.EventLog.WriteEntry%2A>和<xref:System.Diagnostics.EventLog.Log%2A>未上设置属性你<xref:System.Diagnostics.EventLog>实例，该日志将默认为应用程序日志。</span><span class="sxs-lookup"><span data-stu-id="6be2f-1375">If the system needs to register the <xref:System.Diagnostics.EventLog.Source%2A> through a call to <xref:System.Diagnostics.EventLog.WriteEntry%2A> and the <xref:System.Diagnostics.EventLog.Log%2A> property has not been set on your <xref:System.Diagnostics.EventLog> instance, the log defaults to the Application log.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="6be2f-1376">上面列出的许多异常由错误生成的注册过程中发生<xref:System.Diagnostics.EventLog.Source%2A>。</span><span class="sxs-lookup"><span data-stu-id="6be2f-1376">Many exceptions listed above are generated by errors raised during the process of registering the <xref:System.Diagnostics.EventLog.Source%2A>.</span></span>  
  
 <span data-ttu-id="6be2f-1377">要写入本地化的项还是要直接写入字符串，则必须配置源。</span><span class="sxs-lookup"><span data-stu-id="6be2f-1377">The source must be configured either for writing localized entries or for writing direct strings.</span></span> <span data-ttu-id="6be2f-1378"><xref:System.Diagnostics.EventLog.WriteEntry%2A>方法直接写入事件日志将写入给定的字符串; 它不使用可本地化的消息资源文件。</span><span class="sxs-lookup"><span data-stu-id="6be2f-1378">The <xref:System.Diagnostics.EventLog.WriteEntry%2A> method writes the given string directly to the event log; it does not use a localizable message resource file.</span></span> <span data-ttu-id="6be2f-1379">使用<xref:System.Diagnostics.EventLog.WriteEvent%2A>方法来写入事件时使用本地化的消息资源文件。</span><span class="sxs-lookup"><span data-stu-id="6be2f-1379">Use the <xref:System.Diagnostics.EventLog.WriteEvent%2A> method to write events using a localized message resource file.</span></span>  
  
 <span data-ttu-id="6be2f-1380">如果你的应用程序将使用资源标识符和字符串值的条目，则必须注册两个单独的源。</span><span class="sxs-lookup"><span data-stu-id="6be2f-1380">If your application writes entries using both resource identifiers and string values, you must register two separate sources.</span></span> <span data-ttu-id="6be2f-1381">例如，使用资源文件，配置一个源，然后使用在该源<xref:System.Diagnostics.EventLog.WriteEvent%2A>方法来编写使用到事件日志的资源标识符的条目。</span><span class="sxs-lookup"><span data-stu-id="6be2f-1381">For example, configure one source with resource files, and then use that source in the <xref:System.Diagnostics.EventLog.WriteEvent%2A> method to write entries using resource identifiers to the event log.</span></span> <span data-ttu-id="6be2f-1382">然后创建不同的源，而无需资源文件，并使用在该源<xref:System.Diagnostics.EventLog.WriteEntry%2A>方法使用该源的事件日志中直接写入字符串。</span><span class="sxs-lookup"><span data-stu-id="6be2f-1382">Then create a different source without resource files, and use that source in the <xref:System.Diagnostics.EventLog.WriteEntry%2A> method to write strings directly to the event log using that source.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="6be2f-1383">如果远程计算机中写入一个条目，消息 （文本字符串） 的值可能不是你所预期如果远程计算机未在运行.NET Framework。</span><span class="sxs-lookup"><span data-stu-id="6be2f-1383">If you write an entry to a remote computer, the value of the message (the text string) might not be what you expect if the remote computer is not running the .NET Framework.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="6be2f-1384">如果`message`参数包含 NUL 字符，则在 NUL 字符处终止事件日志的消息中。</span><span class="sxs-lookup"><span data-stu-id="6be2f-1384">If the `message` parameter contains a NUL character, the message in the event log is terminated at the NUL character.</span></span>  
  
   
  
## Examples  
 [!code-cpp[EventLog_WriteEntry_5#1](~/samples/snippets/cpp/VS_Snippets_CLR/EventLog_WriteEntry_5/CPP/eventlog_writeentry_5.cpp#1)]
 [!code-csharp[EventLog_WriteEntry_5#1](~/samples/snippets/csharp/VS_Snippets_CLR/EventLog_WriteEntry_5/CS/eventlog_writeentry_5.cs#1)]
 [!code-vb[EventLog_WriteEntry_5#1](~/samples/snippets/visualbasic/VS_Snippets_CLR/EventLog_WriteEntry_5/VB/eventlog_writeentry_5.vb#1)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentException"><span data-ttu-id="6be2f-1385"><see cref="P:System.Diagnostics.EventLog.Source" /> 的 <see cref="T:System.Diagnostics.EventLog" /> 属性尚未设置。</span><span class="sxs-lookup"><span data-stu-id="6be2f-1385">The <see cref="P:System.Diagnostics.EventLog.Source" /> property of the <see cref="T:System.Diagnostics.EventLog" /> has not been set.</span></span>  
  
 <span data-ttu-id="6be2f-1386">或</span><span class="sxs-lookup"><span data-stu-id="6be2f-1386">-or-</span></span>  
  
 <span data-ttu-id="6be2f-1387">该方法尝试注册新的事件源，但 <see cref="P:System.Diagnostics.EventLog.MachineName" /> 中的计算机名称无效。</span><span class="sxs-lookup"><span data-stu-id="6be2f-1387">The method attempted to register a new event source, but the computer name in <see cref="P:System.Diagnostics.EventLog.MachineName" /> is not valid.</span></span>  
  
 <span data-ttu-id="6be2f-1388">\- 或 -</span><span class="sxs-lookup"><span data-stu-id="6be2f-1388">\- or -</span></span>  
  
 <span data-ttu-id="6be2f-1389">已为其他事件日志注册了该源。</span><span class="sxs-lookup"><span data-stu-id="6be2f-1389">The source is already registered for a different event log.</span></span>  
  
 <span data-ttu-id="6be2f-1390">\- 或 -</span><span class="sxs-lookup"><span data-stu-id="6be2f-1390">\- or -</span></span>  
  
 <span data-ttu-id="6be2f-1391"><paramref name="eventID" /> 小于零或大于 <see cref="F:System.UInt16.MaxValue" />。</span><span class="sxs-lookup"><span data-stu-id="6be2f-1391"><paramref name="eventID" /> is less than zero or greater than <see cref="F:System.UInt16.MaxValue" />.</span></span>  
  
 <span data-ttu-id="6be2f-1392">\- 或 -</span><span class="sxs-lookup"><span data-stu-id="6be2f-1392">\- or -</span></span>  
  
 <span data-ttu-id="6be2f-1393">消息字符串长于 31,839 字节（在 Windows Vista 之前，在 Windows 操作系统上为 32,766 字节)。</span><span class="sxs-lookup"><span data-stu-id="6be2f-1393">The message string is longer than 31,839 bytes (32,766 bytes on Windows operating systems before Windows Vista).</span></span>  
  
 <span data-ttu-id="6be2f-1394">\- 或 -</span><span class="sxs-lookup"><span data-stu-id="6be2f-1394">\- or -</span></span>  
  
 <span data-ttu-id="6be2f-1395">此源名称导致注册表项路径的长度超过 254 个字符。</span><span class="sxs-lookup"><span data-stu-id="6be2f-1395">The source name results in a registry key path longer than 254 characters.</span></span></exception>
        <exception cref="T:System.InvalidOperationException"><span data-ttu-id="6be2f-1396">事件日志的注册表项未能打开。</span><span class="sxs-lookup"><span data-stu-id="6be2f-1396">The registry key for the event log could not be opened.</span></span></exception>
        <exception cref="T:System.ComponentModel.InvalidEnumArgumentException">
          <span data-ttu-id="6be2f-1397"><paramref name="type" /> 不是有效的 <see cref="T:System.Diagnostics.EventLogEntryType" />。</span><span class="sxs-lookup"><span data-stu-id="6be2f-1397"><paramref name="type" /> is not a valid <see cref="T:System.Diagnostics.EventLogEntryType" />.</span></span></exception>
        <exception cref="T:System.ComponentModel.Win32Exception"><span data-ttu-id="6be2f-1398">将事件项写入事件日志时，操作系统报告了一个错误。</span><span class="sxs-lookup"><span data-stu-id="6be2f-1398">The operating system reported an error when writing the event entry to the event log.</span></span> <span data-ttu-id="6be2f-1399">一个 Windows 错误代码不可用。</span><span class="sxs-lookup"><span data-stu-id="6be2f-1399">A Windows error code is not available.</span></span></exception>
        <permission cref="T:System.Diagnostics.EventLogPermission"><span data-ttu-id="6be2f-1400">用于写入的计算机上的事件日志信息。</span><span class="sxs-lookup"><span data-stu-id="6be2f-1400">for writing the event log information on the computer.</span></span> <span data-ttu-id="6be2f-1401">关联的枚举： <see cref="F:System.Diagnostics.EventLogPermissionAccess.Write" /></span><span class="sxs-lookup"><span data-stu-id="6be2f-1401">Associated enumeration: <see cref="F:System.Diagnostics.EventLogPermissionAccess.Write" /></span></span></permission>
        <altmember cref="T:System.Diagnostics.EventLogEntryType" />
        <altmember cref="P:System.Diagnostics.EventLog.Source" />
        <altmember cref="Overload:System.Diagnostics.EventLog.CreateEventSource" />
        <altmember cref="M:System.Diagnostics.EventLog.DeleteEventSource(System.String)" />
        <altmember cref="M:System.Diagnostics.EventLog.SourceExists(System.String)" />
        <altmember cref="P:System.Diagnostics.EventLog.Entries" />
      </Docs>
    </Member>
    <Member MemberName="WriteEntry">
      <MemberSignature Language="C#" Value="public static void WriteEntry (string source, string message, System.Diagnostics.EventLogEntryType type, int eventID, short category);" />
      <MemberSignature Language="ILAsm" Value=".method public static hidebysig void WriteEntry(string source, string message, valuetype System.Diagnostics.EventLogEntryType type, int32 eventID, int16 category) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Diagnostics.EventLog.WriteEntry(System.String,System.String,System.Diagnostics.EventLogEntryType,System.Int32,System.Int16)" />
      <MemberSignature Language="VB.NET" Value="Public Shared Sub WriteEntry (source As String, message As String, type As EventLogEntryType, eventID As Integer, category As Short)" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; static void WriteEntry(System::String ^ source, System::String ^ message, System::Diagnostics::EventLogEntryType type, int eventID, short category);" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Void</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="source" Type="System.String" />
        <Parameter Name="message" Type="System.String" />
        <Parameter Name="type" Type="System.Diagnostics.EventLogEntryType" />
        <Parameter Name="eventID" Type="System.Int32" />
        <Parameter Name="category" Type="System.Int16" />
      </Parameters>
      <Docs>
        <param name="source"><span data-ttu-id="6be2f-1402">应用程序在指定计算机上注册时所采用的源。</span><span class="sxs-lookup"><span data-stu-id="6be2f-1402">The source by which the application is registered on the specified computer.</span></span></param>
        <param name="message"><span data-ttu-id="6be2f-1403">要写入事件日志的字符串。</span><span class="sxs-lookup"><span data-stu-id="6be2f-1403">The string to write to the event log.</span></span></param>
        <param name="type"><span data-ttu-id="6be2f-1404"><see cref="T:System.Diagnostics.EventLogEntryType" /> 值之一。</span><span class="sxs-lookup"><span data-stu-id="6be2f-1404">One of the <see cref="T:System.Diagnostics.EventLogEntryType" /> values.</span></span></param>
        <param name="eventID"><span data-ttu-id="6be2f-1405">事件的应用程序特定标识符。</span><span class="sxs-lookup"><span data-stu-id="6be2f-1405">The application-specific identifier for the event.</span></span></param>
        <param name="category"><span data-ttu-id="6be2f-1406">与消息关联的应用程序特定子类别。</span><span class="sxs-lookup"><span data-stu-id="6be2f-1406">The application-specific subcategory associated with the message.</span></span></param>
        <summary><span data-ttu-id="6be2f-1407">通过使用指定的注册事件源，将一个具有给定消息文本、应用程序定义的事件标识符和应用程序定义的类别的项写入事件日志。</span><span class="sxs-lookup"><span data-stu-id="6be2f-1407">Writes an entry with the given message text, application-defined event identifier, and application-defined category to the event log, using the specified registered event source.</span></span> <span data-ttu-id="6be2f-1408">事件查看器可使用 <paramref name="category" /> 筛选日志中的事件。</span><span class="sxs-lookup"><span data-stu-id="6be2f-1408">The <paramref name="category" /> can be used by the Event Viewer to filter events in the log.</span></span></summary>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="6be2f-1409">使用此方法写入与应用程序定义条目`category`到事件日志中，使用已注册为相应的日志的事件源的源。</span><span class="sxs-lookup"><span data-stu-id="6be2f-1409">Use this method to write an entry with an application-defined `category` to the event log, using a source that is already registered as an event source for the appropriate log.</span></span> <span data-ttu-id="6be2f-1410">事件查看器将使用到按事件源写入筛选器事件类别。</span><span class="sxs-lookup"><span data-stu-id="6be2f-1410">The Event Viewer uses the category to filter events written by an event source.</span></span> <span data-ttu-id="6be2f-1411">事件查看器可将类别显示为数字值，或者它可以作为资源标识符使用类别，以显示本地化的类别字符串。</span><span class="sxs-lookup"><span data-stu-id="6be2f-1411">The Event Viewer can display the category as a numeric value, or it can use the category as a resource identifier to display a localized category string.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="6be2f-1412">`category`参数应是正数值。</span><span class="sxs-lookup"><span data-stu-id="6be2f-1412">The `category` parameter should be a positive value.</span></span> <span data-ttu-id="6be2f-1413">负类别值显示为正补数在事件查看器。</span><span class="sxs-lookup"><span data-stu-id="6be2f-1413">Negative category values appear as a complementary positive number in the Event Viewer.</span></span> <span data-ttu-id="6be2f-1414">例如，– 10 显示为 65526，为 65535 为-1。</span><span class="sxs-lookup"><span data-stu-id="6be2f-1414">For example, a –10 appears as 65,526, a –1 as 65,535.</span></span>  
  
 <span data-ttu-id="6be2f-1415">若要在事件查看器中显示本地化的类别字符串，必须使用事件源使用类别资源文件，配置和设置`category`类别资源文件中的资源标识符。</span><span class="sxs-lookup"><span data-stu-id="6be2f-1415">To display localized category strings in the Event Viewer, you must use an event source configured with a category resource file, and set the `category` to a resource identifier in the category resource file.</span></span> <span data-ttu-id="6be2f-1416">如果事件源没有配置的类别资源文件，或指定`category`没有索引在类别资源文件中，一个字符串，则事件查看器将显示该条目的数字类别值。</span><span class="sxs-lookup"><span data-stu-id="6be2f-1416">If the event source does not have a configured category resource file, or the specified `category` does not index a string in the category resource file, then the Event Viewer displays the numeric category value for that entry.</span></span> <span data-ttu-id="6be2f-1417">配置类别资源文件，以及数量的类别字符串在资源文件中，使用<xref:System.Diagnostics.EventLogInstaller>或<xref:System.Diagnostics.EventSourceCreationData>类。</span><span class="sxs-lookup"><span data-stu-id="6be2f-1417">Configure the category resource file, along with the number of category strings in the resource file, using the <xref:System.Diagnostics.EventLogInstaller> or the <xref:System.Diagnostics.EventSourceCreationData> class.</span></span>  
  
 <span data-ttu-id="6be2f-1418">除了类别，你可以指定要写入事件日志事件的事件标识符。</span><span class="sxs-lookup"><span data-stu-id="6be2f-1418">In addition to the category, you can specify an event identifier for the event being written to the event log.</span></span> <span data-ttu-id="6be2f-1419">事件标识符以及事件源，唯一标识的事件。</span><span class="sxs-lookup"><span data-stu-id="6be2f-1419">Event identifiers, along with the event source, uniquely identify an event.</span></span> <span data-ttu-id="6be2f-1420">每个应用程序可以定义其自己的编号的事件以及它们映射到其中的描述字符串。</span><span class="sxs-lookup"><span data-stu-id="6be2f-1420">Each application can define its own numbered events and the description strings to which they map.</span></span> <span data-ttu-id="6be2f-1421">事件查看器显示这些字符串值，以帮助用户了解发生的问题和建议采取的操作。</span><span class="sxs-lookup"><span data-stu-id="6be2f-1421">Event viewers display these string values to help the user understand what went wrong and suggest what actions to take.</span></span>  
  
 <span data-ttu-id="6be2f-1422">最后，你可以指定<xref:System.Diagnostics.EventLogEntryType>写入到事件日志的事件。</span><span class="sxs-lookup"><span data-stu-id="6be2f-1422">Finally, you can specify an <xref:System.Diagnostics.EventLogEntryType> for the event being written to the event log.</span></span> <span data-ttu-id="6be2f-1423">`type`指示由一个图标和事件查看器日志中的类型列中的文本。</span><span class="sxs-lookup"><span data-stu-id="6be2f-1423">The `type` is indicated by an icon and text in the Type column in the Event Viewer for a log.</span></span> <span data-ttu-id="6be2f-1424">此参数指示事件类型是否是错误、 警告、 信息、 成功审核或失败审核。</span><span class="sxs-lookup"><span data-stu-id="6be2f-1424">This parameter indicates whether the event type is error, warning, information, success audit, or failure audit.</span></span>  
  
 <span data-ttu-id="6be2f-1425">你必须创建并在编写与源的第一个条目之前，配置事件源。</span><span class="sxs-lookup"><span data-stu-id="6be2f-1425">You must create and configure the event source before writing the first entry with the source.</span></span> <span data-ttu-id="6be2f-1426">在你的应用程序的安装过程中创建新的事件源。</span><span class="sxs-lookup"><span data-stu-id="6be2f-1426">Create the new event source during the installation of your application.</span></span> <span data-ttu-id="6be2f-1427">这样，可以为操作系统来刷新其已注册的事件源的列表和其配置的时间。</span><span class="sxs-lookup"><span data-stu-id="6be2f-1427">This allows time for the operating system to refresh its list of registered event sources and their configuration.</span></span> <span data-ttu-id="6be2f-1428">如果操作系统未刷新其事件源的列表，并尝试写入新的源的事件写入操作将失败。</span><span class="sxs-lookup"><span data-stu-id="6be2f-1428">If the operating system has not refreshed its list of event sources, and you attempt to write an event with the new source, the write operation will fail.</span></span> <span data-ttu-id="6be2f-1429">你可以配置新的源使用<xref:System.Diagnostics.EventLogInstaller>，或使用<xref:System.Diagnostics.EventLog.CreateEventSource%2A>方法。</span><span class="sxs-lookup"><span data-stu-id="6be2f-1429">You can configure a new source using an <xref:System.Diagnostics.EventLogInstaller>, or using the <xref:System.Diagnostics.EventLog.CreateEventSource%2A> method.</span></span> <span data-ttu-id="6be2f-1430">若要创建新的事件源的计算机上，必须具有管理权限。</span><span class="sxs-lookup"><span data-stu-id="6be2f-1430">You must have administrative rights on the computer to create a new event source.</span></span>  
  
 <span data-ttu-id="6be2f-1431">要写入本地化的项还是要直接写入字符串，则必须配置源。</span><span class="sxs-lookup"><span data-stu-id="6be2f-1431">The source must be configured either for writing localized entries or for writing direct strings.</span></span> <span data-ttu-id="6be2f-1432"><xref:System.Diagnostics.EventLog.WriteEntry%2A>方法直接写入事件日志将写入给定的字符串; 它不使用可本地化的消息资源文件。</span><span class="sxs-lookup"><span data-stu-id="6be2f-1432">The <xref:System.Diagnostics.EventLog.WriteEntry%2A> method writes the given string directly to the event log; it does not use a localizable message resource file.</span></span> <span data-ttu-id="6be2f-1433">使用<xref:System.Diagnostics.EventLog.WriteEvent%2A>方法来写入事件时使用本地化的消息资源文件。</span><span class="sxs-lookup"><span data-stu-id="6be2f-1433">Use the <xref:System.Diagnostics.EventLog.WriteEvent%2A> method to write events using a localized message resource file.</span></span>  
  
 <span data-ttu-id="6be2f-1434">如果你的应用程序将使用资源标识符和字符串值的条目，则必须注册两个单独的源。</span><span class="sxs-lookup"><span data-stu-id="6be2f-1434">If your application writes entries using both resource identifiers and string values, you must register two separate sources.</span></span> <span data-ttu-id="6be2f-1435">例如，使用资源文件，配置一个源，然后使用在该源<xref:System.Diagnostics.EventLog.WriteEvent%2A>方法来编写使用到事件日志的资源标识符的条目。</span><span class="sxs-lookup"><span data-stu-id="6be2f-1435">For example, configure one source with resource files, and then use that source in the <xref:System.Diagnostics.EventLog.WriteEvent%2A> method to write entries using resource identifiers to the event log.</span></span> <span data-ttu-id="6be2f-1436">然后创建不同的源，而无需资源文件，并使用在该源<xref:System.Diagnostics.EventLog.WriteEntry%2A>方法使用该源的事件日志中直接写入字符串。</span><span class="sxs-lookup"><span data-stu-id="6be2f-1436">Then create a different source without resource files, and use that source in the <xref:System.Diagnostics.EventLog.WriteEntry%2A> method to write strings directly to the event log using that source.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="6be2f-1437">如果`message`参数包含 NUL 字符，则在 NUL 字符处终止事件日志的消息中。</span><span class="sxs-lookup"><span data-stu-id="6be2f-1437">If the `message` parameter contains a NUL character, the message in the event log is terminated at the NUL character.</span></span>  
>   
>  <span data-ttu-id="6be2f-1438">`message`字符串不能包含 %*n*，其中*n*是整数值 (例如，%1)，因为事件查看器会将其视为插入字符串。</span><span class="sxs-lookup"><span data-stu-id="6be2f-1438">The `message` string cannot contain %*n*, where *n* is an integer value (for example, %1), because the event viewer treats it as an insertion string.</span></span> <span data-ttu-id="6be2f-1439">Internet 协议版本 6 (IPv6) 地址只能包含此字符序列，因为无法记录事件消息包含 IPv6 地址。</span><span class="sxs-lookup"><span data-stu-id="6be2f-1439">Because an Internet Protocol, version 6 (IPv6) address can contain this character sequence, you cannot log an event message that contains an IPv6 address.</span></span>  
  
   
  
## Examples  
 [!code-cpp[EventLog_WriteEntry_1_3#1](~/samples/snippets/cpp/VS_Snippets_CLR/EventLog_WriteEntry_1_3/CPP/eventlog_writeentry_1_3.cpp#1)]
 [!code-csharp[EventLog_WriteEntry_1_3#1](~/samples/snippets/csharp/VS_Snippets_CLR/EventLog_WriteEntry_1_3/CS/eventlog_writeentry_1_3.cs#1)]
 [!code-vb[EventLog_WriteEntry_1_3#1](~/samples/snippets/visualbasic/VS_Snippets_CLR/EventLog_WriteEntry_1_3/VB/eventlog_writeentry_1_3.vb#1)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentException"><span data-ttu-id="6be2f-1440"><paramref name="source" /> 值是空字符串 ("")。</span><span class="sxs-lookup"><span data-stu-id="6be2f-1440">The <paramref name="source" /> value is an empty string ("").</span></span>  
  
 <span data-ttu-id="6be2f-1441">\- 或 -</span><span class="sxs-lookup"><span data-stu-id="6be2f-1441">\- or -</span></span>  
  
 <span data-ttu-id="6be2f-1442"><paramref name="source" /> 值为 <see langword="null" />。</span><span class="sxs-lookup"><span data-stu-id="6be2f-1442">The <paramref name="source" /> value is <see langword="null" />.</span></span>  
  
 <span data-ttu-id="6be2f-1443">\- 或 -</span><span class="sxs-lookup"><span data-stu-id="6be2f-1443">\- or -</span></span>  
  
 <span data-ttu-id="6be2f-1444"><paramref name="eventID" /> 小于零或大于 <see cref="F:System.UInt16.MaxValue" />。</span><span class="sxs-lookup"><span data-stu-id="6be2f-1444"><paramref name="eventID" /> is less than zero or greater than <see cref="F:System.UInt16.MaxValue" />.</span></span>  
  
 <span data-ttu-id="6be2f-1445">\- 或 -</span><span class="sxs-lookup"><span data-stu-id="6be2f-1445">\- or -</span></span>  
  
 <span data-ttu-id="6be2f-1446">消息字符串长于 31,839 字节（在 Windows Vista 之前，在 Windows 操作系统上为 32,766 字节)。</span><span class="sxs-lookup"><span data-stu-id="6be2f-1446">The message string is longer than 31,839 bytes (32,766 bytes on Windows operating systems before Windows Vista).</span></span>  
  
 <span data-ttu-id="6be2f-1447">\- 或 -</span><span class="sxs-lookup"><span data-stu-id="6be2f-1447">\- or -</span></span>  
  
 <span data-ttu-id="6be2f-1448">此源名称导致注册表项路径的长度超过 254 个字符。</span><span class="sxs-lookup"><span data-stu-id="6be2f-1448">The source name results in a registry key path longer than 254 characters.</span></span></exception>
        <exception cref="T:System.InvalidOperationException"><span data-ttu-id="6be2f-1449">事件日志的注册表项未能打开。</span><span class="sxs-lookup"><span data-stu-id="6be2f-1449">The registry key for the event log could not be opened.</span></span></exception>
        <exception cref="T:System.ComponentModel.InvalidEnumArgumentException">
          <span data-ttu-id="6be2f-1450"><paramref name="type" /> 不是有效的 <see cref="T:System.Diagnostics.EventLogEntryType" />。</span><span class="sxs-lookup"><span data-stu-id="6be2f-1450"><paramref name="type" /> is not a valid <see cref="T:System.Diagnostics.EventLogEntryType" />.</span></span></exception>
        <exception cref="T:System.ComponentModel.Win32Exception"><span data-ttu-id="6be2f-1451">将事件项写入事件日志时，操作系统报告了一个错误。</span><span class="sxs-lookup"><span data-stu-id="6be2f-1451">The operating system reported an error when writing the event entry to the event log.</span></span> <span data-ttu-id="6be2f-1452">一个 Windows 错误代码不可用。</span><span class="sxs-lookup"><span data-stu-id="6be2f-1452">A Windows error code is not available.</span></span></exception>
        <permission cref="T:System.Diagnostics.EventLogPermission"><span data-ttu-id="6be2f-1453">用于写入的计算机上的事件日志信息。</span><span class="sxs-lookup"><span data-stu-id="6be2f-1453">for writing the event log information on the computer.</span></span> <span data-ttu-id="6be2f-1454">关联的枚举： <see cref="F:System.Diagnostics.EventLogPermissionAccess.Write" /></span><span class="sxs-lookup"><span data-stu-id="6be2f-1454">Associated enumeration: <see cref="F:System.Diagnostics.EventLogPermissionAccess.Write" /></span></span></permission>
        <altmember cref="T:System.Diagnostics.EventLogEntryType" />
        <altmember cref="P:System.Diagnostics.EventLog.Source" />
        <altmember cref="Overload:System.Diagnostics.EventLog.CreateEventSource" />
        <altmember cref="M:System.Diagnostics.EventLog.DeleteEventSource(System.String)" />
        <altmember cref="M:System.Diagnostics.EventLog.SourceExists(System.String)" />
        <altmember cref="P:System.Diagnostics.EventLog.Entries" />
      </Docs>
    </Member>
    <Member MemberName="WriteEntry">
      <MemberSignature Language="C#" Value="public static void WriteEntry (string source, string message, System.Diagnostics.EventLogEntryType type, int eventID, short category, byte[] rawData);" />
      <MemberSignature Language="ILAsm" Value=".method public static hidebysig void WriteEntry(string source, string message, valuetype System.Diagnostics.EventLogEntryType type, int32 eventID, int16 category, unsigned int8[] rawData) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Diagnostics.EventLog.WriteEntry(System.String,System.String,System.Diagnostics.EventLogEntryType,System.Int32,System.Int16,System.Byte[])" />
      <MemberSignature Language="VB.NET" Value="Public Shared Sub WriteEntry (source As String, message As String, type As EventLogEntryType, eventID As Integer, category As Short, rawData As Byte())" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; static void WriteEntry(System::String ^ source, System::String ^ message, System::Diagnostics::EventLogEntryType type, int eventID, short category, cli::array &lt;System::Byte&gt; ^ rawData);" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Void</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="source" Type="System.String" />
        <Parameter Name="message" Type="System.String" />
        <Parameter Name="type" Type="System.Diagnostics.EventLogEntryType" />
        <Parameter Name="eventID" Type="System.Int32" />
        <Parameter Name="category" Type="System.Int16" />
        <Parameter Name="rawData" Type="System.Byte[]" />
      </Parameters>
      <Docs>
        <param name="source"><span data-ttu-id="6be2f-1455">应用程序在指定计算机上注册时所采用的源。</span><span class="sxs-lookup"><span data-stu-id="6be2f-1455">The source by which the application is registered on the specified computer.</span></span></param>
        <param name="message"><span data-ttu-id="6be2f-1456">要写入事件日志的字符串。</span><span class="sxs-lookup"><span data-stu-id="6be2f-1456">The string to write to the event log.</span></span></param>
        <param name="type"><span data-ttu-id="6be2f-1457"><see cref="T:System.Diagnostics.EventLogEntryType" /> 值之一。</span><span class="sxs-lookup"><span data-stu-id="6be2f-1457">One of the <see cref="T:System.Diagnostics.EventLogEntryType" /> values.</span></span></param>
        <param name="eventID"><span data-ttu-id="6be2f-1458">事件的应用程序特定标识符。</span><span class="sxs-lookup"><span data-stu-id="6be2f-1458">The application-specific identifier for the event.</span></span></param>
        <param name="category"><span data-ttu-id="6be2f-1459">与消息关联的应用程序特定子类别。</span><span class="sxs-lookup"><span data-stu-id="6be2f-1459">The application-specific subcategory associated with the message.</span></span></param>
        <param name="rawData"><span data-ttu-id="6be2f-1460">包含与此项关联的二进制数据的字节数组。</span><span class="sxs-lookup"><span data-stu-id="6be2f-1460">An array of bytes that holds the binary data associated with the entry.</span></span></param>
        <summary><span data-ttu-id="6be2f-1461">（使用指定的注册事件源）将一个包含给定消息文本、应用程序定义的事件标识符和应用程序定义的类别的项写入事件日志，并向消息追加二进制数据。</span><span class="sxs-lookup"><span data-stu-id="6be2f-1461">Writes an entry with the given message text, application-defined event identifier, and application-defined category to the event log (using the specified registered event source) and appends binary data to the message.</span></span></summary>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="6be2f-1462">使用此方法将应用程序定义特定于事件的数据写入事件日志中，使用已注册为相应的日志的事件源的源。</span><span class="sxs-lookup"><span data-stu-id="6be2f-1462">Use this method to write application-defined event-specific data to the event log, using a source already registered as an event source for the appropriate log.</span></span> <span data-ttu-id="6be2f-1463">事件查看器不解释该数据。它仅在组合的十六进制转义序列和文本格式显示原始数据。</span><span class="sxs-lookup"><span data-stu-id="6be2f-1463">The Event Viewer does not interpret this data; it displays raw data only in a combined hexadecimal and text format.</span></span> <span data-ttu-id="6be2f-1464">应谨慎; 使用特定于事件的数据仅当你确信它将会很有用，则将其包含。</span><span class="sxs-lookup"><span data-stu-id="6be2f-1464">Use event-specific data sparingly; include it only if you are sure it will be useful.</span></span> <span data-ttu-id="6be2f-1465">特定于事件的数据还可用于存储应用程序可以处理独立于事件查看器的信息。</span><span class="sxs-lookup"><span data-stu-id="6be2f-1465">You can also use event-specific data to store information the application can process independently of the Event Viewer.</span></span> <span data-ttu-id="6be2f-1466">例如，你无法专门为事件，编写一个查看器或编写扫描日志文件，并创建报告，包括来自特定事件的数据的信息的程序。</span><span class="sxs-lookup"><span data-stu-id="6be2f-1466">For example, you could write a viewer specifically for your events, or write a program that scans the logfile and creates reports that include information from the event-specific data.</span></span>  
  
 <span data-ttu-id="6be2f-1467">除了二进制数据，还可以指定应用程序定义的类别和应用程序定义的事件标识符。</span><span class="sxs-lookup"><span data-stu-id="6be2f-1467">In addition to the binary data, you can specify an application-defined category and an application-defined event identifier.</span></span> <span data-ttu-id="6be2f-1468">事件查看器将使用到按事件源写入筛选器事件类别。</span><span class="sxs-lookup"><span data-stu-id="6be2f-1468">The Event Viewer uses the category to filter events written by an event source.</span></span> <span data-ttu-id="6be2f-1469">事件查看器可将类别显示为数字值，或者它可以作为资源标识符使用类别，以显示本地化的类别字符串。</span><span class="sxs-lookup"><span data-stu-id="6be2f-1469">The Event Viewer can display the category as a numeric value, or it can use the category as a resource identifier to display a localized category string.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="6be2f-1470">`category`参数应是正数值。</span><span class="sxs-lookup"><span data-stu-id="6be2f-1470">The `category` parameter should be a positive value.</span></span> <span data-ttu-id="6be2f-1471">负类别值显示为正补数在事件查看器。</span><span class="sxs-lookup"><span data-stu-id="6be2f-1471">Negative category values appear as a complementary positive number in the Event Viewer.</span></span> <span data-ttu-id="6be2f-1472">例如，– 10 将显示为 65526，为 65535 为-1。</span><span class="sxs-lookup"><span data-stu-id="6be2f-1472">For example, a –10 will appear as 65,526, a –1 as 65,535.</span></span>  
  
 <span data-ttu-id="6be2f-1473">若要在事件查看器中显示本地化的类别字符串，必须使用事件源使用类别资源文件，配置和设置`category`类别资源文件中的资源标识符。</span><span class="sxs-lookup"><span data-stu-id="6be2f-1473">To display localized category strings in the Event Viewer, you must use an event source configured with a category resource file, and set the `category` to a resource identifier in the category resource file.</span></span> <span data-ttu-id="6be2f-1474">如果事件源没有配置的类别资源文件，或指定`category`没有索引在类别资源文件中，一个字符串，则事件查看器将显示该条目的数字类别值。</span><span class="sxs-lookup"><span data-stu-id="6be2f-1474">If the event source does not have a configured category resource file, or the specified `category` does not index a string in the category resource file, then the Event Viewer displays the numeric category value for that entry.</span></span> <span data-ttu-id="6be2f-1475">配置类别资源文件，以及数量的类别字符串在资源文件中，使用<xref:System.Diagnostics.EventLogInstaller>或<xref:System.Diagnostics.EventSourceCreationData>类。</span><span class="sxs-lookup"><span data-stu-id="6be2f-1475">Configure the category resource file, along with the number of category strings in the resource file, using the <xref:System.Diagnostics.EventLogInstaller> or the <xref:System.Diagnostics.EventSourceCreationData> class.</span></span>  
  
 <span data-ttu-id="6be2f-1476">事件标识符，以及事件源，唯一标识的事件。</span><span class="sxs-lookup"><span data-stu-id="6be2f-1476">Event identifiers, together with the event source, uniquely identify an event.</span></span> <span data-ttu-id="6be2f-1477">每个应用程序可以定义其自己的编号的事件以及它们映射到其中的描述字符串。</span><span class="sxs-lookup"><span data-stu-id="6be2f-1477">Each application can define its own numbered events and the description strings to which they map.</span></span> <span data-ttu-id="6be2f-1478">事件查看器显示这些字符串值，以帮助用户了解发生的问题和建议采取的操作。</span><span class="sxs-lookup"><span data-stu-id="6be2f-1478">Event viewers display these string values to help the user understand what went wrong and suggest what actions to take.</span></span>  
  
 <span data-ttu-id="6be2f-1479">最后，你可以指定<xref:System.Diagnostics.EventLogEntryType>写入到事件日志的事件。</span><span class="sxs-lookup"><span data-stu-id="6be2f-1479">Finally, you can specify an <xref:System.Diagnostics.EventLogEntryType> for the event being written to the event log.</span></span> <span data-ttu-id="6be2f-1480">`type`指示由一个图标和事件查看器日志中的类型列中的文本。</span><span class="sxs-lookup"><span data-stu-id="6be2f-1480">The `type` is indicated by an icon and text in the Type column in the Event Viewer for a log.</span></span> <span data-ttu-id="6be2f-1481">此参数指示事件类型是否是错误、 警告、 信息、 成功审核或失败审核。</span><span class="sxs-lookup"><span data-stu-id="6be2f-1481">This parameter indicates whether the event type is error, warning, information, success audit, or failure audit.</span></span>  
  
 <span data-ttu-id="6be2f-1482">你必须创建并在编写与源的第一个条目之前，配置事件源。</span><span class="sxs-lookup"><span data-stu-id="6be2f-1482">You must create and configure the event source before writing the first entry with the source.</span></span> <span data-ttu-id="6be2f-1483">在你的应用程序的安装过程中创建新的事件源。</span><span class="sxs-lookup"><span data-stu-id="6be2f-1483">Create the new event source during the installation of your application.</span></span> <span data-ttu-id="6be2f-1484">这样，可以为操作系统来刷新其已注册的事件源的列表和其配置的时间。</span><span class="sxs-lookup"><span data-stu-id="6be2f-1484">This allows time for the operating system to refresh its list of registered event sources and their configuration.</span></span> <span data-ttu-id="6be2f-1485">如果操作系统未刷新其事件源的列表，并尝试写入新的源的事件写入操作将失败。</span><span class="sxs-lookup"><span data-stu-id="6be2f-1485">If the operating system has not refreshed its list of event sources, and you attempt to write an event with the new source, the write operation will fail.</span></span> <span data-ttu-id="6be2f-1486">你可以配置新的源使用<xref:System.Diagnostics.EventLogInstaller>，或使用<xref:System.Diagnostics.EventLog.CreateEventSource%2A>方法。</span><span class="sxs-lookup"><span data-stu-id="6be2f-1486">You can configure a new source using an <xref:System.Diagnostics.EventLogInstaller>, or using the <xref:System.Diagnostics.EventLog.CreateEventSource%2A> method.</span></span> <span data-ttu-id="6be2f-1487">若要创建新的事件源的计算机上，必须具有管理权限。</span><span class="sxs-lookup"><span data-stu-id="6be2f-1487">You must have administrative rights on the computer to create a new event source.</span></span>  
  
 <span data-ttu-id="6be2f-1488">要写入本地化的项还是要直接写入字符串，则必须配置源。</span><span class="sxs-lookup"><span data-stu-id="6be2f-1488">The source must be configured either for writing localized entries or for writing direct strings.</span></span> <span data-ttu-id="6be2f-1489"><xref:System.Diagnostics.EventLog.WriteEntry%2A>方法直接写入事件日志将写入给定的字符串; 它不使用可本地化的消息资源文件。</span><span class="sxs-lookup"><span data-stu-id="6be2f-1489">The <xref:System.Diagnostics.EventLog.WriteEntry%2A> method writes the given string directly to the event log; it does not use a localizable message resource file.</span></span> <span data-ttu-id="6be2f-1490">使用<xref:System.Diagnostics.EventLog.WriteEvent%2A>方法来写入事件时使用本地化的消息资源文件。</span><span class="sxs-lookup"><span data-stu-id="6be2f-1490">Use the <xref:System.Diagnostics.EventLog.WriteEvent%2A> method to write events using a localized message resource file.</span></span>  
  
 <span data-ttu-id="6be2f-1491">如果你的应用程序将使用资源标识符和字符串值的条目，则必须注册两个单独的源。</span><span class="sxs-lookup"><span data-stu-id="6be2f-1491">If your application writes entries using both resource identifiers and string values, you must register two separate sources.</span></span> <span data-ttu-id="6be2f-1492">例如，使用资源文件，配置一个源，然后使用在该源<xref:System.Diagnostics.EventLog.WriteEvent%2A>方法来编写使用到事件日志的资源标识符的条目。</span><span class="sxs-lookup"><span data-stu-id="6be2f-1492">For example, configure one source with resource files, and then use that source in the <xref:System.Diagnostics.EventLog.WriteEvent%2A> method to write entries using resource identifiers to the event log.</span></span> <span data-ttu-id="6be2f-1493">然后创建不同的源，而无需资源文件，并使用在该源<xref:System.Diagnostics.EventLog.WriteEntry%2A>方法使用该源的事件日志中直接写入字符串。</span><span class="sxs-lookup"><span data-stu-id="6be2f-1493">Then create a different source without resource files, and use that source in the <xref:System.Diagnostics.EventLog.WriteEntry%2A> method to write strings directly to the event log using that source.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="6be2f-1494">如果`message`参数包含 NUL 字符，则在 NUL 字符处终止事件日志的消息中。</span><span class="sxs-lookup"><span data-stu-id="6be2f-1494">If the `message` parameter contains a NUL character, the message in the event log is terminated at the NUL character.</span></span>  
>   
>  <span data-ttu-id="6be2f-1495">`message`字符串不能包含 %*n*，其中*n*是整数值 (例如，%1)，因为事件查看器会将其视为插入字符串。</span><span class="sxs-lookup"><span data-stu-id="6be2f-1495">The `message` string cannot contain %*n*, where *n* is an integer value (for example, %1), because the event viewer treats it as an insertion string.</span></span> <span data-ttu-id="6be2f-1496">Internet 协议版本 6 (IPv6) 地址只能包含此字符序列，因为无法记录事件消息包含 IPv6 地址。</span><span class="sxs-lookup"><span data-stu-id="6be2f-1496">Because an Internet Protocol, version 6 (IPv6) address can contain this character sequence, you cannot log an event message that contains an IPv6 address.</span></span>  
  
   
  
## Examples  
 [!code-cpp[EventLog_WriteEntry_1_3#2](~/samples/snippets/cpp/VS_Snippets_CLR/EventLog_WriteEntry_1_3/CPP/eventlog_writeentry_1_3.cpp#2)]
 [!code-csharp[EventLog_WriteEntry_1_3#2](~/samples/snippets/csharp/VS_Snippets_CLR/EventLog_WriteEntry_1_3/CS/eventlog_writeentry_1_3.cs#2)]
 [!code-vb[EventLog_WriteEntry_1_3#2](~/samples/snippets/visualbasic/VS_Snippets_CLR/EventLog_WriteEntry_1_3/VB/eventlog_writeentry_1_3.vb#2)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentException"><span data-ttu-id="6be2f-1497"><paramref name="source" /> 值是空字符串 ("")。</span><span class="sxs-lookup"><span data-stu-id="6be2f-1497">The <paramref name="source" /> value is an empty string ("").</span></span>  
  
 <span data-ttu-id="6be2f-1498">\- 或 -</span><span class="sxs-lookup"><span data-stu-id="6be2f-1498">\- or -</span></span>  
  
 <span data-ttu-id="6be2f-1499"><paramref name="source" /> 值为 <see langword="null" />。</span><span class="sxs-lookup"><span data-stu-id="6be2f-1499">The <paramref name="source" /> value is <see langword="null" />.</span></span>  
  
 <span data-ttu-id="6be2f-1500">\- 或 -</span><span class="sxs-lookup"><span data-stu-id="6be2f-1500">\- or -</span></span>  
  
 <span data-ttu-id="6be2f-1501"><paramref name="eventID" /> 小于零或大于 <see cref="F:System.UInt16.MaxValue" />。</span><span class="sxs-lookup"><span data-stu-id="6be2f-1501"><paramref name="eventID" /> is less than zero or greater than <see cref="F:System.UInt16.MaxValue" />.</span></span>  
  
 <span data-ttu-id="6be2f-1502">\- 或 -</span><span class="sxs-lookup"><span data-stu-id="6be2f-1502">\- or -</span></span>  
  
 <span data-ttu-id="6be2f-1503">消息字符串长于 31,839 字节（在 Windows Vista 之前，在 Windows 操作系统上为 32,766 字节)。</span><span class="sxs-lookup"><span data-stu-id="6be2f-1503">The message string is longer than 31,839 bytes (32,766 bytes on Windows operating systems before Windows Vista).</span></span>  
  
 <span data-ttu-id="6be2f-1504">\- 或 -</span><span class="sxs-lookup"><span data-stu-id="6be2f-1504">\- or -</span></span>  
  
 <span data-ttu-id="6be2f-1505">此源名称导致注册表项路径的长度超过 254 个字符。</span><span class="sxs-lookup"><span data-stu-id="6be2f-1505">The source name results in a registry key path longer than 254 characters.</span></span></exception>
        <exception cref="T:System.ComponentModel.InvalidEnumArgumentException">
          <span data-ttu-id="6be2f-1506"><paramref name="type" /> 不是有效的 <see cref="T:System.Diagnostics.EventLogEntryType" />。</span><span class="sxs-lookup"><span data-stu-id="6be2f-1506"><paramref name="type" /> is not a valid <see cref="T:System.Diagnostics.EventLogEntryType" />.</span></span></exception>
        <exception cref="T:System.InvalidOperationException"><span data-ttu-id="6be2f-1507">事件日志的注册表项未能打开。</span><span class="sxs-lookup"><span data-stu-id="6be2f-1507">The registry key for the event log could not be opened.</span></span></exception>
        <exception cref="T:System.ComponentModel.Win32Exception"><span data-ttu-id="6be2f-1508">将事件项写入事件日志时，操作系统报告了一个错误。</span><span class="sxs-lookup"><span data-stu-id="6be2f-1508">The operating system reported an error when writing the event entry to the event log.</span></span> <span data-ttu-id="6be2f-1509">一个 Windows 错误代码不可用。</span><span class="sxs-lookup"><span data-stu-id="6be2f-1509">A Windows error code is not available.</span></span></exception>
        <permission cref="T:System.Diagnostics.EventLogPermission"><span data-ttu-id="6be2f-1510">用于写入的计算机上的事件日志信息。</span><span class="sxs-lookup"><span data-stu-id="6be2f-1510">for writing the event log information on the computer.</span></span> <span data-ttu-id="6be2f-1511">关联的枚举： <see cref="F:System.Diagnostics.EventLogPermissionAccess.Write" /></span><span class="sxs-lookup"><span data-stu-id="6be2f-1511">Associated enumeration: <see cref="F:System.Diagnostics.EventLogPermissionAccess.Write" /></span></span></permission>
        <altmember cref="T:System.Diagnostics.EventLogEntryType" />
        <altmember cref="P:System.Diagnostics.EventLog.Source" />
        <altmember cref="Overload:System.Diagnostics.EventLog.CreateEventSource" />
        <altmember cref="M:System.Diagnostics.EventLog.DeleteEventSource(System.String)" />
        <altmember cref="M:System.Diagnostics.EventLog.SourceExists(System.String)" />
        <altmember cref="P:System.Diagnostics.EventLog.Entries" />
      </Docs>
    </Member>
    <MemberGroup MemberName="WriteEvent">
      <AssemblyInfo>
        <AssemblyName>System</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Docs>
        <summary><span data-ttu-id="6be2f-1512">向事件日志写入本地化事件项。</span><span class="sxs-lookup"><span data-stu-id="6be2f-1512">Writes a localized event entry to the event log.</span></span></summary>
      </Docs>
    </MemberGroup>
    <Member MemberName="WriteEvent">
      <MemberSignature Language="C#" Value="public void WriteEvent (System.Diagnostics.EventInstance instance, params object[] values);" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig instance void WriteEvent(class System.Diagnostics.EventInstance instance, object[] values) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Diagnostics.EventLog.WriteEvent(System.Diagnostics.EventInstance,System.Object[])" />
      <MemberSignature Language="VB.NET" Value="Public Sub WriteEvent (instance As EventInstance, ParamArray values As Object())" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; void WriteEvent(System::Diagnostics::EventInstance ^ instance, ... cli::array &lt;System::Object ^&gt; ^ values);" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Attributes>
        <Attribute>
          <AttributeName>System.Runtime.InteropServices.ComVisible(false)</AttributeName>
        </Attribute>
      </Attributes>
      <ReturnValue>
        <ReturnType>System.Void</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="instance" Type="System.Diagnostics.EventInstance" />
        <Parameter Name="values" Type="System.Object[]">
          <Attributes>
            <Attribute>
              <AttributeName>System.ParamArray</AttributeName>
            </Attribute>
          </Attributes>
        </Parameter>
      </Parameters>
      <Docs>
        <param name="instance"><span data-ttu-id="6be2f-1513">表示本地化事件日志项的 <see cref="T:System.Diagnostics.EventInstance" /> 实例。</span><span class="sxs-lookup"><span data-stu-id="6be2f-1513">An <see cref="T:System.Diagnostics.EventInstance" /> instance that represents a localized event log entry.</span></span></param>
        <param name="values"><span data-ttu-id="6be2f-1514">要合并到事件日志项的消息文本中的字符串数组。</span><span class="sxs-lookup"><span data-stu-id="6be2f-1514">An array of strings to merge into the message text of the event log entry.</span></span></param>
        <summary><span data-ttu-id="6be2f-1515">向事件日志写入本地化项。</span><span class="sxs-lookup"><span data-stu-id="6be2f-1515">Writes a localized entry to the event log.</span></span></summary>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="6be2f-1516">使用此方法写入事件日志写入本地化的项。</span><span class="sxs-lookup"><span data-stu-id="6be2f-1516">Use this method to write a localized entry to the event log.</span></span> <span data-ttu-id="6be2f-1517">使用资源标识符，而不是字符串值中指定的事件属性。</span><span class="sxs-lookup"><span data-stu-id="6be2f-1517">You specify the event properties with resource identifiers rather than string values.</span></span> <span data-ttu-id="6be2f-1518">事件查看器使用的资源标识符来显示的本地化的资源文件中的相应字符串<xref:System.Diagnostics.EventLog.Source%2A>。</span><span class="sxs-lookup"><span data-stu-id="6be2f-1518">The Event Viewer uses the resource identifiers to display the corresponding strings from the localized resource file for the <xref:System.Diagnostics.EventLog.Source%2A>.</span></span> <span data-ttu-id="6be2f-1519">需要在编写使用资源标识符的事件前，必须将源注册相应的资源文件。</span><span class="sxs-lookup"><span data-stu-id="6be2f-1519">You must register the source with the corresponding resource file before you write events using resource identifiers.</span></span>  
  
 <span data-ttu-id="6be2f-1520">输入`instance`实例指定的事件消息和属性。</span><span class="sxs-lookup"><span data-stu-id="6be2f-1520">The input `instance` instance specifies the event message and properties.</span></span> <span data-ttu-id="6be2f-1521">设置<xref:System.Diagnostics.EventInstance.InstanceId%2A>的`instance`输入源消息资源文件中定义的消息。</span><span class="sxs-lookup"><span data-stu-id="6be2f-1521">Set the <xref:System.Diagnostics.EventInstance.InstanceId%2A> of the `instance` input for the defined message in the source message resource file.</span></span> <span data-ttu-id="6be2f-1522">你可以选择性地设置<xref:System.Diagnostics.EventInstance.CategoryId%2A>和<xref:System.Diagnostics.EventInstance.EntryType%2A>的`instance`输入事件项的类别和事件类型定义。</span><span class="sxs-lookup"><span data-stu-id="6be2f-1522">You can optionally set the <xref:System.Diagnostics.EventInstance.CategoryId%2A> and <xref:System.Diagnostics.EventInstance.EntryType%2A> of the `instance` input to define the category and event type of your event entry.</span></span> <span data-ttu-id="6be2f-1523">你还可以指定要插入本地化的消息文本的独立于语言的字符串的数组。</span><span class="sxs-lookup"><span data-stu-id="6be2f-1523">You can also specify an array of language-independent strings to insert into the localized message text.</span></span> <span data-ttu-id="6be2f-1524">设置`values`到`null`如果事件消息不包含替换字符串的格式设置占位符。</span><span class="sxs-lookup"><span data-stu-id="6be2f-1524">Set `values` to `null` if the event message does not contain formatting placeholders for replacement strings.</span></span>  
  
 <span data-ttu-id="6be2f-1525">必须设置<xref:System.Diagnostics.EventLog.Source%2A>属性你<xref:System.Diagnostics.EventLog>组件之前使用<xref:System.Diagnostics.EventLog.WriteEvent%2A>。</span><span class="sxs-lookup"><span data-stu-id="6be2f-1525">You must set the <xref:System.Diagnostics.EventLog.Source%2A> property on your <xref:System.Diagnostics.EventLog> component before using <xref:System.Diagnostics.EventLog.WriteEvent%2A>.</span></span> <span data-ttu-id="6be2f-1526">指定的源必须配置用于本地化的项写入事件日志中。源至少必须具有一个用于定义消息资源文件。</span><span class="sxs-lookup"><span data-stu-id="6be2f-1526">The specified source must be configured for writing localized entries to the log; the source must at minimum have a message resource file defined.</span></span>  
  
 <span data-ttu-id="6be2f-1527">你必须创建并在编写与源的第一个条目之前，配置事件源。</span><span class="sxs-lookup"><span data-stu-id="6be2f-1527">You must create and configure the event source before writing the first entry with the source.</span></span> <span data-ttu-id="6be2f-1528">在你的应用程序的安装过程中创建新的事件源。</span><span class="sxs-lookup"><span data-stu-id="6be2f-1528">Create the new event source during the installation of your application.</span></span> <span data-ttu-id="6be2f-1529">这样，可以为操作系统来刷新其已注册的事件源的列表和其配置的时间。</span><span class="sxs-lookup"><span data-stu-id="6be2f-1529">This allows time for the operating system to refresh its list of registered event sources and their configuration.</span></span> <span data-ttu-id="6be2f-1530">如果操作系统未刷新其事件源的列表，并尝试写入新的源的事件写入操作将失败。</span><span class="sxs-lookup"><span data-stu-id="6be2f-1530">If the operating system has not refreshed its list of event sources, and you attempt to write an event with the new source, the write operation will fail.</span></span> <span data-ttu-id="6be2f-1531">你可以配置新的源使用<xref:System.Diagnostics.EventLogInstaller>，或使用<xref:System.Diagnostics.EventLog.CreateEventSource%2A>方法。</span><span class="sxs-lookup"><span data-stu-id="6be2f-1531">You can configure a new source using an <xref:System.Diagnostics.EventLogInstaller>, or using the <xref:System.Diagnostics.EventLog.CreateEventSource%2A> method.</span></span> <span data-ttu-id="6be2f-1532">若要创建新的事件源的计算机上，必须具有管理权限。</span><span class="sxs-lookup"><span data-stu-id="6be2f-1532">You must have administrative rights on the computer to create a new event source.</span></span>  
  
 <span data-ttu-id="6be2f-1533">要写入本地化的项还是要直接写入字符串，则必须配置源。</span><span class="sxs-lookup"><span data-stu-id="6be2f-1533">The source must be configured either for writing localized entries or for writing direct strings.</span></span> <span data-ttu-id="6be2f-1534">使用<xref:System.Diagnostics.EventLog.WriteEntry%2A>方法如果你的应用程序将直接写入事件日志的字符串值。</span><span class="sxs-lookup"><span data-stu-id="6be2f-1534">Use the <xref:System.Diagnostics.EventLog.WriteEntry%2A> method if your application writes string values directly to the event log.</span></span>  
  
 <span data-ttu-id="6be2f-1535">如果你的应用程序将使用资源标识符和字符串值的条目，则必须注册两个单独的源。</span><span class="sxs-lookup"><span data-stu-id="6be2f-1535">If your application writes entries using both resource identifiers and string values, you must register two separate sources.</span></span> <span data-ttu-id="6be2f-1536">例如，使用资源文件，配置一个源，然后使用在该源<xref:System.Diagnostics.EventLog.WriteEvent%2A>方法来编写使用到事件日志的资源标识符的条目。</span><span class="sxs-lookup"><span data-stu-id="6be2f-1536">For example, configure one source with resource files, and then use that source in the <xref:System.Diagnostics.EventLog.WriteEvent%2A> method to write entries using resource identifiers to the event log.</span></span> <span data-ttu-id="6be2f-1537">然后创建不同的源，而无需资源文件，并使用在该源<xref:System.Diagnostics.EventLog.WriteEntry%2A>方法使用该源的事件日志中直接写入字符串。</span><span class="sxs-lookup"><span data-stu-id="6be2f-1537">Then create a different source without resource files, and use that source in the <xref:System.Diagnostics.EventLog.WriteEntry%2A> method to write strings directly to the event log using that source.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="6be2f-1538">如果你向远程计算机的值写入条目`message`字符串可能不是你所预期如果远程计算机未在运行.NET Framework。</span><span class="sxs-lookup"><span data-stu-id="6be2f-1538">If you write an entry to a remote computer, the value of the `message` string might not be what you expect if the remote computer is not running the .NET Framework.</span></span> <span data-ttu-id="6be2f-1539">此外，`message`字符串不能包含 %*n*，其中*n*是整数值 (例如，%1)，因为事件查看器会将其视为插入字符串。</span><span class="sxs-lookup"><span data-stu-id="6be2f-1539">Also, the `message` string cannot contain %*n*, where *n* is an integer value (for example, %1), because the event viewer treats it as an insertion string.</span></span> <span data-ttu-id="6be2f-1540">Internet 协议版本 6 (IPv6) 地址只能包含此字符序列，因为无法记录事件消息包含 IPv6 地址。</span><span class="sxs-lookup"><span data-stu-id="6be2f-1540">Because an Internet Protocol, version 6 (IPv6) address can contain this character sequence, you cannot log an event message that contains an IPv6 address.</span></span>  
  
   
  
## Examples  
 <span data-ttu-id="6be2f-1541">下面的示例将两个审核项写入事件日志`myNewLog`。</span><span class="sxs-lookup"><span data-stu-id="6be2f-1541">The following example writes two audit entries to the event log `myNewLog`.</span></span> <span data-ttu-id="6be2f-1542">该示例创建一个新的事件源和新的事件日志，如果它们尚不存在本地计算机上。</span><span class="sxs-lookup"><span data-stu-id="6be2f-1542">The example creates a new event source and a new event log if they do not exist on the local computer.</span></span> <span data-ttu-id="6be2f-1543">事件消息文本被指定的资源文件中使用的资源标识符。</span><span class="sxs-lookup"><span data-stu-id="6be2f-1543">The event message text is specified using a resource identifier in a resource file.</span></span>  
  
 [!code-cpp[EventLog_WriteEvent#7](~/samples/snippets/cpp/VS_Snippets_CLR/eventlog_WriteEvent/CPP/source.cpp#7)]
 [!code-csharp[EventLog_WriteEvent#7](~/samples/snippets/csharp/VS_Snippets_CLR/eventlog_WriteEvent/CS/source.cs#7)]
 [!code-vb[EventLog_WriteEvent#7](~/samples/snippets/visualbasic/VS_Snippets_CLR/eventlog_WriteEvent/VB/source.vb#7)]  
  
 <span data-ttu-id="6be2f-1544">该示例使用以下的消息文本文件，内置于 EventLogMsgs.dll 的资源库。</span><span class="sxs-lookup"><span data-stu-id="6be2f-1544">The example uses the following message text file, built into the resource library EventLogMsgs.dll.</span></span> <span data-ttu-id="6be2f-1545">消息文本文件是从其创建的消息资源文件的源。</span><span class="sxs-lookup"><span data-stu-id="6be2f-1545">A message text file is the source from which the message resource file is created.</span></span> <span data-ttu-id="6be2f-1546">消息文本文件定义的资源标识符和类别、 事件消息和参数插入字符串的文本。</span><span class="sxs-lookup"><span data-stu-id="6be2f-1546">The message text file defines the resource identifiers and text for the category, event message, and parameter insertion strings.</span></span>  
  
```  
; // EventLogMsgs.mc  
; // ********************************************************  
  
; // Use the following commands to build this file:  
  
; //   mc -s EventLogMsgs.mc  
; //   rc EventLogMsgs.rc  
; //   link /DLL /SUBSYSTEM:WINDOWS /NOENTRY /MACHINE:x86 EventLogMsgs.Res   
; // ********************************************************  
  
; // - Event categories -  
; // Categories must be numbered consecutively starting at 1.  
; // ********************************************************  
  
MessageId=0x1  
Severity=Success  
SymbolicName=INSTALL_CATEGORY  
Language=English  
Installation  
.  
  
MessageId=0x2  
Severity=Success  
SymbolicName=QUERY_CATEGORY  
Language=English  
Database Query  
.  
  
MessageId=0x3  
Severity=Success  
SymbolicName=REFRESH_CATEGORY  
Language=English  
Data Refresh  
.  
  
; // - Event messages -  
; // *********************************  
  
MessageId = 1000  
Severity = Success  
Facility = Application  
SymbolicName = AUDIT_SUCCESS_MESSAGE_ID_1000  
Language=English  
My application message text, in English, for message id 1000, called from %1.  
.  
  
MessageId = 1001  
Severity = Warning  
Facility = Application  
SymbolicName = AUDIT_FAILED_MESSAGE_ID_1001  
Language=English  
My application message text, in English, for message id 1001, called from %1.  
.  
  
MessageId = 1002  
Severity = Success  
Facility = Application  
SymbolicName = GENERIC_INFO_MESSAGE_ID_1002  
Language=English  
My generic information message in English, for message id 1002.  
.  
  
MessageId = 1003  
Severity = Warning  
Facility = Application  
SymbolicName = GENERIC_WARNING_MESSAGE_ID_1003  
Language=English  
My generic warning message in English, for message id 1003, called from %1.  
.  
  
MessageId = 1004  
Severity = Success  
Facility = Application  
SymbolicName = UPDATE_CYCLE_COMPLETE_MESSAGE_ID_1004  
Language=English  
The update cycle is complete for %%5002.  
.  
  
MessageId = 1005  
Severity = Warning  
Facility = Application  
SymbolicName = SERVER_CONNECTION_DOWN_MESSAGE_ID_1005  
Language=English  
The refresh operation did not complete because the connection to server %1 could not be established.  
.  
  
; // - Event log display name -  
; // ********************************************************  
  
MessageId = 5001  
Severity = Success  
Facility = Application  
SymbolicName = EVENT_LOG_DISPLAY_NAME_MSGID  
Language=English  
Sample Event Log  
.  
  
; // - Event message parameters -  
; //   Language independent insertion strings  
; // ********************************************************  
  
MessageId = 5002  
Severity = Success  
Facility = Application  
SymbolicName = EVENT_LOG_SERVICE_NAME_MSGID  
Language=English  
SVC_UPDATE.EXE  
.  
```  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentException"><span data-ttu-id="6be2f-1547"><see cref="P:System.Diagnostics.EventLog.Source" /> 的 <see cref="T:System.Diagnostics.EventLog" /> 属性尚未设置。</span><span class="sxs-lookup"><span data-stu-id="6be2f-1547">The <see cref="P:System.Diagnostics.EventLog.Source" /> property of the <see cref="T:System.Diagnostics.EventLog" /> has not been set.</span></span>  
  
 <span data-ttu-id="6be2f-1548">或</span><span class="sxs-lookup"><span data-stu-id="6be2f-1548">-or-</span></span>  
  
 <span data-ttu-id="6be2f-1549">该方法尝试注册新的事件源，但 <see cref="P:System.Diagnostics.EventLog.MachineName" /> 中的计算机名称无效。</span><span class="sxs-lookup"><span data-stu-id="6be2f-1549">The method attempted to register a new event source, but the computer name in <see cref="P:System.Diagnostics.EventLog.MachineName" /> is not valid.</span></span>  
  
 <span data-ttu-id="6be2f-1550">\- 或 -</span><span class="sxs-lookup"><span data-stu-id="6be2f-1550">\- or -</span></span>  
  
 <span data-ttu-id="6be2f-1551">已为其他事件日志注册了该源。</span><span class="sxs-lookup"><span data-stu-id="6be2f-1551">The source is already registered for a different event log.</span></span>  
  
 <span data-ttu-id="6be2f-1552">\- 或 -</span><span class="sxs-lookup"><span data-stu-id="6be2f-1552">\- or -</span></span>  
  
 <span data-ttu-id="6be2f-1553"><paramref name="instance.InstanceId" /> 小于零或大于 <see cref="F:System.UInt16.MaxValue" />。</span><span class="sxs-lookup"><span data-stu-id="6be2f-1553"><paramref name="instance.InstanceId" /> is less than zero or greater than <see cref="F:System.UInt16.MaxValue" />.</span></span>  
  
 <span data-ttu-id="6be2f-1554">\- 或 -</span><span class="sxs-lookup"><span data-stu-id="6be2f-1554">\- or -</span></span>  
  
 <span data-ttu-id="6be2f-1555"><paramref name="values" /> 超过了 256 个元素。</span><span class="sxs-lookup"><span data-stu-id="6be2f-1555"><paramref name="values" /> has more than 256 elements.</span></span>  
  
 <span data-ttu-id="6be2f-1556">\- 或 -</span><span class="sxs-lookup"><span data-stu-id="6be2f-1556">\- or -</span></span>  
  
 <span data-ttu-id="6be2f-1557"><paramref name="values" /> 元素中有一个超过了 32766 个字节。</span><span class="sxs-lookup"><span data-stu-id="6be2f-1557">One of the <paramref name="values" /> elements is longer than 32766 bytes.</span></span>  
  
 <span data-ttu-id="6be2f-1558">\- 或 -</span><span class="sxs-lookup"><span data-stu-id="6be2f-1558">\- or -</span></span>  
  
 <span data-ttu-id="6be2f-1559">此源名称导致注册表项路径的长度超过 254 个字符。</span><span class="sxs-lookup"><span data-stu-id="6be2f-1559">The source name results in a registry key path longer than 254 characters.</span></span></exception>
        <exception cref="T:System.ArgumentNullException">
          <span data-ttu-id="6be2f-1560"><paramref name="instance" /> 为 <see langword="null" />。</span><span class="sxs-lookup"><span data-stu-id="6be2f-1560"><paramref name="instance" /> is <see langword="null" />.</span></span></exception>
        <exception cref="T:System.InvalidOperationException"><span data-ttu-id="6be2f-1561">事件日志的注册表项未能打开。</span><span class="sxs-lookup"><span data-stu-id="6be2f-1561">The registry key for the event log could not be opened.</span></span></exception>
        <exception cref="T:System.ComponentModel.Win32Exception"><span data-ttu-id="6be2f-1562">将事件项写入事件日志时，操作系统报告了一个错误。</span><span class="sxs-lookup"><span data-stu-id="6be2f-1562">The operating system reported an error when writing the event entry to the event log.</span></span> <span data-ttu-id="6be2f-1563">一个 Windows 错误代码不可用。</span><span class="sxs-lookup"><span data-stu-id="6be2f-1563">A Windows error code is not available.</span></span></exception>
        <permission cref="T:System.Diagnostics.EventLogPermission"><span data-ttu-id="6be2f-1564">用于写入的计算机上的事件日志信息。</span><span class="sxs-lookup"><span data-stu-id="6be2f-1564">for writing the event log information on the computer.</span></span> <span data-ttu-id="6be2f-1565">关联的枚举： <see cref="F:System.Diagnostics.EventLogPermissionAccess.Write" /></span><span class="sxs-lookup"><span data-stu-id="6be2f-1565">Associated enumeration: <see cref="F:System.Diagnostics.EventLogPermissionAccess.Write" /></span></span></permission>
        <altmember cref="Overload:System.Diagnostics.EventLog.CreateEventSource" />
        <altmember cref="P:System.Diagnostics.EventLog.Source" />
        <altmember cref="P:System.Diagnostics.EventLog.Entries" />
        <altmember cref="T:System.Diagnostics.EventInstance" />
      </Docs>
    </Member>
    <Member MemberName="WriteEvent">
      <MemberSignature Language="C#" Value="public void WriteEvent (System.Diagnostics.EventInstance instance, byte[] data, params object[] values);" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig instance void WriteEvent(class System.Diagnostics.EventInstance instance, unsigned int8[] data, object[] values) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Diagnostics.EventLog.WriteEvent(System.Diagnostics.EventInstance,System.Byte[],System.Object[])" />
      <MemberSignature Language="VB.NET" Value="Public Sub WriteEvent (instance As EventInstance, data As Byte(), ParamArray values As Object())" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; void WriteEvent(System::Diagnostics::EventInstance ^ instance, cli::array &lt;System::Byte&gt; ^ data, ... cli::array &lt;System::Object ^&gt; ^ values);" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Attributes>
        <Attribute>
          <AttributeName>System.Runtime.InteropServices.ComVisible(false)</AttributeName>
        </Attribute>
      </Attributes>
      <ReturnValue>
        <ReturnType>System.Void</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="instance" Type="System.Diagnostics.EventInstance" />
        <Parameter Name="data" Type="System.Byte[]" />
        <Parameter Name="values" Type="System.Object[]">
          <Attributes>
            <Attribute>
              <AttributeName>System.ParamArray</AttributeName>
            </Attribute>
          </Attributes>
        </Parameter>
      </Parameters>
      <Docs>
        <param name="instance"><span data-ttu-id="6be2f-1566">表示本地化事件日志项的 <see cref="T:System.Diagnostics.EventInstance" /> 实例。</span><span class="sxs-lookup"><span data-stu-id="6be2f-1566">An <see cref="T:System.Diagnostics.EventInstance" /> instance that represents a localized event log entry.</span></span></param>
        <param name="data"><span data-ttu-id="6be2f-1567">包含与此项关联的二进制数据的字节数组。</span><span class="sxs-lookup"><span data-stu-id="6be2f-1567">An array of bytes that holds the binary data associated with the entry.</span></span></param>
        <param name="values"><span data-ttu-id="6be2f-1568">要合并到事件日志项的消息文本中的字符串数组。</span><span class="sxs-lookup"><span data-stu-id="6be2f-1568">An array of strings to merge into the message text of the event log entry.</span></span></param>
        <summary><span data-ttu-id="6be2f-1569">写入包含给定的事件数据、消息替换字符串和关联的二进制数据的事件日志项。</span><span class="sxs-lookup"><span data-stu-id="6be2f-1569">Writes an event log entry with the given event data, message replacement strings, and associated binary data.</span></span></summary>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="6be2f-1570">使用此方法要使用其他特定于事件的数据的本地化的项写入事件日志。</span><span class="sxs-lookup"><span data-stu-id="6be2f-1570">Use this method to write a localized entry with additional event-specific data to the event log.</span></span> <span data-ttu-id="6be2f-1571">使用资源标识符，而不是字符串值中指定的事件属性。</span><span class="sxs-lookup"><span data-stu-id="6be2f-1571">You specify the event properties with resource identifiers rather than string values.</span></span> <span data-ttu-id="6be2f-1572">事件查看器使用的资源标识符来显示的本地化的资源文件中的相应字符串<xref:System.Diagnostics.EventLog.Source%2A>。</span><span class="sxs-lookup"><span data-stu-id="6be2f-1572">The Event Viewer uses the resource identifiers to display the corresponding strings from the localized resource file for the <xref:System.Diagnostics.EventLog.Source%2A>.</span></span> <span data-ttu-id="6be2f-1573">需要在编写使用资源标识符的事件前，必须将源注册相应的资源文件。</span><span class="sxs-lookup"><span data-stu-id="6be2f-1573">You must register the source with the corresponding resource file before you write events using resource identifiers.</span></span>  
  
 <span data-ttu-id="6be2f-1574">输入`instance`实例指定的事件消息和属性。</span><span class="sxs-lookup"><span data-stu-id="6be2f-1574">The input `instance` instance specifies the event message and properties.</span></span> <span data-ttu-id="6be2f-1575">设置<xref:System.Diagnostics.EventInstance.InstanceId%2A>的`instance`输入源消息资源文件中定义的消息。</span><span class="sxs-lookup"><span data-stu-id="6be2f-1575">Set the <xref:System.Diagnostics.EventInstance.InstanceId%2A> of the `instance` input for the defined message in the source message resource file.</span></span> <span data-ttu-id="6be2f-1576">你可以选择性地设置<xref:System.Diagnostics.EventInstance.CategoryId%2A>和<xref:System.Diagnostics.EventInstance.EntryType%2A>的`instance`输入事件项的类别和事件类型定义。</span><span class="sxs-lookup"><span data-stu-id="6be2f-1576">You can optionally set the <xref:System.Diagnostics.EventInstance.CategoryId%2A> and <xref:System.Diagnostics.EventInstance.EntryType%2A> of the `instance` input to define the category and event type of your event entry.</span></span> <span data-ttu-id="6be2f-1577">你还可以指定要插入本地化的消息文本的独立于语言的字符串的数组。</span><span class="sxs-lookup"><span data-stu-id="6be2f-1577">You can also specify an array of language-independent strings to insert into the localized message text.</span></span> <span data-ttu-id="6be2f-1578">设置`values`到`null`如果事件消息不包含替换字符串的格式设置占位符。</span><span class="sxs-lookup"><span data-stu-id="6be2f-1578">Set `values` to `null` if the event message does not contain formatting placeholders for replacement strings.</span></span>  
  
 <span data-ttu-id="6be2f-1579">指定与事件时为事件提供更多详细信息所需的二进制数据。</span><span class="sxs-lookup"><span data-stu-id="6be2f-1579">Specify binary data with an event when it is necessary to provide additional details for the event.</span></span> <span data-ttu-id="6be2f-1580">例如，使用`data`参数，以包括有关特定错误的信息。</span><span class="sxs-lookup"><span data-stu-id="6be2f-1580">For example, use the `data` parameter to include information on a specific error.</span></span> <span data-ttu-id="6be2f-1581">事件查看器不解释关联的事件数据中;它采用组合的十六进制转义序列和文本格式显示的数据。</span><span class="sxs-lookup"><span data-stu-id="6be2f-1581">The Event Viewer does not interpret the associated event data; it displays the data in a combined hexadecimal and text format.</span></span> <span data-ttu-id="6be2f-1582">应谨慎; 使用特定于事件的数据仅当你确信它将会很有用，则将其包含。</span><span class="sxs-lookup"><span data-stu-id="6be2f-1582">Use event-specific data sparingly; include it only if you are sure it will be useful.</span></span> <span data-ttu-id="6be2f-1583">特定于事件的数据还可用于存储应用程序可以处理独立于事件查看器的信息。</span><span class="sxs-lookup"><span data-stu-id="6be2f-1583">You can also use event-specific data to store information the application can process independently of the Event Viewer.</span></span> <span data-ttu-id="6be2f-1584">例如，你无法专门为事件，编写一个查看器或编写扫描事件日志，并创建报告，包括来自特定事件的数据的信息的程序。</span><span class="sxs-lookup"><span data-stu-id="6be2f-1584">For example, you could write a viewer specifically for your events, or write a program that scans the event log and creates reports that include information from the event-specific data.</span></span>  
  
 <span data-ttu-id="6be2f-1585">必须设置<xref:System.Diagnostics.EventLog.Source%2A>属性你<xref:System.Diagnostics.EventLog>组件之前使用组件之前<xref:System.Diagnostics.EventLog.WriteEvent%2A>。</span><span class="sxs-lookup"><span data-stu-id="6be2f-1585">You must set the <xref:System.Diagnostics.EventLog.Source%2A> property on your <xref:System.Diagnostics.EventLog> component before component before using <xref:System.Diagnostics.EventLog.WriteEvent%2A>.</span></span> <span data-ttu-id="6be2f-1586">指定的源必须配置用于本地化的项写入事件日志中。源至少必须具有一个用于定义消息资源文件。</span><span class="sxs-lookup"><span data-stu-id="6be2f-1586">The specified source must be configured for writing localized entries to the log; the source must at minimum have a message resource file defined.</span></span>  
  
 <span data-ttu-id="6be2f-1587">你必须创建并在编写与源的第一个条目之前，配置事件源。</span><span class="sxs-lookup"><span data-stu-id="6be2f-1587">You must create and configure the event source before writing the first entry with the source.</span></span> <span data-ttu-id="6be2f-1588">在你的应用程序的安装过程中创建新的事件源。</span><span class="sxs-lookup"><span data-stu-id="6be2f-1588">Create the new event source during the installation of your application.</span></span> <span data-ttu-id="6be2f-1589">这样，可以为操作系统来刷新其已注册的事件源的列表和其配置的时间。</span><span class="sxs-lookup"><span data-stu-id="6be2f-1589">This allows time for the operating system to refresh its list of registered event sources and their configuration.</span></span> <span data-ttu-id="6be2f-1590">如果操作系统未刷新其事件源的列表，并尝试写入新的源的事件写入操作将失败。</span><span class="sxs-lookup"><span data-stu-id="6be2f-1590">If the operating system has not refreshed its list of event sources, and you attempt to write an event with the new source, the write operation will fail.</span></span> <span data-ttu-id="6be2f-1591">你可以配置新的源使用<xref:System.Diagnostics.EventLogInstaller>，或使用<xref:System.Diagnostics.EventLog.CreateEventSource%2A>方法。</span><span class="sxs-lookup"><span data-stu-id="6be2f-1591">You can configure a new source using an <xref:System.Diagnostics.EventLogInstaller>, or using the <xref:System.Diagnostics.EventLog.CreateEventSource%2A> method.</span></span> <span data-ttu-id="6be2f-1592">若要创建新的事件源的计算机上，必须具有管理权限。</span><span class="sxs-lookup"><span data-stu-id="6be2f-1592">You must have administrative rights on the computer to create a new event source.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="6be2f-1593">如果不指定<xref:System.Diagnostics.EventLog.MachineName%2A>为你<xref:System.Diagnostics.EventLog>实例然后才能调用<xref:System.Diagnostics.EventLog.WriteEvent%2A>，本地计算机 ("。") 假定。</span><span class="sxs-lookup"><span data-stu-id="6be2f-1593">If you do not specify a <xref:System.Diagnostics.EventLog.MachineName%2A> for your <xref:System.Diagnostics.EventLog> instance before you call <xref:System.Diagnostics.EventLog.WriteEvent%2A>, the local computer (".") is assumed.</span></span>  
  
 <span data-ttu-id="6be2f-1594">要写入本地化的项还是要直接写入字符串，则必须配置源。</span><span class="sxs-lookup"><span data-stu-id="6be2f-1594">The source must be configured either for writing localized entries or for writing direct strings.</span></span> <span data-ttu-id="6be2f-1595">使用<xref:System.Diagnostics.EventLog.WriteEntry%2A>方法如果你的应用程序将直接写入事件日志的字符串值。</span><span class="sxs-lookup"><span data-stu-id="6be2f-1595">Use the <xref:System.Diagnostics.EventLog.WriteEntry%2A> method if your application writes string values directly to the event log.</span></span>  
  
 <span data-ttu-id="6be2f-1596">如果你的应用程序将使用资源标识符和字符串值的条目，则必须注册两个单独的源。</span><span class="sxs-lookup"><span data-stu-id="6be2f-1596">If your application writes entries using both resource identifiers and string values, you must register two separate sources.</span></span> <span data-ttu-id="6be2f-1597">例如，使用资源文件，配置一个源，然后使用在该源<xref:System.Diagnostics.EventLog.WriteEvent%2A>方法来编写使用到事件日志的资源标识符的条目。</span><span class="sxs-lookup"><span data-stu-id="6be2f-1597">For example, configure one source with resource files, and then use that source in the <xref:System.Diagnostics.EventLog.WriteEvent%2A> method to write entries using resource identifiers to the event log.</span></span> <span data-ttu-id="6be2f-1598">然后创建不同的源，而无需资源文件，并使用在该源<xref:System.Diagnostics.EventLog.WriteEntry%2A>方法使用该源的事件日志中直接写入字符串。</span><span class="sxs-lookup"><span data-stu-id="6be2f-1598">Then create a different source without resource files, and use that source in the <xref:System.Diagnostics.EventLog.WriteEntry%2A> method to write strings directly to the event log using that source.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="6be2f-1599">如果你向远程计算机的值写入条目`message`字符串可能不是你所预期如果远程计算机未在运行.NET Framework。</span><span class="sxs-lookup"><span data-stu-id="6be2f-1599">If you write an entry to a remote computer, the value of the `message` string might not be what you expect if the remote computer is not running the .NET Framework.</span></span> <span data-ttu-id="6be2f-1600">此外，`message`字符串不能包含 %*n*，其中*n*是整数值 (例如，%1)，因为事件查看器会将其视为插入字符串。</span><span class="sxs-lookup"><span data-stu-id="6be2f-1600">Also, the `message` string cannot contain %*n*, where *n* is an integer value (for example, %1), because the event viewer treats it as an insertion string.</span></span> <span data-ttu-id="6be2f-1601">Internet 协议版本 6 (IPv6) 地址只能包含此字符序列，因为无法记录事件消息包含 IPv6 地址。</span><span class="sxs-lookup"><span data-stu-id="6be2f-1601">Because an Internet Protocol, version 6 (IPv6) address can contain this character sequence, you cannot log an event message that contains an IPv6 address.</span></span>  
  
   
  
## Examples  
 <span data-ttu-id="6be2f-1602">下面的示例将两个审核项写入事件日志`myNewLog`。</span><span class="sxs-lookup"><span data-stu-id="6be2f-1602">The following example writes two audit entries to the event log `myNewLog`.</span></span> <span data-ttu-id="6be2f-1603">该示例创建一个新的事件源和新的事件日志，如果它们尚不存在本地计算机上。</span><span class="sxs-lookup"><span data-stu-id="6be2f-1603">The example creates a new event source and a new event log if they do not exist on the local computer.</span></span> <span data-ttu-id="6be2f-1604">事件消息文本被指定的资源文件中使用的资源标识符。</span><span class="sxs-lookup"><span data-stu-id="6be2f-1604">The event message text is specified using a resource identifier in a resource file.</span></span>  
  
 [!code-cpp[EventLog_WriteEvent#7](~/samples/snippets/cpp/VS_Snippets_CLR/eventlog_WriteEvent/CPP/source.cpp#7)]
 [!code-csharp[EventLog_WriteEvent#7](~/samples/snippets/csharp/VS_Snippets_CLR/eventlog_WriteEvent/CS/source.cs#7)]
 [!code-vb[EventLog_WriteEvent#7](~/samples/snippets/visualbasic/VS_Snippets_CLR/eventlog_WriteEvent/VB/source.vb#7)]  
  
 <span data-ttu-id="6be2f-1605">该示例使用以下的消息文本文件，内置于 EventLogMsgs.dll 的资源库。</span><span class="sxs-lookup"><span data-stu-id="6be2f-1605">The example uses the following message text file, built into the resource library EventLogMsgs.dll.</span></span> <span data-ttu-id="6be2f-1606">消息文本文件是从其创建的消息资源文件的源。</span><span class="sxs-lookup"><span data-stu-id="6be2f-1606">A message text file is the source from which the message resource file is created.</span></span> <span data-ttu-id="6be2f-1607">消息文本文件定义的资源标识符和类别、 事件消息和参数插入字符串的文本。</span><span class="sxs-lookup"><span data-stu-id="6be2f-1607">The message text file defines the resource identifiers and text for the category, event message, and parameter insertion strings.</span></span>  
  
```  
; // EventLogMsgs.mc  
; // ********************************************************  
  
; // Use the following commands to build this file:  
  
; //   mc -s EventLogMsgs.mc  
; //   rc EventLogMsgs.rc  
; //   link /DLL /SUBSYSTEM:WINDOWS /NOENTRY /MACHINE:x86 EventLogMsgs.Res   
; // ********************************************************  
  
; // - Event categories -  
; // Categories must be numbered consecutively starting at 1.  
; // ********************************************************  
  
MessageId=0x1  
Severity=Success  
SymbolicName=INSTALL_CATEGORY  
Language=English  
Installation  
.  
  
MessageId=0x2  
Severity=Success  
SymbolicName=QUERY_CATEGORY  
Language=English  
Database Query  
.  
  
MessageId=0x3  
Severity=Success  
SymbolicName=REFRESH_CATEGORY  
Language=English  
Data Refresh  
.  
  
; // - Event messages -  
; // *********************************  
  
MessageId = 1000  
Severity = Success  
Facility = Application  
SymbolicName = AUDIT_SUCCESS_MESSAGE_ID_1000  
Language=English  
My application message text, in English, for message id 1000, called from %1.  
.  
  
MessageId = 1001  
Severity = Warning  
Facility = Application  
SymbolicName = AUDIT_FAILED_MESSAGE_ID_1001  
Language=English  
My application message text, in English, for message id 1001, called from %1.  
.  
  
MessageId = 1002  
Severity = Success  
Facility = Application  
SymbolicName = GENERIC_INFO_MESSAGE_ID_1002  
Language=English  
My generic information message in English, for message id 1002.  
.  
  
MessageId = 1003  
Severity = Warning  
Facility = Application  
SymbolicName = GENERIC_WARNING_MESSAGE_ID_1003  
Language=English  
My generic warning message in English, for message id 1003, called from %1.  
.  
  
MessageId = 1004  
Severity = Success  
Facility = Application  
SymbolicName = UPDATE_CYCLE_COMPLETE_MESSAGE_ID_1004  
Language=English  
The update cycle is complete for %%5002.  
.  
  
MessageId = 1005  
Severity = Warning  
Facility = Application  
SymbolicName = SERVER_CONNECTION_DOWN_MESSAGE_ID_1005  
Language=English  
The refresh operation did not complete because the connection to server %1 could not be established.  
.  
  
; // - Event log display name -  
; // ********************************************************  
  
MessageId = 5001  
Severity = Success  
Facility = Application  
SymbolicName = EVENT_LOG_DISPLAY_NAME_MSGID  
Language=English  
Sample Event Log  
.  
  
; // - Event message parameters -  
; //   Language independent insertion strings  
; // ********************************************************  
  
MessageId = 5002  
Severity = Success  
Facility = Application  
SymbolicName = EVENT_LOG_SERVICE_NAME_MSGID  
Language=English  
SVC_UPDATE.EXE  
.  
```  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentException"><span data-ttu-id="6be2f-1608"><see cref="P:System.Diagnostics.EventLog.Source" /> 的 <see cref="T:System.Diagnostics.EventLog" /> 属性尚未设置。</span><span class="sxs-lookup"><span data-stu-id="6be2f-1608">The <see cref="P:System.Diagnostics.EventLog.Source" /> property of the <see cref="T:System.Diagnostics.EventLog" /> has not been set.</span></span>  
  
 <span data-ttu-id="6be2f-1609">或</span><span class="sxs-lookup"><span data-stu-id="6be2f-1609">-or-</span></span>  
  
 <span data-ttu-id="6be2f-1610">该方法尝试注册新的事件源，但 <see cref="P:System.Diagnostics.EventLog.MachineName" /> 中的计算机名称无效。</span><span class="sxs-lookup"><span data-stu-id="6be2f-1610">The method attempted to register a new event source, but the computer name in <see cref="P:System.Diagnostics.EventLog.MachineName" /> is not valid.</span></span>  
  
 <span data-ttu-id="6be2f-1611">\- 或 -</span><span class="sxs-lookup"><span data-stu-id="6be2f-1611">\- or -</span></span>  
  
 <span data-ttu-id="6be2f-1612">已为其他事件日志注册了该源。</span><span class="sxs-lookup"><span data-stu-id="6be2f-1612">The source is already registered for a different event log.</span></span>  
  
 <span data-ttu-id="6be2f-1613">\- 或 -</span><span class="sxs-lookup"><span data-stu-id="6be2f-1613">\- or -</span></span>  
  
 <span data-ttu-id="6be2f-1614"><paramref name="instance.InstanceId" /> 小于零或大于 <see cref="F:System.UInt16.MaxValue" />。</span><span class="sxs-lookup"><span data-stu-id="6be2f-1614"><paramref name="instance.InstanceId" /> is less than zero or greater than <see cref="F:System.UInt16.MaxValue" />.</span></span>  
  
 <span data-ttu-id="6be2f-1615">\- 或 -</span><span class="sxs-lookup"><span data-stu-id="6be2f-1615">\- or -</span></span>  
  
 <span data-ttu-id="6be2f-1616"><paramref name="values" /> 超过了 256 个元素。</span><span class="sxs-lookup"><span data-stu-id="6be2f-1616"><paramref name="values" /> has more than 256 elements.</span></span>  
  
 <span data-ttu-id="6be2f-1617">\- 或 -</span><span class="sxs-lookup"><span data-stu-id="6be2f-1617">\- or -</span></span>  
  
 <span data-ttu-id="6be2f-1618"><paramref name="values" /> 元素中有一个超过了 32766 个字节。</span><span class="sxs-lookup"><span data-stu-id="6be2f-1618">One of the <paramref name="values" /> elements is longer than 32766 bytes.</span></span>  
  
 <span data-ttu-id="6be2f-1619">\- 或 -</span><span class="sxs-lookup"><span data-stu-id="6be2f-1619">\- or -</span></span>  
  
 <span data-ttu-id="6be2f-1620">此源名称导致注册表项路径的长度超过 254 个字符。</span><span class="sxs-lookup"><span data-stu-id="6be2f-1620">The source name results in a registry key path longer than 254 characters.</span></span></exception>
        <exception cref="T:System.ArgumentNullException">
          <span data-ttu-id="6be2f-1621"><paramref name="instance" /> 为 <see langword="null" />。</span><span class="sxs-lookup"><span data-stu-id="6be2f-1621"><paramref name="instance" /> is <see langword="null" />.</span></span></exception>
        <exception cref="T:System.InvalidOperationException"><span data-ttu-id="6be2f-1622">事件日志的注册表项未能打开。</span><span class="sxs-lookup"><span data-stu-id="6be2f-1622">The registry key for the event log could not be opened.</span></span></exception>
        <exception cref="T:System.ComponentModel.Win32Exception"><span data-ttu-id="6be2f-1623">将事件项写入事件日志时，操作系统报告了一个错误。</span><span class="sxs-lookup"><span data-stu-id="6be2f-1623">The operating system reported an error when writing the event entry to the event log.</span></span> <span data-ttu-id="6be2f-1624">一个 Windows 错误代码不可用。</span><span class="sxs-lookup"><span data-stu-id="6be2f-1624">A Windows error code is not available.</span></span></exception>
        <permission cref="T:System.Diagnostics.EventLogPermission"><span data-ttu-id="6be2f-1625">用于写入的计算机上的事件日志信息。</span><span class="sxs-lookup"><span data-stu-id="6be2f-1625">for writing the event log information on the computer.</span></span> <span data-ttu-id="6be2f-1626">关联的枚举： <see cref="F:System.Diagnostics.EventLogPermissionAccess.Write" /></span><span class="sxs-lookup"><span data-stu-id="6be2f-1626">Associated enumeration: <see cref="F:System.Diagnostics.EventLogPermissionAccess.Write" /></span></span></permission>
        <altmember cref="Overload:System.Diagnostics.EventLog.CreateEventSource" />
        <altmember cref="P:System.Diagnostics.EventLog.Source" />
        <altmember cref="P:System.Diagnostics.EventLog.Entries" />
        <altmember cref="T:System.Diagnostics.EventInstance" />
      </Docs>
    </Member>
    <Member MemberName="WriteEvent">
      <MemberSignature Language="C#" Value="public static void WriteEvent (string source, System.Diagnostics.EventInstance instance, params object[] values);" />
      <MemberSignature Language="ILAsm" Value=".method public static hidebysig void WriteEvent(string source, class System.Diagnostics.EventInstance instance, object[] values) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Diagnostics.EventLog.WriteEvent(System.String,System.Diagnostics.EventInstance,System.Object[])" />
      <MemberSignature Language="VB.NET" Value="Public Shared Sub WriteEvent (source As String, instance As EventInstance, ParamArray values As Object())" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; static void WriteEvent(System::String ^ source, System::Diagnostics::EventInstance ^ instance, ... cli::array &lt;System::Object ^&gt; ^ values);" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Void</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="source" Type="System.String" />
        <Parameter Name="instance" Type="System.Diagnostics.EventInstance" />
        <Parameter Name="values" Type="System.Object[]">
          <Attributes>
            <Attribute>
              <AttributeName>System.ParamArray</AttributeName>
            </Attribute>
          </Attributes>
        </Parameter>
      </Parameters>
      <Docs>
        <param name="source"><span data-ttu-id="6be2f-1627">在指定的计算机上为应用程序注册的事件源的名称。</span><span class="sxs-lookup"><span data-stu-id="6be2f-1627">The name of the event source registered for the application on the specified computer.</span></span></param>
        <param name="instance"><span data-ttu-id="6be2f-1628">表示本地化事件日志项的 <see cref="T:System.Diagnostics.EventInstance" /> 实例。</span><span class="sxs-lookup"><span data-stu-id="6be2f-1628">An <see cref="T:System.Diagnostics.EventInstance" /> instance that represents a localized event log entry.</span></span></param>
        <param name="values"><span data-ttu-id="6be2f-1629">要合并到事件日志项的消息文本中的字符串数组。</span><span class="sxs-lookup"><span data-stu-id="6be2f-1629">An array of strings to merge into the message text of the event log entry.</span></span></param>
        <summary><span data-ttu-id="6be2f-1630">使用指定的已注册事件源写入包含给定事件数据和消息替换字符串的事件日志项。</span><span class="sxs-lookup"><span data-stu-id="6be2f-1630">Writes an event log entry with the given event data and message replacement strings, using the specified registered event source.</span></span></summary>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="6be2f-1631">使用此方法使用已注册为相应的日志的事件源的源的事件日志写入本地化的项。</span><span class="sxs-lookup"><span data-stu-id="6be2f-1631">Use this method to write a localized entry to the event log, using a source already registered as an event source for the appropriate log.</span></span> <span data-ttu-id="6be2f-1632">使用资源标识符，而不是字符串值中指定的事件属性。</span><span class="sxs-lookup"><span data-stu-id="6be2f-1632">You specify the event properties with resource identifiers rather than string values.</span></span> <span data-ttu-id="6be2f-1633">事件查看器使用的资源标识符来显示源的本地化的资源文件中的相应字符串。</span><span class="sxs-lookup"><span data-stu-id="6be2f-1633">The Event Viewer uses the resource identifiers to display the corresponding strings from the localized resource file for the source.</span></span> <span data-ttu-id="6be2f-1634">需要在编写使用资源标识符的事件前，必须将源注册相应的资源文件。</span><span class="sxs-lookup"><span data-stu-id="6be2f-1634">You must register the source with the corresponding resource file before you write events using resource identifiers.</span></span>  
  
 <span data-ttu-id="6be2f-1635">输入`instance`实例指定的事件消息和属性。</span><span class="sxs-lookup"><span data-stu-id="6be2f-1635">The input `instance` instance specifies the event message and properties.</span></span> <span data-ttu-id="6be2f-1636">设置<xref:System.Diagnostics.EventInstance.InstanceId%2A>的`instance`输入源消息资源文件中定义的消息。</span><span class="sxs-lookup"><span data-stu-id="6be2f-1636">Set the <xref:System.Diagnostics.EventInstance.InstanceId%2A> of the `instance` input for the defined message in the source message resource file.</span></span> <span data-ttu-id="6be2f-1637">你可以选择性地设置<xref:System.Diagnostics.EventInstance.CategoryId%2A>和<xref:System.Diagnostics.EventInstance.EntryType%2A>的`instance`输入事件项的类别和事件类型定义。</span><span class="sxs-lookup"><span data-stu-id="6be2f-1637">You can optionally set the <xref:System.Diagnostics.EventInstance.CategoryId%2A> and <xref:System.Diagnostics.EventInstance.EntryType%2A> of the `instance` input to define the category and event type of your event entry.</span></span> <span data-ttu-id="6be2f-1638">你还可以指定要插入本地化的消息文本的独立于语言的字符串的数组。</span><span class="sxs-lookup"><span data-stu-id="6be2f-1638">You can also specify an array of language-independent strings to insert into the localized message text.</span></span> <span data-ttu-id="6be2f-1639">设置`values`到`null`如果事件消息不包含替换字符串的格式设置占位符。</span><span class="sxs-lookup"><span data-stu-id="6be2f-1639">Set `values` to `null` if the event message does not contain formatting placeholders for replacement strings.</span></span>  
  
 <span data-ttu-id="6be2f-1640">指定的源之前，必须注册为事件日志使用<xref:System.Diagnostics.EventLog.WriteEvent%2A>。</span><span class="sxs-lookup"><span data-stu-id="6be2f-1640">The specified source must be registered for an event log before using <xref:System.Diagnostics.EventLog.WriteEvent%2A>.</span></span> <span data-ttu-id="6be2f-1641">指定的源必须配置用于本地化的项写入事件日志中。源至少必须具有一个用于定义消息资源文件。</span><span class="sxs-lookup"><span data-stu-id="6be2f-1641">The specified source must be configured for writing localized entries to the log; the source must at minimum have a message resource file defined.</span></span>  
  
 <span data-ttu-id="6be2f-1642">你必须创建并在编写与源的第一个条目之前，配置事件源。</span><span class="sxs-lookup"><span data-stu-id="6be2f-1642">You must create and configure the event source before writing the first entry with the source.</span></span> <span data-ttu-id="6be2f-1643">在你的应用程序的安装过程中创建新的事件源。</span><span class="sxs-lookup"><span data-stu-id="6be2f-1643">Create the new event source during the installation of your application.</span></span> <span data-ttu-id="6be2f-1644">这样，可以为操作系统来刷新其已注册的事件源的列表和其配置的时间。</span><span class="sxs-lookup"><span data-stu-id="6be2f-1644">This allows time for the operating system to refresh its list of registered event sources and their configuration.</span></span> <span data-ttu-id="6be2f-1645">如果操作系统未刷新其事件源的列表，并尝试写入新的源的事件写入操作将失败。</span><span class="sxs-lookup"><span data-stu-id="6be2f-1645">If the operating system has not refreshed its list of event sources, and you attempt to write an event with the new source, the write operation will fail.</span></span> <span data-ttu-id="6be2f-1646">你可以配置新的源使用<xref:System.Diagnostics.EventLogInstaller>，或使用<xref:System.Diagnostics.EventLog.CreateEventSource%2A>方法。</span><span class="sxs-lookup"><span data-stu-id="6be2f-1646">You can configure a new source using an <xref:System.Diagnostics.EventLogInstaller>, or using the <xref:System.Diagnostics.EventLog.CreateEventSource%2A> method.</span></span> <span data-ttu-id="6be2f-1647">若要创建新的事件源的计算机上，必须具有管理权限。</span><span class="sxs-lookup"><span data-stu-id="6be2f-1647">You must have administrative rights on the computer to create a new event source.</span></span>  
  
 <span data-ttu-id="6be2f-1648">要写入本地化的项还是要直接写入字符串，则必须配置源。</span><span class="sxs-lookup"><span data-stu-id="6be2f-1648">The source must be configured either for writing localized entries or for writing direct strings.</span></span> <span data-ttu-id="6be2f-1649">使用<xref:System.Diagnostics.EventLog.WriteEntry%2A>方法如果你的应用程序将直接写入事件日志的字符串值。</span><span class="sxs-lookup"><span data-stu-id="6be2f-1649">Use the <xref:System.Diagnostics.EventLog.WriteEntry%2A> method if your application writes string values directly to the event log.</span></span>  
  
 <span data-ttu-id="6be2f-1650">如果你的应用程序将使用资源标识符和字符串值的条目，则必须注册两个单独的源。</span><span class="sxs-lookup"><span data-stu-id="6be2f-1650">If your application writes entries using both resource identifiers and string values, you must register two separate sources.</span></span> <span data-ttu-id="6be2f-1651">例如，使用资源文件，配置一个源，然后使用在该源<xref:System.Diagnostics.EventLog.WriteEvent%2A>方法来编写使用到事件日志的资源标识符的条目。</span><span class="sxs-lookup"><span data-stu-id="6be2f-1651">For example, configure one source with resource files, and then use that source in the <xref:System.Diagnostics.EventLog.WriteEvent%2A> method to write entries using resource identifiers to the event log.</span></span> <span data-ttu-id="6be2f-1652">然后创建不同的源，而无需资源文件，并使用在该源<xref:System.Diagnostics.EventLog.WriteEntry%2A>方法使用该源的事件日志中直接写入字符串。</span><span class="sxs-lookup"><span data-stu-id="6be2f-1652">Then create a different source without resource files, and use that source in the <xref:System.Diagnostics.EventLog.WriteEntry%2A> method to write strings directly to the event log using that source.</span></span>  
  
   
  
## Examples  
 <span data-ttu-id="6be2f-1653">下面的示例将现有的事件日志写入信息性事件条目和警告事件项。</span><span class="sxs-lookup"><span data-stu-id="6be2f-1653">The following example writes an informational event entry and a warning event entry to an existing event log.</span></span> <span data-ttu-id="6be2f-1654">事件消息文本被指定的资源文件中使用的资源标识符。</span><span class="sxs-lookup"><span data-stu-id="6be2f-1654">The event message text is specified using a resource identifier in a resource file.</span></span> <span data-ttu-id="6be2f-1655">该示例假定已为该源中注册相应的资源文件。</span><span class="sxs-lookup"><span data-stu-id="6be2f-1655">The example assumes the corresponding resource file has been registered for the source.</span></span>  
  
 [!code-cpp[EventLog_WriteEvent#8](~/samples/snippets/cpp/VS_Snippets_CLR/eventlog_WriteEvent/CPP/source.cpp#8)]
 [!code-csharp[EventLog_WriteEvent#8](~/samples/snippets/csharp/VS_Snippets_CLR/eventlog_WriteEvent/CS/source.cs#8)]
 [!code-vb[EventLog_WriteEvent#8](~/samples/snippets/visualbasic/VS_Snippets_CLR/eventlog_WriteEvent/VB/source.vb#8)]  
  
 <span data-ttu-id="6be2f-1656">该示例使用以下的消息文本文件，内置于 EventLogMsgs.dll 的资源库。</span><span class="sxs-lookup"><span data-stu-id="6be2f-1656">The example uses the following message text file, built into the resource library EventLogMsgs.dll.</span></span> <span data-ttu-id="6be2f-1657">消息文本文件是从其创建的消息资源文件的源。</span><span class="sxs-lookup"><span data-stu-id="6be2f-1657">A message text file is the source from which the message resource file is created.</span></span> <span data-ttu-id="6be2f-1658">消息文本文件定义的资源标识符和类别、 事件消息和参数插入字符串的文本。</span><span class="sxs-lookup"><span data-stu-id="6be2f-1658">The message text file defines the resource identifiers and text for the category, event message, and parameter insertion strings.</span></span>  
  
```  
; // EventLogMsgs.mc  
; // ********************************************************  
  
; // Use the following commands to build this file:  
  
; //   mc -s EventLogMsgs.mc  
; //   rc EventLogMsgs.rc  
; //   link /DLL /SUBSYSTEM:WINDOWS /NOENTRY /MACHINE:x86 EventLogMsgs.Res   
; // ********************************************************  
  
; // - Event categories -  
; // Categories must be numbered consecutively starting at 1.  
; // ********************************************************  
  
MessageId=0x1  
Severity=Success  
SymbolicName=INSTALL_CATEGORY  
Language=English  
Installation  
.  
  
MessageId=0x2  
Severity=Success  
SymbolicName=QUERY_CATEGORY  
Language=English  
Database Query  
.  
  
MessageId=0x3  
Severity=Success  
SymbolicName=REFRESH_CATEGORY  
Language=English  
Data Refresh  
.  
  
; // - Event messages -  
; // *********************************  
  
MessageId = 1000  
Severity = Success  
Facility = Application  
SymbolicName = AUDIT_SUCCESS_MESSAGE_ID_1000  
Language=English  
My application message text, in English, for message id 1000, called from %1.  
.  
  
MessageId = 1001  
Severity = Warning  
Facility = Application  
SymbolicName = AUDIT_FAILED_MESSAGE_ID_1001  
Language=English  
My application message text, in English, for message id 1001, called from %1.  
.  
  
MessageId = 1002  
Severity = Success  
Facility = Application  
SymbolicName = GENERIC_INFO_MESSAGE_ID_1002  
Language=English  
My generic information message in English, for message id 1002.  
.  
  
MessageId = 1003  
Severity = Warning  
Facility = Application  
SymbolicName = GENERIC_WARNING_MESSAGE_ID_1003  
Language=English  
My generic warning message in English, for message id 1003, called from %1.  
.  
  
MessageId = 1004  
Severity = Success  
Facility = Application  
SymbolicName = UPDATE_CYCLE_COMPLETE_MESSAGE_ID_1004  
Language=English  
The update cycle is complete for %%5002.  
.  
  
MessageId = 1005  
Severity = Warning  
Facility = Application  
SymbolicName = SERVER_CONNECTION_DOWN_MESSAGE_ID_1005  
Language=English  
The refresh operation did not complete because the connection to server %1 could not be established.  
.  
  
; // - Event log display name -  
; // ********************************************************  
  
MessageId = 5001  
Severity = Success  
Facility = Application  
SymbolicName = EVENT_LOG_DISPLAY_NAME_MSGID  
Language=English  
Sample Event Log  
.  
  
; // - Event message parameters -  
; //   Language independent insertion strings  
; // ********************************************************  
  
MessageId = 5002  
Severity = Success  
Facility = Application  
SymbolicName = EVENT_LOG_SERVICE_NAME_MSGID  
Language=English  
SVC_UPDATE.EXE  
.  
```  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentException"><span data-ttu-id="6be2f-1659"><paramref name="source" /> 值是空字符串 ("")。</span><span class="sxs-lookup"><span data-stu-id="6be2f-1659">The <paramref name="source" /> value is an empty string ("").</span></span>  
  
 <span data-ttu-id="6be2f-1660">\- 或 -</span><span class="sxs-lookup"><span data-stu-id="6be2f-1660">\- or -</span></span>  
  
 <span data-ttu-id="6be2f-1661"><paramref name="source" /> 值为 <see langword="null" />。</span><span class="sxs-lookup"><span data-stu-id="6be2f-1661">The <paramref name="source" /> value is <see langword="null" />.</span></span>  
  
 <span data-ttu-id="6be2f-1662">\- 或 -</span><span class="sxs-lookup"><span data-stu-id="6be2f-1662">\- or -</span></span>  
  
 <span data-ttu-id="6be2f-1663"><paramref name="instance.InstanceId" /> 小于零或大于 <see cref="F:System.UInt16.MaxValue" />。</span><span class="sxs-lookup"><span data-stu-id="6be2f-1663"><paramref name="instance.InstanceId" /> is less than zero or greater than <see cref="F:System.UInt16.MaxValue" />.</span></span>  
  
 <span data-ttu-id="6be2f-1664">\- 或 -</span><span class="sxs-lookup"><span data-stu-id="6be2f-1664">\- or -</span></span>  
  
 <span data-ttu-id="6be2f-1665"><paramref name="values" /> 超过了 256 个元素。</span><span class="sxs-lookup"><span data-stu-id="6be2f-1665"><paramref name="values" /> has more than 256 elements.</span></span>  
  
 <span data-ttu-id="6be2f-1666">\- 或 -</span><span class="sxs-lookup"><span data-stu-id="6be2f-1666">\- or -</span></span>  
  
 <span data-ttu-id="6be2f-1667"><paramref name="values" /> 元素中有一个超过了 32766 个字节。</span><span class="sxs-lookup"><span data-stu-id="6be2f-1667">One of the <paramref name="values" /> elements is longer than 32766 bytes.</span></span>  
  
 <span data-ttu-id="6be2f-1668">\- 或 -</span><span class="sxs-lookup"><span data-stu-id="6be2f-1668">\- or -</span></span>  
  
 <span data-ttu-id="6be2f-1669">此源名称导致注册表项路径的长度超过 254 个字符。</span><span class="sxs-lookup"><span data-stu-id="6be2f-1669">The source name results in a registry key path longer than 254 characters.</span></span></exception>
        <exception cref="T:System.ArgumentNullException">
          <span data-ttu-id="6be2f-1670"><paramref name="instance" /> 为 <see langword="null" />。</span><span class="sxs-lookup"><span data-stu-id="6be2f-1670"><paramref name="instance" /> is <see langword="null" />.</span></span></exception>
        <exception cref="T:System.InvalidOperationException"><span data-ttu-id="6be2f-1671">事件日志的注册表项未能打开。</span><span class="sxs-lookup"><span data-stu-id="6be2f-1671">The registry key for the event log could not be opened.</span></span></exception>
        <exception cref="T:System.ComponentModel.Win32Exception"><span data-ttu-id="6be2f-1672">将事件项写入事件日志时，操作系统报告了一个错误。</span><span class="sxs-lookup"><span data-stu-id="6be2f-1672">The operating system reported an error when writing the event entry to the event log.</span></span> <span data-ttu-id="6be2f-1673">一个 Windows 错误代码不可用。</span><span class="sxs-lookup"><span data-stu-id="6be2f-1673">A Windows error code is not available.</span></span></exception>
        <permission cref="T:System.Diagnostics.EventLogPermission"><span data-ttu-id="6be2f-1674">用于写入的计算机上的事件日志信息。</span><span class="sxs-lookup"><span data-stu-id="6be2f-1674">for writing the event log information on the computer.</span></span> <span data-ttu-id="6be2f-1675">关联的枚举： <see cref="F:System.Diagnostics.EventLogPermissionAccess.Write" /></span><span class="sxs-lookup"><span data-stu-id="6be2f-1675">Associated enumeration: <see cref="F:System.Diagnostics.EventLogPermissionAccess.Write" /></span></span></permission>
        <altmember cref="Overload:System.Diagnostics.EventLog.CreateEventSource" />
        <altmember cref="P:System.Diagnostics.EventLog.Source" />
        <altmember cref="P:System.Diagnostics.EventLog.Entries" />
        <altmember cref="T:System.Diagnostics.EventInstance" />
      </Docs>
    </Member>
    <Member MemberName="WriteEvent">
      <MemberSignature Language="C#" Value="public static void WriteEvent (string source, System.Diagnostics.EventInstance instance, byte[] data, params object[] values);" />
      <MemberSignature Language="ILAsm" Value=".method public static hidebysig void WriteEvent(string source, class System.Diagnostics.EventInstance instance, unsigned int8[] data, object[] values) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Diagnostics.EventLog.WriteEvent(System.String,System.Diagnostics.EventInstance,System.Byte[],System.Object[])" />
      <MemberSignature Language="VB.NET" Value="Public Shared Sub WriteEvent (source As String, instance As EventInstance, data As Byte(), ParamArray values As Object())" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; static void WriteEvent(System::String ^ source, System::Diagnostics::EventInstance ^ instance, cli::array &lt;System::Byte&gt; ^ data, ... cli::array &lt;System::Object ^&gt; ^ values);" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Void</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="source" Type="System.String" />
        <Parameter Name="instance" Type="System.Diagnostics.EventInstance" />
        <Parameter Name="data" Type="System.Byte[]" />
        <Parameter Name="values" Type="System.Object[]">
          <Attributes>
            <Attribute>
              <AttributeName>System.ParamArray</AttributeName>
            </Attribute>
          </Attributes>
        </Parameter>
      </Parameters>
      <Docs>
        <param name="source"><span data-ttu-id="6be2f-1676">在指定的计算机上为应用程序注册的事件源的名称。</span><span class="sxs-lookup"><span data-stu-id="6be2f-1676">The name of the event source registered for the application on the specified computer.</span></span></param>
        <param name="instance"><span data-ttu-id="6be2f-1677">表示本地化事件日志项的 <see cref="T:System.Diagnostics.EventInstance" /> 实例。</span><span class="sxs-lookup"><span data-stu-id="6be2f-1677">An <see cref="T:System.Diagnostics.EventInstance" /> instance that represents a localized event log entry.</span></span></param>
        <param name="data"><span data-ttu-id="6be2f-1678">包含与此项关联的二进制数据的字节数组。</span><span class="sxs-lookup"><span data-stu-id="6be2f-1678">An array of bytes that holds the binary data associated with the entry.</span></span></param>
        <param name="values"><span data-ttu-id="6be2f-1679">要合并到事件日志项的消息文本中的字符串数组。</span><span class="sxs-lookup"><span data-stu-id="6be2f-1679">An array of strings to merge into the message text of the event log entry.</span></span></param>
        <summary><span data-ttu-id="6be2f-1680">使用指定的已注册事件源，写入包含给定的事件数据、消息替换字符串和关联的二进制数据的事件日志项。</span><span class="sxs-lookup"><span data-stu-id="6be2f-1680">Writes an event log entry with the given event data, message replacement strings, and associated binary data, and using the specified registered event source.</span></span></summary>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="6be2f-1681">使用此方法更多特定于事件的数据的本地化的项写入事件日志中，使用已注册为相应的日志的事件源的源。</span><span class="sxs-lookup"><span data-stu-id="6be2f-1681">Use this method to write a localized entry with additional event-specific data to the event log, using a source already registered as an event source for the appropriate log.</span></span> <span data-ttu-id="6be2f-1682">使用资源标识符，而不是字符串值中指定的事件属性。</span><span class="sxs-lookup"><span data-stu-id="6be2f-1682">You specify the event properties with resource identifiers rather than string values.</span></span> <span data-ttu-id="6be2f-1683">事件查看器使用的资源标识符来显示源的本地化的资源文件中的相应字符串。</span><span class="sxs-lookup"><span data-stu-id="6be2f-1683">The Event Viewer uses the resource identifiers to display the corresponding strings from the localized resource file for the source.</span></span> <span data-ttu-id="6be2f-1684">需要在编写使用资源标识符的事件前，必须将源注册相应的资源文件。</span><span class="sxs-lookup"><span data-stu-id="6be2f-1684">You must register the source with the corresponding resource file before you write events using resource identifiers.</span></span>  
  
 <span data-ttu-id="6be2f-1685">输入`instance`实例指定的事件消息和属性。</span><span class="sxs-lookup"><span data-stu-id="6be2f-1685">The input `instance` instance specifies the event message and properties.</span></span> <span data-ttu-id="6be2f-1686">设置<xref:System.Diagnostics.EventInstance.InstanceId%2A>的`instance`输入源消息资源文件中定义的消息。</span><span class="sxs-lookup"><span data-stu-id="6be2f-1686">Set the <xref:System.Diagnostics.EventInstance.InstanceId%2A> of the `instance` input for the defined message in the source message resource file.</span></span> <span data-ttu-id="6be2f-1687">你可以选择性地设置<xref:System.Diagnostics.EventInstance.CategoryId%2A>和<xref:System.Diagnostics.EventInstance.EntryType%2A>的`instance`输入事件项的类别和事件类型定义。</span><span class="sxs-lookup"><span data-stu-id="6be2f-1687">You can optionally set the <xref:System.Diagnostics.EventInstance.CategoryId%2A> and <xref:System.Diagnostics.EventInstance.EntryType%2A> of the `instance` input to define the category and event type of your event entry.</span></span> <span data-ttu-id="6be2f-1688">你还可以指定要插入本地化的消息文本的独立于语言的字符串的数组。</span><span class="sxs-lookup"><span data-stu-id="6be2f-1688">You can also specify an array of language-independent strings to insert into the localized message text.</span></span> <span data-ttu-id="6be2f-1689">设置`values`到`null`如果事件消息不包含替换字符串的格式设置占位符。</span><span class="sxs-lookup"><span data-stu-id="6be2f-1689">Set `values` to `null` if the event message does not contain formatting placeholders for replacement strings.</span></span>  
  
 <span data-ttu-id="6be2f-1690">指定与事件时为事件提供更多详细信息所需的二进制数据。</span><span class="sxs-lookup"><span data-stu-id="6be2f-1690">Specify binary data with an event when it is necessary to provide additional details for the event.</span></span> <span data-ttu-id="6be2f-1691">例如，使用`data`参数，以包括有关特定错误的信息。</span><span class="sxs-lookup"><span data-stu-id="6be2f-1691">For example, use the `data` parameter to include information on a specific error.</span></span> <span data-ttu-id="6be2f-1692">事件查看器不解释关联的事件数据中;它采用组合的十六进制转义序列和文本格式显示的数据。</span><span class="sxs-lookup"><span data-stu-id="6be2f-1692">The Event Viewer does not interpret the associated event data; it displays the data in a combined hexadecimal and text format.</span></span> <span data-ttu-id="6be2f-1693">应谨慎; 使用特定于事件的数据仅当你确信它将会很有用，则将其包含。</span><span class="sxs-lookup"><span data-stu-id="6be2f-1693">Use event-specific data sparingly; include it only if you are sure it will be useful.</span></span> <span data-ttu-id="6be2f-1694">特定于事件的数据还可用于存储应用程序可以处理独立于事件查看器的信息。</span><span class="sxs-lookup"><span data-stu-id="6be2f-1694">You can also use event-specific data to store information the application can process independently of the Event Viewer.</span></span> <span data-ttu-id="6be2f-1695">例如，你无法专门为事件，编写一个查看器或编写扫描事件日志，并创建报告，包括来自特定事件的数据的信息的程序。</span><span class="sxs-lookup"><span data-stu-id="6be2f-1695">For example, you could write a viewer specifically for your events, or write a program that scans the event log and creates reports that include information from the event-specific data.</span></span>  
  
 <span data-ttu-id="6be2f-1696">指定的源之前，必须注册为事件日志使用<xref:System.Diagnostics.EventLog.WriteEvent%2A>。</span><span class="sxs-lookup"><span data-stu-id="6be2f-1696">The specified source must be registered for an event log before using <xref:System.Diagnostics.EventLog.WriteEvent%2A>.</span></span> <span data-ttu-id="6be2f-1697">指定的源必须配置用于本地化的项写入事件日志中。源至少必须具有一个用于定义消息资源文件。</span><span class="sxs-lookup"><span data-stu-id="6be2f-1697">The specified source must be configured for writing localized entries to the log; the source must at minimum have a message resource file defined.</span></span>  
  
 <span data-ttu-id="6be2f-1698">你必须创建并在编写与源的第一个条目之前，配置事件源。</span><span class="sxs-lookup"><span data-stu-id="6be2f-1698">You must create and configure the event source before writing the first entry with the source.</span></span> <span data-ttu-id="6be2f-1699">在你的应用程序的安装过程中创建新的事件源。</span><span class="sxs-lookup"><span data-stu-id="6be2f-1699">Create the new event source during the installation of your application.</span></span> <span data-ttu-id="6be2f-1700">这样，可以为操作系统来刷新其已注册的事件源的列表和其配置的时间。</span><span class="sxs-lookup"><span data-stu-id="6be2f-1700">This allows time for the operating system to refresh its list of registered event sources and their configuration.</span></span> <span data-ttu-id="6be2f-1701">如果操作系统未刷新其事件源的列表，并尝试写入新的源的事件写入操作将失败。</span><span class="sxs-lookup"><span data-stu-id="6be2f-1701">If the operating system has not refreshed its list of event sources, and you attempt to write an event with the new source, the write operation will fail.</span></span> <span data-ttu-id="6be2f-1702">你可以配置新的源使用<xref:System.Diagnostics.EventLogInstaller>，或使用<xref:System.Diagnostics.EventLog.CreateEventSource%2A>方法。</span><span class="sxs-lookup"><span data-stu-id="6be2f-1702">You can configure a new source using an <xref:System.Diagnostics.EventLogInstaller>, or using the <xref:System.Diagnostics.EventLog.CreateEventSource%2A> method.</span></span> <span data-ttu-id="6be2f-1703">若要创建新的事件源的计算机上，必须具有管理权限。</span><span class="sxs-lookup"><span data-stu-id="6be2f-1703">You must have administrative rights on the computer to create a new event source.</span></span>  
  
 <span data-ttu-id="6be2f-1704">要写入本地化的项还是要直接写入字符串，则必须配置源。</span><span class="sxs-lookup"><span data-stu-id="6be2f-1704">The source must be configured either for writing localized entries or for writing direct strings.</span></span> <span data-ttu-id="6be2f-1705">使用<xref:System.Diagnostics.EventLog.WriteEntry%2A>方法如果你的应用程序将直接写入事件日志的字符串值。</span><span class="sxs-lookup"><span data-stu-id="6be2f-1705">Use the <xref:System.Diagnostics.EventLog.WriteEntry%2A> method if your application writes string values directly to the event log.</span></span>  
  
 <span data-ttu-id="6be2f-1706">如果你的应用程序将使用资源标识符和字符串值的条目，则必须注册两个单独的源。</span><span class="sxs-lookup"><span data-stu-id="6be2f-1706">If your application writes entries using both resource identifiers and string values, you must register two separate sources.</span></span> <span data-ttu-id="6be2f-1707">例如，使用资源文件，配置一个源，然后使用在该源<xref:System.Diagnostics.EventLog.WriteEvent%2A>方法来编写使用到事件日志的资源标识符的条目。</span><span class="sxs-lookup"><span data-stu-id="6be2f-1707">For example, configure one source with resource files, and then use that source in the <xref:System.Diagnostics.EventLog.WriteEvent%2A> method to write entries using resource identifiers to the event log.</span></span> <span data-ttu-id="6be2f-1708">然后创建不同的源，而无需资源文件，并使用在该源<xref:System.Diagnostics.EventLog.WriteEntry%2A>方法使用该源的事件日志中直接写入字符串。</span><span class="sxs-lookup"><span data-stu-id="6be2f-1708">Then create a different source without resource files, and use that source in the <xref:System.Diagnostics.EventLog.WriteEntry%2A> method to write strings directly to the event log using that source.</span></span>  
  
   
  
## Examples  
 <span data-ttu-id="6be2f-1709">下面的示例将现有的事件日志写入信息性事件条目和警告事件项。</span><span class="sxs-lookup"><span data-stu-id="6be2f-1709">The following example writes an informational event entry and a warning event entry to an existing event log.</span></span> <span data-ttu-id="6be2f-1710">事件消息文本被指定的资源文件中使用的资源标识符。</span><span class="sxs-lookup"><span data-stu-id="6be2f-1710">The event message text is specified using a resource identifier in a resource file.</span></span> <span data-ttu-id="6be2f-1711">该示例假定已为该源中注册相应的资源文件。</span><span class="sxs-lookup"><span data-stu-id="6be2f-1711">The example assumes the corresponding resource file has been registered for the source.</span></span>  
  
 [!code-cpp[EventLog_WriteEvent#8](~/samples/snippets/cpp/VS_Snippets_CLR/eventlog_WriteEvent/CPP/source.cpp#8)]
 [!code-csharp[EventLog_WriteEvent#8](~/samples/snippets/csharp/VS_Snippets_CLR/eventlog_WriteEvent/CS/source.cs#8)]
 [!code-vb[EventLog_WriteEvent#8](~/samples/snippets/visualbasic/VS_Snippets_CLR/eventlog_WriteEvent/VB/source.vb#8)]  
  
 <span data-ttu-id="6be2f-1712">该示例使用以下的消息文本文件，内置于 EventLogMsgs.dll 的资源库。</span><span class="sxs-lookup"><span data-stu-id="6be2f-1712">The example uses the following message text file, built into the resource library EventLogMsgs.dll.</span></span> <span data-ttu-id="6be2f-1713">消息文本文件是从其创建的消息资源文件的源。</span><span class="sxs-lookup"><span data-stu-id="6be2f-1713">A message text file is the source from which the message resource file is created.</span></span> <span data-ttu-id="6be2f-1714">消息文本文件定义的资源标识符和类别、 事件消息和参数插入字符串的文本。</span><span class="sxs-lookup"><span data-stu-id="6be2f-1714">The message text file defines the resource identifiers and text for the category, event message, and parameter insertion strings.</span></span>  
  
```  
; // EventLogMsgs.mc  
; // ********************************************************  
  
; // Use the following commands to build this file:  
  
; //   mc -s EventLogMsgs.mc  
; //   rc EventLogMsgs.rc  
; //   link /DLL /SUBSYSTEM:WINDOWS /NOENTRY /MACHINE:x86 EventLogMsgs.Res   
; // ********************************************************  
  
; // - Event categories -  
; // Categories must be numbered consecutively starting at 1.  
; // ********************************************************  
  
MessageId=0x1  
Severity=Success  
SymbolicName=INSTALL_CATEGORY  
Language=English  
Installation  
.  
  
MessageId=0x2  
Severity=Success  
SymbolicName=QUERY_CATEGORY  
Language=English  
Database Query  
.  
  
MessageId=0x3  
Severity=Success  
SymbolicName=REFRESH_CATEGORY  
Language=English  
Data Refresh  
.  
  
; // - Event messages -  
; // *********************************  
  
MessageId = 1000  
Severity = Success  
Facility = Application  
SymbolicName = AUDIT_SUCCESS_MESSAGE_ID_1000  
Language=English  
My application message text, in English, for message id 1000, called from %1.  
.  
  
MessageId = 1001  
Severity = Warning  
Facility = Application  
SymbolicName = AUDIT_FAILED_MESSAGE_ID_1001  
Language=English  
My application message text, in English, for message id 1001, called from %1.  
.  
  
MessageId = 1002  
Severity = Success  
Facility = Application  
SymbolicName = GENERIC_INFO_MESSAGE_ID_1002  
Language=English  
My generic information message in English, for message id 1002.  
.  
  
MessageId = 1003  
Severity = Warning  
Facility = Application  
SymbolicName = GENERIC_WARNING_MESSAGE_ID_1003  
Language=English  
My generic warning message in English, for message id 1003, called from %1.  
.  
  
MessageId = 1004  
Severity = Success  
Facility = Application  
SymbolicName = UPDATE_CYCLE_COMPLETE_MESSAGE_ID_1004  
Language=English  
The update cycle is complete for %%5002.  
.  
  
MessageId = 1005  
Severity = Warning  
Facility = Application  
SymbolicName = SERVER_CONNECTION_DOWN_MESSAGE_ID_1005  
Language=English  
The refresh operation did not complete because the connection to server %1 could not be established.  
.  
  
; // - Event log display name -  
; // ********************************************************  
  
MessageId = 5001  
Severity = Success  
Facility = Application  
SymbolicName = EVENT_LOG_DISPLAY_NAME_MSGID  
Language=English  
Sample Event Log  
.  
  
; // - Event message parameters -  
; //   Language independent insertion strings  
; // ********************************************************  
  
MessageId = 5002  
Severity = Success  
Facility = Application  
SymbolicName = EVENT_LOG_SERVICE_NAME_MSGID  
Language=English  
SVC_UPDATE.EXE  
.  
```  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentException"><span data-ttu-id="6be2f-1715"><paramref name="source" /> 值是空字符串 ("")。</span><span class="sxs-lookup"><span data-stu-id="6be2f-1715">The <paramref name="source" /> value is an empty string ("").</span></span>  
  
 <span data-ttu-id="6be2f-1716">\- 或 -</span><span class="sxs-lookup"><span data-stu-id="6be2f-1716">\- or -</span></span>  
  
 <span data-ttu-id="6be2f-1717"><paramref name="source" /> 值为 <see langword="null" />。</span><span class="sxs-lookup"><span data-stu-id="6be2f-1717">The <paramref name="source" /> value is <see langword="null" />.</span></span>  
  
 <span data-ttu-id="6be2f-1718">\- 或 -</span><span class="sxs-lookup"><span data-stu-id="6be2f-1718">\- or -</span></span>  
  
 <span data-ttu-id="6be2f-1719"><paramref name="instance.InstanceId" /> 小于零或大于 <see cref="F:System.UInt16.MaxValue" />。</span><span class="sxs-lookup"><span data-stu-id="6be2f-1719"><paramref name="instance.InstanceId" /> is less than zero or greater than <see cref="F:System.UInt16.MaxValue" />.</span></span>  
  
 <span data-ttu-id="6be2f-1720">\- 或 -</span><span class="sxs-lookup"><span data-stu-id="6be2f-1720">\- or -</span></span>  
  
 <span data-ttu-id="6be2f-1721"><paramref name="values" /> 超过了 256 个元素。</span><span class="sxs-lookup"><span data-stu-id="6be2f-1721"><paramref name="values" /> has more than 256 elements.</span></span>  
  
 <span data-ttu-id="6be2f-1722">\- 或 -</span><span class="sxs-lookup"><span data-stu-id="6be2f-1722">\- or -</span></span>  
  
 <span data-ttu-id="6be2f-1723"><paramref name="values" /> 元素中有一个超过了 32766 个字节。</span><span class="sxs-lookup"><span data-stu-id="6be2f-1723">One of the <paramref name="values" /> elements is longer than 32766 bytes.</span></span>  
  
 <span data-ttu-id="6be2f-1724">\- 或 -</span><span class="sxs-lookup"><span data-stu-id="6be2f-1724">\- or -</span></span>  
  
 <span data-ttu-id="6be2f-1725">此源名称导致注册表项路径的长度超过 254 个字符。</span><span class="sxs-lookup"><span data-stu-id="6be2f-1725">The source name results in a registry key path longer than 254 characters.</span></span></exception>
        <exception cref="T:System.ArgumentNullException">
          <span data-ttu-id="6be2f-1726"><paramref name="instance" /> 为 <see langword="null" />。</span><span class="sxs-lookup"><span data-stu-id="6be2f-1726"><paramref name="instance" /> is <see langword="null" />.</span></span></exception>
        <exception cref="T:System.InvalidOperationException"><span data-ttu-id="6be2f-1727">事件日志的注册表项未能打开。</span><span class="sxs-lookup"><span data-stu-id="6be2f-1727">The registry key for the event log could not be opened.</span></span></exception>
        <exception cref="T:System.ComponentModel.Win32Exception"><span data-ttu-id="6be2f-1728">将事件项写入事件日志时，操作系统报告了一个错误。</span><span class="sxs-lookup"><span data-stu-id="6be2f-1728">The operating system reported an error when writing the event entry to the event log.</span></span> <span data-ttu-id="6be2f-1729">一个 Windows 错误代码不可用。</span><span class="sxs-lookup"><span data-stu-id="6be2f-1729">A Windows error code is not available.</span></span></exception>
        <permission cref="T:System.Diagnostics.EventLogPermission"><span data-ttu-id="6be2f-1730">用于写入的计算机上的事件日志信息。</span><span class="sxs-lookup"><span data-stu-id="6be2f-1730">for writing the event log information on the computer.</span></span> <span data-ttu-id="6be2f-1731">关联的枚举： <see cref="F:System.Diagnostics.EventLogPermissionAccess.Write" /></span><span class="sxs-lookup"><span data-stu-id="6be2f-1731">Associated enumeration: <see cref="F:System.Diagnostics.EventLogPermissionAccess.Write" /></span></span></permission>
        <altmember cref="Overload:System.Diagnostics.EventLog.CreateEventSource" />
        <altmember cref="P:System.Diagnostics.EventLog.Source" />
        <altmember cref="P:System.Diagnostics.EventLog.Entries" />
        <altmember cref="T:System.Diagnostics.EventInstance" />
      </Docs>
    </Member>
  </Members>
</Type>